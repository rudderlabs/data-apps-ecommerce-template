2022-06-28 07:34:28.010849 (MainThread): Running with dbt=1.0.8
2022-06-28 07:34:28.267023 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt_rpc.task.server.RPCServerTask'>, debug=None, defer=None, exclude=None, fail_fast=None, host='0.0.0.0', log_cache_events=False, log_format=None, models=None, partial_parse=True, port=8580, printer_width=None, profile='user', profiles_dir='/usr/src/develop/.dbt', project_dir=None, record_timing_info=None, rpc_method=None, send_anonymous_usage_stats=None, single_threaded=False, state=None, static_parser=None, target=None, threads=None, use_colors=None, use_experimental_parser=None, vars='{}', version_check=None, warn_error=None, which='rpc', write_json=None)
2022-06-28 07:34:28.283105 (MainThread): Tracking: tracking
2022-06-28 07:34:28.283538 (MainThread): 07:34:28  Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb7c6c41310>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb7c6c41190>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb78876f550>]}
2022-06-28 07:34:28.283857 (MainThread): Serving RPC server at 0.0.0.0:8580, pid=22
2022-06-28 07:34:28.284134 (MainThread): Supported methods: ['build', 'cli_args', 'compile', 'compile_sql', 'deps', 'docs.generate', 'gc', 'get-manifest', 'kill', 'list', 'poll', 'ps', 'run', 'run-operation', 'run_sql', 'seed', 'snapshot', 'snapshot-freshness', 'source-freshness', 'status', 'test']
2022-06-28 07:34:28.284367 (MainThread): Send requests to http://localhost:8580/jsonrpc
2022-06-28 07:34:28.286461 (Thread-12): 07:34:28  Partial parse save file not found. Starting full parse.
2022-06-28 07:34:28.286755 (Thread-12): 07:34:28  Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': 'b6c0532a-3544-442c-b6ea-c43ccf94db55', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb78876cf70>]}
2022-06-28 07:34:28.311352 (Thread-12): 07:34:28  Parsing macros/adapters.sql
2022-06-28 07:34:28.349177 (Thread-12): 07:34:28  Parsing macros/catalog.sql
2022-06-28 07:34:28.351087 (Thread-12): 07:34:28  Parsing macros/materializations/table.sql
2022-06-28 07:34:28.354041 (Thread-12): 07:34:28  Parsing macros/materializations/seed.sql
2022-06-28 07:34:28.358937 (Thread-12): 07:34:28  Parsing macros/materializations/incremental.sql
2022-06-28 07:34:28.367150 (Thread-12): 07:34:28  Parsing macros/materializations/merge.sql
2022-06-28 07:34:28.370783 (Thread-12): 07:34:28  Parsing macros/materializations/snapshot.sql
2022-06-28 07:34:28.371687 (Thread-12): 07:34:28  Parsing macros/materializations/view.sql
2022-06-28 07:34:28.372956 (Thread-12): 07:34:28  Parsing macros/adapters/metadata.sql
2022-06-28 07:34:28.379885 (Thread-12): 07:34:28  Parsing macros/adapters/columns.sql
2022-06-28 07:34:28.389799 (Thread-12): 07:34:28  Parsing macros/adapters/freshness.sql
2022-06-28 07:34:28.392564 (Thread-12): 07:34:28  Parsing macros/adapters/persist_docs.sql
2022-06-28 07:34:28.396893 (Thread-12): 07:34:28  Parsing macros/adapters/relation.sql
2022-06-28 07:34:28.406093 (Thread-12): 07:34:28  Parsing macros/adapters/schema.sql
2022-06-28 07:34:28.408239 (Thread-12): 07:34:28  Parsing macros/adapters/indexes.sql
2022-06-28 07:34:28.410992 (Thread-12): 07:34:28  Parsing macros/get_custom_name/get_custom_schema.sql
2022-06-28 07:34:28.413434 (Thread-12): 07:34:28  Parsing macros/get_custom_name/get_custom_alias.sql
2022-06-28 07:34:28.417245 (Thread-12): 07:34:28  Parsing macros/get_custom_name/get_custom_database.sql
2022-06-28 07:34:28.421375 (Thread-12): 07:34:28  Parsing macros/etc/datetime.sql
2022-06-28 07:34:28.433153 (Thread-12): 07:34:28  Parsing macros/etc/statement.sql
2022-06-28 07:34:28.437687 (Thread-12): 07:34:28  Parsing macros/generic_test_sql/unique.sql
2022-06-28 07:34:28.438430 (Thread-12): 07:34:28  Parsing macros/generic_test_sql/not_null.sql
2022-06-28 07:34:28.438984 (Thread-12): 07:34:28  Parsing macros/generic_test_sql/accepted_values.sql
2022-06-28 07:34:28.440333 (Thread-12): 07:34:28  Parsing macros/generic_test_sql/relationships.sql
2022-06-28 07:34:28.441170 (Thread-12): 07:34:28  Parsing macros/materializations/configs.sql
2022-06-28 07:34:28.443433 (Thread-12): 07:34:28  Parsing macros/materializations/hooks.sql
2022-06-28 07:34:28.447206 (Thread-12): 07:34:28  Parsing macros/materializations/models/table/table.sql
2022-06-28 07:34:28.454645 (Thread-12): 07:34:28  Parsing macros/materializations/models/table/create_table_as.sql
2022-06-28 07:34:28.457549 (Thread-12): 07:34:28  Parsing macros/materializations/models/view/create_or_replace_view.sql
2022-06-28 07:34:28.460266 (Thread-12): 07:34:28  Parsing macros/materializations/models/view/helpers.sql
2022-06-28 07:34:28.461605 (Thread-12): 07:34:28  Parsing macros/materializations/models/view/create_view_as.sql
2022-06-28 07:34:28.463889 (Thread-12): 07:34:28  Parsing macros/materializations/models/view/view.sql
2022-06-28 07:34:28.470736 (Thread-12): 07:34:28  Parsing macros/materializations/models/incremental/incremental.sql
2022-06-28 07:34:28.480380 (Thread-12): 07:34:28  Parsing macros/materializations/models/incremental/on_schema_change.sql
2022-06-28 07:34:28.495230 (Thread-12): 07:34:28  Parsing macros/materializations/models/incremental/is_incremental.sql
2022-06-28 07:34:28.496676 (Thread-12): 07:34:28  Parsing macros/materializations/models/incremental/merge.sql
2022-06-28 07:34:28.507444 (Thread-12): 07:34:28  Parsing macros/materializations/models/incremental/column_helpers.sql
2022-06-28 07:34:28.511679 (Thread-12): 07:34:28  Parsing macros/materializations/seeds/helpers.sql
2022-06-28 07:34:28.527181 (Thread-12): 07:34:28  Parsing macros/materializations/seeds/seed.sql
2022-06-28 07:34:28.532825 (Thread-12): 07:34:28  Parsing macros/materializations/tests/helpers.sql
2022-06-28 07:34:28.534523 (Thread-12): 07:34:28  Parsing macros/materializations/tests/test.sql
2022-06-28 07:34:28.538723 (Thread-12): 07:34:28  Parsing macros/materializations/tests/where_subquery.sql
2022-06-28 07:34:28.540457 (Thread-12): 07:34:28  Parsing macros/materializations/snapshots/helpers.sql
2022-06-28 07:34:28.551335 (Thread-12): 07:34:28  Parsing macros/materializations/snapshots/strategies.sql
2022-06-28 07:34:28.567319 (Thread-12): 07:34:28  Parsing macros/materializations/snapshots/snapshot_merge.sql
2022-06-28 07:34:28.568888 (Thread-12): 07:34:28  Parsing macros/materializations/snapshots/snapshot.sql
2022-06-28 07:34:28.579956 (Thread-12): 07:34:28  Parsing tests/generic/builtin.sql
2022-06-28 07:34:28.768731 (Thread-12): 07:34:28  1699: static parser successfully parsed example/my_first_dbt_model.sql
2022-06-28 07:34:28.796722 (Thread-12): 07:34:28  [WARNING]: Did not find matching node for patch with name 'my_second_dbt_model' in the 'models' section of file 'models/example/schema.yml'
2022-06-28 07:34:28.810893 (Thread-12): 07:34:28  [WARNING]: Test 'test.ecommerce_data_model_dbt.unique_my_second_dbt_model_id.57a0f8c493' (models/example/schema.yml) depends on a node named 'my_second_dbt_model' which was not found
2022-06-28 07:34:28.811134 (Thread-12): 07:34:28  [WARNING]: Test 'test.ecommerce_data_model_dbt.not_null_my_second_dbt_model_id.151b76d778' (models/example/schema.yml) depends on a node named 'my_second_dbt_model' which was not found
2022-06-28 07:34:28.850452 (Thread-12): 07:34:28  Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'b6c0532a-3544-442c-b6ea-c43ccf94db55', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb7880aa250>]}
2022-06-28 07:34:28.993037 (Thread-13): handling status request
2022-06-28 07:34:28.993531 (Thread-13): 07:34:28  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'b6c0532a-3544-442c-b6ea-c43ccf94db55', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb7880aac10>]}
2022-06-28 07:34:28.994554 (Thread-13): sending response (<Response 16544 bytes [200 OK]>) to 10.0.21.58
2022-06-28 07:34:29.330721 (Thread-14): handling status request
2022-06-28 07:34:29.331119 (Thread-14): 07:34:29  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'b6c0532a-3544-442c-b6ea-c43ccf94db55', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb7cae4d400>]}
2022-06-28 07:34:29.331955 (Thread-14): sending response (<Response 16544 bytes [200 OK]>) to 10.0.21.58
2022-06-28 07:34:43.382330 (Thread-15): handling status request
2022-06-28 07:34:43.383808 (Thread-15): 07:34:43  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'b6c0532a-3544-442c-b6ea-c43ccf94db55', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb788760fd0>]}
2022-06-28 07:34:43.384657 (Thread-15): sending response (<Response 16544 bytes [200 OK]>) to 10.0.21.58
2022-06-28 07:34:43.757281 (Thread-16): handling run_sql request
2022-06-28 07:34:43.757714 (Thread-16): 07:34:43  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'b6c0532a-3544-442c-b6ea-c43ccf94db55', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb78876c100>]}
2022-06-28 07:34:46.082452 (Thread-16): sending response (<Response 138 bytes [200 OK]>) to 10.0.21.58
2022-06-28 07:34:46.111612 (MainThread): 07:34:46  Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '5807ee2b-3837-490e-869b-72d0f98ed434', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fde78092490>]}
2022-06-28 07:34:46.112236 (MainThread): 07:34:46  Found 1 model, 2 tests, 0 snapshots, 0 analyses, 179 macros, 0 operations, 0 seed files, 0 sources, 0 exposures, 0 metrics
2022-06-28 07:34:46.112832 (Thread-1): 07:34:46  Acquiring new snowflake connection "rpc.ecommerce_data_model_dbt.request"
2022-06-28 07:34:46.112964 (Thread-1): 07:34:46  Began compiling node rpc.ecommerce_data_model_dbt.request
2022-06-28 07:34:46.113054 (Thread-1): 07:34:46  Compiling rpc.ecommerce_data_model_dbt.request
2022-06-28 07:34:46.114970 (Thread-1): 07:34:46  finished collecting timing info
2022-06-28 07:34:46.115102 (Thread-1): 07:34:46  Began executing node rpc.ecommerce_data_model_dbt.request
2022-06-28 07:34:46.115915 (Thread-1): 07:34:46  Using snowflake connection "rpc.ecommerce_data_model_dbt.request"
2022-06-28 07:34:46.116010 (Thread-1): 07:34:46  On rpc.ecommerce_data_model_dbt.request: /*
    Welcome to your first dbt model!
    Did you know that you can also configure models directly within SQL files?
    This will override configurations stated in dbt_project.yml

    Try changing "table" to "view" below
*/



with source_data as (

    select 1 as id
    union all
    select null as id

)

select *
from source_data

/*
    Uncomment the line below to remove records with null `id` values
*/

-- where id is not null
limit 500
/* limit added automatically by dbt cloud */
2022-06-28 07:34:46.116093 (Thread-1): 07:34:46  Opening a new connection, currently in state init
2022-06-28 07:34:46.477329 (Thread-17): handling poll request
2022-06-28 07:34:46.477758 (Thread-17): 07:34:46  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'b6c0532a-3544-442c-b6ea-c43ccf94db55', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb78808a940>]}
2022-06-28 07:34:46.478686 (Thread-17): sending response (<Response 4246 bytes [200 OK]>) to 10.0.21.58
2022-06-28 07:34:47.655804 (Thread-1): 07:34:47  SQL status: SUCCESS 2 in 1.54 seconds
2022-06-28 07:34:47.657258 (Thread-1): 07:34:47  finished collecting timing info
2022-06-28 07:34:47.657457 (Thread-1): 07:34:47  On rpc.ecommerce_data_model_dbt.request: Close
2022-06-28 07:34:47.854405 (Thread-18): handling poll request
2022-06-28 07:34:47.854772 (Thread-18): 07:34:47  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'b6c0532a-3544-442c-b6ea-c43ccf94db55', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb78808a880>]}
2022-06-28 07:34:47.855280 (Thread-18): sending response (<Response 1383 bytes [200 OK]>) to 10.0.21.58
2022-06-28 07:34:49.282303 (Thread-19): handling poll request
2022-06-28 07:34:49.282692 (Thread-19): 07:34:49  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'b6c0532a-3544-442c-b6ea-c43ccf94db55', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb78808ab80>]}
2022-06-28 07:34:49.283562 (Thread-19): sending response (<Response 4336 bytes [200 OK]>) to 10.0.21.58
2022-06-28 07:39:25.636206 (Thread-20): 07:39:25  Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
2022-06-28 07:39:25.637845 (Thread-20): 07:39:25  Partial parsing: update schema file: ecommerce_data_model_dbt://models/example/schema.yml
2022-06-28 07:39:25.706234 (Thread-20): 07:39:25  Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'b6c0532a-3544-442c-b6ea-c43ccf94db55', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb780d2c6d0>]}
2022-06-28 07:39:25.801081 (Thread-21): 07:39:25  Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
2022-06-28 07:39:25.801274 (Thread-21): 07:39:25  Partial parsing enabled, no changes found, skipping parsing
2022-06-28 07:39:25.806447 (Thread-21): 07:39:25  Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'b6c0532a-3544-442c-b6ea-c43ccf94db55', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb780c9c8b0>]}
2022-06-28 07:39:26.639982 (Thread-22): handling status request
2022-06-28 07:39:26.640343 (Thread-22): 07:39:26  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'b6c0532a-3544-442c-b6ea-c43ccf94db55', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb7880aa6a0>]}
2022-06-28 07:39:26.640854 (Thread-22): sending response (<Response 1241 bytes [200 OK]>) to 10.0.21.58
2022-06-28 07:39:26.837841 (Thread-23): handling status request
2022-06-28 07:39:26.838214 (Thread-23): 07:39:26  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'b6c0532a-3544-442c-b6ea-c43ccf94db55', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb7887f5040>]}
2022-06-28 07:39:26.838684 (Thread-23): sending response (<Response 1241 bytes [200 OK]>) to 10.0.21.58
2022-06-28 07:39:26.868244 (Thread-24): handling status request
2022-06-28 07:39:26.868551 (Thread-24): 07:39:26  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'b6c0532a-3544-442c-b6ea-c43ccf94db55', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb788046e50>]}
2022-06-28 07:39:26.868980 (Thread-24): sending response (<Response 1241 bytes [200 OK]>) to 10.0.21.58
2022-06-28 07:39:27.094763 (Thread-25): handling status request
2022-06-28 07:39:27.095169 (Thread-25): 07:39:27  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'b6c0532a-3544-442c-b6ea-c43ccf94db55', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb780d6a190>]}
2022-06-28 07:39:27.095615 (Thread-25): sending response (<Response 1241 bytes [200 OK]>) to 10.0.21.58
2022-06-28 07:39:30.440622 (Thread-26): 07:39:30  Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
2022-06-28 07:39:30.441029 (Thread-26): 07:39:30  Partial parsing: update schema file: ecommerce_data_model_dbt://models/example/schema.yml
2022-06-28 07:39:30.484748 (Thread-26): 07:39:30  Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'b6c0532a-3544-442c-b6ea-c43ccf94db55', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb780c137f0>]}
2022-06-28 07:39:31.266246 (Thread-27): handling status request
2022-06-28 07:39:31.266622 (Thread-27): 07:39:31  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'b6c0532a-3544-442c-b6ea-c43ccf94db55', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb780c97250>]}
2022-06-28 07:39:31.267100 (Thread-27): sending response (<Response 1271 bytes [200 OK]>) to 10.0.21.58
2022-06-28 07:39:31.340481 (Thread-28): handling status request
2022-06-28 07:39:31.340854 (Thread-28): 07:39:31  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'b6c0532a-3544-442c-b6ea-c43ccf94db55', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb780d28e80>]}
2022-06-28 07:39:31.341322 (Thread-28): sending response (<Response 1271 bytes [200 OK]>) to 10.0.21.58
2022-06-28 07:40:21.175674 (Thread-29): 07:40:21  Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
2022-06-28 07:40:21.176932 (Thread-29): 07:40:21  Partial parsing enabled, no changes found, skipping parsing
2022-06-28 07:40:21.182346 (Thread-29): 07:40:21  Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'b6c0532a-3544-442c-b6ea-c43ccf94db55', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb780bf2f70>]}
2022-06-28 07:40:21.317865 (Thread-30): 07:40:21  Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
2022-06-28 07:40:21.318065 (Thread-30): 07:40:21  Partial parsing enabled, no changes found, skipping parsing
2022-06-28 07:40:21.323298 (Thread-30): 07:40:21  Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'b6c0532a-3544-442c-b6ea-c43ccf94db55', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb780be0f10>]}
2022-06-28 07:40:22.185634 (Thread-31): handling status request
2022-06-28 07:40:22.186026 (Thread-31): 07:40:22  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'b6c0532a-3544-442c-b6ea-c43ccf94db55', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb780c76940>]}
2022-06-28 07:40:22.186513 (Thread-31): sending response (<Response 1241 bytes [200 OK]>) to 10.0.21.58
2022-06-28 07:40:22.201871 (Thread-32): handling status request
2022-06-28 07:40:22.202204 (Thread-32): 07:40:22  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'b6c0532a-3544-442c-b6ea-c43ccf94db55', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb780c76be0>]}
2022-06-28 07:40:22.202619 (Thread-32): sending response (<Response 1241 bytes [200 OK]>) to 10.0.21.58
2022-06-28 07:40:22.369833 (Thread-33): handling status request
2022-06-28 07:40:22.370187 (Thread-33): 07:40:22  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'b6c0532a-3544-442c-b6ea-c43ccf94db55', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb780c76d30>]}
2022-06-28 07:40:22.370649 (Thread-33): sending response (<Response 1241 bytes [200 OK]>) to 10.0.21.58
2022-06-28 07:40:22.402083 (Thread-34): handling status request
2022-06-28 07:40:22.402425 (Thread-34): 07:40:22  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'b6c0532a-3544-442c-b6ea-c43ccf94db55', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb780c76e80>]}
2022-06-28 07:40:22.402872 (Thread-34): sending response (<Response 1241 bytes [200 OK]>) to 10.0.21.58
2022-06-28 07:41:23.450059 (Thread-35): 07:41:23  Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
2022-06-28 07:41:23.451383 (Thread-35): 07:41:23  Partial parsing enabled, no changes found, skipping parsing
2022-06-28 07:41:23.456526 (Thread-35): 07:41:23  Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'b6c0532a-3544-442c-b6ea-c43ccf94db55', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb780b75fa0>]}
2022-06-28 07:41:24.316230 (Thread-36): handling status request
2022-06-28 07:41:24.316588 (Thread-36): 07:41:24  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'b6c0532a-3544-442c-b6ea-c43ccf94db55', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb780bd5910>]}
2022-06-28 07:41:24.317050 (Thread-36): sending response (<Response 1241 bytes [200 OK]>) to 10.0.21.58
2022-06-28 07:41:24.424124 (Thread-37): handling status request
2022-06-28 07:41:24.424477 (Thread-37): 07:41:24  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'b6c0532a-3544-442c-b6ea-c43ccf94db55', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb780bd57f0>]}
2022-06-28 07:41:24.424945 (Thread-37): sending response (<Response 1241 bytes [200 OK]>) to 10.0.21.58
2022-06-28 07:41:35.626823 (Thread-38): 07:41:35  Partial parsing enabled: 2 files deleted, 2 files added, 0 files changed.
2022-06-28 07:41:35.627131 (Thread-38): 07:41:35  Partial parsing: added file: ecommerce_data_model_dbt://models/data_model/my_first_dbt_model.sql
2022-06-28 07:41:35.627348 (Thread-38): 07:41:35  Partial parsing: added file: ecommerce_data_model_dbt://models/data_model/schema.yml
2022-06-28 07:41:35.627488 (Thread-38): 07:41:35  Partial parsing: deleted source source.ecommerce_data_model_dbt.ecommerce.users
2022-06-28 07:41:35.627566 (Thread-38): 07:41:35  Partial parsing: deleted source source.ecommerce_data_model_dbt.ecommerce.tracks
2022-06-28 07:41:35.627634 (Thread-38): 07:41:35  Partial parsing: deleted source source.ecommerce_data_model_dbt.ecommerce.product_viewed
2022-06-28 07:41:35.627698 (Thread-38): 07:41:35  Partial parsing: deleted source source.ecommerce_data_model_dbt.ecommerce.product_removed
2022-06-28 07:41:35.627758 (Thread-38): 07:41:35  Partial parsing: deleted source source.ecommerce_data_model_dbt.ecommerce.product_list_viewed
2022-06-28 07:41:35.627818 (Thread-38): 07:41:35  Partial parsing: deleted source source.ecommerce_data_model_dbt.ecommerce.product_list_filtered
2022-06-28 07:41:35.627878 (Thread-38): 07:41:35  Partial parsing: deleted source source.ecommerce_data_model_dbt.ecommerce.product_clicked
2022-06-28 07:41:35.627938 (Thread-38): 07:41:35  Partial parsing: deleted source source.ecommerce_data_model_dbt.ecommerce.product_added
2022-06-28 07:41:35.627997 (Thread-38): 07:41:35  Partial parsing: deleted source source.ecommerce_data_model_dbt.ecommerce.products_searched
2022-06-28 07:41:35.628055 (Thread-38): 07:41:35  Partial parsing: deleted source source.ecommerce_data_model_dbt.ecommerce.order_completed
2022-06-28 07:41:35.628114 (Thread-38): 07:41:35  Partial parsing: deleted source source.ecommerce_data_model_dbt.ecommerce.identifies
2022-06-28 07:41:35.628172 (Thread-38): 07:41:35  Partial parsing: deleted source source.ecommerce_data_model_dbt.ecommerce.complaint_raised
2022-06-28 07:41:35.628317 (Thread-38): 07:41:35  Partial parsing: deleted source source.ecommerce_data_model_dbt.ecommerce.checkout_step_completed
2022-06-28 07:41:35.628379 (Thread-38): 07:41:35  Partial parsing: deleted source source.ecommerce_data_model_dbt.ecommerce.checkout_started
2022-06-28 07:41:35.628439 (Thread-38): 07:41:35  Partial parsing: deleted source source.ecommerce_data_model_dbt.ecommerce.cart_viewed
2022-06-28 07:41:35.628528 (Thread-38): 07:41:35  Partial parsing: deleted file: ecommerce_data_model_dbt://models/example/my_first_dbt_model.sql
2022-06-28 07:41:35.632012 (Thread-38): 07:41:35  1699: static parser successfully parsed data_model/my_first_dbt_model.sql
2022-06-28 07:41:35.690110 (Thread-38): 07:41:35  [WARNING]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.ecommerce_data_model_dbt.example

2022-06-28 07:41:35.697045 (Thread-38): 07:41:35  Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'b6c0532a-3544-442c-b6ea-c43ccf94db55', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb7887baf70>]}
2022-06-28 07:41:36.244000 (Thread-39): handling status request
2022-06-28 07:41:36.244360 (Thread-39): 07:41:36  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'b6c0532a-3544-442c-b6ea-c43ccf94db55', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb780c92820>]}
2022-06-28 07:41:36.267552 (Thread-39): sending response (<Response 7644 bytes [200 OK]>) to 10.0.21.58
2022-06-28 07:41:36.303223 (Thread-40): handling status request
2022-06-28 07:41:36.303558 (Thread-40): 07:41:36  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'b6c0532a-3544-442c-b6ea-c43ccf94db55', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb780c92580>]}
2022-06-28 07:41:36.304100 (Thread-40): sending response (<Response 7644 bytes [200 OK]>) to 10.0.21.58
2022-06-28 07:52:26.297256 (Thread-41): 07:52:26  Partial parsing enabled: 0 files deleted, 1 files added, 0 files changed.
2022-06-28 07:52:26.298894 (Thread-41): 07:52:26  Partial parsing: added file: ecommerce_data_model_dbt://models/data_model/feat_user_features.sql
2022-06-28 07:52:26.302473 (Thread-41): 07:52:26  1699: static parser successfully parsed data_model/feat_user_features.sql
2022-06-28 07:52:26.340242 (Thread-41): 07:52:26  [WARNING]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.ecommerce_data_model_dbt.example

2022-06-28 07:52:26.345417 (Thread-41): 07:52:26  Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'b6c0532a-3544-442c-b6ea-c43ccf94db55', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb7887cc400>]}
2022-06-28 07:52:27.177585 (Thread-42): handling status request
2022-06-28 07:52:27.177994 (Thread-42): 07:52:27  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'b6c0532a-3544-442c-b6ea-c43ccf94db55', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb780d20bb0>]}
2022-06-28 07:52:27.178550 (Thread-42): sending response (<Response 2042 bytes [200 OK]>) to 10.0.21.58
2022-06-28 07:52:27.179511 (Thread-43): handling status request
2022-06-28 07:52:27.179836 (Thread-43): 07:52:27  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'b6c0532a-3544-442c-b6ea-c43ccf94db55', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb7815c8190>]}
2022-06-28 07:52:27.180284 (Thread-43): sending response (<Response 2042 bytes [200 OK]>) to 10.0.21.58
2022-06-28 07:54:30.181985 (Thread-44): 07:54:30  Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
2022-06-28 07:54:30.184802 (Thread-44): 07:54:30  Partial parsing: updated file: ecommerce_data_model_dbt://models/data_model/feat_user_features.sql
2022-06-28 07:54:30.188365 (Thread-44): 07:54:30  1603: static parser failed on data_model/feat_user_features.sql
2022-06-28 07:54:31.326818 (Thread-45): handling status request
2022-06-28 07:54:31.327247 (Thread-45): 07:54:31  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'b6c0532a-3544-442c-b6ea-c43ccf94db55', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb7886d5550>]}
2022-06-28 07:54:31.327726 (Thread-45): sending response (<Response 1309 bytes [200 OK]>) to 10.0.21.58
2022-06-28 07:54:31.399717 (Thread-46): handling status request
2022-06-28 07:54:31.400064 (Thread-46): 07:54:31  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'b6c0532a-3544-442c-b6ea-c43ccf94db55', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb780c2ee80>]}
2022-06-28 07:54:31.400505 (Thread-46): sending response (<Response 1309 bytes [200 OK]>) to 10.0.21.58
2022-06-28 07:54:55.187391 (Thread-47): 07:54:55  Partial parsing enabled: 0 files deleted, 1 files added, 1 files changed.
2022-06-28 07:54:55.187704 (Thread-47): 07:54:55  Partial parsing: added file: ecommerce_data_model_dbt://models/data_model/stg_tracks.sql
2022-06-28 07:54:55.187916 (Thread-47): 07:54:55  Partial parsing: updated file: ecommerce_data_model_dbt://models/data_model/feat_user_features.sql
2022-06-28 07:54:55.191426 (Thread-47): 07:54:55  1699: static parser successfully parsed data_model/stg_tracks.sql
2022-06-28 07:54:55.193329 (Thread-47): 07:54:55  1603: static parser failed on data_model/feat_user_features.sql
2022-06-28 07:54:56.018721 (Thread-48): handling status request
2022-06-28 07:54:56.019096 (Thread-48): 07:54:56  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'b6c0532a-3544-442c-b6ea-c43ccf94db55', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb780be5fa0>]}
2022-06-28 07:54:56.019598 (Thread-48): sending response (<Response 1944 bytes [200 OK]>) to 10.0.21.58
2022-06-28 07:54:56.125395 (Thread-49): handling status request
2022-06-28 07:54:56.125770 (Thread-49): 07:54:56  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'b6c0532a-3544-442c-b6ea-c43ccf94db55', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb780be5f10>]}
2022-06-28 07:54:56.126304 (Thread-49): sending response (<Response 1944 bytes [200 OK]>) to 10.0.21.58
2022-06-28 07:55:46.037250 (Thread-50): 07:55:46  Partial parsing enabled: 0 files deleted, 1 files added, 1 files changed.
2022-06-28 07:55:46.037595 (Thread-50): 07:55:46  Partial parsing: added file: ecommerce_data_model_dbt://models/data_model/stg_tracks.sql
2022-06-28 07:55:46.037851 (Thread-50): 07:55:46  Partial parsing: updated file: ecommerce_data_model_dbt://models/data_model/feat_user_features.sql
2022-06-28 07:55:46.041584 (Thread-50): 07:55:46  1699: static parser successfully parsed data_model/stg_tracks.sql
2022-06-28 07:55:46.043603 (Thread-50): 07:55:46  1603: static parser failed on data_model/feat_user_features.sql
2022-06-28 07:55:46.929383 (Thread-51): handling status request
2022-06-28 07:55:46.930327 (Thread-52): handling status request
2022-06-28 07:55:46.930542 (Thread-51): 07:55:46  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'b6c0532a-3544-442c-b6ea-c43ccf94db55', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb780c25e80>]}
2022-06-28 07:55:46.930848 (Thread-52): 07:55:46  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'b6c0532a-3544-442c-b6ea-c43ccf94db55', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb780c0c6a0>]}
2022-06-28 07:55:46.931353 (Thread-51): sending response (<Response 1944 bytes [200 OK]>) to 10.0.21.58
2022-06-28 07:55:46.931821 (Thread-52): sending response (<Response 1944 bytes [200 OK]>) to 10.0.21.58
2022-06-28 07:55:48.033608 (Thread-53): handling status request
2022-06-28 07:55:48.034033 (Thread-53): 07:55:48  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'b6c0532a-3544-442c-b6ea-c43ccf94db55', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb780d664f0>]}
2022-06-28 07:55:48.034495 (Thread-53): sending response (<Response 1944 bytes [200 OK]>) to 10.0.21.58
2022-06-28 07:55:48.422194 (Thread-54): handling run_sql request
2022-06-28 07:55:48.422524 (Thread-54): 07:55:48  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'b6c0532a-3544-442c-b6ea-c43ccf94db55', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb780c25b50>]}
2022-06-28 07:55:48.422888 (Thread-54): sending response (<Response 667 bytes [200 OK]>) to 10.0.21.58
2022-06-28 07:56:03.503760 (Thread-55): 07:56:03  Partial parsing enabled: 0 files deleted, 1 files added, 1 files changed.
2022-06-28 07:56:03.504143 (Thread-55): 07:56:03  Partial parsing: added file: ecommerce_data_model_dbt://models/data_model/stg_tracks.sql
2022-06-28 07:56:03.504373 (Thread-55): 07:56:03  Partial parsing: updated file: ecommerce_data_model_dbt://models/data_model/feat_user_features.sql
2022-06-28 07:56:03.508146 (Thread-55): 07:56:03  1699: static parser successfully parsed data_model/stg_tracks.sql
2022-06-28 07:56:03.510213 (Thread-55): 07:56:03  1603: static parser failed on data_model/feat_user_features.sql
2022-06-28 07:56:04.306995 (Thread-56): handling status request
2022-06-28 07:56:04.307430 (Thread-56): 07:56:04  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'b6c0532a-3544-442c-b6ea-c43ccf94db55', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb780c0c250>]}
2022-06-28 07:56:04.307946 (Thread-56): sending response (<Response 1944 bytes [200 OK]>) to 10.0.21.58
2022-06-28 07:56:04.383089 (Thread-57): handling status request
2022-06-28 07:56:04.383446 (Thread-57): 07:56:04  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'b6c0532a-3544-442c-b6ea-c43ccf94db55', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb780ca4340>]}
2022-06-28 07:56:04.383928 (Thread-57): sending response (<Response 1944 bytes [200 OK]>) to 10.0.21.58
2022-06-28 07:56:06.768745 (Thread-58): handling status request
2022-06-28 07:56:06.769139 (Thread-58): 07:56:06  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'b6c0532a-3544-442c-b6ea-c43ccf94db55', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb7887ccdc0>]}
2022-06-28 07:56:06.769602 (Thread-58): sending response (<Response 1944 bytes [200 OK]>) to 10.0.21.58
2022-06-28 07:56:07.145129 (Thread-59): handling compile_sql request
2022-06-28 07:56:07.145472 (Thread-59): 07:56:07  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'b6c0532a-3544-442c-b6ea-c43ccf94db55', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb780ca45e0>]}
2022-06-28 07:56:07.145885 (Thread-59): sending response (<Response 667 bytes [200 OK]>) to 10.0.21.58
2022-06-28 07:56:13.150060 (Thread-60): 07:56:13  Partial parsing enabled: 0 files deleted, 1 files added, 1 files changed.
2022-06-28 07:56:13.150401 (Thread-60): 07:56:13  Partial parsing: added file: ecommerce_data_model_dbt://models/data_model/stg_tracks.sql
2022-06-28 07:56:13.150625 (Thread-60): 07:56:13  Partial parsing: updated file: ecommerce_data_model_dbt://models/data_model/feat_user_features.sql
2022-06-28 07:56:13.154499 (Thread-60): 07:56:13  1699: static parser successfully parsed data_model/stg_tracks.sql
2022-06-28 07:56:13.156503 (Thread-60): 07:56:13  1603: static parser failed on data_model/feat_user_features.sql
2022-06-28 07:56:13.323143 (Thread-61): 07:56:13  Partial parsing enabled: 0 files deleted, 1 files added, 1 files changed.
2022-06-28 07:56:13.323612 (Thread-61): 07:56:13  Partial parsing: added file: ecommerce_data_model_dbt://models/data_model/stg_tracks.sql
2022-06-28 07:56:13.323860 (Thread-61): 07:56:13  Partial parsing: updated file: ecommerce_data_model_dbt://models/data_model/feat_user_features.sql
2022-06-28 07:56:13.328540 (Thread-61): 07:56:13  1699: static parser successfully parsed data_model/stg_tracks.sql
2022-06-28 07:56:13.331379 (Thread-61): 07:56:13  1603: static parser failed on data_model/feat_user_features.sql
2022-06-28 07:56:14.479433 (Thread-62): handling status request
2022-06-28 07:56:14.479879 (Thread-62): 07:56:14  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'b6c0532a-3544-442c-b6ea-c43ccf94db55', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb780bb0220>]}
2022-06-28 07:56:14.480404 (Thread-62): sending response (<Response 1944 bytes [200 OK]>) to 10.0.21.58
2022-06-28 07:56:14.650123 (Thread-63): handling status request
2022-06-28 07:56:14.650491 (Thread-63): 07:56:14  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'b6c0532a-3544-442c-b6ea-c43ccf94db55', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb780bb9790>]}
2022-06-28 07:56:14.650973 (Thread-63): sending response (<Response 1944 bytes [200 OK]>) to 10.0.21.58
2022-06-28 07:56:14.777901 (Thread-64): handling status request
2022-06-28 07:56:14.778240 (Thread-64): 07:56:14  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'b6c0532a-3544-442c-b6ea-c43ccf94db55', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb780d279d0>]}
2022-06-28 07:56:14.778704 (Thread-64): sending response (<Response 1944 bytes [200 OK]>) to 10.0.21.58
2022-06-28 07:56:14.903698 (Thread-65): handling status request
2022-06-28 07:56:14.904071 (Thread-65): 07:56:14  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'b6c0532a-3544-442c-b6ea-c43ccf94db55', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb780d27a00>]}
2022-06-28 07:56:14.904592 (Thread-65): sending response (<Response 1944 bytes [200 OK]>) to 10.0.21.58
2022-06-28 07:56:18.959651 (Thread-66): handling status request
2022-06-28 07:56:18.960009 (Thread-66): 07:56:18  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'b6c0532a-3544-442c-b6ea-c43ccf94db55', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb780d27a90>]}
2022-06-28 07:56:18.960487 (Thread-66): sending response (<Response 1944 bytes [200 OK]>) to 10.0.21.58
2022-06-28 07:56:19.354245 (Thread-67): handling run_sql request
2022-06-28 07:56:19.354600 (Thread-67): 07:56:19  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'b6c0532a-3544-442c-b6ea-c43ccf94db55', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb780d27b80>]}
2022-06-28 07:56:19.354975 (Thread-67): sending response (<Response 667 bytes [200 OK]>) to 10.0.21.58
2022-06-28 07:56:21.174068 (Thread-68): 07:56:21  Partial parsing enabled: 0 files deleted, 1 files added, 1 files changed.
2022-06-28 07:56:21.174393 (Thread-68): 07:56:21  Partial parsing: added file: ecommerce_data_model_dbt://models/data_model/stg_tracks.sql
2022-06-28 07:56:21.174595 (Thread-68): 07:56:21  Partial parsing: updated file: ecommerce_data_model_dbt://models/data_model/feat_user_features.sql
2022-06-28 07:56:21.178534 (Thread-68): 07:56:21  1699: static parser successfully parsed data_model/stg_tracks.sql
2022-06-28 07:56:21.180476 (Thread-68): 07:56:21  1603: static parser failed on data_model/feat_user_features.sql
2022-06-28 07:56:21.355315 (Thread-69): 07:56:21  Partial parsing enabled: 0 files deleted, 1 files added, 1 files changed.
2022-06-28 07:56:21.355659 (Thread-69): 07:56:21  Partial parsing: added file: ecommerce_data_model_dbt://models/data_model/stg_tracks.sql
2022-06-28 07:56:21.355872 (Thread-69): 07:56:21  Partial parsing: updated file: ecommerce_data_model_dbt://models/data_model/feat_user_features.sql
2022-06-28 07:56:21.360005 (Thread-69): 07:56:21  1699: static parser successfully parsed data_model/stg_tracks.sql
2022-06-28 07:56:21.362179 (Thread-69): 07:56:21  1603: static parser failed on data_model/feat_user_features.sql
2022-06-28 07:56:22.098080 (Thread-70): handling status request
2022-06-28 07:56:22.098453 (Thread-70): 07:56:22  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'b6c0532a-3544-442c-b6ea-c43ccf94db55', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb7886dcb80>]}
2022-06-28 07:56:22.098953 (Thread-70): sending response (<Response 1944 bytes [200 OK]>) to 10.0.21.58
2022-06-28 07:56:22.234899 (Thread-71): handling status request
2022-06-28 07:56:22.235276 (Thread-71): 07:56:22  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'b6c0532a-3544-442c-b6ea-c43ccf94db55', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb780bb01f0>]}
2022-06-28 07:56:22.235753 (Thread-71): sending response (<Response 1944 bytes [200 OK]>) to 10.0.21.58
2022-06-28 07:56:22.274392 (Thread-72): handling status request
2022-06-28 07:56:22.274743 (Thread-72): 07:56:22  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'b6c0532a-3544-442c-b6ea-c43ccf94db55', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb780da53a0>]}
2022-06-28 07:56:22.275215 (Thread-72): sending response (<Response 1944 bytes [200 OK]>) to 10.0.21.58
2022-06-28 07:56:22.421485 (Thread-73): handling status request
2022-06-28 07:56:22.421885 (Thread-73): 07:56:22  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'b6c0532a-3544-442c-b6ea-c43ccf94db55', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb780da5ee0>]}
2022-06-28 07:56:22.422374 (Thread-73): sending response (<Response 1944 bytes [200 OK]>) to 10.0.21.58
2022-06-28 07:56:27.360802 (Thread-74): 07:56:27  Partial parsing enabled: 0 files deleted, 1 files added, 1 files changed.
2022-06-28 07:56:27.361128 (Thread-74): 07:56:27  Partial parsing: added file: ecommerce_data_model_dbt://models/data_model/stg_tracks.sql
2022-06-28 07:56:27.361340 (Thread-74): 07:56:27  Partial parsing: updated file: ecommerce_data_model_dbt://models/data_model/feat_user_features.sql
2022-06-28 07:56:27.364806 (Thread-74): 07:56:27  1699: static parser successfully parsed data_model/stg_tracks.sql
2022-06-28 07:56:27.366776 (Thread-74): 07:56:27  1603: static parser failed on data_model/feat_user_features.sql
2022-06-28 07:56:28.137957 (Thread-75): handling status request
2022-06-28 07:56:28.138350 (Thread-75): 07:56:28  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'b6c0532a-3544-442c-b6ea-c43ccf94db55', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb780da2040>]}
2022-06-28 07:56:28.138876 (Thread-75): sending response (<Response 1944 bytes [200 OK]>) to 10.0.21.58
2022-06-28 07:56:28.184475 (Thread-76): handling status request
2022-06-28 07:56:28.184909 (Thread-76): 07:56:28  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'b6c0532a-3544-442c-b6ea-c43ccf94db55', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb780da2f10>]}
2022-06-28 07:56:28.185380 (Thread-76): sending response (<Response 1944 bytes [200 OK]>) to 10.0.21.58
2022-06-28 07:56:35.982802 (Thread-77): 07:56:35  Partial parsing enabled: 0 files deleted, 1 files added, 1 files changed.
2022-06-28 07:56:35.983092 (Thread-77): 07:56:35  Partial parsing: added file: ecommerce_data_model_dbt://models/data_model/stg_tracks.sql
2022-06-28 07:56:35.983293 (Thread-77): 07:56:35  Partial parsing: updated file: ecommerce_data_model_dbt://models/data_model/feat_user_features.sql
2022-06-28 07:56:35.986763 (Thread-77): 07:56:35  1699: static parser successfully parsed data_model/stg_tracks.sql
2022-06-28 07:56:35.988814 (Thread-77): 07:56:35  1699: static parser successfully parsed data_model/feat_user_features.sql
2022-06-28 07:56:36.044200 (Thread-77): 07:56:36  [WARNING]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.ecommerce_data_model_dbt.example

2022-06-28 07:56:36.049071 (Thread-77): 07:56:36  Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'b6c0532a-3544-442c-b6ea-c43ccf94db55', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb780d2e550>]}
2022-06-28 07:56:36.937334 (Thread-78): handling status request
2022-06-28 07:56:36.937720 (Thread-78): 07:56:36  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'b6c0532a-3544-442c-b6ea-c43ccf94db55', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb780cfc1c0>]}
2022-06-28 07:56:36.957148 (Thread-78): sending response (<Response 2679 bytes [200 OK]>) to 10.0.21.58
2022-06-28 07:56:37.041538 (Thread-79): handling status request
2022-06-28 07:56:37.041874 (Thread-79): 07:56:37  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'b6c0532a-3544-442c-b6ea-c43ccf94db55', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb780cfc6d0>]}
2022-06-28 07:56:37.042357 (Thread-79): sending response (<Response 2679 bytes [200 OK]>) to 10.0.21.58
2022-06-28 07:56:40.078571 (Thread-80): handling status request
2022-06-28 07:56:40.078928 (Thread-80): 07:56:40  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'b6c0532a-3544-442c-b6ea-c43ccf94db55', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb780cfc4f0>]}
2022-06-28 07:56:40.079423 (Thread-80): sending response (<Response 2679 bytes [200 OK]>) to 10.0.21.58
2022-06-28 07:56:40.447301 (Thread-81): handling compile_sql request
2022-06-28 07:56:40.447646 (Thread-81): 07:56:40  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'b6c0532a-3544-442c-b6ea-c43ccf94db55', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb780d61490>]}
2022-06-28 07:56:42.816837 (Thread-81): sending response (<Response 138 bytes [200 OK]>) to 10.0.21.58
2022-06-28 07:56:42.841064 (MainThread): 07:56:42  Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '6c8106fb-bfd1-43b4-925c-1ab89d40f225', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6ad65be4f0>]}
2022-06-28 07:56:42.841595 (MainThread): 07:56:42  Found 3 models, 2 tests, 0 snapshots, 0 analyses, 179 macros, 0 operations, 0 seed files, 15 sources, 0 exposures, 0 metrics
2022-06-28 07:56:42.842178 (Thread-1): 07:56:42  Acquiring new snowflake connection "rpc.ecommerce_data_model_dbt.request"
2022-06-28 07:56:42.842305 (Thread-1): 07:56:42  Began compiling node rpc.ecommerce_data_model_dbt.request
2022-06-28 07:56:42.842393 (Thread-1): 07:56:42  Compiling rpc.ecommerce_data_model_dbt.request
2022-06-28 07:56:42.844393 (Thread-1): 07:56:42  finished collecting timing info
2022-06-28 07:56:42.844534 (Thread-1): 07:56:42  Began executing node rpc.ecommerce_data_model_dbt.request
2022-06-28 07:56:42.844637 (Thread-1): 07:56:42  finished collecting timing info
2022-06-28 07:56:43.321628 (Thread-82): handling poll request
2022-06-28 07:56:43.322097 (Thread-82): 07:56:43  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'b6c0532a-3544-442c-b6ea-c43ccf94db55', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb780ccee20>]}
2022-06-28 07:56:43.323265 (Thread-82): sending response (<Response 5627 bytes [200 OK]>) to 10.0.21.58
2022-06-28 07:56:46.718359 (Thread-83): handling status request
2022-06-28 07:56:46.718766 (Thread-83): 07:56:46  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'b6c0532a-3544-442c-b6ea-c43ccf94db55', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb780cce070>]}
2022-06-28 07:56:46.719315 (Thread-83): sending response (<Response 2679 bytes [200 OK]>) to 10.0.21.58
2022-06-28 07:56:47.115019 (Thread-84): handling run_sql request
2022-06-28 07:56:47.115373 (Thread-84): 07:56:47  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'b6c0532a-3544-442c-b6ea-c43ccf94db55', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb780cce8b0>]}
2022-06-28 07:56:49.434255 (Thread-84): sending response (<Response 138 bytes [200 OK]>) to 10.0.21.58
2022-06-28 07:56:49.458605 (MainThread): 07:56:49  Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'a8ade604-ad18-45c9-b3cc-ed8e494cea70', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f09c11be550>]}
2022-06-28 07:56:49.459141 (MainThread): 07:56:49  Found 3 models, 2 tests, 0 snapshots, 0 analyses, 179 macros, 0 operations, 0 seed files, 15 sources, 0 exposures, 0 metrics
2022-06-28 07:56:49.459730 (Thread-1): 07:56:49  Acquiring new snowflake connection "rpc.ecommerce_data_model_dbt.request"
2022-06-28 07:56:49.459903 (Thread-1): 07:56:49  Began compiling node rpc.ecommerce_data_model_dbt.request
2022-06-28 07:56:49.460039 (Thread-1): 07:56:49  Compiling rpc.ecommerce_data_model_dbt.request
2022-06-28 07:56:49.462510 (Thread-1): 07:56:49  finished collecting timing info
2022-06-28 07:56:49.462641 (Thread-1): 07:56:49  Began executing node rpc.ecommerce_data_model_dbt.request
2022-06-28 07:56:49.463278 (Thread-1): 07:56:49  Using snowflake connection "rpc.ecommerce_data_model_dbt.request"
2022-06-28 07:56:49.463374 (Thread-1): 07:56:49  On rpc.ecommerce_data_model_dbt.request: select user_id, event_type, count(*) from analytics_db.data_apps_simulated.tracks group by 1, 2
limit 500
/* limit added automatically by dbt cloud */
2022-06-28 07:56:49.463496 (Thread-1): 07:56:49  Opening a new connection, currently in state init
2022-06-28 07:56:49.794926 (Thread-85): handling poll request
2022-06-28 07:56:49.795343 (Thread-85): 07:56:49  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'b6c0532a-3544-442c-b6ea-c43ccf94db55', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb780c336a0>]}
2022-06-28 07:56:49.796206 (Thread-85): sending response (<Response 3880 bytes [200 OK]>) to 10.0.21.58
2022-06-28 07:56:50.232240 (Thread-1): 07:56:50  Snowflake adapter: Snowflake query id: 01a53ebc-0602-2c49-0019-8203045bfed2
2022-06-28 07:56:50.232432 (Thread-1): 07:56:50  Snowflake adapter: Snowflake error: 000904 (42000): SQL compilation error: error line 1 at position 16
invalid identifier 'EVENT_TYPE'
2022-06-28 07:56:50.232598 (Thread-1): 07:56:50  finished collecting timing info
2022-06-28 07:56:50.232759 (Thread-1): 07:56:50  On rpc.ecommerce_data_model_dbt.request: Close
2022-06-28 07:56:50.310237 (Thread-1): Got an exception: Database Error
  000904 (42000): SQL compilation error: error line 1 at position 16
  invalid identifier 'EVENT_TYPE'
Traceback (most recent call last):
  File "/usr/local/lib/python3.8/dist-packages/dbt/adapters/snowflake/connections.py", line 206, in exception_handler
    yield
  File "/usr/local/lib/python3.8/dist-packages/dbt/adapters/sql/connections.py", line 74, in add_query
    cursor.execute(sql, bindings)
  File "/usr/local/lib/python3.8/dist-packages/snowflake/connector/cursor.py", line 721, in execute
    Error.errorhandler_wrapper(
  File "/usr/local/lib/python3.8/dist-packages/snowflake/connector/errors.py", line 258, in errorhandler_wrapper
    cursor.errorhandler(connection, cursor, error_class, error_value)
  File "/usr/local/lib/python3.8/dist-packages/snowflake/connector/errors.py", line 188, in default_errorhandler
    raise error_class(
snowflake.connector.errors.ProgrammingError: 000904 (42000): SQL compilation error: error line 1 at position 16
invalid identifier 'EVENT_TYPE'

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/usr/local/lib/python3.8/dist-packages/dbt/task/base.py", line 361, in safe_run
    result = self.compile_and_execute(manifest, ctx)
  File "/usr/local/lib/python3.8/dist-packages/dbt/task/base.py", line 314, in compile_and_execute
    result = self.run(ctx.node, manifest)
  File "/usr/local/lib/python3.8/dist-packages/dbt/task/base.py", line 403, in run
    return self.execute(compiled_node, manifest)
  File "/usr/local/lib/python3.8/dist-packages/dbt_rpc/rpc/node_runners.py", line 90, in execute
    _, execute_result = self.adapter.execute(
  File "/usr/local/lib/python3.8/dist-packages/dbt/adapters/base/impl.py", line 225, in execute
    return self.connections.execute(
  File "/usr/local/lib/python3.8/dist-packages/dbt/adapters/sql/connections.py", line 127, in execute
    _, cursor = self.add_query(sql, auto_begin)
  File "/usr/local/lib/python3.8/dist-packages/dbt/adapters/snowflake/connections.py", line 433, in add_query
    connection, cursor = super().add_query(
  File "/usr/local/lib/python3.8/dist-packages/dbt/adapters/sql/connections.py", line 83, in add_query
    return connection, cursor
  File "/usr/lib/python3.8/contextlib.py", line 131, in __exit__
    self.gen.throw(type, value, traceback)
  File "/usr/local/lib/python3.8/dist-packages/dbt/adapters/snowflake/connections.py", line 223, in exception_handler
    raise DatabaseException(msg)
dbt.exceptions.DatabaseException: Database Error
  000904 (42000): SQL compilation error: error line 1 at position 16
  invalid identifier 'EVENT_TYPE'
2022-06-28 07:56:50.311125 (Thread-1): Got exception RPCException(10003, Database Error, {'type': 'DatabaseException', 'message': "Database Error in rpc request (from remote system)\n  000904 (42000): SQL compilation error: error line 1 at position 16\n  invalid identifier 'EVENT_TYPE'", 'raw_sql': "select user_id, event_type, count(*) from {{ source('ecommerce', 'tracks') }} group by 1, 2\nlimit 500\n/* limit added automatically by dbt cloud */", 'compiled_sql': 'select user_id, event_type, count(*) from analytics_db.data_apps_simulated.tracks group by 1, 2\nlimit 500\n/* limit added automatically by dbt cloud */', 'tags': None}, None)
Traceback (most recent call last):
  File "/usr/local/lib/python3.8/dist-packages/dbt_rpc/task/sql_commands.py", line 147, in _in_thread
    self.node_results.append(runner.safe_run(self.manifest))
  File "/usr/local/lib/python3.8/dist-packages/dbt/task/base.py", line 377, in safe_run
    result = self.error_result(ctx.node, error, started, [])
  File "/usr/local/lib/python3.8/dist-packages/dbt_rpc/rpc/node_runners.py", line 56, in error_result
    raise error
dbt_rpc.rpc.error.RPCException: RPCException(10003, Database Error, {'type': 'DatabaseException', 'message': "Database Error in rpc request (from remote system)\n  000904 (42000): SQL compilation error: error line 1 at position 16\n  invalid identifier 'EVENT_TYPE'", 'raw_sql': "select user_id, event_type, count(*) from {{ source('ecommerce', 'tracks') }} group by 1, 2\nlimit 500\n/* limit added automatically by dbt cloud */", 'compiled_sql': 'select user_id, event_type, count(*) from analytics_db.data_apps_simulated.tracks group by 1, 2\nlimit 500\n/* limit added automatically by dbt cloud */', 'tags': None}, None)
2022-06-28 07:56:51.273036 (Thread-86): handling poll request
2022-06-28 07:56:51.273515 (Thread-86): 07:56:51  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'b6c0532a-3544-442c-b6ea-c43ccf94db55', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb780bd8220>]}
2022-06-28 07:56:51.274396 (Thread-86): sending response (<Response 10458 bytes [200 OK]>) to 10.0.21.58
2022-06-28 07:57:08.679806 (Thread-87): 07:57:08  Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
2022-06-28 07:57:08.680190 (Thread-87): 07:57:08  Partial parsing: updated file: ecommerce_data_model_dbt://models/data_model/stg_tracks.sql
2022-06-28 07:57:08.684044 (Thread-87): 07:57:08  1699: static parser successfully parsed data_model/stg_tracks.sql
2022-06-28 07:57:08.724158 (Thread-87): 07:57:08  [WARNING]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.ecommerce_data_model_dbt.example

2022-06-28 07:57:08.729806 (Thread-87): 07:57:08  Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'b6c0532a-3544-442c-b6ea-c43ccf94db55', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb780affe80>]}
2022-06-28 07:57:09.502802 (Thread-88): handling status request
2022-06-28 07:57:09.503159 (Thread-88): 07:57:09  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'b6c0532a-3544-442c-b6ea-c43ccf94db55', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb780c18310>]}
2022-06-28 07:57:09.503655 (Thread-88): sending response (<Response 2028 bytes [200 OK]>) to 10.0.21.58
2022-06-28 07:57:09.534296 (Thread-89): handling status request
2022-06-28 07:57:09.534580 (Thread-89): 07:57:09  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'b6c0532a-3544-442c-b6ea-c43ccf94db55', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb780c187c0>]}
2022-06-28 07:57:09.534998 (Thread-89): sending response (<Response 2028 bytes [200 OK]>) to 10.0.21.58
2022-06-28 07:57:10.605317 (Thread-90): handling status request
2022-06-28 07:57:10.605708 (Thread-90): 07:57:10  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'b6c0532a-3544-442c-b6ea-c43ccf94db55', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb780da2460>]}
2022-06-28 07:57:10.606205 (Thread-90): sending response (<Response 2028 bytes [200 OK]>) to 10.0.21.58
2022-06-28 07:57:10.981472 (Thread-91): handling run_sql request
2022-06-28 07:57:10.981866 (Thread-91): 07:57:10  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'b6c0532a-3544-442c-b6ea-c43ccf94db55', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb780da5ee0>]}
2022-06-28 07:57:13.267567 (Thread-91): sending response (<Response 138 bytes [200 OK]>) to 10.0.21.58
2022-06-28 07:57:13.292016 (MainThread): 07:57:13  Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '9b8c0081-2474-475b-9dc4-78e8e53f4445', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd193bbe5b0>]}
2022-06-28 07:57:13.292527 (MainThread): 07:57:13  Found 3 models, 2 tests, 0 snapshots, 0 analyses, 179 macros, 0 operations, 0 seed files, 15 sources, 0 exposures, 0 metrics
2022-06-28 07:57:13.293112 (Thread-1): 07:57:13  Acquiring new snowflake connection "rpc.ecommerce_data_model_dbt.request"
2022-06-28 07:57:13.293240 (Thread-1): 07:57:13  Began compiling node rpc.ecommerce_data_model_dbt.request
2022-06-28 07:57:13.293331 (Thread-1): 07:57:13  Compiling rpc.ecommerce_data_model_dbt.request
2022-06-28 07:57:13.295372 (Thread-1): 07:57:13  finished collecting timing info
2022-06-28 07:57:13.295497 (Thread-1): 07:57:13  Began executing node rpc.ecommerce_data_model_dbt.request
2022-06-28 07:57:13.296062 (Thread-1): 07:57:13  Using snowflake connection "rpc.ecommerce_data_model_dbt.request"
2022-06-28 07:57:13.296150 (Thread-1): 07:57:13  On rpc.ecommerce_data_model_dbt.request: select user_id, event_text, count(*) from analytics_db.data_apps_simulated.tracks group by 1, 2
limit 500
/* limit added automatically by dbt cloud */
2022-06-28 07:57:13.296229 (Thread-1): 07:57:13  Opening a new connection, currently in state init
2022-06-28 07:57:13.714246 (Thread-92): handling poll request
2022-06-28 07:57:13.714698 (Thread-92): 07:57:13  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'b6c0532a-3544-442c-b6ea-c43ccf94db55', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb78b82d880>]}
2022-06-28 07:57:13.715624 (Thread-92): sending response (<Response 3880 bytes [200 OK]>) to 10.0.21.58
2022-06-28 07:57:15.109299 (Thread-93): handling poll request
2022-06-28 07:57:15.109671 (Thread-93): 07:57:15  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'b6c0532a-3544-442c-b6ea-c43ccf94db55', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb78b82d4f0>]}
2022-06-28 07:57:15.110199 (Thread-93): sending response (<Response 393 bytes [200 OK]>) to 10.0.21.58
2022-06-28 07:57:15.218213 (Thread-1): 07:57:15  SQL status: SUCCESS 42 in 1.92 seconds
2022-06-28 07:57:15.220016 (Thread-1): 07:57:15  finished collecting timing info
2022-06-28 07:57:15.220194 (Thread-1): 07:57:15  On rpc.ecommerce_data_model_dbt.request: Close
2022-06-28 07:57:16.531047 (Thread-94): handling poll request
2022-06-28 07:57:16.531434 (Thread-94): 07:57:16  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'b6c0532a-3544-442c-b6ea-c43ccf94db55', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb780ccef40>]}
2022-06-28 07:57:16.532459 (Thread-94): sending response (<Response 5334 bytes [200 OK]>) to 10.0.21.58
2022-06-28 07:57:23.982061 (Thread-95): 07:57:23  Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
2022-06-28 07:57:23.982472 (Thread-95): 07:57:23  Partial parsing: updated file: ecommerce_data_model_dbt://models/data_model/feat_user_features.sql
2022-06-28 07:57:23.986469 (Thread-95): 07:57:23  1603: static parser failed on data_model/feat_user_features.sql
2022-06-28 07:57:24.332708 (Thread-96): 07:57:24  Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
2022-06-28 07:57:24.333114 (Thread-96): 07:57:24  Partial parsing: updated file: ecommerce_data_model_dbt://models/data_model/feat_user_features.sql
2022-06-28 07:57:24.336790 (Thread-96): 07:57:24  1603: static parser failed on data_model/feat_user_features.sql
2022-06-28 07:57:24.952040 (Thread-97): handling status request
2022-06-28 07:57:24.952414 (Thread-97): 07:57:24  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'b6c0532a-3544-442c-b6ea-c43ccf94db55', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb780affc10>]}
2022-06-28 07:57:24.952934 (Thread-97): sending response (<Response 1302 bytes [200 OK]>) to 10.0.21.58
2022-06-28 07:57:25.108053 (Thread-98): handling status request
2022-06-28 07:57:25.108473 (Thread-98): 07:57:25  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'b6c0532a-3544-442c-b6ea-c43ccf94db55', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb780afe550>]}
2022-06-28 07:57:25.108940 (Thread-98): sending response (<Response 1302 bytes [200 OK]>) to 10.0.21.58
2022-06-28 07:57:25.542219 (Thread-99): handling status request
2022-06-28 07:57:25.542638 (Thread-99): 07:57:25  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'b6c0532a-3544-442c-b6ea-c43ccf94db55', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb780d2e9a0>]}
2022-06-28 07:57:25.543117 (Thread-99): sending response (<Response 1302 bytes [200 OK]>) to 10.0.21.58
2022-06-28 07:57:25.575033 (Thread-100): handling status request
2022-06-28 07:57:25.575344 (Thread-100): 07:57:25  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'b6c0532a-3544-442c-b6ea-c43ccf94db55', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb780affe80>]}
2022-06-28 07:57:25.575729 (Thread-100): sending response (<Response 1302 bytes [200 OK]>) to 10.0.21.58
2022-06-28 07:57:25.658021 (Thread-101): handling status request
2022-06-28 07:57:25.658351 (Thread-101): 07:57:25  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'b6c0532a-3544-442c-b6ea-c43ccf94db55', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb780a32370>]}
2022-06-28 07:57:25.658783 (Thread-101): sending response (<Response 1302 bytes [200 OK]>) to 10.0.21.58
2022-06-28 07:57:25.685938 (Thread-102): handling status request
2022-06-28 07:57:25.686255 (Thread-102): 07:57:25  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'b6c0532a-3544-442c-b6ea-c43ccf94db55', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb780a32190>]}
2022-06-28 07:57:25.686678 (Thread-102): sending response (<Response 1302 bytes [200 OK]>) to 10.0.21.58
2022-06-28 07:57:27.167693 (Thread-103): handling status request
2022-06-28 07:57:27.168050 (Thread-103): 07:57:27  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'b6c0532a-3544-442c-b6ea-c43ccf94db55', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb780a32640>]}
2022-06-28 07:57:27.170039 (Thread-103): sending response (<Response 1302 bytes [200 OK]>) to 10.0.21.58
2022-06-28 07:57:27.535120 (Thread-104): handling run_sql request
2022-06-28 07:57:27.535488 (Thread-104): 07:57:27  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'b6c0532a-3544-442c-b6ea-c43ccf94db55', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb780a31370>]}
2022-06-28 07:57:27.535912 (Thread-104): sending response (<Response 653 bytes [200 OK]>) to 10.0.21.58
2022-06-28 07:57:38.604493 (Thread-105): 07:57:38  Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
2022-06-28 07:57:38.604876 (Thread-105): 07:57:38  Partial parsing: updated file: ecommerce_data_model_dbt://models/data_model/feat_user_features.sql
2022-06-28 07:57:38.608496 (Thread-105): 07:57:38  1603: static parser failed on data_model/feat_user_features.sql
2022-06-28 07:57:38.807617 (Thread-106): 07:57:38  Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
2022-06-28 07:57:38.807969 (Thread-106): 07:57:38  Partial parsing: updated file: ecommerce_data_model_dbt://models/data_model/feat_user_features.sql
2022-06-28 07:57:38.811430 (Thread-106): 07:57:38  1603: static parser failed on data_model/feat_user_features.sql
2022-06-28 07:57:39.439581 (Thread-107): handling status request
2022-06-28 07:57:39.439988 (Thread-107): 07:57:39  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'b6c0532a-3544-442c-b6ea-c43ccf94db55', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb780a4cee0>]}
2022-06-28 07:57:39.440481 (Thread-107): sending response (<Response 1306 bytes [200 OK]>) to 10.0.21.58
2022-06-28 07:57:39.656163 (Thread-108): handling status request
2022-06-28 07:57:39.656525 (Thread-108): 07:57:39  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'b6c0532a-3544-442c-b6ea-c43ccf94db55', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb780a4d070>]}
2022-06-28 07:57:39.656984 (Thread-108): sending response (<Response 1306 bytes [200 OK]>) to 10.0.21.58
2022-06-28 07:57:39.806487 (Thread-109): handling status request
2022-06-28 07:57:39.806834 (Thread-109): 07:57:39  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'b6c0532a-3544-442c-b6ea-c43ccf94db55', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb780a4cb50>]}
2022-06-28 07:57:39.807274 (Thread-109): sending response (<Response 1306 bytes [200 OK]>) to 10.0.21.58
2022-06-28 07:57:39.827276 (Thread-110): handling status request
2022-06-28 07:57:39.827574 (Thread-110): 07:57:39  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'b6c0532a-3544-442c-b6ea-c43ccf94db55', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb780a4ce20>]}
2022-06-28 07:57:39.828018 (Thread-110): sending response (<Response 1306 bytes [200 OK]>) to 10.0.21.58
2022-06-28 07:57:40.554230 (Thread-111): handling status request
2022-06-28 07:57:40.554656 (Thread-111): 07:57:40  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'b6c0532a-3544-442c-b6ea-c43ccf94db55', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb780aa6d30>]}
2022-06-28 07:57:40.555128 (Thread-111): sending response (<Response 1306 bytes [200 OK]>) to 10.0.21.58
2022-06-28 07:57:40.985608 (Thread-112): handling run_sql request
2022-06-28 07:57:40.985985 (Thread-112): 07:57:40  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'b6c0532a-3544-442c-b6ea-c43ccf94db55', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb780a4d3d0>]}
2022-06-28 07:57:41.010528 (Thread-112): sending response (<Response 655 bytes [200 OK]>) to 10.0.21.58
2022-06-28 07:57:46.289087 (Thread-113): 07:57:46  Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
2022-06-28 07:57:46.289473 (Thread-113): 07:57:46  Partial parsing: updated file: ecommerce_data_model_dbt://models/data_model/feat_user_features.sql
2022-06-28 07:57:46.293205 (Thread-113): 07:57:46  1603: static parser failed on data_model/feat_user_features.sql
2022-06-28 07:57:46.517258 (Thread-114): 07:57:46  Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
2022-06-28 07:57:46.517613 (Thread-114): 07:57:46  Partial parsing: updated file: ecommerce_data_model_dbt://models/data_model/feat_user_features.sql
2022-06-28 07:57:46.521274 (Thread-114): 07:57:46  1603: static parser failed on data_model/feat_user_features.sql
2022-06-28 07:57:47.236041 (Thread-115): handling status request
2022-06-28 07:57:47.236429 (Thread-115): 07:57:47  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'b6c0532a-3544-442c-b6ea-c43ccf94db55', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb780a4c400>]}
2022-06-28 07:57:47.236934 (Thread-115): sending response (<Response 1279 bytes [200 OK]>) to 10.0.21.58
2022-06-28 07:57:47.302430 (Thread-116): handling status request
2022-06-28 07:57:47.302787 (Thread-116): 07:57:47  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'b6c0532a-3544-442c-b6ea-c43ccf94db55', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb780a4c940>]}
2022-06-28 07:57:47.303248 (Thread-116): sending response (<Response 1279 bytes [200 OK]>) to 10.0.21.58
2022-06-28 07:57:47.398114 (Thread-117): handling status request
2022-06-28 07:57:47.398490 (Thread-117): 07:57:47  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'b6c0532a-3544-442c-b6ea-c43ccf94db55', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb780a63910>]}
2022-06-28 07:57:47.398967 (Thread-117): sending response (<Response 1279 bytes [200 OK]>) to 10.0.21.58
2022-06-28 07:57:47.465219 (Thread-118): handling status request
2022-06-28 07:57:47.465513 (Thread-118): 07:57:47  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'b6c0532a-3544-442c-b6ea-c43ccf94db55', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb780a63b50>]}
2022-06-28 07:57:47.465980 (Thread-118): sending response (<Response 1279 bytes [200 OK]>) to 10.0.21.58
2022-06-28 07:57:50.325418 (Thread-119): handling status request
2022-06-28 07:57:50.325817 (Thread-119): 07:57:50  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'b6c0532a-3544-442c-b6ea-c43ccf94db55', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb780a63cd0>]}
2022-06-28 07:57:50.326306 (Thread-119): sending response (<Response 1279 bytes [200 OK]>) to 10.0.21.58
2022-06-28 07:57:50.738747 (Thread-120): handling run_sql request
2022-06-28 07:57:50.739110 (Thread-120): 07:57:50  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'b6c0532a-3544-442c-b6ea-c43ccf94db55', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb780a63e20>]}
2022-06-28 07:57:50.739514 (Thread-120): sending response (<Response 601 bytes [200 OK]>) to 10.0.21.58
2022-06-28 07:57:57.452696 (Thread-121): 07:57:57  Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
2022-06-28 07:57:57.453062 (Thread-121): 07:57:57  Partial parsing: updated file: ecommerce_data_model_dbt://models/data_model/feat_user_features.sql
2022-06-28 07:57:57.456552 (Thread-121): 07:57:57  1603: static parser failed on data_model/feat_user_features.sql
2022-06-28 07:57:57.670565 (Thread-122): 07:57:57  Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
2022-06-28 07:57:57.670918 (Thread-122): 07:57:57  Partial parsing: updated file: ecommerce_data_model_dbt://models/data_model/feat_user_features.sql
2022-06-28 07:57:57.674496 (Thread-122): 07:57:57  1603: static parser failed on data_model/feat_user_features.sql
2022-06-28 07:57:58.414412 (Thread-123): handling status request
2022-06-28 07:57:58.414776 (Thread-123): 07:57:58  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'b6c0532a-3544-442c-b6ea-c43ccf94db55', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb780a57580>]}
2022-06-28 07:57:58.415267 (Thread-123): sending response (<Response 1314 bytes [200 OK]>) to 10.0.21.58
2022-06-28 07:57:58.469154 (Thread-124): handling status request
2022-06-28 07:57:58.469512 (Thread-124): 07:57:58  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'b6c0532a-3544-442c-b6ea-c43ccf94db55', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb780a4cb50>]}
2022-06-28 07:57:58.470026 (Thread-124): sending response (<Response 1314 bytes [200 OK]>) to 10.0.21.58
2022-06-28 07:57:58.569779 (Thread-125): handling status request
2022-06-28 07:57:58.570182 (Thread-125): 07:57:58  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'b6c0532a-3544-442c-b6ea-c43ccf94db55', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb7809f7490>]}
2022-06-28 07:57:58.570655 (Thread-125): sending response (<Response 1314 bytes [200 OK]>) to 10.0.21.58
2022-06-28 07:57:58.617238 (Thread-126): handling status request
2022-06-28 07:57:58.617613 (Thread-126): 07:57:58  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'b6c0532a-3544-442c-b6ea-c43ccf94db55', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb7809f7550>]}
2022-06-28 07:57:58.618110 (Thread-126): sending response (<Response 1314 bytes [200 OK]>) to 10.0.21.58
2022-06-28 07:57:58.854460 (Thread-127): handling status request
2022-06-28 07:57:58.854851 (Thread-127): 07:57:58  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'b6c0532a-3544-442c-b6ea-c43ccf94db55', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb7809f7850>]}
2022-06-28 07:57:58.855332 (Thread-127): sending response (<Response 1314 bytes [200 OK]>) to 10.0.21.58
2022-06-28 07:57:59.292226 (Thread-128): handling run_sql request
2022-06-28 07:57:59.292618 (Thread-128): 07:57:59  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'b6c0532a-3544-442c-b6ea-c43ccf94db55', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb780a4c340>]}
2022-06-28 07:57:59.292987 (Thread-128): sending response (<Response 671 bytes [200 OK]>) to 10.0.21.58
2022-06-28 07:58:19.342429 (Thread-129): 07:58:19  Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
2022-06-28 07:58:19.342786 (Thread-129): 07:58:19  Partial parsing: updated file: ecommerce_data_model_dbt://models/data_model/feat_user_features.sql
2022-06-28 07:58:19.346411 (Thread-129): 07:58:19  1699: static parser successfully parsed data_model/feat_user_features.sql
2022-06-28 07:58:19.384815 (Thread-129): 07:58:19  [WARNING]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.ecommerce_data_model_dbt.example

2022-06-28 07:58:19.389688 (Thread-129): 07:58:19  Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'b6c0532a-3544-442c-b6ea-c43ccf94db55', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb780a6df40>]}
2022-06-28 07:58:19.524935 (Thread-130): 07:58:19  Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
2022-06-28 07:58:19.525117 (Thread-130): 07:58:19  Partial parsing enabled, no changes found, skipping parsing
2022-06-28 07:58:19.525433 (Thread-130): 07:58:19  [WARNING]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.ecommerce_data_model_dbt.example

2022-06-28 07:58:19.530758 (Thread-130): 07:58:19  Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'b6c0532a-3544-442c-b6ea-c43ccf94db55', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb780989fa0>]}
2022-06-28 07:58:20.181656 (Thread-131): handling status request
2022-06-28 07:58:20.182108 (Thread-131): 07:58:20  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'b6c0532a-3544-442c-b6ea-c43ccf94db55', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb780aadeb0>]}
2022-06-28 07:58:20.182606 (Thread-131): sending response (<Response 1695 bytes [200 OK]>) to 10.0.21.58
2022-06-28 07:58:20.359353 (Thread-132): handling status request
2022-06-28 07:58:20.359750 (Thread-132): 07:58:20  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'b6c0532a-3544-442c-b6ea-c43ccf94db55', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb780aad490>]}
2022-06-28 07:58:20.360205 (Thread-132): sending response (<Response 1695 bytes [200 OK]>) to 10.0.21.58
2022-06-28 07:58:20.583646 (Thread-133): handling status request
2022-06-28 07:58:20.584002 (Thread-133): 07:58:20  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'b6c0532a-3544-442c-b6ea-c43ccf94db55', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb780aad7c0>]}
2022-06-28 07:58:20.584465 (Thread-133): sending response (<Response 1695 bytes [200 OK]>) to 10.0.21.58
2022-06-28 07:58:20.596982 (Thread-134): handling status request
2022-06-28 07:58:20.597218 (Thread-134): 07:58:20  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'b6c0532a-3544-442c-b6ea-c43ccf94db55', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb780aad100>]}
2022-06-28 07:58:20.597557 (Thread-134): sending response (<Response 1695 bytes [200 OK]>) to 10.0.21.58
2022-06-28 07:58:21.357077 (Thread-135): handling status request
2022-06-28 07:58:21.357445 (Thread-135): 07:58:21  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'b6c0532a-3544-442c-b6ea-c43ccf94db55', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb780aad130>]}
2022-06-28 07:58:21.357951 (Thread-135): sending response (<Response 1695 bytes [200 OK]>) to 10.0.21.58
2022-06-28 07:58:21.717601 (Thread-136): handling run_sql request
2022-06-28 07:58:21.718016 (Thread-136): 07:58:21  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'b6c0532a-3544-442c-b6ea-c43ccf94db55', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb780a630d0>]}
2022-06-28 07:58:24.047984 (Thread-136): sending response (<Response 138 bytes [200 OK]>) to 10.0.21.58
2022-06-28 07:58:24.072818 (MainThread): 07:58:24  Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'a8423302-b941-4c55-8995-1ffd8a75fd6a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1106e99370>]}
2022-06-28 07:58:24.073342 (MainThread): 07:58:24  Found 3 models, 2 tests, 0 snapshots, 0 analyses, 179 macros, 0 operations, 0 seed files, 15 sources, 0 exposures, 0 metrics
2022-06-28 07:58:24.073937 (Thread-1): 07:58:24  Acquiring new snowflake connection "rpc.ecommerce_data_model_dbt.request"
2022-06-28 07:58:24.074064 (Thread-1): 07:58:24  Began compiling node rpc.ecommerce_data_model_dbt.request
2022-06-28 07:58:24.074154 (Thread-1): 07:58:24  Compiling rpc.ecommerce_data_model_dbt.request
2022-06-28 07:58:24.076377 (Thread-1): 07:58:24  finished collecting timing info
2022-06-28 07:58:24.076559 (Thread-1): 07:58:24  Began executing node rpc.ecommerce_data_model_dbt.request
2022-06-28 07:58:24.077113 (Thread-1): 07:58:24  Using snowflake connection "rpc.ecommerce_data_model_dbt.request"
2022-06-28 07:58:24.077205 (Thread-1): 07:58:24  On rpc.ecommerce_data_model_dbt.request: -- unique_key='TIMESTAMP' 
-- ToDo: unique key should be combination of timestamp and user_id.
-- Final table from which the output would be an incremental table with one row per user + run timestamp combination, and the features would correspond to that timestamp. 
select * from ANALYTICS_DB.DBT_ECOMMERCE_DATA_MODEL.stg_tracks
limit 500
/* limit added automatically by dbt cloud */
2022-06-28 07:58:24.077286 (Thread-1): 07:58:24  Opening a new connection, currently in state init
2022-06-28 07:58:24.483434 (Thread-137): handling poll request
2022-06-28 07:58:24.483857 (Thread-137): 07:58:24  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'b6c0532a-3544-442c-b6ea-c43ccf94db55', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb780a53dc0>]}
2022-06-28 07:58:24.484775 (Thread-137): sending response (<Response 4125 bytes [200 OK]>) to 10.0.21.58
2022-06-28 07:58:24.808198 (Thread-1): 07:58:24  Snowflake adapter: Snowflake query id: 01a53ebe-0602-2ca4-0019-8203045c0b2a
2022-06-28 07:58:24.808403 (Thread-1): 07:58:24  Snowflake adapter: Snowflake error: 002003 (02000): SQL compilation error:
Schema 'ANALYTICS_DB.DBT_ECOMMERCE_DATA_MODEL' does not exist or not authorized.
2022-06-28 07:58:24.808562 (Thread-1): 07:58:24  finished collecting timing info
2022-06-28 07:58:24.808733 (Thread-1): 07:58:24  On rpc.ecommerce_data_model_dbt.request: Close
2022-06-28 07:58:24.861833 (Thread-1): Got an exception: Database Error
  002003 (02000): SQL compilation error:
  Schema 'ANALYTICS_DB.DBT_ECOMMERCE_DATA_MODEL' does not exist or not authorized.
Traceback (most recent call last):
  File "/usr/local/lib/python3.8/dist-packages/dbt/adapters/snowflake/connections.py", line 206, in exception_handler
    yield
  File "/usr/local/lib/python3.8/dist-packages/dbt/adapters/sql/connections.py", line 74, in add_query
    cursor.execute(sql, bindings)
  File "/usr/local/lib/python3.8/dist-packages/snowflake/connector/cursor.py", line 721, in execute
    Error.errorhandler_wrapper(
  File "/usr/local/lib/python3.8/dist-packages/snowflake/connector/errors.py", line 258, in errorhandler_wrapper
    cursor.errorhandler(connection, cursor, error_class, error_value)
  File "/usr/local/lib/python3.8/dist-packages/snowflake/connector/errors.py", line 188, in default_errorhandler
    raise error_class(
snowflake.connector.errors.ProgrammingError: 002003 (02000): SQL compilation error:
Schema 'ANALYTICS_DB.DBT_ECOMMERCE_DATA_MODEL' does not exist or not authorized.

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/usr/local/lib/python3.8/dist-packages/dbt/task/base.py", line 361, in safe_run
    result = self.compile_and_execute(manifest, ctx)
  File "/usr/local/lib/python3.8/dist-packages/dbt/task/base.py", line 314, in compile_and_execute
    result = self.run(ctx.node, manifest)
  File "/usr/local/lib/python3.8/dist-packages/dbt/task/base.py", line 403, in run
    return self.execute(compiled_node, manifest)
  File "/usr/local/lib/python3.8/dist-packages/dbt_rpc/rpc/node_runners.py", line 90, in execute
    _, execute_result = self.adapter.execute(
  File "/usr/local/lib/python3.8/dist-packages/dbt/adapters/base/impl.py", line 225, in execute
    return self.connections.execute(
  File "/usr/local/lib/python3.8/dist-packages/dbt/adapters/sql/connections.py", line 127, in execute
    _, cursor = self.add_query(sql, auto_begin)
  File "/usr/local/lib/python3.8/dist-packages/dbt/adapters/snowflake/connections.py", line 433, in add_query
    connection, cursor = super().add_query(
  File "/usr/local/lib/python3.8/dist-packages/dbt/adapters/sql/connections.py", line 83, in add_query
    return connection, cursor
  File "/usr/lib/python3.8/contextlib.py", line 131, in __exit__
    self.gen.throw(type, value, traceback)
  File "/usr/local/lib/python3.8/dist-packages/dbt/adapters/snowflake/connections.py", line 223, in exception_handler
    raise DatabaseException(msg)
dbt.exceptions.DatabaseException: Database Error
  002003 (02000): SQL compilation error:
  Schema 'ANALYTICS_DB.DBT_ECOMMERCE_DATA_MODEL' does not exist or not authorized.
2022-06-28 07:58:24.862777 (Thread-1): Got exception RPCException(10003, Database Error, {'type': 'DatabaseException', 'message': "Database Error in rpc request (from remote system)\n  002003 (02000): SQL compilation error:\n  Schema 'ANALYTICS_DB.DBT_ECOMMERCE_DATA_MODEL' does not exist or not authorized.", 'raw_sql': "{{\n    config(\n        materialized='incremental'\n    )\n}}\n-- unique_key='TIMESTAMP' \n-- ToDo: unique key should be combination of timestamp and user_id.\n-- Final table from which the output would be an incremental table with one row per user + run timestamp combination, and the features would correspond to that timestamp. \nselect * from {{ ref('stg_tracks') }}\nlimit 500\n/* limit added automatically by dbt cloud */", 'compiled_sql': "\n-- unique_key='TIMESTAMP' \n-- ToDo: unique key should be combination of timestamp and user_id.\n-- Final table from which the output would be an incremental table with one row per user + run timestamp combination, and the features would correspond to that timestamp. \nselect * from ANALYTICS_DB.DBT_ECOMMERCE_DATA_MODEL.stg_tracks\nlimit 500\n/* limit added automatically by dbt cloud */", 'tags': None}, None)
Traceback (most recent call last):
  File "/usr/local/lib/python3.8/dist-packages/dbt_rpc/task/sql_commands.py", line 147, in _in_thread
    self.node_results.append(runner.safe_run(self.manifest))
  File "/usr/local/lib/python3.8/dist-packages/dbt/task/base.py", line 377, in safe_run
    result = self.error_result(ctx.node, error, started, [])
  File "/usr/local/lib/python3.8/dist-packages/dbt_rpc/rpc/node_runners.py", line 56, in error_result
    raise error
dbt_rpc.rpc.error.RPCException: RPCException(10003, Database Error, {'type': 'DatabaseException', 'message': "Database Error in rpc request (from remote system)\n  002003 (02000): SQL compilation error:\n  Schema 'ANALYTICS_DB.DBT_ECOMMERCE_DATA_MODEL' does not exist or not authorized.", 'raw_sql': "{{\n    config(\n        materialized='incremental'\n    )\n}}\n-- unique_key='TIMESTAMP' \n-- ToDo: unique key should be combination of timestamp and user_id.\n-- Final table from which the output would be an incremental table with one row per user + run timestamp combination, and the features would correspond to that timestamp. \nselect * from {{ ref('stg_tracks') }}\nlimit 500\n/* limit added automatically by dbt cloud */", 'compiled_sql': "\n-- unique_key='TIMESTAMP' \n-- ToDo: unique key should be combination of timestamp and user_id.\n-- Final table from which the output would be an incremental table with one row per user + run timestamp combination, and the features would correspond to that timestamp. \nselect * from ANALYTICS_DB.DBT_ECOMMERCE_DATA_MODEL.stg_tracks\nlimit 500\n/* limit added automatically by dbt cloud */", 'tags': None}, None)
2022-06-28 07:58:25.861199 (Thread-138): handling poll request
2022-06-28 07:58:25.861554 (Thread-138): 07:58:25  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'b6c0532a-3544-442c-b6ea-c43ccf94db55', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb780a53e80>]}
2022-06-28 07:58:25.862186 (Thread-138): sending response (<Response 12435 bytes [200 OK]>) to 10.0.21.58
2022-06-28 07:58:27.469769 (Thread-139): 07:58:27  Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
2022-06-28 07:58:27.470232 (Thread-139): 07:58:27  Partial parsing: updated file: ecommerce_data_model_dbt://models/data_model/feat_user_features.sql
2022-06-28 07:58:27.474585 (Thread-139): 07:58:27  1699: static parser successfully parsed data_model/feat_user_features.sql
2022-06-28 07:58:27.510717 (Thread-139): 07:58:27  [WARNING]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.ecommerce_data_model_dbt.example

2022-06-28 07:58:27.516398 (Thread-139): 07:58:27  Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'b6c0532a-3544-442c-b6ea-c43ccf94db55', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb780aeb040>]}
2022-06-28 07:58:27.676359 (Thread-140): 07:58:27  Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
2022-06-28 07:58:27.676565 (Thread-140): 07:58:27  Partial parsing enabled, no changes found, skipping parsing
2022-06-28 07:58:27.676948 (Thread-140): 07:58:27  [WARNING]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.ecommerce_data_model_dbt.example

2022-06-28 07:58:27.683022 (Thread-140): 07:58:27  Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'b6c0532a-3544-442c-b6ea-c43ccf94db55', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb7808bb790>]}
2022-06-28 07:58:28.280994 (Thread-141): handling status request
2022-06-28 07:58:28.281388 (Thread-141): 07:58:28  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'b6c0532a-3544-442c-b6ea-c43ccf94db55', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb7809f2d60>]}
2022-06-28 07:58:28.281945 (Thread-141): sending response (<Response 1695 bytes [200 OK]>) to 10.0.21.58
2022-06-28 07:58:28.428207 (Thread-142): handling status request
2022-06-28 07:58:28.428559 (Thread-142): 07:58:28  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'b6c0532a-3544-442c-b6ea-c43ccf94db55', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb7809f2a90>]}
2022-06-28 07:58:28.429054 (Thread-142): sending response (<Response 1695 bytes [200 OK]>) to 10.0.21.58
2022-06-28 07:58:28.552213 (Thread-143): handling status request
2022-06-28 07:58:28.552572 (Thread-143): 07:58:28  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'b6c0532a-3544-442c-b6ea-c43ccf94db55', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb7809f25e0>]}
2022-06-28 07:58:28.553050 (Thread-143): sending response (<Response 1695 bytes [200 OK]>) to 10.0.21.58
2022-06-28 07:58:28.566795 (Thread-144): handling status request
2022-06-28 07:58:28.567097 (Thread-144): 07:58:28  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'b6c0532a-3544-442c-b6ea-c43ccf94db55', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb7809f27c0>]}
2022-06-28 07:58:28.567525 (Thread-144): sending response (<Response 1695 bytes [200 OK]>) to 10.0.21.58
2022-06-28 07:58:32.197201 (Thread-145): handling status request
2022-06-28 07:58:32.197561 (Thread-145): 07:58:32  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'b6c0532a-3544-442c-b6ea-c43ccf94db55', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb7809f2820>]}
2022-06-28 07:58:32.198067 (Thread-145): sending response (<Response 1695 bytes [200 OK]>) to 10.0.21.58
2022-06-28 07:58:32.607105 (Thread-146): handling run_sql request
2022-06-28 07:58:32.607464 (Thread-146): 07:58:32  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'b6c0532a-3544-442c-b6ea-c43ccf94db55', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb7809f2c70>]}
2022-06-28 07:58:35.071991 (Thread-146): sending response (<Response 138 bytes [200 OK]>) to 10.0.21.58
2022-06-28 07:58:35.097300 (MainThread): 07:58:35  Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '02a93d29-1806-4232-ae52-80301096dd4e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f85d55a7bb0>]}
2022-06-28 07:58:35.097873 (MainThread): 07:58:35  Found 3 models, 2 tests, 0 snapshots, 0 analyses, 179 macros, 0 operations, 0 seed files, 15 sources, 0 exposures, 0 metrics
2022-06-28 07:58:35.098483 (Thread-1): 07:58:35  Acquiring new snowflake connection "rpc.ecommerce_data_model_dbt.request"
2022-06-28 07:58:35.098615 (Thread-1): 07:58:35  Began compiling node rpc.ecommerce_data_model_dbt.request
2022-06-28 07:58:35.098706 (Thread-1): 07:58:35  Compiling rpc.ecommerce_data_model_dbt.request
2022-06-28 07:58:35.100767 (Thread-1): 07:58:35  finished collecting timing info
2022-06-28 07:58:35.100899 (Thread-1): 07:58:35  Began executing node rpc.ecommerce_data_model_dbt.request
2022-06-28 07:58:35.101467 (Thread-1): 07:58:35  Using snowflake connection "rpc.ecommerce_data_model_dbt.request"
2022-06-28 07:58:35.101566 (Thread-1): 07:58:35  On rpc.ecommerce_data_model_dbt.request: select user_id, event_text, count(*) from analytics_db.data_apps_simulated.tracks group by 1, 2
limit 500
/* limit added automatically by dbt cloud */
2022-06-28 07:58:35.101647 (Thread-1): 07:58:35  Opening a new connection, currently in state init
2022-06-28 07:58:35.450828 (Thread-147): handling poll request
2022-06-28 07:58:35.451241 (Thread-147): 07:58:35  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'b6c0532a-3544-442c-b6ea-c43ccf94db55', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb780a89730>]}
2022-06-28 07:58:35.452098 (Thread-147): sending response (<Response 3880 bytes [200 OK]>) to 10.0.21.58
2022-06-28 07:58:35.783385 (Thread-1): 07:58:35  SQL status: SUCCESS 42 in 0.68 seconds
2022-06-28 07:58:35.785209 (Thread-1): 07:58:35  finished collecting timing info
2022-06-28 07:58:35.785396 (Thread-1): 07:58:35  On rpc.ecommerce_data_model_dbt.request: Close
2022-06-28 07:58:36.894447 (Thread-148): handling poll request
2022-06-28 07:58:36.894796 (Thread-148): 07:58:36  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'b6c0532a-3544-442c-b6ea-c43ccf94db55', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb78098a220>]}
2022-06-28 07:58:36.895773 (Thread-148): sending response (<Response 5333 bytes [200 OK]>) to 10.0.21.58
2022-06-28 07:58:52.166023 (Thread-149): handling status request
2022-06-28 07:58:52.166381 (Thread-149): 07:58:52  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'b6c0532a-3544-442c-b6ea-c43ccf94db55', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb78098a2b0>]}
2022-06-28 07:58:52.166888 (Thread-149): sending response (<Response 1673 bytes [200 OK]>) to 10.0.21.58
2022-06-28 07:58:52.170582 (Thread-150): handling status request
2022-06-28 07:58:52.170827 (Thread-150): 07:58:52  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'b6c0532a-3544-442c-b6ea-c43ccf94db55', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb78097fca0>]}
2022-06-28 07:58:52.171182 (Thread-150): sending response (<Response 1673 bytes [200 OK]>) to 10.0.21.58
2022-06-28 07:58:52.233733 (Thread-151): handling list request
2022-06-28 07:58:52.234164 (Thread-151): 07:58:52  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'b6c0532a-3544-442c-b6ea-c43ccf94db55', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb780983520>]}
2022-06-28 07:58:52.237722 (Thread-152): handling list request
2022-06-28 07:58:52.238256 (Thread-152): 07:58:52  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'b6c0532a-3544-442c-b6ea-c43ccf94db55', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb7809841f0>]}
2022-06-28 07:58:52.267508 (Thread-152): 07:58:52  Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'b6c0532a-3544-442c-b6ea-c43ccf94db55', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb780d286d0>]}
2022-06-28 07:58:52.267918 (Thread-152): 07:58:52  Found 3 models, 2 tests, 0 snapshots, 0 analyses, 179 macros, 0 operations, 0 seed files, 15 sources, 0 exposures, 0 metrics
2022-06-28 07:58:52.273847 (Thread-152): sending response (<Response 2668 bytes [200 OK]>) to 10.0.21.58
2022-06-28 07:58:52.292496 (Thread-151): 07:58:52  Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'b6c0532a-3544-442c-b6ea-c43ccf94db55', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb780983670>]}
2022-06-28 07:58:52.292747 (Thread-151): 07:58:52  Found 3 models, 2 tests, 0 snapshots, 0 analyses, 179 macros, 0 operations, 0 seed files, 15 sources, 0 exposures, 0 metrics
2022-06-28 07:58:52.295296 (Thread-151): sending response (<Response 3224 bytes [200 OK]>) to 10.0.21.58
2022-06-28 07:58:55.172354 (Thread-153): 07:58:55  Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
2022-06-28 07:58:55.172548 (Thread-153): 07:58:55  Partial parsing enabled, no changes found, skipping parsing
2022-06-28 07:58:55.172965 (Thread-153): 07:58:55  [WARNING]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.ecommerce_data_model_dbt.example

2022-06-28 07:58:55.178988 (Thread-153): 07:58:55  Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'b6c0532a-3544-442c-b6ea-c43ccf94db55', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb780a5baf0>]}
2022-06-28 07:58:55.971311 (Thread-154): handling status request
2022-06-28 07:58:55.971674 (Thread-154): 07:58:55  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'b6c0532a-3544-442c-b6ea-c43ccf94db55', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb7808bda30>]}
2022-06-28 07:58:55.972208 (Thread-154): sending response (<Response 1695 bytes [200 OK]>) to 10.0.21.58
2022-06-28 07:58:56.183496 (Thread-155): handling status request
2022-06-28 07:58:56.183858 (Thread-155): 07:58:56  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'b6c0532a-3544-442c-b6ea-c43ccf94db55', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb7808bdc10>]}
2022-06-28 07:58:56.184331 (Thread-155): sending response (<Response 1695 bytes [200 OK]>) to 10.0.21.58
2022-06-28 07:59:00.968156 (Thread-156): 07:59:00  Partial parsing enabled: 1 files deleted, 0 files added, 0 files changed.
2022-06-28 07:59:00.968434 (Thread-156): 07:59:00  Partial parsing: deleted file: ecommerce_data_model_dbt://models/data_model/my_first_dbt_model.sql
2022-06-28 07:59:00.973229 (Thread-156): 07:59:00  [WARNING]: Did not find matching node for patch with name 'my_first_dbt_model' in the 'models' section of file 'models/data_model/schema.yml'
2022-06-28 07:59:00.977505 (Thread-156): 07:59:00  [WARNING]: Test 'test.ecommerce_data_model_dbt.unique_my_first_dbt_model_id.16e066b321' (models/data_model/schema.yml) depends on a node named 'my_first_dbt_model' which was not found
2022-06-28 07:59:00.977751 (Thread-156): 07:59:00  [WARNING]: Test 'test.ecommerce_data_model_dbt.not_null_my_first_dbt_model_id.5fb22c2710' (models/data_model/schema.yml) depends on a node named 'my_first_dbt_model' which was not found
2022-06-28 07:59:01.019600 (Thread-156): 07:59:01  [WARNING]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.ecommerce_data_model_dbt.example

2022-06-28 07:59:01.024333 (Thread-156): 07:59:01  Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'b6c0532a-3544-442c-b6ea-c43ccf94db55', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb780a47f40>]}
2022-06-28 07:59:01.828916 (Thread-157): handling status request
2022-06-28 07:59:01.829308 (Thread-157): 07:59:01  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'b6c0532a-3544-442c-b6ea-c43ccf94db55', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb7809ae2e0>]}
2022-06-28 07:59:01.829845 (Thread-157): sending response (<Response 3032 bytes [200 OK]>) to 10.0.21.58
2022-06-28 07:59:01.863390 (Thread-158): handling status request
2022-06-28 07:59:01.863735 (Thread-158): 07:59:01  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'b6c0532a-3544-442c-b6ea-c43ccf94db55', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb780aa7ac0>]}
2022-06-28 07:59:01.864223 (Thread-158): sending response (<Response 3032 bytes [200 OK]>) to 10.0.21.58
2022-06-28 07:59:01.893620 (Thread-159): handling status request
2022-06-28 07:59:01.894002 (Thread-159): 07:59:01  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'b6c0532a-3544-442c-b6ea-c43ccf94db55', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb7809ae9d0>]}
2022-06-28 07:59:01.894499 (Thread-159): sending response (<Response 3010 bytes [200 OK]>) to 10.0.21.58
2022-06-28 07:59:01.901205 (Thread-160): handling list request
2022-06-28 07:59:01.901455 (Thread-160): 07:59:01  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'b6c0532a-3544-442c-b6ea-c43ccf94db55', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb7809ae190>]}
2022-06-28 07:59:01.933114 (Thread-160): 07:59:01  Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'b6c0532a-3544-442c-b6ea-c43ccf94db55', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb7809add30>]}
2022-06-28 07:59:01.933450 (Thread-160): 07:59:01  Found 2 models, 0 tests, 0 snapshots, 0 analyses, 179 macros, 0 operations, 0 seed files, 15 sources, 0 exposures, 0 metrics
2022-06-28 07:59:01.936030 (Thread-160): sending response (<Response 2668 bytes [200 OK]>) to 10.0.21.58
2022-06-28 07:59:12.060177 (Thread-161): handling status request
2022-06-28 07:59:12.060592 (Thread-161): 07:59:12  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'b6c0532a-3544-442c-b6ea-c43ccf94db55', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb7809ae760>]}
2022-06-28 07:59:12.061122 (Thread-161): sending response (<Response 3010 bytes [200 OK]>) to 10.0.21.58
2022-06-28 07:59:12.090174 (Thread-162): handling list request
2022-06-28 07:59:12.090436 (Thread-162): 07:59:12  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'b6c0532a-3544-442c-b6ea-c43ccf94db55', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb78098df40>]}
2022-06-28 07:59:12.123662 (Thread-162): 07:59:12  Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'b6c0532a-3544-442c-b6ea-c43ccf94db55', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb7809aea00>]}
2022-06-28 07:59:12.123948 (Thread-162): 07:59:12  Found 2 models, 0 tests, 0 snapshots, 0 analyses, 179 macros, 0 operations, 0 seed files, 15 sources, 0 exposures, 0 metrics
2022-06-28 07:59:12.126382 (Thread-162): sending response (<Response 2668 bytes [200 OK]>) to 10.0.21.58
2022-06-28 07:59:31.045518 (Thread-163): 07:59:31  Partial parsing enabled: 0 files deleted, 1 files added, 0 files changed.
2022-06-28 07:59:31.045899 (Thread-163): 07:59:31  Partial parsing: added file: ecommerce_data_model_dbt://models/data_model/products_viewed.sql
2022-06-28 07:59:31.049658 (Thread-163): 07:59:31  1699: static parser successfully parsed data_model/products_viewed.sql
2022-06-28 07:59:31.090790 (Thread-163): 07:59:31  [WARNING]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.ecommerce_data_model_dbt.example

2022-06-28 07:59:31.096215 (Thread-163): 07:59:31  Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'b6c0532a-3544-442c-b6ea-c43ccf94db55', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb732fac400>]}
2022-06-28 07:59:31.938905 (Thread-164): handling status request
2022-06-28 07:59:31.939328 (Thread-164): 07:59:31  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'b6c0532a-3544-442c-b6ea-c43ccf94db55', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb7808c7bb0>]}
2022-06-28 07:59:31.939822 (Thread-164): sending response (<Response 2041 bytes [200 OK]>) to 10.0.21.58
2022-06-28 07:59:32.018155 (Thread-165): handling status request
2022-06-28 07:59:32.018516 (Thread-165): 07:59:32  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'b6c0532a-3544-442c-b6ea-c43ccf94db55', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb780a5b460>]}
2022-06-28 07:59:32.018989 (Thread-165): sending response (<Response 2041 bytes [200 OK]>) to 10.0.21.58
2022-06-28 07:59:42.963955 (Thread-166): 07:59:42  Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
2022-06-28 07:59:42.964330 (Thread-166): 07:59:42  Partial parsing: updated file: ecommerce_data_model_dbt://models/data_model/products_viewed.sql
2022-06-28 07:59:42.967900 (Thread-166): 07:59:42  1699: static parser successfully parsed data_model/products_viewed.sql
2022-06-28 07:59:43.001578 (Thread-166): 07:59:43  [WARNING]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.ecommerce_data_model_dbt.example

2022-06-28 07:59:43.006574 (Thread-166): 07:59:43  Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'b6c0532a-3544-442c-b6ea-c43ccf94db55', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb732f3baf0>]}
2022-06-28 07:59:43.166906 (Thread-167): 07:59:43  Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
2022-06-28 07:59:43.167082 (Thread-167): 07:59:43  Partial parsing enabled, no changes found, skipping parsing
2022-06-28 07:59:43.167400 (Thread-167): 07:59:43  [WARNING]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.ecommerce_data_model_dbt.example

2022-06-28 07:59:43.172236 (Thread-167): 07:59:43  Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'b6c0532a-3544-442c-b6ea-c43ccf94db55', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb732e87f40>]}
2022-06-28 07:59:43.790582 (Thread-168): handling status request
2022-06-28 07:59:43.790939 (Thread-168): 07:59:43  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'b6c0532a-3544-442c-b6ea-c43ccf94db55', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb732f1d430>]}
2022-06-28 07:59:43.791426 (Thread-168): sending response (<Response 1695 bytes [200 OK]>) to 10.0.21.58
2022-06-28 07:59:44.020577 (Thread-169): handling status request
2022-06-28 07:59:44.020948 (Thread-169): 07:59:44  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'b6c0532a-3544-442c-b6ea-c43ccf94db55', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb732f1d250>]}
2022-06-28 07:59:44.021421 (Thread-169): sending response (<Response 1695 bytes [200 OK]>) to 10.0.21.58
2022-06-28 07:59:44.148871 (Thread-170): handling status request
2022-06-28 07:59:44.149243 (Thread-170): 07:59:44  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'b6c0532a-3544-442c-b6ea-c43ccf94db55', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb732f11ee0>]}
2022-06-28 07:59:44.149717 (Thread-170): sending response (<Response 1695 bytes [200 OK]>) to 10.0.21.58
2022-06-28 07:59:44.210834 (Thread-171): handling status request
2022-06-28 07:59:44.211198 (Thread-171): 07:59:44  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'b6c0532a-3544-442c-b6ea-c43ccf94db55', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb732f11d00>]}
2022-06-28 07:59:44.211663 (Thread-171): sending response (<Response 1695 bytes [200 OK]>) to 10.0.21.58
2022-06-28 07:59:45.764440 (Thread-172): 07:59:45  Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
2022-06-28 07:59:45.764831 (Thread-172): 07:59:45  Partial parsing: updated file: ecommerce_data_model_dbt://models/data_model/products_viewed.sql
2022-06-28 07:59:45.768401 (Thread-172): 07:59:45  1699: static parser successfully parsed data_model/products_viewed.sql
2022-06-28 07:59:45.806278 (Thread-172): 07:59:45  [WARNING]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.ecommerce_data_model_dbt.example

2022-06-28 07:59:45.811238 (Thread-172): 07:59:45  Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'b6c0532a-3544-442c-b6ea-c43ccf94db55', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb780a703a0>]}
2022-06-28 07:59:46.439129 (Thread-173): handling status request
2022-06-28 07:59:46.439484 (Thread-173): 07:59:46  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'b6c0532a-3544-442c-b6ea-c43ccf94db55', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb732e7e0d0>]}
2022-06-28 07:59:46.439962 (Thread-173): sending response (<Response 2043 bytes [200 OK]>) to 10.0.21.58
2022-06-28 07:59:46.441439 (Thread-174): handling status request
2022-06-28 07:59:46.441678 (Thread-174): 07:59:46  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'b6c0532a-3544-442c-b6ea-c43ccf94db55', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb732f39ee0>]}
2022-06-28 07:59:46.442070 (Thread-174): sending response (<Response 2043 bytes [200 OK]>) to 10.0.21.58
2022-06-28 08:00:05.613446 (Thread-175): 08:00:05  Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
2022-06-28 08:00:05.613863 (Thread-175): 08:00:05  Partial parsing: updated file: ecommerce_data_model_dbt://models/data_model/products_viewed.sql
2022-06-28 08:00:05.617661 (Thread-175): 08:00:05  1699: static parser successfully parsed data_model/products_viewed.sql
2022-06-28 08:00:05.656817 (Thread-175): 08:00:05  [WARNING]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.ecommerce_data_model_dbt.example

2022-06-28 08:00:05.662419 (Thread-175): 08:00:05  Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'b6c0532a-3544-442c-b6ea-c43ccf94db55', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb780da2af0>]}
2022-06-28 08:00:06.436589 (Thread-176): handling status request
2022-06-28 08:00:06.436964 (Thread-176): 08:00:06  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'b6c0532a-3544-442c-b6ea-c43ccf94db55', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb732f28d30>]}
2022-06-28 08:00:06.437463 (Thread-176): sending response (<Response 2043 bytes [200 OK]>) to 10.0.21.58
2022-06-28 08:00:06.538597 (Thread-177): handling status request
2022-06-28 08:00:06.539001 (Thread-177): 08:00:06  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'b6c0532a-3544-442c-b6ea-c43ccf94db55', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb732f282e0>]}
2022-06-28 08:00:06.539485 (Thread-177): sending response (<Response 2043 bytes [200 OK]>) to 10.0.21.58
2022-06-28 08:00:10.044050 (Thread-178): 08:00:10  Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
2022-06-28 08:00:10.044464 (Thread-178): 08:00:10  Partial parsing: updated file: ecommerce_data_model_dbt://models/data_model/products_viewed.sql
2022-06-28 08:00:10.048586 (Thread-178): 08:00:10  1699: static parser successfully parsed data_model/products_viewed.sql
2022-06-28 08:00:10.088102 (Thread-178): 08:00:10  [WARNING]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.ecommerce_data_model_dbt.example

2022-06-28 08:00:10.093670 (Thread-178): 08:00:10  Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'b6c0532a-3544-442c-b6ea-c43ccf94db55', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb780d20eb0>]}
2022-06-28 08:00:10.851646 (Thread-179): handling status request
2022-06-28 08:00:10.852015 (Thread-179): 08:00:10  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'b6c0532a-3544-442c-b6ea-c43ccf94db55', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb780040e50>]}
2022-06-28 08:00:10.852526 (Thread-179): sending response (<Response 2043 bytes [200 OK]>) to 10.0.21.58
2022-06-28 08:00:10.964510 (Thread-180): handling status request
2022-06-28 08:00:10.964891 (Thread-180): 08:00:10  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'b6c0532a-3544-442c-b6ea-c43ccf94db55', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb780040a90>]}
2022-06-28 08:00:10.965379 (Thread-180): sending response (<Response 2043 bytes [200 OK]>) to 10.0.21.58
2022-06-28 08:00:12.055739 (Thread-181): handling status request
2022-06-28 08:00:12.056112 (Thread-181): 08:00:12  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'b6c0532a-3544-442c-b6ea-c43ccf94db55', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb7809a92b0>]}
2022-06-28 08:00:12.056616 (Thread-181): sending response (<Response 2021 bytes [200 OK]>) to 10.0.21.58
2022-06-28 08:00:12.064034 (Thread-182): handling list request
2022-06-28 08:00:12.064275 (Thread-182): 08:00:12  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'b6c0532a-3544-442c-b6ea-c43ccf94db55', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb7809a9220>]}
2022-06-28 08:00:12.127386 (Thread-184): sending response (<Response 214 bytes [200 OK]>) to 10.0.21.58
2022-06-28 08:00:13.482103 (Thread-185): handling status request
2022-06-28 08:00:13.482514 (Thread-185): 08:00:13  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'b6c0532a-3544-442c-b6ea-c43ccf94db55', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb732f773a0>]}
2022-06-28 08:00:13.482990 (Thread-185): sending response (<Response 2021 bytes [200 OK]>) to 10.0.21.58
2022-06-28 08:00:13.489018 (Thread-186): handling list request
2022-06-28 08:00:13.489246 (Thread-186): 08:00:13  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'b6c0532a-3544-442c-b6ea-c43ccf94db55', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb780040040>]}
2022-06-28 08:00:13.525178 (Thread-186): 08:00:13  Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'b6c0532a-3544-442c-b6ea-c43ccf94db55', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb78808a610>]}
2022-06-28 08:00:13.525527 (Thread-186): 08:00:13  Found 3 models, 0 tests, 0 snapshots, 0 analyses, 179 macros, 0 operations, 0 seed files, 15 sources, 0 exposures, 0 metrics
2022-06-28 08:00:13.529428 (Thread-186): sending response (<Response 2076 bytes [200 OK]>) to 10.0.21.58
2022-06-28 08:00:31.210819 (Thread-187): 08:00:31  Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
2022-06-28 08:00:31.211205 (Thread-187): 08:00:31  Partial parsing: updated file: ecommerce_data_model_dbt://models/data_model/feat_user_features.sql
2022-06-28 08:00:31.215786 (Thread-187): 08:00:31  1699: static parser successfully parsed data_model/feat_user_features.sql
2022-06-28 08:00:32.031645 (Thread-188): handling status request
2022-06-28 08:00:32.032025 (Thread-188): 08:00:32  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'b6c0532a-3544-442c-b6ea-c43ccf94db55', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb7bc0e6220>]}
2022-06-28 08:00:32.032515 (Thread-188): sending response (<Response 1418 bytes [200 OK]>) to 10.0.21.58
2022-06-28 08:00:32.238874 (Thread-189): handling status request
2022-06-28 08:00:32.239287 (Thread-189): 08:00:32  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'b6c0532a-3544-442c-b6ea-c43ccf94db55', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb7bc0e64c0>]}
2022-06-28 08:00:32.239768 (Thread-189): sending response (<Response 1418 bytes [200 OK]>) to 10.0.21.58
2022-06-28 08:00:39.273665 (Thread-190): 08:00:39  Partial parsing enabled: 1 files deleted, 1 files added, 1 files changed.
2022-06-28 08:00:39.274031 (Thread-190): 08:00:39  Partial parsing: added file: ecommerce_data_model_dbt://models/data_model/stg_products_viewed.sql
2022-06-28 08:00:39.274142 (Thread-190): 08:00:39  Partial parsing: deleted file: ecommerce_data_model_dbt://models/data_model/products_viewed.sql
2022-06-28 08:00:39.274331 (Thread-190): 08:00:39  Partial parsing: updated file: ecommerce_data_model_dbt://models/data_model/feat_user_features.sql
2022-06-28 08:00:39.279015 (Thread-190): 08:00:39  1699: static parser successfully parsed data_model/stg_products_viewed.sql
2022-06-28 08:00:39.281322 (Thread-190): 08:00:39  1699: static parser successfully parsed data_model/feat_user_features.sql
2022-06-28 08:00:39.315555 (Thread-190): 08:00:39  [WARNING]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.ecommerce_data_model_dbt.example

2022-06-28 08:00:39.323021 (Thread-190): 08:00:39  Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'b6c0532a-3544-442c-b6ea-c43ccf94db55', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb7887ed8e0>]}
2022-06-28 08:00:40.029864 (Thread-191): handling status request
2022-06-28 08:00:40.030289 (Thread-191): 08:00:40  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'b6c0532a-3544-442c-b6ea-c43ccf94db55', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb78870b6a0>]}
2022-06-28 08:00:40.030838 (Thread-191): sending response (<Response 3041 bytes [200 OK]>) to 10.0.21.58
2022-06-28 08:00:40.109599 (Thread-192): handling status request
2022-06-28 08:00:40.110034 (Thread-192): 08:00:40  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'b6c0532a-3544-442c-b6ea-c43ccf94db55', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb780d28100>]}
2022-06-28 08:00:40.110585 (Thread-192): sending response (<Response 3041 bytes [200 OK]>) to 10.0.21.58
2022-06-28 08:00:40.165099 (Thread-193): handling status request
2022-06-28 08:00:40.165507 (Thread-193): 08:00:40  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'b6c0532a-3544-442c-b6ea-c43ccf94db55', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb780a31b50>]}
2022-06-28 08:00:40.166059 (Thread-193): sending response (<Response 3019 bytes [200 OK]>) to 10.0.21.58
2022-06-28 08:00:40.183290 (Thread-194): handling list request
2022-06-28 08:00:40.183581 (Thread-194): 08:00:40  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'b6c0532a-3544-442c-b6ea-c43ccf94db55', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb780d28d30>]}
2022-06-28 08:00:40.210362 (Thread-194): 08:00:40  Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'b6c0532a-3544-442c-b6ea-c43ccf94db55', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb7815c8640>]}
2022-06-28 08:00:40.210693 (Thread-194): 08:00:40  Found 3 models, 0 tests, 0 snapshots, 0 analyses, 179 macros, 0 operations, 0 seed files, 15 sources, 0 exposures, 0 metrics
2022-06-28 08:00:40.213470 (Thread-194): sending response (<Response 3665 bytes [200 OK]>) to 10.0.21.58
2022-06-28 08:00:41.730270 (Thread-195): handling status request
2022-06-28 08:00:41.730634 (Thread-195): 08:00:41  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'b6c0532a-3544-442c-b6ea-c43ccf94db55', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb7815c8040>]}
2022-06-28 08:00:41.731445 (Thread-195): sending response (<Response 3019 bytes [200 OK]>) to 10.0.21.58
2022-06-28 08:00:41.738174 (Thread-196): handling list request
2022-06-28 08:00:41.738440 (Thread-196): 08:00:41  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'b6c0532a-3544-442c-b6ea-c43ccf94db55', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb732f77640>]}
2022-06-28 08:00:41.770129 (Thread-196): 08:00:41  Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'b6c0532a-3544-442c-b6ea-c43ccf94db55', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb780d2eac0>]}
2022-06-28 08:00:41.770410 (Thread-196): 08:00:41  Found 3 models, 0 tests, 0 snapshots, 0 analyses, 179 macros, 0 operations, 0 seed files, 15 sources, 0 exposures, 0 metrics
2022-06-28 08:00:41.772881 (Thread-196): sending response (<Response 2782 bytes [200 OK]>) to 10.0.21.58
2022-06-28 08:00:44.790568 (Thread-197): 08:00:44  Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
2022-06-28 08:00:44.790744 (Thread-197): 08:00:44  Partial parsing enabled, no changes found, skipping parsing
2022-06-28 08:00:44.791061 (Thread-197): 08:00:44  [WARNING]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.ecommerce_data_model_dbt.example

2022-06-28 08:00:44.795891 (Thread-197): 08:00:44  Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'b6c0532a-3544-442c-b6ea-c43ccf94db55', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb732e8da60>]}
2022-06-28 08:00:44.939484 (Thread-198): 08:00:44  Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
2022-06-28 08:00:44.939662 (Thread-198): 08:00:44  Partial parsing enabled, no changes found, skipping parsing
2022-06-28 08:00:44.939985 (Thread-198): 08:00:44  [WARNING]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.ecommerce_data_model_dbt.example

2022-06-28 08:00:44.945339 (Thread-198): 08:00:44  Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'b6c0532a-3544-442c-b6ea-c43ccf94db55', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb730600f40>]}
2022-06-28 08:00:45.621234 (Thread-199): handling status request
2022-06-28 08:00:45.621615 (Thread-199): 08:00:45  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'b6c0532a-3544-442c-b6ea-c43ccf94db55', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb732f77550>]}
2022-06-28 08:00:45.622156 (Thread-199): sending response (<Response 1695 bytes [200 OK]>) to 10.0.21.58
2022-06-28 08:00:45.758867 (Thread-200): handling status request
2022-06-28 08:00:45.759230 (Thread-200): 08:00:45  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'b6c0532a-3544-442c-b6ea-c43ccf94db55', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb78870b6a0>]}
2022-06-28 08:00:45.759736 (Thread-200): sending response (<Response 1695 bytes [200 OK]>) to 10.0.21.58
2022-06-28 08:00:45.931199 (Thread-201): handling status request
2022-06-28 08:00:45.931570 (Thread-201): 08:00:45  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'b6c0532a-3544-442c-b6ea-c43ccf94db55', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb78870bf40>]}
2022-06-28 08:00:45.932031 (Thread-201): sending response (<Response 1695 bytes [200 OK]>) to 10.0.21.58
2022-06-28 08:00:45.964051 (Thread-202): handling status request
2022-06-28 08:00:45.964376 (Thread-202): 08:00:45  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'b6c0532a-3544-442c-b6ea-c43ccf94db55', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb78870bee0>]}
2022-06-28 08:00:45.964838 (Thread-202): sending response (<Response 1695 bytes [200 OK]>) to 10.0.21.58
2022-06-28 08:40:59.717591 (Thread-203): handling status request
2022-06-28 08:40:59.717996 (Thread-203): 08:40:59  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'b6c0532a-3544-442c-b6ea-c43ccf94db55', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb780d08df0>]}
2022-06-28 08:40:59.718466 (Thread-203): sending response (<Response 1695 bytes [200 OK]>) to 10.0.21.58
2022-06-28 08:40:59.773707 (Thread-204): handling status request
2022-06-28 08:40:59.774077 (Thread-204): 08:40:59  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'b6c0532a-3544-442c-b6ea-c43ccf94db55', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb780d082e0>]}
2022-06-28 08:40:59.774519 (Thread-204): sending response (<Response 1695 bytes [200 OK]>) to 10.0.21.58
2022-06-28 08:40:59.823062 (Thread-205): handling ps request
2022-06-28 08:40:59.823314 (Thread-205): 08:40:59  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'b6c0532a-3544-442c-b6ea-c43ccf94db55', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb780d08760>]}
2022-06-28 08:40:59.824088 (Thread-205): sending response (<Response 5737 bytes [200 OK]>) to 10.0.21.58
2022-06-28 08:40:59.881464 (Thread-206): handling status request
2022-06-28 08:40:59.881706 (Thread-206): 08:40:59  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'b6c0532a-3544-442c-b6ea-c43ccf94db55', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb732f200d0>]}
2022-06-28 08:40:59.882111 (Thread-206): sending response (<Response 1695 bytes [200 OK]>) to 10.0.21.58
2022-06-28 08:41:01.657974 (Thread-207): handling status request
2022-06-28 08:41:01.658336 (Thread-207): 08:41:01  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'b6c0532a-3544-442c-b6ea-c43ccf94db55', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb780c03cd0>]}
2022-06-28 08:41:01.658801 (Thread-207): sending response (<Response 1673 bytes [200 OK]>) to 10.0.21.58
2022-06-28 08:41:01.666524 (Thread-208): handling list request
2022-06-28 08:41:01.666776 (Thread-208): 08:41:01  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'b6c0532a-3544-442c-b6ea-c43ccf94db55', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb780b72520>]}
2022-06-28 08:41:01.701220 (Thread-208): 08:41:01  Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'b6c0532a-3544-442c-b6ea-c43ccf94db55', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb780d11880>]}
2022-06-28 08:41:01.701867 (Thread-208): 08:41:01  Found 3 models, 0 tests, 0 snapshots, 0 analyses, 179 macros, 0 operations, 0 seed files, 15 sources, 0 exposures, 0 metrics
2022-06-28 08:41:01.704476 (Thread-208): sending response (<Response 3665 bytes [200 OK]>) to 10.0.21.58
2022-06-28 08:41:01.824933 (Thread-209): handling status request
2022-06-28 08:41:01.825305 (Thread-209): 08:41:01  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'b6c0532a-3544-442c-b6ea-c43ccf94db55', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb780d08190>]}
2022-06-28 08:41:01.825777 (Thread-209): sending response (<Response 1695 bytes [200 OK]>) to 10.0.21.58
2022-06-28 08:41:55.559804 (Thread-210): handling status request
2022-06-28 08:41:55.560166 (Thread-210): 08:41:55  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'b6c0532a-3544-442c-b6ea-c43ccf94db55', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb780d11f70>]}
2022-06-28 08:41:55.560625 (Thread-210): sending response (<Response 1673 bytes [200 OK]>) to 10.0.21.58
2022-06-28 08:41:55.568781 (Thread-211): handling list request
2022-06-28 08:41:55.569008 (Thread-211): 08:41:55  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'b6c0532a-3544-442c-b6ea-c43ccf94db55', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb780d115e0>]}
2022-06-28 08:41:55.603937 (Thread-211): 08:41:55  Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'b6c0532a-3544-442c-b6ea-c43ccf94db55', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb732e4b220>]}
2022-06-28 08:41:55.604174 (Thread-211): 08:41:55  Found 3 models, 0 tests, 0 snapshots, 0 analyses, 179 macros, 0 operations, 0 seed files, 15 sources, 0 exposures, 0 metrics
2022-06-28 08:41:55.607706 (Thread-211): sending response (<Response 2782 bytes [200 OK]>) to 10.0.21.58
2022-06-28 08:43:29.245192 (Thread-212): handling ps request
2022-06-28 08:43:29.245635 (Thread-212): 08:43:29  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'b6c0532a-3544-442c-b6ea-c43ccf94db55', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb780c03cd0>]}
2022-06-28 08:43:29.246837 (Thread-212): sending response (<Response 6316 bytes [200 OK]>) to 10.0.21.58
2022-06-28 08:43:29.277064 (Thread-213): handling status request
2022-06-28 08:43:29.277326 (Thread-213): 08:43:29  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'b6c0532a-3544-442c-b6ea-c43ccf94db55', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb732e8ddc0>]}
2022-06-28 08:43:29.277733 (Thread-213): sending response (<Response 1695 bytes [200 OK]>) to 10.0.21.58
2022-06-28 08:43:29.285196 (Thread-214): handling status request
2022-06-28 08:43:29.285425 (Thread-214): 08:43:29  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'b6c0532a-3544-442c-b6ea-c43ccf94db55', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb732e8d9a0>]}
2022-06-28 08:43:29.285829 (Thread-214): sending response (<Response 1695 bytes [200 OK]>) to 10.0.21.58
2022-06-28 08:43:29.415140 (Thread-215): handling status request
2022-06-28 08:43:29.415502 (Thread-215): 08:43:29  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'b6c0532a-3544-442c-b6ea-c43ccf94db55', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb780b75e50>]}
2022-06-28 08:43:29.415961 (Thread-215): sending response (<Response 1695 bytes [200 OK]>) to 10.0.21.58
2022-06-28 08:43:31.023669 (Thread-216): handling status request
2022-06-28 08:43:31.024027 (Thread-216): 08:43:31  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'b6c0532a-3544-442c-b6ea-c43ccf94db55', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb732e49160>]}
2022-06-28 08:43:31.024513 (Thread-216): sending response (<Response 1673 bytes [200 OK]>) to 10.0.21.58
2022-06-28 08:43:31.030571 (Thread-217): handling list request
2022-06-28 08:43:31.030869 (Thread-217): 08:43:31  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'b6c0532a-3544-442c-b6ea-c43ccf94db55', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb780c035b0>]}
2022-06-28 08:43:31.122287 (Thread-217): 08:43:31  Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'b6c0532a-3544-442c-b6ea-c43ccf94db55', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb7305fbe20>]}
2022-06-28 08:43:31.122641 (Thread-217): 08:43:31  Found 3 models, 0 tests, 0 snapshots, 0 analyses, 179 macros, 0 operations, 0 seed files, 15 sources, 0 exposures, 0 metrics
2022-06-28 08:43:31.125296 (Thread-217): sending response (<Response 2782 bytes [200 OK]>) to 10.0.21.58
2022-06-28 08:43:31.171312 (Thread-218): handling status request
2022-06-28 08:43:31.171684 (Thread-218): 08:43:31  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'b6c0532a-3544-442c-b6ea-c43ccf94db55', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb7305fb190>]}
2022-06-28 08:43:31.172450 (Thread-218): sending response (<Response 1695 bytes [200 OK]>) to 10.0.21.58
2022-06-28 08:43:42.606961 (Thread-219): handling status request
2022-06-28 08:43:42.607324 (Thread-219): 08:43:42  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'b6c0532a-3544-442c-b6ea-c43ccf94db55', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb7305fbca0>]}
2022-06-28 08:43:42.607811 (Thread-219): sending response (<Response 1673 bytes [200 OK]>) to 10.0.21.58
2022-06-28 08:43:42.666645 (Thread-220): handling list request
2022-06-28 08:43:42.666904 (Thread-220): 08:43:42  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'b6c0532a-3544-442c-b6ea-c43ccf94db55', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb7305fbd90>]}
2022-06-28 08:43:42.695899 (Thread-220): 08:43:42  Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'b6c0532a-3544-442c-b6ea-c43ccf94db55', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb7808ee550>]}
2022-06-28 08:43:42.696169 (Thread-220): 08:43:42  Found 3 models, 0 tests, 0 snapshots, 0 analyses, 179 macros, 0 operations, 0 seed files, 15 sources, 0 exposures, 0 metrics
2022-06-28 08:43:42.700008 (Thread-220): sending response (<Response 3665 bytes [200 OK]>) to 10.0.21.58
2022-06-28 09:12:23.144007 (MainThread): Running with dbt=1.0.8
2022-06-28 09:12:23.422879 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt_rpc.task.server.RPCServerTask'>, debug=None, defer=None, exclude=None, fail_fast=None, host='0.0.0.0', log_cache_events=False, log_format=None, models=None, partial_parse=True, port=8580, printer_width=None, profile='user', profiles_dir='/usr/src/develop/.dbt', project_dir=None, record_timing_info=None, rpc_method=None, send_anonymous_usage_stats=None, single_threaded=False, state=None, static_parser=None, target=None, threads=None, use_colors=None, use_experimental_parser=None, vars='{}', version_check=None, warn_error=None, which='rpc', write_json=None)
2022-06-28 09:12:23.432236 (MainThread): Tracking: tracking
2022-06-28 09:12:23.433415 (MainThread): 09:12:23  Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa92c06f670>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa8ed34c520>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa8ed35eb20>]}
2022-06-28 09:12:23.438926 (MainThread): Serving RPC server at 0.0.0.0:8580, pid=22
2022-06-28 09:12:23.439330 (MainThread): Supported methods: ['build', 'cli_args', 'compile', 'compile_sql', 'deps', 'docs.generate', 'gc', 'get-manifest', 'kill', 'list', 'poll', 'ps', 'run', 'run-operation', 'run_sql', 'seed', 'snapshot', 'snapshot-freshness', 'source-freshness', 'status', 'test']
2022-06-28 09:12:23.439503 (MainThread): Send requests to http://localhost:8580/jsonrpc
2022-06-28 09:12:23.506699 (Thread-12): 09:12:23  Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
2022-06-28 09:12:23.506940 (Thread-12): 09:12:23  Partial parsing enabled, no changes found, skipping parsing
2022-06-28 09:12:23.507440 (Thread-12): 09:12:23  [WARNING]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.ecommerce_data_model_dbt.example

2022-06-28 09:12:23.514005 (Thread-12): 09:12:23  Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '6e9d0c3d-4c5a-4c24-aea8-f0dbcfecdbb9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa8ed237d90>]}
2022-06-28 09:12:25.583133 (Thread-13): handling ps request
2022-06-28 09:12:25.583567 (Thread-13): 09:12:25  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '6e9d0c3d-4c5a-4c24-aea8-f0dbcfecdbb9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa8ed2a4ee0>]}
2022-06-28 09:12:25.584211 (Thread-13): sending response (<Response 105 bytes [200 OK]>) to 10.0.36.93
2022-06-28 09:12:25.821554 (Thread-14): handling status request
2022-06-28 09:12:25.822168 (Thread-14): 09:12:25  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '6e9d0c3d-4c5a-4c24-aea8-f0dbcfecdbb9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa8ed2a4d60>]}
2022-06-28 09:12:25.822937 (Thread-14): sending response (<Response 1691 bytes [200 OK]>) to 10.0.36.93
2022-06-28 09:12:26.018521 (Thread-15): handling status request
2022-06-28 09:12:26.018965 (Thread-15): 09:12:26  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '6e9d0c3d-4c5a-4c24-aea8-f0dbcfecdbb9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa8ed2a4cd0>]}
2022-06-28 09:12:26.019485 (Thread-15): sending response (<Response 1691 bytes [200 OK]>) to 10.0.36.93
2022-06-28 09:12:26.043831 (Thread-16): handling status request
2022-06-28 09:12:26.044265 (Thread-16): 09:12:26  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '6e9d0c3d-4c5a-4c24-aea8-f0dbcfecdbb9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa8ed35d2e0>]}
2022-06-28 09:12:26.044774 (Thread-16): sending response (<Response 1691 bytes [200 OK]>) to 10.0.36.93
2022-06-28 09:12:27.990444 (Thread-17): handling status request
2022-06-28 09:12:27.990897 (Thread-17): 09:12:27  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '6e9d0c3d-4c5a-4c24-aea8-f0dbcfecdbb9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa8ed35dac0>]}
2022-06-28 09:12:27.991387 (Thread-17): sending response (<Response 1691 bytes [200 OK]>) to 10.0.36.93
2022-06-28 09:12:52.561223 (Thread-18): handling status request
2022-06-28 09:12:52.563113 (Thread-18): 09:12:52  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '6e9d0c3d-4c5a-4c24-aea8-f0dbcfecdbb9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa9267faeb0>]}
2022-06-28 09:12:52.563608 (Thread-18): sending response (<Response 1669 bytes [200 OK]>) to 10.0.36.93
2022-06-28 09:12:52.628248 (Thread-19): handling list request
2022-06-28 09:12:52.628651 (Thread-19): 09:12:52  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '6e9d0c3d-4c5a-4c24-aea8-f0dbcfecdbb9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa8ed322190>]}
2022-06-28 09:12:52.666589 (Thread-19): 09:12:52  Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '6e9d0c3d-4c5a-4c24-aea8-f0dbcfecdbb9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa8ed35d400>]}
2022-06-28 09:12:52.667002 (Thread-19): 09:12:52  Found 3 models, 0 tests, 0 snapshots, 0 analyses, 179 macros, 0 operations, 0 seed files, 15 sources, 0 exposures, 0 metrics
2022-06-28 09:12:52.671820 (Thread-19): sending response (<Response 2720 bytes [200 OK]>) to 10.0.36.93
2022-06-28 09:12:56.447747 (Thread-20): handling status request
2022-06-28 09:12:56.448156 (Thread-20): 09:12:56  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '6e9d0c3d-4c5a-4c24-aea8-f0dbcfecdbb9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa9267faee0>]}
2022-06-28 09:12:56.448636 (Thread-20): sending response (<Response 1669 bytes [200 OK]>) to 10.0.36.93
2022-06-28 09:12:56.474711 (Thread-21): handling list request
2022-06-28 09:12:56.475069 (Thread-21): 09:12:56  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '6e9d0c3d-4c5a-4c24-aea8-f0dbcfecdbb9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa8ed23f610>]}
2022-06-28 09:12:56.515135 (Thread-21): 09:12:56  Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '6e9d0c3d-4c5a-4c24-aea8-f0dbcfecdbb9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa8ec1e6430>]}
2022-06-28 09:12:56.515494 (Thread-21): 09:12:56  Found 3 models, 0 tests, 0 snapshots, 0 analyses, 179 macros, 0 operations, 0 seed files, 15 sources, 0 exposures, 0 metrics
2022-06-28 09:12:56.521439 (Thread-21): sending response (<Response 2780 bytes [200 OK]>) to 10.0.36.93
2022-06-28 09:13:32.960921 (Thread-22): 09:13:32  Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
2022-06-28 09:13:32.962617 (Thread-22): 09:13:32  Partial parsing: updated file: ecommerce_data_model_dbt://models/data_model/stg_products_viewed.sql
2022-06-28 09:13:32.974178 (Thread-22): 09:13:32  1699: static parser successfully parsed data_model/stg_products_viewed.sql
2022-06-28 09:13:33.040245 (Thread-22): 09:13:33  [WARNING]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.ecommerce_data_model_dbt.example

2022-06-28 09:13:33.045749 (Thread-22): 09:13:33  Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '6e9d0c3d-4c5a-4c24-aea8-f0dbcfecdbb9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa8ec0f8c10>]}
2022-06-28 09:13:33.157955 (Thread-23): 09:13:33  Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
2022-06-28 09:13:33.158180 (Thread-23): 09:13:33  Partial parsing enabled, no changes found, skipping parsing
2022-06-28 09:13:33.158589 (Thread-23): 09:13:33  [WARNING]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.ecommerce_data_model_dbt.example

2022-06-28 09:13:33.164292 (Thread-23): 09:13:33  Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '6e9d0c3d-4c5a-4c24-aea8-f0dbcfecdbb9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa8ec06a4f0>]}
2022-06-28 09:13:33.601287 (Thread-24): handling status request
2022-06-28 09:13:33.601728 (Thread-24): 09:13:33  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '6e9d0c3d-4c5a-4c24-aea8-f0dbcfecdbb9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa8ed2d1580>]}
2022-06-28 09:13:33.602242 (Thread-24): sending response (<Response 1669 bytes [200 OK]>) to 10.0.36.93
2022-06-28 09:13:33.611683 (Thread-25): handling list request
2022-06-28 09:13:33.611991 (Thread-25): 09:13:33  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '6e9d0c3d-4c5a-4c24-aea8-f0dbcfecdbb9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa8ed2d16d0>]}
2022-06-28 09:13:33.640644 (Thread-25): 09:13:33  Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '6e9d0c3d-4c5a-4c24-aea8-f0dbcfecdbb9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa8ec17f6d0>]}
2022-06-28 09:13:33.641070 (Thread-25): 09:13:33  Found 3 models, 0 tests, 0 snapshots, 0 analyses, 179 macros, 0 operations, 0 seed files, 15 sources, 0 exposures, 0 metrics
2022-06-28 09:13:33.643930 (Thread-25): sending response (<Response 2756 bytes [200 OK]>) to 10.0.36.93
2022-06-28 09:13:33.936072 (Thread-26): handling status request
2022-06-28 09:13:33.936482 (Thread-26): 09:13:33  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '6e9d0c3d-4c5a-4c24-aea8-f0dbcfecdbb9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa8ec1f7c40>]}
2022-06-28 09:13:33.936980 (Thread-26): sending response (<Response 1691 bytes [200 OK]>) to 10.0.36.93
2022-06-28 09:13:34.139184 (Thread-27): handling status request
2022-06-28 09:13:34.139592 (Thread-27): 09:13:34  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '6e9d0c3d-4c5a-4c24-aea8-f0dbcfecdbb9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa8ec1f7e80>]}
2022-06-28 09:13:34.140107 (Thread-27): sending response (<Response 1691 bytes [200 OK]>) to 10.0.36.93
2022-06-28 09:13:34.252031 (Thread-28): handling status request
2022-06-28 09:13:34.252430 (Thread-28): 09:13:34  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '6e9d0c3d-4c5a-4c24-aea8-f0dbcfecdbb9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa8ec1f7130>]}
2022-06-28 09:13:34.253224 (Thread-28): sending response (<Response 1691 bytes [200 OK]>) to 10.0.36.93
2022-06-28 09:13:34.356601 (Thread-29): handling status request
2022-06-28 09:13:34.357040 (Thread-29): 09:13:34  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '6e9d0c3d-4c5a-4c24-aea8-f0dbcfecdbb9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa8ec1f72b0>]}
2022-06-28 09:13:34.357568 (Thread-29): sending response (<Response 1691 bytes [200 OK]>) to 10.0.36.93
2022-06-28 09:13:37.985527 (Thread-30): handling status request
2022-06-28 09:13:37.985957 (Thread-30): 09:13:37  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '6e9d0c3d-4c5a-4c24-aea8-f0dbcfecdbb9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa8ec1f7e20>]}
2022-06-28 09:13:37.986488 (Thread-30): sending response (<Response 1691 bytes [200 OK]>) to 10.0.36.93
2022-06-28 09:13:38.404776 (Thread-31): handling compile_sql request
2022-06-28 09:13:38.405189 (Thread-31): 09:13:38  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '6e9d0c3d-4c5a-4c24-aea8-f0dbcfecdbb9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa8ec1f7dc0>]}
2022-06-28 09:13:40.845760 (Thread-31): sending response (<Response 138 bytes [200 OK]>) to 10.0.36.93
2022-06-28 09:13:40.871354 (MainThread): 09:13:40  Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'e6a08d87-55ec-4e4d-b086-5506ff3f083e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f510cf7d4f0>]}
2022-06-28 09:13:40.871976 (MainThread): 09:13:40  Found 3 models, 0 tests, 0 snapshots, 0 analyses, 179 macros, 0 operations, 0 seed files, 15 sources, 0 exposures, 0 metrics
2022-06-28 09:13:40.872605 (Thread-1): 09:13:40  Acquiring new snowflake connection "rpc.ecommerce_data_model_dbt.request"
2022-06-28 09:13:40.872741 (Thread-1): 09:13:40  Began compiling node rpc.ecommerce_data_model_dbt.request
2022-06-28 09:13:40.872838 (Thread-1): 09:13:40  Compiling rpc.ecommerce_data_model_dbt.request
2022-06-28 09:13:40.875107 (Thread-1): 09:13:40  finished collecting timing info
2022-06-28 09:13:40.875240 (Thread-1): 09:13:40  Began executing node rpc.ecommerce_data_model_dbt.request
2022-06-28 09:13:40.875340 (Thread-1): 09:13:40  finished collecting timing info
2022-06-28 09:13:41.267092 (Thread-32): handling poll request
2022-06-28 09:13:41.267612 (Thread-32): 09:13:41  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '6e9d0c3d-4c5a-4c24-aea8-f0dbcfecdbb9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa8ec1faa90>]}
2022-06-28 09:13:41.268849 (Thread-32): sending response (<Response 5461 bytes [200 OK]>) to 10.0.36.93
2022-06-28 09:13:54.062528 (Thread-33): handling status request
2022-06-28 09:13:54.062960 (Thread-33): 09:13:54  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '6e9d0c3d-4c5a-4c24-aea8-f0dbcfecdbb9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa8ec09c2e0>]}
2022-06-28 09:13:54.063517 (Thread-33): sending response (<Response 1691 bytes [200 OK]>) to 10.0.36.93
2022-06-28 09:13:54.475045 (Thread-34): handling compile_sql request
2022-06-28 09:13:54.475461 (Thread-34): 09:13:54  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '6e9d0c3d-4c5a-4c24-aea8-f0dbcfecdbb9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa8ec09c040>]}
2022-06-28 09:13:56.904464 (Thread-34): sending response (<Response 138 bytes [200 OK]>) to 10.0.36.93
2022-06-28 09:13:56.930056 (MainThread): 09:13:56  Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'c78d8842-a6de-477a-ae8b-f295b51cf0f2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f98a917d3d0>]}
2022-06-28 09:13:56.930657 (MainThread): 09:13:56  Found 3 models, 0 tests, 0 snapshots, 0 analyses, 179 macros, 0 operations, 0 seed files, 15 sources, 0 exposures, 0 metrics
2022-06-28 09:13:56.931271 (Thread-1): 09:13:56  Acquiring new snowflake connection "rpc.ecommerce_data_model_dbt.request"
2022-06-28 09:13:56.931406 (Thread-1): 09:13:56  Began compiling node rpc.ecommerce_data_model_dbt.request
2022-06-28 09:13:56.931501 (Thread-1): 09:13:56  Compiling rpc.ecommerce_data_model_dbt.request
2022-06-28 09:13:56.933849 (Thread-1): 09:13:56  finished collecting timing info
2022-06-28 09:13:56.933992 (Thread-1): 09:13:56  Began executing node rpc.ecommerce_data_model_dbt.request
2022-06-28 09:13:56.934093 (Thread-1): 09:13:56  finished collecting timing info
2022-06-28 09:13:57.307940 (Thread-35): handling poll request
2022-06-28 09:13:57.308413 (Thread-35): 09:13:57  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '6e9d0c3d-4c5a-4c24-aea8-f0dbcfecdbb9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa8ec115340>]}
2022-06-28 09:13:57.309571 (Thread-35): sending response (<Response 5478 bytes [200 OK]>) to 10.0.36.93
2022-06-28 09:14:07.594339 (Thread-36): 09:14:07  Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
2022-06-28 09:14:07.594577 (Thread-36): 09:14:07  Partial parsing enabled, no changes found, skipping parsing
2022-06-28 09:14:07.595066 (Thread-36): 09:14:07  [WARNING]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.ecommerce_data_model_dbt.example

2022-06-28 09:14:07.600977 (Thread-36): 09:14:07  Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '6e9d0c3d-4c5a-4c24-aea8-f0dbcfecdbb9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa8e01aeaf0>]}
2022-06-28 09:14:07.797143 (Thread-37): 09:14:07  Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
2022-06-28 09:14:07.797366 (Thread-37): 09:14:07  Partial parsing enabled, no changes found, skipping parsing
2022-06-28 09:14:07.797787 (Thread-37): 09:14:07  [WARNING]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.ecommerce_data_model_dbt.example

2022-06-28 09:14:07.803522 (Thread-37): 09:14:07  Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '6e9d0c3d-4c5a-4c24-aea8-f0dbcfecdbb9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa8e0130ee0>]}
2022-06-28 09:14:08.486599 (Thread-38): handling status request
2022-06-28 09:14:08.487040 (Thread-38): 09:14:08  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '6e9d0c3d-4c5a-4c24-aea8-f0dbcfecdbb9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa8ed234040>]}
2022-06-28 09:14:08.487591 (Thread-38): sending response (<Response 1691 bytes [200 OK]>) to 10.0.36.93
2022-06-28 09:14:08.685469 (Thread-39): handling status request
2022-06-28 09:14:08.685915 (Thread-39): 09:14:08  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '6e9d0c3d-4c5a-4c24-aea8-f0dbcfecdbb9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa8e018d310>]}
2022-06-28 09:14:08.686422 (Thread-39): sending response (<Response 1691 bytes [200 OK]>) to 10.0.36.93
2022-06-28 09:14:08.824888 (Thread-40): handling status request
2022-06-28 09:14:08.825294 (Thread-40): 09:14:08  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '6e9d0c3d-4c5a-4c24-aea8-f0dbcfecdbb9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa8e018d160>]}
2022-06-28 09:14:08.825792 (Thread-40): sending response (<Response 1691 bytes [200 OK]>) to 10.0.36.93
2022-06-28 09:14:08.908711 (Thread-41): handling status request
2022-06-28 09:14:08.909111 (Thread-41): 09:14:08  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '6e9d0c3d-4c5a-4c24-aea8-f0dbcfecdbb9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa8e018d070>]}
2022-06-28 09:14:08.909598 (Thread-41): sending response (<Response 1691 bytes [200 OK]>) to 10.0.36.93
2022-06-28 09:14:13.706423 (Thread-42): 09:14:13  Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
2022-06-28 09:14:13.706688 (Thread-42): 09:14:13  Partial parsing enabled, no changes found, skipping parsing
2022-06-28 09:14:13.707344 (Thread-42): 09:14:13  [WARNING]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.ecommerce_data_model_dbt.example

2022-06-28 09:14:13.714973 (Thread-42): 09:14:13  Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '6e9d0c3d-4c5a-4c24-aea8-f0dbcfecdbb9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa8e00afd30>]}
2022-06-28 09:14:14.572682 (Thread-43): handling status request
2022-06-28 09:14:14.573119 (Thread-43): 09:14:14  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '6e9d0c3d-4c5a-4c24-aea8-f0dbcfecdbb9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa8ec157490>]}
2022-06-28 09:14:14.573658 (Thread-43): sending response (<Response 1691 bytes [200 OK]>) to 10.0.36.93
2022-06-28 09:14:14.574733 (Thread-44): handling status request
2022-06-28 09:14:14.575097 (Thread-44): 09:14:14  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '6e9d0c3d-4c5a-4c24-aea8-f0dbcfecdbb9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa91d7b69a0>]}
2022-06-28 09:14:14.575556 (Thread-44): sending response (<Response 1691 bytes [200 OK]>) to 10.0.36.93
2022-06-28 09:14:14.793732 (Thread-45): handling status request
2022-06-28 09:14:14.794133 (Thread-45): 09:14:14  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '6e9d0c3d-4c5a-4c24-aea8-f0dbcfecdbb9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa8ec1573d0>]}
2022-06-28 09:14:14.794607 (Thread-45): sending response (<Response 1691 bytes [200 OK]>) to 10.0.36.93
2022-06-28 09:14:15.242616 (Thread-46): handling run_sql request
2022-06-28 09:14:15.243023 (Thread-46): 09:14:15  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '6e9d0c3d-4c5a-4c24-aea8-f0dbcfecdbb9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa8ec157460>]}
2022-06-28 09:14:17.673754 (Thread-46): sending response (<Response 138 bytes [200 OK]>) to 10.0.36.93
2022-06-28 09:14:17.699431 (MainThread): 09:14:17  Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '50c63dfa-41f0-4f68-9613-30c6a594e56f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2b83a1f370>]}
2022-06-28 09:14:17.700067 (MainThread): 09:14:17  Found 3 models, 0 tests, 0 snapshots, 0 analyses, 179 macros, 0 operations, 0 seed files, 15 sources, 0 exposures, 0 metrics
2022-06-28 09:14:17.700689 (Thread-1): 09:14:17  Acquiring new snowflake connection "rpc.ecommerce_data_model_dbt.request"
2022-06-28 09:14:17.700821 (Thread-1): 09:14:17  Began compiling node rpc.ecommerce_data_model_dbt.request
2022-06-28 09:14:17.700913 (Thread-1): 09:14:17  Compiling rpc.ecommerce_data_model_dbt.request
2022-06-28 09:14:17.703087 (Thread-1): 09:14:17  finished collecting timing info
2022-06-28 09:14:17.703218 (Thread-1): 09:14:17  Began executing node rpc.ecommerce_data_model_dbt.request
2022-06-28 09:14:17.703815 (Thread-1): 09:14:17  Using snowflake connection "rpc.ecommerce_data_model_dbt.request"
2022-06-28 09:14:17.703908 (Thread-1): 09:14:17  On rpc.ecommerce_data_model_dbt.request: select * from analytics_db.data_apps_simulated.tracks
limit 500
/* limit added automatically by dbt cloud */
2022-06-28 09:14:17.703990 (Thread-1): 09:14:17  Opening a new connection, currently in state init
2022-06-28 09:14:18.077332 (Thread-47): handling poll request
2022-06-28 09:14:18.077839 (Thread-47): 09:14:18  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '6e9d0c3d-4c5a-4c24-aea8-f0dbcfecdbb9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa8e0192100>]}
2022-06-28 09:14:18.078715 (Thread-47): sending response (<Response 3837 bytes [200 OK]>) to 10.0.36.93
2022-06-28 09:14:19.541599 (Thread-48): handling poll request
2022-06-28 09:14:19.542013 (Thread-48): 09:14:19  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '6e9d0c3d-4c5a-4c24-aea8-f0dbcfecdbb9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa8e0192a00>]}
2022-06-28 09:14:19.542496 (Thread-48): sending response (<Response 402 bytes [200 OK]>) to 10.0.36.93
2022-06-28 09:14:19.608870 (Thread-1): 09:14:19  SQL status: SUCCESS 119 in 1.9 seconds
2022-06-28 09:14:19.615702 (Thread-1): 09:14:19  finished collecting timing info
2022-06-28 09:14:19.615942 (Thread-1): 09:14:19  On rpc.ecommerce_data_model_dbt.request: Close
2022-06-28 09:14:20.989850 (Thread-49): handling poll request
2022-06-28 09:14:20.990435 (Thread-49): 09:14:20  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '6e9d0c3d-4c5a-4c24-aea8-f0dbcfecdbb9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa8ec123220>]}
2022-06-28 09:14:20.994547 (Thread-49): sending response (<Response 51638 bytes [200 OK]>) to 10.0.36.93
2022-06-28 09:14:37.868519 (Thread-50): 09:14:37  Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
2022-06-28 09:14:37.868999 (Thread-50): 09:14:37  Partial parsing: updated file: ecommerce_data_model_dbt://models/data_model/feat_user_features.sql
2022-06-28 09:14:37.873201 (Thread-50): 09:14:37  1699: static parser successfully parsed data_model/feat_user_features.sql
2022-06-28 09:14:37.915537 (Thread-50): 09:14:37  [WARNING]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.ecommerce_data_model_dbt.example

2022-06-28 09:14:37.921607 (Thread-50): 09:14:37  Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '6e9d0c3d-4c5a-4c24-aea8-f0dbcfecdbb9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa8e00960a0>]}
2022-06-28 09:14:38.190290 (Thread-51): 09:14:38  Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
2022-06-28 09:14:38.190526 (Thread-51): 09:14:38  Partial parsing enabled, no changes found, skipping parsing
2022-06-28 09:14:38.190943 (Thread-51): 09:14:38  [WARNING]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.ecommerce_data_model_dbt.example

2022-06-28 09:14:38.196565 (Thread-51): 09:14:38  Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '6e9d0c3d-4c5a-4c24-aea8-f0dbcfecdbb9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa8e01aefa0>]}
2022-06-28 09:14:38.746425 (Thread-52): handling status request
2022-06-28 09:14:38.746834 (Thread-52): 09:14:38  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '6e9d0c3d-4c5a-4c24-aea8-f0dbcfecdbb9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa8e0194ca0>]}
2022-06-28 09:14:38.747367 (Thread-52): sending response (<Response 1691 bytes [200 OK]>) to 10.0.36.93
2022-06-28 09:14:38.953548 (Thread-53): handling status request
2022-06-28 09:14:38.953957 (Thread-53): 09:14:38  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '6e9d0c3d-4c5a-4c24-aea8-f0dbcfecdbb9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa8e0194ac0>]}
2022-06-28 09:14:38.954486 (Thread-53): sending response (<Response 1691 bytes [200 OK]>) to 10.0.36.93
2022-06-28 09:14:39.179744 (Thread-54): handling status request
2022-06-28 09:14:39.180174 (Thread-54): 09:14:39  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '6e9d0c3d-4c5a-4c24-aea8-f0dbcfecdbb9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa8e0194910>]}
2022-06-28 09:14:39.180672 (Thread-54): sending response (<Response 1691 bytes [200 OK]>) to 10.0.36.93
2022-06-28 09:14:39.182359 (Thread-55): handling status request
2022-06-28 09:14:39.182646 (Thread-55): 09:14:39  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '6e9d0c3d-4c5a-4c24-aea8-f0dbcfecdbb9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa8e0194790>]}
2022-06-28 09:14:39.183064 (Thread-55): sending response (<Response 1691 bytes [200 OK]>) to 10.0.36.93
2022-06-28 09:14:40.043137 (Thread-56): handling status request
2022-06-28 09:14:40.043609 (Thread-56): 09:14:40  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '6e9d0c3d-4c5a-4c24-aea8-f0dbcfecdbb9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa8e0070d30>]}
2022-06-28 09:14:40.044137 (Thread-56): sending response (<Response 1691 bytes [200 OK]>) to 10.0.36.93
2022-06-28 09:14:40.473575 (Thread-57): handling compile_sql request
2022-06-28 09:14:40.473981 (Thread-57): 09:14:40  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '6e9d0c3d-4c5a-4c24-aea8-f0dbcfecdbb9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa8e01941c0>]}
2022-06-28 09:14:42.878164 (Thread-57): sending response (<Response 138 bytes [200 OK]>) to 10.0.36.93
2022-06-28 09:14:42.903254 (MainThread): 09:14:42  Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '00e947d9-b7db-48d3-955b-bbe8564c7cde', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd4fb4923a0>]}
2022-06-28 09:14:42.903871 (MainThread): 09:14:42  Found 3 models, 0 tests, 0 snapshots, 0 analyses, 179 macros, 0 operations, 0 seed files, 15 sources, 0 exposures, 0 metrics
2022-06-28 09:14:42.904498 (Thread-1): 09:14:42  Acquiring new snowflake connection "rpc.ecommerce_data_model_dbt.request"
2022-06-28 09:14:42.904633 (Thread-1): 09:14:42  Began compiling node rpc.ecommerce_data_model_dbt.request
2022-06-28 09:14:42.904726 (Thread-1): 09:14:42  Compiling rpc.ecommerce_data_model_dbt.request
2022-06-28 09:14:42.906782 (Thread-1): 09:14:42  finished collecting timing info
2022-06-28 09:14:42.906913 (Thread-1): 09:14:42  Began executing node rpc.ecommerce_data_model_dbt.request
2022-06-28 09:14:42.907011 (Thread-1): 09:14:42  finished collecting timing info
2022-06-28 09:14:43.297935 (Thread-58): handling poll request
2022-06-28 09:14:43.298411 (Thread-58): 09:14:43  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '6e9d0c3d-4c5a-4c24-aea8-f0dbcfecdbb9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa8e01a23a0>]}
2022-06-28 09:14:43.299596 (Thread-58): sending response (<Response 5492 bytes [200 OK]>) to 10.0.36.93
2022-06-28 09:14:48.343673 (Thread-59): handling status request
2022-06-28 09:14:48.344106 (Thread-59): 09:14:48  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '6e9d0c3d-4c5a-4c24-aea8-f0dbcfecdbb9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa8e01a22e0>]}
2022-06-28 09:14:48.344653 (Thread-59): sending response (<Response 1691 bytes [200 OK]>) to 10.0.36.93
2022-06-28 09:14:48.798005 (Thread-60): handling run_sql request
2022-06-28 09:14:48.798423 (Thread-60): 09:14:48  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '6e9d0c3d-4c5a-4c24-aea8-f0dbcfecdbb9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa8e01a29a0>]}
2022-06-28 09:14:51.267145 (Thread-60): sending response (<Response 138 bytes [200 OK]>) to 10.0.36.93
2022-06-28 09:14:51.293115 (MainThread): 09:14:51  Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '4f33bd00-98b6-4065-9e50-d03741ca98ae', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2d3e53d3a0>]}
2022-06-28 09:14:51.293730 (MainThread): 09:14:51  Found 3 models, 0 tests, 0 snapshots, 0 analyses, 179 macros, 0 operations, 0 seed files, 15 sources, 0 exposures, 0 metrics
2022-06-28 09:14:51.294373 (Thread-1): 09:14:51  Acquiring new snowflake connection "rpc.ecommerce_data_model_dbt.request"
2022-06-28 09:14:51.294512 (Thread-1): 09:14:51  Began compiling node rpc.ecommerce_data_model_dbt.request
2022-06-28 09:14:51.294608 (Thread-1): 09:14:51  Compiling rpc.ecommerce_data_model_dbt.request
2022-06-28 09:14:51.296805 (Thread-1): 09:14:51  finished collecting timing info
2022-06-28 09:14:51.296940 (Thread-1): 09:14:51  Began executing node rpc.ecommerce_data_model_dbt.request
2022-06-28 09:14:51.297549 (Thread-1): 09:14:51  Using snowflake connection "rpc.ecommerce_data_model_dbt.request"
2022-06-28 09:14:51.297644 (Thread-1): 09:14:51  On rpc.ecommerce_data_model_dbt.request: select * from ANALYTICS_DB.DBT_ECOMMERCE_DATA_MODEL.stg_products_viewed
limit 500
/* limit added automatically by dbt cloud */
2022-06-28 09:14:51.297728 (Thread-1): 09:14:51  Opening a new connection, currently in state init
2022-06-28 09:14:51.714551 (Thread-61): handling poll request
2022-06-28 09:14:51.715034 (Thread-61): 09:14:51  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '6e9d0c3d-4c5a-4c24-aea8-f0dbcfecdbb9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa8e0195a60>]}
2022-06-28 09:14:51.715964 (Thread-61): sending response (<Response 3854 bytes [200 OK]>) to 10.0.36.93
2022-06-28 09:14:52.114020 (Thread-1): 09:14:52  Snowflake adapter: Snowflake query id: 01a53f0a-0602-2c49-0019-8203045c2e06
2022-06-28 09:14:52.114235 (Thread-1): 09:14:52  Snowflake adapter: Snowflake error: 002003 (02000): SQL compilation error:
Schema 'ANALYTICS_DB.DBT_ECOMMERCE_DATA_MODEL' does not exist or not authorized.
2022-06-28 09:14:52.114426 (Thread-1): 09:14:52  finished collecting timing info
2022-06-28 09:14:52.114609 (Thread-1): 09:14:52  On rpc.ecommerce_data_model_dbt.request: Close
2022-06-28 09:14:52.213620 (Thread-1): Got an exception: Database Error
  002003 (02000): SQL compilation error:
  Schema 'ANALYTICS_DB.DBT_ECOMMERCE_DATA_MODEL' does not exist or not authorized.
Traceback (most recent call last):
  File "/usr/local/lib/python3.8/dist-packages/dbt/adapters/snowflake/connections.py", line 206, in exception_handler
    yield
  File "/usr/local/lib/python3.8/dist-packages/dbt/adapters/sql/connections.py", line 74, in add_query
    cursor.execute(sql, bindings)
  File "/usr/local/lib/python3.8/dist-packages/snowflake/connector/cursor.py", line 721, in execute
    Error.errorhandler_wrapper(
  File "/usr/local/lib/python3.8/dist-packages/snowflake/connector/errors.py", line 258, in errorhandler_wrapper
    cursor.errorhandler(connection, cursor, error_class, error_value)
  File "/usr/local/lib/python3.8/dist-packages/snowflake/connector/errors.py", line 188, in default_errorhandler
    raise error_class(
snowflake.connector.errors.ProgrammingError: 002003 (02000): SQL compilation error:
Schema 'ANALYTICS_DB.DBT_ECOMMERCE_DATA_MODEL' does not exist or not authorized.

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/usr/local/lib/python3.8/dist-packages/dbt/task/base.py", line 361, in safe_run
    result = self.compile_and_execute(manifest, ctx)
  File "/usr/local/lib/python3.8/dist-packages/dbt/task/base.py", line 314, in compile_and_execute
    result = self.run(ctx.node, manifest)
  File "/usr/local/lib/python3.8/dist-packages/dbt/task/base.py", line 403, in run
    return self.execute(compiled_node, manifest)
  File "/usr/local/lib/python3.8/dist-packages/dbt_rpc/rpc/node_runners.py", line 90, in execute
    _, execute_result = self.adapter.execute(
  File "/usr/local/lib/python3.8/dist-packages/dbt/adapters/base/impl.py", line 225, in execute
    return self.connections.execute(
  File "/usr/local/lib/python3.8/dist-packages/dbt/adapters/sql/connections.py", line 127, in execute
    _, cursor = self.add_query(sql, auto_begin)
  File "/usr/local/lib/python3.8/dist-packages/dbt/adapters/snowflake/connections.py", line 433, in add_query
    connection, cursor = super().add_query(
  File "/usr/local/lib/python3.8/dist-packages/dbt/adapters/sql/connections.py", line 83, in add_query
    return connection, cursor
  File "/usr/lib/python3.8/contextlib.py", line 131, in __exit__
    self.gen.throw(type, value, traceback)
  File "/usr/local/lib/python3.8/dist-packages/dbt/adapters/snowflake/connections.py", line 223, in exception_handler
    raise DatabaseException(msg)
dbt.exceptions.DatabaseException: Database Error
  002003 (02000): SQL compilation error:
  Schema 'ANALYTICS_DB.DBT_ECOMMERCE_DATA_MODEL' does not exist or not authorized.
2022-06-28 09:14:52.214632 (Thread-1): Got exception RPCException(10003, Database Error, {'type': 'DatabaseException', 'message': "Database Error in rpc request (from remote system)\n  002003 (02000): SQL compilation error:\n  Schema 'ANALYTICS_DB.DBT_ECOMMERCE_DATA_MODEL' does not exist or not authorized.", 'raw_sql': "select * from {{ ref('stg_products_viewed') }}\nlimit 500\n/* limit added automatically by dbt cloud */", 'compiled_sql': 'select * from ANALYTICS_DB.DBT_ECOMMERCE_DATA_MODEL.stg_products_viewed\nlimit 500\n/* limit added automatically by dbt cloud */', 'tags': None}, None)
Traceback (most recent call last):
  File "/usr/local/lib/python3.8/dist-packages/dbt_rpc/task/sql_commands.py", line 147, in _in_thread
    self.node_results.append(runner.safe_run(self.manifest))
  File "/usr/local/lib/python3.8/dist-packages/dbt/task/base.py", line 377, in safe_run
    result = self.error_result(ctx.node, error, started, [])
  File "/usr/local/lib/python3.8/dist-packages/dbt_rpc/rpc/node_runners.py", line 56, in error_result
    raise error
dbt_rpc.rpc.error.RPCException: RPCException(10003, Database Error, {'type': 'DatabaseException', 'message': "Database Error in rpc request (from remote system)\n  002003 (02000): SQL compilation error:\n  Schema 'ANALYTICS_DB.DBT_ECOMMERCE_DATA_MODEL' does not exist or not authorized.", 'raw_sql': "select * from {{ ref('stg_products_viewed') }}\nlimit 500\n/* limit added automatically by dbt cloud */", 'compiled_sql': 'select * from ANALYTICS_DB.DBT_ECOMMERCE_DATA_MODEL.stg_products_viewed\nlimit 500\n/* limit added automatically by dbt cloud */', 'tags': None}, None)
2022-06-28 09:14:53.135028 (Thread-62): handling poll request
2022-06-28 09:14:53.135501 (Thread-62): 09:14:53  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '6e9d0c3d-4c5a-4c24-aea8-f0dbcfecdbb9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa8e0195e20>]}
2022-06-28 09:14:53.136191 (Thread-62): sending response (<Response 10366 bytes [200 OK]>) to 10.0.36.93
2022-06-28 09:16:32.054909 (Thread-63): 09:16:32  Unable to do partial parsing because a project config has changed
2022-06-28 09:16:32.058393 (Thread-63): 09:16:32  Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '6e9d0c3d-4c5a-4c24-aea8-f0dbcfecdbb9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa8e019d7c0>]}
2022-06-28 09:16:32.119989 (Thread-63): 09:16:32  Parsing macros/adapters.sql
2022-06-28 09:16:32.158547 (Thread-63): 09:16:32  Parsing macros/catalog.sql
2022-06-28 09:16:32.160565 (Thread-63): 09:16:32  Parsing macros/materializations/table.sql
2022-06-28 09:16:32.163703 (Thread-63): 09:16:32  Parsing macros/materializations/seed.sql
2022-06-28 09:16:32.168902 (Thread-63): 09:16:32  Parsing macros/materializations/incremental.sql
2022-06-28 09:16:32.177489 (Thread-63): 09:16:32  Parsing macros/materializations/merge.sql
2022-06-28 09:16:32.181313 (Thread-63): 09:16:32  Parsing macros/materializations/snapshot.sql
2022-06-28 09:16:32.182305 (Thread-63): 09:16:32  Parsing macros/materializations/view.sql
2022-06-28 09:16:32.183682 (Thread-63): 09:16:32  Parsing macros/adapters/metadata.sql
2022-06-28 09:16:32.190759 (Thread-63): 09:16:32  Parsing macros/adapters/columns.sql
2022-06-28 09:16:32.200665 (Thread-63): 09:16:32  Parsing macros/adapters/freshness.sql
2022-06-28 09:16:32.203605 (Thread-63): 09:16:32  Parsing macros/adapters/persist_docs.sql
2022-06-28 09:16:32.207997 (Thread-63): 09:16:32  Parsing macros/adapters/relation.sql
2022-06-28 09:16:32.217387 (Thread-63): 09:16:32  Parsing macros/adapters/schema.sql
2022-06-28 09:16:32.219558 (Thread-63): 09:16:32  Parsing macros/adapters/indexes.sql
2022-06-28 09:16:32.222295 (Thread-63): 09:16:32  Parsing macros/get_custom_name/get_custom_schema.sql
2022-06-28 09:16:32.224787 (Thread-63): 09:16:32  Parsing macros/get_custom_name/get_custom_alias.sql
2022-06-28 09:16:32.226273 (Thread-63): 09:16:32  Parsing macros/get_custom_name/get_custom_database.sql
2022-06-28 09:16:32.227839 (Thread-63): 09:16:32  Parsing macros/etc/datetime.sql
2022-06-28 09:16:32.236118 (Thread-63): 09:16:32  Parsing macros/etc/statement.sql
2022-06-28 09:16:32.240493 (Thread-63): 09:16:32  Parsing macros/generic_test_sql/unique.sql
2022-06-28 09:16:32.241296 (Thread-63): 09:16:32  Parsing macros/generic_test_sql/not_null.sql
2022-06-28 09:16:32.241871 (Thread-63): 09:16:32  Parsing macros/generic_test_sql/accepted_values.sql
2022-06-28 09:16:32.243236 (Thread-63): 09:16:32  Parsing macros/generic_test_sql/relationships.sql
2022-06-28 09:16:32.244157 (Thread-63): 09:16:32  Parsing macros/materializations/configs.sql
2022-06-28 09:16:32.246451 (Thread-63): 09:16:32  Parsing macros/materializations/hooks.sql
2022-06-28 09:16:32.250290 (Thread-63): 09:16:32  Parsing macros/materializations/models/table/table.sql
2022-06-28 09:16:32.257707 (Thread-63): 09:16:32  Parsing macros/materializations/models/table/create_table_as.sql
2022-06-28 09:16:32.260559 (Thread-63): 09:16:32  Parsing macros/materializations/models/view/create_or_replace_view.sql
2022-06-28 09:16:32.263213 (Thread-63): 09:16:32  Parsing macros/materializations/models/view/helpers.sql
2022-06-28 09:16:32.264588 (Thread-63): 09:16:32  Parsing macros/materializations/models/view/create_view_as.sql
2022-06-28 09:16:32.266925 (Thread-63): 09:16:32  Parsing macros/materializations/models/view/view.sql
2022-06-28 09:16:32.273961 (Thread-63): 09:16:32  Parsing macros/materializations/models/incremental/incremental.sql
2022-06-28 09:16:32.283833 (Thread-63): 09:16:32  Parsing macros/materializations/models/incremental/on_schema_change.sql
2022-06-28 09:16:32.299344 (Thread-63): 09:16:32  Parsing macros/materializations/models/incremental/is_incremental.sql
2022-06-28 09:16:32.300953 (Thread-63): 09:16:32  Parsing macros/materializations/models/incremental/merge.sql
2022-06-28 09:16:32.312272 (Thread-63): 09:16:32  Parsing macros/materializations/models/incremental/column_helpers.sql
2022-06-28 09:16:32.316802 (Thread-63): 09:16:32  Parsing macros/materializations/seeds/helpers.sql
2022-06-28 09:16:32.337348 (Thread-63): 09:16:32  Parsing macros/materializations/seeds/seed.sql
2022-06-28 09:16:32.346425 (Thread-63): 09:16:32  Parsing macros/materializations/tests/helpers.sql
2022-06-28 09:16:32.349102 (Thread-63): 09:16:32  Parsing macros/materializations/tests/test.sql
2022-06-28 09:16:32.355906 (Thread-63): 09:16:32  Parsing macros/materializations/tests/where_subquery.sql
2022-06-28 09:16:32.358669 (Thread-63): 09:16:32  Parsing macros/materializations/snapshots/helpers.sql
2022-06-28 09:16:32.375896 (Thread-63): 09:16:32  Parsing macros/materializations/snapshots/strategies.sql
2022-06-28 09:16:32.393427 (Thread-63): 09:16:32  Parsing macros/materializations/snapshots/snapshot_merge.sql
2022-06-28 09:16:32.395213 (Thread-63): 09:16:32  Parsing macros/materializations/snapshots/snapshot.sql
2022-06-28 09:16:32.406856 (Thread-63): 09:16:32  Parsing tests/generic/builtin.sql
2022-06-28 09:16:32.606335 (Thread-63): 09:16:32  1699: static parser successfully parsed data_model/stg_products_viewed.sql
2022-06-28 09:16:32.608751 (Thread-63): 09:16:32  1699: static parser successfully parsed data_model/feat_user_features.sql
2022-06-28 09:16:32.610785 (Thread-63): 09:16:32  1699: static parser successfully parsed data_model/stg_tracks.sql
2022-06-28 09:16:32.629479 (Thread-63): 09:16:32  [WARNING]: Did not find matching node for patch with name 'my_first_dbt_model' in the 'models' section of file 'models/data_model/schema.yml'
2022-06-28 09:16:32.663600 (Thread-63): 09:16:32  [WARNING]: Test 'test.ecommerce_data_model_dbt.unique_my_first_dbt_model_id.16e066b321' (models/data_model/schema.yml) depends on a node named 'my_first_dbt_model' which was not found
2022-06-28 09:16:32.664007 (Thread-63): 09:16:32  [WARNING]: Test 'test.ecommerce_data_model_dbt.not_null_my_first_dbt_model_id.5fb22c2710' (models/data_model/schema.yml) depends on a node named 'my_first_dbt_model' which was not found
2022-06-28 09:16:32.712490 (Thread-63): 09:16:32  [WARNING]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.ecommerce_data_model_dbt.example

2022-06-28 09:16:32.718097 (Thread-63): 09:16:32  Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '6e9d0c3d-4c5a-4c24-aea8-f0dbcfecdbb9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa8ed35d550>]}
2022-06-28 09:16:32.975519 (Thread-64): handling status request
2022-06-28 09:16:32.975970 (Thread-64): 09:16:32  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '6e9d0c3d-4c5a-4c24-aea8-f0dbcfecdbb9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa8ec115850>]}
2022-06-28 09:16:32.976969 (Thread-64): sending response (<Response 17632 bytes [200 OK]>) to 10.0.36.93
2022-06-28 09:16:33.052473 (Thread-65): handling status request
2022-06-28 09:16:33.052878 (Thread-65): 09:16:33  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '6e9d0c3d-4c5a-4c24-aea8-f0dbcfecdbb9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa8ed2c0430>]}
2022-06-28 09:16:33.053830 (Thread-65): sending response (<Response 17632 bytes [200 OK]>) to 10.0.36.93
2022-06-28 09:17:00.148599 (Thread-66): 09:17:00  Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
2022-06-28 09:17:00.149067 (Thread-66): 09:17:00  Partial parsing: updated file: ecommerce_data_model_dbt://models/data_model/stg_products_viewed.sql
2022-06-28 09:17:00.153396 (Thread-66): 09:17:00  1603: static parser failed on data_model/stg_products_viewed.sql
2022-06-28 09:17:00.157386 (Thread-66): 09:17:00  1602: parser fallback to jinja rendering on data_model/stg_products_viewed.sql
2022-06-28 09:17:00.203558 (Thread-66): 09:17:00  [WARNING]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.ecommerce_data_model_dbt.example

2022-06-28 09:17:00.211541 (Thread-66): 09:17:00  Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '6e9d0c3d-4c5a-4c24-aea8-f0dbcfecdbb9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa89ad9e520>]}
2022-06-28 09:17:01.017112 (Thread-67): handling status request
2022-06-28 09:17:01.017564 (Thread-67): 09:17:01  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '6e9d0c3d-4c5a-4c24-aea8-f0dbcfecdbb9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa8ed2c0910>]}
2022-06-28 09:17:01.018106 (Thread-67): sending response (<Response 2355 bytes [200 OK]>) to 10.0.36.93
2022-06-28 09:17:01.251014 (Thread-68): handling status request
2022-06-28 09:17:01.251419 (Thread-68): 09:17:01  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '6e9d0c3d-4c5a-4c24-aea8-f0dbcfecdbb9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa8e00c4730>]}
2022-06-28 09:17:01.251976 (Thread-68): sending response (<Response 2355 bytes [200 OK]>) to 10.0.36.93
2022-06-28 09:17:01.485180 (Thread-69): handling status request
2022-06-28 09:17:01.485608 (Thread-69): 09:17:01  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '6e9d0c3d-4c5a-4c24-aea8-f0dbcfecdbb9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa8e00c45b0>]}
2022-06-28 09:17:01.486120 (Thread-69): sending response (<Response 2355 bytes [200 OK]>) to 10.0.36.93
2022-06-28 09:17:01.534368 (Thread-70): handling status request
2022-06-28 09:17:01.534773 (Thread-70): 09:17:01  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '6e9d0c3d-4c5a-4c24-aea8-f0dbcfecdbb9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa8e00c43a0>]}
2022-06-28 09:17:01.535276 (Thread-70): sending response (<Response 2355 bytes [200 OK]>) to 10.0.36.93
2022-06-28 09:17:01.709088 (Thread-71): handling status request
2022-06-28 09:17:01.709507 (Thread-71): 09:17:01  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '6e9d0c3d-4c5a-4c24-aea8-f0dbcfecdbb9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa8e00c42b0>]}
2022-06-28 09:17:01.710010 (Thread-71): sending response (<Response 2355 bytes [200 OK]>) to 10.0.36.93
2022-06-28 09:17:02.140526 (Thread-72): handling compile_sql request
2022-06-28 09:17:02.140965 (Thread-72): 09:17:02  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '6e9d0c3d-4c5a-4c24-aea8-f0dbcfecdbb9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa8e00c4130>]}
2022-06-28 09:17:04.723276 (Thread-72): sending response (<Response 138 bytes [200 OK]>) to 10.0.36.93
2022-06-28 09:17:04.786155 (MainThread): 09:17:04  Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '07377db0-6c20-4aa0-b9af-d800186915f9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0f68a80fd0>]}
2022-06-28 09:17:04.786783 (MainThread): 09:17:04  Found 3 models, 0 tests, 0 snapshots, 0 analyses, 179 macros, 0 operations, 0 seed files, 15 sources, 0 exposures, 0 metrics
2022-06-28 09:17:04.787428 (Thread-1): 09:17:04  Acquiring new snowflake connection "rpc.ecommerce_data_model_dbt.request"
2022-06-28 09:17:04.787567 (Thread-1): 09:17:04  Began compiling node rpc.ecommerce_data_model_dbt.request
2022-06-28 09:17:04.787698 (Thread-1): 09:17:04  Compiling rpc.ecommerce_data_model_dbt.request
2022-06-28 09:17:04.791018 (Thread-1): 09:17:04  finished collecting timing info
2022-06-28 09:17:04.791165 (Thread-1): 09:17:04  Began executing node rpc.ecommerce_data_model_dbt.request
2022-06-28 09:17:04.791266 (Thread-1): 09:17:04  finished collecting timing info
2022-06-28 09:17:05.155122 (Thread-73): handling poll request
2022-06-28 09:17:05.155690 (Thread-73): 09:17:05  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '6e9d0c3d-4c5a-4c24-aea8-f0dbcfecdbb9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa8e00c46d0>]}
2022-06-28 09:17:05.156950 (Thread-73): sending response (<Response 5606 bytes [200 OK]>) to 10.0.36.93
2022-06-28 09:17:16.370006 (Thread-74): 09:17:16  Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
2022-06-28 09:17:16.370478 (Thread-74): 09:17:16  Partial parsing: updated file: ecommerce_data_model_dbt://models/data_model/stg_products_viewed.sql
2022-06-28 09:17:16.375749 (Thread-74): 09:17:16  1603: static parser failed on data_model/stg_products_viewed.sql
2022-06-28 09:17:16.379604 (Thread-74): 09:17:16  1602: parser fallback to jinja rendering on data_model/stg_products_viewed.sql
2022-06-28 09:17:16.428170 (Thread-74): 09:17:16  [WARNING]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.ecommerce_data_model_dbt.example

2022-06-28 09:17:16.433878 (Thread-74): 09:17:16  Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '6e9d0c3d-4c5a-4c24-aea8-f0dbcfecdbb9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa89ad99d90>]}
2022-06-28 09:17:16.557613 (Thread-75): 09:17:16  Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
2022-06-28 09:17:16.557851 (Thread-75): 09:17:16  Partial parsing enabled, no changes found, skipping parsing
2022-06-28 09:17:16.558302 (Thread-75): 09:17:16  [WARNING]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.ecommerce_data_model_dbt.example

2022-06-28 09:17:16.564031 (Thread-75): 09:17:16  Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '6e9d0c3d-4c5a-4c24-aea8-f0dbcfecdbb9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa89ac74c10>]}
2022-06-28 09:17:17.218139 (Thread-76): handling status request
2022-06-28 09:17:17.218551 (Thread-76): 09:17:17  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '6e9d0c3d-4c5a-4c24-aea8-f0dbcfecdbb9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa8ec157e50>]}
2022-06-28 09:17:17.219151 (Thread-76): sending response (<Response 1691 bytes [200 OK]>) to 10.0.36.93
2022-06-28 09:17:17.427490 (Thread-77): handling status request
2022-06-28 09:17:17.427985 (Thread-77): 09:17:17  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '6e9d0c3d-4c5a-4c24-aea8-f0dbcfecdbb9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa8ec105ee0>]}
2022-06-28 09:17:17.428486 (Thread-77): sending response (<Response 1691 bytes [200 OK]>) to 10.0.36.93
2022-06-28 09:17:17.640553 (Thread-78): handling status request
2022-06-28 09:17:17.641045 (Thread-78): 09:17:17  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '6e9d0c3d-4c5a-4c24-aea8-f0dbcfecdbb9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa8ec115af0>]}
2022-06-28 09:17:17.641560 (Thread-78): sending response (<Response 1691 bytes [200 OK]>) to 10.0.36.93
2022-06-28 09:17:17.670405 (Thread-79): handling status request
2022-06-28 09:17:17.670908 (Thread-79): 09:17:17  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '6e9d0c3d-4c5a-4c24-aea8-f0dbcfecdbb9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa89acb46d0>]}
2022-06-28 09:17:17.671433 (Thread-79): sending response (<Response 1691 bytes [200 OK]>) to 10.0.36.93
2022-06-28 09:17:18.919707 (Thread-80): handling status request
2022-06-28 09:17:18.920193 (Thread-80): 09:17:18  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '6e9d0c3d-4c5a-4c24-aea8-f0dbcfecdbb9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa89acb4550>]}
2022-06-28 09:17:18.920686 (Thread-80): sending response (<Response 1691 bytes [200 OK]>) to 10.0.36.93
2022-06-28 09:17:19.324160 (Thread-81): handling compile_sql request
2022-06-28 09:17:19.324567 (Thread-81): 09:17:19  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '6e9d0c3d-4c5a-4c24-aea8-f0dbcfecdbb9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa89acb4340>]}
2022-06-28 09:17:21.758384 (Thread-81): sending response (<Response 138 bytes [200 OK]>) to 10.0.36.93
2022-06-28 09:17:21.789721 (MainThread): 09:17:21  Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '6dec5696-0e35-48a1-998c-9b28e83b3373', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd6c0728e20>]}
2022-06-28 09:17:21.790400 (MainThread): 09:17:21  Found 3 models, 0 tests, 0 snapshots, 0 analyses, 179 macros, 0 operations, 0 seed files, 15 sources, 0 exposures, 0 metrics
2022-06-28 09:17:21.791020 (Thread-1): 09:17:21  Acquiring new snowflake connection "rpc.ecommerce_data_model_dbt.request"
2022-06-28 09:17:21.791143 (Thread-1): 09:17:21  Began compiling node rpc.ecommerce_data_model_dbt.request
2022-06-28 09:17:21.791236 (Thread-1): 09:17:21  Compiling rpc.ecommerce_data_model_dbt.request
2022-06-28 09:17:21.793928 (Thread-1): 09:17:21  finished collecting timing info
2022-06-28 09:17:21.794067 (Thread-1): 09:17:21  Began executing node rpc.ecommerce_data_model_dbt.request
2022-06-28 09:17:21.794169 (Thread-1): 09:17:21  finished collecting timing info
2022-06-28 09:17:22.264180 (Thread-82): handling poll request
2022-06-28 09:17:22.264692 (Thread-82): 09:17:22  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '6e9d0c3d-4c5a-4c24-aea8-f0dbcfecdbb9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa89adbc250>]}
2022-06-28 09:17:22.265906 (Thread-82): sending response (<Response 5614 bytes [200 OK]>) to 10.0.36.93
2022-06-28 09:18:17.407492 (Thread-83): 09:18:17  Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
2022-06-28 09:18:17.407991 (Thread-83): 09:18:17  Partial parsing: updated file: ecommerce_data_model_dbt://models/data_model/feat_user_features.sql
2022-06-28 09:18:17.413132 (Thread-83): 09:18:17  1699: static parser successfully parsed data_model/feat_user_features.sql
2022-06-28 09:18:17.467064 (Thread-83): 09:18:17  [WARNING]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.ecommerce_data_model_dbt.example

2022-06-28 09:18:17.472933 (Thread-83): 09:18:17  Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '6e9d0c3d-4c5a-4c24-aea8-f0dbcfecdbb9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa89abb1d30>]}
2022-06-28 09:18:17.587858 (Thread-84): 09:18:17  Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
2022-06-28 09:18:17.588219 (Thread-84): 09:18:17  Partial parsing enabled, no changes found, skipping parsing
2022-06-28 09:18:17.588856 (Thread-84): 09:18:17  [WARNING]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.ecommerce_data_model_dbt.example

2022-06-28 09:18:17.595674 (Thread-84): 09:18:17  Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '6e9d0c3d-4c5a-4c24-aea8-f0dbcfecdbb9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa89ab72f10>]}
2022-06-28 09:18:17.799195 (Thread-85): 09:18:17  Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
2022-06-28 09:18:17.799427 (Thread-85): 09:18:17  Partial parsing enabled, no changes found, skipping parsing
2022-06-28 09:18:17.799938 (Thread-85): 09:18:17  [WARNING]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.ecommerce_data_model_dbt.example

2022-06-28 09:18:17.806312 (Thread-85): 09:18:17  Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '6e9d0c3d-4c5a-4c24-aea8-f0dbcfecdbb9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa89ab5f640>]}
2022-06-28 09:18:18.826283 (Thread-86): handling status request
2022-06-28 09:18:18.826716 (Thread-86): 09:18:18  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '6e9d0c3d-4c5a-4c24-aea8-f0dbcfecdbb9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa89acb48e0>]}
2022-06-28 09:18:18.827241 (Thread-86): sending response (<Response 1691 bytes [200 OK]>) to 10.0.36.93
2022-06-28 09:18:19.088226 (Thread-87): handling status request
2022-06-28 09:18:19.088677 (Thread-87): 09:18:19  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '6e9d0c3d-4c5a-4c24-aea8-f0dbcfecdbb9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa89ac79700>]}
2022-06-28 09:18:19.101110 (Thread-87): sending response (<Response 1691 bytes [200 OK]>) to 10.0.36.93
2022-06-28 09:18:19.344246 (Thread-88): handling status request
2022-06-28 09:18:19.344661 (Thread-88): 09:18:19  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '6e9d0c3d-4c5a-4c24-aea8-f0dbcfecdbb9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa89abb1eb0>]}
2022-06-28 09:18:19.345155 (Thread-88): sending response (<Response 1691 bytes [200 OK]>) to 10.0.36.93
2022-06-28 09:18:19.415478 (Thread-89): handling status request
2022-06-28 09:18:19.415933 (Thread-89): 09:18:19  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '6e9d0c3d-4c5a-4c24-aea8-f0dbcfecdbb9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa89ab38c10>]}
2022-06-28 09:18:19.416430 (Thread-89): sending response (<Response 1691 bytes [200 OK]>) to 10.0.36.93
2022-06-28 09:18:19.458859 (Thread-90): handling status request
2022-06-28 09:18:19.459372 (Thread-90): 09:18:19  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '6e9d0c3d-4c5a-4c24-aea8-f0dbcfecdbb9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa89ab38a90>]}
2022-06-28 09:18:19.460016 (Thread-90): sending response (<Response 1691 bytes [200 OK]>) to 10.0.36.93
2022-06-28 09:18:19.565443 (Thread-91): handling status request
2022-06-28 09:18:19.565843 (Thread-91): 09:18:19  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '6e9d0c3d-4c5a-4c24-aea8-f0dbcfecdbb9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa89ab388e0>]}
2022-06-28 09:18:19.566328 (Thread-91): sending response (<Response 1691 bytes [200 OK]>) to 10.0.36.93
2022-06-28 09:19:01.436147 (Thread-92): 09:19:01  Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
2022-06-28 09:19:01.436581 (Thread-92): 09:19:01  Partial parsing: updated file: ecommerce_data_model_dbt://models/data_model/feat_user_features.sql
2022-06-28 09:19:01.440771 (Thread-92): 09:19:01  1699: static parser successfully parsed data_model/feat_user_features.sql
2022-06-28 09:19:01.485945 (Thread-92): 09:19:01  [WARNING]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.ecommerce_data_model_dbt.example

2022-06-28 09:19:01.491694 (Thread-92): 09:19:01  Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '6e9d0c3d-4c5a-4c24-aea8-f0dbcfecdbb9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa89aaf3d60>]}
2022-06-28 09:19:02.254894 (Thread-93): handling status request
2022-06-28 09:19:02.255307 (Thread-93): 09:19:02  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '6e9d0c3d-4c5a-4c24-aea8-f0dbcfecdbb9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa89aa50f70>]}
2022-06-28 09:19:02.255924 (Thread-93): sending response (<Response 2044 bytes [200 OK]>) to 10.0.36.93
2022-06-28 09:19:02.367400 (Thread-94): handling status request
2022-06-28 09:19:02.367863 (Thread-94): 09:19:02  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '6e9d0c3d-4c5a-4c24-aea8-f0dbcfecdbb9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa89aa50460>]}
2022-06-28 09:19:02.368372 (Thread-94): sending response (<Response 2044 bytes [200 OK]>) to 10.0.36.93
2022-06-28 09:19:07.081981 (Thread-95): 09:19:07  Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
2022-06-28 09:19:07.082201 (Thread-95): 09:19:07  Partial parsing enabled, no changes found, skipping parsing
2022-06-28 09:19:07.082598 (Thread-95): 09:19:07  [WARNING]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.ecommerce_data_model_dbt.example

2022-06-28 09:19:07.088665 (Thread-95): 09:19:07  Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '6e9d0c3d-4c5a-4c24-aea8-f0dbcfecdbb9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa89a9caeb0>]}
2022-06-28 09:19:07.968317 (Thread-96): handling status request
2022-06-28 09:19:07.968730 (Thread-96): 09:19:07  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '6e9d0c3d-4c5a-4c24-aea8-f0dbcfecdbb9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa89ab39880>]}
2022-06-28 09:19:07.981174 (Thread-97): handling status request
2022-06-28 09:19:07.981547 (Thread-97): 09:19:07  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '6e9d0c3d-4c5a-4c24-aea8-f0dbcfecdbb9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa89aa543d0>]}
2022-06-28 09:19:08.050710 (Thread-96): sending response (<Response 1691 bytes [200 OK]>) to 10.0.36.93
2022-06-28 09:19:08.051185 (Thread-97): sending response (<Response 1691 bytes [200 OK]>) to 10.0.36.93
2022-06-28 09:19:10.386736 (Thread-98): handling status request
2022-06-28 09:19:10.387181 (Thread-98): 09:19:10  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '6e9d0c3d-4c5a-4c24-aea8-f0dbcfecdbb9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa89ab398b0>]}
2022-06-28 09:19:10.387714 (Thread-98): sending response (<Response 1691 bytes [200 OK]>) to 10.0.36.93
2022-06-28 09:19:10.804750 (Thread-99): handling compile_sql request
2022-06-28 09:19:10.805202 (Thread-99): 09:19:10  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '6e9d0c3d-4c5a-4c24-aea8-f0dbcfecdbb9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa89ab39730>]}
2022-06-28 09:19:13.213844 (Thread-99): sending response (<Response 138 bytes [200 OK]>) to 10.0.36.93
2022-06-28 09:19:13.240912 (MainThread): 09:19:13  Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'a97887a7-bde7-42d6-9607-11e214a57a8e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f980673e4c0>]}
2022-06-28 09:19:13.241551 (MainThread): 09:19:13  Found 3 models, 0 tests, 0 snapshots, 0 analyses, 179 macros, 0 operations, 0 seed files, 15 sources, 0 exposures, 0 metrics
2022-06-28 09:19:13.242212 (Thread-1): 09:19:13  Acquiring new snowflake connection "rpc.ecommerce_data_model_dbt.request"
2022-06-28 09:19:13.242351 (Thread-1): 09:19:13  Began compiling node rpc.ecommerce_data_model_dbt.request
2022-06-28 09:19:13.242447 (Thread-1): 09:19:13  Compiling rpc.ecommerce_data_model_dbt.request
2022-06-28 09:19:13.244979 (Thread-1): 09:19:13  finished collecting timing info
2022-06-28 09:19:13.245137 (Thread-1): 09:19:13  Began executing node rpc.ecommerce_data_model_dbt.request
2022-06-28 09:19:13.245240 (Thread-1): 09:19:13  finished collecting timing info
2022-06-28 09:19:13.684295 (Thread-100): handling poll request
2022-06-28 09:19:13.684766 (Thread-100): 09:19:13  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '6e9d0c3d-4c5a-4c24-aea8-f0dbcfecdbb9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa89ab3ca30>]}
2022-06-28 09:19:13.685976 (Thread-100): sending response (<Response 6028 bytes [200 OK]>) to 10.0.36.93
2022-06-28 09:19:34.414474 (Thread-101): 09:19:34  Partial parsing enabled: 0 files deleted, 1 files added, 0 files changed.
2022-06-28 09:19:34.414884 (Thread-101): 09:19:34  Partial parsing: added file: ecommerce_data_model_dbt://models/data_model/stg_user_properties.sql
2022-06-28 09:19:34.419252 (Thread-101): 09:19:34  1699: static parser successfully parsed data_model/stg_user_properties.sql
2022-06-28 09:19:34.469295 (Thread-101): 09:19:34  [WARNING]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.ecommerce_data_model_dbt.example

2022-06-28 09:19:34.475069 (Thread-101): 09:19:34  Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '6e9d0c3d-4c5a-4c24-aea8-f0dbcfecdbb9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa89a9d4850>]}
2022-06-28 09:19:35.280118 (Thread-102): handling status request
2022-06-28 09:19:35.280577 (Thread-102): 09:19:35  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '6e9d0c3d-4c5a-4c24-aea8-f0dbcfecdbb9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa89ab52490>]}
2022-06-28 09:19:35.281107 (Thread-102): sending response (<Response 2049 bytes [200 OK]>) to 10.0.36.93
2022-06-28 09:19:35.398606 (Thread-103): handling status request
2022-06-28 09:19:35.399016 (Thread-103): 09:19:35  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '6e9d0c3d-4c5a-4c24-aea8-f0dbcfecdbb9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa89ab522e0>]}
2022-06-28 09:19:35.399520 (Thread-103): sending response (<Response 2049 bytes [200 OK]>) to 10.0.36.93
2022-06-28 09:23:55.337587 (Thread-104): 09:23:55  Unable to do partial parsing because a project config has changed
2022-06-28 09:23:55.339959 (Thread-104): 09:23:55  Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '6e9d0c3d-4c5a-4c24-aea8-f0dbcfecdbb9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa89a9e3b80>]}
2022-06-28 09:23:55.419484 (Thread-104): 09:23:55  Parsing macros/adapters.sql
2022-06-28 09:23:55.459697 (Thread-104): 09:23:55  Parsing macros/catalog.sql
2022-06-28 09:23:55.461722 (Thread-104): 09:23:55  Parsing macros/materializations/table.sql
2022-06-28 09:23:55.469026 (Thread-104): 09:23:55  Parsing macros/materializations/seed.sql
2022-06-28 09:23:55.485047 (Thread-104): 09:23:55  Parsing macros/materializations/incremental.sql
2022-06-28 09:23:55.500565 (Thread-104): 09:23:55  Parsing macros/materializations/merge.sql
2022-06-28 09:23:55.504642 (Thread-104): 09:23:55  Parsing macros/materializations/snapshot.sql
2022-06-28 09:23:55.505661 (Thread-104): 09:23:55  Parsing macros/materializations/view.sql
2022-06-28 09:23:55.507016 (Thread-104): 09:23:55  Parsing macros/adapters/metadata.sql
2022-06-28 09:23:55.514214 (Thread-104): 09:23:55  Parsing macros/adapters/columns.sql
2022-06-28 09:23:55.524122 (Thread-104): 09:23:55  Parsing macros/adapters/freshness.sql
2022-06-28 09:23:55.527053 (Thread-104): 09:23:55  Parsing macros/adapters/persist_docs.sql
2022-06-28 09:23:55.531409 (Thread-104): 09:23:55  Parsing macros/adapters/relation.sql
2022-06-28 09:23:55.541032 (Thread-104): 09:23:55  Parsing macros/adapters/schema.sql
2022-06-28 09:23:55.543252 (Thread-104): 09:23:55  Parsing macros/adapters/indexes.sql
2022-06-28 09:23:55.546002 (Thread-104): 09:23:55  Parsing macros/get_custom_name/get_custom_schema.sql
2022-06-28 09:23:55.548523 (Thread-104): 09:23:55  Parsing macros/get_custom_name/get_custom_alias.sql
2022-06-28 09:23:55.550040 (Thread-104): 09:23:55  Parsing macros/get_custom_name/get_custom_database.sql
2022-06-28 09:23:55.551584 (Thread-104): 09:23:55  Parsing macros/etc/datetime.sql
2022-06-28 09:23:55.559941 (Thread-104): 09:23:55  Parsing macros/etc/statement.sql
2022-06-28 09:23:55.564619 (Thread-104): 09:23:55  Parsing macros/generic_test_sql/unique.sql
2022-06-28 09:23:55.565463 (Thread-104): 09:23:55  Parsing macros/generic_test_sql/not_null.sql
2022-06-28 09:23:55.566118 (Thread-104): 09:23:55  Parsing macros/generic_test_sql/accepted_values.sql
2022-06-28 09:23:55.567595 (Thread-104): 09:23:55  Parsing macros/generic_test_sql/relationships.sql
2022-06-28 09:23:55.568585 (Thread-104): 09:23:55  Parsing macros/materializations/configs.sql
2022-06-28 09:23:55.570955 (Thread-104): 09:23:55  Parsing macros/materializations/hooks.sql
2022-06-28 09:23:55.574937 (Thread-104): 09:23:55  Parsing macros/materializations/models/table/table.sql
2022-06-28 09:23:55.582564 (Thread-104): 09:23:55  Parsing macros/materializations/models/table/create_table_as.sql
2022-06-28 09:23:55.585507 (Thread-104): 09:23:55  Parsing macros/materializations/models/view/create_or_replace_view.sql
2022-06-28 09:23:55.588253 (Thread-104): 09:23:55  Parsing macros/materializations/models/view/helpers.sql
2022-06-28 09:23:55.589641 (Thread-104): 09:23:55  Parsing macros/materializations/models/view/create_view_as.sql
2022-06-28 09:23:55.592014 (Thread-104): 09:23:55  Parsing macros/materializations/models/view/view.sql
2022-06-28 09:23:55.599237 (Thread-104): 09:23:55  Parsing macros/materializations/models/incremental/incremental.sql
2022-06-28 09:23:55.609453 (Thread-104): 09:23:55  Parsing macros/materializations/models/incremental/on_schema_change.sql
2022-06-28 09:23:55.625121 (Thread-104): 09:23:55  Parsing macros/materializations/models/incremental/is_incremental.sql
2022-06-28 09:23:55.626723 (Thread-104): 09:23:55  Parsing macros/materializations/models/incremental/merge.sql
2022-06-28 09:23:55.637819 (Thread-104): 09:23:55  Parsing macros/materializations/models/incremental/column_helpers.sql
2022-06-28 09:23:55.642233 (Thread-104): 09:23:55  Parsing macros/materializations/seeds/helpers.sql
2022-06-28 09:23:55.658287 (Thread-104): 09:23:55  Parsing macros/materializations/seeds/seed.sql
2022-06-28 09:23:55.664716 (Thread-104): 09:23:55  Parsing macros/materializations/tests/helpers.sql
2022-06-28 09:23:55.666601 (Thread-104): 09:23:55  Parsing macros/materializations/tests/test.sql
2022-06-28 09:23:55.671059 (Thread-104): 09:23:55  Parsing macros/materializations/tests/where_subquery.sql
2022-06-28 09:23:55.672936 (Thread-104): 09:23:55  Parsing macros/materializations/snapshots/helpers.sql
2022-06-28 09:23:55.684633 (Thread-104): 09:23:55  Parsing macros/materializations/snapshots/strategies.sql
2022-06-28 09:23:55.702610 (Thread-104): 09:23:55  Parsing macros/materializations/snapshots/snapshot_merge.sql
2022-06-28 09:23:55.704415 (Thread-104): 09:23:55  Parsing macros/materializations/snapshots/snapshot.sql
2022-06-28 09:23:55.716660 (Thread-104): 09:23:55  Parsing tests/generic/builtin.sql
2022-06-28 09:23:56.275226 (Thread-105): handling status request
2022-06-28 09:23:56.275671 (Thread-105): 09:23:56  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '6e9d0c3d-4c5a-4c24-aea8-f0dbcfecdbb9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa89a9f81c0>]}
2022-06-28 09:23:56.276578 (Thread-105): sending response (<Response 14607 bytes [200 OK]>) to 10.0.36.93
2022-06-28 09:23:56.519433 (Thread-106): handling status request
2022-06-28 09:23:56.519959 (Thread-106): 09:23:56  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '6e9d0c3d-4c5a-4c24-aea8-f0dbcfecdbb9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa89a9f86d0>]}
2022-06-28 09:23:56.520886 (Thread-106): sending response (<Response 14607 bytes [200 OK]>) to 10.0.36.93
2022-06-28 09:23:56.758362 (Thread-107): handling status request
2022-06-28 09:23:56.759006 (Thread-107): 09:23:56  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '6e9d0c3d-4c5a-4c24-aea8-f0dbcfecdbb9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa89a9f8850>]}
2022-06-28 09:23:56.760201 (Thread-107): sending response (<Response 14607 bytes [200 OK]>) to 10.0.36.93
2022-06-28 09:23:56.767744 (Thread-108): handling status request
2022-06-28 09:23:56.768107 (Thread-108): 09:23:56  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '6e9d0c3d-4c5a-4c24-aea8-f0dbcfecdbb9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa89a9ec820>]}
2022-06-28 09:23:56.768975 (Thread-108): sending response (<Response 14607 bytes [200 OK]>) to 10.0.36.93
2022-06-28 09:25:11.796183 (Thread-109): 09:25:11  Unable to do partial parsing because a project config has changed
2022-06-28 09:25:11.800233 (Thread-109): 09:25:11  Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '6e9d0c3d-4c5a-4c24-aea8-f0dbcfecdbb9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa89a9c5370>]}
2022-06-28 09:25:11.865744 (Thread-109): 09:25:11  Parsing macros/adapters.sql
2022-06-28 09:25:11.903475 (Thread-109): 09:25:11  Parsing macros/catalog.sql
2022-06-28 09:25:11.905449 (Thread-109): 09:25:11  Parsing macros/materializations/table.sql
2022-06-28 09:25:11.908501 (Thread-109): 09:25:11  Parsing macros/materializations/seed.sql
2022-06-28 09:25:11.913621 (Thread-109): 09:25:11  Parsing macros/materializations/incremental.sql
2022-06-28 09:25:11.922058 (Thread-109): 09:25:11  Parsing macros/materializations/merge.sql
2022-06-28 09:25:11.925827 (Thread-109): 09:25:11  Parsing macros/materializations/snapshot.sql
2022-06-28 09:25:11.926793 (Thread-109): 09:25:11  Parsing macros/materializations/view.sql
2022-06-28 09:25:11.928163 (Thread-109): 09:25:11  Parsing macros/adapters/metadata.sql
2022-06-28 09:25:11.935312 (Thread-109): 09:25:11  Parsing macros/adapters/columns.sql
2022-06-28 09:25:11.945104 (Thread-109): 09:25:11  Parsing macros/adapters/freshness.sql
2022-06-28 09:25:11.948052 (Thread-109): 09:25:11  Parsing macros/adapters/persist_docs.sql
2022-06-28 09:25:11.952411 (Thread-109): 09:25:11  Parsing macros/adapters/relation.sql
2022-06-28 09:25:11.961881 (Thread-109): 09:25:11  Parsing macros/adapters/schema.sql
2022-06-28 09:25:11.964158 (Thread-109): 09:25:11  Parsing macros/adapters/indexes.sql
2022-06-28 09:25:11.966885 (Thread-109): 09:25:11  Parsing macros/get_custom_name/get_custom_schema.sql
2022-06-28 09:25:11.969375 (Thread-109): 09:25:11  Parsing macros/get_custom_name/get_custom_alias.sql
2022-06-28 09:25:11.970856 (Thread-109): 09:25:11  Parsing macros/get_custom_name/get_custom_database.sql
2022-06-28 09:25:11.972420 (Thread-109): 09:25:11  Parsing macros/etc/datetime.sql
2022-06-28 09:25:11.980730 (Thread-109): 09:25:11  Parsing macros/etc/statement.sql
2022-06-28 09:25:11.985144 (Thread-109): 09:25:11  Parsing macros/generic_test_sql/unique.sql
2022-06-28 09:25:11.985893 (Thread-109): 09:25:11  Parsing macros/generic_test_sql/not_null.sql
2022-06-28 09:25:11.986462 (Thread-109): 09:25:11  Parsing macros/generic_test_sql/accepted_values.sql
2022-06-28 09:25:11.987851 (Thread-109): 09:25:11  Parsing macros/generic_test_sql/relationships.sql
2022-06-28 09:25:11.988740 (Thread-109): 09:25:11  Parsing macros/materializations/configs.sql
2022-06-28 09:25:11.991006 (Thread-109): 09:25:11  Parsing macros/materializations/hooks.sql
2022-06-28 09:25:11.994854 (Thread-109): 09:25:11  Parsing macros/materializations/models/table/table.sql
2022-06-28 09:25:12.002340 (Thread-109): 09:25:12  Parsing macros/materializations/models/table/create_table_as.sql
2022-06-28 09:25:12.005251 (Thread-109): 09:25:12  Parsing macros/materializations/models/view/create_or_replace_view.sql
2022-06-28 09:25:12.007898 (Thread-109): 09:25:12  Parsing macros/materializations/models/view/helpers.sql
2022-06-28 09:25:12.009222 (Thread-109): 09:25:12  Parsing macros/materializations/models/view/create_view_as.sql
2022-06-28 09:25:12.011491 (Thread-109): 09:25:12  Parsing macros/materializations/models/view/view.sql
2022-06-28 09:25:12.018527 (Thread-109): 09:25:12  Parsing macros/materializations/models/incremental/incremental.sql
2022-06-28 09:25:12.028375 (Thread-109): 09:25:12  Parsing macros/materializations/models/incremental/on_schema_change.sql
2022-06-28 09:25:12.043587 (Thread-109): 09:25:12  Parsing macros/materializations/models/incremental/is_incremental.sql
2022-06-28 09:25:12.045190 (Thread-109): 09:25:12  Parsing macros/materializations/models/incremental/merge.sql
2022-06-28 09:25:12.056127 (Thread-109): 09:25:12  Parsing macros/materializations/models/incremental/column_helpers.sql
2022-06-28 09:25:12.060505 (Thread-109): 09:25:12  Parsing macros/materializations/seeds/helpers.sql
2022-06-28 09:25:12.076972 (Thread-109): 09:25:12  Parsing macros/materializations/seeds/seed.sql
2022-06-28 09:25:12.082939 (Thread-109): 09:25:12  Parsing macros/materializations/tests/helpers.sql
2022-06-28 09:25:12.084801 (Thread-109): 09:25:12  Parsing macros/materializations/tests/test.sql
2022-06-28 09:25:12.089667 (Thread-109): 09:25:12  Parsing macros/materializations/tests/where_subquery.sql
2022-06-28 09:25:12.091663 (Thread-109): 09:25:12  Parsing macros/materializations/snapshots/helpers.sql
2022-06-28 09:25:12.102928 (Thread-109): 09:25:12  Parsing macros/materializations/snapshots/strategies.sql
2022-06-28 09:25:12.119510 (Thread-109): 09:25:12  Parsing macros/materializations/snapshots/snapshot_merge.sql
2022-06-28 09:25:12.121263 (Thread-109): 09:25:12  Parsing macros/materializations/snapshots/snapshot.sql
2022-06-28 09:25:12.132674 (Thread-109): 09:25:12  Parsing tests/generic/builtin.sql
2022-06-28 09:25:12.343062 (Thread-109): 09:25:12  1603: static parser failed on data_model/stg_products_viewed.sql
2022-06-28 09:25:12.346860 (Thread-109): 09:25:12  1602: parser fallback to jinja rendering on data_model/stg_products_viewed.sql
2022-06-28 09:25:12.348534 (Thread-109): 09:25:12  1699: static parser successfully parsed data_model/feat_user_features.sql
2022-06-28 09:25:12.350685 (Thread-109): 09:25:12  1699: static parser successfully parsed data_model/stg_user_properties.sql
2022-06-28 09:25:12.352711 (Thread-109): 09:25:12  1699: static parser successfully parsed data_model/stg_user_gender.sql
2022-06-28 09:25:12.354778 (Thread-109): 09:25:12  1699: static parser successfully parsed data_model/stg_tracks.sql
2022-06-28 09:25:12.370155 (Thread-109): 09:25:12  [WARNING]: Did not find matching node for patch with name 'my_first_dbt_model' in the 'models' section of file 'models/data_model/schema.yml'
2022-06-28 09:25:12.388024 (Thread-109): 09:25:12  [WARNING]: Test 'test.ecommerce_data_model_dbt.unique_my_first_dbt_model_id.16e066b321' (models/data_model/schema.yml) depends on a node named 'my_first_dbt_model' which was not found
2022-06-28 09:25:12.388384 (Thread-109): 09:25:12  [WARNING]: Test 'test.ecommerce_data_model_dbt.not_null_my_first_dbt_model_id.5fb22c2710' (models/data_model/schema.yml) depends on a node named 'my_first_dbt_model' which was not found
2022-06-28 09:25:12.444116 (Thread-109): 09:25:12  [WARNING]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.ecommerce_data_model_dbt.example

2022-06-28 09:25:12.449846 (Thread-109): 09:25:12  Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '6e9d0c3d-4c5a-4c24-aea8-f0dbcfecdbb9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa89a92ad60>]}
2022-06-28 09:25:12.796834 (Thread-110): handling status request
2022-06-28 09:25:12.797308 (Thread-110): 09:25:12  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '6e9d0c3d-4c5a-4c24-aea8-f0dbcfecdbb9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa89a9e53d0>]}
2022-06-28 09:25:12.798289 (Thread-110): sending response (<Response 18627 bytes [200 OK]>) to 10.0.36.93
2022-06-28 09:25:12.812341 (Thread-111): handling status request
2022-06-28 09:25:12.812749 (Thread-111): 09:25:12  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '6e9d0c3d-4c5a-4c24-aea8-f0dbcfecdbb9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa89a8e0700>]}
2022-06-28 09:25:12.813716 (Thread-111): sending response (<Response 18627 bytes [200 OK]>) to 10.0.36.93
2022-06-28 09:25:53.814797 (Thread-112): 09:25:53  Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
2022-06-28 09:25:53.815267 (Thread-112): 09:25:53  Partial parsing: updated file: ecommerce_data_model_dbt://models/data_model/stg_user_gender.sql
2022-06-28 09:25:53.819465 (Thread-112): 09:25:53  1603: static parser failed on data_model/stg_user_gender.sql
2022-06-28 09:25:53.823910 (Thread-112): 09:25:53  1602: parser fallback to jinja rendering on data_model/stg_user_gender.sql
2022-06-28 09:25:53.862494 (Thread-112): 09:25:53  [WARNING]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.ecommerce_data_model_dbt.example

2022-06-28 09:25:53.868276 (Thread-112): 09:25:53  Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '6e9d0c3d-4c5a-4c24-aea8-f0dbcfecdbb9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa89aa7ac40>]}
2022-06-28 09:25:54.252907 (Thread-113): 09:25:54  Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
2022-06-28 09:25:54.253140 (Thread-113): 09:25:54  Partial parsing enabled, no changes found, skipping parsing
2022-06-28 09:25:54.253588 (Thread-113): 09:25:54  [WARNING]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.ecommerce_data_model_dbt.example

2022-06-28 09:25:54.259189 (Thread-113): 09:25:54  Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '6e9d0c3d-4c5a-4c24-aea8-f0dbcfecdbb9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa89a8578e0>]}
2022-06-28 09:25:55.234910 (Thread-114): handling status request
2022-06-28 09:25:55.235323 (Thread-114): 09:25:55  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '6e9d0c3d-4c5a-4c24-aea8-f0dbcfecdbb9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa89a9e5340>]}
2022-06-28 09:25:55.235895 (Thread-114): sending response (<Response 1695 bytes [200 OK]>) to 10.0.36.93
2022-06-28 09:25:55.264432 (Thread-115): handling status request
2022-06-28 09:25:55.264873 (Thread-115): 09:25:55  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '6e9d0c3d-4c5a-4c24-aea8-f0dbcfecdbb9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa89a972b50>]}
2022-06-28 09:25:55.265384 (Thread-115): sending response (<Response 1695 bytes [200 OK]>) to 10.0.36.93
2022-06-28 09:25:55.420143 (Thread-116): handling status request
2022-06-28 09:25:55.420558 (Thread-116): 09:25:55  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '6e9d0c3d-4c5a-4c24-aea8-f0dbcfecdbb9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa89a9727c0>]}
2022-06-28 09:25:55.421099 (Thread-116): sending response (<Response 1695 bytes [200 OK]>) to 10.0.36.93
2022-06-28 09:25:56.936147 (Thread-117): handling status request
2022-06-28 09:25:56.936636 (Thread-117): 09:25:56  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '6e9d0c3d-4c5a-4c24-aea8-f0dbcfecdbb9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa89a972eb0>]}
2022-06-28 09:25:56.937187 (Thread-117): sending response (<Response 1695 bytes [200 OK]>) to 10.0.36.93
2022-06-28 09:25:57.023309 (Thread-118): handling status request
2022-06-28 09:25:57.023821 (Thread-118): 09:25:57  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '6e9d0c3d-4c5a-4c24-aea8-f0dbcfecdbb9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa89a9ec2b0>]}
2022-06-28 09:25:57.024343 (Thread-118): sending response (<Response 1695 bytes [200 OK]>) to 10.0.36.93
2022-06-28 09:25:57.045966 (Thread-119): handling compile_sql request
2022-06-28 09:25:57.046365 (Thread-119): 09:25:57  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '6e9d0c3d-4c5a-4c24-aea8-f0dbcfecdbb9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa89a9ecc10>]}
2022-06-28 09:25:59.493474 (Thread-119): sending response (<Response 138 bytes [200 OK]>) to 10.0.36.93
2022-06-28 09:25:59.520089 (MainThread): 09:25:59  Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '4cb26801-0fe3-4147-a538-500f25e667d9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f08234c19d0>]}
2022-06-28 09:25:59.520726 (MainThread): 09:25:59  Found 5 models, 0 tests, 0 snapshots, 0 analyses, 179 macros, 0 operations, 0 seed files, 15 sources, 0 exposures, 0 metrics
2022-06-28 09:25:59.521375 (Thread-1): 09:25:59  Acquiring new snowflake connection "rpc.ecommerce_data_model_dbt.request"
2022-06-28 09:25:59.521512 (Thread-1): 09:25:59  Began compiling node rpc.ecommerce_data_model_dbt.request
2022-06-28 09:25:59.521608 (Thread-1): 09:25:59  Compiling rpc.ecommerce_data_model_dbt.request
2022-06-28 09:25:59.524477 (Thread-1): 09:25:59  finished collecting timing info
2022-06-28 09:25:59.524629 (Thread-1): 09:25:59  Began executing node rpc.ecommerce_data_model_dbt.request
2022-06-28 09:25:59.524747 (Thread-1): 09:25:59  finished collecting timing info
2022-06-28 09:25:59.917382 (Thread-120): handling poll request
2022-06-28 09:25:59.917863 (Thread-120): 09:25:59  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '6e9d0c3d-4c5a-4c24-aea8-f0dbcfecdbb9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa89a9674f0>]}
2022-06-28 09:25:59.919124 (Thread-120): sending response (<Response 6648 bytes [200 OK]>) to 10.0.36.93
2022-06-28 09:26:04.073805 (Thread-121): handling status request
2022-06-28 09:26:04.074272 (Thread-121): 09:26:04  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '6e9d0c3d-4c5a-4c24-aea8-f0dbcfecdbb9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa89a965190>]}
2022-06-28 09:26:04.074819 (Thread-121): sending response (<Response 1695 bytes [200 OK]>) to 10.0.36.93
2022-06-28 09:26:04.486084 (Thread-122): handling run_sql request
2022-06-28 09:26:04.486513 (Thread-122): 09:26:04  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '6e9d0c3d-4c5a-4c24-aea8-f0dbcfecdbb9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa89a9171c0>]}
2022-06-28 09:26:06.908914 (Thread-122): sending response (<Response 138 bytes [200 OK]>) to 10.0.36.93
2022-06-28 09:26:06.934980 (MainThread): 09:26:06  Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'b695f663-85b9-432d-81fb-450b3cd856e2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fab88fc1a90>]}
2022-06-28 09:26:06.935546 (MainThread): 09:26:06  Found 5 models, 0 tests, 0 snapshots, 0 analyses, 179 macros, 0 operations, 0 seed files, 15 sources, 0 exposures, 0 metrics
2022-06-28 09:26:06.936180 (Thread-1): 09:26:06  Acquiring new snowflake connection "rpc.ecommerce_data_model_dbt.request"
2022-06-28 09:26:06.936315 (Thread-1): 09:26:06  Began compiling node rpc.ecommerce_data_model_dbt.request
2022-06-28 09:26:06.936407 (Thread-1): 09:26:06  Compiling rpc.ecommerce_data_model_dbt.request
2022-06-28 09:26:06.938967 (Thread-1): 09:26:06  finished collecting timing info
2022-06-28 09:26:06.939098 (Thread-1): 09:26:06  Began executing node rpc.ecommerce_data_model_dbt.request
2022-06-28 09:26:06.939939 (Thread-1): 09:26:06  Using snowflake connection "rpc.ecommerce_data_model_dbt.request"
2022-06-28 09:26:06.940032 (Thread-1): 09:26:06  On rpc.ecommerce_data_model_dbt.request: select user_id, gender from 
(select user_id, properties_gender as gender, row_number() over(partition by user_id order by timestamp desc) as rn from 
analytics_db.data_apps_simulated.identifies where timestamp >= '2021-06-01' and timestamp <= '2022-06-22'
and properties_gender is not null and properties_gender != '') a where rn = 1
limit 500
/* limit added automatically by dbt cloud */
2022-06-28 09:26:06.940113 (Thread-1): 09:26:06  Opening a new connection, currently in state init
2022-06-28 09:26:07.327729 (Thread-123): handling poll request
2022-06-28 09:26:07.328222 (Thread-123): 09:26:07  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '6e9d0c3d-4c5a-4c24-aea8-f0dbcfecdbb9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa89a946ee0>]}
2022-06-28 09:26:07.329164 (Thread-123): sending response (<Response 4117 bytes [200 OK]>) to 10.0.36.93
2022-06-28 09:26:08.469360 (Thread-1): 09:26:08  SQL status: SUCCESS 0 in 1.53 seconds
2022-06-28 09:26:08.470648 (Thread-1): 09:26:08  finished collecting timing info
2022-06-28 09:26:08.470836 (Thread-1): 09:26:08  On rpc.ecommerce_data_model_dbt.request: Close
2022-06-28 09:26:08.805115 (Thread-124): handling poll request
2022-06-28 09:26:08.805555 (Thread-124): 09:26:08  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '6e9d0c3d-4c5a-4c24-aea8-f0dbcfecdbb9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa89ab29a30>]}
2022-06-28 09:26:08.806122 (Thread-124): sending response (<Response 1383 bytes [200 OK]>) to 10.0.36.93
2022-06-28 09:26:10.215082 (Thread-125): handling poll request
2022-06-28 09:26:10.215519 (Thread-125): 09:26:10  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '6e9d0c3d-4c5a-4c24-aea8-f0dbcfecdbb9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa89ab29790>]}
2022-06-28 09:26:10.242417 (Thread-125): sending response (<Response 3845 bytes [200 OK]>) to 10.0.36.93
2022-06-28 09:26:58.819120 (Thread-126): 09:26:58  Unable to do partial parsing because a project config has changed
2022-06-28 09:26:58.819516 (Thread-126): 09:26:58  Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '6e9d0c3d-4c5a-4c24-aea8-f0dbcfecdbb9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa89ab67be0>]}
2022-06-28 09:26:58.913560 (Thread-126): 09:26:58  Parsing macros/adapters.sql
2022-06-28 09:26:58.952246 (Thread-126): 09:26:58  Parsing macros/catalog.sql
2022-06-28 09:26:58.954232 (Thread-126): 09:26:58  Parsing macros/materializations/table.sql
2022-06-28 09:26:58.957387 (Thread-126): 09:26:58  Parsing macros/materializations/seed.sql
2022-06-28 09:26:58.962527 (Thread-126): 09:26:58  Parsing macros/materializations/incremental.sql
2022-06-28 09:26:58.971220 (Thread-126): 09:26:58  Parsing macros/materializations/merge.sql
2022-06-28 09:26:58.975169 (Thread-126): 09:26:58  Parsing macros/materializations/snapshot.sql
2022-06-28 09:26:58.976249 (Thread-126): 09:26:58  Parsing macros/materializations/view.sql
2022-06-28 09:26:58.977642 (Thread-126): 09:26:58  Parsing macros/adapters/metadata.sql
2022-06-28 09:26:58.984833 (Thread-126): 09:26:58  Parsing macros/adapters/columns.sql
2022-06-28 09:26:58.994863 (Thread-126): 09:26:58  Parsing macros/adapters/freshness.sql
2022-06-28 09:26:58.997828 (Thread-126): 09:26:58  Parsing macros/adapters/persist_docs.sql
2022-06-28 09:26:59.002196 (Thread-126): 09:26:59  Parsing macros/adapters/relation.sql
2022-06-28 09:26:59.011562 (Thread-126): 09:26:59  Parsing macros/adapters/schema.sql
2022-06-28 09:26:59.013832 (Thread-126): 09:26:59  Parsing macros/adapters/indexes.sql
2022-06-28 09:26:59.016610 (Thread-126): 09:26:59  Parsing macros/get_custom_name/get_custom_schema.sql
2022-06-28 09:26:59.019074 (Thread-126): 09:26:59  Parsing macros/get_custom_name/get_custom_alias.sql
2022-06-28 09:26:59.020650 (Thread-126): 09:26:59  Parsing macros/get_custom_name/get_custom_database.sql
2022-06-28 09:26:59.022233 (Thread-126): 09:26:59  Parsing macros/etc/datetime.sql
2022-06-28 09:26:59.030682 (Thread-126): 09:26:59  Parsing macros/etc/statement.sql
2022-06-28 09:26:59.035188 (Thread-126): 09:26:59  Parsing macros/generic_test_sql/unique.sql
2022-06-28 09:26:59.036060 (Thread-126): 09:26:59  Parsing macros/generic_test_sql/not_null.sql
2022-06-28 09:26:59.036682 (Thread-126): 09:26:59  Parsing macros/generic_test_sql/accepted_values.sql
2022-06-28 09:26:59.038062 (Thread-126): 09:26:59  Parsing macros/generic_test_sql/relationships.sql
2022-06-28 09:26:59.038949 (Thread-126): 09:26:59  Parsing macros/materializations/configs.sql
2022-06-28 09:26:59.041313 (Thread-126): 09:26:59  Parsing macros/materializations/hooks.sql
2022-06-28 09:26:59.045202 (Thread-126): 09:26:59  Parsing macros/materializations/models/table/table.sql
2022-06-28 09:26:59.053212 (Thread-126): 09:26:59  Parsing macros/materializations/models/table/create_table_as.sql
2022-06-28 09:26:59.056152 (Thread-126): 09:26:59  Parsing macros/materializations/models/view/create_or_replace_view.sql
2022-06-28 09:26:59.058810 (Thread-126): 09:26:59  Parsing macros/materializations/models/view/helpers.sql
2022-06-28 09:26:59.060189 (Thread-126): 09:26:59  Parsing macros/materializations/models/view/create_view_as.sql
2022-06-28 09:26:59.062484 (Thread-126): 09:26:59  Parsing macros/materializations/models/view/view.sql
2022-06-28 09:26:59.069631 (Thread-126): 09:26:59  Parsing macros/materializations/models/incremental/incremental.sql
2022-06-28 09:26:59.079609 (Thread-126): 09:26:59  Parsing macros/materializations/models/incremental/on_schema_change.sql
2022-06-28 09:26:59.095445 (Thread-126): 09:26:59  Parsing macros/materializations/models/incremental/is_incremental.sql
2022-06-28 09:26:59.097172 (Thread-126): 09:26:59  Parsing macros/materializations/models/incremental/merge.sql
2022-06-28 09:26:59.108427 (Thread-126): 09:26:59  Parsing macros/materializations/models/incremental/column_helpers.sql
2022-06-28 09:26:59.112977 (Thread-126): 09:26:59  Parsing macros/materializations/seeds/helpers.sql
2022-06-28 09:26:59.129789 (Thread-126): 09:26:59  Parsing macros/materializations/seeds/seed.sql
2022-06-28 09:26:59.138100 (Thread-126): 09:26:59  Parsing macros/materializations/tests/helpers.sql
2022-06-28 09:26:59.140777 (Thread-126): 09:26:59  Parsing macros/materializations/tests/test.sql
2022-06-28 09:26:59.147264 (Thread-126): 09:26:59  Parsing macros/materializations/tests/where_subquery.sql
2022-06-28 09:26:59.149451 (Thread-126): 09:26:59  Parsing macros/materializations/snapshots/helpers.sql
2022-06-28 09:26:59.165231 (Thread-126): 09:26:59  Parsing macros/materializations/snapshots/strategies.sql
2022-06-28 09:26:59.188259 (Thread-126): 09:26:59  Parsing macros/materializations/snapshots/snapshot_merge.sql
2022-06-28 09:26:59.190460 (Thread-126): 09:26:59  Parsing macros/materializations/snapshots/snapshot.sql
2022-06-28 09:26:59.206431 (Thread-126): 09:26:59  Parsing tests/generic/builtin.sql
2022-06-28 09:26:59.730677 (Thread-127): handling status request
2022-06-28 09:26:59.731104 (Thread-127): 09:26:59  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '6e9d0c3d-4c5a-4c24-aea8-f0dbcfecdbb9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa89a8d5550>]}
2022-06-28 09:26:59.732056 (Thread-127): sending response (<Response 14607 bytes [200 OK]>) to 10.0.36.93
2022-06-28 09:26:59.823323 (Thread-128): handling status request
2022-06-28 09:26:59.823773 (Thread-128): 09:26:59  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '6e9d0c3d-4c5a-4c24-aea8-f0dbcfecdbb9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa89a9dd100>]}
2022-06-28 09:26:59.824650 (Thread-128): sending response (<Response 14607 bytes [200 OK]>) to 10.0.36.93
2022-06-28 09:27:00.130081 (Thread-129): handling status request
2022-06-28 09:27:00.130527 (Thread-129): 09:27:00  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '6e9d0c3d-4c5a-4c24-aea8-f0dbcfecdbb9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa89a9dd220>]}
2022-06-28 09:27:00.131377 (Thread-129): sending response (<Response 14607 bytes [200 OK]>) to 10.0.36.93
2022-06-28 09:27:00.277609 (Thread-130): handling status request
2022-06-28 09:27:00.278024 (Thread-130): 09:27:00  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '6e9d0c3d-4c5a-4c24-aea8-f0dbcfecdbb9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa89a9dd5b0>]}
2022-06-28 09:27:00.278874 (Thread-130): sending response (<Response 14607 bytes [200 OK]>) to 10.0.36.93
2022-06-28 09:27:02.347298 (Thread-131): handling status request
2022-06-28 09:27:02.347748 (Thread-131): 09:27:02  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '6e9d0c3d-4c5a-4c24-aea8-f0dbcfecdbb9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa89a9dd850>]}
2022-06-28 09:27:02.348628 (Thread-131): sending response (<Response 14607 bytes [200 OK]>) to 10.0.36.93
2022-06-28 09:27:02.764036 (Thread-132): handling run_sql request
2022-06-28 09:27:02.764468 (Thread-132): 09:27:02  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '6e9d0c3d-4c5a-4c24-aea8-f0dbcfecdbb9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa89a9dd670>]}
2022-06-28 09:27:02.764924 (Thread-132): sending response (<Response 429 bytes [200 OK]>) to 10.0.36.93
2022-06-28 09:27:07.273900 (Thread-133): handling status request
2022-06-28 09:27:07.274362 (Thread-133): 09:27:07  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '6e9d0c3d-4c5a-4c24-aea8-f0dbcfecdbb9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa89a870940>]}
2022-06-28 09:27:07.275261 (Thread-133): sending response (<Response 14607 bytes [200 OK]>) to 10.0.36.93
2022-06-28 09:27:07.676819 (Thread-134): handling compile_sql request
2022-06-28 09:27:07.677231 (Thread-134): 09:27:07  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '6e9d0c3d-4c5a-4c24-aea8-f0dbcfecdbb9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa89a870160>]}
2022-06-28 09:27:07.677628 (Thread-134): sending response (<Response 429 bytes [200 OK]>) to 10.0.36.93
2022-06-28 09:27:11.909151 (Thread-135): 09:27:11  Unable to do partial parsing because a project config has changed
2022-06-28 09:27:11.909533 (Thread-135): 09:27:11  Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '6e9d0c3d-4c5a-4c24-aea8-f0dbcfecdbb9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa89a8d5550>]}
2022-06-28 09:27:11.962994 (Thread-135): 09:27:11  Parsing macros/adapters.sql
2022-06-28 09:27:12.002692 (Thread-135): 09:27:12  Parsing macros/catalog.sql
2022-06-28 09:27:12.004710 (Thread-135): 09:27:12  Parsing macros/materializations/table.sql
2022-06-28 09:27:12.007849 (Thread-135): 09:27:12  Parsing macros/materializations/seed.sql
2022-06-28 09:27:12.012995 (Thread-135): 09:27:12  Parsing macros/materializations/incremental.sql
2022-06-28 09:27:12.021637 (Thread-135): 09:27:12  Parsing macros/materializations/merge.sql
2022-06-28 09:27:12.025492 (Thread-135): 09:27:12  Parsing macros/materializations/snapshot.sql
2022-06-28 09:27:12.026469 (Thread-135): 09:27:12  Parsing macros/materializations/view.sql
2022-06-28 09:27:12.027864 (Thread-135): 09:27:12  Parsing macros/adapters/metadata.sql
2022-06-28 09:27:12.035229 (Thread-135): 09:27:12  Parsing macros/adapters/columns.sql
2022-06-28 09:27:12.048357 (Thread-135): 09:27:12  Parsing macros/adapters/freshness.sql
2022-06-28 09:27:12.051289 (Thread-135): 09:27:12  Parsing macros/adapters/persist_docs.sql
2022-06-28 09:27:12.055681 (Thread-135): 09:27:12  Parsing macros/adapters/relation.sql
2022-06-28 09:27:12.065219 (Thread-135): 09:27:12  Parsing macros/adapters/schema.sql
2022-06-28 09:27:12.067435 (Thread-135): 09:27:12  Parsing macros/adapters/indexes.sql
2022-06-28 09:27:12.070174 (Thread-135): 09:27:12  Parsing macros/get_custom_name/get_custom_schema.sql
2022-06-28 09:27:12.072687 (Thread-135): 09:27:12  Parsing macros/get_custom_name/get_custom_alias.sql
2022-06-28 09:27:12.074190 (Thread-135): 09:27:12  Parsing macros/get_custom_name/get_custom_database.sql
2022-06-28 09:27:12.075809 (Thread-135): 09:27:12  Parsing macros/etc/datetime.sql
2022-06-28 09:27:12.084272 (Thread-135): 09:27:12  Parsing macros/etc/statement.sql
2022-06-28 09:27:12.088797 (Thread-135): 09:27:12  Parsing macros/generic_test_sql/unique.sql
2022-06-28 09:27:12.089598 (Thread-135): 09:27:12  Parsing macros/generic_test_sql/not_null.sql
2022-06-28 09:27:12.090193 (Thread-135): 09:27:12  Parsing macros/generic_test_sql/accepted_values.sql
2022-06-28 09:27:12.091560 (Thread-135): 09:27:12  Parsing macros/generic_test_sql/relationships.sql
2022-06-28 09:27:12.092490 (Thread-135): 09:27:12  Parsing macros/materializations/configs.sql
2022-06-28 09:27:12.094778 (Thread-135): 09:27:12  Parsing macros/materializations/hooks.sql
2022-06-28 09:27:12.098591 (Thread-135): 09:27:12  Parsing macros/materializations/models/table/table.sql
2022-06-28 09:27:12.106111 (Thread-135): 09:27:12  Parsing macros/materializations/models/table/create_table_as.sql
2022-06-28 09:27:12.109052 (Thread-135): 09:27:12  Parsing macros/materializations/models/view/create_or_replace_view.sql
2022-06-28 09:27:12.111747 (Thread-135): 09:27:12  Parsing macros/materializations/models/view/helpers.sql
2022-06-28 09:27:12.113101 (Thread-135): 09:27:12  Parsing macros/materializations/models/view/create_view_as.sql
2022-06-28 09:27:12.115419 (Thread-135): 09:27:12  Parsing macros/materializations/models/view/view.sql
2022-06-28 09:27:12.122878 (Thread-135): 09:27:12  Parsing macros/materializations/models/incremental/incremental.sql
2022-06-28 09:27:12.133216 (Thread-135): 09:27:12  Parsing macros/materializations/models/incremental/on_schema_change.sql
2022-06-28 09:27:12.152164 (Thread-135): 09:27:12  Parsing macros/materializations/models/incremental/is_incremental.sql
2022-06-28 09:27:12.154197 (Thread-135): 09:27:12  Parsing macros/materializations/models/incremental/merge.sql
2022-06-28 09:27:12.174560 (Thread-135): 09:27:12  Parsing macros/materializations/models/incremental/column_helpers.sql
2022-06-28 09:27:12.182859 (Thread-135): 09:27:12  Parsing macros/materializations/seeds/helpers.sql
2022-06-28 09:27:12.205425 (Thread-135): 09:27:12  Parsing macros/materializations/seeds/seed.sql
2022-06-28 09:27:12.224839 (Thread-135): 09:27:12  Parsing macros/materializations/tests/helpers.sql
2022-06-28 09:27:12.232371 (Thread-135): 09:27:12  Parsing macros/materializations/tests/test.sql
2022-06-28 09:27:12.242493 (Thread-135): 09:27:12  Parsing macros/materializations/tests/where_subquery.sql
2022-06-28 09:27:12.245107 (Thread-135): 09:27:12  Parsing macros/materializations/snapshots/helpers.sql
2022-06-28 09:27:12.260688 (Thread-135): 09:27:12  Parsing macros/materializations/snapshots/strategies.sql
2022-06-28 09:27:12.279832 (Thread-135): 09:27:12  Parsing macros/materializations/snapshots/snapshot_merge.sql
2022-06-28 09:27:12.281629 (Thread-135): 09:27:12  Parsing macros/materializations/snapshots/snapshot.sql
2022-06-28 09:27:12.293291 (Thread-135): 09:27:12  Parsing tests/generic/builtin.sql
2022-06-28 09:27:12.807107 (Thread-136): handling status request
2022-06-28 09:27:12.807534 (Thread-136): 09:27:12  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '6e9d0c3d-4c5a-4c24-aea8-f0dbcfecdbb9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa89a7ccee0>]}
2022-06-28 09:27:12.808484 (Thread-136): sending response (<Response 14607 bytes [200 OK]>) to 10.0.36.93
2022-06-28 09:27:12.907529 (Thread-137): handling status request
2022-06-28 09:27:12.908017 (Thread-137): 09:27:12  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '6e9d0c3d-4c5a-4c24-aea8-f0dbcfecdbb9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa89a7cc400>]}
2022-06-28 09:27:12.908995 (Thread-137): sending response (<Response 14607 bytes [200 OK]>) to 10.0.36.93
2022-06-28 09:27:13.296164 (Thread-138): handling status request
2022-06-28 09:27:13.296664 (Thread-138): 09:27:13  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '6e9d0c3d-4c5a-4c24-aea8-f0dbcfecdbb9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa89a994880>]}
2022-06-28 09:27:13.297564 (Thread-138): sending response (<Response 14607 bytes [200 OK]>) to 10.0.36.93
2022-06-28 09:27:13.419576 (Thread-139): handling status request
2022-06-28 09:27:13.420034 (Thread-139): 09:27:13  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '6e9d0c3d-4c5a-4c24-aea8-f0dbcfecdbb9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa89a7cc820>]}
2022-06-28 09:27:13.420903 (Thread-139): sending response (<Response 14607 bytes [200 OK]>) to 10.0.36.93
2022-06-28 09:27:14.583757 (Thread-140): 09:27:14  Unable to do partial parsing because a project config has changed
2022-06-28 09:27:14.584133 (Thread-140): 09:27:14  Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '6e9d0c3d-4c5a-4c24-aea8-f0dbcfecdbb9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa89a972c40>]}
2022-06-28 09:27:14.632852 (Thread-140): 09:27:14  Parsing macros/adapters.sql
2022-06-28 09:27:14.672018 (Thread-140): 09:27:14  Parsing macros/catalog.sql
2022-06-28 09:27:14.673983 (Thread-140): 09:27:14  Parsing macros/materializations/table.sql
2022-06-28 09:27:14.677142 (Thread-140): 09:27:14  Parsing macros/materializations/seed.sql
2022-06-28 09:27:14.682214 (Thread-140): 09:27:14  Parsing macros/materializations/incremental.sql
2022-06-28 09:27:14.690701 (Thread-140): 09:27:14  Parsing macros/materializations/merge.sql
2022-06-28 09:27:14.694567 (Thread-140): 09:27:14  Parsing macros/materializations/snapshot.sql
2022-06-28 09:27:14.695574 (Thread-140): 09:27:14  Parsing macros/materializations/view.sql
2022-06-28 09:27:14.697006 (Thread-140): 09:27:14  Parsing macros/adapters/metadata.sql
2022-06-28 09:27:14.704014 (Thread-140): 09:27:14  Parsing macros/adapters/columns.sql
2022-06-28 09:27:14.713798 (Thread-140): 09:27:14  Parsing macros/adapters/freshness.sql
2022-06-28 09:27:14.716718 (Thread-140): 09:27:14  Parsing macros/adapters/persist_docs.sql
2022-06-28 09:27:14.721101 (Thread-140): 09:27:14  Parsing macros/adapters/relation.sql
2022-06-28 09:27:14.730618 (Thread-140): 09:27:14  Parsing macros/adapters/schema.sql
2022-06-28 09:27:14.732887 (Thread-140): 09:27:14  Parsing macros/adapters/indexes.sql
2022-06-28 09:27:14.735669 (Thread-140): 09:27:14  Parsing macros/get_custom_name/get_custom_schema.sql
2022-06-28 09:27:14.738154 (Thread-140): 09:27:14  Parsing macros/get_custom_name/get_custom_alias.sql
2022-06-28 09:27:14.739695 (Thread-140): 09:27:14  Parsing macros/get_custom_name/get_custom_database.sql
2022-06-28 09:27:14.741291 (Thread-140): 09:27:14  Parsing macros/etc/datetime.sql
2022-06-28 09:27:14.749653 (Thread-140): 09:27:14  Parsing macros/etc/statement.sql
2022-06-28 09:27:14.754057 (Thread-140): 09:27:14  Parsing macros/generic_test_sql/unique.sql
2022-06-28 09:27:14.754813 (Thread-140): 09:27:14  Parsing macros/generic_test_sql/not_null.sql
2022-06-28 09:27:14.755399 (Thread-140): 09:27:14  Parsing macros/generic_test_sql/accepted_values.sql
2022-06-28 09:27:14.756813 (Thread-140): 09:27:14  Parsing macros/generic_test_sql/relationships.sql
2022-06-28 09:27:14.757714 (Thread-140): 09:27:14  Parsing macros/materializations/configs.sql
2022-06-28 09:27:14.760084 (Thread-140): 09:27:14  Parsing macros/materializations/hooks.sql
2022-06-28 09:27:14.763925 (Thread-140): 09:27:14  Parsing macros/materializations/models/table/table.sql
2022-06-28 09:27:14.771501 (Thread-140): 09:27:14  Parsing macros/materializations/models/table/create_table_as.sql
2022-06-28 09:27:14.774406 (Thread-140): 09:27:14  Parsing macros/materializations/models/view/create_or_replace_view.sql
2022-06-28 09:27:14.777098 (Thread-140): 09:27:14  Parsing macros/materializations/models/view/helpers.sql
2022-06-28 09:27:14.778436 (Thread-140): 09:27:14  Parsing macros/materializations/models/view/create_view_as.sql
2022-06-28 09:27:14.780809 (Thread-140): 09:27:14  Parsing macros/materializations/models/view/view.sql
2022-06-28 09:27:14.788236 (Thread-140): 09:27:14  Parsing macros/materializations/models/incremental/incremental.sql
2022-06-28 09:27:14.959468 (Thread-140): 09:27:14  Parsing macros/materializations/models/incremental/on_schema_change.sql
2022-06-28 09:27:14.975376 (Thread-140): 09:27:14  Parsing macros/materializations/models/incremental/is_incremental.sql
2022-06-28 09:27:14.977169 (Thread-140): 09:27:14  Parsing macros/materializations/models/incremental/merge.sql
2022-06-28 09:27:14.988835 (Thread-140): 09:27:14  Parsing macros/materializations/models/incremental/column_helpers.sql
2022-06-28 09:27:14.993404 (Thread-140): 09:27:14  Parsing macros/materializations/seeds/helpers.sql
2022-06-28 09:27:15.013248 (Thread-140): 09:27:15  Parsing macros/materializations/seeds/seed.sql
2022-06-28 09:27:15.019387 (Thread-140): 09:27:15  Parsing macros/materializations/tests/helpers.sql
2022-06-28 09:27:15.021294 (Thread-140): 09:27:15  Parsing macros/materializations/tests/test.sql
2022-06-28 09:27:15.025606 (Thread-140): 09:27:15  Parsing macros/materializations/tests/where_subquery.sql
2022-06-28 09:27:15.027386 (Thread-140): 09:27:15  Parsing macros/materializations/snapshots/helpers.sql
2022-06-28 09:27:15.038362 (Thread-140): 09:27:15  Parsing macros/materializations/snapshots/strategies.sql
2022-06-28 09:27:15.055842 (Thread-140): 09:27:15  Parsing macros/materializations/snapshots/snapshot_merge.sql
2022-06-28 09:27:15.057591 (Thread-140): 09:27:15  Parsing macros/materializations/snapshots/snapshot.sql
2022-06-28 09:27:15.069037 (Thread-140): 09:27:15  Parsing tests/generic/builtin.sql
2022-06-28 09:27:15.258335 (Thread-140): 09:27:15  1603: static parser failed on data_model/stg_products_viewed.sql
2022-06-28 09:27:15.262114 (Thread-140): 09:27:15  1602: parser fallback to jinja rendering on data_model/stg_products_viewed.sql
2022-06-28 09:27:15.263426 (Thread-140): 09:27:15  1699: static parser successfully parsed data_model/feat_user_features.sql
2022-06-28 09:27:15.265841 (Thread-140): 09:27:15  1699: static parser successfully parsed data_model/stg_user_properties.sql
2022-06-28 09:27:15.268110 (Thread-140): 09:27:15  1603: static parser failed on data_model/stg_user_gender.sql
2022-06-28 09:27:15.272024 (Thread-140): 09:27:15  1602: parser fallback to jinja rendering on data_model/stg_user_gender.sql
2022-06-28 09:27:15.273048 (Thread-140): 09:27:15  1699: static parser successfully parsed data_model/stg_tracks.sql
2022-06-28 09:27:15.288718 (Thread-140): 09:27:15  [WARNING]: Did not find matching node for patch with name 'my_first_dbt_model' in the 'models' section of file 'models/data_model/schema.yml'
2022-06-28 09:27:15.305489 (Thread-140): 09:27:15  [WARNING]: Test 'test.ecommerce_data_model_dbt.unique_my_first_dbt_model_id.16e066b321' (models/data_model/schema.yml) depends on a node named 'my_first_dbt_model' which was not found
2022-06-28 09:27:15.305839 (Thread-140): 09:27:15  [WARNING]: Test 'test.ecommerce_data_model_dbt.not_null_my_first_dbt_model_id.5fb22c2710' (models/data_model/schema.yml) depends on a node named 'my_first_dbt_model' which was not found
2022-06-28 09:27:15.354357 (Thread-140): 09:27:15  [WARNING]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.ecommerce_data_model_dbt.example

2022-06-28 09:27:15.363403 (Thread-140): 09:27:15  Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '6e9d0c3d-4c5a-4c24-aea8-f0dbcfecdbb9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa89a8706d0>]}
2022-06-28 09:27:15.549026 (Thread-141): handling status request
2022-06-28 09:27:15.549430 (Thread-141): 09:27:15  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '6e9d0c3d-4c5a-4c24-aea8-f0dbcfecdbb9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa89a8f8b80>]}
2022-06-28 09:27:15.550410 (Thread-141): sending response (<Response 18933 bytes [200 OK]>) to 10.0.36.93
2022-06-28 09:27:15.595785 (Thread-142): handling status request
2022-06-28 09:27:15.596198 (Thread-142): 09:27:15  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '6e9d0c3d-4c5a-4c24-aea8-f0dbcfecdbb9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa89a8f8fa0>]}
2022-06-28 09:27:15.597183 (Thread-142): sending response (<Response 18933 bytes [200 OK]>) to 10.0.36.93
2022-06-28 09:27:16.380219 (Thread-143): handling status request
2022-06-28 09:27:16.380652 (Thread-143): 09:27:16  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '6e9d0c3d-4c5a-4c24-aea8-f0dbcfecdbb9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa89a86b4f0>]}
2022-06-28 09:27:16.381629 (Thread-143): sending response (<Response 18933 bytes [200 OK]>) to 10.0.36.93
2022-06-28 09:27:16.785534 (Thread-144): handling run_sql request
2022-06-28 09:27:16.785952 (Thread-144): 09:27:16  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '6e9d0c3d-4c5a-4c24-aea8-f0dbcfecdbb9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa89a8f8610>]}
2022-06-28 09:27:19.204991 (Thread-144): sending response (<Response 138 bytes [200 OK]>) to 10.0.36.93
2022-06-28 09:27:19.231078 (MainThread): 09:27:19  Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'a2ee374c-9c41-43fa-9523-99aac1896856', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa74ec34be0>]}
2022-06-28 09:27:19.231697 (MainThread): 09:27:19  Found 5 models, 0 tests, 0 snapshots, 0 analyses, 179 macros, 0 operations, 0 seed files, 15 sources, 0 exposures, 0 metrics
2022-06-28 09:27:19.232332 (Thread-1): 09:27:19  Acquiring new snowflake connection "rpc.ecommerce_data_model_dbt.request"
2022-06-28 09:27:19.232470 (Thread-1): 09:27:19  Began compiling node rpc.ecommerce_data_model_dbt.request
2022-06-28 09:27:19.232582 (Thread-1): 09:27:19  Compiling rpc.ecommerce_data_model_dbt.request
2022-06-28 09:27:19.235284 (Thread-1): 09:27:19  finished collecting timing info
2022-06-28 09:27:19.235434 (Thread-1): 09:27:19  Began executing node rpc.ecommerce_data_model_dbt.request
2022-06-28 09:27:19.236310 (Thread-1): 09:27:19  Using snowflake connection "rpc.ecommerce_data_model_dbt.request"
2022-06-28 09:27:19.236411 (Thread-1): 09:27:19  On rpc.ecommerce_data_model_dbt.request: select user_id, gender from 
(select user_id, properties_gender as gender, row_number() over(partition by user_id order by timestamp desc) as rn from 
analytics_db.data_apps_simulated.identifies where timestamp >= '2021-06-01' and timestamp <= '2022-06-29'
and properties_gender is not null and properties_gender != '') a where rn = 1
limit 500
/* limit added automatically by dbt cloud */
2022-06-28 09:27:19.236497 (Thread-1): 09:27:19  Opening a new connection, currently in state init
2022-06-28 09:27:19.618045 (Thread-145): handling poll request
2022-06-28 09:27:19.618514 (Thread-145): 09:27:19  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '6e9d0c3d-4c5a-4c24-aea8-f0dbcfecdbb9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa89a8573d0>]}
2022-06-28 09:27:19.619472 (Thread-145): sending response (<Response 4127 bytes [200 OK]>) to 10.0.36.93
2022-06-28 09:27:20.295232 (Thread-1): 09:27:20  SQL status: SUCCESS 5 in 1.06 seconds
2022-06-28 09:27:20.296736 (Thread-1): 09:27:20  finished collecting timing info
2022-06-28 09:27:20.296930 (Thread-1): 09:27:20  On rpc.ecommerce_data_model_dbt.request: Close
2022-06-28 09:27:21.033229 (Thread-146): handling poll request
2022-06-28 09:27:21.033642 (Thread-146): 09:27:21  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '6e9d0c3d-4c5a-4c24-aea8-f0dbcfecdbb9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa89a9987f0>]}
2022-06-28 09:27:21.034536 (Thread-146): sending response (<Response 4911 bytes [200 OK]>) to 10.0.36.93
2022-06-28 09:29:36.652717 (Thread-147): 09:29:36  Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
2022-06-28 09:29:36.655002 (Thread-147): 09:29:36  Partial parsing: updated file: ecommerce_data_model_dbt://models/data_model/stg_user_gender.sql
2022-06-28 09:29:36.661134 (Thread-147): 09:29:36  1603: static parser failed on data_model/stg_user_gender.sql
2022-06-28 09:29:36.665643 (Thread-147): 09:29:36  1602: parser fallback to jinja rendering on data_model/stg_user_gender.sql
2022-06-28 09:29:36.714046 (Thread-147): 09:29:36  [WARNING]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.ecommerce_data_model_dbt.example

2022-06-28 09:29:36.719928 (Thread-147): 09:29:36  Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '6e9d0c3d-4c5a-4c24-aea8-f0dbcfecdbb9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa89ad95b20>]}
2022-06-28 09:29:37.479338 (Thread-148): handling status request
2022-06-28 09:29:37.479811 (Thread-148): 09:29:37  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '6e9d0c3d-4c5a-4c24-aea8-f0dbcfecdbb9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa89a837e50>]}
2022-06-28 09:29:37.480391 (Thread-148): sending response (<Response 2349 bytes [200 OK]>) to 10.0.36.93
2022-06-28 09:29:37.758334 (Thread-149): handling status request
2022-06-28 09:29:37.758742 (Thread-149): 09:29:37  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '6e9d0c3d-4c5a-4c24-aea8-f0dbcfecdbb9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa89a9e11f0>]}
2022-06-28 09:29:37.759258 (Thread-149): sending response (<Response 2349 bytes [200 OK]>) to 10.0.36.93
2022-06-28 09:29:37.997529 (Thread-150): handling status request
2022-06-28 09:29:37.997938 (Thread-150): 09:29:37  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '6e9d0c3d-4c5a-4c24-aea8-f0dbcfecdbb9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa89a9e1910>]}
2022-06-28 09:29:37.998459 (Thread-150): sending response (<Response 2349 bytes [200 OK]>) to 10.0.36.93
2022-06-28 09:29:38.055732 (Thread-151): handling status request
2022-06-28 09:29:38.056146 (Thread-151): 09:29:38  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '6e9d0c3d-4c5a-4c24-aea8-f0dbcfecdbb9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa89a9e15b0>]}
2022-06-28 09:29:38.056664 (Thread-151): sending response (<Response 2349 bytes [200 OK]>) to 10.0.36.93
2022-06-28 09:30:00.737553 (Thread-152): 09:30:00  Partial parsing enabled: 1 files deleted, 1 files added, 0 files changed.
2022-06-28 09:30:00.737964 (Thread-152): 09:30:00  Partial parsing: added file: ecommerce_data_model_dbt://models/data_model/stg_user_traits.sql
2022-06-28 09:30:00.738114 (Thread-152): 09:30:00  Partial parsing: deleted file: ecommerce_data_model_dbt://models/data_model/stg_user_gender.sql
2022-06-28 09:30:00.742309 (Thread-152): 09:30:00  1603: static parser failed on data_model/stg_user_traits.sql
2022-06-28 09:30:00.746292 (Thread-152): 09:30:00  1602: parser fallback to jinja rendering on data_model/stg_user_traits.sql
2022-06-28 09:30:00.791892 (Thread-152): 09:30:00  [WARNING]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.ecommerce_data_model_dbt.example

2022-06-28 09:30:00.797505 (Thread-152): 09:30:00  Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '6e9d0c3d-4c5a-4c24-aea8-f0dbcfecdbb9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa89a9a9c70>]}
2022-06-28 09:30:01.667305 (Thread-153): handling status request
2022-06-28 09:30:01.667769 (Thread-153): 09:30:01  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '6e9d0c3d-4c5a-4c24-aea8-f0dbcfecdbb9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa8ec129ca0>]}
2022-06-28 09:30:01.668335 (Thread-153): sending response (<Response 2684 bytes [200 OK]>) to 10.0.36.93
2022-06-28 09:30:01.689289 (Thread-154): handling status request
2022-06-28 09:30:01.689726 (Thread-154): 09:30:01  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '6e9d0c3d-4c5a-4c24-aea8-f0dbcfecdbb9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa89a85a970>]}
2022-06-28 09:30:01.760677 (Thread-154): sending response (<Response 2684 bytes [200 OK]>) to 10.0.36.93
2022-06-28 09:33:14.654095 (Thread-155): handling status request
2022-06-28 09:33:14.654522 (Thread-155): 09:33:14  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '6e9d0c3d-4c5a-4c24-aea8-f0dbcfecdbb9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa8ec129e50>]}
2022-06-28 09:33:14.655119 (Thread-155): sending response (<Response 2684 bytes [200 OK]>) to 10.0.36.93
2022-06-28 09:33:14.836465 (Thread-156): handling status request
2022-06-28 09:33:14.836907 (Thread-156): 09:33:14  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '6e9d0c3d-4c5a-4c24-aea8-f0dbcfecdbb9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa8ec115760>]}
2022-06-28 09:33:14.837458 (Thread-156): sending response (<Response 2684 bytes [200 OK]>) to 10.0.36.93
2022-06-28 09:33:15.522370 (Thread-157): handling ps request
2022-06-28 09:33:15.522811 (Thread-157): 09:33:15  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '6e9d0c3d-4c5a-4c24-aea8-f0dbcfecdbb9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa8ec115be0>]}
2022-06-28 09:33:15.523803 (Thread-157): sending response (<Response 6687 bytes [200 OK]>) to 10.0.36.93
2022-06-28 09:33:15.556129 (Thread-158): handling status request
2022-06-28 09:33:15.556552 (Thread-158): 09:33:15  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '6e9d0c3d-4c5a-4c24-aea8-f0dbcfecdbb9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa8ed34c5b0>]}
2022-06-28 09:33:15.557055 (Thread-158): sending response (<Response 2684 bytes [200 OK]>) to 10.0.36.93
2022-06-28 09:33:16.729604 (Thread-159): handling status request
2022-06-28 09:33:16.730022 (Thread-159): 09:33:16  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '6e9d0c3d-4c5a-4c24-aea8-f0dbcfecdbb9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa8ec13d130>]}
2022-06-28 09:33:16.730561 (Thread-159): sending response (<Response 2684 bytes [200 OK]>) to 10.0.36.93
2022-06-28 09:33:49.612326 (Thread-160): handling status request
2022-06-28 09:33:49.612749 (Thread-160): 09:33:49  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '6e9d0c3d-4c5a-4c24-aea8-f0dbcfecdbb9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa8ec13d940>]}
2022-06-28 09:33:49.613269 (Thread-160): sending response (<Response 2684 bytes [200 OK]>) to 10.0.36.93
2022-06-28 09:33:53.340784 (Thread-161): 09:33:53  Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
2022-06-28 09:33:53.341025 (Thread-161): 09:33:53  Partial parsing enabled, no changes found, skipping parsing
2022-06-28 09:33:53.341489 (Thread-161): 09:33:53  [WARNING]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.ecommerce_data_model_dbt.example

2022-06-28 09:33:53.347191 (Thread-161): 09:33:53  Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '6e9d0c3d-4c5a-4c24-aea8-f0dbcfecdbb9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa89a961940>]}
2022-06-28 09:33:54.252177 (Thread-162): handling status request
2022-06-28 09:33:54.252631 (Thread-162): 09:33:54  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '6e9d0c3d-4c5a-4c24-aea8-f0dbcfecdbb9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa8e018d4c0>]}
2022-06-28 09:33:54.253141 (Thread-162): sending response (<Response 1695 bytes [200 OK]>) to 10.0.36.93
2022-06-28 09:33:54.296185 (Thread-163): handling status request
2022-06-28 09:33:54.296597 (Thread-163): 09:33:54  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '6e9d0c3d-4c5a-4c24-aea8-f0dbcfecdbb9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa8ec073f40>]}
2022-06-28 09:33:54.297108 (Thread-163): sending response (<Response 1695 bytes [200 OK]>) to 10.0.36.93
2022-06-28 09:34:09.712202 (Thread-164): handling status request
2022-06-28 09:34:09.712724 (Thread-164): 09:34:09  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '6e9d0c3d-4c5a-4c24-aea8-f0dbcfecdbb9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa8ec073d90>]}
2022-06-28 09:34:09.713289 (Thread-164): sending response (<Response 1695 bytes [200 OK]>) to 10.0.36.93
2022-06-29 07:10:37.219469 (MainThread): Running with dbt=1.0.8
2022-06-29 07:10:37.484826 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt_rpc.task.server.RPCServerTask'>, debug=None, defer=None, exclude=None, fail_fast=None, host='0.0.0.0', log_cache_events=False, log_format=None, models=None, partial_parse=True, port=8580, printer_width=None, profile='user', profiles_dir='/usr/src/develop/.dbt', project_dir=None, record_timing_info=None, rpc_method=None, send_anonymous_usage_stats=None, single_threaded=False, state=None, static_parser=None, target=None, threads=None, use_colors=None, use_experimental_parser=None, vars='{}', version_check=None, warn_error=None, which='rpc', write_json=None)
2022-06-29 07:10:37.487137 (MainThread): Tracking: tracking
2022-06-29 07:10:37.487446 (MainThread): 07:10:37  Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f63ce98eac0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f63c86b9d90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f63939d1550>]}
2022-06-29 07:10:37.487799 (MainThread): Serving RPC server at 0.0.0.0:8580, pid=22
2022-06-29 07:10:37.489013 (MainThread): Supported methods: ['build', 'cli_args', 'compile', 'compile_sql', 'deps', 'docs.generate', 'gc', 'get-manifest', 'kill', 'list', 'poll', 'ps', 'run', 'run-operation', 'run_sql', 'seed', 'snapshot', 'snapshot-freshness', 'source-freshness', 'status', 'test']
2022-06-29 07:10:37.494727 (MainThread): Send requests to http://localhost:8580/jsonrpc
2022-06-29 07:10:37.511142 (Thread-12): 07:10:37  Unable to do partial parsing because profile has changed
2022-06-29 07:10:37.511409 (Thread-12): 07:10:37  Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': 'b69520e4-9398-4713-9c56-1c613c44499e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f63939ddc40>]}
2022-06-29 07:10:37.545596 (Thread-12): 07:10:37  Parsing macros/adapters.sql
2022-06-29 07:10:37.583577 (Thread-12): 07:10:37  Parsing macros/catalog.sql
2022-06-29 07:10:37.585426 (Thread-12): 07:10:37  Parsing macros/materializations/table.sql
2022-06-29 07:10:37.588406 (Thread-12): 07:10:37  Parsing macros/materializations/seed.sql
2022-06-29 07:10:37.593383 (Thread-12): 07:10:37  Parsing macros/materializations/incremental.sql
2022-06-29 07:10:37.601699 (Thread-12): 07:10:37  Parsing macros/materializations/merge.sql
2022-06-29 07:10:37.605367 (Thread-12): 07:10:37  Parsing macros/materializations/snapshot.sql
2022-06-29 07:10:37.606294 (Thread-12): 07:10:37  Parsing macros/materializations/view.sql
2022-06-29 07:10:37.607563 (Thread-12): 07:10:37  Parsing macros/adapters/metadata.sql
2022-06-29 07:10:37.614693 (Thread-12): 07:10:37  Parsing macros/adapters/columns.sql
2022-06-29 07:10:37.624246 (Thread-12): 07:10:37  Parsing macros/adapters/freshness.sql
2022-06-29 07:10:37.627074 (Thread-12): 07:10:37  Parsing macros/adapters/persist_docs.sql
2022-06-29 07:10:37.631276 (Thread-12): 07:10:37  Parsing macros/adapters/relation.sql
2022-06-29 07:10:37.640611 (Thread-12): 07:10:37  Parsing macros/adapters/schema.sql
2022-06-29 07:10:37.642762 (Thread-12): 07:10:37  Parsing macros/adapters/indexes.sql
2022-06-29 07:10:37.645322 (Thread-12): 07:10:37  Parsing macros/get_custom_name/get_custom_schema.sql
2022-06-29 07:10:37.647695 (Thread-12): 07:10:37  Parsing macros/get_custom_name/get_custom_alias.sql
2022-06-29 07:10:37.649100 (Thread-12): 07:10:37  Parsing macros/get_custom_name/get_custom_database.sql
2022-06-29 07:10:37.650643 (Thread-12): 07:10:37  Parsing macros/etc/datetime.sql
2022-06-29 07:10:37.658813 (Thread-12): 07:10:37  Parsing macros/etc/statement.sql
2022-06-29 07:10:37.663261 (Thread-12): 07:10:37  Parsing macros/generic_test_sql/unique.sql
2022-06-29 07:10:37.663941 (Thread-12): 07:10:37  Parsing macros/generic_test_sql/not_null.sql
2022-06-29 07:10:37.664459 (Thread-12): 07:10:37  Parsing macros/generic_test_sql/accepted_values.sql
2022-06-29 07:10:37.665744 (Thread-12): 07:10:37  Parsing macros/generic_test_sql/relationships.sql
2022-06-29 07:10:37.666617 (Thread-12): 07:10:37  Parsing macros/materializations/configs.sql
2022-06-29 07:10:37.668871 (Thread-12): 07:10:37  Parsing macros/materializations/hooks.sql
2022-06-29 07:10:37.672651 (Thread-12): 07:10:37  Parsing macros/materializations/models/table/table.sql
2022-06-29 07:10:37.679933 (Thread-12): 07:10:37  Parsing macros/materializations/models/table/create_table_as.sql
2022-06-29 07:10:37.684106 (Thread-12): 07:10:37  Parsing macros/materializations/models/view/create_or_replace_view.sql
2022-06-29 07:10:37.686774 (Thread-12): 07:10:37  Parsing macros/materializations/models/view/helpers.sql
2022-06-29 07:10:37.688166 (Thread-12): 07:10:37  Parsing macros/materializations/models/view/create_view_as.sql
2022-06-29 07:10:37.690516 (Thread-12): 07:10:37  Parsing macros/materializations/models/view/view.sql
2022-06-29 07:10:37.697429 (Thread-12): 07:10:37  Parsing macros/materializations/models/incremental/incremental.sql
2022-06-29 07:10:37.707710 (Thread-12): 07:10:37  Parsing macros/materializations/models/incremental/on_schema_change.sql
2022-06-29 07:10:37.722825 (Thread-12): 07:10:37  Parsing macros/materializations/models/incremental/is_incremental.sql
2022-06-29 07:10:37.724260 (Thread-12): 07:10:37  Parsing macros/materializations/models/incremental/merge.sql
2022-06-29 07:10:37.735176 (Thread-12): 07:10:37  Parsing macros/materializations/models/incremental/column_helpers.sql
2022-06-29 07:10:37.739472 (Thread-12): 07:10:37  Parsing macros/materializations/seeds/helpers.sql
2022-06-29 07:10:37.755364 (Thread-12): 07:10:37  Parsing macros/materializations/seeds/seed.sql
2022-06-29 07:10:37.761117 (Thread-12): 07:10:37  Parsing macros/materializations/tests/helpers.sql
2022-06-29 07:10:37.762896 (Thread-12): 07:10:37  Parsing macros/materializations/tests/test.sql
2022-06-29 07:10:37.767075 (Thread-12): 07:10:37  Parsing macros/materializations/tests/where_subquery.sql
2022-06-29 07:10:37.768779 (Thread-12): 07:10:37  Parsing macros/materializations/snapshots/helpers.sql
2022-06-29 07:10:37.779748 (Thread-12): 07:10:37  Parsing macros/materializations/snapshots/strategies.sql
2022-06-29 07:10:37.795647 (Thread-12): 07:10:37  Parsing macros/materializations/snapshots/snapshot_merge.sql
2022-06-29 07:10:37.797207 (Thread-12): 07:10:37  Parsing macros/materializations/snapshots/snapshot.sql
2022-06-29 07:10:37.808287 (Thread-12): 07:10:37  Parsing tests/generic/builtin.sql
2022-06-29 07:10:37.998850 (Thread-12): 07:10:37  1603: static parser failed on data_model/stg_user_traits.sql
2022-06-29 07:10:38.011948 (Thread-12): 07:10:38  1602: parser fallback to jinja rendering on data_model/stg_user_traits.sql
2022-06-29 07:10:38.013114 (Thread-12): 07:10:38  1603: static parser failed on data_model/stg_products_viewed.sql
2022-06-29 07:10:38.016206 (Thread-12): 07:10:38  1602: parser fallback to jinja rendering on data_model/stg_products_viewed.sql
2022-06-29 07:10:38.017353 (Thread-12): 07:10:38  1699: static parser successfully parsed data_model/feat_user_features.sql
2022-06-29 07:10:38.019412 (Thread-12): 07:10:38  1699: static parser successfully parsed data_model/stg_user_properties.sql
2022-06-29 07:10:38.021398 (Thread-12): 07:10:38  1699: static parser successfully parsed data_model/stg_tracks.sql
2022-06-29 07:10:38.038857 (Thread-12): 07:10:38  [WARNING]: Did not find matching node for patch with name 'my_first_dbt_model' in the 'models' section of file 'models/data_model/schema.yml'
2022-06-29 07:10:38.067552 (Thread-12): 07:10:38  [WARNING]: Test 'test.ecommerce_data_model_dbt.unique_my_first_dbt_model_id.16e066b321' (models/data_model/schema.yml) depends on a node named 'my_first_dbt_model' which was not found
2022-06-29 07:10:38.067843 (Thread-12): 07:10:38  [WARNING]: Test 'test.ecommerce_data_model_dbt.not_null_my_first_dbt_model_id.5fb22c2710' (models/data_model/schema.yml) depends on a node named 'my_first_dbt_model' which was not found
2022-06-29 07:10:38.107976 (Thread-12): 07:10:38  [WARNING]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.ecommerce_data_model_dbt.example

2022-06-29 07:10:38.115284 (Thread-12): 07:10:38  Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'b69520e4-9398-4713-9c56-1c613c44499e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6394a9bbb0>]}
2022-06-29 07:10:38.557029 (Thread-13): handling status request
2022-06-29 07:10:38.557437 (Thread-13): 07:10:38  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'b69520e4-9398-4713-9c56-1c613c44499e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f63939ddb20>]}
2022-06-29 07:10:38.558533 (Thread-13): sending response (<Response 18864 bytes [200 OK]>) to 10.0.12.141
2022-06-29 07:10:38.647205 (Thread-14): handling status request
2022-06-29 07:10:38.647504 (Thread-14): 07:10:38  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'b69520e4-9398-4713-9c56-1c613c44499e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f63908c3460>]}
2022-06-29 07:10:38.648424 (Thread-14): sending response (<Response 18864 bytes [200 OK]>) to 10.0.12.141
2022-06-29 07:10:45.171032 (Thread-15): handling status request
2022-06-29 07:10:45.171413 (Thread-15): 07:10:45  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'b69520e4-9398-4713-9c56-1c613c44499e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6390901f70>]}
2022-06-29 07:10:45.172311 (Thread-15): sending response (<Response 18841 bytes [200 OK]>) to 10.0.12.141
2022-06-29 07:10:45.178799 (Thread-16): handling list request
2022-06-29 07:10:45.179037 (Thread-16): 07:10:45  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'b69520e4-9398-4713-9c56-1c613c44499e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f63d60c13d0>]}
2022-06-29 07:10:45.217303 (Thread-16): 07:10:45  Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'b69520e4-9398-4713-9c56-1c613c44499e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6392964d30>]}
2022-06-29 07:10:45.217574 (Thread-16): 07:10:45  Found 5 models, 0 tests, 0 snapshots, 0 analyses, 179 macros, 0 operations, 0 seed files, 15 sources, 0 exposures, 0 metrics
2022-06-29 07:10:45.218104 (Thread-16): 07:10:45  The selection criterion '+README.md+' does not match any nodes
2022-06-29 07:10:45.218215 (Thread-16): 07:10:45  No nodes selected!
2022-06-29 07:10:45.219624 (Thread-16): sending response (<Response 1923 bytes [200 OK]>) to 10.0.12.141
2022-06-29 07:10:48.355211 (Thread-17): handling status request
2022-06-29 07:10:48.356879 (Thread-17): 07:10:48  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'b69520e4-9398-4713-9c56-1c613c44499e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6392955f40>]}
2022-06-29 07:10:48.357767 (Thread-17): sending response (<Response 18841 bytes [200 OK]>) to 10.0.12.141
2022-06-29 07:10:48.368932 (Thread-18): handling list request
2022-06-29 07:10:48.369158 (Thread-18): 07:10:48  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'b69520e4-9398-4713-9c56-1c613c44499e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6392955b50>]}
2022-06-29 07:10:48.396925 (Thread-18): 07:10:48  Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'b69520e4-9398-4713-9c56-1c613c44499e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f63929430a0>]}
2022-06-29 07:10:48.397189 (Thread-18): 07:10:48  Found 5 models, 0 tests, 0 snapshots, 0 analyses, 179 macros, 0 operations, 0 seed files, 15 sources, 0 exposures, 0 metrics
2022-06-29 07:10:48.399345 (Thread-18): 07:10:48  The selection criterion '+fake_data/product_catalogue.json+' does not match any nodes
2022-06-29 07:10:48.399485 (Thread-18): 07:10:48  No nodes selected!
2022-06-29 07:10:48.400691 (Thread-18): sending response (<Response 1946 bytes [200 OK]>) to 10.0.12.141
2022-06-29 07:10:52.554502 (Thread-19): handling status request
2022-06-29 07:10:52.554878 (Thread-19): 07:10:52  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'b69520e4-9398-4713-9c56-1c613c44499e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6392950e20>]}
2022-06-29 07:10:52.555798 (Thread-19): sending response (<Response 18841 bytes [200 OK]>) to 10.0.12.141
2022-06-29 07:10:52.609334 (Thread-20): handling list request
2022-06-29 07:10:52.609611 (Thread-20): 07:10:52  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'b69520e4-9398-4713-9c56-1c613c44499e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f63909130d0>]}
2022-06-29 07:10:52.639844 (Thread-20): 07:10:52  Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'b69520e4-9398-4713-9c56-1c613c44499e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f63929552b0>]}
2022-06-29 07:10:52.640180 (Thread-20): 07:10:52  Found 5 models, 0 tests, 0 snapshots, 0 analyses, 179 macros, 0 operations, 0 seed files, 15 sources, 0 exposures, 0 metrics
2022-06-29 07:10:52.643809 (Thread-20): sending response (<Response 2713 bytes [200 OK]>) to 10.0.12.141
2022-06-29 07:11:06.379562 (Thread-21): handling status request
2022-06-29 07:11:06.381137 (Thread-21): 07:11:06  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'b69520e4-9398-4713-9c56-1c613c44499e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6390918160>]}
2022-06-29 07:11:06.382104 (Thread-21): sending response (<Response 18841 bytes [200 OK]>) to 10.0.12.141
2022-06-29 07:11:06.393526 (Thread-22): handling list request
2022-06-29 07:11:06.393751 (Thread-22): 07:11:06  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'b69520e4-9398-4713-9c56-1c613c44499e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6390918670>]}
2022-06-29 07:11:06.423252 (Thread-22): 07:11:06  Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'b69520e4-9398-4713-9c56-1c613c44499e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6390913220>]}
2022-06-29 07:11:06.423556 (Thread-22): 07:11:06  Found 5 models, 0 tests, 0 snapshots, 0 analyses, 179 macros, 0 operations, 0 seed files, 15 sources, 0 exposures, 0 metrics
2022-06-29 07:11:06.427325 (Thread-22): sending response (<Response 2713 bytes [200 OK]>) to 10.0.12.141
2022-06-29 07:11:09.312202 (Thread-23): handling status request
2022-06-29 07:11:09.312549 (Thread-23): 07:11:09  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'b69520e4-9398-4713-9c56-1c613c44499e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6394a20be0>]}
2022-06-29 07:11:09.313421 (Thread-23): sending response (<Response 18841 bytes [200 OK]>) to 10.0.12.141
2022-06-29 07:11:09.319716 (Thread-24): handling list request
2022-06-29 07:11:09.319940 (Thread-24): 07:11:09  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'b69520e4-9398-4713-9c56-1c613c44499e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6394a202e0>]}
2022-06-29 07:11:09.351174 (Thread-24): 07:11:09  Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'b69520e4-9398-4713-9c56-1c613c44499e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6394a20b80>]}
2022-06-29 07:11:09.351433 (Thread-24): 07:11:09  Found 5 models, 0 tests, 0 snapshots, 0 analyses, 179 macros, 0 operations, 0 seed files, 15 sources, 0 exposures, 0 metrics
2022-06-29 07:11:09.357232 (Thread-24): sending response (<Response 2032 bytes [200 OK]>) to 10.0.12.141
2022-06-29 07:11:15.635133 (Thread-25): handling status request
2022-06-29 07:11:15.635489 (Thread-25): 07:11:15  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'b69520e4-9398-4713-9c56-1c613c44499e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6394a3d8e0>]}
2022-06-29 07:11:15.636339 (Thread-25): sending response (<Response 18841 bytes [200 OK]>) to 10.0.12.141
2022-06-29 07:11:15.647372 (Thread-26): handling list request
2022-06-29 07:11:15.647641 (Thread-26): 07:11:15  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'b69520e4-9398-4713-9c56-1c613c44499e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6392950a90>]}
2022-06-29 07:11:15.677802 (Thread-26): 07:11:15  Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'b69520e4-9398-4713-9c56-1c613c44499e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6394a3d4f0>]}
2022-06-29 07:11:15.678111 (Thread-26): 07:11:15  Found 5 models, 0 tests, 0 snapshots, 0 analyses, 179 macros, 0 operations, 0 seed files, 15 sources, 0 exposures, 0 metrics
2022-06-29 07:11:15.682843 (Thread-26): 07:11:15  The selection criterion '+models/data_model/stg_user_properties.sql+' does not match any nodes
2022-06-29 07:11:15.682972 (Thread-26): 07:11:15  No nodes selected!
2022-06-29 07:11:15.684187 (Thread-26): sending response (<Response 1955 bytes [200 OK]>) to 10.0.12.141
2022-06-29 07:11:16.972427 (Thread-27): handling status request
2022-06-29 07:11:16.972781 (Thread-27): 07:11:16  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'b69520e4-9398-4713-9c56-1c613c44499e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6394a4c1c0>]}
2022-06-29 07:11:16.973635 (Thread-27): sending response (<Response 18841 bytes [200 OK]>) to 10.0.12.141
2022-06-29 07:11:17.012864 (Thread-28): handling list request
2022-06-29 07:11:17.013194 (Thread-28): 07:11:17  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'b69520e4-9398-4713-9c56-1c613c44499e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6394a4cee0>]}
2022-06-29 07:11:17.043067 (Thread-28): 07:11:17  Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'b69520e4-9398-4713-9c56-1c613c44499e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f63908fbfd0>]}
2022-06-29 07:11:17.043534 (Thread-28): 07:11:17  Found 5 models, 0 tests, 0 snapshots, 0 analyses, 179 macros, 0 operations, 0 seed files, 15 sources, 0 exposures, 0 metrics
2022-06-29 07:11:17.047112 (Thread-28): sending response (<Response 2064 bytes [200 OK]>) to 10.0.12.141
2022-06-29 07:17:30.043207 (Thread-29): handling status request
2022-06-29 07:17:30.045117 (Thread-29): 07:17:30  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'b69520e4-9398-4713-9c56-1c613c44499e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6394a51d00>]}
2022-06-29 07:17:30.046115 (Thread-29): sending response (<Response 18841 bytes [200 OK]>) to 10.0.12.141
2022-06-29 07:17:30.084074 (Thread-30): handling list request
2022-06-29 07:17:30.084421 (Thread-30): 07:17:30  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'b69520e4-9398-4713-9c56-1c613c44499e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6394a59040>]}
2022-06-29 07:17:30.126246 (Thread-30): 07:17:30  Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'b69520e4-9398-4713-9c56-1c613c44499e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6394a4cee0>]}
2022-06-29 07:17:30.126606 (Thread-30): 07:17:30  Found 5 models, 0 tests, 0 snapshots, 0 analyses, 179 macros, 0 operations, 0 seed files, 15 sources, 0 exposures, 0 metrics
2022-06-29 07:17:30.136197 (Thread-30): sending response (<Response 2713 bytes [200 OK]>) to 10.0.12.141
2022-06-29 07:18:59.608183 (Thread-31): handling status request
2022-06-29 07:18:59.610203 (Thread-31): 07:18:59  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'b69520e4-9398-4713-9c56-1c613c44499e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6394a59730>]}
2022-06-29 07:18:59.640102 (Thread-31): sending response (<Response 18841 bytes [200 OK]>) to 10.0.12.141
2022-06-29 07:18:59.647029 (Thread-32): handling list request
2022-06-29 07:18:59.647311 (Thread-32): 07:18:59  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'b69520e4-9398-4713-9c56-1c613c44499e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f63908d38b0>]}
2022-06-29 07:18:59.687847 (Thread-32): 07:18:59  Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'b69520e4-9398-4713-9c56-1c613c44499e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f639091a850>]}
2022-06-29 07:18:59.688166 (Thread-32): 07:18:59  Found 5 models, 0 tests, 0 snapshots, 0 analyses, 179 macros, 0 operations, 0 seed files, 15 sources, 0 exposures, 0 metrics
2022-06-29 07:18:59.697282 (Thread-32): sending response (<Response 2713 bytes [200 OK]>) to 10.0.12.141
2022-06-29 07:20:55.037870 (Thread-33): handling status request
2022-06-29 07:20:55.039833 (Thread-33): 07:20:55  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'b69520e4-9398-4713-9c56-1c613c44499e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6394a59250>]}
2022-06-29 07:20:55.040770 (Thread-33): sending response (<Response 18841 bytes [200 OK]>) to 10.0.12.141
2022-06-29 07:20:55.047265 (Thread-34): handling list request
2022-06-29 07:20:55.047488 (Thread-34): 07:20:55  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'b69520e4-9398-4713-9c56-1c613c44499e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6394a29a90>]}
2022-06-29 07:20:55.082312 (Thread-34): 07:20:55  Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'b69520e4-9398-4713-9c56-1c613c44499e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f63908d3190>]}
2022-06-29 07:20:55.082564 (Thread-34): 07:20:55  Found 5 models, 0 tests, 0 snapshots, 0 analyses, 179 macros, 0 operations, 0 seed files, 15 sources, 0 exposures, 0 metrics
2022-06-29 07:20:55.091369 (Thread-34): sending response (<Response 2032 bytes [200 OK]>) to 10.0.12.141
2022-06-29 07:20:56.244152 (Thread-35): handling status request
2022-06-29 07:20:56.244501 (Thread-35): 07:20:56  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'b69520e4-9398-4713-9c56-1c613c44499e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6394a29760>]}
2022-06-29 07:20:56.245395 (Thread-35): sending response (<Response 18841 bytes [200 OK]>) to 10.0.12.141
2022-06-29 07:20:56.251868 (Thread-36): handling list request
2022-06-29 07:20:56.252091 (Thread-36): 07:20:56  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'b69520e4-9398-4713-9c56-1c613c44499e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6394a25b20>]}
2022-06-29 07:20:56.282141 (Thread-36): 07:20:56  Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'b69520e4-9398-4713-9c56-1c613c44499e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6394a297f0>]}
2022-06-29 07:20:56.282379 (Thread-36): 07:20:56  Found 5 models, 0 tests, 0 snapshots, 0 analyses, 179 macros, 0 operations, 0 seed files, 15 sources, 0 exposures, 0 metrics
2022-06-29 07:20:56.284843 (Thread-36): 07:20:56  The selection criterion '+models/data_model/stg_user_properties.sql+' does not match any nodes
2022-06-29 07:20:56.284994 (Thread-36): 07:20:56  No nodes selected!
2022-06-29 07:20:56.286222 (Thread-36): sending response (<Response 1955 bytes [200 OK]>) to 10.0.12.141
2022-06-29 08:18:34.237861 (Thread-37): handling status request
2022-06-29 08:18:34.240617 (Thread-37): 08:18:34  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'b69520e4-9398-4713-9c56-1c613c44499e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f63407c9370>]}
2022-06-29 08:18:34.241511 (Thread-37): sending response (<Response 18841 bytes [200 OK]>) to 10.0.12.141
2022-06-29 08:18:34.253833 (Thread-38): handling list request
2022-06-29 08:18:34.254132 (Thread-38): 08:18:34  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'b69520e4-9398-4713-9c56-1c613c44499e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f63407c9550>]}
2022-06-29 08:18:34.313796 (Thread-38): 08:18:34  Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'b69520e4-9398-4713-9c56-1c613c44499e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f63d1ef8880>]}
2022-06-29 08:18:34.314161 (Thread-38): 08:18:34  Found 5 models, 0 tests, 0 snapshots, 0 analyses, 179 macros, 0 operations, 0 seed files, 15 sources, 0 exposures, 0 metrics
2022-06-29 08:18:34.322931 (Thread-38): sending response (<Response 2713 bytes [200 OK]>) to 10.0.12.141
2022-07-01 06:33:53.138567 (MainThread): Running with dbt=1.0.8
2022-07-01 06:33:53.399844 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt_rpc.task.server.RPCServerTask'>, debug=None, defer=None, exclude=None, fail_fast=None, host='0.0.0.0', log_cache_events=False, log_format=None, models=None, partial_parse=True, port=8580, printer_width=None, profile='user', profiles_dir='/usr/src/develop/.dbt', project_dir=None, record_timing_info=None, rpc_method=None, send_anonymous_usage_stats=None, single_threaded=False, state=None, static_parser=None, target=None, threads=None, use_colors=None, use_experimental_parser=None, vars='{}', version_check=None, warn_error=None, which='rpc', write_json=None)
2022-07-01 06:33:53.404368 (MainThread): Tracking: tracking
2022-07-01 06:33:53.404692 (MainThread): 06:33:53  Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f49d4e53850>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f499c06f910>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f499c052580>]}
2022-07-01 06:33:53.408957 (MainThread): Serving RPC server at 0.0.0.0:8580, pid=22
2022-07-01 06:33:53.409308 (MainThread): Supported methods: ['build', 'cli_args', 'compile', 'compile_sql', 'deps', 'docs.generate', 'gc', 'get-manifest', 'kill', 'list', 'poll', 'ps', 'run', 'run-operation', 'run_sql', 'seed', 'snapshot', 'snapshot-freshness', 'source-freshness', 'status', 'test']
2022-07-01 06:33:53.409538 (MainThread): Send requests to http://localhost:8580/jsonrpc
2022-07-01 06:33:53.479985 (Thread-12): 06:33:53  Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
2022-07-01 06:33:53.480215 (Thread-12): 06:33:53  Partial parsing enabled, no changes found, skipping parsing
2022-07-01 06:33:53.480708 (Thread-12): 06:33:53  [WARNING]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.ecommerce_data_model_dbt.example

2022-07-01 06:33:53.487063 (Thread-12): 06:33:53  Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '041e6842-5442-412b-bd4d-673603f523ff', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4996422850>]}
2022-07-01 06:33:54.790241 (Thread-13): handling ps request
2022-07-01 06:33:54.790636 (Thread-13): 06:33:54  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '041e6842-5442-412b-bd4d-673603f523ff', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4996412f70>]}
2022-07-01 06:33:54.791268 (Thread-13): sending response (<Response 106 bytes [200 OK]>) to 10.0.11.40
2022-07-01 06:33:54.939912 (Thread-14): handling status request
2022-07-01 06:33:54.940327 (Thread-14): 06:33:54  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '041e6842-5442-412b-bd4d-673603f523ff', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4996412940>]}
2022-07-01 06:33:54.940818 (Thread-14): sending response (<Response 1692 bytes [200 OK]>) to 10.0.11.40
2022-07-01 06:33:54.969318 (Thread-15): handling status request
2022-07-01 06:33:54.969600 (Thread-15): 06:33:54  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '041e6842-5442-412b-bd4d-673603f523ff', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4996412d00>]}
2022-07-01 06:33:54.969981 (Thread-15): sending response (<Response 1692 bytes [200 OK]>) to 10.0.11.40
2022-07-01 06:33:54.975455 (Thread-16): handling status request
2022-07-01 06:33:54.975720 (Thread-16): 06:33:54  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '041e6842-5442-412b-bd4d-673603f523ff', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4996412b80>]}
2022-07-01 06:33:54.976062 (Thread-16): sending response (<Response 1692 bytes [200 OK]>) to 10.0.11.40
2022-07-01 06:33:57.541719 (Thread-17): handling status request
2022-07-01 06:33:57.542167 (Thread-17): 06:33:57  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '041e6842-5442-412b-bd4d-673603f523ff', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f49964bd190>]}
2022-07-01 06:33:57.542640 (Thread-17): sending response (<Response 1669 bytes [200 OK]>) to 10.0.11.40
2022-07-01 06:33:57.548445 (Thread-18): handling list request
2022-07-01 06:33:57.548703 (Thread-18): 06:33:57  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '041e6842-5442-412b-bd4d-673603f523ff', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4996412610>]}
2022-07-01 06:33:57.586412 (Thread-18): 06:33:57  Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '041e6842-5442-412b-bd4d-673603f523ff', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4996412a90>]}
2022-07-01 06:33:57.586710 (Thread-18): 06:33:57  Found 5 models, 0 tests, 0 snapshots, 0 analyses, 179 macros, 0 operations, 0 seed files, 15 sources, 0 exposures, 0 metrics
2022-07-01 06:33:57.589580 (Thread-18): sending response (<Response 2711 bytes [200 OK]>) to 10.0.11.40
2022-07-01 06:33:57.715234 (Thread-19): handling status request
2022-07-01 06:33:57.715550 (Thread-19): 06:33:57  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '041e6842-5442-412b-bd4d-673603f523ff', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f49964bd1c0>]}
2022-07-01 06:33:57.715972 (Thread-19): sending response (<Response 1692 bytes [200 OK]>) to 10.0.11.40
2022-07-01 06:34:42.011637 (Thread-20): handling status request
2022-07-01 06:34:42.013292 (Thread-20): 06:34:42  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '041e6842-5442-412b-bd4d-673603f523ff', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f49964bd070>]}
2022-07-01 06:34:42.013769 (Thread-20): sending response (<Response 1669 bytes [200 OK]>) to 10.0.11.40
2022-07-01 06:34:42.021504 (Thread-21): handling list request
2022-07-01 06:34:42.021768 (Thread-21): 06:34:42  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '041e6842-5442-412b-bd4d-673603f523ff', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4996422d30>]}
2022-07-01 06:34:42.056109 (Thread-21): 06:34:42  Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '041e6842-5442-412b-bd4d-673603f523ff', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f499642c100>]}
2022-07-01 06:34:42.056489 (Thread-21): 06:34:42  Found 5 models, 0 tests, 0 snapshots, 0 analyses, 179 macros, 0 operations, 0 seed files, 15 sources, 0 exposures, 0 metrics
2022-07-01 06:34:42.065900 (Thread-21): sending response (<Response 2711 bytes [200 OK]>) to 10.0.11.40
2022-07-01 06:34:54.805122 (Thread-22): handling status request
2022-07-01 06:34:54.806901 (Thread-22): 06:34:54  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '041e6842-5442-412b-bd4d-673603f523ff', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f499c00eaf0>]}
2022-07-01 06:34:54.807414 (Thread-22): sending response (<Response 1669 bytes [200 OK]>) to 10.0.11.40
2022-07-01 06:34:54.816471 (Thread-23): handling list request
2022-07-01 06:34:54.816816 (Thread-23): 06:34:54  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '041e6842-5442-412b-bd4d-673603f523ff', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4996422d30>]}
2022-07-01 06:34:54.845118 (Thread-23): 06:34:54  Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '041e6842-5442-412b-bd4d-673603f523ff', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f49943f2c10>]}
2022-07-01 06:34:54.845430 (Thread-23): 06:34:54  Found 5 models, 0 tests, 0 snapshots, 0 analyses, 179 macros, 0 operations, 0 seed files, 15 sources, 0 exposures, 0 metrics
2022-07-01 06:34:54.847681 (Thread-23): 06:34:54  The selection criterion '+models/data_model/stg_user_properties.sql+' does not match any nodes
2022-07-01 06:34:54.847838 (Thread-23): 06:34:54  No nodes selected!
2022-07-01 06:34:54.849319 (Thread-23): sending response (<Response 1951 bytes [200 OK]>) to 10.0.11.40
2022-07-01 06:34:56.666849 (Thread-24): handling status request
2022-07-01 06:34:56.667265 (Thread-24): 06:34:56  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '041e6842-5442-412b-bd4d-673603f523ff', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f49943fb910>]}
2022-07-01 06:34:56.667746 (Thread-24): sending response (<Response 1669 bytes [200 OK]>) to 10.0.11.40
2022-07-01 06:34:56.688325 (Thread-25): handling list request
2022-07-01 06:34:56.688627 (Thread-25): 06:34:56  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '041e6842-5442-412b-bd4d-673603f523ff', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f499642c910>]}
2022-07-01 06:34:56.722420 (Thread-25): 06:34:56  Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '041e6842-5442-412b-bd4d-673603f523ff', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f49943fbee0>]}
2022-07-01 06:34:56.722750 (Thread-25): 06:34:56  Found 5 models, 0 tests, 0 snapshots, 0 analyses, 179 macros, 0 operations, 0 seed files, 15 sources, 0 exposures, 0 metrics
2022-07-01 06:34:56.726960 (Thread-25): sending response (<Response 2030 bytes [200 OK]>) to 10.0.11.40
2022-07-01 06:34:57.393165 (Thread-26): handling status request
2022-07-01 06:34:57.393554 (Thread-26): 06:34:57  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '041e6842-5442-412b-bd4d-673603f523ff', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f49943827c0>]}
2022-07-01 06:34:57.394033 (Thread-26): sending response (<Response 1669 bytes [200 OK]>) to 10.0.11.40
2022-07-01 06:34:57.400121 (Thread-27): handling list request
2022-07-01 06:34:57.400395 (Thread-27): 06:34:57  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '041e6842-5442-412b-bd4d-673603f523ff', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f49943f25e0>]}
2022-07-01 06:34:57.437832 (Thread-27): 06:34:57  Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '041e6842-5442-412b-bd4d-673603f523ff', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f499438d070>]}
2022-07-01 06:34:57.438112 (Thread-27): 06:34:57  Found 5 models, 0 tests, 0 snapshots, 0 analyses, 179 macros, 0 operations, 0 seed files, 15 sources, 0 exposures, 0 metrics
2022-07-01 06:34:57.441681 (Thread-27): sending response (<Response 2062 bytes [200 OK]>) to 10.0.11.40
2022-07-01 09:35:58.618489 (MainThread): Running with dbt=1.0.8
2022-07-01 09:35:58.878519 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt_rpc.task.server.RPCServerTask'>, debug=None, defer=None, exclude=None, fail_fast=None, host='0.0.0.0', log_cache_events=False, log_format=None, models=None, partial_parse=True, port=8580, printer_width=None, profile='user', profiles_dir='/usr/src/develop/.dbt', project_dir=None, record_timing_info=None, rpc_method=None, send_anonymous_usage_stats=None, single_threaded=False, state=None, static_parser=None, target=None, threads=None, use_colors=None, use_experimental_parser=None, vars='{}', version_check=None, warn_error=None, which='rpc', write_json=None)
2022-07-01 09:35:58.883055 (MainThread): Tracking: tracking
2022-07-01 09:35:58.883381 (MainThread): 09:35:58  Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f73ee0bb850>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f73ab770a60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f73ab7810a0>]}
2022-07-01 09:35:58.887653 (MainThread): Serving RPC server at 0.0.0.0:8580, pid=22
2022-07-01 09:35:58.888031 (MainThread): Supported methods: ['build', 'cli_args', 'compile', 'compile_sql', 'deps', 'docs.generate', 'gc', 'get-manifest', 'kill', 'list', 'poll', 'ps', 'run', 'run-operation', 'run_sql', 'seed', 'snapshot', 'snapshot-freshness', 'source-freshness', 'status', 'test']
2022-07-01 09:35:58.889054 (MainThread): Send requests to http://localhost:8580/jsonrpc
2022-07-01 09:35:58.953312 (Thread-12): 09:35:58  Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
2022-07-01 09:35:58.953524 (Thread-12): 09:35:58  Partial parsing enabled, no changes found, skipping parsing
2022-07-01 09:35:58.954004 (Thread-12): 09:35:58  [WARNING]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.ecommerce_data_model_dbt.example

2022-07-01 09:35:58.959957 (Thread-12): 09:35:58  Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'f48b5fd9-b5fc-4510-bbcd-b59df21410e2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f73ab669970>]}
2022-07-01 09:36:01.182927 (Thread-13): handling ps request
2022-07-01 09:36:01.183328 (Thread-13): 09:36:01  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'f48b5fd9-b5fc-4510-bbcd-b59df21410e2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f73ab658b50>]}
2022-07-01 09:36:01.183897 (Thread-13): sending response (<Response 106 bytes [200 OK]>) to 10.0.18.132
2022-07-01 09:36:01.322512 (Thread-14): handling status request
2022-07-01 09:36:01.322916 (Thread-14): 09:36:01  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'f48b5fd9-b5fc-4510-bbcd-b59df21410e2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f73ab658eb0>]}
2022-07-01 09:36:01.323389 (Thread-14): sending response (<Response 1692 bytes [200 OK]>) to 10.0.18.132
2022-07-01 09:36:01.414478 (Thread-15): handling status request
2022-07-01 09:36:01.414829 (Thread-15): 09:36:01  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'f48b5fd9-b5fc-4510-bbcd-b59df21410e2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f73ab658a00>]}
2022-07-01 09:36:01.415281 (Thread-15): sending response (<Response 1692 bytes [200 OK]>) to 10.0.18.132
2022-07-01 09:36:01.426466 (Thread-16): handling status request
2022-07-01 09:36:01.426730 (Thread-16): 09:36:01  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'f48b5fd9-b5fc-4510-bbcd-b59df21410e2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f73ab6581c0>]}
2022-07-01 09:36:01.427083 (Thread-16): sending response (<Response 1692 bytes [200 OK]>) to 10.0.18.132
2022-07-01 09:36:03.590155 (Thread-17): handling status request
2022-07-01 09:36:03.590551 (Thread-17): 09:36:03  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'f48b5fd9-b5fc-4510-bbcd-b59df21410e2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f73ab658be0>]}
2022-07-01 09:36:03.591013 (Thread-17): sending response (<Response 1669 bytes [200 OK]>) to 10.0.18.132
2022-07-01 09:36:03.598880 (Thread-18): handling list request
2022-07-01 09:36:03.599150 (Thread-18): 09:36:03  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'f48b5fd9-b5fc-4510-bbcd-b59df21410e2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f73ab658700>]}
2022-07-01 09:36:03.640788 (Thread-18): 09:36:03  Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'f48b5fd9-b5fc-4510-bbcd-b59df21410e2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f73ab704310>]}
2022-07-01 09:36:03.641146 (Thread-18): 09:36:03  Found 5 models, 0 tests, 0 snapshots, 0 analyses, 179 macros, 0 operations, 0 seed files, 15 sources, 0 exposures, 0 metrics
2022-07-01 09:36:03.644267 (Thread-18): sending response (<Response 2064 bytes [200 OK]>) to 10.0.18.132
2022-07-01 09:36:03.761919 (Thread-19): handling status request
2022-07-01 09:36:03.762480 (Thread-19): 09:36:03  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'f48b5fd9-b5fc-4510-bbcd-b59df21410e2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f73ee0bb490>]}
2022-07-01 09:36:03.762946 (Thread-19): sending response (<Response 1692 bytes [200 OK]>) to 10.0.18.132
2022-07-01 09:41:06.011592 (Thread-20): handling status request
2022-07-01 09:41:06.013742 (Thread-20): 09:41:06  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'f48b5fd9-b5fc-4510-bbcd-b59df21410e2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f73ab711cd0>]}
2022-07-01 09:41:06.014225 (Thread-20): sending response (<Response 1669 bytes [200 OK]>) to 10.0.18.132
2022-07-01 09:41:06.020602 (Thread-21): handling list request
2022-07-01 09:41:06.020867 (Thread-21): 09:41:06  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'f48b5fd9-b5fc-4510-bbcd-b59df21410e2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f73ab658d00>]}
2022-07-01 09:41:06.061292 (Thread-21): 09:41:06  Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'f48b5fd9-b5fc-4510-bbcd-b59df21410e2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f73ab674940>]}
2022-07-01 09:41:06.061574 (Thread-21): 09:41:06  Found 5 models, 0 tests, 0 snapshots, 0 analyses, 179 macros, 0 operations, 0 seed files, 15 sources, 0 exposures, 0 metrics
2022-07-01 09:41:06.070136 (Thread-21): sending response (<Response 2713 bytes [200 OK]>) to 10.0.18.132
2022-07-01 09:41:18.546550 (Thread-22): handling status request
2022-07-01 09:41:18.548521 (Thread-22): 09:41:18  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'f48b5fd9-b5fc-4510-bbcd-b59df21410e2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f73ab704730>]}
2022-07-01 09:41:18.549011 (Thread-22): sending response (<Response 1669 bytes [200 OK]>) to 10.0.18.132
2022-07-01 09:41:18.556447 (Thread-23): handling list request
2022-07-01 09:41:18.556708 (Thread-23): 09:41:18  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'f48b5fd9-b5fc-4510-bbcd-b59df21410e2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f73ab704520>]}
2022-07-01 09:41:18.587487 (Thread-23): 09:41:18  Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'f48b5fd9-b5fc-4510-bbcd-b59df21410e2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f73ab642af0>]}
2022-07-01 09:41:18.587755 (Thread-23): 09:41:18  Found 5 models, 0 tests, 0 snapshots, 0 analyses, 179 macros, 0 operations, 0 seed files, 15 sources, 0 exposures, 0 metrics
2022-07-01 09:41:18.591429 (Thread-23): sending response (<Response 2713 bytes [200 OK]>) to 10.0.18.132
2022-07-01 09:41:19.448586 (Thread-24): handling status request
2022-07-01 09:41:19.449005 (Thread-24): 09:41:19  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'f48b5fd9-b5fc-4510-bbcd-b59df21410e2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f73ab704520>]}
2022-07-01 09:41:19.449482 (Thread-24): sending response (<Response 1669 bytes [200 OK]>) to 10.0.18.132
2022-07-01 09:41:19.458414 (Thread-25): handling list request
2022-07-01 09:41:19.458669 (Thread-25): 09:41:19  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'f48b5fd9-b5fc-4510-bbcd-b59df21410e2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f73ab674f40>]}
2022-07-01 09:41:19.487622 (Thread-25): 09:41:19  Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'f48b5fd9-b5fc-4510-bbcd-b59df21410e2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f73ab64cc10>]}
2022-07-01 09:41:19.487892 (Thread-25): 09:41:19  Found 5 models, 0 tests, 0 snapshots, 0 analyses, 179 macros, 0 operations, 0 seed files, 15 sources, 0 exposures, 0 metrics
2022-07-01 09:41:19.491588 (Thread-25): sending response (<Response 2032 bytes [200 OK]>) to 10.0.18.132
2022-07-01 09:41:22.340239 (Thread-26): handling status request
2022-07-01 09:41:22.340677 (Thread-26): 09:41:22  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'f48b5fd9-b5fc-4510-bbcd-b59df21410e2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f73a85c34f0>]}
2022-07-01 09:41:22.341400 (Thread-26): sending response (<Response 1669 bytes [200 OK]>) to 10.0.18.132
2022-07-01 09:41:22.369597 (Thread-27): handling list request
2022-07-01 09:41:22.369984 (Thread-27): 09:41:22  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'f48b5fd9-b5fc-4510-bbcd-b59df21410e2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f73ab669fd0>]}
2022-07-01 09:41:22.400365 (Thread-27): 09:41:22  Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'f48b5fd9-b5fc-4510-bbcd-b59df21410e2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f73a85c3d30>]}
2022-07-01 09:41:22.400709 (Thread-27): 09:41:22  Found 5 models, 0 tests, 0 snapshots, 0 analyses, 179 macros, 0 operations, 0 seed files, 15 sources, 0 exposures, 0 metrics
2022-07-01 09:41:22.403061 (Thread-27): 09:41:22  The selection criterion '+models/data_model/stg_user_properties.sql+' does not match any nodes
2022-07-01 09:41:22.403216 (Thread-27): 09:41:22  No nodes selected!
2022-07-01 09:41:22.404654 (Thread-27): sending response (<Response 1955 bytes [200 OK]>) to 10.0.18.132
2022-07-01 09:43:06.973340 (Thread-28): handling status request
2022-07-01 09:43:06.975222 (Thread-28): 09:43:06  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'f48b5fd9-b5fc-4510-bbcd-b59df21410e2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f73a85cda30>]}
2022-07-01 09:43:06.975694 (Thread-28): sending response (<Response 1692 bytes [200 OK]>) to 10.0.18.132
2022-07-01 09:43:07.339284 (Thread-29): handling run_sql request
2022-07-01 09:43:07.339597 (Thread-29): 09:43:07  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'f48b5fd9-b5fc-4510-bbcd-b59df21410e2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f73a85cd5b0>]}
2022-07-01 09:43:09.650014 (Thread-29): sending response (<Response 139 bytes [200 OK]>) to 10.0.18.132
2022-07-01 09:43:09.678138 (MainThread): 09:43:09  Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '3b162b5a-2a18-42b8-a533-04add69f91ab', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0827ec1970>]}
2022-07-01 09:43:09.678661 (MainThread): 09:43:09  Found 5 models, 0 tests, 0 snapshots, 0 analyses, 179 macros, 0 operations, 0 seed files, 15 sources, 0 exposures, 0 metrics
2022-07-01 09:43:09.679245 (Thread-1): 09:43:09  Acquiring new snowflake connection "rpc.ecommerce_data_model_dbt.request"
2022-07-01 09:43:09.679379 (Thread-1): 09:43:09  Began compiling node rpc.ecommerce_data_model_dbt.request
2022-07-01 09:43:09.679472 (Thread-1): 09:43:09  Compiling rpc.ecommerce_data_model_dbt.request
2022-07-01 09:43:09.682050 (Thread-1): 09:43:09  finished collecting timing info
2022-07-01 09:43:09.682183 (Thread-1): 09:43:09  Began executing node rpc.ecommerce_data_model_dbt.request
2022-07-01 09:43:09.683119 (Thread-1): 09:43:09  Using snowflake connection "rpc.ecommerce_data_model_dbt.request"
2022-07-01 09:43:09.683211 (Thread-1): 09:43:09  On rpc.ecommerce_data_model_dbt.request: with cte_gender as 
(select user_id, gender from 
(select user_id, properties_gender as gender, row_number() over(partition by user_id order by timestamp desc) as rn from 
analytics_db.data_apps_simulated.identifies where timestamp >= '2021-06-01' and timestamp <= '2022-06-29'
and properties_gender is not null and properties_gender != '') a where rn = 1),
cte_age as ()
select coalesce(a.user_id, b.user_id) as user_id, gender, age from cte_gender a full outer join cte_age b on a.user_id = b.user_id
limit 500
/* limit added automatically by dbt cloud */
2022-07-01 09:43:09.683293 (Thread-1): 09:43:09  Opening a new connection, currently in state init
2022-07-01 09:43:10.015612 (Thread-30): handling poll request
2022-07-01 09:43:10.016065 (Thread-30): 09:43:10  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'f48b5fd9-b5fc-4510-bbcd-b59df21410e2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f73a85d8760>]}
2022-07-01 09:43:10.016985 (Thread-30): sending response (<Response 4289 bytes [200 OK]>) to 10.0.18.132
2022-07-01 09:43:10.314988 (Thread-1): 09:43:10  Snowflake adapter: Snowflake query id: 01a55007-0602-3016-0019-82030461855e
2022-07-01 09:43:10.315181 (Thread-1): 09:43:10  Snowflake adapter: Snowflake error: 001003 (42000): SQL compilation error:
syntax error line 6 at position 12 unexpected ')'.
2022-07-01 09:43:10.315341 (Thread-1): 09:43:10  finished collecting timing info
2022-07-01 09:43:10.315498 (Thread-1): 09:43:10  On rpc.ecommerce_data_model_dbt.request: Close
2022-07-01 09:43:10.385109 (Thread-1): Got an exception: Database Error
  001003 (42000): SQL compilation error:
  syntax error line 6 at position 12 unexpected ')'.
Traceback (most recent call last):
  File "/usr/local/lib/python3.8/dist-packages/dbt/adapters/snowflake/connections.py", line 206, in exception_handler
    yield
  File "/usr/local/lib/python3.8/dist-packages/dbt/adapters/sql/connections.py", line 74, in add_query
    cursor.execute(sql, bindings)
  File "/usr/local/lib/python3.8/dist-packages/snowflake/connector/cursor.py", line 721, in execute
    Error.errorhandler_wrapper(
  File "/usr/local/lib/python3.8/dist-packages/snowflake/connector/errors.py", line 258, in errorhandler_wrapper
    cursor.errorhandler(connection, cursor, error_class, error_value)
  File "/usr/local/lib/python3.8/dist-packages/snowflake/connector/errors.py", line 188, in default_errorhandler
    raise error_class(
snowflake.connector.errors.ProgrammingError: 001003 (42000): SQL compilation error:
syntax error line 6 at position 12 unexpected ')'.

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/usr/local/lib/python3.8/dist-packages/dbt/task/base.py", line 361, in safe_run
    result = self.compile_and_execute(manifest, ctx)
  File "/usr/local/lib/python3.8/dist-packages/dbt/task/base.py", line 314, in compile_and_execute
    result = self.run(ctx.node, manifest)
  File "/usr/local/lib/python3.8/dist-packages/dbt/task/base.py", line 403, in run
    return self.execute(compiled_node, manifest)
  File "/usr/local/lib/python3.8/dist-packages/dbt_rpc/rpc/node_runners.py", line 90, in execute
    _, execute_result = self.adapter.execute(
  File "/usr/local/lib/python3.8/dist-packages/dbt/adapters/base/impl.py", line 225, in execute
    return self.connections.execute(
  File "/usr/local/lib/python3.8/dist-packages/dbt/adapters/sql/connections.py", line 127, in execute
    _, cursor = self.add_query(sql, auto_begin)
  File "/usr/local/lib/python3.8/dist-packages/dbt/adapters/snowflake/connections.py", line 433, in add_query
    connection, cursor = super().add_query(
  File "/usr/local/lib/python3.8/dist-packages/dbt/adapters/sql/connections.py", line 83, in add_query
    return connection, cursor
  File "/usr/lib/python3.8/contextlib.py", line 131, in __exit__
    self.gen.throw(type, value, traceback)
  File "/usr/local/lib/python3.8/dist-packages/dbt/adapters/snowflake/connections.py", line 223, in exception_handler
    raise DatabaseException(msg)
dbt.exceptions.DatabaseException: Database Error
  001003 (42000): SQL compilation error:
  syntax error line 6 at position 12 unexpected ')'.
2022-07-01 09:43:10.385955 (Thread-1): Got exception RPCException(10003, Database Error, {'type': 'DatabaseException', 'message': "Database Error in rpc request (from remote system)\n  001003 (42000): SQL compilation error:\n  syntax error line 6 at position 12 unexpected ')'.", 'raw_sql': "with cte_gender as \n(select user_id, gender from \n(select user_id, properties_gender as gender, row_number() over(partition by user_id order by timestamp desc) as rn from \n{{ source('ecommerce', 'identifies') }} where timestamp >= '{{ var('start_date') }}' and timestamp <= '{{ var('end_date') }}'\nand properties_gender is not null and properties_gender != '') a where rn = 1),\ncte_age as ()\nselect coalesce(a.user_id, b.user_id) as user_id, gender, age from cte_gender a full outer join cte_age b on a.user_id = b.user_id\nlimit 500\n/* limit added automatically by dbt cloud */", 'compiled_sql': "with cte_gender as \n(select user_id, gender from \n(select user_id, properties_gender as gender, row_number() over(partition by user_id order by timestamp desc) as rn from \nanalytics_db.data_apps_simulated.identifies where timestamp >= '2021-06-01' and timestamp <= '2022-06-29'\nand properties_gender is not null and properties_gender != '') a where rn = 1),\ncte_age as ()\nselect coalesce(a.user_id, b.user_id) as user_id, gender, age from cte_gender a full outer join cte_age b on a.user_id = b.user_id\nlimit 500\n/* limit added automatically by dbt cloud */", 'tags': None}, None)
Traceback (most recent call last):
  File "/usr/local/lib/python3.8/dist-packages/dbt_rpc/task/sql_commands.py", line 147, in _in_thread
    self.node_results.append(runner.safe_run(self.manifest))
  File "/usr/local/lib/python3.8/dist-packages/dbt/task/base.py", line 377, in safe_run
    result = self.error_result(ctx.node, error, started, [])
  File "/usr/local/lib/python3.8/dist-packages/dbt_rpc/rpc/node_runners.py", line 56, in error_result
    raise error
dbt_rpc.rpc.error.RPCException: RPCException(10003, Database Error, {'type': 'DatabaseException', 'message': "Database Error in rpc request (from remote system)\n  001003 (42000): SQL compilation error:\n  syntax error line 6 at position 12 unexpected ')'.", 'raw_sql': "with cte_gender as \n(select user_id, gender from \n(select user_id, properties_gender as gender, row_number() over(partition by user_id order by timestamp desc) as rn from \n{{ source('ecommerce', 'identifies') }} where timestamp >= '{{ var('start_date') }}' and timestamp <= '{{ var('end_date') }}'\nand properties_gender is not null and properties_gender != '') a where rn = 1),\ncte_age as ()\nselect coalesce(a.user_id, b.user_id) as user_id, gender, age from cte_gender a full outer join cte_age b on a.user_id = b.user_id\nlimit 500\n/* limit added automatically by dbt cloud */", 'compiled_sql': "with cte_gender as \n(select user_id, gender from \n(select user_id, properties_gender as gender, row_number() over(partition by user_id order by timestamp desc) as rn from \nanalytics_db.data_apps_simulated.identifies where timestamp >= '2021-06-01' and timestamp <= '2022-06-29'\nand properties_gender is not null and properties_gender != '') a where rn = 1),\ncte_age as ()\nselect coalesce(a.user_id, b.user_id) as user_id, gender, age from cte_gender a full outer join cte_age b on a.user_id = b.user_id\nlimit 500\n/* limit added automatically by dbt cloud */", 'tags': None}, None)
2022-07-01 09:43:11.410214 (Thread-31): handling poll request
2022-07-01 09:43:11.410626 (Thread-31): 09:43:11  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'f48b5fd9-b5fc-4510-bbcd-b59df21410e2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f73a85d8a60>]}
2022-07-01 09:43:11.411227 (Thread-31): sending response (<Response 13376 bytes [200 OK]>) to 10.0.18.132
2022-07-01 09:44:07.232797 (Thread-32): handling status request
2022-07-01 09:44:07.234588 (Thread-32): 09:44:07  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'f48b5fd9-b5fc-4510-bbcd-b59df21410e2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f73a85d8f10>]}
2022-07-01 09:44:07.235093 (Thread-32): sending response (<Response 1692 bytes [200 OK]>) to 10.0.18.132
2022-07-01 09:44:07.611734 (Thread-33): handling run_sql request
2022-07-01 09:44:07.612110 (Thread-33): 09:44:07  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'f48b5fd9-b5fc-4510-bbcd-b59df21410e2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f73a85e10a0>]}
2022-07-01 09:44:09.958843 (Thread-33): sending response (<Response 139 bytes [200 OK]>) to 10.0.18.132
2022-07-01 09:44:09.986627 (MainThread): 09:44:09  Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'fafb450d-c6b1-4911-a162-fa43c73c7d21', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7effa0a05a30>]}
2022-07-01 09:44:09.987142 (MainThread): 09:44:09  Found 5 models, 0 tests, 0 snapshots, 0 analyses, 179 macros, 0 operations, 0 seed files, 15 sources, 0 exposures, 0 metrics
2022-07-01 09:44:09.987717 (Thread-1): 09:44:09  Acquiring new snowflake connection "rpc.ecommerce_data_model_dbt.request"
2022-07-01 09:44:09.987850 (Thread-1): 09:44:09  Began compiling node rpc.ecommerce_data_model_dbt.request
2022-07-01 09:44:09.987943 (Thread-1): 09:44:09  Compiling rpc.ecommerce_data_model_dbt.request
2022-07-01 09:44:09.990516 (Thread-1): 09:44:09  finished collecting timing info
2022-07-01 09:44:09.990658 (Thread-1): 09:44:09  Began executing node rpc.ecommerce_data_model_dbt.request
2022-07-01 09:44:09.991612 (Thread-1): 09:44:09  Using snowflake connection "rpc.ecommerce_data_model_dbt.request"
2022-07-01 09:44:09.991706 (Thread-1): 09:44:09  On rpc.ecommerce_data_model_dbt.request: with cte_gender as 
(select user_id, gender from 
(select user_id, properties_gender as gender, row_number() over(partition by user_id order by timestamp desc) as rn from 
analytics_db.data_apps_simulated.identifies where timestamp >= '2021-06-01' and timestamp <= '2022-06-29'
and properties_gender is not null and properties_gender != '') a where rn = 1,
cte_age as ()
select coalesce(a.user_id, b.user_id) as user_id, gender, age from cte_gender a full outer join cte_age b on a.user_id = b.user_id
limit 500
/* limit added automatically by dbt cloud */
2022-07-01 09:44:09.991788 (Thread-1): 09:44:09  Opening a new connection, currently in state init
2022-07-01 09:44:10.356285 (Thread-34): handling poll request
2022-07-01 09:44:10.356754 (Thread-34): 09:44:10  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'f48b5fd9-b5fc-4510-bbcd-b59df21410e2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f73a85e90d0>]}
2022-07-01 09:44:10.357561 (Thread-34): sending response (<Response 4287 bytes [200 OK]>) to 10.0.18.132
2022-07-01 09:44:10.693299 (Thread-1): 09:44:10  Snowflake adapter: Snowflake query id: 01a55008-0602-2e59-0019-820304617752
2022-07-01 09:44:10.693566 (Thread-1): 09:44:10  Snowflake adapter: Snowflake error: 001003 (42000): SQL compilation error:
syntax error line 5 at position 77 unexpected ','.
syntax error line 6 at position 12 unexpected ')'.
2022-07-01 09:44:10.693800 (Thread-1): 09:44:10  finished collecting timing info
2022-07-01 09:44:10.694023 (Thread-1): 09:44:10  On rpc.ecommerce_data_model_dbt.request: Close
2022-07-01 09:44:10.764643 (Thread-1): Got an exception: Database Error
  001003 (42000): SQL compilation error:
  syntax error line 5 at position 77 unexpected ','.
  syntax error line 6 at position 12 unexpected ')'.
Traceback (most recent call last):
  File "/usr/local/lib/python3.8/dist-packages/dbt/adapters/snowflake/connections.py", line 206, in exception_handler
    yield
  File "/usr/local/lib/python3.8/dist-packages/dbt/adapters/sql/connections.py", line 74, in add_query
    cursor.execute(sql, bindings)
  File "/usr/local/lib/python3.8/dist-packages/snowflake/connector/cursor.py", line 721, in execute
    Error.errorhandler_wrapper(
  File "/usr/local/lib/python3.8/dist-packages/snowflake/connector/errors.py", line 258, in errorhandler_wrapper
    cursor.errorhandler(connection, cursor, error_class, error_value)
  File "/usr/local/lib/python3.8/dist-packages/snowflake/connector/errors.py", line 188, in default_errorhandler
    raise error_class(
snowflake.connector.errors.ProgrammingError: 001003 (42000): SQL compilation error:
syntax error line 5 at position 77 unexpected ','.
syntax error line 6 at position 12 unexpected ')'.

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/usr/local/lib/python3.8/dist-packages/dbt/task/base.py", line 361, in safe_run
    result = self.compile_and_execute(manifest, ctx)
  File "/usr/local/lib/python3.8/dist-packages/dbt/task/base.py", line 314, in compile_and_execute
    result = self.run(ctx.node, manifest)
  File "/usr/local/lib/python3.8/dist-packages/dbt/task/base.py", line 403, in run
    return self.execute(compiled_node, manifest)
  File "/usr/local/lib/python3.8/dist-packages/dbt_rpc/rpc/node_runners.py", line 90, in execute
    _, execute_result = self.adapter.execute(
  File "/usr/local/lib/python3.8/dist-packages/dbt/adapters/base/impl.py", line 225, in execute
    return self.connections.execute(
  File "/usr/local/lib/python3.8/dist-packages/dbt/adapters/sql/connections.py", line 127, in execute
    _, cursor = self.add_query(sql, auto_begin)
  File "/usr/local/lib/python3.8/dist-packages/dbt/adapters/snowflake/connections.py", line 433, in add_query
    connection, cursor = super().add_query(
  File "/usr/local/lib/python3.8/dist-packages/dbt/adapters/sql/connections.py", line 83, in add_query
    return connection, cursor
  File "/usr/lib/python3.8/contextlib.py", line 131, in __exit__
    self.gen.throw(type, value, traceback)
  File "/usr/local/lib/python3.8/dist-packages/dbt/adapters/snowflake/connections.py", line 223, in exception_handler
    raise DatabaseException(msg)
dbt.exceptions.DatabaseException: Database Error
  001003 (42000): SQL compilation error:
  syntax error line 5 at position 77 unexpected ','.
  syntax error line 6 at position 12 unexpected ')'.
2022-07-01 09:44:10.765672 (Thread-1): Got exception RPCException(10003, Database Error, {'type': 'DatabaseException', 'message': "Database Error in rpc request (from remote system)\n  001003 (42000): SQL compilation error:\n  syntax error line 5 at position 77 unexpected ','.\n  syntax error line 6 at position 12 unexpected ')'.", 'raw_sql': "with cte_gender as \n(select user_id, gender from \n(select user_id, properties_gender as gender, row_number() over(partition by user_id order by timestamp desc) as rn from \n{{ source('ecommerce', 'identifies') }} where timestamp >= '{{ var('start_date') }}' and timestamp <= '{{ var('end_date') }}'\nand properties_gender is not null and properties_gender != '') a where rn = 1,\ncte_age as ()\nselect coalesce(a.user_id, b.user_id) as user_id, gender, age from cte_gender a full outer join cte_age b on a.user_id = b.user_id\nlimit 500\n/* limit added automatically by dbt cloud */", 'compiled_sql': "with cte_gender as \n(select user_id, gender from \n(select user_id, properties_gender as gender, row_number() over(partition by user_id order by timestamp desc) as rn from \nanalytics_db.data_apps_simulated.identifies where timestamp >= '2021-06-01' and timestamp <= '2022-06-29'\nand properties_gender is not null and properties_gender != '') a where rn = 1,\ncte_age as ()\nselect coalesce(a.user_id, b.user_id) as user_id, gender, age from cte_gender a full outer join cte_age b on a.user_id = b.user_id\nlimit 500\n/* limit added automatically by dbt cloud */", 'tags': None}, None)
Traceback (most recent call last):
  File "/usr/local/lib/python3.8/dist-packages/dbt_rpc/task/sql_commands.py", line 147, in _in_thread
    self.node_results.append(runner.safe_run(self.manifest))
  File "/usr/local/lib/python3.8/dist-packages/dbt/task/base.py", line 377, in safe_run
    result = self.error_result(ctx.node, error, started, [])
  File "/usr/local/lib/python3.8/dist-packages/dbt_rpc/rpc/node_runners.py", line 56, in error_result
    raise error
dbt_rpc.rpc.error.RPCException: RPCException(10003, Database Error, {'type': 'DatabaseException', 'message': "Database Error in rpc request (from remote system)\n  001003 (42000): SQL compilation error:\n  syntax error line 5 at position 77 unexpected ','.\n  syntax error line 6 at position 12 unexpected ')'.", 'raw_sql': "with cte_gender as \n(select user_id, gender from \n(select user_id, properties_gender as gender, row_number() over(partition by user_id order by timestamp desc) as rn from \n{{ source('ecommerce', 'identifies') }} where timestamp >= '{{ var('start_date') }}' and timestamp <= '{{ var('end_date') }}'\nand properties_gender is not null and properties_gender != '') a where rn = 1,\ncte_age as ()\nselect coalesce(a.user_id, b.user_id) as user_id, gender, age from cte_gender a full outer join cte_age b on a.user_id = b.user_id\nlimit 500\n/* limit added automatically by dbt cloud */", 'compiled_sql': "with cte_gender as \n(select user_id, gender from \n(select user_id, properties_gender as gender, row_number() over(partition by user_id order by timestamp desc) as rn from \nanalytics_db.data_apps_simulated.identifies where timestamp >= '2021-06-01' and timestamp <= '2022-06-29'\nand properties_gender is not null and properties_gender != '') a where rn = 1,\ncte_age as ()\nselect coalesce(a.user_id, b.user_id) as user_id, gender, age from cte_gender a full outer join cte_age b on a.user_id = b.user_id\nlimit 500\n/* limit added automatically by dbt cloud */", 'tags': None}, None)
2022-07-01 09:44:11.734944 (Thread-35): handling poll request
2022-07-01 09:44:11.735343 (Thread-35): 09:44:11  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'f48b5fd9-b5fc-4510-bbcd-b59df21410e2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f73a85e93d0>]}
2022-07-01 09:44:11.757884 (Thread-35): sending response (<Response 13745 bytes [200 OK]>) to 10.0.18.132
2022-07-01 09:45:38.256436 (Thread-36): handling status request
2022-07-01 09:45:38.258147 (Thread-36): 09:45:38  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'f48b5fd9-b5fc-4510-bbcd-b59df21410e2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f73a85e9220>]}
2022-07-01 09:45:38.258646 (Thread-36): sending response (<Response 1692 bytes [200 OK]>) to 10.0.18.132
2022-07-01 09:45:38.641129 (Thread-37): handling compile_sql request
2022-07-01 09:45:38.641518 (Thread-37): 09:45:38  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'f48b5fd9-b5fc-4510-bbcd-b59df21410e2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f73a85e9a30>]}
2022-07-01 09:45:40.949998 (Thread-37): sending response (<Response 139 bytes [200 OK]>) to 10.0.18.132
2022-07-01 09:45:40.977565 (MainThread): 09:45:40  Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'cf498e66-d26a-4343-bc9a-ce57e4be2edd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcb9ecafa60>]}
2022-07-01 09:45:40.978072 (MainThread): 09:45:40  Found 5 models, 0 tests, 0 snapshots, 0 analyses, 179 macros, 0 operations, 0 seed files, 15 sources, 0 exposures, 0 metrics
2022-07-01 09:45:40.978646 (Thread-1): 09:45:40  Acquiring new snowflake connection "rpc.ecommerce_data_model_dbt.request"
2022-07-01 09:45:40.978780 (Thread-1): 09:45:40  Began compiling node rpc.ecommerce_data_model_dbt.request
2022-07-01 09:45:40.978872 (Thread-1): 09:45:40  Compiling rpc.ecommerce_data_model_dbt.request
2022-07-01 09:45:40.981407 (Thread-1): 09:45:40  finished collecting timing info
2022-07-01 09:45:40.981546 (Thread-1): 09:45:40  Began executing node rpc.ecommerce_data_model_dbt.request
2022-07-01 09:45:40.981644 (Thread-1): 09:45:40  finished collecting timing info
2022-07-01 09:45:41.320081 (Thread-38): handling poll request
2022-07-01 09:45:41.320542 (Thread-38): 09:45:41  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'f48b5fd9-b5fc-4510-bbcd-b59df21410e2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f73a85f2be0>]}
2022-07-01 09:45:41.321699 (Thread-38): sending response (<Response 7333 bytes [200 OK]>) to 10.0.18.132
2022-07-01 09:45:47.254126 (Thread-39): handling status request
2022-07-01 09:45:47.254550 (Thread-39): 09:45:47  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'f48b5fd9-b5fc-4510-bbcd-b59df21410e2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f73a85f2df0>]}
2022-07-01 09:45:47.255069 (Thread-39): sending response (<Response 1692 bytes [200 OK]>) to 10.0.18.132
2022-07-01 09:45:47.621397 (Thread-40): handling run_sql request
2022-07-01 09:45:47.621782 (Thread-40): 09:45:47  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'f48b5fd9-b5fc-4510-bbcd-b59df21410e2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f73a85f2d90>]}
2022-07-01 09:45:49.936692 (Thread-40): sending response (<Response 139 bytes [200 OK]>) to 10.0.18.132
2022-07-01 09:45:49.961803 (MainThread): 09:45:49  Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'bef547ec-5ccb-4ec3-a719-dde92b356f51', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f48fb602a60>]}
2022-07-01 09:45:49.962307 (MainThread): 09:45:49  Found 5 models, 0 tests, 0 snapshots, 0 analyses, 179 macros, 0 operations, 0 seed files, 15 sources, 0 exposures, 0 metrics
2022-07-01 09:45:49.962874 (Thread-1): 09:45:49  Acquiring new snowflake connection "rpc.ecommerce_data_model_dbt.request"
2022-07-01 09:45:49.963004 (Thread-1): 09:45:49  Began compiling node rpc.ecommerce_data_model_dbt.request
2022-07-01 09:45:49.963096 (Thread-1): 09:45:49  Compiling rpc.ecommerce_data_model_dbt.request
2022-07-01 09:45:49.965598 (Thread-1): 09:45:49  finished collecting timing info
2022-07-01 09:45:49.965724 (Thread-1): 09:45:49  Began executing node rpc.ecommerce_data_model_dbt.request
2022-07-01 09:45:49.966642 (Thread-1): 09:45:49  Using snowflake connection "rpc.ecommerce_data_model_dbt.request"
2022-07-01 09:45:49.966732 (Thread-1): 09:45:49  On rpc.ecommerce_data_model_dbt.request: with cte_gender as 
(select user_id, gender from 
(select user_id, properties_gender as gender, row_number() over(partition by user_id order by timestamp desc) as rn from 
analytics_db.data_apps_simulated.identifies where timestamp >= '2021-06-01' and timestamp <= '2022-06-29'
and properties_gender is not null and properties_gender != '') a where rn = 1),
cte_age as ()
select coalesce(a.user_id, b.user_id) as user_id, gender, age from cte_gender a full outer join cte_age b on a.user_id = b.user_id
limit 500
/* limit added automatically by dbt cloud */
2022-07-01 09:45:49.966812 (Thread-1): 09:45:49  Opening a new connection, currently in state init
2022-07-01 09:45:50.302419 (Thread-41): handling poll request
2022-07-01 09:45:50.302859 (Thread-41): 09:45:50  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'f48b5fd9-b5fc-4510-bbcd-b59df21410e2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f73a85fae20>]}
2022-07-01 09:45:50.303676 (Thread-41): sending response (<Response 4289 bytes [200 OK]>) to 10.0.18.132
2022-07-01 09:45:50.612477 (Thread-1): 09:45:50  Snowflake adapter: Snowflake query id: 01a55009-0602-3016-0019-820304618572
2022-07-01 09:45:50.612666 (Thread-1): 09:45:50  Snowflake adapter: Snowflake error: 001003 (42000): SQL compilation error:
syntax error line 6 at position 12 unexpected ')'.
2022-07-01 09:45:50.612822 (Thread-1): 09:45:50  finished collecting timing info
2022-07-01 09:45:50.612975 (Thread-1): 09:45:50  On rpc.ecommerce_data_model_dbt.request: Close
2022-07-01 09:45:50.691446 (Thread-1): Got an exception: Database Error
  001003 (42000): SQL compilation error:
  syntax error line 6 at position 12 unexpected ')'.
Traceback (most recent call last):
  File "/usr/local/lib/python3.8/dist-packages/dbt/adapters/snowflake/connections.py", line 206, in exception_handler
    yield
  File "/usr/local/lib/python3.8/dist-packages/dbt/adapters/sql/connections.py", line 74, in add_query
    cursor.execute(sql, bindings)
  File "/usr/local/lib/python3.8/dist-packages/snowflake/connector/cursor.py", line 721, in execute
    Error.errorhandler_wrapper(
  File "/usr/local/lib/python3.8/dist-packages/snowflake/connector/errors.py", line 258, in errorhandler_wrapper
    cursor.errorhandler(connection, cursor, error_class, error_value)
  File "/usr/local/lib/python3.8/dist-packages/snowflake/connector/errors.py", line 188, in default_errorhandler
    raise error_class(
snowflake.connector.errors.ProgrammingError: 001003 (42000): SQL compilation error:
syntax error line 6 at position 12 unexpected ')'.

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/usr/local/lib/python3.8/dist-packages/dbt/task/base.py", line 361, in safe_run
    result = self.compile_and_execute(manifest, ctx)
  File "/usr/local/lib/python3.8/dist-packages/dbt/task/base.py", line 314, in compile_and_execute
    result = self.run(ctx.node, manifest)
  File "/usr/local/lib/python3.8/dist-packages/dbt/task/base.py", line 403, in run
    return self.execute(compiled_node, manifest)
  File "/usr/local/lib/python3.8/dist-packages/dbt_rpc/rpc/node_runners.py", line 90, in execute
    _, execute_result = self.adapter.execute(
  File "/usr/local/lib/python3.8/dist-packages/dbt/adapters/base/impl.py", line 225, in execute
    return self.connections.execute(
  File "/usr/local/lib/python3.8/dist-packages/dbt/adapters/sql/connections.py", line 127, in execute
    _, cursor = self.add_query(sql, auto_begin)
  File "/usr/local/lib/python3.8/dist-packages/dbt/adapters/snowflake/connections.py", line 433, in add_query
    connection, cursor = super().add_query(
  File "/usr/local/lib/python3.8/dist-packages/dbt/adapters/sql/connections.py", line 83, in add_query
    return connection, cursor
  File "/usr/lib/python3.8/contextlib.py", line 131, in __exit__
    self.gen.throw(type, value, traceback)
  File "/usr/local/lib/python3.8/dist-packages/dbt/adapters/snowflake/connections.py", line 223, in exception_handler
    raise DatabaseException(msg)
dbt.exceptions.DatabaseException: Database Error
  001003 (42000): SQL compilation error:
  syntax error line 6 at position 12 unexpected ')'.
2022-07-01 09:45:50.692342 (Thread-1): Got exception RPCException(10003, Database Error, {'type': 'DatabaseException', 'message': "Database Error in rpc request (from remote system)\n  001003 (42000): SQL compilation error:\n  syntax error line 6 at position 12 unexpected ')'.", 'raw_sql': "with cte_gender as \n(select user_id, gender from \n(select user_id, properties_gender as gender, row_number() over(partition by user_id order by timestamp desc) as rn from \n{{ source('ecommerce', 'identifies') }} where timestamp >= '{{ var('start_date') }}' and timestamp <= '{{ var('end_date') }}'\nand properties_gender is not null and properties_gender != '') a where rn = 1),\ncte_age as ()\nselect coalesce(a.user_id, b.user_id) as user_id, gender, age from cte_gender a full outer join cte_age b on a.user_id = b.user_id\nlimit 500\n/* limit added automatically by dbt cloud */", 'compiled_sql': "with cte_gender as \n(select user_id, gender from \n(select user_id, properties_gender as gender, row_number() over(partition by user_id order by timestamp desc) as rn from \nanalytics_db.data_apps_simulated.identifies where timestamp >= '2021-06-01' and timestamp <= '2022-06-29'\nand properties_gender is not null and properties_gender != '') a where rn = 1),\ncte_age as ()\nselect coalesce(a.user_id, b.user_id) as user_id, gender, age from cte_gender a full outer join cte_age b on a.user_id = b.user_id\nlimit 500\n/* limit added automatically by dbt cloud */", 'tags': None}, None)
Traceback (most recent call last):
  File "/usr/local/lib/python3.8/dist-packages/dbt_rpc/task/sql_commands.py", line 147, in _in_thread
    self.node_results.append(runner.safe_run(self.manifest))
  File "/usr/local/lib/python3.8/dist-packages/dbt/task/base.py", line 377, in safe_run
    result = self.error_result(ctx.node, error, started, [])
  File "/usr/local/lib/python3.8/dist-packages/dbt_rpc/rpc/node_runners.py", line 56, in error_result
    raise error
dbt_rpc.rpc.error.RPCException: RPCException(10003, Database Error, {'type': 'DatabaseException', 'message': "Database Error in rpc request (from remote system)\n  001003 (42000): SQL compilation error:\n  syntax error line 6 at position 12 unexpected ')'.", 'raw_sql': "with cte_gender as \n(select user_id, gender from \n(select user_id, properties_gender as gender, row_number() over(partition by user_id order by timestamp desc) as rn from \n{{ source('ecommerce', 'identifies') }} where timestamp >= '{{ var('start_date') }}' and timestamp <= '{{ var('end_date') }}'\nand properties_gender is not null and properties_gender != '') a where rn = 1),\ncte_age as ()\nselect coalesce(a.user_id, b.user_id) as user_id, gender, age from cte_gender a full outer join cte_age b on a.user_id = b.user_id\nlimit 500\n/* limit added automatically by dbt cloud */", 'compiled_sql': "with cte_gender as \n(select user_id, gender from \n(select user_id, properties_gender as gender, row_number() over(partition by user_id order by timestamp desc) as rn from \nanalytics_db.data_apps_simulated.identifies where timestamp >= '2021-06-01' and timestamp <= '2022-06-29'\nand properties_gender is not null and properties_gender != '') a where rn = 1),\ncte_age as ()\nselect coalesce(a.user_id, b.user_id) as user_id, gender, age from cte_gender a full outer join cte_age b on a.user_id = b.user_id\nlimit 500\n/* limit added automatically by dbt cloud */", 'tags': None}, None)
2022-07-01 09:45:51.670102 (Thread-42): handling poll request
2022-07-01 09:45:51.670512 (Thread-42): 09:45:51  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'f48b5fd9-b5fc-4510-bbcd-b59df21410e2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f73a8584190>]}
2022-07-01 09:45:51.671134 (Thread-42): sending response (<Response 13376 bytes [200 OK]>) to 10.0.18.132
2022-07-01 09:45:57.162664 (Thread-43): handling status request
2022-07-01 09:45:57.163067 (Thread-43): 09:45:57  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'f48b5fd9-b5fc-4510-bbcd-b59df21410e2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f73a85845e0>]}
2022-07-01 09:45:57.163562 (Thread-43): sending response (<Response 1692 bytes [200 OK]>) to 10.0.18.132
2022-07-01 09:45:57.770029 (Thread-44): handling compile_sql request
2022-07-01 09:45:57.770444 (Thread-44): 09:45:57  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'f48b5fd9-b5fc-4510-bbcd-b59df21410e2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f73a85847c0>]}
2022-07-01 09:46:00.079783 (Thread-44): sending response (<Response 139 bytes [200 OK]>) to 10.0.18.132
2022-07-01 09:46:00.104962 (MainThread): 09:46:00  Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '410e5b62-d5ed-4ad8-97a5-2a1609ddf36e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb54c803a60>]}
2022-07-01 09:46:00.105482 (MainThread): 09:46:00  Found 5 models, 0 tests, 0 snapshots, 0 analyses, 179 macros, 0 operations, 0 seed files, 15 sources, 0 exposures, 0 metrics
2022-07-01 09:46:00.106060 (Thread-1): 09:46:00  Acquiring new snowflake connection "rpc.ecommerce_data_model_dbt.request"
2022-07-01 09:46:00.106195 (Thread-1): 09:46:00  Began compiling node rpc.ecommerce_data_model_dbt.request
2022-07-01 09:46:00.106287 (Thread-1): 09:46:00  Compiling rpc.ecommerce_data_model_dbt.request
2022-07-01 09:46:00.108813 (Thread-1): 09:46:00  finished collecting timing info
2022-07-01 09:46:00.108942 (Thread-1): 09:46:00  Began executing node rpc.ecommerce_data_model_dbt.request
2022-07-01 09:46:00.109045 (Thread-1): 09:46:00  finished collecting timing info
2022-07-01 09:46:00.451635 (Thread-45): handling poll request
2022-07-01 09:46:00.452123 (Thread-45): 09:46:00  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'f48b5fd9-b5fc-4510-bbcd-b59df21410e2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f73a8584580>]}
2022-07-01 09:46:00.453221 (Thread-45): sending response (<Response 7333 bytes [200 OK]>) to 10.0.18.132
2022-07-01 10:04:14.594262 (Thread-46): handling status request
2022-07-01 10:04:14.595966 (Thread-46): 10:04:14  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'f48b5fd9-b5fc-4510-bbcd-b59df21410e2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f73a858a460>]}
2022-07-01 10:04:14.596506 (Thread-46): sending response (<Response 1692 bytes [200 OK]>) to 10.0.18.132
2022-07-01 10:04:14.980476 (Thread-47): handling compile_sql request
2022-07-01 10:04:14.980881 (Thread-47): 10:04:14  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'f48b5fd9-b5fc-4510-bbcd-b59df21410e2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f73a858a640>]}
2022-07-01 10:04:17.273624 (Thread-47): sending response (<Response 139 bytes [200 OK]>) to 10.0.18.132
2022-07-01 10:04:17.301679 (MainThread): 10:04:17  Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'f9343dfb-30f3-4bd2-9d1e-7e863991f7c8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8eef27e9a0>]}
2022-07-01 10:04:17.302176 (MainThread): 10:04:17  Found 5 models, 0 tests, 0 snapshots, 0 analyses, 179 macros, 0 operations, 0 seed files, 15 sources, 0 exposures, 0 metrics
2022-07-01 10:04:17.302734 (Thread-1): 10:04:17  Acquiring new snowflake connection "rpc.ecommerce_data_model_dbt.request"
2022-07-01 10:04:17.302865 (Thread-1): 10:04:17  Began compiling node rpc.ecommerce_data_model_dbt.request
2022-07-01 10:04:17.302957 (Thread-1): 10:04:17  Compiling rpc.ecommerce_data_model_dbt.request
2022-07-01 10:04:17.305440 (Thread-1): 10:04:17  finished collecting timing info
2022-07-01 10:04:17.305568 (Thread-1): 10:04:17  Began executing node rpc.ecommerce_data_model_dbt.request
2022-07-01 10:04:17.305694 (Thread-1): 10:04:17  finished collecting timing info
2022-07-01 10:04:17.661113 (Thread-48): handling poll request
2022-07-01 10:04:17.661569 (Thread-48): 10:04:17  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'f48b5fd9-b5fc-4510-bbcd-b59df21410e2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f73a85966d0>]}
2022-07-01 10:04:17.662669 (Thread-48): sending response (<Response 7325 bytes [200 OK]>) to 10.0.18.132
2022-07-01 10:04:32.666424 (Thread-49): handling status request
2022-07-01 10:04:32.666805 (Thread-49): 10:04:32  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'f48b5fd9-b5fc-4510-bbcd-b59df21410e2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f73a85968b0>]}
2022-07-01 10:04:32.667299 (Thread-49): sending response (<Response 1692 bytes [200 OK]>) to 10.0.18.132
2022-07-01 10:04:33.041348 (Thread-50): handling run_sql request
2022-07-01 10:04:33.041760 (Thread-50): 10:04:33  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'f48b5fd9-b5fc-4510-bbcd-b59df21410e2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f73a858a670>]}
2022-07-01 10:04:35.341514 (Thread-50): sending response (<Response 139 bytes [200 OK]>) to 10.0.18.132
2022-07-01 10:04:35.366649 (MainThread): 10:04:35  Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '53eb8efb-bada-47bd-8d51-117b534d98d1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f61a26b09a0>]}
2022-07-01 10:04:35.367152 (MainThread): 10:04:35  Found 5 models, 0 tests, 0 snapshots, 0 analyses, 179 macros, 0 operations, 0 seed files, 15 sources, 0 exposures, 0 metrics
2022-07-01 10:04:35.367701 (Thread-1): 10:04:35  Acquiring new snowflake connection "rpc.ecommerce_data_model_dbt.request"
2022-07-01 10:04:35.367832 (Thread-1): 10:04:35  Began compiling node rpc.ecommerce_data_model_dbt.request
2022-07-01 10:04:35.367922 (Thread-1): 10:04:35  Compiling rpc.ecommerce_data_model_dbt.request
2022-07-01 10:04:35.370427 (Thread-1): 10:04:35  finished collecting timing info
2022-07-01 10:04:35.370557 (Thread-1): 10:04:35  Began executing node rpc.ecommerce_data_model_dbt.request
2022-07-01 10:04:35.371476 (Thread-1): 10:04:35  Using snowflake connection "rpc.ecommerce_data_model_dbt.request"
2022-07-01 10:04:35.371563 (Thread-1): 10:04:35  On rpc.ecommerce_data_model_dbt.request: with cte_gender as 
(select user_id, gender from 
(select user_id, properties_gender as gender, row_number() over(partition by user_id order by timestamp desc) as rn from 
analytics_db.data_apps_simulated.identifies where timestamp >= '2021-06-01' and timestamp <= '2022-06-29'
and properties_gender is not null and properties_gender != '') where rn = 1),
cte_age as ()
select coalesce(a.user_id, b.user_id) as user_id, gender, age from cte_gender a full outer join cte_age b on a.user_id = b.user_id
limit 500
/* limit added automatically by dbt cloud */
2022-07-01 10:04:35.371642 (Thread-1): 10:04:35  Opening a new connection, currently in state init
2022-07-01 10:04:35.707988 (Thread-51): handling poll request
2022-07-01 10:04:35.708479 (Thread-51): 10:04:35  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'f48b5fd9-b5fc-4510-bbcd-b59df21410e2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f73a859aa00>]}
2022-07-01 10:04:35.709336 (Thread-51): sending response (<Response 4287 bytes [200 OK]>) to 10.0.18.132
2022-07-01 10:04:36.078573 (Thread-1): 10:04:36  Snowflake adapter: Snowflake query id: 01a5501c-0602-2e59-0019-820304617a02
2022-07-01 10:04:36.078766 (Thread-1): 10:04:36  Snowflake adapter: Snowflake error: 001003 (42000): SQL compilation error:
syntax error line 6 at position 12 unexpected ')'.
2022-07-01 10:04:36.078927 (Thread-1): 10:04:36  finished collecting timing info
2022-07-01 10:04:36.079080 (Thread-1): 10:04:36  On rpc.ecommerce_data_model_dbt.request: Close
2022-07-01 10:04:36.173111 (Thread-1): Got an exception: Database Error
  001003 (42000): SQL compilation error:
  syntax error line 6 at position 12 unexpected ')'.
Traceback (most recent call last):
  File "/usr/local/lib/python3.8/dist-packages/dbt/adapters/snowflake/connections.py", line 206, in exception_handler
    yield
  File "/usr/local/lib/python3.8/dist-packages/dbt/adapters/sql/connections.py", line 74, in add_query
    cursor.execute(sql, bindings)
  File "/usr/local/lib/python3.8/dist-packages/snowflake/connector/cursor.py", line 721, in execute
    Error.errorhandler_wrapper(
  File "/usr/local/lib/python3.8/dist-packages/snowflake/connector/errors.py", line 258, in errorhandler_wrapper
    cursor.errorhandler(connection, cursor, error_class, error_value)
  File "/usr/local/lib/python3.8/dist-packages/snowflake/connector/errors.py", line 188, in default_errorhandler
    raise error_class(
snowflake.connector.errors.ProgrammingError: 001003 (42000): SQL compilation error:
syntax error line 6 at position 12 unexpected ')'.

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/usr/local/lib/python3.8/dist-packages/dbt/task/base.py", line 361, in safe_run
    result = self.compile_and_execute(manifest, ctx)
  File "/usr/local/lib/python3.8/dist-packages/dbt/task/base.py", line 314, in compile_and_execute
    result = self.run(ctx.node, manifest)
  File "/usr/local/lib/python3.8/dist-packages/dbt/task/base.py", line 403, in run
    return self.execute(compiled_node, manifest)
  File "/usr/local/lib/python3.8/dist-packages/dbt_rpc/rpc/node_runners.py", line 90, in execute
    _, execute_result = self.adapter.execute(
  File "/usr/local/lib/python3.8/dist-packages/dbt/adapters/base/impl.py", line 225, in execute
    return self.connections.execute(
  File "/usr/local/lib/python3.8/dist-packages/dbt/adapters/sql/connections.py", line 127, in execute
    _, cursor = self.add_query(sql, auto_begin)
  File "/usr/local/lib/python3.8/dist-packages/dbt/adapters/snowflake/connections.py", line 433, in add_query
    connection, cursor = super().add_query(
  File "/usr/local/lib/python3.8/dist-packages/dbt/adapters/sql/connections.py", line 83, in add_query
    return connection, cursor
  File "/usr/lib/python3.8/contextlib.py", line 131, in __exit__
    self.gen.throw(type, value, traceback)
  File "/usr/local/lib/python3.8/dist-packages/dbt/adapters/snowflake/connections.py", line 223, in exception_handler
    raise DatabaseException(msg)
dbt.exceptions.DatabaseException: Database Error
  001003 (42000): SQL compilation error:
  syntax error line 6 at position 12 unexpected ')'.
2022-07-01 10:04:36.174017 (Thread-1): Got exception RPCException(10003, Database Error, {'type': 'DatabaseException', 'message': "Database Error in rpc request (from remote system)\n  001003 (42000): SQL compilation error:\n  syntax error line 6 at position 12 unexpected ')'.", 'raw_sql': "with cte_gender as \n(select user_id, gender from \n(select user_id, properties_gender as gender, row_number() over(partition by user_id order by timestamp desc) as rn from \n{{ source('ecommerce', 'identifies') }} where timestamp >= '{{ var('start_date') }}' and timestamp <= '{{ var('end_date') }}'\nand properties_gender is not null and properties_gender != '') where rn = 1),\ncte_age as ()\nselect coalesce(a.user_id, b.user_id) as user_id, gender, age from cte_gender a full outer join cte_age b on a.user_id = b.user_id\nlimit 500\n/* limit added automatically by dbt cloud */", 'compiled_sql': "with cte_gender as \n(select user_id, gender from \n(select user_id, properties_gender as gender, row_number() over(partition by user_id order by timestamp desc) as rn from \nanalytics_db.data_apps_simulated.identifies where timestamp >= '2021-06-01' and timestamp <= '2022-06-29'\nand properties_gender is not null and properties_gender != '') where rn = 1),\ncte_age as ()\nselect coalesce(a.user_id, b.user_id) as user_id, gender, age from cte_gender a full outer join cte_age b on a.user_id = b.user_id\nlimit 500\n/* limit added automatically by dbt cloud */", 'tags': None}, None)
Traceback (most recent call last):
  File "/usr/local/lib/python3.8/dist-packages/dbt_rpc/task/sql_commands.py", line 147, in _in_thread
    self.node_results.append(runner.safe_run(self.manifest))
  File "/usr/local/lib/python3.8/dist-packages/dbt/task/base.py", line 377, in safe_run
    result = self.error_result(ctx.node, error, started, [])
  File "/usr/local/lib/python3.8/dist-packages/dbt_rpc/rpc/node_runners.py", line 56, in error_result
    raise error
dbt_rpc.rpc.error.RPCException: RPCException(10003, Database Error, {'type': 'DatabaseException', 'message': "Database Error in rpc request (from remote system)\n  001003 (42000): SQL compilation error:\n  syntax error line 6 at position 12 unexpected ')'.", 'raw_sql': "with cte_gender as \n(select user_id, gender from \n(select user_id, properties_gender as gender, row_number() over(partition by user_id order by timestamp desc) as rn from \n{{ source('ecommerce', 'identifies') }} where timestamp >= '{{ var('start_date') }}' and timestamp <= '{{ var('end_date') }}'\nand properties_gender is not null and properties_gender != '') where rn = 1),\ncte_age as ()\nselect coalesce(a.user_id, b.user_id) as user_id, gender, age from cte_gender a full outer join cte_age b on a.user_id = b.user_id\nlimit 500\n/* limit added automatically by dbt cloud */", 'compiled_sql': "with cte_gender as \n(select user_id, gender from \n(select user_id, properties_gender as gender, row_number() over(partition by user_id order by timestamp desc) as rn from \nanalytics_db.data_apps_simulated.identifies where timestamp >= '2021-06-01' and timestamp <= '2022-06-29'\nand properties_gender is not null and properties_gender != '') where rn = 1),\ncte_age as ()\nselect coalesce(a.user_id, b.user_id) as user_id, gender, age from cte_gender a full outer join cte_age b on a.user_id = b.user_id\nlimit 500\n/* limit added automatically by dbt cloud */", 'tags': None}, None)
2022-07-01 10:04:37.079077 (Thread-52): handling poll request
2022-07-01 10:04:37.079507 (Thread-52): 10:04:37  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'f48b5fd9-b5fc-4510-bbcd-b59df21410e2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f73a859aca0>]}
2022-07-01 10:04:37.080097 (Thread-52): sending response (<Response 13362 bytes [200 OK]>) to 10.0.18.132
2022-07-01 10:05:33.391453 (Thread-53): handling status request
2022-07-01 10:05:33.391860 (Thread-53): 10:05:33  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'f48b5fd9-b5fc-4510-bbcd-b59df21410e2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f73a85a91c0>]}
2022-07-01 10:05:33.392362 (Thread-53): sending response (<Response 1692 bytes [200 OK]>) to 10.0.18.132
2022-07-01 10:05:33.770278 (Thread-54): handling compile_sql request
2022-07-01 10:05:33.770600 (Thread-54): 10:05:33  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'f48b5fd9-b5fc-4510-bbcd-b59df21410e2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f73a85a93a0>]}
2022-07-01 10:05:36.071565 (Thread-54): sending response (<Response 139 bytes [200 OK]>) to 10.0.18.132
2022-07-01 10:05:36.099314 (MainThread): 10:05:36  Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'ada635a3-1dfe-4ceb-afae-1dc3103e78bd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1db99c1940>]}
2022-07-01 10:05:36.099815 (MainThread): 10:05:36  Found 5 models, 0 tests, 0 snapshots, 0 analyses, 179 macros, 0 operations, 0 seed files, 15 sources, 0 exposures, 0 metrics
2022-07-01 10:05:36.100412 (Thread-1): 10:05:36  Acquiring new snowflake connection "rpc.ecommerce_data_model_dbt.request"
2022-07-01 10:05:36.100546 (Thread-1): 10:05:36  Began compiling node rpc.ecommerce_data_model_dbt.request
2022-07-01 10:05:36.100645 (Thread-1): 10:05:36  Compiling rpc.ecommerce_data_model_dbt.request
2022-07-01 10:05:36.103135 (Thread-1): 10:05:36  finished collecting timing info
2022-07-01 10:05:36.103263 (Thread-1): 10:05:36  Began executing node rpc.ecommerce_data_model_dbt.request
2022-07-01 10:05:36.103362 (Thread-1): 10:05:36  finished collecting timing info
2022-07-01 10:05:36.457488 (Thread-55): handling poll request
2022-07-01 10:05:36.457953 (Thread-55): 10:05:36  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'f48b5fd9-b5fc-4510-bbcd-b59df21410e2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f73a85a9c40>]}
2022-07-01 10:05:36.459025 (Thread-55): sending response (<Response 7321 bytes [200 OK]>) to 10.0.18.132
2022-07-01 10:05:47.916651 (Thread-56): handling status request
2022-07-01 10:05:47.917041 (Thread-56): 10:05:47  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'f48b5fd9-b5fc-4510-bbcd-b59df21410e2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f73a85a9e20>]}
2022-07-01 10:05:47.917544 (Thread-56): sending response (<Response 1692 bytes [200 OK]>) to 10.0.18.132
2022-07-01 10:05:48.296008 (Thread-57): handling run_sql request
2022-07-01 10:05:48.296414 (Thread-57): 10:05:48  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'f48b5fd9-b5fc-4510-bbcd-b59df21410e2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f73a85a9f40>]}
2022-07-01 10:05:50.623602 (Thread-57): sending response (<Response 139 bytes [200 OK]>) to 10.0.18.132
2022-07-01 10:05:50.648708 (MainThread): 10:05:50  Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '61f90a67-94a9-458c-814f-6a5492d3af63', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f985e9819d0>]}
2022-07-01 10:05:50.649206 (MainThread): 10:05:50  Found 5 models, 0 tests, 0 snapshots, 0 analyses, 179 macros, 0 operations, 0 seed files, 15 sources, 0 exposures, 0 metrics
2022-07-01 10:05:50.649792 (Thread-1): 10:05:50  Acquiring new snowflake connection "rpc.ecommerce_data_model_dbt.request"
2022-07-01 10:05:50.649926 (Thread-1): 10:05:50  Began compiling node rpc.ecommerce_data_model_dbt.request
2022-07-01 10:05:50.650021 (Thread-1): 10:05:50  Compiling rpc.ecommerce_data_model_dbt.request
2022-07-01 10:05:50.652587 (Thread-1): 10:05:50  finished collecting timing info
2022-07-01 10:05:50.652742 (Thread-1): 10:05:50  Began executing node rpc.ecommerce_data_model_dbt.request
2022-07-01 10:05:50.653709 (Thread-1): 10:05:50  Using snowflake connection "rpc.ecommerce_data_model_dbt.request"
2022-07-01 10:05:50.653816 (Thread-1): 10:05:50  On rpc.ecommerce_data_model_dbt.request: with cte_gender as 
(select user_id, gender from 
(select user_id, properties_gender as gender, row_number() over(partition by user_id order by timestamp desc) as rn from 
analytics_db.data_apps_simulated.identifies where timestamp >= '2021-06-01' and timestamp <= '2022-06-29'
and properties_gender is not null and properties_gender != '' where rn = 1),
cte_age as ()
select coalesce(a.user_id, b.user_id) as user_id, gender, age from cte_gender a full outer join cte_age b on a.user_id = b.user_id
limit 500
/* limit added automatically by dbt cloud */
2022-07-01 10:05:50.653916 (Thread-1): 10:05:50  Opening a new connection, currently in state init
2022-07-01 10:05:50.989713 (Thread-58): handling poll request
2022-07-01 10:05:50.990164 (Thread-58): 10:05:50  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'f48b5fd9-b5fc-4510-bbcd-b59df21410e2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f73a85acf70>]}
2022-07-01 10:05:50.991008 (Thread-58): sending response (<Response 4286 bytes [200 OK]>) to 10.0.18.132
2022-07-01 10:05:51.333899 (Thread-1): 10:05:51  Snowflake adapter: Snowflake query id: 01a5501d-0602-2ead-0019-820304616dc2
2022-07-01 10:05:51.334081 (Thread-1): 10:05:51  Snowflake adapter: Snowflake error: 001003 (42000): SQL compilation error:
syntax error line 5 at position 62 unexpected 'where'.
syntax error line 6 at position 12 unexpected ')'.
2022-07-01 10:05:51.334236 (Thread-1): 10:05:51  finished collecting timing info
2022-07-01 10:05:51.334390 (Thread-1): 10:05:51  On rpc.ecommerce_data_model_dbt.request: Close
2022-07-01 10:05:51.407266 (Thread-1): Got an exception: Database Error
  001003 (42000): SQL compilation error:
  syntax error line 5 at position 62 unexpected 'where'.
  syntax error line 6 at position 12 unexpected ')'.
Traceback (most recent call last):
  File "/usr/local/lib/python3.8/dist-packages/dbt/adapters/snowflake/connections.py", line 206, in exception_handler
    yield
  File "/usr/local/lib/python3.8/dist-packages/dbt/adapters/sql/connections.py", line 74, in add_query
    cursor.execute(sql, bindings)
  File "/usr/local/lib/python3.8/dist-packages/snowflake/connector/cursor.py", line 721, in execute
    Error.errorhandler_wrapper(
  File "/usr/local/lib/python3.8/dist-packages/snowflake/connector/errors.py", line 258, in errorhandler_wrapper
    cursor.errorhandler(connection, cursor, error_class, error_value)
  File "/usr/local/lib/python3.8/dist-packages/snowflake/connector/errors.py", line 188, in default_errorhandler
    raise error_class(
snowflake.connector.errors.ProgrammingError: 001003 (42000): SQL compilation error:
syntax error line 5 at position 62 unexpected 'where'.
syntax error line 6 at position 12 unexpected ')'.

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/usr/local/lib/python3.8/dist-packages/dbt/task/base.py", line 361, in safe_run
    result = self.compile_and_execute(manifest, ctx)
  File "/usr/local/lib/python3.8/dist-packages/dbt/task/base.py", line 314, in compile_and_execute
    result = self.run(ctx.node, manifest)
  File "/usr/local/lib/python3.8/dist-packages/dbt/task/base.py", line 403, in run
    return self.execute(compiled_node, manifest)
  File "/usr/local/lib/python3.8/dist-packages/dbt_rpc/rpc/node_runners.py", line 90, in execute
    _, execute_result = self.adapter.execute(
  File "/usr/local/lib/python3.8/dist-packages/dbt/adapters/base/impl.py", line 225, in execute
    return self.connections.execute(
  File "/usr/local/lib/python3.8/dist-packages/dbt/adapters/sql/connections.py", line 127, in execute
    _, cursor = self.add_query(sql, auto_begin)
  File "/usr/local/lib/python3.8/dist-packages/dbt/adapters/snowflake/connections.py", line 433, in add_query
    connection, cursor = super().add_query(
  File "/usr/local/lib/python3.8/dist-packages/dbt/adapters/sql/connections.py", line 83, in add_query
    return connection, cursor
  File "/usr/lib/python3.8/contextlib.py", line 131, in __exit__
    self.gen.throw(type, value, traceback)
  File "/usr/local/lib/python3.8/dist-packages/dbt/adapters/snowflake/connections.py", line 223, in exception_handler
    raise DatabaseException(msg)
dbt.exceptions.DatabaseException: Database Error
  001003 (42000): SQL compilation error:
  syntax error line 5 at position 62 unexpected 'where'.
  syntax error line 6 at position 12 unexpected ')'.
2022-07-01 10:05:51.408150 (Thread-1): Got exception RPCException(10003, Database Error, {'type': 'DatabaseException', 'message': "Database Error in rpc request (from remote system)\n  001003 (42000): SQL compilation error:\n  syntax error line 5 at position 62 unexpected 'where'.\n  syntax error line 6 at position 12 unexpected ')'.", 'raw_sql': "with cte_gender as \n(select user_id, gender from \n(select user_id, properties_gender as gender, row_number() over(partition by user_id order by timestamp desc) as rn from \n{{ source('ecommerce', 'identifies') }} where timestamp >= '{{ var('start_date') }}' and timestamp <= '{{ var('end_date') }}'\nand properties_gender is not null and properties_gender != '' where rn = 1),\ncte_age as ()\nselect coalesce(a.user_id, b.user_id) as user_id, gender, age from cte_gender a full outer join cte_age b on a.user_id = b.user_id\nlimit 500\n/* limit added automatically by dbt cloud */", 'compiled_sql': "with cte_gender as \n(select user_id, gender from \n(select user_id, properties_gender as gender, row_number() over(partition by user_id order by timestamp desc) as rn from \nanalytics_db.data_apps_simulated.identifies where timestamp >= '2021-06-01' and timestamp <= '2022-06-29'\nand properties_gender is not null and properties_gender != '' where rn = 1),\ncte_age as ()\nselect coalesce(a.user_id, b.user_id) as user_id, gender, age from cte_gender a full outer join cte_age b on a.user_id = b.user_id\nlimit 500\n/* limit added automatically by dbt cloud */", 'tags': None}, None)
Traceback (most recent call last):
  File "/usr/local/lib/python3.8/dist-packages/dbt_rpc/task/sql_commands.py", line 147, in _in_thread
    self.node_results.append(runner.safe_run(self.manifest))
  File "/usr/local/lib/python3.8/dist-packages/dbt/task/base.py", line 377, in safe_run
    result = self.error_result(ctx.node, error, started, [])
  File "/usr/local/lib/python3.8/dist-packages/dbt_rpc/rpc/node_runners.py", line 56, in error_result
    raise error
dbt_rpc.rpc.error.RPCException: RPCException(10003, Database Error, {'type': 'DatabaseException', 'message': "Database Error in rpc request (from remote system)\n  001003 (42000): SQL compilation error:\n  syntax error line 5 at position 62 unexpected 'where'.\n  syntax error line 6 at position 12 unexpected ')'.", 'raw_sql': "with cte_gender as \n(select user_id, gender from \n(select user_id, properties_gender as gender, row_number() over(partition by user_id order by timestamp desc) as rn from \n{{ source('ecommerce', 'identifies') }} where timestamp >= '{{ var('start_date') }}' and timestamp <= '{{ var('end_date') }}'\nand properties_gender is not null and properties_gender != '' where rn = 1),\ncte_age as ()\nselect coalesce(a.user_id, b.user_id) as user_id, gender, age from cte_gender a full outer join cte_age b on a.user_id = b.user_id\nlimit 500\n/* limit added automatically by dbt cloud */", 'compiled_sql': "with cte_gender as \n(select user_id, gender from \n(select user_id, properties_gender as gender, row_number() over(partition by user_id order by timestamp desc) as rn from \nanalytics_db.data_apps_simulated.identifies where timestamp >= '2021-06-01' and timestamp <= '2022-06-29'\nand properties_gender is not null and properties_gender != '' where rn = 1),\ncte_age as ()\nselect coalesce(a.user_id, b.user_id) as user_id, gender, age from cte_gender a full outer join cte_age b on a.user_id = b.user_id\nlimit 500\n/* limit added automatically by dbt cloud */", 'tags': None}, None)
2022-07-01 10:05:52.355656 (Thread-59): handling poll request
2022-07-01 10:05:52.356120 (Thread-59): 10:05:52  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'f48b5fd9-b5fc-4510-bbcd-b59df21410e2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f73a85b62b0>]}
2022-07-01 10:05:52.356808 (Thread-59): sending response (<Response 13759 bytes [200 OK]>) to 10.0.18.132
2022-07-01 10:06:11.062770 (Thread-60): handling status request
2022-07-01 10:06:11.063192 (Thread-60): 10:06:11  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'f48b5fd9-b5fc-4510-bbcd-b59df21410e2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f73a85b69a0>]}
2022-07-01 10:06:11.063707 (Thread-60): sending response (<Response 1692 bytes [200 OK]>) to 10.0.18.132
2022-07-01 10:06:11.431774 (Thread-61): handling run_sql request
2022-07-01 10:06:11.432140 (Thread-61): 10:06:11  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'f48b5fd9-b5fc-4510-bbcd-b59df21410e2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f73a85b6d30>]}
2022-07-01 10:06:13.733789 (Thread-61): sending response (<Response 139 bytes [200 OK]>) to 10.0.18.132
2022-07-01 10:06:13.759030 (MainThread): 10:06:13  Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '97bd1efa-d7c9-4ccf-88ea-2aa491af061d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff48b581ac0>]}
2022-07-01 10:06:13.759520 (MainThread): 10:06:13  Found 5 models, 0 tests, 0 snapshots, 0 analyses, 179 macros, 0 operations, 0 seed files, 15 sources, 0 exposures, 0 metrics
2022-07-01 10:06:13.760094 (Thread-1): 10:06:13  Acquiring new snowflake connection "rpc.ecommerce_data_model_dbt.request"
2022-07-01 10:06:13.760229 (Thread-1): 10:06:13  Began compiling node rpc.ecommerce_data_model_dbt.request
2022-07-01 10:06:13.760339 (Thread-1): 10:06:13  Compiling rpc.ecommerce_data_model_dbt.request
2022-07-01 10:06:13.762928 (Thread-1): 10:06:13  finished collecting timing info
2022-07-01 10:06:13.763057 (Thread-1): 10:06:13  Began executing node rpc.ecommerce_data_model_dbt.request
2022-07-01 10:06:13.763984 (Thread-1): 10:06:13  Using snowflake connection "rpc.ecommerce_data_model_dbt.request"
2022-07-01 10:06:13.764074 (Thread-1): 10:06:13  On rpc.ecommerce_data_model_dbt.request: with cte_gender as 
select user_id, gender from 
(select user_id, properties_gender as gender, row_number() over(partition by user_id order by timestamp desc) as rn from 
analytics_db.data_apps_simulated.identifies where timestamp >= '2021-06-01' and timestamp <= '2022-06-29'
and properties_gender is not null and properties_gender != '') where rn = 1,
cte_age as ()
select coalesce(a.user_id, b.user_id) as user_id, gender, age from cte_gender a full outer join cte_age b on a.user_id = b.user_id
limit 500
/* limit added automatically by dbt cloud */
2022-07-01 10:06:13.764157 (Thread-1): 10:06:13  Opening a new connection, currently in state init
2022-07-01 10:06:14.111611 (Thread-62): handling poll request
2022-07-01 10:06:14.112068 (Thread-62): 10:06:14  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'f48b5fd9-b5fc-4510-bbcd-b59df21410e2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f73a853fbb0>]}
2022-07-01 10:06:14.114207 (Thread-62): sending response (<Response 4285 bytes [200 OK]>) to 10.0.18.132
2022-07-01 10:06:14.485762 (Thread-1): 10:06:14  Snowflake adapter: Snowflake query id: 01a5501e-0602-3016-0019-8203046187a2
2022-07-01 10:06:14.485953 (Thread-1): 10:06:14  Snowflake adapter: Snowflake error: 001003 (42000): SQL compilation error:
syntax error line 2 at position 0 unexpected 'select'.
syntax error line 5 at position 75 unexpected ','.
syntax error line 6 at position 12 unexpected ')'.
2022-07-01 10:06:14.486113 (Thread-1): 10:06:14  finished collecting timing info
2022-07-01 10:06:14.486269 (Thread-1): 10:06:14  On rpc.ecommerce_data_model_dbt.request: Close
2022-07-01 10:06:14.536826 (Thread-1): Got an exception: Database Error
  001003 (42000): SQL compilation error:
  syntax error line 2 at position 0 unexpected 'select'.
  syntax error line 5 at position 75 unexpected ','.
  syntax error line 6 at position 12 unexpected ')'.
Traceback (most recent call last):
  File "/usr/local/lib/python3.8/dist-packages/dbt/adapters/snowflake/connections.py", line 206, in exception_handler
    yield
  File "/usr/local/lib/python3.8/dist-packages/dbt/adapters/sql/connections.py", line 74, in add_query
    cursor.execute(sql, bindings)
  File "/usr/local/lib/python3.8/dist-packages/snowflake/connector/cursor.py", line 721, in execute
    Error.errorhandler_wrapper(
  File "/usr/local/lib/python3.8/dist-packages/snowflake/connector/errors.py", line 258, in errorhandler_wrapper
    cursor.errorhandler(connection, cursor, error_class, error_value)
  File "/usr/local/lib/python3.8/dist-packages/snowflake/connector/errors.py", line 188, in default_errorhandler
    raise error_class(
snowflake.connector.errors.ProgrammingError: 001003 (42000): SQL compilation error:
syntax error line 2 at position 0 unexpected 'select'.
syntax error line 5 at position 75 unexpected ','.
syntax error line 6 at position 12 unexpected ')'.

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/usr/local/lib/python3.8/dist-packages/dbt/task/base.py", line 361, in safe_run
    result = self.compile_and_execute(manifest, ctx)
  File "/usr/local/lib/python3.8/dist-packages/dbt/task/base.py", line 314, in compile_and_execute
    result = self.run(ctx.node, manifest)
  File "/usr/local/lib/python3.8/dist-packages/dbt/task/base.py", line 403, in run
    return self.execute(compiled_node, manifest)
  File "/usr/local/lib/python3.8/dist-packages/dbt_rpc/rpc/node_runners.py", line 90, in execute
    _, execute_result = self.adapter.execute(
  File "/usr/local/lib/python3.8/dist-packages/dbt/adapters/base/impl.py", line 225, in execute
    return self.connections.execute(
  File "/usr/local/lib/python3.8/dist-packages/dbt/adapters/sql/connections.py", line 127, in execute
    _, cursor = self.add_query(sql, auto_begin)
  File "/usr/local/lib/python3.8/dist-packages/dbt/adapters/snowflake/connections.py", line 433, in add_query
    connection, cursor = super().add_query(
  File "/usr/local/lib/python3.8/dist-packages/dbt/adapters/sql/connections.py", line 83, in add_query
    return connection, cursor
  File "/usr/lib/python3.8/contextlib.py", line 131, in __exit__
    self.gen.throw(type, value, traceback)
  File "/usr/local/lib/python3.8/dist-packages/dbt/adapters/snowflake/connections.py", line 223, in exception_handler
    raise DatabaseException(msg)
dbt.exceptions.DatabaseException: Database Error
  001003 (42000): SQL compilation error:
  syntax error line 2 at position 0 unexpected 'select'.
  syntax error line 5 at position 75 unexpected ','.
  syntax error line 6 at position 12 unexpected ')'.
2022-07-01 10:06:14.537655 (Thread-1): Got exception RPCException(10003, Database Error, {'type': 'DatabaseException', 'message': "Database Error in rpc request (from remote system)\n  001003 (42000): SQL compilation error:\n  syntax error line 2 at position 0 unexpected 'select'.\n  syntax error line 5 at position 75 unexpected ','.\n  syntax error line 6 at position 12 unexpected ')'.", 'raw_sql': "with cte_gender as \nselect user_id, gender from \n(select user_id, properties_gender as gender, row_number() over(partition by user_id order by timestamp desc) as rn from \n{{ source('ecommerce', 'identifies') }} where timestamp >= '{{ var('start_date') }}' and timestamp <= '{{ var('end_date') }}'\nand properties_gender is not null and properties_gender != '') where rn = 1,\ncte_age as ()\nselect coalesce(a.user_id, b.user_id) as user_id, gender, age from cte_gender a full outer join cte_age b on a.user_id = b.user_id\nlimit 500\n/* limit added automatically by dbt cloud */", 'compiled_sql': "with cte_gender as \nselect user_id, gender from \n(select user_id, properties_gender as gender, row_number() over(partition by user_id order by timestamp desc) as rn from \nanalytics_db.data_apps_simulated.identifies where timestamp >= '2021-06-01' and timestamp <= '2022-06-29'\nand properties_gender is not null and properties_gender != '') where rn = 1,\ncte_age as ()\nselect coalesce(a.user_id, b.user_id) as user_id, gender, age from cte_gender a full outer join cte_age b on a.user_id = b.user_id\nlimit 500\n/* limit added automatically by dbt cloud */", 'tags': None}, None)
Traceback (most recent call last):
  File "/usr/local/lib/python3.8/dist-packages/dbt_rpc/task/sql_commands.py", line 147, in _in_thread
    self.node_results.append(runner.safe_run(self.manifest))
  File "/usr/local/lib/python3.8/dist-packages/dbt/task/base.py", line 377, in safe_run
    result = self.error_result(ctx.node, error, started, [])
  File "/usr/local/lib/python3.8/dist-packages/dbt_rpc/rpc/node_runners.py", line 56, in error_result
    raise error
dbt_rpc.rpc.error.RPCException: RPCException(10003, Database Error, {'type': 'DatabaseException', 'message': "Database Error in rpc request (from remote system)\n  001003 (42000): SQL compilation error:\n  syntax error line 2 at position 0 unexpected 'select'.\n  syntax error line 5 at position 75 unexpected ','.\n  syntax error line 6 at position 12 unexpected ')'.", 'raw_sql': "with cte_gender as \nselect user_id, gender from \n(select user_id, properties_gender as gender, row_number() over(partition by user_id order by timestamp desc) as rn from \n{{ source('ecommerce', 'identifies') }} where timestamp >= '{{ var('start_date') }}' and timestamp <= '{{ var('end_date') }}'\nand properties_gender is not null and properties_gender != '') where rn = 1,\ncte_age as ()\nselect coalesce(a.user_id, b.user_id) as user_id, gender, age from cte_gender a full outer join cte_age b on a.user_id = b.user_id\nlimit 500\n/* limit added automatically by dbt cloud */", 'compiled_sql': "with cte_gender as \nselect user_id, gender from \n(select user_id, properties_gender as gender, row_number() over(partition by user_id order by timestamp desc) as rn from \nanalytics_db.data_apps_simulated.identifies where timestamp >= '2021-06-01' and timestamp <= '2022-06-29'\nand properties_gender is not null and properties_gender != '') where rn = 1,\ncte_age as ()\nselect coalesce(a.user_id, b.user_id) as user_id, gender, age from cte_gender a full outer join cte_age b on a.user_id = b.user_id\nlimit 500\n/* limit added automatically by dbt cloud */", 'tags': None}, None)
2022-07-01 10:06:15.483417 (Thread-63): handling poll request
2022-07-01 10:06:15.483814 (Thread-63): 10:06:15  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'f48b5fd9-b5fc-4510-bbcd-b59df21410e2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f73a85ace80>]}
2022-07-01 10:06:15.484463 (Thread-63): sending response (<Response 14128 bytes [200 OK]>) to 10.0.18.132
2022-07-01 10:06:43.385572 (Thread-64): handling status request
2022-07-01 10:06:43.385983 (Thread-64): 10:06:43  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'f48b5fd9-b5fc-4510-bbcd-b59df21410e2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f73a853f7f0>]}
2022-07-01 10:06:43.386512 (Thread-64): sending response (<Response 1692 bytes [200 OK]>) to 10.0.18.132
2022-07-01 10:06:43.756966 (Thread-65): handling run_sql request
2022-07-01 10:06:43.757311 (Thread-65): 10:06:43  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'f48b5fd9-b5fc-4510-bbcd-b59df21410e2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f73a853fa60>]}
2022-07-01 10:06:46.093723 (Thread-65): sending response (<Response 139 bytes [200 OK]>) to 10.0.18.132
2022-07-01 10:06:46.121919 (MainThread): 10:06:46  Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '38bd2960-62b9-41e8-a998-da72b8000194', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f41d5090a30>]}
2022-07-01 10:06:46.122411 (MainThread): 10:06:46  Found 5 models, 0 tests, 0 snapshots, 0 analyses, 179 macros, 0 operations, 0 seed files, 15 sources, 0 exposures, 0 metrics
2022-07-01 10:06:46.122983 (Thread-1): 10:06:46  Acquiring new snowflake connection "rpc.ecommerce_data_model_dbt.request"
2022-07-01 10:06:46.123120 (Thread-1): 10:06:46  Began compiling node rpc.ecommerce_data_model_dbt.request
2022-07-01 10:06:46.123251 (Thread-1): 10:06:46  Compiling rpc.ecommerce_data_model_dbt.request
2022-07-01 10:06:46.125807 (Thread-1): 10:06:46  finished collecting timing info
2022-07-01 10:06:46.125939 (Thread-1): 10:06:46  Began executing node rpc.ecommerce_data_model_dbt.request
2022-07-01 10:06:46.126867 (Thread-1): 10:06:46  Using snowflake connection "rpc.ecommerce_data_model_dbt.request"
2022-07-01 10:06:46.126960 (Thread-1): 10:06:46  On rpc.ecommerce_data_model_dbt.request: with cte_gender as 
(select user_id, gender from 
(select user_id, properties_gender as gender, row_number() over(partition by user_id order by timestamp desc) as rn from 
analytics_db.data_apps_simulated.identifies where timestamp >= '2021-06-01' and timestamp <= '2022-06-29'
and properties_gender is not null and properties_gender != '') where rn = 1),
cte_age as ()
select coalesce(a.user_id, b.user_id) as user_id, gender, age from cte_gender a full outer join cte_age b on a.user_id = b.user_id
limit 500
/* limit added automatically by dbt cloud */
2022-07-01 10:06:46.127042 (Thread-1): 10:06:46  Opening a new connection, currently in state init
2022-07-01 10:06:46.463286 (Thread-66): handling poll request
2022-07-01 10:06:46.463739 (Thread-66): 10:06:46  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'f48b5fd9-b5fc-4510-bbcd-b59df21410e2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f73a8547370>]}
2022-07-01 10:06:46.464592 (Thread-66): sending response (<Response 4287 bytes [200 OK]>) to 10.0.18.132
2022-07-01 10:06:46.746969 (Thread-1): 10:06:46  Snowflake adapter: Snowflake query id: 01a5501e-0602-2e59-0019-820304617a12
2022-07-01 10:06:46.747158 (Thread-1): 10:06:46  Snowflake adapter: Snowflake error: 001003 (42000): SQL compilation error:
syntax error line 6 at position 12 unexpected ')'.
2022-07-01 10:06:46.747319 (Thread-1): 10:06:46  finished collecting timing info
2022-07-01 10:06:46.747474 (Thread-1): 10:06:46  On rpc.ecommerce_data_model_dbt.request: Close
2022-07-01 10:06:46.802723 (Thread-1): Got an exception: Database Error
  001003 (42000): SQL compilation error:
  syntax error line 6 at position 12 unexpected ')'.
Traceback (most recent call last):
  File "/usr/local/lib/python3.8/dist-packages/dbt/adapters/snowflake/connections.py", line 206, in exception_handler
    yield
  File "/usr/local/lib/python3.8/dist-packages/dbt/adapters/sql/connections.py", line 74, in add_query
    cursor.execute(sql, bindings)
  File "/usr/local/lib/python3.8/dist-packages/snowflake/connector/cursor.py", line 721, in execute
    Error.errorhandler_wrapper(
  File "/usr/local/lib/python3.8/dist-packages/snowflake/connector/errors.py", line 258, in errorhandler_wrapper
    cursor.errorhandler(connection, cursor, error_class, error_value)
  File "/usr/local/lib/python3.8/dist-packages/snowflake/connector/errors.py", line 188, in default_errorhandler
    raise error_class(
snowflake.connector.errors.ProgrammingError: 001003 (42000): SQL compilation error:
syntax error line 6 at position 12 unexpected ')'.

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/usr/local/lib/python3.8/dist-packages/dbt/task/base.py", line 361, in safe_run
    result = self.compile_and_execute(manifest, ctx)
  File "/usr/local/lib/python3.8/dist-packages/dbt/task/base.py", line 314, in compile_and_execute
    result = self.run(ctx.node, manifest)
  File "/usr/local/lib/python3.8/dist-packages/dbt/task/base.py", line 403, in run
    return self.execute(compiled_node, manifest)
  File "/usr/local/lib/python3.8/dist-packages/dbt_rpc/rpc/node_runners.py", line 90, in execute
    _, execute_result = self.adapter.execute(
  File "/usr/local/lib/python3.8/dist-packages/dbt/adapters/base/impl.py", line 225, in execute
    return self.connections.execute(
  File "/usr/local/lib/python3.8/dist-packages/dbt/adapters/sql/connections.py", line 127, in execute
    _, cursor = self.add_query(sql, auto_begin)
  File "/usr/local/lib/python3.8/dist-packages/dbt/adapters/snowflake/connections.py", line 433, in add_query
    connection, cursor = super().add_query(
  File "/usr/local/lib/python3.8/dist-packages/dbt/adapters/sql/connections.py", line 83, in add_query
    return connection, cursor
  File "/usr/lib/python3.8/contextlib.py", line 131, in __exit__
    self.gen.throw(type, value, traceback)
  File "/usr/local/lib/python3.8/dist-packages/dbt/adapters/snowflake/connections.py", line 223, in exception_handler
    raise DatabaseException(msg)
dbt.exceptions.DatabaseException: Database Error
  001003 (42000): SQL compilation error:
  syntax error line 6 at position 12 unexpected ')'.
2022-07-01 10:06:46.803544 (Thread-1): Got exception RPCException(10003, Database Error, {'type': 'DatabaseException', 'message': "Database Error in rpc request (from remote system)\n  001003 (42000): SQL compilation error:\n  syntax error line 6 at position 12 unexpected ')'.", 'raw_sql': "with cte_gender as \n(select user_id, gender from \n(select user_id, properties_gender as gender, row_number() over(partition by user_id order by timestamp desc) as rn from \n{{ source('ecommerce', 'identifies') }} where timestamp >= '{{ var('start_date') }}' and timestamp <= '{{ var('end_date') }}'\nand properties_gender is not null and properties_gender != '') where rn = 1),\ncte_age as ()\nselect coalesce(a.user_id, b.user_id) as user_id, gender, age from cte_gender a full outer join cte_age b on a.user_id = b.user_id\nlimit 500\n/* limit added automatically by dbt cloud */", 'compiled_sql': "with cte_gender as \n(select user_id, gender from \n(select user_id, properties_gender as gender, row_number() over(partition by user_id order by timestamp desc) as rn from \nanalytics_db.data_apps_simulated.identifies where timestamp >= '2021-06-01' and timestamp <= '2022-06-29'\nand properties_gender is not null and properties_gender != '') where rn = 1),\ncte_age as ()\nselect coalesce(a.user_id, b.user_id) as user_id, gender, age from cte_gender a full outer join cte_age b on a.user_id = b.user_id\nlimit 500\n/* limit added automatically by dbt cloud */", 'tags': None}, None)
Traceback (most recent call last):
  File "/usr/local/lib/python3.8/dist-packages/dbt_rpc/task/sql_commands.py", line 147, in _in_thread
    self.node_results.append(runner.safe_run(self.manifest))
  File "/usr/local/lib/python3.8/dist-packages/dbt/task/base.py", line 377, in safe_run
    result = self.error_result(ctx.node, error, started, [])
  File "/usr/local/lib/python3.8/dist-packages/dbt_rpc/rpc/node_runners.py", line 56, in error_result
    raise error
dbt_rpc.rpc.error.RPCException: RPCException(10003, Database Error, {'type': 'DatabaseException', 'message': "Database Error in rpc request (from remote system)\n  001003 (42000): SQL compilation error:\n  syntax error line 6 at position 12 unexpected ')'.", 'raw_sql': "with cte_gender as \n(select user_id, gender from \n(select user_id, properties_gender as gender, row_number() over(partition by user_id order by timestamp desc) as rn from \n{{ source('ecommerce', 'identifies') }} where timestamp >= '{{ var('start_date') }}' and timestamp <= '{{ var('end_date') }}'\nand properties_gender is not null and properties_gender != '') where rn = 1),\ncte_age as ()\nselect coalesce(a.user_id, b.user_id) as user_id, gender, age from cte_gender a full outer join cte_age b on a.user_id = b.user_id\nlimit 500\n/* limit added automatically by dbt cloud */", 'compiled_sql': "with cte_gender as \n(select user_id, gender from \n(select user_id, properties_gender as gender, row_number() over(partition by user_id order by timestamp desc) as rn from \nanalytics_db.data_apps_simulated.identifies where timestamp >= '2021-06-01' and timestamp <= '2022-06-29'\nand properties_gender is not null and properties_gender != '') where rn = 1),\ncte_age as ()\nselect coalesce(a.user_id, b.user_id) as user_id, gender, age from cte_gender a full outer join cte_age b on a.user_id = b.user_id\nlimit 500\n/* limit added automatically by dbt cloud */", 'tags': None}, None)
2022-07-01 10:06:47.834945 (Thread-67): handling poll request
2022-07-01 10:06:47.835336 (Thread-67): 10:06:47  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'f48b5fd9-b5fc-4510-bbcd-b59df21410e2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f73a8555070>]}
2022-07-01 10:06:47.835930 (Thread-67): sending response (<Response 13362 bytes [200 OK]>) to 10.0.18.132
2022-07-01 10:07:42.270770 (Thread-68): 10:07:42  Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
2022-07-01 10:07:42.270989 (Thread-68): 10:07:42  Partial parsing enabled, no changes found, skipping parsing
2022-07-01 10:07:42.271451 (Thread-68): 10:07:42  [WARNING]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.ecommerce_data_model_dbt.example

2022-07-01 10:07:42.276674 (Thread-68): 10:07:42  Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'f48b5fd9-b5fc-4510-bbcd-b59df21410e2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f73a84a0f70>]}
2022-07-01 10:07:43.052109 (Thread-69): handling status request
2022-07-01 10:07:43.052552 (Thread-69): 10:07:43  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'f48b5fd9-b5fc-4510-bbcd-b59df21410e2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f73a8566f40>]}
2022-07-01 10:07:43.053057 (Thread-69): sending response (<Response 1692 bytes [200 OK]>) to 10.0.18.132
2022-07-01 10:07:43.081605 (Thread-70): handling status request
2022-07-01 10:07:43.081884 (Thread-70): 10:07:43  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'f48b5fd9-b5fc-4510-bbcd-b59df21410e2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f73a85719a0>]}
2022-07-01 10:07:43.082299 (Thread-70): sending response (<Response 1692 bytes [200 OK]>) to 10.0.18.132
2022-07-01 10:07:59.695623 (Thread-71): 10:07:59  Partial parsing enabled: 0 files deleted, 1 files added, 0 files changed.
2022-07-01 10:07:59.695970 (Thread-71): 10:07:59  Partial parsing: added file: ecommerce_data_model_dbt://models/data_model/user_traits_test.sql
2022-07-01 10:07:59.707142 (Thread-71): 10:07:59  1699: static parser successfully parsed data_model/user_traits_test.sql
2022-07-01 10:07:59.768674 (Thread-71): 10:07:59  [WARNING]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.ecommerce_data_model_dbt.example

2022-07-01 10:07:59.773373 (Thread-71): 10:07:59  Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'f48b5fd9-b5fc-4510-bbcd-b59df21410e2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f73a83f3640>]}
2022-07-01 10:08:00.426427 (Thread-72): handling status request
2022-07-01 10:08:00.426834 (Thread-72): 10:08:00  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'f48b5fd9-b5fc-4510-bbcd-b59df21410e2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f73a849d790>]}
2022-07-01 10:08:00.427341 (Thread-72): sending response (<Response 2039 bytes [200 OK]>) to 10.0.18.132
2022-07-01 10:08:00.461406 (Thread-73): handling status request
2022-07-01 10:08:00.461679 (Thread-73): 10:08:00  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'f48b5fd9-b5fc-4510-bbcd-b59df21410e2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f73a849d5b0>]}
2022-07-01 10:08:00.462063 (Thread-73): sending response (<Response 2039 bytes [200 OK]>) to 10.0.18.132
2022-07-01 10:08:28.618876 (Thread-74): handling status request
2022-07-01 10:08:28.619267 (Thread-74): 10:08:28  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'f48b5fd9-b5fc-4510-bbcd-b59df21410e2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f73a849d4f0>]}
2022-07-01 10:08:28.619758 (Thread-74): sending response (<Response 2039 bytes [200 OK]>) to 10.0.18.132
2022-07-01 10:08:29.001107 (Thread-75): handling compile_sql request
2022-07-01 10:08:29.001511 (Thread-75): 10:08:29  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'f48b5fd9-b5fc-4510-bbcd-b59df21410e2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f73a849d340>]}
2022-07-01 10:08:31.344868 (Thread-75): sending response (<Response 139 bytes [200 OK]>) to 10.0.18.132
2022-07-01 10:08:31.369879 (MainThread): 10:08:31  Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '0b198c8e-1591-4855-98b4-020006930ff9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd7e46b1e20>]}
2022-07-01 10:08:31.370382 (MainThread): 10:08:31  Found 6 models, 0 tests, 0 snapshots, 0 analyses, 179 macros, 0 operations, 0 seed files, 15 sources, 0 exposures, 0 metrics
2022-07-01 10:08:31.370951 (Thread-1): 10:08:31  Acquiring new snowflake connection "rpc.ecommerce_data_model_dbt.request"
2022-07-01 10:08:31.371086 (Thread-1): 10:08:31  Began compiling node rpc.ecommerce_data_model_dbt.request
2022-07-01 10:08:31.371182 (Thread-1): 10:08:31  Compiling rpc.ecommerce_data_model_dbt.request
2022-07-01 10:08:31.373723 (Thread-1): 10:08:31  finished collecting timing info
2022-07-01 10:08:31.373854 (Thread-1): 10:08:31  Began executing node rpc.ecommerce_data_model_dbt.request
2022-07-01 10:08:31.373953 (Thread-1): 10:08:31  finished collecting timing info
2022-07-01 10:08:31.728724 (Thread-76): handling poll request
2022-07-01 10:08:31.729181 (Thread-76): 10:08:31  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'f48b5fd9-b5fc-4510-bbcd-b59df21410e2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f73a84e9730>]}
2022-07-01 10:08:31.730316 (Thread-76): sending response (<Response 6662 bytes [200 OK]>) to 10.0.18.132
2022-07-01 10:09:03.270846 (Thread-77): handling status request
2022-07-01 10:09:03.271332 (Thread-77): 10:09:03  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'f48b5fd9-b5fc-4510-bbcd-b59df21410e2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f73a84e94c0>]}
2022-07-01 10:09:03.271860 (Thread-77): sending response (<Response 2039 bytes [200 OK]>) to 10.0.18.132
2022-07-01 10:09:03.654014 (Thread-78): handling run_sql request
2022-07-01 10:09:03.654469 (Thread-78): 10:09:03  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'f48b5fd9-b5fc-4510-bbcd-b59df21410e2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f73a84927c0>]}
2022-07-01 10:09:05.976871 (Thread-78): sending response (<Response 139 bytes [200 OK]>) to 10.0.18.132
2022-07-01 10:09:06.004548 (MainThread): 10:09:06  Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '13ed54cd-9ef9-4b62-b6e8-99a83c94e837', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcee7741dc0>]}
2022-07-01 10:09:06.005043 (MainThread): 10:09:06  Found 6 models, 0 tests, 0 snapshots, 0 analyses, 179 macros, 0 operations, 0 seed files, 15 sources, 0 exposures, 0 metrics
2022-07-01 10:09:06.005670 (Thread-1): 10:09:06  Acquiring new snowflake connection "rpc.ecommerce_data_model_dbt.request"
2022-07-01 10:09:06.005821 (Thread-1): 10:09:06  Began compiling node rpc.ecommerce_data_model_dbt.request
2022-07-01 10:09:06.005914 (Thread-1): 10:09:06  Compiling rpc.ecommerce_data_model_dbt.request
2022-07-01 10:09:06.008512 (Thread-1): 10:09:06  finished collecting timing info
2022-07-01 10:09:06.008647 (Thread-1): 10:09:06  Began executing node rpc.ecommerce_data_model_dbt.request
2022-07-01 10:09:06.009413 (Thread-1): 10:09:06  Using snowflake connection "rpc.ecommerce_data_model_dbt.request"
2022-07-01 10:09:06.009502 (Thread-1): 10:09:06  On rpc.ecommerce_data_model_dbt.request: select user_id, gender from 
(select user_id, properties_gender as gender, row_number() over(partition by user_id order by timestamp desc) as rn from 
analytics_db.data_apps_simulated.identifies where timestamp >= '2021-06-01' and timestamp <= '2022-06-29'
and properties_gender is not null and properties_gender != '') a where rn = 1
limit 500
/* limit added automatically by dbt cloud */
2022-07-01 10:09:06.009582 (Thread-1): 10:09:06  Opening a new connection, currently in state init
2022-07-01 10:09:06.361743 (Thread-79): handling poll request
2022-07-01 10:09:06.362188 (Thread-79): 10:09:06  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'f48b5fd9-b5fc-4510-bbcd-b59df21410e2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f73a83bdbe0>]}
2022-07-01 10:09:06.363019 (Thread-79): sending response (<Response 4119 bytes [200 OK]>) to 10.0.18.132
2022-07-01 10:09:07.730553 (Thread-80): handling poll request
2022-07-01 10:09:07.730951 (Thread-80): 10:09:07  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'f48b5fd9-b5fc-4510-bbcd-b59df21410e2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f73a83bd7f0>]}
2022-07-01 10:09:07.731444 (Thread-80): sending response (<Response 400 bytes [200 OK]>) to 10.0.18.132
2022-07-01 10:09:08.240934 (Thread-1): 10:09:08  SQL status: SUCCESS 4 in 2.23 seconds
2022-07-01 10:09:08.242386 (Thread-1): 10:09:08  finished collecting timing info
2022-07-01 10:09:08.242571 (Thread-1): 10:09:08  On rpc.ecommerce_data_model_dbt.request: Close
2022-07-01 10:09:09.113078 (Thread-81): handling poll request
2022-07-01 10:09:09.113476 (Thread-81): 10:09:09  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'f48b5fd9-b5fc-4510-bbcd-b59df21410e2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f73a85712b0>]}
2022-07-01 10:09:09.114380 (Thread-81): sending response (<Response 4904 bytes [200 OK]>) to 10.0.18.132
2022-07-01 10:14:13.698387 (Thread-82): 10:14:13  Unable to do partial parsing because a project config has changed
2022-07-01 10:14:13.700945 (Thread-82): 10:14:13  Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': 'f48b5fd9-b5fc-4510-bbcd-b59df21410e2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f73a83bdd00>]}
2022-07-01 10:14:13.785406 (Thread-82): 10:14:13  Parsing macros/adapters.sql
2022-07-01 10:14:13.822850 (Thread-82): 10:14:13  Parsing macros/catalog.sql
2022-07-01 10:14:13.824756 (Thread-82): 10:14:13  Parsing macros/materializations/table.sql
2022-07-01 10:14:13.827784 (Thread-82): 10:14:13  Parsing macros/materializations/seed.sql
2022-07-01 10:14:13.832843 (Thread-82): 10:14:13  Parsing macros/materializations/incremental.sql
2022-07-01 10:14:13.841258 (Thread-82): 10:14:13  Parsing macros/materializations/merge.sql
2022-07-01 10:14:13.844977 (Thread-82): 10:14:13  Parsing macros/materializations/snapshot.sql
2022-07-01 10:14:13.845939 (Thread-82): 10:14:13  Parsing macros/materializations/view.sql
2022-07-01 10:14:13.847263 (Thread-82): 10:14:13  Parsing macros/adapters/metadata.sql
2022-07-01 10:14:13.854158 (Thread-82): 10:14:13  Parsing macros/adapters/columns.sql
2022-07-01 10:14:13.863678 (Thread-82): 10:14:13  Parsing macros/adapters/freshness.sql
2022-07-01 10:14:13.866512 (Thread-82): 10:14:13  Parsing macros/adapters/persist_docs.sql
2022-07-01 10:14:13.870801 (Thread-82): 10:14:13  Parsing macros/adapters/relation.sql
2022-07-01 10:14:13.880080 (Thread-82): 10:14:13  Parsing macros/adapters/schema.sql
2022-07-01 10:14:13.882230 (Thread-82): 10:14:13  Parsing macros/adapters/indexes.sql
2022-07-01 10:14:13.884876 (Thread-82): 10:14:13  Parsing macros/get_custom_name/get_custom_schema.sql
2022-07-01 10:14:13.887282 (Thread-82): 10:14:13  Parsing macros/get_custom_name/get_custom_alias.sql
2022-07-01 10:14:13.888761 (Thread-82): 10:14:13  Parsing macros/get_custom_name/get_custom_database.sql
2022-07-01 10:14:13.890313 (Thread-82): 10:14:13  Parsing macros/etc/datetime.sql
2022-07-01 10:14:13.898396 (Thread-82): 10:14:13  Parsing macros/etc/statement.sql
2022-07-01 10:14:13.902723 (Thread-82): 10:14:13  Parsing macros/generic_test_sql/unique.sql
2022-07-01 10:14:13.903444 (Thread-82): 10:14:13  Parsing macros/generic_test_sql/not_null.sql
2022-07-01 10:14:13.904012 (Thread-82): 10:14:13  Parsing macros/generic_test_sql/accepted_values.sql
2022-07-01 10:14:13.905408 (Thread-82): 10:14:13  Parsing macros/generic_test_sql/relationships.sql
2022-07-01 10:14:13.906312 (Thread-82): 10:14:13  Parsing macros/materializations/configs.sql
2022-07-01 10:14:13.908583 (Thread-82): 10:14:13  Parsing macros/materializations/hooks.sql
2022-07-01 10:14:13.912310 (Thread-82): 10:14:13  Parsing macros/materializations/models/table/table.sql
2022-07-01 10:14:13.919594 (Thread-82): 10:14:13  Parsing macros/materializations/models/table/create_table_as.sql
2022-07-01 10:14:13.922432 (Thread-82): 10:14:13  Parsing macros/materializations/models/view/create_or_replace_view.sql
2022-07-01 10:14:13.925053 (Thread-82): 10:14:13  Parsing macros/materializations/models/view/helpers.sql
2022-07-01 10:14:13.926358 (Thread-82): 10:14:13  Parsing macros/materializations/models/view/create_view_as.sql
2022-07-01 10:14:13.928652 (Thread-82): 10:14:13  Parsing macros/materializations/models/view/view.sql
2022-07-01 10:14:13.935623 (Thread-82): 10:14:13  Parsing macros/materializations/models/incremental/incremental.sql
2022-07-01 10:14:13.945313 (Thread-82): 10:14:13  Parsing macros/materializations/models/incremental/on_schema_change.sql
2022-07-01 10:14:13.960630 (Thread-82): 10:14:13  Parsing macros/materializations/models/incremental/is_incremental.sql
2022-07-01 10:14:13.962140 (Thread-82): 10:14:13  Parsing macros/materializations/models/incremental/merge.sql
2022-07-01 10:14:13.973145 (Thread-82): 10:14:13  Parsing macros/materializations/models/incremental/column_helpers.sql
2022-07-01 10:14:13.977478 (Thread-82): 10:14:13  Parsing macros/materializations/seeds/helpers.sql
2022-07-01 10:14:13.993720 (Thread-82): 10:14:13  Parsing macros/materializations/seeds/seed.sql
2022-07-01 10:14:13.999631 (Thread-82): 10:14:13  Parsing macros/materializations/tests/helpers.sql
2022-07-01 10:14:14.001480 (Thread-82): 10:14:14  Parsing macros/materializations/tests/test.sql
2022-07-01 10:14:14.005918 (Thread-82): 10:14:14  Parsing macros/materializations/tests/where_subquery.sql
2022-07-01 10:14:14.007768 (Thread-82): 10:14:14  Parsing macros/materializations/snapshots/helpers.sql
2022-07-01 10:14:14.019049 (Thread-82): 10:14:14  Parsing macros/materializations/snapshots/strategies.sql
2022-07-01 10:14:14.036089 (Thread-82): 10:14:14  Parsing macros/materializations/snapshots/snapshot_merge.sql
2022-07-01 10:14:14.037813 (Thread-82): 10:14:14  Parsing macros/materializations/snapshots/snapshot.sql
2022-07-01 10:14:14.049329 (Thread-82): 10:14:14  Parsing tests/generic/builtin.sql
2022-07-01 10:14:14.236461 (Thread-82): 10:14:14  1603: static parser failed on data_model/stg_user_traits.sql
2022-07-01 10:14:14.240520 (Thread-82): 10:14:14  1602: parser fallback to jinja rendering on data_model/stg_user_traits.sql
2022-07-01 10:14:14.241564 (Thread-82): 10:14:14  1699: static parser successfully parsed data_model/user_traits_test.sql
2022-07-01 10:14:14.243539 (Thread-82): 10:14:14  1603: static parser failed on data_model/stg_products_viewed.sql
2022-07-01 10:14:14.246609 (Thread-82): 10:14:14  1602: parser fallback to jinja rendering on data_model/stg_products_viewed.sql
2022-07-01 10:14:14.247727 (Thread-82): 10:14:14  1699: static parser successfully parsed data_model/feat_user_features.sql
2022-07-01 10:14:14.249678 (Thread-82): 10:14:14  1699: static parser successfully parsed data_model/stg_user_properties.sql
2022-07-01 10:14:14.251539 (Thread-82): 10:14:14  1699: static parser successfully parsed data_model/stg_tracks.sql
2022-07-01 10:14:14.269484 (Thread-82): 10:14:14  [WARNING]: Did not find matching node for patch with name 'my_first_dbt_model' in the 'models' section of file 'models/data_model/schema.yml'
2022-07-01 10:14:14.298102 (Thread-82): 10:14:14  [WARNING]: Test 'test.ecommerce_data_model_dbt.unique_my_first_dbt_model_id.16e066b321' (models/data_model/schema.yml) depends on a node named 'my_first_dbt_model' which was not found
2022-07-01 10:14:14.298372 (Thread-82): 10:14:14  [WARNING]: Test 'test.ecommerce_data_model_dbt.not_null_my_first_dbt_model_id.5fb22c2710' (models/data_model/schema.yml) depends on a node named 'my_first_dbt_model' which was not found
2022-07-01 10:14:14.348137 (Thread-82): 10:14:14  [WARNING]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.data-apps-ecommerce-template.data_model

2022-07-01 10:14:14.352855 (Thread-82): 10:14:14  Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'f48b5fd9-b5fc-4510-bbcd-b59df21410e2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f73a8462490>]}
2022-07-01 10:14:14.514186 (Thread-83): handling status request
2022-07-01 10:14:14.514538 (Thread-83): 10:14:14  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'f48b5fd9-b5fc-4510-bbcd-b59df21410e2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f73a83bd940>]}
2022-07-01 10:14:14.515383 (Thread-83): sending response (<Response 19192 bytes [200 OK]>) to 10.0.18.132
2022-07-01 10:14:14.572762 (Thread-84): handling status request
2022-07-01 10:14:14.573018 (Thread-84): 10:14:14  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'f48b5fd9-b5fc-4510-bbcd-b59df21410e2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f73a8187a90>]}
2022-07-01 10:14:14.573741 (Thread-84): sending response (<Response 19192 bytes [200 OK]>) to 10.0.18.132
2022-07-01 10:14:17.364475 (Thread-85): 10:14:17  Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
2022-07-01 10:14:17.364923 (Thread-85): 10:14:17  Partial parsing: updated file: ecommerce_data_model_dbt://models/data_model/user_traits_test.sql
2022-07-01 10:14:17.368841 (Thread-85): 10:14:17  1603: static parser failed on data_model/user_traits_test.sql
2022-07-01 10:14:17.372765 (Thread-85): 10:14:17  1602: parser fallback to jinja rendering on data_model/user_traits_test.sql
2022-07-01 10:14:17.406084 (Thread-85): 10:14:17  [WARNING]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.data-apps-ecommerce-template.data_model

2022-07-01 10:14:17.411181 (Thread-85): 10:14:17  Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'f48b5fd9-b5fc-4510-bbcd-b59df21410e2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f73a80ca340>]}
2022-07-01 10:14:18.247995 (Thread-86): handling status request
2022-07-01 10:14:18.248445 (Thread-86): 10:14:18  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'f48b5fd9-b5fc-4510-bbcd-b59df21410e2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f73a80aeeb0>]}
2022-07-01 10:14:18.248963 (Thread-86): sending response (<Response 2354 bytes [200 OK]>) to 10.0.18.132
2022-07-01 10:14:18.325815 (Thread-87): handling status request
2022-07-01 10:14:18.326179 (Thread-87): 10:14:18  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'f48b5fd9-b5fc-4510-bbcd-b59df21410e2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f73a83bd940>]}
2022-07-01 10:14:18.326632 (Thread-87): sending response (<Response 2354 bytes [200 OK]>) to 10.0.18.132
2022-07-01 10:14:21.198750 (Thread-88): handling status request
2022-07-01 10:14:21.199145 (Thread-88): 10:14:21  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'f48b5fd9-b5fc-4510-bbcd-b59df21410e2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f73a80aea30>]}
2022-07-01 10:14:21.199627 (Thread-88): sending response (<Response 2354 bytes [200 OK]>) to 10.0.18.132
2022-07-01 10:14:21.589996 (Thread-89): handling run_sql request
2022-07-01 10:14:21.590365 (Thread-89): 10:14:21  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'f48b5fd9-b5fc-4510-bbcd-b59df21410e2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f73a8462700>]}
2022-07-01 10:14:23.887039 (Thread-89): sending response (<Response 139 bytes [200 OK]>) to 10.0.18.132
2022-07-01 10:14:23.911993 (MainThread): 10:14:23  Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'e5f677a8-ecf9-4f73-928e-635e5f7c4763', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f16743c3e20>]}
2022-07-01 10:14:23.912523 (MainThread): 10:14:23  Found 6 models, 0 tests, 0 snapshots, 0 analyses, 179 macros, 0 operations, 0 seed files, 15 sources, 0 exposures, 0 metrics
2022-07-01 10:14:23.913119 (Thread-1): 10:14:23  Acquiring new snowflake connection "rpc.ecommerce_data_model_dbt.request"
2022-07-01 10:14:23.913253 (Thread-1): 10:14:23  Began compiling node rpc.ecommerce_data_model_dbt.request
2022-07-01 10:14:23.913352 (Thread-1): 10:14:23  Compiling rpc.ecommerce_data_model_dbt.request
2022-07-01 10:14:23.915898 (Thread-1): 10:14:23  finished collecting timing info
2022-07-01 10:14:23.916028 (Thread-1): 10:14:23  Began executing node rpc.ecommerce_data_model_dbt.request
2022-07-01 10:14:23.916838 (Thread-1): 10:14:23  Using snowflake connection "rpc.ecommerce_data_model_dbt.request"
2022-07-01 10:14:23.916930 (Thread-1): 10:14:23  On rpc.ecommerce_data_model_dbt.request: select user_id, gender from 
(select user_id, properties_gender as gender, row_number() over(partition by user_id order by timestamp desc) as rn from 
analytics_db.data_apps_simulated.identifies where timestamp >= '2021-05-01' and timestamp <= '2022-06-29'
and properties_gender is not null and properties_gender != '') a where rn = 1
limit 500
/* limit added automatically by dbt cloud */
2022-07-01 10:14:23.917011 (Thread-1): 10:14:23  Opening a new connection, currently in state init
2022-07-01 10:14:24.278571 (Thread-90): handling poll request
2022-07-01 10:14:24.279026 (Thread-90): 10:14:24  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'f48b5fd9-b5fc-4510-bbcd-b59df21410e2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f73a80ed4f0>]}
2022-07-01 10:14:24.279939 (Thread-90): sending response (<Response 4119 bytes [200 OK]>) to 10.0.18.132
2022-07-01 10:14:25.206736 (Thread-1): 10:14:25  SQL status: SUCCESS 5 in 1.29 seconds
2022-07-01 10:14:25.208139 (Thread-1): 10:14:25  finished collecting timing info
2022-07-01 10:14:25.208317 (Thread-1): 10:14:25  On rpc.ecommerce_data_model_dbt.request: Close
2022-07-01 10:14:25.653889 (Thread-91): handling poll request
2022-07-01 10:14:25.654315 (Thread-91): 10:14:25  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'f48b5fd9-b5fc-4510-bbcd-b59df21410e2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f73a80ed130>]}
2022-07-01 10:14:25.655193 (Thread-91): sending response (<Response 4921 bytes [200 OK]>) to 10.0.18.132
2022-07-01 10:14:31.568337 (Thread-92): 10:14:31  Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
2022-07-01 10:14:31.568570 (Thread-92): 10:14:31  Partial parsing enabled, no changes found, skipping parsing
2022-07-01 10:14:31.569027 (Thread-92): 10:14:31  [WARNING]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.data-apps-ecommerce-template.data_model

2022-07-01 10:14:31.574761 (Thread-92): 10:14:31  Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'f48b5fd9-b5fc-4510-bbcd-b59df21410e2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f73a805e340>]}
2022-07-01 10:14:32.312007 (Thread-93): handling status request
2022-07-01 10:14:32.312485 (Thread-93): 10:14:32  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'f48b5fd9-b5fc-4510-bbcd-b59df21410e2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f73a8558a90>]}
2022-07-01 10:14:32.312989 (Thread-93): sending response (<Response 1699 bytes [200 OK]>) to 10.0.18.132
2022-07-01 10:14:32.563689 (Thread-94): handling status request
2022-07-01 10:14:32.564086 (Thread-94): 10:14:32  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'f48b5fd9-b5fc-4510-bbcd-b59df21410e2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f739038eeb0>]}
2022-07-01 10:14:32.591418 (Thread-94): sending response (<Response 1699 bytes [200 OK]>) to 10.0.18.132
2022-07-01 10:15:08.522715 (Thread-95): handling status request
2022-07-01 10:15:08.523123 (Thread-95): 10:15:08  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'f48b5fd9-b5fc-4510-bbcd-b59df21410e2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f73a80b6940>]}
2022-07-01 10:15:08.523608 (Thread-95): sending response (<Response 1699 bytes [200 OK]>) to 10.0.18.132
2022-07-01 10:15:08.909611 (Thread-96): handling run_sql request
2022-07-01 10:15:08.910030 (Thread-96): 10:15:08  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'f48b5fd9-b5fc-4510-bbcd-b59df21410e2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f73a80b6190>]}
2022-07-01 10:15:11.261762 (Thread-96): sending response (<Response 139 bytes [200 OK]>) to 10.0.18.132
2022-07-01 10:15:11.288637 (MainThread): 10:15:11  Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '785f8539-52e5-46c5-a291-05cb7362836f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3867781c40>]}
2022-07-01 10:15:11.289180 (MainThread): 10:15:11  Found 6 models, 0 tests, 0 snapshots, 0 analyses, 179 macros, 0 operations, 0 seed files, 15 sources, 0 exposures, 0 metrics
2022-07-01 10:15:11.289762 (Thread-1): 10:15:11  Acquiring new snowflake connection "rpc.ecommerce_data_model_dbt.request"
2022-07-01 10:15:11.289890 (Thread-1): 10:15:11  Began compiling node rpc.ecommerce_data_model_dbt.request
2022-07-01 10:15:11.289986 (Thread-1): 10:15:11  Compiling rpc.ecommerce_data_model_dbt.request
2022-07-01 10:15:11.292463 (Thread-1): 10:15:11  finished collecting timing info
2022-07-01 10:15:11.292595 (Thread-1): 10:15:11  Began executing node rpc.ecommerce_data_model_dbt.request
2022-07-01 10:15:11.293326 (Thread-1): 10:15:11  Using snowflake connection "rpc.ecommerce_data_model_dbt.request"
2022-07-01 10:15:11.293426 (Thread-1): 10:15:11  On rpc.ecommerce_data_model_dbt.request: select user_id, properties_gender as gender, row_number() over(partition by user_id order by timestamp desc) as rn from 
analytics_db.data_apps_simulated.identifies where timestamp >= '2021-05-01' and timestamp <= '2022-06-29'
and properties_gender is not null and properties_gender != '')
limit 500
/* limit added automatically by dbt cloud */
2022-07-01 10:15:11.293508 (Thread-1): 10:15:11  Opening a new connection, currently in state init
2022-07-01 10:15:11.647316 (Thread-97): handling poll request
2022-07-01 10:15:11.647803 (Thread-97): 10:15:11  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'f48b5fd9-b5fc-4510-bbcd-b59df21410e2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f739038f3a0>]}
2022-07-01 10:15:11.648766 (Thread-97): sending response (<Response 4073 bytes [200 OK]>) to 10.0.18.132
2022-07-01 10:15:12.103223 (Thread-1): 10:15:12  Snowflake adapter: Snowflake query id: 01a55027-0602-3016-0019-8203046187ea
2022-07-01 10:15:12.103411 (Thread-1): 10:15:12  Snowflake adapter: Snowflake error: 001003 (42000): SQL compilation error:
syntax error line 3 at position 61 unexpected ')'.
2022-07-01 10:15:12.103572 (Thread-1): 10:15:12  finished collecting timing info
2022-07-01 10:15:12.103728 (Thread-1): 10:15:12  On rpc.ecommerce_data_model_dbt.request: Close
2022-07-01 10:15:12.161798 (Thread-1): Got an exception: Database Error
  001003 (42000): SQL compilation error:
  syntax error line 3 at position 61 unexpected ')'.
Traceback (most recent call last):
  File "/usr/local/lib/python3.8/dist-packages/dbt/adapters/snowflake/connections.py", line 206, in exception_handler
    yield
  File "/usr/local/lib/python3.8/dist-packages/dbt/adapters/sql/connections.py", line 74, in add_query
    cursor.execute(sql, bindings)
  File "/usr/local/lib/python3.8/dist-packages/snowflake/connector/cursor.py", line 721, in execute
    Error.errorhandler_wrapper(
  File "/usr/local/lib/python3.8/dist-packages/snowflake/connector/errors.py", line 258, in errorhandler_wrapper
    cursor.errorhandler(connection, cursor, error_class, error_value)
  File "/usr/local/lib/python3.8/dist-packages/snowflake/connector/errors.py", line 188, in default_errorhandler
    raise error_class(
snowflake.connector.errors.ProgrammingError: 001003 (42000): SQL compilation error:
syntax error line 3 at position 61 unexpected ')'.

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/usr/local/lib/python3.8/dist-packages/dbt/task/base.py", line 361, in safe_run
    result = self.compile_and_execute(manifest, ctx)
  File "/usr/local/lib/python3.8/dist-packages/dbt/task/base.py", line 314, in compile_and_execute
    result = self.run(ctx.node, manifest)
  File "/usr/local/lib/python3.8/dist-packages/dbt/task/base.py", line 403, in run
    return self.execute(compiled_node, manifest)
  File "/usr/local/lib/python3.8/dist-packages/dbt_rpc/rpc/node_runners.py", line 90, in execute
    _, execute_result = self.adapter.execute(
  File "/usr/local/lib/python3.8/dist-packages/dbt/adapters/base/impl.py", line 225, in execute
    return self.connections.execute(
  File "/usr/local/lib/python3.8/dist-packages/dbt/adapters/sql/connections.py", line 127, in execute
    _, cursor = self.add_query(sql, auto_begin)
  File "/usr/local/lib/python3.8/dist-packages/dbt/adapters/snowflake/connections.py", line 433, in add_query
    connection, cursor = super().add_query(
  File "/usr/local/lib/python3.8/dist-packages/dbt/adapters/sql/connections.py", line 83, in add_query
    return connection, cursor
  File "/usr/lib/python3.8/contextlib.py", line 131, in __exit__
    self.gen.throw(type, value, traceback)
  File "/usr/local/lib/python3.8/dist-packages/dbt/adapters/snowflake/connections.py", line 223, in exception_handler
    raise DatabaseException(msg)
dbt.exceptions.DatabaseException: Database Error
  001003 (42000): SQL compilation error:
  syntax error line 3 at position 61 unexpected ')'.
2022-07-01 10:15:12.162665 (Thread-1): Got exception RPCException(10003, Database Error, {'type': 'DatabaseException', 'message': "Database Error in rpc request (from remote system)\n  001003 (42000): SQL compilation error:\n  syntax error line 3 at position 61 unexpected ')'.", 'raw_sql': "select user_id, properties_gender as gender, row_number() over(partition by user_id order by timestamp desc) as rn from \r\n{{ source('ecommerce', 'identifies') }} where timestamp >= '{{ var('start_date') }}' and timestamp <= '{{ var('end_date') }}'\r\nand properties_gender is not null and properties_gender != '')\nlimit 500\n/* limit added automatically by dbt cloud */", 'compiled_sql': "select user_id, properties_gender as gender, row_number() over(partition by user_id order by timestamp desc) as rn from \nanalytics_db.data_apps_simulated.identifies where timestamp >= '2021-05-01' and timestamp <= '2022-06-29'\nand properties_gender is not null and properties_gender != '')\nlimit 500\n/* limit added automatically by dbt cloud */", 'tags': None}, None)
Traceback (most recent call last):
  File "/usr/local/lib/python3.8/dist-packages/dbt_rpc/task/sql_commands.py", line 147, in _in_thread
    self.node_results.append(runner.safe_run(self.manifest))
  File "/usr/local/lib/python3.8/dist-packages/dbt/task/base.py", line 377, in safe_run
    result = self.error_result(ctx.node, error, started, [])
  File "/usr/local/lib/python3.8/dist-packages/dbt_rpc/rpc/node_runners.py", line 56, in error_result
    raise error
dbt_rpc.rpc.error.RPCException: RPCException(10003, Database Error, {'type': 'DatabaseException', 'message': "Database Error in rpc request (from remote system)\n  001003 (42000): SQL compilation error:\n  syntax error line 3 at position 61 unexpected ')'.", 'raw_sql': "select user_id, properties_gender as gender, row_number() over(partition by user_id order by timestamp desc) as rn from \r\n{{ source('ecommerce', 'identifies') }} where timestamp >= '{{ var('start_date') }}' and timestamp <= '{{ var('end_date') }}'\r\nand properties_gender is not null and properties_gender != '')\nlimit 500\n/* limit added automatically by dbt cloud */", 'compiled_sql': "select user_id, properties_gender as gender, row_number() over(partition by user_id order by timestamp desc) as rn from \nanalytics_db.data_apps_simulated.identifies where timestamp >= '2021-05-01' and timestamp <= '2022-06-29'\nand properties_gender is not null and properties_gender != '')\nlimit 500\n/* limit added automatically by dbt cloud */", 'tags': None}, None)
2022-07-01 10:15:13.044110 (Thread-98): handling poll request
2022-07-01 10:15:13.044520 (Thread-98): 10:15:13  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'f48b5fd9-b5fc-4510-bbcd-b59df21410e2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f739038fdf0>]}
2022-07-01 10:15:13.045159 (Thread-98): sending response (<Response 11858 bytes [200 OK]>) to 10.0.18.132
2022-07-01 10:15:18.508744 (Thread-99): handling status request
2022-07-01 10:15:18.509206 (Thread-99): 10:15:18  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'f48b5fd9-b5fc-4510-bbcd-b59df21410e2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f73a80b06d0>]}
2022-07-01 10:15:18.509752 (Thread-99): sending response (<Response 1699 bytes [200 OK]>) to 10.0.18.132
2022-07-01 10:15:18.883533 (Thread-100): handling run_sql request
2022-07-01 10:15:18.883883 (Thread-100): 10:15:18  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'f48b5fd9-b5fc-4510-bbcd-b59df21410e2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f739038ff70>]}
2022-07-01 10:15:21.224082 (Thread-100): sending response (<Response 139 bytes [200 OK]>) to 10.0.18.132
2022-07-01 10:15:21.249336 (MainThread): 10:15:21  Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'c66b66d8-9b24-4d9c-b16f-e26a918b1090', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f64f249cd90>]}
2022-07-01 10:15:21.249862 (MainThread): 10:15:21  Found 6 models, 0 tests, 0 snapshots, 0 analyses, 179 macros, 0 operations, 0 seed files, 15 sources, 0 exposures, 0 metrics
2022-07-01 10:15:21.250433 (Thread-1): 10:15:21  Acquiring new snowflake connection "rpc.ecommerce_data_model_dbt.request"
2022-07-01 10:15:21.250564 (Thread-1): 10:15:21  Began compiling node rpc.ecommerce_data_model_dbt.request
2022-07-01 10:15:21.250654 (Thread-1): 10:15:21  Compiling rpc.ecommerce_data_model_dbt.request
2022-07-01 10:15:21.253416 (Thread-1): 10:15:21  finished collecting timing info
2022-07-01 10:15:21.253542 (Thread-1): 10:15:21  Began executing node rpc.ecommerce_data_model_dbt.request
2022-07-01 10:15:21.254351 (Thread-1): 10:15:21  Using snowflake connection "rpc.ecommerce_data_model_dbt.request"
2022-07-01 10:15:21.254445 (Thread-1): 10:15:21  On rpc.ecommerce_data_model_dbt.request: select user_id, properties_gender as gender, row_number() over(partition by user_id order by timestamp desc) as rn from 
analytics_db.data_apps_simulated.identifies where timestamp >= '2021-05-01' and timestamp <= '2022-06-29'
and properties_gender is not null and properties_gender != ''
limit 500
/* limit added automatically by dbt cloud */
2022-07-01 10:15:21.254525 (Thread-1): 10:15:21  Opening a new connection, currently in state init
2022-07-01 10:15:21.590991 (Thread-101): handling poll request
2022-07-01 10:15:21.591445 (Thread-101): 10:15:21  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'f48b5fd9-b5fc-4510-bbcd-b59df21410e2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f73a803fac0>]}
2022-07-01 10:15:21.592307 (Thread-101): sending response (<Response 4072 bytes [200 OK]>) to 10.0.18.132
2022-07-01 10:15:22.067634 (Thread-1): 10:15:22  SQL status: SUCCESS 5 in 0.81 seconds
2022-07-01 10:15:22.069164 (Thread-1): 10:15:22  finished collecting timing info
2022-07-01 10:15:22.069356 (Thread-1): 10:15:22  On rpc.ecommerce_data_model_dbt.request: Close
2022-07-01 10:15:22.965367 (Thread-102): handling poll request
2022-07-01 10:15:22.965815 (Thread-102): 10:15:22  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'f48b5fd9-b5fc-4510-bbcd-b59df21410e2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f73a803ac70>]}
2022-07-01 10:15:22.966762 (Thread-102): sending response (<Response 4760 bytes [200 OK]>) to 10.0.18.132
2022-07-01 10:15:34.550689 (Thread-103): handling status request
2022-07-01 10:15:34.551118 (Thread-103): 10:15:34  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'f48b5fd9-b5fc-4510-bbcd-b59df21410e2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f73a803f400>]}
2022-07-01 10:15:34.551633 (Thread-103): sending response (<Response 1699 bytes [200 OK]>) to 10.0.18.132
2022-07-01 10:15:34.921978 (Thread-104): handling run_sql request
2022-07-01 10:15:34.922309 (Thread-104): 10:15:34  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'f48b5fd9-b5fc-4510-bbcd-b59df21410e2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f73a803f1f0>]}
2022-07-01 10:15:37.253475 (MainThread): 10:15:37  Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '0fd4170b-1122-43b9-aa0f-372084503896', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa077e33cd0>]}
2022-07-01 10:15:37.253991 (MainThread): 10:15:37  Found 6 models, 0 tests, 0 snapshots, 0 analyses, 179 macros, 0 operations, 0 seed files, 15 sources, 0 exposures, 0 metrics
2022-07-01 10:15:37.254570 (Thread-1): 10:15:37  Acquiring new snowflake connection "rpc.ecommerce_data_model_dbt.request"
2022-07-01 10:15:37.357146 (Thread-104): sending response (<Response 139 bytes [200 OK]>) to 10.0.18.132
2022-07-01 10:15:37.254706 (Thread-1): 10:15:37  Began compiling node rpc.ecommerce_data_model_dbt.request
2022-07-01 10:15:37.254802 (Thread-1): 10:15:37  Compiling rpc.ecommerce_data_model_dbt.request
2022-07-01 10:15:37.257298 (Thread-1): 10:15:37  finished collecting timing info
2022-07-01 10:15:37.257430 (Thread-1): 10:15:37  Began executing node rpc.ecommerce_data_model_dbt.request
2022-07-01 10:15:37.258210 (Thread-1): 10:15:37  Using snowflake connection "rpc.ecommerce_data_model_dbt.request"
2022-07-01 10:15:37.258301 (Thread-1): 10:15:37  On rpc.ecommerce_data_model_dbt.request: select user_id, gender from 
(select user_id, properties_gender as gender, row_number() over(partition by user_id order by timestamp desc) as rn from 
analytics_db.data_apps_simulated.identifies where timestamp >= '2021-05-01' and timestamp <= '2022-06-29'
and properties_gender is not null and properties_gender != '') a where rn = 1
limit 500
/* limit added automatically by dbt cloud */
2022-07-01 10:15:37.258382 (Thread-1): 10:15:37  Opening a new connection, currently in state init
2022-07-01 10:15:37.747131 (Thread-105): handling poll request
2022-07-01 10:15:37.747551 (Thread-105): 10:15:37  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'f48b5fd9-b5fc-4510-bbcd-b59df21410e2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f73ad7cdb20>]}
2022-07-01 10:15:37.748258 (Thread-105): sending response (<Response 4119 bytes [200 OK]>) to 10.0.18.132
2022-07-01 10:15:38.307233 (Thread-1): 10:15:38  SQL status: SUCCESS 5 in 1.05 seconds
2022-07-01 10:15:38.308644 (Thread-1): 10:15:38  finished collecting timing info
2022-07-01 10:15:38.308828 (Thread-1): 10:15:38  On rpc.ecommerce_data_model_dbt.request: Close
2022-07-01 10:15:39.133306 (Thread-106): handling poll request
2022-07-01 10:15:39.133734 (Thread-106): 10:15:39  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'f48b5fd9-b5fc-4510-bbcd-b59df21410e2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f73ab7913d0>]}
2022-07-01 10:15:39.134507 (Thread-106): sending response (<Response 4921 bytes [200 OK]>) to 10.0.18.132
2022-07-01 10:15:50.269083 (Thread-107): handling status request
2022-07-01 10:15:50.269479 (Thread-107): 10:15:50  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'f48b5fd9-b5fc-4510-bbcd-b59df21410e2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f73ab7915e0>]}
2022-07-01 10:15:50.269990 (Thread-107): sending response (<Response 1699 bytes [200 OK]>) to 10.0.18.132
2022-07-01 10:15:50.645867 (Thread-108): handling run_sql request
2022-07-01 10:15:50.646252 (Thread-108): 10:15:50  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'f48b5fd9-b5fc-4510-bbcd-b59df21410e2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f73ab791730>]}
2022-07-01 10:15:52.985189 (Thread-108): sending response (<Response 139 bytes [200 OK]>) to 10.0.18.132
2022-07-01 10:15:53.010244 (MainThread): 10:15:53  Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '67b68356-902b-4608-8930-fc613255bc27', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8ccf581be0>]}
2022-07-01 10:15:53.010768 (MainThread): 10:15:53  Found 6 models, 0 tests, 0 snapshots, 0 analyses, 179 macros, 0 operations, 0 seed files, 15 sources, 0 exposures, 0 metrics
2022-07-01 10:15:53.011348 (Thread-1): 10:15:53  Acquiring new snowflake connection "rpc.ecommerce_data_model_dbt.request"
2022-07-01 10:15:53.011481 (Thread-1): 10:15:53  Began compiling node rpc.ecommerce_data_model_dbt.request
2022-07-01 10:15:53.011590 (Thread-1): 10:15:53  Compiling rpc.ecommerce_data_model_dbt.request
2022-07-01 10:15:53.014129 (Thread-1): 10:15:53  finished collecting timing info
2022-07-01 10:15:53.014257 (Thread-1): 10:15:53  Began executing node rpc.ecommerce_data_model_dbt.request
2022-07-01 10:15:53.015018 (Thread-1): 10:15:53  Using snowflake connection "rpc.ecommerce_data_model_dbt.request"
2022-07-01 10:15:53.015110 (Thread-1): 10:15:53  On rpc.ecommerce_data_model_dbt.request: select user_id, gender from 
(select user_id, properties_gender as gender, row_number() over(partition by user_id order by timestamp desc) as rn from 
analytics_db.data_apps_simulated.identifies where timestamp >= '2021-05-01' and timestamp <= '2022-06-29'
and properties_gender is not null and properties_gender != '') where rn = 1
limit 500
/* limit added automatically by dbt cloud */
2022-07-01 10:15:53.015193 (Thread-1): 10:15:53  Opening a new connection, currently in state init
2022-07-01 10:15:53.373659 (Thread-109): handling poll request
2022-07-01 10:15:53.374118 (Thread-109): 10:15:53  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'f48b5fd9-b5fc-4510-bbcd-b59df21410e2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f73ab7a1940>]}
2022-07-01 10:15:53.375026 (Thread-109): sending response (<Response 4116 bytes [200 OK]>) to 10.0.18.132
2022-07-01 10:15:54.196326 (Thread-1): 10:15:54  SQL status: SUCCESS 5 in 1.18 seconds
2022-07-01 10:15:54.197831 (Thread-1): 10:15:54  finished collecting timing info
2022-07-01 10:15:54.198008 (Thread-1): 10:15:54  On rpc.ecommerce_data_model_dbt.request: Close
2022-07-01 10:15:54.743921 (Thread-110): handling poll request
2022-07-01 10:15:54.744326 (Thread-110): 10:15:54  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'f48b5fd9-b5fc-4510-bbcd-b59df21410e2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f73d07949d0>]}
2022-07-01 10:15:54.745272 (Thread-110): sending response (<Response 4913 bytes [200 OK]>) to 10.0.18.132
2022-07-01 10:16:23.503674 (Thread-111): 10:16:23  Partial parsing enabled: 1 files deleted, 1 files added, 0 files changed.
2022-07-01 10:16:23.504036 (Thread-111): 10:16:23  Partial parsing: added file: ecommerce_data_model_dbt://models/data_model/user_gender_temp.sql
2022-07-01 10:16:23.504180 (Thread-111): 10:16:23  Partial parsing: deleted file: ecommerce_data_model_dbt://models/data_model/user_traits_test.sql
2022-07-01 10:16:23.508735 (Thread-111): 10:16:23  1603: static parser failed on data_model/user_gender_temp.sql
2022-07-01 10:16:23.512407 (Thread-111): 10:16:23  1602: parser fallback to jinja rendering on data_model/user_gender_temp.sql
2022-07-01 10:16:23.543440 (Thread-111): 10:16:23  [WARNING]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.data-apps-ecommerce-template.data_model

2022-07-01 10:16:23.548238 (Thread-111): 10:16:23  Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'f48b5fd9-b5fc-4510-bbcd-b59df21410e2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f73a84f17f0>]}
2022-07-01 10:16:24.300845 (Thread-112): handling status request
2022-07-01 10:16:24.301279 (Thread-112): 10:16:24  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'f48b5fd9-b5fc-4510-bbcd-b59df21410e2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f73a83f36a0>]}
2022-07-01 10:16:24.301830 (Thread-112): sending response (<Response 2696 bytes [200 OK]>) to 10.0.18.132
2022-07-01 10:16:24.335854 (Thread-113): handling status request
2022-07-01 10:16:24.336134 (Thread-113): 10:16:24  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'f48b5fd9-b5fc-4510-bbcd-b59df21410e2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f73a83f3760>]}
2022-07-01 10:16:24.336608 (Thread-113): sending response (<Response 2696 bytes [200 OK]>) to 10.0.18.132
2022-07-01 10:16:27.356289 (Thread-114): 10:16:27  Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
2022-07-01 10:16:27.356727 (Thread-114): 10:16:27  Partial parsing: updated file: ecommerce_data_model_dbt://models/data_model/user_gender_temp.sql
2022-07-01 10:16:27.360510 (Thread-114): 10:16:27  1603: static parser failed on data_model/user_gender_temp.sql
2022-07-01 10:16:27.364181 (Thread-114): 10:16:27  1602: parser fallback to jinja rendering on data_model/user_gender_temp.sql
2022-07-01 10:16:27.395283 (Thread-114): 10:16:27  [WARNING]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.data-apps-ecommerce-template.data_model

2022-07-01 10:16:27.400213 (Thread-114): 10:16:27  Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'f48b5fd9-b5fc-4510-bbcd-b59df21410e2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f739036c880>]}
2022-07-01 10:16:28.122372 (Thread-115): handling status request
2022-07-01 10:16:28.122817 (Thread-115): 10:16:28  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'f48b5fd9-b5fc-4510-bbcd-b59df21410e2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f73ab7a9190>]}
2022-07-01 10:16:28.123326 (Thread-115): sending response (<Response 2360 bytes [200 OK]>) to 10.0.18.132
2022-07-01 10:16:28.243012 (Thread-116): handling status request
2022-07-01 10:16:28.243427 (Thread-116): 10:16:28  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'f48b5fd9-b5fc-4510-bbcd-b59df21410e2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f739033a880>]}
2022-07-01 10:16:28.243928 (Thread-116): sending response (<Response 2360 bytes [200 OK]>) to 10.0.18.132
2022-07-01 10:18:13.376589 (Thread-117): 10:18:13  Partial parsing enabled: 0 files deleted, 1 files added, 0 files changed.
2022-07-01 10:18:13.377941 (Thread-117): 10:18:13  Partial parsing: added file: ecommerce_data_model_dbt://models/data_model/user_age_temp.sql
2022-07-01 10:18:13.381469 (Thread-117): 10:18:13  1699: static parser successfully parsed data_model/user_age_temp.sql
2022-07-01 10:18:13.418371 (Thread-117): 10:18:13  [WARNING]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.data-apps-ecommerce-template.data_model

2022-07-01 10:18:13.423226 (Thread-117): 10:18:13  Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'f48b5fd9-b5fc-4510-bbcd-b59df21410e2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f739028df70>]}
2022-07-01 10:18:14.202260 (Thread-118): handling status request
2022-07-01 10:18:14.202661 (Thread-118): 10:18:14  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'f48b5fd9-b5fc-4510-bbcd-b59df21410e2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f73a84a0280>]}
2022-07-01 10:18:14.203173 (Thread-118): sending response (<Response 2045 bytes [200 OK]>) to 10.0.18.132
2022-07-01 10:18:14.647272 (Thread-119): handling status request
2022-07-01 10:18:14.647652 (Thread-119): 10:18:14  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'f48b5fd9-b5fc-4510-bbcd-b59df21410e2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f73a84ae1c0>]}
2022-07-01 10:18:14.648133 (Thread-119): sending response (<Response 2045 bytes [200 OK]>) to 10.0.18.132
2022-07-01 10:25:20.961495 (Thread-120): handling status request
2022-07-01 10:25:20.962992 (Thread-120): 10:25:20  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'f48b5fd9-b5fc-4510-bbcd-b59df21410e2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f73a84a5a90>]}
2022-07-01 10:25:20.963480 (Thread-120): sending response (<Response 2045 bytes [200 OK]>) to 10.0.18.132
2022-07-01 10:25:21.325511 (Thread-121): handling compile_sql request
2022-07-01 10:25:21.325916 (Thread-121): 10:25:21  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'f48b5fd9-b5fc-4510-bbcd-b59df21410e2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f73a849d790>]}
2022-07-01 10:25:23.643276 (Thread-121): sending response (<Response 139 bytes [200 OK]>) to 10.0.18.132
2022-07-01 10:25:23.670267 (MainThread): 10:25:23  Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '78e66619-ae51-4f9f-82ee-0b28dc340e82', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f927ba261c0>]}
2022-07-01 10:25:23.670767 (MainThread): 10:25:23  Found 7 models, 0 tests, 0 snapshots, 0 analyses, 179 macros, 0 operations, 0 seed files, 15 sources, 0 exposures, 0 metrics
2022-07-01 10:25:23.671328 (Thread-1): 10:25:23  Acquiring new snowflake connection "rpc.ecommerce_data_model_dbt.request"
2022-07-01 10:25:23.671460 (Thread-1): 10:25:23  Began compiling node rpc.ecommerce_data_model_dbt.request
2022-07-01 10:25:23.671552 (Thread-1): 10:25:23  Compiling rpc.ecommerce_data_model_dbt.request
2022-07-01 10:25:23.674090 (Thread-1): 10:25:23  finished collecting timing info
2022-07-01 10:25:23.674218 (Thread-1): 10:25:23  Began executing node rpc.ecommerce_data_model_dbt.request
2022-07-01 10:25:23.674316 (Thread-1): 10:25:23  finished collecting timing info
2022-07-01 10:25:24.025427 (Thread-122): handling poll request
2022-07-01 10:25:24.025902 (Thread-122): 10:25:24  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'f48b5fd9-b5fc-4510-bbcd-b59df21410e2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f73a85ac070>]}
2022-07-01 10:25:24.027141 (Thread-122): sending response (<Response 7247 bytes [200 OK]>) to 10.0.18.132
2022-07-01 10:25:26.597203 (Thread-123): handling status request
2022-07-01 10:25:26.597612 (Thread-123): 10:25:26  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'f48b5fd9-b5fc-4510-bbcd-b59df21410e2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f73a83bd640>]}
2022-07-01 10:25:26.598172 (Thread-123): sending response (<Response 2045 bytes [200 OK]>) to 10.0.18.132
2022-07-01 10:25:26.996500 (Thread-124): handling run_sql request
2022-07-01 10:25:26.996940 (Thread-124): 10:25:26  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'f48b5fd9-b5fc-4510-bbcd-b59df21410e2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f73a8520bb0>]}
2022-07-01 10:25:29.314503 (Thread-124): sending response (<Response 139 bytes [200 OK]>) to 10.0.18.132
2022-07-01 10:25:29.339540 (MainThread): 10:25:29  Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '5f12d032-52c6-47f3-84dd-63cca689f6fa', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdaa9b08250>]}
2022-07-01 10:25:29.340051 (MainThread): 10:25:29  Found 7 models, 0 tests, 0 snapshots, 0 analyses, 179 macros, 0 operations, 0 seed files, 15 sources, 0 exposures, 0 metrics
2022-07-01 10:25:29.340647 (Thread-1): 10:25:29  Acquiring new snowflake connection "rpc.ecommerce_data_model_dbt.request"
2022-07-01 10:25:29.340778 (Thread-1): 10:25:29  Began compiling node rpc.ecommerce_data_model_dbt.request
2022-07-01 10:25:29.340869 (Thread-1): 10:25:29  Compiling rpc.ecommerce_data_model_dbt.request
2022-07-01 10:25:29.343378 (Thread-1): 10:25:29  finished collecting timing info
2022-07-01 10:25:29.343508 (Thread-1): 10:25:29  Began executing node rpc.ecommerce_data_model_dbt.request
2022-07-01 10:25:29.344435 (Thread-1): 10:25:29  Using snowflake connection "rpc.ecommerce_data_model_dbt.request"
2022-07-01 10:25:29.344532 (Thread-1): 10:25:29  On rpc.ecommerce_data_model_dbt.request: select user_id, age from
(select user_id, 
(CASE WHEN dateadd(year, datediff (year, DOB, getdate()), DOB) > getdate()
      THEN datediff(year, DOB, getdate()) - 1
      ELSE datediff(year, DOB, getdate())
 END) as age, 
row_number() over(partition by user_id order by timestamp desc) as rn 
from analytics_db.data_apps_simulated.identifies where timestamp >= '2021-05-01' and timestamp <= '2022-06-29'
and properties_DOB is not null and properties_DOB!='') 
where rn=1
limit 500
/* limit added automatically by dbt cloud */
2022-07-01 10:25:29.344615 (Thread-1): 10:25:29  Opening a new connection, currently in state init
2022-07-01 10:25:29.703654 (Thread-125): handling poll request
2022-07-01 10:25:29.704155 (Thread-125): 10:25:29  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'f48b5fd9-b5fc-4510-bbcd-b59df21410e2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f73a84f1430>]}
2022-07-01 10:25:29.705102 (Thread-125): sending response (<Response 4256 bytes [200 OK]>) to 10.0.18.132
2022-07-01 10:25:30.031918 (Thread-1): 10:25:30  Snowflake adapter: Snowflake query id: 01a55031-0602-2ead-0019-820304616e5a
2022-07-01 10:25:30.032112 (Thread-1): 10:25:30  Snowflake adapter: Snowflake error: 000904 (42000): SQL compilation error: error line 3 at position 41
invalid identifier 'DOB'
2022-07-01 10:25:30.032283 (Thread-1): 10:25:30  finished collecting timing info
2022-07-01 10:25:30.032471 (Thread-1): 10:25:30  On rpc.ecommerce_data_model_dbt.request: Close
2022-07-01 10:25:30.117903 (Thread-1): Got an exception: Database Error
  000904 (42000): SQL compilation error: error line 3 at position 41
  invalid identifier 'DOB'
Traceback (most recent call last):
  File "/usr/local/lib/python3.8/dist-packages/dbt/adapters/snowflake/connections.py", line 206, in exception_handler
    yield
  File "/usr/local/lib/python3.8/dist-packages/dbt/adapters/sql/connections.py", line 74, in add_query
    cursor.execute(sql, bindings)
  File "/usr/local/lib/python3.8/dist-packages/snowflake/connector/cursor.py", line 721, in execute
    Error.errorhandler_wrapper(
  File "/usr/local/lib/python3.8/dist-packages/snowflake/connector/errors.py", line 258, in errorhandler_wrapper
    cursor.errorhandler(connection, cursor, error_class, error_value)
  File "/usr/local/lib/python3.8/dist-packages/snowflake/connector/errors.py", line 188, in default_errorhandler
    raise error_class(
snowflake.connector.errors.ProgrammingError: 000904 (42000): SQL compilation error: error line 3 at position 41
invalid identifier 'DOB'

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/usr/local/lib/python3.8/dist-packages/dbt/task/base.py", line 361, in safe_run
    result = self.compile_and_execute(manifest, ctx)
  File "/usr/local/lib/python3.8/dist-packages/dbt/task/base.py", line 314, in compile_and_execute
    result = self.run(ctx.node, manifest)
  File "/usr/local/lib/python3.8/dist-packages/dbt/task/base.py", line 403, in run
    return self.execute(compiled_node, manifest)
  File "/usr/local/lib/python3.8/dist-packages/dbt_rpc/rpc/node_runners.py", line 90, in execute
    _, execute_result = self.adapter.execute(
  File "/usr/local/lib/python3.8/dist-packages/dbt/adapters/base/impl.py", line 225, in execute
    return self.connections.execute(
  File "/usr/local/lib/python3.8/dist-packages/dbt/adapters/sql/connections.py", line 127, in execute
    _, cursor = self.add_query(sql, auto_begin)
  File "/usr/local/lib/python3.8/dist-packages/dbt/adapters/snowflake/connections.py", line 433, in add_query
    connection, cursor = super().add_query(
  File "/usr/local/lib/python3.8/dist-packages/dbt/adapters/sql/connections.py", line 83, in add_query
    return connection, cursor
  File "/usr/lib/python3.8/contextlib.py", line 131, in __exit__
    self.gen.throw(type, value, traceback)
  File "/usr/local/lib/python3.8/dist-packages/dbt/adapters/snowflake/connections.py", line 223, in exception_handler
    raise DatabaseException(msg)
dbt.exceptions.DatabaseException: Database Error
  000904 (42000): SQL compilation error: error line 3 at position 41
  invalid identifier 'DOB'
2022-07-01 10:25:30.118773 (Thread-1): Got exception RPCException(10003, Database Error, {'type': 'DatabaseException', 'message': "Database Error in rpc request (from remote system)\n  000904 (42000): SQL compilation error: error line 3 at position 41\n  invalid identifier 'DOB'", 'raw_sql': "select user_id, age from\r\n(select user_id, \r\n(CASE WHEN dateadd(year, datediff (year, DOB, getdate()), DOB) > getdate()\r\n      THEN datediff(year, DOB, getdate()) - 1\r\n      ELSE datediff(year, DOB, getdate())\r\n END) as age, \r\nrow_number() over(partition by user_id order by timestamp desc) as rn \r\nfrom {{ source('ecommerce', 'identifies') }} where timestamp >= '{{ var('start_date') }}' and timestamp <= '{{ var('end_date') }}'\r\nand properties_DOB is not null and properties_DOB!='') \r\nwhere rn=1\nlimit 500\n/* limit added automatically by dbt cloud */", 'compiled_sql': "select user_id, age from\n(select user_id, \n(CASE WHEN dateadd(year, datediff (year, DOB, getdate()), DOB) > getdate()\n      THEN datediff(year, DOB, getdate()) - 1\n      ELSE datediff(year, DOB, getdate())\n END) as age, \nrow_number() over(partition by user_id order by timestamp desc) as rn \nfrom analytics_db.data_apps_simulated.identifies where timestamp >= '2021-05-01' and timestamp <= '2022-06-29'\nand properties_DOB is not null and properties_DOB!='') \nwhere rn=1\nlimit 500\n/* limit added automatically by dbt cloud */", 'tags': None}, None)
Traceback (most recent call last):
  File "/usr/local/lib/python3.8/dist-packages/dbt_rpc/task/sql_commands.py", line 147, in _in_thread
    self.node_results.append(runner.safe_run(self.manifest))
  File "/usr/local/lib/python3.8/dist-packages/dbt/task/base.py", line 377, in safe_run
    result = self.error_result(ctx.node, error, started, [])
  File "/usr/local/lib/python3.8/dist-packages/dbt_rpc/rpc/node_runners.py", line 56, in error_result
    raise error
dbt_rpc.rpc.error.RPCException: RPCException(10003, Database Error, {'type': 'DatabaseException', 'message': "Database Error in rpc request (from remote system)\n  000904 (42000): SQL compilation error: error line 3 at position 41\n  invalid identifier 'DOB'", 'raw_sql': "select user_id, age from\r\n(select user_id, \r\n(CASE WHEN dateadd(year, datediff (year, DOB, getdate()), DOB) > getdate()\r\n      THEN datediff(year, DOB, getdate()) - 1\r\n      ELSE datediff(year, DOB, getdate())\r\n END) as age, \r\nrow_number() over(partition by user_id order by timestamp desc) as rn \r\nfrom {{ source('ecommerce', 'identifies') }} where timestamp >= '{{ var('start_date') }}' and timestamp <= '{{ var('end_date') }}'\r\nand properties_DOB is not null and properties_DOB!='') \r\nwhere rn=1\nlimit 500\n/* limit added automatically by dbt cloud */", 'compiled_sql': "select user_id, age from\n(select user_id, \n(CASE WHEN dateadd(year, datediff (year, DOB, getdate()), DOB) > getdate()\n      THEN datediff(year, DOB, getdate()) - 1\n      ELSE datediff(year, DOB, getdate())\n END) as age, \nrow_number() over(partition by user_id order by timestamp desc) as rn \nfrom analytics_db.data_apps_simulated.identifies where timestamp >= '2021-05-01' and timestamp <= '2022-06-29'\nand properties_DOB is not null and properties_DOB!='') \nwhere rn=1\nlimit 500\n/* limit added automatically by dbt cloud */", 'tags': None}, None)
2022-07-01 10:25:31.070530 (Thread-126): handling poll request
2022-07-01 10:25:31.070923 (Thread-126): 10:25:31  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'f48b5fd9-b5fc-4510-bbcd-b59df21410e2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f73a84f1d90>]}
2022-07-01 10:25:31.071591 (Thread-126): sending response (<Response 13262 bytes [200 OK]>) to 10.0.18.132
2022-07-01 10:26:40.170900 (Thread-127): handling status request
2022-07-01 10:26:40.172268 (Thread-127): 10:26:40  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'f48b5fd9-b5fc-4510-bbcd-b59df21410e2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f73a84f1eb0>]}
2022-07-01 10:26:40.172836 (Thread-127): sending response (<Response 2045 bytes [200 OK]>) to 10.0.18.132
2022-07-01 10:26:40.539066 (Thread-128): handling run_sql request
2022-07-01 10:26:40.539417 (Thread-128): 10:26:40  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'f48b5fd9-b5fc-4510-bbcd-b59df21410e2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f73a84f1c40>]}
2022-07-01 10:26:42.861114 (Thread-128): sending response (<Response 139 bytes [200 OK]>) to 10.0.18.132
2022-07-01 10:26:42.887964 (MainThread): 10:26:42  Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '62177252-434f-4dc2-82dc-4e18a8fc6564', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdf4ab48220>]}
2022-07-01 10:26:42.888507 (MainThread): 10:26:42  Found 7 models, 0 tests, 0 snapshots, 0 analyses, 179 macros, 0 operations, 0 seed files, 15 sources, 0 exposures, 0 metrics
2022-07-01 10:26:42.889085 (Thread-1): 10:26:42  Acquiring new snowflake connection "rpc.ecommerce_data_model_dbt.request"
2022-07-01 10:26:42.889221 (Thread-1): 10:26:42  Began compiling node rpc.ecommerce_data_model_dbt.request
2022-07-01 10:26:42.889316 (Thread-1): 10:26:42  Compiling rpc.ecommerce_data_model_dbt.request
2022-07-01 10:26:42.891857 (Thread-1): 10:26:42  finished collecting timing info
2022-07-01 10:26:42.891989 (Thread-1): 10:26:42  Began executing node rpc.ecommerce_data_model_dbt.request
2022-07-01 10:26:42.893027 (Thread-1): 10:26:42  Using snowflake connection "rpc.ecommerce_data_model_dbt.request"
2022-07-01 10:26:42.893123 (Thread-1): 10:26:42  On rpc.ecommerce_data_model_dbt.request: select user_id, age from
(select user_id, 
(CASE WHEN dateadd(year, datediff (year, properties_birthday, getdate()), properties_birthday) > getdate()
      THEN datediff(year, properties_birthday, getdate()) - 1
      ELSE datediff(year, properties_birthday, getdate())
 END) as age, 
row_number() over(partition by user_id order by timestamp desc) as rn 
from analytics_db.data_apps_simulated.identifies where timestamp >= '2021-05-01' and timestamp <= '2022-06-29'
and properties_DOB is not null and properties_DOB!='') 
where rn=1
limit 500
/* limit added automatically by dbt cloud */
2022-07-01 10:26:42.893205 (Thread-1): 10:26:42  Opening a new connection, currently in state init
2022-07-01 10:26:43.267720 (Thread-129): handling poll request
2022-07-01 10:26:43.268189 (Thread-129): 10:26:43  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'f48b5fd9-b5fc-4510-bbcd-b59df21410e2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f73a84f2190>]}
2022-07-01 10:26:43.269275 (Thread-129): sending response (<Response 4321 bytes [200 OK]>) to 10.0.18.132
2022-07-01 10:26:43.588358 (Thread-1): 10:26:43  Snowflake adapter: Snowflake query id: 01a55032-0602-2e59-0019-820304617a92
2022-07-01 10:26:43.588572 (Thread-1): 10:26:43  Snowflake adapter: Snowflake error: 000904 (42000): SQL compilation error: error line 9 at position 4
invalid identifier 'PROPERTIES_DOB'
2022-07-01 10:26:43.588726 (Thread-1): 10:26:43  finished collecting timing info
2022-07-01 10:26:43.588881 (Thread-1): 10:26:43  On rpc.ecommerce_data_model_dbt.request: Close
2022-07-01 10:26:43.657572 (Thread-1): Got an exception: Database Error
  000904 (42000): SQL compilation error: error line 9 at position 4
  invalid identifier 'PROPERTIES_DOB'
Traceback (most recent call last):
  File "/usr/local/lib/python3.8/dist-packages/dbt/adapters/snowflake/connections.py", line 206, in exception_handler
    yield
  File "/usr/local/lib/python3.8/dist-packages/dbt/adapters/sql/connections.py", line 74, in add_query
    cursor.execute(sql, bindings)
  File "/usr/local/lib/python3.8/dist-packages/snowflake/connector/cursor.py", line 721, in execute
    Error.errorhandler_wrapper(
  File "/usr/local/lib/python3.8/dist-packages/snowflake/connector/errors.py", line 258, in errorhandler_wrapper
    cursor.errorhandler(connection, cursor, error_class, error_value)
  File "/usr/local/lib/python3.8/dist-packages/snowflake/connector/errors.py", line 188, in default_errorhandler
    raise error_class(
snowflake.connector.errors.ProgrammingError: 000904 (42000): SQL compilation error: error line 9 at position 4
invalid identifier 'PROPERTIES_DOB'

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/usr/local/lib/python3.8/dist-packages/dbt/task/base.py", line 361, in safe_run
    result = self.compile_and_execute(manifest, ctx)
  File "/usr/local/lib/python3.8/dist-packages/dbt/task/base.py", line 314, in compile_and_execute
    result = self.run(ctx.node, manifest)
  File "/usr/local/lib/python3.8/dist-packages/dbt/task/base.py", line 403, in run
    return self.execute(compiled_node, manifest)
  File "/usr/local/lib/python3.8/dist-packages/dbt_rpc/rpc/node_runners.py", line 90, in execute
    _, execute_result = self.adapter.execute(
  File "/usr/local/lib/python3.8/dist-packages/dbt/adapters/base/impl.py", line 225, in execute
    return self.connections.execute(
  File "/usr/local/lib/python3.8/dist-packages/dbt/adapters/sql/connections.py", line 127, in execute
    _, cursor = self.add_query(sql, auto_begin)
  File "/usr/local/lib/python3.8/dist-packages/dbt/adapters/snowflake/connections.py", line 433, in add_query
    connection, cursor = super().add_query(
  File "/usr/local/lib/python3.8/dist-packages/dbt/adapters/sql/connections.py", line 83, in add_query
    return connection, cursor
  File "/usr/lib/python3.8/contextlib.py", line 131, in __exit__
    self.gen.throw(type, value, traceback)
  File "/usr/local/lib/python3.8/dist-packages/dbt/adapters/snowflake/connections.py", line 223, in exception_handler
    raise DatabaseException(msg)
dbt.exceptions.DatabaseException: Database Error
  000904 (42000): SQL compilation error: error line 9 at position 4
  invalid identifier 'PROPERTIES_DOB'
2022-07-01 10:26:43.658415 (Thread-1): Got exception RPCException(10003, Database Error, {'type': 'DatabaseException', 'message': "Database Error in rpc request (from remote system)\n  000904 (42000): SQL compilation error: error line 9 at position 4\n  invalid identifier 'PROPERTIES_DOB'", 'raw_sql': "select user_id, age from\r\n(select user_id, \r\n(CASE WHEN dateadd(year, datediff (year, properties_birthday, getdate()), properties_birthday) > getdate()\r\n      THEN datediff(year, properties_birthday, getdate()) - 1\r\n      ELSE datediff(year, properties_birthday, getdate())\r\n END) as age, \r\nrow_number() over(partition by user_id order by timestamp desc) as rn \r\nfrom {{ source('ecommerce', 'identifies') }} where timestamp >= '{{ var('start_date') }}' and timestamp <= '{{ var('end_date') }}'\r\nand properties_DOB is not null and properties_DOB!='') \r\nwhere rn=1\nlimit 500\n/* limit added automatically by dbt cloud */", 'compiled_sql': "select user_id, age from\n(select user_id, \n(CASE WHEN dateadd(year, datediff (year, properties_birthday, getdate()), properties_birthday) > getdate()\n      THEN datediff(year, properties_birthday, getdate()) - 1\n      ELSE datediff(year, properties_birthday, getdate())\n END) as age, \nrow_number() over(partition by user_id order by timestamp desc) as rn \nfrom analytics_db.data_apps_simulated.identifies where timestamp >= '2021-05-01' and timestamp <= '2022-06-29'\nand properties_DOB is not null and properties_DOB!='') \nwhere rn=1\nlimit 500\n/* limit added automatically by dbt cloud */", 'tags': None}, None)
Traceback (most recent call last):
  File "/usr/local/lib/python3.8/dist-packages/dbt_rpc/task/sql_commands.py", line 147, in _in_thread
    self.node_results.append(runner.safe_run(self.manifest))
  File "/usr/local/lib/python3.8/dist-packages/dbt/task/base.py", line 377, in safe_run
    result = self.error_result(ctx.node, error, started, [])
  File "/usr/local/lib/python3.8/dist-packages/dbt_rpc/rpc/node_runners.py", line 56, in error_result
    raise error
dbt_rpc.rpc.error.RPCException: RPCException(10003, Database Error, {'type': 'DatabaseException', 'message': "Database Error in rpc request (from remote system)\n  000904 (42000): SQL compilation error: error line 9 at position 4\n  invalid identifier 'PROPERTIES_DOB'", 'raw_sql': "select user_id, age from\r\n(select user_id, \r\n(CASE WHEN dateadd(year, datediff (year, properties_birthday, getdate()), properties_birthday) > getdate()\r\n      THEN datediff(year, properties_birthday, getdate()) - 1\r\n      ELSE datediff(year, properties_birthday, getdate())\r\n END) as age, \r\nrow_number() over(partition by user_id order by timestamp desc) as rn \r\nfrom {{ source('ecommerce', 'identifies') }} where timestamp >= '{{ var('start_date') }}' and timestamp <= '{{ var('end_date') }}'\r\nand properties_DOB is not null and properties_DOB!='') \r\nwhere rn=1\nlimit 500\n/* limit added automatically by dbt cloud */", 'compiled_sql': "select user_id, age from\n(select user_id, \n(CASE WHEN dateadd(year, datediff (year, properties_birthday, getdate()), properties_birthday) > getdate()\n      THEN datediff(year, properties_birthday, getdate()) - 1\n      ELSE datediff(year, properties_birthday, getdate())\n END) as age, \nrow_number() over(partition by user_id order by timestamp desc) as rn \nfrom analytics_db.data_apps_simulated.identifies where timestamp >= '2021-05-01' and timestamp <= '2022-06-29'\nand properties_DOB is not null and properties_DOB!='') \nwhere rn=1\nlimit 500\n/* limit added automatically by dbt cloud */", 'tags': None}, None)
2022-07-01 10:26:44.652136 (Thread-130): handling poll request
2022-07-01 10:26:44.652562 (Thread-130): 10:26:44  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'f48b5fd9-b5fc-4510-bbcd-b59df21410e2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f73a84f20a0>]}
2022-07-01 10:26:44.653209 (Thread-130): sending response (<Response 13780 bytes [200 OK]>) to 10.0.18.132
2022-07-01 10:26:58.591064 (Thread-131): 10:26:58  Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
2022-07-01 10:26:58.591488 (Thread-131): 10:26:58  Partial parsing: updated file: ecommerce_data_model_dbt://models/data_model/user_age_temp.sql
2022-07-01 10:26:58.595410 (Thread-131): 10:26:58  1603: static parser failed on data_model/user_age_temp.sql
2022-07-01 10:26:58.599604 (Thread-131): 10:26:58  1602: parser fallback to jinja rendering on data_model/user_age_temp.sql
2022-07-01 10:26:58.633451 (Thread-131): 10:26:58  [WARNING]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.data-apps-ecommerce-template.data_model

2022-07-01 10:26:58.638280 (Thread-131): 10:26:58  Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'f48b5fd9-b5fc-4510-bbcd-b59df21410e2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7390207e80>]}
2022-07-01 10:26:59.374422 (Thread-132): handling status request
2022-07-01 10:26:59.374825 (Thread-132): 10:26:59  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'f48b5fd9-b5fc-4510-bbcd-b59df21410e2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f73902687f0>]}
2022-07-01 10:26:59.375344 (Thread-132): sending response (<Response 2351 bytes [200 OK]>) to 10.0.18.132
2022-07-01 10:26:59.433704 (Thread-133): handling status request
2022-07-01 10:26:59.434034 (Thread-133): 10:26:59  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'f48b5fd9-b5fc-4510-bbcd-b59df21410e2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7390268730>]}
2022-07-01 10:26:59.434476 (Thread-133): sending response (<Response 2351 bytes [200 OK]>) to 10.0.18.132
2022-07-01 10:26:59.887603 (Thread-134): handling status request
2022-07-01 10:26:59.888008 (Thread-134): 10:26:59  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'f48b5fd9-b5fc-4510-bbcd-b59df21410e2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7390268eb0>]}
2022-07-01 10:26:59.888541 (Thread-134): sending response (<Response 2351 bytes [200 OK]>) to 10.0.18.132
2022-07-01 10:27:00.252193 (Thread-135): handling run_sql request
2022-07-01 10:27:00.252618 (Thread-135): 10:27:00  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'f48b5fd9-b5fc-4510-bbcd-b59df21410e2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7390268730>]}
2022-07-01 10:27:02.604336 (Thread-135): sending response (<Response 139 bytes [200 OK]>) to 10.0.18.132
2022-07-01 10:27:02.630169 (MainThread): 10:27:02  Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'ef04ea1b-fbc0-454a-9d90-3a1941d71ee4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa2ff90a1c0>]}
2022-07-01 10:27:02.630686 (MainThread): 10:27:02  Found 7 models, 0 tests, 0 snapshots, 0 analyses, 179 macros, 0 operations, 0 seed files, 15 sources, 0 exposures, 0 metrics
2022-07-01 10:27:02.631279 (Thread-1): 10:27:02  Acquiring new snowflake connection "rpc.ecommerce_data_model_dbt.request"
2022-07-01 10:27:02.631415 (Thread-1): 10:27:02  Began compiling node rpc.ecommerce_data_model_dbt.request
2022-07-01 10:27:02.631508 (Thread-1): 10:27:02  Compiling rpc.ecommerce_data_model_dbt.request
2022-07-01 10:27:02.634100 (Thread-1): 10:27:02  finished collecting timing info
2022-07-01 10:27:02.634230 (Thread-1): 10:27:02  Began executing node rpc.ecommerce_data_model_dbt.request
2022-07-01 10:27:02.635220 (Thread-1): 10:27:02  Using snowflake connection "rpc.ecommerce_data_model_dbt.request"
2022-07-01 10:27:02.635311 (Thread-1): 10:27:02  On rpc.ecommerce_data_model_dbt.request: select user_id, age from
(select user_id, 
(CASE WHEN dateadd(year, datediff (year, properties_birthday, getdate()), properties_birthday) > getdate()
      THEN datediff(year, properties_birthday, getdate()) - 1
      ELSE datediff(year, properties_birthday, getdate())
 END) as age, 
row_number() over(partition by user_id order by timestamp desc) as rn 
from analytics_db.data_apps_simulated.identifies where timestamp >= '2021-05-01' and timestamp <= '2022-06-29'
and properties_birthday is not null and properties_birthday!='') 
where rn=1
limit 500
/* limit added automatically by dbt cloud */
2022-07-01 10:27:02.635392 (Thread-1): 10:27:02  Opening a new connection, currently in state init
2022-07-01 10:27:02.986494 (Thread-136): handling poll request
2022-07-01 10:27:02.986987 (Thread-136): 10:27:02  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'f48b5fd9-b5fc-4510-bbcd-b59df21410e2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f739026d4c0>]}
2022-07-01 10:27:02.987948 (Thread-136): sending response (<Response 4331 bytes [200 OK]>) to 10.0.18.132
2022-07-01 10:27:04.383464 (Thread-137): handling poll request
2022-07-01 10:27:04.383863 (Thread-137): 10:27:04  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'f48b5fd9-b5fc-4510-bbcd-b59df21410e2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f739026d130>]}
2022-07-01 10:27:04.384344 (Thread-137): sending response (<Response 397 bytes [200 OK]>) to 10.0.18.132
2022-07-01 10:27:04.390267 (Thread-1): 10:27:04  Snowflake adapter: Snowflake query id: 01a55033-0602-3016-0019-82030461885a
2022-07-01 10:27:04.390464 (Thread-1): 10:27:04  Snowflake adapter: Snowflake error: 100035 (22007): Timestamp '15-03-1982' is not recognized
2022-07-01 10:27:04.390623 (Thread-1): 10:27:04  finished collecting timing info
2022-07-01 10:27:04.390776 (Thread-1): 10:27:04  On rpc.ecommerce_data_model_dbt.request: Close
2022-07-01 10:27:04.452935 (Thread-1): Got an exception: Database Error
  100035 (22007): Timestamp '15-03-1982' is not recognized
Traceback (most recent call last):
  File "/usr/local/lib/python3.8/dist-packages/dbt/adapters/snowflake/connections.py", line 206, in exception_handler
    yield
  File "/usr/local/lib/python3.8/dist-packages/dbt/adapters/sql/connections.py", line 74, in add_query
    cursor.execute(sql, bindings)
  File "/usr/local/lib/python3.8/dist-packages/snowflake/connector/cursor.py", line 721, in execute
    Error.errorhandler_wrapper(
  File "/usr/local/lib/python3.8/dist-packages/snowflake/connector/errors.py", line 258, in errorhandler_wrapper
    cursor.errorhandler(connection, cursor, error_class, error_value)
  File "/usr/local/lib/python3.8/dist-packages/snowflake/connector/errors.py", line 188, in default_errorhandler
    raise error_class(
snowflake.connector.errors.ProgrammingError: 100035 (22007): Timestamp '15-03-1982' is not recognized

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/usr/local/lib/python3.8/dist-packages/dbt/task/base.py", line 361, in safe_run
    result = self.compile_and_execute(manifest, ctx)
  File "/usr/local/lib/python3.8/dist-packages/dbt/task/base.py", line 314, in compile_and_execute
    result = self.run(ctx.node, manifest)
  File "/usr/local/lib/python3.8/dist-packages/dbt/task/base.py", line 403, in run
    return self.execute(compiled_node, manifest)
  File "/usr/local/lib/python3.8/dist-packages/dbt_rpc/rpc/node_runners.py", line 90, in execute
    _, execute_result = self.adapter.execute(
  File "/usr/local/lib/python3.8/dist-packages/dbt/adapters/base/impl.py", line 225, in execute
    return self.connections.execute(
  File "/usr/local/lib/python3.8/dist-packages/dbt/adapters/sql/connections.py", line 127, in execute
    _, cursor = self.add_query(sql, auto_begin)
  File "/usr/local/lib/python3.8/dist-packages/dbt/adapters/snowflake/connections.py", line 433, in add_query
    connection, cursor = super().add_query(
  File "/usr/local/lib/python3.8/dist-packages/dbt/adapters/sql/connections.py", line 83, in add_query
    return connection, cursor
  File "/usr/lib/python3.8/contextlib.py", line 131, in __exit__
    self.gen.throw(type, value, traceback)
  File "/usr/local/lib/python3.8/dist-packages/dbt/adapters/snowflake/connections.py", line 223, in exception_handler
    raise DatabaseException(msg)
dbt.exceptions.DatabaseException: Database Error
  100035 (22007): Timestamp '15-03-1982' is not recognized
2022-07-01 10:27:04.453858 (Thread-1): Got exception RPCException(10003, Database Error, {'type': 'DatabaseException', 'message': "Database Error in rpc request (from remote system)\n  100035 (22007): Timestamp '15-03-1982' is not recognized", 'raw_sql': "select user_id, age from\r\n(select user_id, \r\n(CASE WHEN dateadd(year, datediff (year, properties_birthday, getdate()), properties_birthday) > getdate()\r\n      THEN datediff(year, properties_birthday, getdate()) - 1\r\n      ELSE datediff(year, properties_birthday, getdate())\r\n END) as age, \r\nrow_number() over(partition by user_id order by timestamp desc) as rn \r\nfrom {{ source('ecommerce', 'identifies') }} where timestamp >= '{{ var('start_date') }}' and timestamp <= '{{ var('end_date') }}'\r\nand properties_birthday is not null and properties_birthday!='') \r\nwhere rn=1\nlimit 500\n/* limit added automatically by dbt cloud */", 'compiled_sql': "select user_id, age from\n(select user_id, \n(CASE WHEN dateadd(year, datediff (year, properties_birthday, getdate()), properties_birthday) > getdate()\n      THEN datediff(year, properties_birthday, getdate()) - 1\n      ELSE datediff(year, properties_birthday, getdate())\n END) as age, \nrow_number() over(partition by user_id order by timestamp desc) as rn \nfrom analytics_db.data_apps_simulated.identifies where timestamp >= '2021-05-01' and timestamp <= '2022-06-29'\nand properties_birthday is not null and properties_birthday!='') \nwhere rn=1\nlimit 500\n/* limit added automatically by dbt cloud */", 'tags': None}, None)
Traceback (most recent call last):
  File "/usr/local/lib/python3.8/dist-packages/dbt_rpc/task/sql_commands.py", line 147, in _in_thread
    self.node_results.append(runner.safe_run(self.manifest))
  File "/usr/local/lib/python3.8/dist-packages/dbt/task/base.py", line 377, in safe_run
    result = self.error_result(ctx.node, error, started, [])
  File "/usr/local/lib/python3.8/dist-packages/dbt_rpc/rpc/node_runners.py", line 56, in error_result
    raise error
dbt_rpc.rpc.error.RPCException: RPCException(10003, Database Error, {'type': 'DatabaseException', 'message': "Database Error in rpc request (from remote system)\n  100035 (22007): Timestamp '15-03-1982' is not recognized", 'raw_sql': "select user_id, age from\r\n(select user_id, \r\n(CASE WHEN dateadd(year, datediff (year, properties_birthday, getdate()), properties_birthday) > getdate()\r\n      THEN datediff(year, properties_birthday, getdate()) - 1\r\n      ELSE datediff(year, properties_birthday, getdate())\r\n END) as age, \r\nrow_number() over(partition by user_id order by timestamp desc) as rn \r\nfrom {{ source('ecommerce', 'identifies') }} where timestamp >= '{{ var('start_date') }}' and timestamp <= '{{ var('end_date') }}'\r\nand properties_birthday is not null and properties_birthday!='') \r\nwhere rn=1\nlimit 500\n/* limit added automatically by dbt cloud */", 'compiled_sql': "select user_id, age from\n(select user_id, \n(CASE WHEN dateadd(year, datediff (year, properties_birthday, getdate()), properties_birthday) > getdate()\n      THEN datediff(year, properties_birthday, getdate()) - 1\n      ELSE datediff(year, properties_birthday, getdate())\n END) as age, \nrow_number() over(partition by user_id order by timestamp desc) as rn \nfrom analytics_db.data_apps_simulated.identifies where timestamp >= '2021-05-01' and timestamp <= '2022-06-29'\nand properties_birthday is not null and properties_birthday!='') \nwhere rn=1\nlimit 500\n/* limit added automatically by dbt cloud */", 'tags': None}, None)
2022-07-01 10:27:05.757032 (Thread-138): handling poll request
2022-07-01 10:27:05.757463 (Thread-138): 10:27:05  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'f48b5fd9-b5fc-4510-bbcd-b59df21410e2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f73a84e1460>]}
2022-07-01 10:27:05.758130 (Thread-138): sending response (<Response 13516 bytes [200 OK]>) to 10.0.18.132
2022-07-01 10:30:15.767048 (Thread-139): handling status request
2022-07-01 10:30:15.768755 (Thread-139): 10:30:15  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'f48b5fd9-b5fc-4510-bbcd-b59df21410e2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f73ab7a1d90>]}
2022-07-01 10:30:15.769299 (Thread-139): sending response (<Response 2351 bytes [200 OK]>) to 10.0.18.132
2022-07-01 10:30:16.136435 (Thread-140): handling run_sql request
2022-07-01 10:30:16.136832 (Thread-140): 10:30:16  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'f48b5fd9-b5fc-4510-bbcd-b59df21410e2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f73ab7b0a90>]}
2022-07-01 10:30:18.429619 (Thread-140): sending response (<Response 139 bytes [200 OK]>) to 10.0.18.132
2022-07-01 10:30:18.457058 (MainThread): 10:30:18  Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '32ff1497-77e3-4b17-9701-2396e8d615c2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa3cb6ca190>]}
2022-07-01 10:30:18.457551 (MainThread): 10:30:18  Found 7 models, 0 tests, 0 snapshots, 0 analyses, 179 macros, 0 operations, 0 seed files, 15 sources, 0 exposures, 0 metrics
2022-07-01 10:30:18.458129 (Thread-1): 10:30:18  Acquiring new snowflake connection "rpc.ecommerce_data_model_dbt.request"
2022-07-01 10:30:18.458269 (Thread-1): 10:30:18  Began compiling node rpc.ecommerce_data_model_dbt.request
2022-07-01 10:30:18.458363 (Thread-1): 10:30:18  Compiling rpc.ecommerce_data_model_dbt.request
2022-07-01 10:30:18.460895 (Thread-1): 10:30:18  finished collecting timing info
2022-07-01 10:30:18.461022 (Thread-1): 10:30:18  Began executing node rpc.ecommerce_data_model_dbt.request
2022-07-01 10:30:18.461789 (Thread-1): 10:30:18  Using snowflake connection "rpc.ecommerce_data_model_dbt.request"
2022-07-01 10:30:18.461893 (Thread-1): 10:30:18  On rpc.ecommerce_data_model_dbt.request: select user_id, gender from 
(select user_id, properties_gender as gender, row_number() over(partition by user_id order by timestamp desc) as rn from 
analytics_db.data_apps_simulated.identifies where timestamp >= '2021-05-01' and timestamp <= '2022-06-29'
and properties_gender is not null and properties_gender != '') where rn = 1
limit 500
/* limit added automatically by dbt cloud */
2022-07-01 10:30:18.461975 (Thread-1): 10:30:18  Opening a new connection, currently in state init
2022-07-01 10:30:18.806079 (Thread-141): handling poll request
2022-07-01 10:30:18.806537 (Thread-141): 10:30:18  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'f48b5fd9-b5fc-4510-bbcd-b59df21410e2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7390225160>]}
2022-07-01 10:30:18.807414 (Thread-141): sending response (<Response 4117 bytes [200 OK]>) to 10.0.18.132
2022-07-01 10:30:19.141847 (Thread-1): 10:30:19  SQL status: SUCCESS 5 in 0.68 seconds
2022-07-01 10:30:19.143203 (Thread-1): 10:30:19  finished collecting timing info
2022-07-01 10:30:19.143382 (Thread-1): 10:30:19  On rpc.ecommerce_data_model_dbt.request: Close
2022-07-01 10:30:20.200598 (Thread-142): handling poll request
2022-07-01 10:30:20.201010 (Thread-142): 10:30:20  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'f48b5fd9-b5fc-4510-bbcd-b59df21410e2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f73902257f0>]}
2022-07-01 10:30:20.201952 (Thread-142): sending response (<Response 4913 bytes [200 OK]>) to 10.0.18.132
2022-07-01 10:30:22.704525 (Thread-143): handling status request
2022-07-01 10:30:22.704916 (Thread-143): 10:30:22  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'f48b5fd9-b5fc-4510-bbcd-b59df21410e2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f73902259d0>]}
2022-07-01 10:30:22.705444 (Thread-143): sending response (<Response 2351 bytes [200 OK]>) to 10.0.18.132
2022-07-01 10:30:23.069223 (Thread-144): handling run_sql request
2022-07-01 10:30:23.069577 (Thread-144): 10:30:23  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'f48b5fd9-b5fc-4510-bbcd-b59df21410e2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7390225a90>]}
2022-07-01 10:30:25.382887 (Thread-144): sending response (<Response 139 bytes [200 OK]>) to 10.0.18.132
2022-07-01 10:30:25.408068 (MainThread): 10:30:25  Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '420c18c3-50f0-49b6-9117-ed7af276441a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbb579ca340>]}
2022-07-01 10:30:25.408599 (MainThread): 10:30:25  Found 7 models, 0 tests, 0 snapshots, 0 analyses, 179 macros, 0 operations, 0 seed files, 15 sources, 0 exposures, 0 metrics
2022-07-01 10:30:25.409168 (Thread-1): 10:30:25  Acquiring new snowflake connection "rpc.ecommerce_data_model_dbt.request"
2022-07-01 10:30:25.409297 (Thread-1): 10:30:25  Began compiling node rpc.ecommerce_data_model_dbt.request
2022-07-01 10:30:25.409392 (Thread-1): 10:30:25  Compiling rpc.ecommerce_data_model_dbt.request
2022-07-01 10:30:25.411905 (Thread-1): 10:30:25  finished collecting timing info
2022-07-01 10:30:25.412031 (Thread-1): 10:30:25  Began executing node rpc.ecommerce_data_model_dbt.request
2022-07-01 10:30:25.413038 (Thread-1): 10:30:25  Using snowflake connection "rpc.ecommerce_data_model_dbt.request"
2022-07-01 10:30:25.413128 (Thread-1): 10:30:25  On rpc.ecommerce_data_model_dbt.request: select user_id, age from
(select user_id, 
(CASE WHEN dateadd(year, datediff (year, properties_birthday, getdate()), properties_birthday) > getdate()
      THEN datediff(year, properties_birthday, getdate()) - 1
      ELSE datediff(year, properties_birthday, getdate())
 END) as age, 
row_number() over(partition by user_id order by timestamp desc) as rn 
from analytics_db.data_apps_simulated.identifies where timestamp >= '2021-05-01' and timestamp <= '2022-06-29'
and properties_birthday is not null and properties_birthday!='') 
where rn=1
limit 500
/* limit added automatically by dbt cloud */
2022-07-01 10:30:25.413209 (Thread-1): 10:30:25  Opening a new connection, currently in state init
2022-07-01 10:30:25.751649 (Thread-145): handling poll request
2022-07-01 10:30:25.752116 (Thread-145): 10:30:25  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'f48b5fd9-b5fc-4510-bbcd-b59df21410e2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f73902242b0>]}
2022-07-01 10:30:25.753065 (Thread-145): sending response (<Response 4331 bytes [200 OK]>) to 10.0.18.132
2022-07-01 10:30:26.113621 (Thread-1): 10:30:26  Snowflake adapter: Snowflake query id: 01a55036-0602-2e59-0019-820304617ac6
2022-07-01 10:30:26.113818 (Thread-1): 10:30:26  Snowflake adapter: Snowflake error: 100035 (22007): Timestamp '15-03-1982' is not recognized
2022-07-01 10:30:26.113979 (Thread-1): 10:30:26  finished collecting timing info
2022-07-01 10:30:26.114130 (Thread-1): 10:30:26  On rpc.ecommerce_data_model_dbt.request: Close
2022-07-01 10:30:26.208228 (Thread-1): Got an exception: Database Error
  100035 (22007): Timestamp '15-03-1982' is not recognized
Traceback (most recent call last):
  File "/usr/local/lib/python3.8/dist-packages/dbt/adapters/snowflake/connections.py", line 206, in exception_handler
    yield
  File "/usr/local/lib/python3.8/dist-packages/dbt/adapters/sql/connections.py", line 74, in add_query
    cursor.execute(sql, bindings)
  File "/usr/local/lib/python3.8/dist-packages/snowflake/connector/cursor.py", line 721, in execute
    Error.errorhandler_wrapper(
  File "/usr/local/lib/python3.8/dist-packages/snowflake/connector/errors.py", line 258, in errorhandler_wrapper
    cursor.errorhandler(connection, cursor, error_class, error_value)
  File "/usr/local/lib/python3.8/dist-packages/snowflake/connector/errors.py", line 188, in default_errorhandler
    raise error_class(
snowflake.connector.errors.ProgrammingError: 100035 (22007): Timestamp '15-03-1982' is not recognized

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/usr/local/lib/python3.8/dist-packages/dbt/task/base.py", line 361, in safe_run
    result = self.compile_and_execute(manifest, ctx)
  File "/usr/local/lib/python3.8/dist-packages/dbt/task/base.py", line 314, in compile_and_execute
    result = self.run(ctx.node, manifest)
  File "/usr/local/lib/python3.8/dist-packages/dbt/task/base.py", line 403, in run
    return self.execute(compiled_node, manifest)
  File "/usr/local/lib/python3.8/dist-packages/dbt_rpc/rpc/node_runners.py", line 90, in execute
    _, execute_result = self.adapter.execute(
  File "/usr/local/lib/python3.8/dist-packages/dbt/adapters/base/impl.py", line 225, in execute
    return self.connections.execute(
  File "/usr/local/lib/python3.8/dist-packages/dbt/adapters/sql/connections.py", line 127, in execute
    _, cursor = self.add_query(sql, auto_begin)
  File "/usr/local/lib/python3.8/dist-packages/dbt/adapters/snowflake/connections.py", line 433, in add_query
    connection, cursor = super().add_query(
  File "/usr/local/lib/python3.8/dist-packages/dbt/adapters/sql/connections.py", line 83, in add_query
    return connection, cursor
  File "/usr/lib/python3.8/contextlib.py", line 131, in __exit__
    self.gen.throw(type, value, traceback)
  File "/usr/local/lib/python3.8/dist-packages/dbt/adapters/snowflake/connections.py", line 223, in exception_handler
    raise DatabaseException(msg)
dbt.exceptions.DatabaseException: Database Error
  100035 (22007): Timestamp '15-03-1982' is not recognized
2022-07-01 10:30:26.209104 (Thread-1): Got exception RPCException(10003, Database Error, {'type': 'DatabaseException', 'message': "Database Error in rpc request (from remote system)\n  100035 (22007): Timestamp '15-03-1982' is not recognized", 'raw_sql': "select user_id, age from\r\n(select user_id, \r\n(CASE WHEN dateadd(year, datediff (year, properties_birthday, getdate()), properties_birthday) > getdate()\r\n      THEN datediff(year, properties_birthday, getdate()) - 1\r\n      ELSE datediff(year, properties_birthday, getdate())\r\n END) as age, \r\nrow_number() over(partition by user_id order by timestamp desc) as rn \r\nfrom {{ source('ecommerce', 'identifies') }} where timestamp >= '{{ var('start_date') }}' and timestamp <= '{{ var('end_date') }}'\r\nand properties_birthday is not null and properties_birthday!='') \r\nwhere rn=1\nlimit 500\n/* limit added automatically by dbt cloud */", 'compiled_sql': "select user_id, age from\n(select user_id, \n(CASE WHEN dateadd(year, datediff (year, properties_birthday, getdate()), properties_birthday) > getdate()\n      THEN datediff(year, properties_birthday, getdate()) - 1\n      ELSE datediff(year, properties_birthday, getdate())\n END) as age, \nrow_number() over(partition by user_id order by timestamp desc) as rn \nfrom analytics_db.data_apps_simulated.identifies where timestamp >= '2021-05-01' and timestamp <= '2022-06-29'\nand properties_birthday is not null and properties_birthday!='') \nwhere rn=1\nlimit 500\n/* limit added automatically by dbt cloud */", 'tags': None}, None)
Traceback (most recent call last):
  File "/usr/local/lib/python3.8/dist-packages/dbt_rpc/task/sql_commands.py", line 147, in _in_thread
    self.node_results.append(runner.safe_run(self.manifest))
  File "/usr/local/lib/python3.8/dist-packages/dbt/task/base.py", line 377, in safe_run
    result = self.error_result(ctx.node, error, started, [])
  File "/usr/local/lib/python3.8/dist-packages/dbt_rpc/rpc/node_runners.py", line 56, in error_result
    raise error
dbt_rpc.rpc.error.RPCException: RPCException(10003, Database Error, {'type': 'DatabaseException', 'message': "Database Error in rpc request (from remote system)\n  100035 (22007): Timestamp '15-03-1982' is not recognized", 'raw_sql': "select user_id, age from\r\n(select user_id, \r\n(CASE WHEN dateadd(year, datediff (year, properties_birthday, getdate()), properties_birthday) > getdate()\r\n      THEN datediff(year, properties_birthday, getdate()) - 1\r\n      ELSE datediff(year, properties_birthday, getdate())\r\n END) as age, \r\nrow_number() over(partition by user_id order by timestamp desc) as rn \r\nfrom {{ source('ecommerce', 'identifies') }} where timestamp >= '{{ var('start_date') }}' and timestamp <= '{{ var('end_date') }}'\r\nand properties_birthday is not null and properties_birthday!='') \r\nwhere rn=1\nlimit 500\n/* limit added automatically by dbt cloud */", 'compiled_sql': "select user_id, age from\n(select user_id, \n(CASE WHEN dateadd(year, datediff (year, properties_birthday, getdate()), properties_birthday) > getdate()\n      THEN datediff(year, properties_birthday, getdate()) - 1\n      ELSE datediff(year, properties_birthday, getdate())\n END) as age, \nrow_number() over(partition by user_id order by timestamp desc) as rn \nfrom analytics_db.data_apps_simulated.identifies where timestamp >= '2021-05-01' and timestamp <= '2022-06-29'\nand properties_birthday is not null and properties_birthday!='') \nwhere rn=1\nlimit 500\n/* limit added automatically by dbt cloud */", 'tags': None}, None)
2022-07-01 10:30:27.118614 (Thread-146): handling poll request
2022-07-01 10:30:27.119010 (Thread-146): 10:30:27  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'f48b5fd9-b5fc-4510-bbcd-b59df21410e2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7390215280>]}
2022-07-01 10:30:27.119658 (Thread-146): sending response (<Response 13516 bytes [200 OK]>) to 10.0.18.132
2022-07-01 10:31:00.414198 (Thread-147): handling status request
2022-07-01 10:31:00.414617 (Thread-147): 10:31:00  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'f48b5fd9-b5fc-4510-bbcd-b59df21410e2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f73902156d0>]}
2022-07-01 10:31:00.415164 (Thread-147): sending response (<Response 2351 bytes [200 OK]>) to 10.0.18.132
2022-07-01 10:31:00.807702 (Thread-148): handling compile_sql request
2022-07-01 10:31:00.808107 (Thread-148): 10:31:00  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'f48b5fd9-b5fc-4510-bbcd-b59df21410e2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f73902158b0>]}
2022-07-01 10:31:03.161313 (Thread-148): sending response (<Response 139 bytes [200 OK]>) to 10.0.18.132
2022-07-01 10:31:03.186703 (MainThread): 10:31:03  Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '512349b8-06ce-4d7c-8c47-7cfc51d56e6e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8c90a10160>]}
2022-07-01 10:31:03.187219 (MainThread): 10:31:03  Found 7 models, 0 tests, 0 snapshots, 0 analyses, 179 macros, 0 operations, 0 seed files, 15 sources, 0 exposures, 0 metrics
2022-07-01 10:31:03.187793 (Thread-1): 10:31:03  Acquiring new snowflake connection "rpc.ecommerce_data_model_dbt.request"
2022-07-01 10:31:03.187927 (Thread-1): 10:31:03  Began compiling node rpc.ecommerce_data_model_dbt.request
2022-07-01 10:31:03.188021 (Thread-1): 10:31:03  Compiling rpc.ecommerce_data_model_dbt.request
2022-07-01 10:31:03.190552 (Thread-1): 10:31:03  finished collecting timing info
2022-07-01 10:31:03.190681 (Thread-1): 10:31:03  Began executing node rpc.ecommerce_data_model_dbt.request
2022-07-01 10:31:03.190780 (Thread-1): 10:31:03  finished collecting timing info
2022-07-01 10:31:03.532074 (Thread-149): handling poll request
2022-07-01 10:31:03.532549 (Thread-149): 10:31:03  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'f48b5fd9-b5fc-4510-bbcd-b59df21410e2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7390213a30>]}
2022-07-01 10:31:03.533689 (Thread-149): sending response (<Response 7542 bytes [200 OK]>) to 10.0.18.132
2022-07-01 10:31:19.781161 (Thread-150): handling status request
2022-07-01 10:31:19.781545 (Thread-150): 10:31:19  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'f48b5fd9-b5fc-4510-bbcd-b59df21410e2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7390213c10>]}
2022-07-01 10:31:19.782088 (Thread-150): sending response (<Response 2351 bytes [200 OK]>) to 10.0.18.132
2022-07-01 10:31:20.168140 (Thread-151): handling run_sql request
2022-07-01 10:31:20.168579 (Thread-151): 10:31:20  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'f48b5fd9-b5fc-4510-bbcd-b59df21410e2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7390213cd0>]}
2022-07-01 10:31:22.486721 (Thread-151): sending response (<Response 139 bytes [200 OK]>) to 10.0.18.132
2022-07-01 10:31:22.513991 (MainThread): 10:31:22  Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '4e5a2d37-9984-42a4-bb3f-a1f7ef4eca87', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f080188c160>]}
2022-07-01 10:31:22.514514 (MainThread): 10:31:22  Found 7 models, 0 tests, 0 snapshots, 0 analyses, 179 macros, 0 operations, 0 seed files, 15 sources, 0 exposures, 0 metrics
2022-07-01 10:31:22.515080 (Thread-1): 10:31:22  Acquiring new snowflake connection "rpc.ecommerce_data_model_dbt.request"
2022-07-01 10:31:22.515215 (Thread-1): 10:31:22  Began compiling node rpc.ecommerce_data_model_dbt.request
2022-07-01 10:31:22.515307 (Thread-1): 10:31:22  Compiling rpc.ecommerce_data_model_dbt.request
2022-07-01 10:31:22.517847 (Thread-1): 10:31:22  finished collecting timing info
2022-07-01 10:31:22.517983 (Thread-1): 10:31:22  Began executing node rpc.ecommerce_data_model_dbt.request
2022-07-01 10:31:22.518957 (Thread-1): 10:31:22  Using snowflake connection "rpc.ecommerce_data_model_dbt.request"
2022-07-01 10:31:22.519048 (Thread-1): 10:31:22  On rpc.ecommerce_data_model_dbt.request: select user_id, age from
(select user_id, 
(CASE WHEN dateadd(year, datediff (year, properties_birthday, getdate()), properties_birthday) > getdate()
      THEN datediff(year, properties_birthday, getdate()) - 1
      ELSE datediff(year, properties_birthday, getdate())
 END) as age, 
row_number() over(partition by user_id order by timestamp desc) as rn 
from analytics_db.data_apps_simulated.identifies where timestamp >= '2021-05-01' and timestamp <= '2022-06-29'
and properties_birthday is not null and properties_birthday!='') 
where rn=1
limit 500
/* limit added automatically by dbt cloud */
2022-07-01 10:31:22.519131 (Thread-1): 10:31:22  Opening a new connection, currently in state init
2022-07-01 10:31:22.847918 (Thread-152): handling poll request
2022-07-01 10:31:22.848353 (Thread-152): 10:31:22  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'f48b5fd9-b5fc-4510-bbcd-b59df21410e2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7390206d60>]}
2022-07-01 10:31:22.849293 (Thread-152): sending response (<Response 4331 bytes [200 OK]>) to 10.0.18.132
2022-07-01 10:31:23.618548 (Thread-1): 10:31:23  Snowflake adapter: Snowflake query id: 01a55037-0602-3016-0019-820304618876
2022-07-01 10:31:23.618745 (Thread-1): 10:31:23  Snowflake adapter: Snowflake error: 100035 (22007): Timestamp '15-03-1982' is not recognized
2022-07-01 10:31:23.618905 (Thread-1): 10:31:23  finished collecting timing info
2022-07-01 10:31:23.619063 (Thread-1): 10:31:23  On rpc.ecommerce_data_model_dbt.request: Close
2022-07-01 10:31:23.687633 (Thread-1): Got an exception: Database Error
  100035 (22007): Timestamp '15-03-1982' is not recognized
Traceback (most recent call last):
  File "/usr/local/lib/python3.8/dist-packages/dbt/adapters/snowflake/connections.py", line 206, in exception_handler
    yield
  File "/usr/local/lib/python3.8/dist-packages/dbt/adapters/sql/connections.py", line 74, in add_query
    cursor.execute(sql, bindings)
  File "/usr/local/lib/python3.8/dist-packages/snowflake/connector/cursor.py", line 721, in execute
    Error.errorhandler_wrapper(
  File "/usr/local/lib/python3.8/dist-packages/snowflake/connector/errors.py", line 258, in errorhandler_wrapper
    cursor.errorhandler(connection, cursor, error_class, error_value)
  File "/usr/local/lib/python3.8/dist-packages/snowflake/connector/errors.py", line 188, in default_errorhandler
    raise error_class(
snowflake.connector.errors.ProgrammingError: 100035 (22007): Timestamp '15-03-1982' is not recognized

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/usr/local/lib/python3.8/dist-packages/dbt/task/base.py", line 361, in safe_run
    result = self.compile_and_execute(manifest, ctx)
  File "/usr/local/lib/python3.8/dist-packages/dbt/task/base.py", line 314, in compile_and_execute
    result = self.run(ctx.node, manifest)
  File "/usr/local/lib/python3.8/dist-packages/dbt/task/base.py", line 403, in run
    return self.execute(compiled_node, manifest)
  File "/usr/local/lib/python3.8/dist-packages/dbt_rpc/rpc/node_runners.py", line 90, in execute
    _, execute_result = self.adapter.execute(
  File "/usr/local/lib/python3.8/dist-packages/dbt/adapters/base/impl.py", line 225, in execute
    return self.connections.execute(
  File "/usr/local/lib/python3.8/dist-packages/dbt/adapters/sql/connections.py", line 127, in execute
    _, cursor = self.add_query(sql, auto_begin)
  File "/usr/local/lib/python3.8/dist-packages/dbt/adapters/snowflake/connections.py", line 433, in add_query
    connection, cursor = super().add_query(
  File "/usr/local/lib/python3.8/dist-packages/dbt/adapters/sql/connections.py", line 83, in add_query
    return connection, cursor
  File "/usr/lib/python3.8/contextlib.py", line 131, in __exit__
    self.gen.throw(type, value, traceback)
  File "/usr/local/lib/python3.8/dist-packages/dbt/adapters/snowflake/connections.py", line 223, in exception_handler
    raise DatabaseException(msg)
dbt.exceptions.DatabaseException: Database Error
  100035 (22007): Timestamp '15-03-1982' is not recognized
2022-07-01 10:31:23.688588 (Thread-1): Got exception RPCException(10003, Database Error, {'type': 'DatabaseException', 'message': "Database Error in rpc request (from remote system)\n  100035 (22007): Timestamp '15-03-1982' is not recognized", 'raw_sql': "select user_id, age from\r\n(select user_id, \r\n(CASE WHEN dateadd(year, datediff (year, properties_birthday, getdate()), properties_birthday) > getdate()\r\n      THEN datediff(year, properties_birthday, getdate()) - 1\r\n      ELSE datediff(year, properties_birthday, getdate())\r\n END) as age, \r\nrow_number() over(partition by user_id order by timestamp desc) as rn \r\nfrom {{ source('ecommerce', 'identifies') }} where timestamp >= '{{ var('start_date') }}' and timestamp <= '{{ var('end_date') }}'\r\nand properties_birthday is not null and properties_birthday!='') \r\nwhere rn=1\nlimit 500\n/* limit added automatically by dbt cloud */", 'compiled_sql': "select user_id, age from\n(select user_id, \n(CASE WHEN dateadd(year, datediff (year, properties_birthday, getdate()), properties_birthday) > getdate()\n      THEN datediff(year, properties_birthday, getdate()) - 1\n      ELSE datediff(year, properties_birthday, getdate())\n END) as age, \nrow_number() over(partition by user_id order by timestamp desc) as rn \nfrom analytics_db.data_apps_simulated.identifies where timestamp >= '2021-05-01' and timestamp <= '2022-06-29'\nand properties_birthday is not null and properties_birthday!='') \nwhere rn=1\nlimit 500\n/* limit added automatically by dbt cloud */", 'tags': None}, None)
Traceback (most recent call last):
  File "/usr/local/lib/python3.8/dist-packages/dbt_rpc/task/sql_commands.py", line 147, in _in_thread
    self.node_results.append(runner.safe_run(self.manifest))
  File "/usr/local/lib/python3.8/dist-packages/dbt/task/base.py", line 377, in safe_run
    result = self.error_result(ctx.node, error, started, [])
  File "/usr/local/lib/python3.8/dist-packages/dbt_rpc/rpc/node_runners.py", line 56, in error_result
    raise error
dbt_rpc.rpc.error.RPCException: RPCException(10003, Database Error, {'type': 'DatabaseException', 'message': "Database Error in rpc request (from remote system)\n  100035 (22007): Timestamp '15-03-1982' is not recognized", 'raw_sql': "select user_id, age from\r\n(select user_id, \r\n(CASE WHEN dateadd(year, datediff (year, properties_birthday, getdate()), properties_birthday) > getdate()\r\n      THEN datediff(year, properties_birthday, getdate()) - 1\r\n      ELSE datediff(year, properties_birthday, getdate())\r\n END) as age, \r\nrow_number() over(partition by user_id order by timestamp desc) as rn \r\nfrom {{ source('ecommerce', 'identifies') }} where timestamp >= '{{ var('start_date') }}' and timestamp <= '{{ var('end_date') }}'\r\nand properties_birthday is not null and properties_birthday!='') \r\nwhere rn=1\nlimit 500\n/* limit added automatically by dbt cloud */", 'compiled_sql': "select user_id, age from\n(select user_id, \n(CASE WHEN dateadd(year, datediff (year, properties_birthday, getdate()), properties_birthday) > getdate()\n      THEN datediff(year, properties_birthday, getdate()) - 1\n      ELSE datediff(year, properties_birthday, getdate())\n END) as age, \nrow_number() over(partition by user_id order by timestamp desc) as rn \nfrom analytics_db.data_apps_simulated.identifies where timestamp >= '2021-05-01' and timestamp <= '2022-06-29'\nand properties_birthday is not null and properties_birthday!='') \nwhere rn=1\nlimit 500\n/* limit added automatically by dbt cloud */", 'tags': None}, None)
2022-07-01 10:31:24.225120 (Thread-153): handling poll request
2022-07-01 10:31:24.225566 (Thread-153): 10:31:24  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'f48b5fd9-b5fc-4510-bbcd-b59df21410e2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f739022c0d0>]}
2022-07-01 10:31:24.226237 (Thread-153): sending response (<Response 13516 bytes [200 OK]>) to 10.0.18.132
2022-07-01 11:02:50.819715 (Thread-154): 11:02:50  Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
2022-07-01 11:02:50.820937 (Thread-154): 11:02:50  Partial parsing enabled, no changes found, skipping parsing
2022-07-01 11:02:50.821468 (Thread-154): 11:02:50  [WARNING]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.data-apps-ecommerce-template.data_model

2022-07-01 11:02:50.827204 (Thread-154): 11:02:50  Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'f48b5fd9-b5fc-4510-bbcd-b59df21410e2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f73900f56d0>]}
2022-07-01 11:02:51.644760 (Thread-155): handling status request
2022-07-01 11:02:51.645236 (Thread-155): 11:02:51  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'f48b5fd9-b5fc-4510-bbcd-b59df21410e2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f73901f87c0>]}
2022-07-01 11:02:51.645740 (Thread-155): sending response (<Response 1703 bytes [200 OK]>) to 10.0.18.132
2022-07-01 11:02:51.790797 (Thread-156): handling status request
2022-07-01 11:02:51.791203 (Thread-156): 11:02:51  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'f48b5fd9-b5fc-4510-bbcd-b59df21410e2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f73901ac310>]}
2022-07-01 11:02:51.791676 (Thread-156): sending response (<Response 1703 bytes [200 OK]>) to 10.0.18.132
2022-07-01 11:02:53.126752 (Thread-157): 11:02:53  Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
2022-07-01 11:02:53.126957 (Thread-157): 11:02:53  Partial parsing enabled, no changes found, skipping parsing
2022-07-01 11:02:53.127390 (Thread-157): 11:02:53  [WARNING]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.data-apps-ecommerce-template.data_model

2022-07-01 11:02:53.132413 (Thread-157): 11:02:53  Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'f48b5fd9-b5fc-4510-bbcd-b59df21410e2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f73901275e0>]}
2022-07-01 11:02:53.888365 (Thread-158): handling status request
2022-07-01 11:02:53.888797 (Thread-158): 11:02:53  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'f48b5fd9-b5fc-4510-bbcd-b59df21410e2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f73901c1dc0>]}
2022-07-01 11:02:53.889296 (Thread-158): sending response (<Response 1703 bytes [200 OK]>) to 10.0.18.132
2022-07-01 11:02:53.928631 (Thread-159): handling status request
2022-07-01 11:02:53.928891 (Thread-159): 11:02:53  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'f48b5fd9-b5fc-4510-bbcd-b59df21410e2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f73901c1c10>]}
2022-07-01 11:02:53.929262 (Thread-159): sending response (<Response 1703 bytes [200 OK]>) to 10.0.18.132
2022-07-01 11:03:00.350159 (Thread-160): handling status request
2022-07-01 11:03:00.350569 (Thread-160): 11:03:00  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'f48b5fd9-b5fc-4510-bbcd-b59df21410e2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f73901c1be0>]}
2022-07-01 11:03:00.351061 (Thread-160): sending response (<Response 1703 bytes [200 OK]>) to 10.0.18.132
2022-07-01 11:03:00.398902 (Thread-161): handling status request
2022-07-01 11:03:00.399191 (Thread-161): 11:03:00  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'f48b5fd9-b5fc-4510-bbcd-b59df21410e2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f73901c1a00>]}
2022-07-01 11:03:00.399613 (Thread-161): sending response (<Response 1703 bytes [200 OK]>) to 10.0.18.132
2022-07-01 11:03:00.405633 (Thread-162): handling ps request
2022-07-01 11:03:00.405897 (Thread-162): 11:03:00  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'f48b5fd9-b5fc-4510-bbcd-b59df21410e2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f73901c1370>]}
2022-07-01 11:03:00.407180 (Thread-162): sending response (<Response 14946 bytes [200 OK]>) to 10.0.18.132
2022-07-01 11:03:00.480785 (Thread-163): handling status request
2022-07-01 11:03:00.485154 (Thread-163): 11:03:00  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'f48b5fd9-b5fc-4510-bbcd-b59df21410e2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f73901b0430>]}
2022-07-01 11:03:00.485620 (Thread-163): sending response (<Response 1703 bytes [200 OK]>) to 10.0.18.132
2022-07-01 11:03:02.357566 (Thread-164): handling status request
2022-07-01 11:03:02.357962 (Thread-164): 11:03:02  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'f48b5fd9-b5fc-4510-bbcd-b59df21410e2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f73901b0e20>]}
2022-07-01 11:03:02.358459 (Thread-164): sending response (<Response 1680 bytes [200 OK]>) to 10.0.18.132
2022-07-01 11:03:02.369606 (Thread-165): handling list request
2022-07-01 11:03:02.369875 (Thread-165): 11:03:02  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'f48b5fd9-b5fc-4510-bbcd-b59df21410e2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f73901b0be0>]}
2022-07-01 11:03:02.408864 (Thread-165): 11:03:02  Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'f48b5fd9-b5fc-4510-bbcd-b59df21410e2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f73901b0f40>]}
2022-07-01 11:03:02.409199 (Thread-165): 11:03:02  Found 7 models, 0 tests, 0 snapshots, 0 analyses, 179 macros, 0 operations, 0 seed files, 15 sources, 0 exposures, 0 metrics
2022-07-01 11:03:02.412124 (Thread-165): sending response (<Response 2058 bytes [200 OK]>) to 10.0.18.132
2022-07-01 11:03:02.509934 (Thread-166): handling status request
2022-07-01 11:03:02.510277 (Thread-166): 11:03:02  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'f48b5fd9-b5fc-4510-bbcd-b59df21410e2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f73901c1460>]}
2022-07-01 11:03:02.510725 (Thread-166): sending response (<Response 1703 bytes [200 OK]>) to 10.0.18.132
2022-07-01 11:03:10.806620 (Thread-167): handling status request
2022-07-01 11:03:10.807028 (Thread-167): 11:03:10  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'f48b5fd9-b5fc-4510-bbcd-b59df21410e2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f73901c1790>]}
2022-07-01 11:03:10.807507 (Thread-167): sending response (<Response 1680 bytes [200 OK]>) to 10.0.18.132
2022-07-01 11:03:10.828085 (Thread-168): handling list request
2022-07-01 11:03:10.828351 (Thread-168): 11:03:10  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'f48b5fd9-b5fc-4510-bbcd-b59df21410e2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f739008ac10>]}
2022-07-01 11:03:10.861245 (Thread-168): 11:03:10  Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'f48b5fd9-b5fc-4510-bbcd-b59df21410e2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f73901b0d30>]}
2022-07-01 11:03:10.861518 (Thread-168): 11:03:10  Found 7 models, 0 tests, 0 snapshots, 0 analyses, 179 macros, 0 operations, 0 seed files, 15 sources, 0 exposures, 0 metrics
2022-07-01 11:03:10.864818 (Thread-168): sending response (<Response 2070 bytes [200 OK]>) to 10.0.18.132
2022-07-01 11:03:12.660521 (Thread-169): handling status request
2022-07-01 11:03:12.660912 (Thread-169): 11:03:12  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'f48b5fd9-b5fc-4510-bbcd-b59df21410e2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f73900f0550>]}
2022-07-01 11:03:12.661380 (Thread-169): sending response (<Response 1703 bytes [200 OK]>) to 10.0.18.132
2022-07-01 11:03:13.006918 (Thread-170): handling run_sql request
2022-07-01 11:03:13.007312 (Thread-170): 11:03:13  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'f48b5fd9-b5fc-4510-bbcd-b59df21410e2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f73900f01c0>]}
2022-07-01 11:03:15.326418 (Thread-170): sending response (<Response 139 bytes [200 OK]>) to 10.0.18.132
2022-07-01 11:03:15.351326 (MainThread): 11:03:15  Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '7005dd2c-983f-43cf-b14e-5425a569d524', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4a4fb860a0>]}
2022-07-01 11:03:15.351831 (MainThread): 11:03:15  Found 7 models, 0 tests, 0 snapshots, 0 analyses, 179 macros, 0 operations, 0 seed files, 15 sources, 0 exposures, 0 metrics
2022-07-01 11:03:15.352430 (Thread-1): 11:03:15  Acquiring new snowflake connection "rpc.ecommerce_data_model_dbt.request"
2022-07-01 11:03:15.352569 (Thread-1): 11:03:15  Began compiling node rpc.ecommerce_data_model_dbt.request
2022-07-01 11:03:15.352676 (Thread-1): 11:03:15  Compiling rpc.ecommerce_data_model_dbt.request
2022-07-01 11:03:15.355190 (Thread-1): 11:03:15  finished collecting timing info
2022-07-01 11:03:15.355319 (Thread-1): 11:03:15  Began executing node rpc.ecommerce_data_model_dbt.request
2022-07-01 11:03:15.356080 (Thread-1): 11:03:15  Using snowflake connection "rpc.ecommerce_data_model_dbt.request"
2022-07-01 11:03:15.356169 (Thread-1): 11:03:15  On rpc.ecommerce_data_model_dbt.request: select user_id, gender from 
(select user_id, properties_gender as gender, row_number() over(partition by user_id order by timestamp desc) as rn from 
analytics_db.data_apps_simulated.identifies where timestamp >= '2021-05-01' and timestamp <= '2022-06-29'
and properties_gender is not null and properties_gender != '') where rn = 1
limit 500
/* limit added automatically by dbt cloud */
2022-07-01 11:03:15.356250 (Thread-1): 11:03:15  Opening a new connection, currently in state init
2022-07-01 11:03:15.696009 (Thread-171): handling poll request
2022-07-01 11:03:15.696492 (Thread-171): 11:03:15  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'f48b5fd9-b5fc-4510-bbcd-b59df21410e2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7390127af0>]}
2022-07-01 11:03:15.697367 (Thread-171): sending response (<Response 4117 bytes [200 OK]>) to 10.0.18.132
2022-07-01 11:03:17.047580 (Thread-172): handling poll request
2022-07-01 11:03:17.047973 (Thread-172): 11:03:17  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'f48b5fd9-b5fc-4510-bbcd-b59df21410e2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7390127b50>]}
2022-07-01 11:03:17.048478 (Thread-172): sending response (<Response 400 bytes [200 OK]>) to 10.0.18.132
2022-07-01 11:03:18.417798 (Thread-173): handling poll request
2022-07-01 11:03:18.418223 (Thread-173): 11:03:18  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'f48b5fd9-b5fc-4510-bbcd-b59df21410e2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7390127700>]}
2022-07-01 11:03:18.418710 (Thread-173): sending response (<Response 400 bytes [200 OK]>) to 10.0.18.132
2022-07-01 11:03:18.808057 (Thread-1): 11:03:18  SQL status: SUCCESS 5 in 3.45 seconds
2022-07-01 11:03:18.809509 (Thread-1): 11:03:18  finished collecting timing info
2022-07-01 11:03:18.809694 (Thread-1): 11:03:18  On rpc.ecommerce_data_model_dbt.request: Close
2022-07-01 11:03:19.773845 (Thread-174): handling poll request
2022-07-01 11:03:19.774265 (Thread-174): 11:03:19  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'f48b5fd9-b5fc-4510-bbcd-b59df21410e2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f73900fe8b0>]}
2022-07-01 11:03:19.775133 (Thread-174): sending response (<Response 4912 bytes [200 OK]>) to 10.0.18.132
2022-07-01 11:03:22.212176 (Thread-175): handling status request
2022-07-01 11:03:22.212610 (Thread-175): 11:03:22  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'f48b5fd9-b5fc-4510-bbcd-b59df21410e2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f73900fe340>]}
2022-07-01 11:03:22.213116 (Thread-175): sending response (<Response 1703 bytes [200 OK]>) to 10.0.18.132
2022-07-01 11:03:22.556618 (Thread-176): handling run_sql request
2022-07-01 11:03:22.556975 (Thread-176): 11:03:22  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'f48b5fd9-b5fc-4510-bbcd-b59df21410e2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f73900fe220>]}
2022-07-01 11:03:24.873621 (Thread-176): sending response (<Response 139 bytes [200 OK]>) to 10.0.18.132
2022-07-01 11:03:24.898821 (MainThread): 11:03:24  Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'a81806b1-c772-4d09-a75c-a75e8bdb436d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6067814ee0>]}
2022-07-01 11:03:24.899328 (MainThread): 11:03:24  Found 7 models, 0 tests, 0 snapshots, 0 analyses, 179 macros, 0 operations, 0 seed files, 15 sources, 0 exposures, 0 metrics
2022-07-01 11:03:24.899907 (Thread-1): 11:03:24  Acquiring new snowflake connection "rpc.ecommerce_data_model_dbt.request"
2022-07-01 11:03:24.900040 (Thread-1): 11:03:24  Began compiling node rpc.ecommerce_data_model_dbt.request
2022-07-01 11:03:24.900135 (Thread-1): 11:03:24  Compiling rpc.ecommerce_data_model_dbt.request
2022-07-01 11:03:24.902661 (Thread-1): 11:03:24  finished collecting timing info
2022-07-01 11:03:24.902791 (Thread-1): 11:03:24  Began executing node rpc.ecommerce_data_model_dbt.request
2022-07-01 11:03:24.903754 (Thread-1): 11:03:24  Using snowflake connection "rpc.ecommerce_data_model_dbt.request"
2022-07-01 11:03:24.903843 (Thread-1): 11:03:24  On rpc.ecommerce_data_model_dbt.request: select user_id, age from
(select user_id, 
(CASE WHEN dateadd(year, datediff (year, properties_birthday, getdate()), properties_birthday) > getdate()
      THEN datediff(year, properties_birthday, getdate()) - 1
      ELSE datediff(year, properties_birthday, getdate())
 END) as age, 
row_number() over(partition by user_id order by timestamp desc) as rn 
from analytics_db.data_apps_simulated.identifies where timestamp >= '2021-05-01' and timestamp <= '2022-06-29'
and properties_birthday is not null and properties_birthday!='') 
where rn=1
limit 500
/* limit added automatically by dbt cloud */
2022-07-01 11:03:24.903925 (Thread-1): 11:03:24  Opening a new connection, currently in state init
2022-07-01 11:03:25.242055 (Thread-177): handling poll request
2022-07-01 11:03:25.242535 (Thread-177): 11:03:25  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'f48b5fd9-b5fc-4510-bbcd-b59df21410e2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7390127280>]}
2022-07-01 11:03:25.243388 (Thread-177): sending response (<Response 4331 bytes [200 OK]>) to 10.0.18.132
2022-07-01 11:03:25.399143 (Thread-1): 11:03:25  SQL status: SUCCESS 3 in 0.5 seconds
2022-07-01 11:03:25.400565 (Thread-1): 11:03:25  finished collecting timing info
2022-07-01 11:03:25.400750 (Thread-1): 11:03:25  On rpc.ecommerce_data_model_dbt.request: Close
2022-07-01 11:03:26.595984 (Thread-178): handling poll request
2022-07-01 11:03:26.596451 (Thread-178): 11:03:26  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'f48b5fd9-b5fc-4510-bbcd-b59df21410e2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f73900fe490>]}
2022-07-01 11:03:26.597351 (Thread-178): sending response (<Response 5769 bytes [200 OK]>) to 10.0.18.132
2022-07-01 11:22:50.459218 (Thread-179): 11:22:50  Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
2022-07-01 11:22:50.460876 (Thread-179): 11:22:50  Partial parsing: updated file: ecommerce_data_model_dbt://models/data_model/user_age_temp.sql
2022-07-01 11:22:50.464981 (Thread-179): 11:22:50  1603: static parser failed on data_model/user_age_temp.sql
2022-07-01 11:22:50.468860 (Thread-179): 11:22:50  1602: parser fallback to jinja rendering on data_model/user_age_temp.sql
2022-07-01 11:22:50.522960 (Thread-179): 11:22:50  [WARNING]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.data-apps-ecommerce-template.data_model

2022-07-01 11:22:50.527785 (Thread-179): 11:22:50  Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'f48b5fd9-b5fc-4510-bbcd-b59df21410e2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f73427e6b20>]}
2022-07-01 11:22:51.202445 (Thread-180): handling status request
2022-07-01 11:22:51.202853 (Thread-180): 11:22:51  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'f48b5fd9-b5fc-4510-bbcd-b59df21410e2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f73900adb80>]}
2022-07-01 11:22:51.203370 (Thread-180): sending response (<Response 2351 bytes [200 OK]>) to 10.0.18.132
2022-07-01 11:22:51.259131 (Thread-181): handling status request
2022-07-01 11:22:51.259405 (Thread-181): 11:22:51  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'f48b5fd9-b5fc-4510-bbcd-b59df21410e2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f73900ad970>]}
2022-07-01 11:22:51.259809 (Thread-181): sending response (<Response 2351 bytes [200 OK]>) to 10.0.18.132
2022-07-01 11:23:06.464297 (Thread-182): handling status request
2022-07-01 11:23:06.464737 (Thread-182): 11:23:06  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'f48b5fd9-b5fc-4510-bbcd-b59df21410e2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f73900ad7f0>]}
2022-07-01 11:23:06.496109 (Thread-182): sending response (<Response 2351 bytes [200 OK]>) to 10.0.18.132
2022-07-01 11:23:06.853757 (Thread-183): handling run_sql request
2022-07-01 11:23:06.854151 (Thread-183): 11:23:06  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'f48b5fd9-b5fc-4510-bbcd-b59df21410e2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f73900ad820>]}
2022-07-01 11:23:09.166109 (Thread-183): sending response (<Response 139 bytes [200 OK]>) to 10.0.18.132
2022-07-01 11:23:09.192299 (MainThread): 11:23:09  Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '383282f4-d63a-4f89-9b6c-2555a6859004', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbaa910a130>]}
2022-07-01 11:23:09.192845 (MainThread): 11:23:09  Found 7 models, 0 tests, 0 snapshots, 0 analyses, 179 macros, 0 operations, 0 seed files, 15 sources, 0 exposures, 0 metrics
2022-07-01 11:23:09.193425 (Thread-1): 11:23:09  Acquiring new snowflake connection "rpc.ecommerce_data_model_dbt.request"
2022-07-01 11:23:09.193556 (Thread-1): 11:23:09  Began compiling node rpc.ecommerce_data_model_dbt.request
2022-07-01 11:23:09.193653 (Thread-1): 11:23:09  Compiling rpc.ecommerce_data_model_dbt.request
2022-07-01 11:23:09.196908 (Thread-1): 11:23:09  finished collecting timing info
2022-07-01 11:23:09.197041 (Thread-1): 11:23:09  Began executing node rpc.ecommerce_data_model_dbt.request
2022-07-01 11:23:09.198646 (Thread-1): 11:23:09  Using snowflake connection "rpc.ecommerce_data_model_dbt.request"
2022-07-01 11:23:09.198746 (Thread-1): 11:23:09  On rpc.ecommerce_data_model_dbt.request: with cte_gender as 
(select user_id, gender from 
(select user_id, properties_gender as gender, row_number() over(partition by user_id order by timestamp desc) as rn from 
analytics_db.data_apps_simulated.identifies where timestamp >= '2021-05-01' and timestamp <= '2022-06-29'
and properties_gender is not null and properties_gender != '') where rn = 1),

cte_age as (select user_id, age from
(select user_id, 
(CASE WHEN dateadd(year, datediff (year, properties_birthday, getdate()), properties_birthday) > getdate()
      THEN datediff(year, properties_birthday, getdate()) - 1
      ELSE datediff(year, properties_birthday, getdate())
 END) as age, 
row_number() over(partition by user_id order by timestamp desc) as rn 
from analytics_db.data_apps_simulated.identifies where timestamp >= '2021-05-01' and timestamp <= '2022-06-29'
and properties_birthday is not null and properties_birthday!='') 
where rn=1)

select coalesce(a.user_id, b.user_id) as user_id, gender, age from cte_gender a full outer join cte_age b on a.user_id = b.user_id
limit 500
/* limit added automatically by dbt cloud */
2022-07-01 11:23:09.198831 (Thread-1): 11:23:09  Opening a new connection, currently in state init
2022-07-01 11:23:09.531096 (Thread-184): handling poll request
2022-07-01 11:23:09.531541 (Thread-184): 11:23:09  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'f48b5fd9-b5fc-4510-bbcd-b59df21410e2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f73901f8280>]}
2022-07-01 11:23:09.532489 (Thread-184): sending response (<Response 4843 bytes [200 OK]>) to 10.0.18.132
2022-07-01 11:23:10.883394 (Thread-185): handling poll request
2022-07-01 11:23:10.883781 (Thread-185): 11:23:10  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'f48b5fd9-b5fc-4510-bbcd-b59df21410e2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f73901dd5b0>]}
2022-07-01 11:23:10.884258 (Thread-185): sending response (<Response 398 bytes [200 OK]>) to 10.0.18.132
2022-07-01 11:23:12.242262 (Thread-186): handling poll request
2022-07-01 11:23:12.242657 (Thread-186): 11:23:12  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'f48b5fd9-b5fc-4510-bbcd-b59df21410e2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f73901dd640>]}
2022-07-01 11:23:12.243126 (Thread-186): sending response (<Response 399 bytes [200 OK]>) to 10.0.18.132
2022-07-01 11:23:13.603661 (Thread-187): handling poll request
2022-07-01 11:23:13.604053 (Thread-187): 11:23:13  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'f48b5fd9-b5fc-4510-bbcd-b59df21410e2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f73901ddb20>]}
2022-07-01 11:23:13.604564 (Thread-187): sending response (<Response 399 bytes [200 OK]>) to 10.0.18.132
2022-07-01 11:23:14.975969 (Thread-188): handling poll request
2022-07-01 11:23:14.976350 (Thread-188): 11:23:14  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'f48b5fd9-b5fc-4510-bbcd-b59df21410e2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f73901dd670>]}
2022-07-01 11:23:14.976875 (Thread-188): sending response (<Response 399 bytes [200 OK]>) to 10.0.18.132
2022-07-01 11:23:16.337248 (Thread-189): handling poll request
2022-07-01 11:23:16.337661 (Thread-189): 11:23:16  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'f48b5fd9-b5fc-4510-bbcd-b59df21410e2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f73900690a0>]}
2022-07-01 11:23:16.338134 (Thread-189): sending response (<Response 399 bytes [200 OK]>) to 10.0.18.132
2022-07-01 11:23:16.929382 (Thread-1): 11:23:16  SQL status: SUCCESS 5 in 7.73 seconds
2022-07-01 11:23:16.930917 (Thread-1): 11:23:16  finished collecting timing info
2022-07-01 11:23:16.931104 (Thread-1): 11:23:16  On rpc.ecommerce_data_model_dbt.request: Close
2022-07-01 11:23:17.689520 (Thread-190): handling poll request
2022-07-01 11:23:17.689906 (Thread-190): 11:23:17  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'f48b5fd9-b5fc-4510-bbcd-b59df21410e2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f73427d3c70>]}
2022-07-01 11:23:17.690812 (Thread-190): sending response (<Response 7971 bytes [200 OK]>) to 10.0.18.132
2022-07-01 11:23:35.999361 (Thread-191): handling status request
2022-07-01 11:23:35.999836 (Thread-191): 11:23:35  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'f48b5fd9-b5fc-4510-bbcd-b59df21410e2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f73901dd850>]}
2022-07-01 11:23:36.000375 (Thread-191): sending response (<Response 2351 bytes [200 OK]>) to 10.0.18.132
2022-07-01 11:23:36.476924 (Thread-192): handling run_sql request
2022-07-01 11:23:36.477264 (Thread-192): 11:23:36  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'f48b5fd9-b5fc-4510-bbcd-b59df21410e2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f73427d3880>]}
2022-07-01 11:23:38.788522 (Thread-192): sending response (<Response 139 bytes [200 OK]>) to 10.0.18.132
2022-07-01 11:23:38.814373 (MainThread): 11:23:38  Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '610a311d-1945-43aa-8ccd-099532f8cac5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f68907ca190>]}
2022-07-01 11:23:38.814874 (MainThread): 11:23:38  Found 7 models, 0 tests, 0 snapshots, 0 analyses, 179 macros, 0 operations, 0 seed files, 15 sources, 0 exposures, 0 metrics
2022-07-01 11:23:38.815444 (Thread-1): 11:23:38  Acquiring new snowflake connection "rpc.ecommerce_data_model_dbt.request"
2022-07-01 11:23:38.815576 (Thread-1): 11:23:38  Began compiling node rpc.ecommerce_data_model_dbt.request
2022-07-01 11:23:38.815670 (Thread-1): 11:23:38  Compiling rpc.ecommerce_data_model_dbt.request
2022-07-01 11:23:38.818846 (Thread-1): 11:23:38  finished collecting timing info
2022-07-01 11:23:38.818974 (Thread-1): 11:23:38  Began executing node rpc.ecommerce_data_model_dbt.request
2022-07-01 11:23:38.820564 (Thread-1): 11:23:38  Using snowflake connection "rpc.ecommerce_data_model_dbt.request"
2022-07-01 11:23:38.820662 (Thread-1): 11:23:38  On rpc.ecommerce_data_model_dbt.request: with cte_gender as 
(select user_id, gender from 
(select user_id, properties_gender as gender, row_number() over(partition by user_id order by timestamp desc) as rn from 
analytics_db.data_apps_simulated.identifies where timestamp >= '2021-05-01' and timestamp <= '2022-06-29'
and properties_gender is not null and properties_gender != '') where rn = 1),

cte_age as (select user_id, age from
(select user_id, 
(CASE WHEN dateadd(year, datediff (year, properties_birthday, getdate()), properties_birthday) > getdate()
      THEN datediff(year, properties_birthday, getdate()) - 1
      ELSE datediff(year, properties_birthday, getdate())
 END) as age, 
row_number() over(partition by user_id order by timestamp desc) as rn 
from analytics_db.data_apps_simulated.identifies where timestamp >= '2021-05-01' and timestamp <= '2022-06-29'
and properties_birthday is not null and properties_birthday!='') 
where rn=1)

select coalesce(a.user_id, b.user_id) as user_id, gender, age from cte_gender a full outer join cte_age b on a.user_id = b.user_id order by user_id
limit 500
/* limit added automatically by dbt cloud */
2022-07-01 11:23:38.820746 (Thread-1): 11:23:38  Opening a new connection, currently in state init
2022-07-01 11:23:39.157722 (Thread-193): handling poll request
2022-07-01 11:23:39.158177 (Thread-193): 11:23:39  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'f48b5fd9-b5fc-4510-bbcd-b59df21410e2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f739018b580>]}
2022-07-01 11:23:39.159030 (Thread-193): sending response (<Response 4860 bytes [200 OK]>) to 10.0.18.132
2022-07-01 11:23:40.112893 (Thread-1): 11:23:40  SQL status: SUCCESS 5 in 1.29 seconds
2022-07-01 11:23:40.114431 (Thread-1): 11:23:40  finished collecting timing info
2022-07-01 11:23:40.114617 (Thread-1): 11:23:40  On rpc.ecommerce_data_model_dbt.request: Close
2022-07-01 11:23:40.941116 (Thread-194): handling poll request
2022-07-01 11:23:40.941513 (Thread-194): 11:23:40  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'f48b5fd9-b5fc-4510-bbcd-b59df21410e2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f739018bca0>]}
2022-07-01 11:23:40.943028 (Thread-194): sending response (<Response 8037 bytes [200 OK]>) to 10.0.18.132
2022-07-01 11:24:40.720323 (Thread-195): 11:24:40  Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
2022-07-01 11:24:40.720800 (Thread-195): 11:24:40  Partial parsing: updated file: ecommerce_data_model_dbt://models/data_model/stg_user_traits.sql
2022-07-01 11:24:40.725073 (Thread-195): 11:24:40  1603: static parser failed on data_model/stg_user_traits.sql
2022-07-01 11:24:40.730140 (Thread-195): 11:24:40  1602: parser fallback to jinja rendering on data_model/stg_user_traits.sql
2022-07-01 11:24:40.763379 (Thread-195): 11:24:40  [WARNING]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.data-apps-ecommerce-template.data_model

2022-07-01 11:24:40.768307 (Thread-195): 11:24:40  Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'f48b5fd9-b5fc-4510-bbcd-b59df21410e2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f73427780d0>]}
2022-07-01 11:24:44.744563 (Thread-196): handling status request
2022-07-01 11:24:44.744994 (Thread-196): 11:24:44  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'f48b5fd9-b5fc-4510-bbcd-b59df21410e2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f73900ad2b0>]}
2022-07-01 11:24:44.745528 (Thread-196): sending response (<Response 2357 bytes [200 OK]>) to 10.0.18.132
2022-07-01 11:24:44.883741 (Thread-197): handling status request
2022-07-01 11:24:44.884131 (Thread-197): 11:24:44  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'f48b5fd9-b5fc-4510-bbcd-b59df21410e2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f73900add60>]}
2022-07-01 11:24:44.884658 (Thread-197): sending response (<Response 2357 bytes [200 OK]>) to 10.0.18.132
2022-07-01 11:24:44.918207 (Thread-198): handling status request
2022-07-01 11:24:44.920819 (Thread-198): 11:24:44  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'f48b5fd9-b5fc-4510-bbcd-b59df21410e2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f734275edf0>]}
2022-07-01 11:24:44.921285 (Thread-198): sending response (<Response 2357 bytes [200 OK]>) to 10.0.18.132
2022-07-01 11:24:45.338922 (Thread-199): handling run_sql request
2022-07-01 11:24:45.339327 (Thread-199): 11:24:45  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'f48b5fd9-b5fc-4510-bbcd-b59df21410e2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f734275efd0>]}
2022-07-01 11:24:47.681501 (Thread-199): sending response (<Response 139 bytes [200 OK]>) to 10.0.18.132
2022-07-01 11:24:47.707451 (MainThread): 11:24:47  Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'ca95cc2b-8f45-4202-b6ec-0dc403253c1f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fef91949250>]}
2022-07-01 11:24:47.707964 (MainThread): 11:24:47  Found 7 models, 0 tests, 0 snapshots, 0 analyses, 179 macros, 0 operations, 0 seed files, 15 sources, 0 exposures, 0 metrics
2022-07-01 11:24:47.708546 (Thread-1): 11:24:47  Acquiring new snowflake connection "rpc.ecommerce_data_model_dbt.request"
2022-07-01 11:24:47.708672 (Thread-1): 11:24:47  Began compiling node rpc.ecommerce_data_model_dbt.request
2022-07-01 11:24:47.708764 (Thread-1): 11:24:47  Compiling rpc.ecommerce_data_model_dbt.request
2022-07-01 11:24:47.712019 (Thread-1): 11:24:47  finished collecting timing info
2022-07-01 11:24:47.712147 (Thread-1): 11:24:47  Began executing node rpc.ecommerce_data_model_dbt.request
2022-07-01 11:24:47.713749 (Thread-1): 11:24:47  Using snowflake connection "rpc.ecommerce_data_model_dbt.request"
2022-07-01 11:24:47.713848 (Thread-1): 11:24:47  On rpc.ecommerce_data_model_dbt.request: with cte_gender as 
(select user_id, gender from 
(select user_id, properties_gender as gender, row_number() over(partition by user_id order by timestamp desc) as rn from 
analytics_db.data_apps_simulated.identifies where timestamp >= '2021-05-01' and timestamp <= '2022-06-29'
and properties_gender is not null and properties_gender != '') where rn = 1),

cte_age as (select user_id, age from
(select user_id, 
(CASE WHEN dateadd(year, datediff (year, properties_birthday, getdate()), properties_birthday) > getdate()
      THEN datediff(year, properties_birthday, getdate()) - 1
      ELSE datediff(year, properties_birthday, getdate())
 END) as age, 
row_number() over(partition by user_id order by timestamp desc) as rn 
from analytics_db.data_apps_simulated.identifies where timestamp >= '2021-05-01' and timestamp <= '2022-06-29'
and properties_birthday is not null and properties_birthday!='') 
where rn=1)

select coalesce(a.user_id, b.user_id) as user_id, gender, age from cte_gender a full outer join cte_age b on a.user_id = b.user_id
limit 500
/* limit added automatically by dbt cloud */
2022-07-01 11:24:47.713931 (Thread-1): 11:24:47  Opening a new connection, currently in state init
2022-07-01 11:24:48.081336 (Thread-200): handling poll request
2022-07-01 11:24:48.081794 (Thread-200): 11:24:48  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'f48b5fd9-b5fc-4510-bbcd-b59df21410e2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f73427985e0>]}
2022-07-01 11:24:48.082720 (Thread-200): sending response (<Response 4853 bytes [200 OK]>) to 10.0.18.132
2022-07-01 11:24:48.617693 (Thread-1): 11:24:48  SQL status: SUCCESS 5 in 0.9 seconds
2022-07-01 11:24:48.619187 (Thread-1): 11:24:48  finished collecting timing info
2022-07-01 11:24:48.619366 (Thread-1): 11:24:48  On rpc.ecommerce_data_model_dbt.request: Close
2022-07-01 11:24:49.442001 (Thread-201): handling poll request
2022-07-01 11:24:49.442416 (Thread-201): 11:24:49  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'f48b5fd9-b5fc-4510-bbcd-b59df21410e2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f73427d01f0>]}
2022-07-01 11:24:49.443359 (Thread-201): sending response (<Response 7972 bytes [200 OK]>) to 10.0.18.132
2022-07-01 11:25:29.598320 (Thread-202): 11:25:29  Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
2022-07-01 11:25:29.598557 (Thread-202): 11:25:29  Partial parsing enabled, no changes found, skipping parsing
2022-07-01 11:25:29.599057 (Thread-202): 11:25:29  [WARNING]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.data-apps-ecommerce-template.data_model

2022-07-01 11:25:29.604883 (Thread-202): 11:25:29  Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'f48b5fd9-b5fc-4510-bbcd-b59df21410e2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f73901eb430>]}
2022-07-01 11:25:30.812118 (Thread-203): handling status request
2022-07-01 11:25:30.812549 (Thread-203): 11:25:30  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'f48b5fd9-b5fc-4510-bbcd-b59df21410e2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f734273aee0>]}
2022-07-01 11:25:30.813050 (Thread-203): sending response (<Response 1703 bytes [200 OK]>) to 10.0.18.132
2022-07-01 11:25:30.988689 (Thread-204): handling status request
2022-07-01 11:25:30.989055 (Thread-204): 11:25:30  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'f48b5fd9-b5fc-4510-bbcd-b59df21410e2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f734273ad00>]}
2022-07-01 11:25:30.989511 (Thread-204): sending response (<Response 1703 bytes [200 OK]>) to 10.0.18.132
2022-07-01 11:25:50.395000 (Thread-205): 11:25:50  Partial parsing enabled: 1 files deleted, 0 files added, 0 files changed.
2022-07-01 11:25:50.395290 (Thread-205): 11:25:50  Partial parsing: deleted file: ecommerce_data_model_dbt://models/data_model/user_age_temp.sql
2022-07-01 11:25:50.428786 (Thread-205): 11:25:50  [WARNING]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.data-apps-ecommerce-template.data_model

2022-07-01 11:25:50.434025 (Thread-205): 11:25:50  Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'f48b5fd9-b5fc-4510-bbcd-b59df21410e2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f73427675b0>]}
2022-07-01 11:25:51.619761 (Thread-206): handling status request
2022-07-01 11:25:51.620161 (Thread-206): 11:25:51  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'f48b5fd9-b5fc-4510-bbcd-b59df21410e2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f734268e3d0>]}
2022-07-01 11:25:51.620682 (Thread-206): sending response (<Response 1737 bytes [200 OK]>) to 10.0.18.132
2022-07-01 11:25:51.714297 (Thread-207): handling status request
2022-07-01 11:25:51.714663 (Thread-207): 11:25:51  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'f48b5fd9-b5fc-4510-bbcd-b59df21410e2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f734268e1f0>]}
2022-07-01 11:25:51.715128 (Thread-207): sending response (<Response 1737 bytes [200 OK]>) to 10.0.18.132
2022-07-01 11:26:10.082872 (Thread-208): 11:26:10  Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
2022-07-01 11:26:10.083081 (Thread-208): 11:26:10  Partial parsing enabled, no changes found, skipping parsing
2022-07-01 11:26:10.083490 (Thread-208): 11:26:10  [WARNING]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.data-apps-ecommerce-template.data_model

2022-07-01 11:26:10.088530 (Thread-208): 11:26:10  Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'f48b5fd9-b5fc-4510-bbcd-b59df21410e2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7342594f10>]}
2022-07-01 11:26:11.342546 (Thread-209): handling status request
2022-07-01 11:26:11.342947 (Thread-209): 11:26:11  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'f48b5fd9-b5fc-4510-bbcd-b59df21410e2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f734262a4f0>]}
2022-07-01 11:26:11.343424 (Thread-209): sending response (<Response 1703 bytes [200 OK]>) to 10.0.18.132
2022-07-01 11:26:11.450011 (Thread-210): handling status request
2022-07-01 11:26:11.450289 (Thread-210): 11:26:11  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'f48b5fd9-b5fc-4510-bbcd-b59df21410e2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f734262a310>]}
2022-07-01 11:26:11.450686 (Thread-210): sending response (<Response 1703 bytes [200 OK]>) to 10.0.18.132
2022-07-01 11:26:14.742836 (Thread-211): 11:26:14  Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
2022-07-01 11:26:14.743041 (Thread-211): 11:26:14  Partial parsing enabled, no changes found, skipping parsing
2022-07-01 11:26:14.743478 (Thread-211): 11:26:14  [WARNING]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.data-apps-ecommerce-template.data_model

2022-07-01 11:26:14.748567 (Thread-211): 11:26:14  Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'f48b5fd9-b5fc-4510-bbcd-b59df21410e2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7342568b50>]}
2022-07-01 11:26:15.603370 (Thread-212): handling status request
2022-07-01 11:26:15.603773 (Thread-212): 11:26:15  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'f48b5fd9-b5fc-4510-bbcd-b59df21410e2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7342639f70>]}
2022-07-01 11:26:15.629428 (Thread-212): sending response (<Response 1703 bytes [200 OK]>) to 10.0.18.132
2022-07-01 11:26:15.837662 (Thread-213): handling status request
2022-07-01 11:26:15.838038 (Thread-213): 11:26:15  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'f48b5fd9-b5fc-4510-bbcd-b59df21410e2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7342639c10>]}
2022-07-01 11:26:15.838510 (Thread-213): sending response (<Response 1703 bytes [200 OK]>) to 10.0.18.132
2022-07-01 11:26:21.590726 (Thread-214): 11:26:21  Partial parsing enabled: 0 files deleted, 1 files added, 0 files changed.
2022-07-01 11:26:21.591090 (Thread-214): 11:26:21  Partial parsing: added file: ecommerce_data_model_dbt://models/data_model/temp_folder/age.sql
2022-07-01 11:26:21.595297 (Thread-214): 11:26:21  1603: static parser failed on data_model/temp_folder/age.sql
2022-07-01 11:26:21.599081 (Thread-214): 11:26:21  1602: parser fallback to jinja rendering on data_model/temp_folder/age.sql
2022-07-01 11:26:21.634838 (Thread-214): 11:26:21  [WARNING]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.data-apps-ecommerce-template.data_model

2022-07-01 11:26:21.639772 (Thread-214): 11:26:21  Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'f48b5fd9-b5fc-4510-bbcd-b59df21410e2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f73425275b0>]}
2022-07-01 11:26:22.439526 (Thread-215): handling status request
2022-07-01 11:26:22.439941 (Thread-215): 11:26:22  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'f48b5fd9-b5fc-4510-bbcd-b59df21410e2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7342598c70>]}
2022-07-01 11:26:22.440541 (Thread-215): sending response (<Response 2355 bytes [200 OK]>) to 10.0.18.132
2022-07-01 11:26:22.566110 (Thread-216): handling status request
2022-07-01 11:26:22.566476 (Thread-216): 11:26:22  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'f48b5fd9-b5fc-4510-bbcd-b59df21410e2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7342598a60>]}
2022-07-01 11:26:22.566955 (Thread-216): sending response (<Response 2355 bytes [200 OK]>) to 10.0.18.132
2022-07-01 11:26:31.651081 (Thread-217): 11:26:31  Partial parsing enabled: 1 files deleted, 0 files added, 0 files changed.
2022-07-01 11:26:31.651338 (Thread-217): 11:26:31  Partial parsing: deleted file: ecommerce_data_model_dbt://models/data_model/user_gender_temp.sql
2022-07-01 11:26:31.686205 (Thread-217): 11:26:31  [WARNING]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.data-apps-ecommerce-template.data_model

2022-07-01 11:26:31.691020 (Thread-217): 11:26:31  Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'f48b5fd9-b5fc-4510-bbcd-b59df21410e2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f734251ce50>]}
2022-07-01 11:26:32.615710 (Thread-218): handling status request
2022-07-01 11:26:32.616135 (Thread-218): 11:26:32  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'f48b5fd9-b5fc-4510-bbcd-b59df21410e2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f73425f2970>]}
2022-07-01 11:26:32.616677 (Thread-218): sending response (<Response 1740 bytes [200 OK]>) to 10.0.18.132
2022-07-01 11:26:32.838698 (Thread-219): handling status request
2022-07-01 11:26:32.839111 (Thread-219): 11:26:32  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'f48b5fd9-b5fc-4510-bbcd-b59df21410e2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f73425f2730>]}
2022-07-01 11:26:32.839587 (Thread-219): sending response (<Response 1740 bytes [200 OK]>) to 10.0.18.132
2022-07-01 11:26:40.684464 (Thread-220): 11:26:40  Partial parsing enabled: 0 files deleted, 1 files added, 0 files changed.
2022-07-01 11:26:40.684830 (Thread-220): 11:26:40  Partial parsing: added file: ecommerce_data_model_dbt://models/data_model/temp_folder/gender.sql
2022-07-01 11:26:40.688529 (Thread-220): 11:26:40  1699: static parser successfully parsed data_model/temp_folder/gender.sql
2022-07-01 11:26:40.731442 (Thread-220): 11:26:40  [WARNING]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.data-apps-ecommerce-template.data_model

2022-07-01 11:26:40.736452 (Thread-220): 11:26:40  Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'f48b5fd9-b5fc-4510-bbcd-b59df21410e2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f73424f5f40>]}
2022-07-01 11:26:41.896184 (Thread-221): handling status request
2022-07-01 11:26:41.896611 (Thread-221): 11:26:41  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'f48b5fd9-b5fc-4510-bbcd-b59df21410e2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7342541340>]}
2022-07-01 11:26:41.897114 (Thread-221): sending response (<Response 2055 bytes [200 OK]>) to 10.0.18.132
2022-07-01 11:26:42.149102 (Thread-222): handling status request
2022-07-01 11:26:42.149541 (Thread-222): 11:26:42  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'f48b5fd9-b5fc-4510-bbcd-b59df21410e2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7342541280>]}
2022-07-01 11:26:42.150035 (Thread-222): sending response (<Response 2055 bytes [200 OK]>) to 10.0.18.132
2022-07-01 11:26:44.202120 (Thread-223): 11:26:44  Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
2022-07-01 11:26:44.202542 (Thread-223): 11:26:44  Partial parsing: updated file: ecommerce_data_model_dbt://models/data_model/temp_folder/gender.sql
2022-07-01 11:26:44.206899 (Thread-223): 11:26:44  1603: static parser failed on data_model/temp_folder/gender.sql
2022-07-01 11:26:44.210398 (Thread-223): 11:26:44  1602: parser fallback to jinja rendering on data_model/temp_folder/gender.sql
2022-07-01 11:26:44.243645 (Thread-223): 11:26:44  [WARNING]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.data-apps-ecommerce-template.data_model

2022-07-01 11:26:44.248450 (Thread-223): 11:26:44  Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'f48b5fd9-b5fc-4510-bbcd-b59df21410e2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f73427701c0>]}
2022-07-01 11:26:45.320647 (Thread-224): handling status request
2022-07-01 11:26:45.321061 (Thread-224): 11:26:45  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'f48b5fd9-b5fc-4510-bbcd-b59df21410e2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f73424e60d0>]}
2022-07-01 11:26:45.321577 (Thread-224): sending response (<Response 2366 bytes [200 OK]>) to 10.0.18.132
2022-07-01 11:26:45.399765 (Thread-225): handling status request
2022-07-01 11:26:45.400115 (Thread-225): 11:26:45  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'f48b5fd9-b5fc-4510-bbcd-b59df21410e2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f734251ee80>]}
2022-07-01 11:26:45.400625 (Thread-225): sending response (<Response 2366 bytes [200 OK]>) to 10.0.18.132
2022-07-01 11:26:47.354004 (Thread-226): 11:26:47  Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
2022-07-01 11:26:47.354208 (Thread-226): 11:26:47  Partial parsing enabled, no changes found, skipping parsing
2022-07-01 11:26:47.354657 (Thread-226): 11:26:47  [WARNING]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.data-apps-ecommerce-template.data_model

2022-07-01 11:26:47.359646 (Thread-226): 11:26:47  Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'f48b5fd9-b5fc-4510-bbcd-b59df21410e2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7342405700>]}
2022-07-01 11:26:48.232330 (Thread-227): handling status request
2022-07-01 11:26:48.232775 (Thread-227): 11:26:48  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'f48b5fd9-b5fc-4510-bbcd-b59df21410e2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f73424e65b0>]}
2022-07-01 11:26:48.233264 (Thread-227): sending response (<Response 1703 bytes [200 OK]>) to 10.0.18.132
2022-07-01 11:26:48.437707 (Thread-228): handling status request
2022-07-01 11:26:48.438081 (Thread-228): 11:26:48  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'f48b5fd9-b5fc-4510-bbcd-b59df21410e2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f73425f2a00>]}
2022-07-01 11:26:48.438560 (Thread-228): sending response (<Response 1703 bytes [200 OK]>) to 10.0.18.132
2022-07-01 11:27:27.970270 (Thread-229): handling status request
2022-07-01 11:27:27.970728 (Thread-229): 11:27:27  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'f48b5fd9-b5fc-4510-bbcd-b59df21410e2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f73425220d0>]}
2022-07-01 11:27:27.971203 (Thread-229): sending response (<Response 1680 bytes [200 OK]>) to 10.0.18.132
2022-07-01 11:27:27.974805 (Thread-230): handling status request
2022-07-01 11:27:27.975060 (Thread-230): 11:27:27  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'f48b5fd9-b5fc-4510-bbcd-b59df21410e2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f73424be1f0>]}
2022-07-01 11:27:27.975407 (Thread-230): sending response (<Response 1680 bytes [200 OK]>) to 10.0.18.132
2022-07-01 11:27:27.978743 (Thread-231): handling list request
2022-07-01 11:27:27.978987 (Thread-231): 11:27:27  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'f48b5fd9-b5fc-4510-bbcd-b59df21410e2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f73424be310>]}
2022-07-01 11:27:28.018341 (Thread-232): sending response (<Response 214 bytes [200 OK]>) to 10.0.18.132
2022-07-01 11:27:29.430276 (Thread-233): handling status request
2022-07-01 11:27:29.430688 (Thread-233): 11:27:29  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'f48b5fd9-b5fc-4510-bbcd-b59df21410e2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f73425221c0>]}
2022-07-01 11:27:29.431163 (Thread-233): sending response (<Response 1680 bytes [200 OK]>) to 10.0.18.132
2022-07-01 11:27:29.445371 (Thread-234): handling list request
2022-07-01 11:27:29.445634 (Thread-234): 11:27:29  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'f48b5fd9-b5fc-4510-bbcd-b59df21410e2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f73424162e0>]}
2022-07-01 11:27:29.472694 (Thread-234): 11:27:29  Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'f48b5fd9-b5fc-4510-bbcd-b59df21410e2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f734240c220>]}
2022-07-01 11:27:29.472960 (Thread-234): 11:27:29  Found 7 models, 0 tests, 0 snapshots, 0 analyses, 179 macros, 0 operations, 0 seed files, 15 sources, 0 exposures, 0 metrics
2022-07-01 11:27:29.475528 (Thread-234): sending response (<Response 2122 bytes [200 OK]>) to 10.0.18.132
2022-07-04 04:12:21.447325 (MainThread): Running with dbt=1.0.8
2022-07-04 04:12:21.716500 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt_rpc.task.server.RPCServerTask'>, debug=None, defer=None, exclude=None, fail_fast=None, host='0.0.0.0', log_cache_events=False, log_format=None, models=None, partial_parse=True, port=8580, printer_width=None, profile='user', profiles_dir='/usr/src/develop/.dbt', project_dir=None, record_timing_info=None, rpc_method=None, send_anonymous_usage_stats=None, single_threaded=False, state=None, static_parser=None, target=None, threads=None, use_colors=None, use_experimental_parser=None, vars='{}', version_check=None, warn_error=None, which='rpc', write_json=None)
2022-07-04 04:12:21.721131 (MainThread): Tracking: tracking
2022-07-04 04:12:21.721456 (MainThread): 04:12:21  Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb1abc1a850>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb16d2f89d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb16d34eee0>]}
2022-07-04 04:12:21.721882 (MainThread): Serving RPC server at 0.0.0.0:8580, pid=22
2022-07-04 04:12:21.726037 (MainThread): Supported methods: ['build', 'cli_args', 'compile', 'compile_sql', 'deps', 'docs.generate', 'gc', 'get-manifest', 'kill', 'list', 'poll', 'ps', 'run', 'run-operation', 'run_sql', 'seed', 'snapshot', 'snapshot-freshness', 'source-freshness', 'status', 'test']
2022-07-04 04:12:21.726265 (MainThread): Send requests to http://localhost:8580/jsonrpc
2022-07-04 04:12:21.812465 (Thread-12): 04:12:21  Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
2022-07-04 04:12:21.812688 (Thread-12): 04:12:21  Partial parsing enabled, no changes found, skipping parsing
2022-07-04 04:12:21.813230 (Thread-12): 04:12:21  [WARNING]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.data-apps-ecommerce-template.data_model

2022-07-04 04:12:21.819569 (Thread-12): 04:12:21  Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '08022227-1dd0-4d09-94f1-e256bf2507d1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb16c1defd0>]}
2022-07-04 04:12:36.423092 (Thread-13): handling status request
2022-07-04 04:12:36.423676 (Thread-13): 04:12:36  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '08022227-1dd0-4d09-94f1-e256bf2507d1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb16d2bb5e0>]}
2022-07-04 04:12:36.424383 (Thread-13): sending response (<Response 1699 bytes [200 OK]>) to 10.0.12.141
2022-07-04 04:12:36.699974 (Thread-14): handling status request
2022-07-04 04:12:36.700369 (Thread-14): 04:12:36  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '08022227-1dd0-4d09-94f1-e256bf2507d1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb16d2bb400>]}
2022-07-04 04:12:36.700827 (Thread-14): sending response (<Response 1699 bytes [200 OK]>) to 10.0.12.141
2022-07-04 04:12:36.749589 (Thread-15): handling ps request
2022-07-04 04:12:36.749978 (Thread-15): 04:12:36  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '08022227-1dd0-4d09-94f1-e256bf2507d1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb16d2bb220>]}
2022-07-04 04:12:36.750425 (Thread-15): sending response (<Response 106 bytes [200 OK]>) to 10.0.12.141
2022-07-04 04:12:36.799164 (Thread-16): handling status request
2022-07-04 04:12:36.799533 (Thread-16): 04:12:36  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '08022227-1dd0-4d09-94f1-e256bf2507d1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb16d2bb0a0>]}
2022-07-04 04:12:36.799982 (Thread-16): sending response (<Response 1699 bytes [200 OK]>) to 10.0.12.141
2022-07-04 04:12:41.355259 (Thread-17): handling status request
2022-07-04 04:12:41.355665 (Thread-17): 04:12:41  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '08022227-1dd0-4d09-94f1-e256bf2507d1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb16c1cff10>]}
2022-07-04 04:12:41.356134 (Thread-17): sending response (<Response 1676 bytes [200 OK]>) to 10.0.12.141
2022-07-04 04:12:41.361902 (Thread-18): handling list request
2022-07-04 04:12:41.362200 (Thread-18): 04:12:41  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '08022227-1dd0-4d09-94f1-e256bf2507d1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb16c1cf610>]}
2022-07-04 04:12:41.417116 (Thread-18): 04:12:41  Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '08022227-1dd0-4d09-94f1-e256bf2507d1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb16d2bb0a0>]}
2022-07-04 04:12:41.417540 (Thread-18): 04:12:41  Found 7 models, 0 tests, 0 snapshots, 0 analyses, 179 macros, 0 operations, 0 seed files, 15 sources, 0 exposures, 0 metrics
2022-07-04 04:12:41.420712 (Thread-18): sending response (<Response 2120 bytes [200 OK]>) to 10.0.12.141
2022-07-04 04:12:41.591192 (Thread-19): handling status request
2022-07-04 04:12:41.591597 (Thread-19): 04:12:41  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '08022227-1dd0-4d09-94f1-e256bf2507d1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb16c1cfc10>]}
2022-07-04 04:12:41.592082 (Thread-19): sending response (<Response 1699 bytes [200 OK]>) to 10.0.12.141
2022-07-04 04:13:43.193763 (Thread-20): 04:13:43  Partial parsing enabled: 0 files deleted, 1 files added, 0 files changed.
2022-07-04 04:13:43.195508 (Thread-20): 04:13:43  Partial parsing: added file: ecommerce_data_model_dbt://models/data_model/temp_folder/country.sql
2022-07-04 04:13:43.206635 (Thread-20): 04:13:43  1699: static parser successfully parsed data_model/temp_folder/country.sql
2022-07-04 04:13:43.266495 (Thread-20): 04:13:43  [WARNING]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.data-apps-ecommerce-template.data_model

2022-07-04 04:13:43.271661 (Thread-20): 04:13:43  Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '08022227-1dd0-4d09-94f1-e256bf2507d1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb16c0ba190>]}
2022-07-04 04:13:43.817894 (Thread-21): handling status request
2022-07-04 04:13:43.818316 (Thread-21): 04:13:43  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '08022227-1dd0-4d09-94f1-e256bf2507d1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb16c109c40>]}
2022-07-04 04:13:43.818801 (Thread-21): sending response (<Response 2029 bytes [200 OK]>) to 10.0.12.141
2022-07-04 04:13:43.825053 (Thread-22): handling list request
2022-07-04 04:13:43.825338 (Thread-22): 04:13:43  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '08022227-1dd0-4d09-94f1-e256bf2507d1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb16c109610>]}
2022-07-04 04:13:43.845871 (Thread-23): handling status request
2022-07-04 04:13:43.846123 (Thread-23): 04:13:43  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '08022227-1dd0-4d09-94f1-e256bf2507d1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb16d2bb6a0>]}
2022-07-04 04:13:43.846566 (Thread-23): sending response (<Response 2029 bytes [200 OK]>) to 10.0.12.141
2022-07-04 04:13:43.849850 (Thread-22): 04:13:43  Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '08022227-1dd0-4d09-94f1-e256bf2507d1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb16c0de370>]}
2022-07-04 04:13:43.850158 (Thread-22): 04:13:43  Found 8 models, 0 tests, 0 snapshots, 0 analyses, 179 macros, 0 operations, 0 seed files, 15 sources, 0 exposures, 0 metrics
2022-07-04 04:13:43.851292 (Thread-22): 04:13:43  The selection criterion '+models/data_model/temp_folder/country.sql+' does not match any nodes
2022-07-04 04:13:43.851444 (Thread-22): 04:13:43  No nodes selected!
2022-07-04 04:13:43.853313 (Thread-22): sending response (<Response 3280 bytes [200 OK]>) to 10.0.12.141
2022-07-04 04:13:43.869504 (Thread-24): handling list request
2022-07-04 04:13:43.869804 (Thread-24): 04:13:43  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '08022227-1dd0-4d09-94f1-e256bf2507d1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb16d3204c0>]}
2022-07-04 04:13:43.897790 (Thread-24): 04:13:43  Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '08022227-1dd0-4d09-94f1-e256bf2507d1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb16c0ba1f0>]}
2022-07-04 04:13:43.898152 (Thread-24): 04:13:43  Found 8 models, 0 tests, 0 snapshots, 0 analyses, 179 macros, 0 operations, 0 seed files, 15 sources, 0 exposures, 0 metrics
2022-07-04 04:13:43.900868 (Thread-24): sending response (<Response 2120 bytes [200 OK]>) to 10.0.12.141
2022-07-04 04:13:44.038043 (Thread-25): handling status request
2022-07-04 04:13:44.038438 (Thread-25): 04:13:44  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '08022227-1dd0-4d09-94f1-e256bf2507d1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb16c0dea60>]}
2022-07-04 04:13:44.038927 (Thread-25): sending response (<Response 2052 bytes [200 OK]>) to 10.0.12.141
2022-07-04 04:13:44.089830 (Thread-26): handling status request
2022-07-04 04:13:44.090253 (Thread-26): 04:13:44  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '08022227-1dd0-4d09-94f1-e256bf2507d1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb16c0baca0>]}
2022-07-04 04:13:44.090718 (Thread-26): sending response (<Response 2052 bytes [200 OK]>) to 10.0.12.141
2022-07-04 04:13:45.261859 (Thread-27): handling status request
2022-07-04 04:13:45.262306 (Thread-27): 04:13:45  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '08022227-1dd0-4d09-94f1-e256bf2507d1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb16c0ba3d0>]}
2022-07-04 04:13:45.262782 (Thread-27): sending response (<Response 2029 bytes [200 OK]>) to 10.0.12.141
2022-07-04 04:13:45.268564 (Thread-28): handling list request
2022-07-04 04:13:45.268831 (Thread-28): 04:13:45  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '08022227-1dd0-4d09-94f1-e256bf2507d1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb16c0bab80>]}
2022-07-04 04:13:45.304155 (Thread-28): 04:13:45  Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '08022227-1dd0-4d09-94f1-e256bf2507d1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb16c0af9a0>]}
2022-07-04 04:13:45.304635 (Thread-28): 04:13:45  Found 8 models, 0 tests, 0 snapshots, 0 analyses, 179 macros, 0 operations, 0 seed files, 15 sources, 0 exposures, 0 metrics
2022-07-04 04:13:45.307117 (Thread-28): sending response (<Response 2028 bytes [200 OK]>) to 10.0.12.141
2022-07-04 04:13:51.355380 (Thread-29): handling status request
2022-07-04 04:13:51.355785 (Thread-29): 04:13:51  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '08022227-1dd0-4d09-94f1-e256bf2507d1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb16c1ed8e0>]}
2022-07-04 04:13:51.356308 (Thread-29): sending response (<Response 2029 bytes [200 OK]>) to 10.0.12.141
2022-07-04 04:13:51.362472 (Thread-30): handling list request
2022-07-04 04:13:51.362798 (Thread-30): 04:13:51  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '08022227-1dd0-4d09-94f1-e256bf2507d1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb16c0afca0>]}
2022-07-04 04:13:51.420005 (Thread-30): 04:13:51  Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '08022227-1dd0-4d09-94f1-e256bf2507d1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb16c0a68e0>]}
2022-07-04 04:13:51.420455 (Thread-30): 04:13:51  Found 8 models, 0 tests, 0 snapshots, 0 analyses, 179 macros, 0 operations, 0 seed files, 15 sources, 0 exposures, 0 metrics
2022-07-04 04:13:51.424184 (Thread-30): sending response (<Response 2040 bytes [200 OK]>) to 10.0.12.141
2022-07-04 04:16:42.765343 (Thread-31): 04:16:42  Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
2022-07-04 04:16:42.767422 (Thread-31): 04:16:42  Partial parsing: updated file: ecommerce_data_model_dbt://models/data_model/temp_folder/country.sql
2022-07-04 04:16:42.771994 (Thread-31): 04:16:42  1603: static parser failed on data_model/temp_folder/country.sql
2022-07-04 04:16:42.775963 (Thread-31): 04:16:42  1602: parser fallback to jinja rendering on data_model/temp_folder/country.sql
2022-07-04 04:16:42.810859 (Thread-31): 04:16:42  [WARNING]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.data-apps-ecommerce-template.data_model

2022-07-04 04:16:42.816351 (Thread-31): 04:16:42  Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '08022227-1dd0-4d09-94f1-e256bf2507d1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb160759940>]}
2022-07-04 04:16:43.290212 (Thread-32): handling status request
2022-07-04 04:16:43.290630 (Thread-32): 04:16:43  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '08022227-1dd0-4d09-94f1-e256bf2507d1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb16c063250>]}
2022-07-04 04:16:43.291144 (Thread-32): sending response (<Response 2340 bytes [200 OK]>) to 10.0.12.141
2022-07-04 04:16:43.322229 (Thread-33): handling list request
2022-07-04 04:16:43.322641 (Thread-33): 04:16:43  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '08022227-1dd0-4d09-94f1-e256bf2507d1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb16c0630d0>]}
2022-07-04 04:16:43.354024 (Thread-33): 04:16:43  Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '08022227-1dd0-4d09-94f1-e256bf2507d1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb16c0a6e50>]}
2022-07-04 04:16:43.354413 (Thread-33): 04:16:43  Found 8 models, 0 tests, 0 snapshots, 0 analyses, 179 macros, 0 operations, 0 seed files, 15 sources, 0 exposures, 0 metrics
2022-07-04 04:16:43.357383 (Thread-33): sending response (<Response 2044 bytes [200 OK]>) to 10.0.12.141
2022-07-04 04:16:43.598524 (Thread-34): handling status request
2022-07-04 04:16:43.598971 (Thread-34): 04:16:43  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '08022227-1dd0-4d09-94f1-e256bf2507d1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb16079af70>]}
2022-07-04 04:16:43.606073 (Thread-35): handling status request
2022-07-04 04:16:43.606452 (Thread-35): 04:16:43  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '08022227-1dd0-4d09-94f1-e256bf2507d1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb160758be0>]}
2022-07-04 04:16:43.619137 (Thread-34): sending response (<Response 2363 bytes [200 OK]>) to 10.0.12.141
2022-07-04 04:16:43.619595 (Thread-35): sending response (<Response 2363 bytes [200 OK]>) to 10.0.12.141
2022-07-04 04:16:43.867236 (Thread-36): handling status request
2022-07-04 04:16:43.867659 (Thread-36): 04:16:43  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '08022227-1dd0-4d09-94f1-e256bf2507d1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb16079a730>]}
2022-07-04 04:16:43.868191 (Thread-36): sending response (<Response 2340 bytes [200 OK]>) to 10.0.12.141
2022-07-04 04:16:43.873192 (Thread-37): handling list request
2022-07-04 04:16:43.873501 (Thread-37): 04:16:43  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '08022227-1dd0-4d09-94f1-e256bf2507d1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb160759760>]}
2022-07-04 04:16:43.904554 (Thread-37): 04:16:43  Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '08022227-1dd0-4d09-94f1-e256bf2507d1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb16079afd0>]}
2022-07-04 04:16:43.904946 (Thread-37): 04:16:43  Found 8 models, 0 tests, 0 snapshots, 0 analyses, 179 macros, 0 operations, 0 seed files, 15 sources, 0 exposures, 0 metrics
2022-07-04 04:16:43.907738 (Thread-37): sending response (<Response 2040 bytes [200 OK]>) to 10.0.12.141
2022-07-04 04:16:45.473071 (Thread-38): 04:16:45  Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
2022-07-04 04:16:45.473295 (Thread-38): 04:16:45  Partial parsing enabled, no changes found, skipping parsing
2022-07-04 04:16:45.473816 (Thread-38): 04:16:45  [WARNING]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.data-apps-ecommerce-template.data_model

2022-07-04 04:16:45.479447 (Thread-38): 04:16:45  Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '08022227-1dd0-4d09-94f1-e256bf2507d1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb160682fd0>]}
2022-07-04 04:16:46.217223 (Thread-39): handling status request
2022-07-04 04:16:46.217646 (Thread-39): 04:16:46  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '08022227-1dd0-4d09-94f1-e256bf2507d1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb16067fbb0>]}
2022-07-04 04:16:46.218181 (Thread-39): sending response (<Response 1699 bytes [200 OK]>) to 10.0.12.141
2022-07-04 04:16:46.311188 (Thread-40): handling status request
2022-07-04 04:16:46.311588 (Thread-40): 04:16:46  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '08022227-1dd0-4d09-94f1-e256bf2507d1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb16067faf0>]}
2022-07-04 04:16:46.312054 (Thread-40): sending response (<Response 1676 bytes [200 OK]>) to 10.0.12.141
2022-07-04 04:16:46.319665 (Thread-41): handling list request
2022-07-04 04:16:46.319986 (Thread-41): 04:16:46  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '08022227-1dd0-4d09-94f1-e256bf2507d1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb16079ad00>]}
2022-07-04 04:16:46.350197 (Thread-41): 04:16:46  Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '08022227-1dd0-4d09-94f1-e256bf2507d1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb160683280>]}
2022-07-04 04:16:46.350542 (Thread-41): 04:16:46  Found 8 models, 0 tests, 0 snapshots, 0 analyses, 179 macros, 0 operations, 0 seed files, 15 sources, 0 exposures, 0 metrics
2022-07-04 04:16:46.353321 (Thread-41): sending response (<Response 2028 bytes [200 OK]>) to 10.0.12.141
2022-07-04 04:16:46.363576 (Thread-42): handling status request
2022-07-04 04:16:46.363890 (Thread-42): 04:16:46  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '08022227-1dd0-4d09-94f1-e256bf2507d1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb16067ffa0>]}
2022-07-04 04:16:46.364324 (Thread-42): sending response (<Response 1699 bytes [200 OK]>) to 10.0.12.141
2022-07-04 04:16:47.864503 (Thread-43): 04:16:47  Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
2022-07-04 04:16:47.864727 (Thread-43): 04:16:47  Partial parsing enabled, no changes found, skipping parsing
2022-07-04 04:16:47.865236 (Thread-43): 04:16:47  [WARNING]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.data-apps-ecommerce-template.data_model

2022-07-04 04:16:47.870846 (Thread-43): 04:16:47  Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '08022227-1dd0-4d09-94f1-e256bf2507d1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb160639f10>]}
2022-07-04 04:16:48.745959 (Thread-44): handling status request
2022-07-04 04:16:48.746360 (Thread-44): 04:16:48  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '08022227-1dd0-4d09-94f1-e256bf2507d1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb160683940>]}
2022-07-04 04:16:48.746845 (Thread-44): sending response (<Response 1699 bytes [200 OK]>) to 10.0.12.141
2022-07-04 04:16:48.780016 (Thread-45): handling status request
2022-07-04 04:16:48.780355 (Thread-45): 04:16:48  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '08022227-1dd0-4d09-94f1-e256bf2507d1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb16c09c220>]}
2022-07-04 04:16:48.780794 (Thread-45): sending response (<Response 1699 bytes [200 OK]>) to 10.0.12.141
2022-07-04 04:16:51.977986 (Thread-46): handling status request
2022-07-04 04:16:51.978495 (Thread-46): 04:16:51  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '08022227-1dd0-4d09-94f1-e256bf2507d1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb16c0e1d60>]}
2022-07-04 04:16:51.979005 (Thread-46): sending response (<Response 1699 bytes [200 OK]>) to 10.0.12.141
2022-07-04 04:16:52.357855 (Thread-47): handling run_sql request
2022-07-04 04:16:52.358373 (Thread-47): 04:16:52  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '08022227-1dd0-4d09-94f1-e256bf2507d1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb16067fe20>]}
2022-07-04 04:16:54.734421 (Thread-47): sending response (<Response 139 bytes [200 OK]>) to 10.0.12.141
2022-07-04 04:16:54.759304 (MainThread): 04:16:54  Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '6cf3f209-d123-41c3-9d58-55ea9e3da2ef', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f13979c92b0>]}
2022-07-04 04:16:54.759853 (MainThread): 04:16:54  Found 8 models, 0 tests, 0 snapshots, 0 analyses, 179 macros, 0 operations, 0 seed files, 15 sources, 0 exposures, 0 metrics
2022-07-04 04:16:54.760444 (Thread-1): 04:16:54  Acquiring new snowflake connection "rpc.ecommerce_data_model_dbt.request"
2022-07-04 04:16:54.760577 (Thread-1): 04:16:54  Began compiling node rpc.ecommerce_data_model_dbt.request
2022-07-04 04:16:54.760670 (Thread-1): 04:16:54  Compiling rpc.ecommerce_data_model_dbt.request
2022-07-04 04:16:54.763220 (Thread-1): 04:16:54  finished collecting timing info
2022-07-04 04:16:54.763350 (Thread-1): 04:16:54  Began executing node rpc.ecommerce_data_model_dbt.request
2022-07-04 04:16:54.764124 (Thread-1): 04:16:54  Using snowflake connection "rpc.ecommerce_data_model_dbt.request"
2022-07-04 04:16:54.764212 (Thread-1): 04:16:54  On rpc.ecommerce_data_model_dbt.request: select user_id, country from 
(select user_id, properties_country as country, row_number() over(partition by user_id order by timestamp desc) as rn from 
analytics_db.data_apps_simulated.identifies where timestamp >= '2021-05-01' and timestamp <= '2022-06-29'
and properties_country is not null and properties_country != '') where rn = 1
limit 500
/* limit added automatically by dbt cloud */
2022-07-04 04:16:54.764293 (Thread-1): 04:16:54  Opening a new connection, currently in state init
2022-07-04 04:16:55.108527 (Thread-48): handling poll request
2022-07-04 04:16:55.109028 (Thread-48): 04:16:55  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '08022227-1dd0-4d09-94f1-e256bf2507d1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb16062fbb0>]}
2022-07-04 04:16:55.109997 (Thread-48): sending response (<Response 4125 bytes [200 OK]>) to 10.0.12.141
2022-07-04 04:16:56.438374 (Thread-1): 04:16:56  SQL status: SUCCESS 5 in 1.67 seconds
2022-07-04 04:16:56.439768 (Thread-1): 04:16:56  finished collecting timing info
2022-07-04 04:16:56.439955 (Thread-1): 04:16:56  On rpc.ecommerce_data_model_dbt.request: Close
2022-07-04 04:16:56.488507 (Thread-49): handling poll request
2022-07-04 04:16:56.488940 (Thread-49): 04:16:56  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '08022227-1dd0-4d09-94f1-e256bf2507d1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb16062f880>]}
2022-07-04 04:16:56.489499 (Thread-49): sending response (<Response 1388 bytes [200 OK]>) to 10.0.12.141
2022-07-04 04:16:57.960213 (Thread-50): handling poll request
2022-07-04 04:16:57.960627 (Thread-50): 04:16:57  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '08022227-1dd0-4d09-94f1-e256bf2507d1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb1606233d0>]}
2022-07-04 04:16:57.961509 (Thread-50): sending response (<Response 3963 bytes [200 OK]>) to 10.0.12.141
2022-07-04 04:19:42.098532 (Thread-51): handling status request
2022-07-04 04:19:42.100794 (Thread-51): 04:19:42  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '08022227-1dd0-4d09-94f1-e256bf2507d1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb160623610>]}
2022-07-04 04:19:42.101340 (Thread-51): sending response (<Response 1699 bytes [200 OK]>) to 10.0.12.141
2022-07-04 04:19:42.481408 (Thread-52): handling compile_sql request
2022-07-04 04:19:42.481813 (Thread-52): 04:19:42  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '08022227-1dd0-4d09-94f1-e256bf2507d1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb1606236d0>]}
2022-07-04 04:19:44.859336 (Thread-52): sending response (<Response 139 bytes [200 OK]>) to 10.0.12.141
2022-07-04 04:19:44.887612 (MainThread): 04:19:44  Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '3ffa49c0-bdd4-4efe-ad5e-06f8c41829b7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3a760693a0>]}
2022-07-04 04:19:44.888179 (MainThread): 04:19:44  Found 8 models, 0 tests, 0 snapshots, 0 analyses, 179 macros, 0 operations, 0 seed files, 15 sources, 0 exposures, 0 metrics
2022-07-04 04:19:44.888779 (Thread-1): 04:19:44  Acquiring new snowflake connection "rpc.ecommerce_data_model_dbt.request"
2022-07-04 04:19:44.888915 (Thread-1): 04:19:44  Began compiling node rpc.ecommerce_data_model_dbt.request
2022-07-04 04:19:44.889006 (Thread-1): 04:19:44  Compiling rpc.ecommerce_data_model_dbt.request
2022-07-04 04:19:44.892901 (Thread-1): 04:19:44  finished collecting timing info
2022-07-04 04:19:44.893032 (Thread-1): 04:19:44  Began executing node rpc.ecommerce_data_model_dbt.request
2022-07-04 04:19:44.893131 (Thread-1): 04:19:44  finished collecting timing info
2022-07-04 04:19:45.255245 (Thread-53): handling poll request
2022-07-04 04:19:45.255708 (Thread-53): 04:19:45  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '08022227-1dd0-4d09-94f1-e256bf2507d1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb1606299d0>]}
2022-07-04 04:19:45.257540 (Thread-53): sending response (<Response 11262 bytes [200 OK]>) to 10.0.12.141
2022-07-04 04:19:50.224372 (Thread-54): handling status request
2022-07-04 04:19:50.224774 (Thread-54): 04:19:50  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '08022227-1dd0-4d09-94f1-e256bf2507d1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb160639e80>]}
2022-07-04 04:19:50.225302 (Thread-54): sending response (<Response 1699 bytes [200 OK]>) to 10.0.12.141
2022-07-04 04:19:50.614114 (Thread-55): handling run_sql request
2022-07-04 04:19:50.614542 (Thread-55): 04:19:50  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '08022227-1dd0-4d09-94f1-e256bf2507d1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb16062f6a0>]}
2022-07-04 04:19:52.945569 (Thread-55): sending response (<Response 139 bytes [200 OK]>) to 10.0.12.141
2022-07-04 04:19:52.972626 (MainThread): 04:19:52  Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'ea0890ae-670f-4e73-8a0f-7514a0f9b4cc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f402f2c7400>]}
2022-07-04 04:19:52.973191 (MainThread): 04:19:52  Found 8 models, 0 tests, 0 snapshots, 0 analyses, 179 macros, 0 operations, 0 seed files, 15 sources, 0 exposures, 0 metrics
2022-07-04 04:19:52.973812 (Thread-1): 04:19:52  Acquiring new snowflake connection "rpc.ecommerce_data_model_dbt.request"
2022-07-04 04:19:52.973980 (Thread-1): 04:19:52  Began compiling node rpc.ecommerce_data_model_dbt.request
2022-07-04 04:19:52.974080 (Thread-1): 04:19:52  Compiling rpc.ecommerce_data_model_dbt.request
2022-07-04 04:19:52.978346 (Thread-1): 04:19:52  finished collecting timing info
2022-07-04 04:19:52.978485 (Thread-1): 04:19:52  Began executing node rpc.ecommerce_data_model_dbt.request
2022-07-04 04:19:52.980419 (Thread-1): 04:19:52  Using snowflake connection "rpc.ecommerce_data_model_dbt.request"
2022-07-04 04:19:52.980519 (Thread-1): 04:19:52  On rpc.ecommerce_data_model_dbt.request: with cte_gender as 
(select user_id, gender from 
(select user_id, properties_gender as gender, row_number() over(partition by user_id order by timestamp desc) as rn from 
analytics_db.data_apps_simulated.identifies where timestamp >= '2021-05-01' and timestamp <= '2022-06-29'
and properties_gender is not null and properties_gender != '') where rn = 1),

cte_age as 
(select user_id, age from
(select user_id, 
(CASE WHEN dateadd(year, datediff (year, properties_birthday, getdate()), properties_birthday) > getdate()
      THEN datediff(year, properties_birthday, getdate()) - 1
      ELSE datediff(year, properties_birthday, getdate())
 END) as age, 
row_number() over(partition by user_id order by timestamp desc) as rn 
from analytics_db.data_apps_simulated.identifies where timestamp >= '2021-05-01' and timestamp <= '2022-06-29'
and properties_birthday is not null and properties_birthday!=''), 
where rn=1)

ctg_country as 
(select user_id, country from 
(select user_id, properties_country as country, row_number() over(partition by user_id order by timestamp desc) as rn from 
analytics_db.data_apps_simulated.identifies where timestamp >= '2021-05-01' and timestamp <= '2022-06-29'
and properties_country is not null and properties_country != '') where rn = 1)

select coalesce(a.user_id, b.user_id) as user_id, gender, age from cte_gender a full outer join cte_age b on a.user_id = b.user_id
limit 500
/* limit added automatically by dbt cloud */
2022-07-04 04:19:52.980605 (Thread-1): 04:19:52  Opening a new connection, currently in state init
2022-07-04 04:19:53.343541 (Thread-56): handling poll request
2022-07-04 04:19:53.344009 (Thread-56): 04:19:53  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '08022227-1dd0-4d09-94f1-e256bf2507d1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb16062a2b0>]}
2022-07-04 04:19:53.344857 (Thread-56): sending response (<Response 5209 bytes [200 OK]>) to 10.0.12.141
2022-07-04 04:19:53.688080 (Thread-1): 04:19:53  Snowflake adapter: Snowflake query id: 01a55fa3-0602-3256-0019-82030465bae6
2022-07-04 04:19:53.688279 (Thread-1): 04:19:53  Snowflake adapter: Snowflake error: 001003 (42000): SQL compilation error:
syntax error line 17 at position 0 unexpected 'where'.
syntax error line 19 at position 0 unexpected 'ctg_country'.
syntax error line 21 at position 110 unexpected ')'.
2022-07-04 04:19:53.688444 (Thread-1): 04:19:53  finished collecting timing info
2022-07-04 04:19:53.688599 (Thread-1): 04:19:53  On rpc.ecommerce_data_model_dbt.request: Close
2022-07-04 04:19:53.745458 (Thread-1): Got an exception: Database Error
  001003 (42000): SQL compilation error:
  syntax error line 17 at position 0 unexpected 'where'.
  syntax error line 19 at position 0 unexpected 'ctg_country'.
  syntax error line 21 at position 110 unexpected ')'.
Traceback (most recent call last):
  File "/usr/local/lib/python3.8/dist-packages/dbt/adapters/snowflake/connections.py", line 206, in exception_handler
    yield
  File "/usr/local/lib/python3.8/dist-packages/dbt/adapters/sql/connections.py", line 74, in add_query
    cursor.execute(sql, bindings)
  File "/usr/local/lib/python3.8/dist-packages/snowflake/connector/cursor.py", line 721, in execute
    Error.errorhandler_wrapper(
  File "/usr/local/lib/python3.8/dist-packages/snowflake/connector/errors.py", line 258, in errorhandler_wrapper
    cursor.errorhandler(connection, cursor, error_class, error_value)
  File "/usr/local/lib/python3.8/dist-packages/snowflake/connector/errors.py", line 188, in default_errorhandler
    raise error_class(
snowflake.connector.errors.ProgrammingError: 001003 (42000): SQL compilation error:
syntax error line 17 at position 0 unexpected 'where'.
syntax error line 19 at position 0 unexpected 'ctg_country'.
syntax error line 21 at position 110 unexpected ')'.

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/usr/local/lib/python3.8/dist-packages/dbt/task/base.py", line 361, in safe_run
    result = self.compile_and_execute(manifest, ctx)
  File "/usr/local/lib/python3.8/dist-packages/dbt/task/base.py", line 314, in compile_and_execute
    result = self.run(ctx.node, manifest)
  File "/usr/local/lib/python3.8/dist-packages/dbt/task/base.py", line 403, in run
    return self.execute(compiled_node, manifest)
  File "/usr/local/lib/python3.8/dist-packages/dbt_rpc/rpc/node_runners.py", line 90, in execute
    _, execute_result = self.adapter.execute(
  File "/usr/local/lib/python3.8/dist-packages/dbt/adapters/base/impl.py", line 225, in execute
    return self.connections.execute(
  File "/usr/local/lib/python3.8/dist-packages/dbt/adapters/sql/connections.py", line 127, in execute
    _, cursor = self.add_query(sql, auto_begin)
  File "/usr/local/lib/python3.8/dist-packages/dbt/adapters/snowflake/connections.py", line 433, in add_query
    connection, cursor = super().add_query(
  File "/usr/local/lib/python3.8/dist-packages/dbt/adapters/sql/connections.py", line 83, in add_query
    return connection, cursor
  File "/usr/lib/python3.8/contextlib.py", line 131, in __exit__
    self.gen.throw(type, value, traceback)
  File "/usr/local/lib/python3.8/dist-packages/dbt/adapters/snowflake/connections.py", line 223, in exception_handler
    raise DatabaseException(msg)
dbt.exceptions.DatabaseException: Database Error
  001003 (42000): SQL compilation error:
  syntax error line 17 at position 0 unexpected 'where'.
  syntax error line 19 at position 0 unexpected 'ctg_country'.
  syntax error line 21 at position 110 unexpected ')'.
2022-07-04 04:19:53.746484 (Thread-1): Got exception RPCException(10003, Database Error, {'type': 'DatabaseException', 'message': "Database Error in rpc request (from remote system)\n  001003 (42000): SQL compilation error:\n  syntax error line 17 at position 0 unexpected 'where'.\n  syntax error line 19 at position 0 unexpected 'ctg_country'.\n  syntax error line 21 at position 110 unexpected ')'.", 'raw_sql': "with cte_gender as \n(select user_id, gender from \n(select user_id, properties_gender as gender, row_number() over(partition by user_id order by timestamp desc) as rn from \n{{ source('ecommerce', 'identifies') }} where timestamp >= '{{ var('start_date') }}' and timestamp <= '{{ var('end_date') }}'\nand properties_gender is not null and properties_gender != '') where rn = 1),\n\ncte_age as \n(select user_id, age from\n(select user_id, \n(CASE WHEN dateadd(year, datediff (year, properties_birthday, getdate()), properties_birthday) > getdate()\n      THEN datediff(year, properties_birthday, getdate()) - 1\n      ELSE datediff(year, properties_birthday, getdate())\n END) as age, \nrow_number() over(partition by user_id order by timestamp desc) as rn \nfrom {{ source('ecommerce', 'identifies') }} where timestamp >= '{{ var('start_date') }}' and timestamp <= '{{ var('end_date') }}'\nand properties_birthday is not null and properties_birthday!=''), \nwhere rn=1)\n\nctg_country as \n(select user_id, country from \n(select user_id, properties_country as country, row_number() over(partition by user_id order by timestamp desc) as rn from \n{{ source('ecommerce', 'identifies') }} where timestamp >= '{{ var('start_date') }}' and timestamp <= '{{ var('end_date') }}'\nand properties_country is not null and properties_country != '') where rn = 1)\n\nselect coalesce(a.user_id, b.user_id) as user_id, gender, age from cte_gender a full outer join cte_age b on a.user_id = b.user_id\nlimit 500\n/* limit added automatically by dbt cloud */", 'compiled_sql': "with cte_gender as \n(select user_id, gender from \n(select user_id, properties_gender as gender, row_number() over(partition by user_id order by timestamp desc) as rn from \nanalytics_db.data_apps_simulated.identifies where timestamp >= '2021-05-01' and timestamp <= '2022-06-29'\nand properties_gender is not null and properties_gender != '') where rn = 1),\n\ncte_age as \n(select user_id, age from\n(select user_id, \n(CASE WHEN dateadd(year, datediff (year, properties_birthday, getdate()), properties_birthday) > getdate()\n      THEN datediff(year, properties_birthday, getdate()) - 1\n      ELSE datediff(year, properties_birthday, getdate())\n END) as age, \nrow_number() over(partition by user_id order by timestamp desc) as rn \nfrom analytics_db.data_apps_simulated.identifies where timestamp >= '2021-05-01' and timestamp <= '2022-06-29'\nand properties_birthday is not null and properties_birthday!=''), \nwhere rn=1)\n\nctg_country as \n(select user_id, country from \n(select user_id, properties_country as country, row_number() over(partition by user_id order by timestamp desc) as rn from \nanalytics_db.data_apps_simulated.identifies where timestamp >= '2021-05-01' and timestamp <= '2022-06-29'\nand properties_country is not null and properties_country != '') where rn = 1)\n\nselect coalesce(a.user_id, b.user_id) as user_id, gender, age from cte_gender a full outer join cte_age b on a.user_id = b.user_id\nlimit 500\n/* limit added automatically by dbt cloud */", 'tags': None}, None)
Traceback (most recent call last):
  File "/usr/local/lib/python3.8/dist-packages/dbt_rpc/task/sql_commands.py", line 147, in _in_thread
    self.node_results.append(runner.safe_run(self.manifest))
  File "/usr/local/lib/python3.8/dist-packages/dbt/task/base.py", line 377, in safe_run
    result = self.error_result(ctx.node, error, started, [])
  File "/usr/local/lib/python3.8/dist-packages/dbt_rpc/rpc/node_runners.py", line 56, in error_result
    raise error
dbt_rpc.rpc.error.RPCException: RPCException(10003, Database Error, {'type': 'DatabaseException', 'message': "Database Error in rpc request (from remote system)\n  001003 (42000): SQL compilation error:\n  syntax error line 17 at position 0 unexpected 'where'.\n  syntax error line 19 at position 0 unexpected 'ctg_country'.\n  syntax error line 21 at position 110 unexpected ')'.", 'raw_sql': "with cte_gender as \n(select user_id, gender from \n(select user_id, properties_gender as gender, row_number() over(partition by user_id order by timestamp desc) as rn from \n{{ source('ecommerce', 'identifies') }} where timestamp >= '{{ var('start_date') }}' and timestamp <= '{{ var('end_date') }}'\nand properties_gender is not null and properties_gender != '') where rn = 1),\n\ncte_age as \n(select user_id, age from\n(select user_id, \n(CASE WHEN dateadd(year, datediff (year, properties_birthday, getdate()), properties_birthday) > getdate()\n      THEN datediff(year, properties_birthday, getdate()) - 1\n      ELSE datediff(year, properties_birthday, getdate())\n END) as age, \nrow_number() over(partition by user_id order by timestamp desc) as rn \nfrom {{ source('ecommerce', 'identifies') }} where timestamp >= '{{ var('start_date') }}' and timestamp <= '{{ var('end_date') }}'\nand properties_birthday is not null and properties_birthday!=''), \nwhere rn=1)\n\nctg_country as \n(select user_id, country from \n(select user_id, properties_country as country, row_number() over(partition by user_id order by timestamp desc) as rn from \n{{ source('ecommerce', 'identifies') }} where timestamp >= '{{ var('start_date') }}' and timestamp <= '{{ var('end_date') }}'\nand properties_country is not null and properties_country != '') where rn = 1)\n\nselect coalesce(a.user_id, b.user_id) as user_id, gender, age from cte_gender a full outer join cte_age b on a.user_id = b.user_id\nlimit 500\n/* limit added automatically by dbt cloud */", 'compiled_sql': "with cte_gender as \n(select user_id, gender from \n(select user_id, properties_gender as gender, row_number() over(partition by user_id order by timestamp desc) as rn from \nanalytics_db.data_apps_simulated.identifies where timestamp >= '2021-05-01' and timestamp <= '2022-06-29'\nand properties_gender is not null and properties_gender != '') where rn = 1),\n\ncte_age as \n(select user_id, age from\n(select user_id, \n(CASE WHEN dateadd(year, datediff (year, properties_birthday, getdate()), properties_birthday) > getdate()\n      THEN datediff(year, properties_birthday, getdate()) - 1\n      ELSE datediff(year, properties_birthday, getdate())\n END) as age, \nrow_number() over(partition by user_id order by timestamp desc) as rn \nfrom analytics_db.data_apps_simulated.identifies where timestamp >= '2021-05-01' and timestamp <= '2022-06-29'\nand properties_birthday is not null and properties_birthday!=''), \nwhere rn=1)\n\nctg_country as \n(select user_id, country from \n(select user_id, properties_country as country, row_number() over(partition by user_id order by timestamp desc) as rn from \nanalytics_db.data_apps_simulated.identifies where timestamp >= '2021-05-01' and timestamp <= '2022-06-29'\nand properties_country is not null and properties_country != '') where rn = 1)\n\nselect coalesce(a.user_id, b.user_id) as user_id, gender, age from cte_gender a full outer join cte_age b on a.user_id = b.user_id\nlimit 500\n/* limit added automatically by dbt cloud */", 'tags': None}, None)
2022-07-04 04:19:54.711471 (Thread-57): handling poll request
2022-07-04 04:19:54.711918 (Thread-57): 04:19:54  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '08022227-1dd0-4d09-94f1-e256bf2507d1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb16062a5b0>]}
2022-07-04 04:19:54.712593 (Thread-57): sending response (<Response 20872 bytes [200 OK]>) to 10.0.12.141
2022-07-04 04:22:26.137054 (Thread-58): handling status request
2022-07-04 04:22:26.139774 (Thread-58): 04:22:26  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '08022227-1dd0-4d09-94f1-e256bf2507d1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb16062aa30>]}
2022-07-04 04:22:26.140308 (Thread-58): sending response (<Response 1699 bytes [200 OK]>) to 10.0.12.141
2022-07-04 04:22:26.528144 (Thread-59): handling compile_sql request
2022-07-04 04:22:26.528561 (Thread-59): 04:22:26  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '08022227-1dd0-4d09-94f1-e256bf2507d1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb16062ac10>]}
2022-07-04 04:22:28.859447 (Thread-59): sending response (<Response 139 bytes [200 OK]>) to 10.0.12.141
2022-07-04 04:22:28.887516 (MainThread): 04:22:28  Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'f470a47e-abf9-40a9-8d5a-ee21dc6693f9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f08b9308310>]}
2022-07-04 04:22:28.888043 (MainThread): 04:22:28  Found 8 models, 0 tests, 0 snapshots, 0 analyses, 179 macros, 0 operations, 0 seed files, 15 sources, 0 exposures, 0 metrics
2022-07-04 04:22:28.888628 (Thread-1): 04:22:28  Acquiring new snowflake connection "rpc.ecommerce_data_model_dbt.request"
2022-07-04 04:22:28.888758 (Thread-1): 04:22:28  Began compiling node rpc.ecommerce_data_model_dbt.request
2022-07-04 04:22:28.888850 (Thread-1): 04:22:28  Compiling rpc.ecommerce_data_model_dbt.request
2022-07-04 04:22:28.892707 (Thread-1): 04:22:28  finished collecting timing info
2022-07-04 04:22:28.892834 (Thread-1): 04:22:28  Began executing node rpc.ecommerce_data_model_dbt.request
2022-07-04 04:22:28.892932 (Thread-1): 04:22:28  finished collecting timing info
2022-07-04 04:22:29.259030 (Thread-60): handling poll request
2022-07-04 04:22:29.259496 (Thread-60): 04:22:29  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '08022227-1dd0-4d09-94f1-e256bf2507d1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb1605b0e50>]}
2022-07-04 04:22:29.260644 (Thread-60): sending response (<Response 11517 bytes [200 OK]>) to 10.0.12.141
2022-07-04 04:22:33.709000 (Thread-61): handling status request
2022-07-04 04:22:33.709425 (Thread-61): 04:22:33  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '08022227-1dd0-4d09-94f1-e256bf2507d1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb1605b0fa0>]}
2022-07-04 04:22:33.709968 (Thread-61): sending response (<Response 1699 bytes [200 OK]>) to 10.0.12.141
2022-07-04 04:22:34.070862 (Thread-62): handling run_sql request
2022-07-04 04:22:34.071275 (Thread-62): 04:22:34  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '08022227-1dd0-4d09-94f1-e256bf2507d1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb1605b4130>]}
2022-07-04 04:22:36.427909 (Thread-62): sending response (<Response 139 bytes [200 OK]>) to 10.0.12.141
2022-07-04 04:22:36.455147 (MainThread): 04:22:36  Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '7af8783d-97f4-47e4-a176-0e3ff457fa50', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2b22949250>]}
2022-07-04 04:22:36.455723 (MainThread): 04:22:36  Found 8 models, 0 tests, 0 snapshots, 0 analyses, 179 macros, 0 operations, 0 seed files, 15 sources, 0 exposures, 0 metrics
2022-07-04 04:22:36.456323 (Thread-1): 04:22:36  Acquiring new snowflake connection "rpc.ecommerce_data_model_dbt.request"
2022-07-04 04:22:36.456457 (Thread-1): 04:22:36  Began compiling node rpc.ecommerce_data_model_dbt.request
2022-07-04 04:22:36.456550 (Thread-1): 04:22:36  Compiling rpc.ecommerce_data_model_dbt.request
2022-07-04 04:22:36.460488 (Thread-1): 04:22:36  finished collecting timing info
2022-07-04 04:22:36.460625 (Thread-1): 04:22:36  Began executing node rpc.ecommerce_data_model_dbt.request
2022-07-04 04:22:36.462651 (Thread-1): 04:22:36  Using snowflake connection "rpc.ecommerce_data_model_dbt.request"
2022-07-04 04:22:36.462753 (Thread-1): 04:22:36  On rpc.ecommerce_data_model_dbt.request: with cte_gender as 
(select user_id, gender from 
(select user_id, properties_gender as gender, row_number() over(partition by user_id order by timestamp desc) as rn from 
analytics_db.data_apps_simulated.identifies where timestamp >= '2021-05-01' and timestamp <= '2022-06-29'
and properties_gender is not null and properties_gender != '') where rn = 1),

cte_age as 
(select user_id, age from
(select user_id, 
(CASE WHEN dateadd(year, datediff (year, properties_birthday, getdate()), properties_birthday) > getdate()
      THEN datediff(year, properties_birthday, getdate()) - 1
      ELSE datediff(year, properties_birthday, getdate())
 END) as age, row_number() over(partition by user_id order by timestamp desc) as rn 
from analytics_db.data_apps_simulated.identifies where timestamp >= '2021-05-01' and timestamp <= '2022-06-29'
and properties_birthday is not null and properties_birthday!='') where rn = 1),

ctg_country as 
(select user_id, country from 
(select user_id, properties_country as country, row_number() over(partition by user_id order by timestamp desc) as rn from 
analytics_db.data_apps_simulated.identifies where timestamp >= '2021-05-01' and timestamp <= '2022-06-29'
and properties_country is not null and properties_country != '') where rn = 1)

select coalesce(a.user_id, b.user_id, c.user_id) 
as user_id, gender, age, country 
from cte_gender a full outer join cte_age b full outer join cte_country c on a.user_id = b.user_id = c.user_id
limit 500
/* limit added automatically by dbt cloud */
2022-07-04 04:22:36.462837 (Thread-1): 04:22:36  Opening a new connection, currently in state init
2022-07-04 04:22:36.784250 (Thread-63): handling poll request
2022-07-04 04:22:36.784715 (Thread-63): 04:22:36  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '08022227-1dd0-4d09-94f1-e256bf2507d1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb1605b4be0>]}
2022-07-04 04:22:36.785604 (Thread-63): sending response (<Response 5273 bytes [200 OK]>) to 10.0.12.141
2022-07-04 04:22:37.114956 (Thread-1): 04:22:37  Snowflake adapter: Snowflake query id: 01a55fa6-0602-2ed5-0019-82030465d486
2022-07-04 04:22:37.115144 (Thread-1): 04:22:37  Snowflake adapter: Snowflake error: 002003 (42S02): SQL compilation error:
Object 'CTE_COUNTRY' does not exist or not authorized.
2022-07-04 04:22:37.115308 (Thread-1): 04:22:37  finished collecting timing info
2022-07-04 04:22:37.115467 (Thread-1): 04:22:37  On rpc.ecommerce_data_model_dbt.request: Close
2022-07-04 04:22:37.179026 (Thread-1): Got an exception: Database Error
  002003 (42S02): SQL compilation error:
  Object 'CTE_COUNTRY' does not exist or not authorized.
Traceback (most recent call last):
  File "/usr/local/lib/python3.8/dist-packages/dbt/adapters/snowflake/connections.py", line 206, in exception_handler
    yield
  File "/usr/local/lib/python3.8/dist-packages/dbt/adapters/sql/connections.py", line 74, in add_query
    cursor.execute(sql, bindings)
  File "/usr/local/lib/python3.8/dist-packages/snowflake/connector/cursor.py", line 721, in execute
    Error.errorhandler_wrapper(
  File "/usr/local/lib/python3.8/dist-packages/snowflake/connector/errors.py", line 258, in errorhandler_wrapper
    cursor.errorhandler(connection, cursor, error_class, error_value)
  File "/usr/local/lib/python3.8/dist-packages/snowflake/connector/errors.py", line 188, in default_errorhandler
    raise error_class(
snowflake.connector.errors.ProgrammingError: 002003 (42S02): SQL compilation error:
Object 'CTE_COUNTRY' does not exist or not authorized.

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/usr/local/lib/python3.8/dist-packages/dbt/task/base.py", line 361, in safe_run
    result = self.compile_and_execute(manifest, ctx)
  File "/usr/local/lib/python3.8/dist-packages/dbt/task/base.py", line 314, in compile_and_execute
    result = self.run(ctx.node, manifest)
  File "/usr/local/lib/python3.8/dist-packages/dbt/task/base.py", line 403, in run
    return self.execute(compiled_node, manifest)
  File "/usr/local/lib/python3.8/dist-packages/dbt_rpc/rpc/node_runners.py", line 90, in execute
    _, execute_result = self.adapter.execute(
  File "/usr/local/lib/python3.8/dist-packages/dbt/adapters/base/impl.py", line 225, in execute
    return self.connections.execute(
  File "/usr/local/lib/python3.8/dist-packages/dbt/adapters/sql/connections.py", line 127, in execute
    _, cursor = self.add_query(sql, auto_begin)
  File "/usr/local/lib/python3.8/dist-packages/dbt/adapters/snowflake/connections.py", line 433, in add_query
    connection, cursor = super().add_query(
  File "/usr/local/lib/python3.8/dist-packages/dbt/adapters/sql/connections.py", line 83, in add_query
    return connection, cursor
  File "/usr/lib/python3.8/contextlib.py", line 131, in __exit__
    self.gen.throw(type, value, traceback)
  File "/usr/local/lib/python3.8/dist-packages/dbt/adapters/snowflake/connections.py", line 223, in exception_handler
    raise DatabaseException(msg)
dbt.exceptions.DatabaseException: Database Error
  002003 (42S02): SQL compilation error:
  Object 'CTE_COUNTRY' does not exist or not authorized.
2022-07-04 04:22:37.180005 (Thread-1): Got exception RPCException(10003, Database Error, {'type': 'DatabaseException', 'message': "Database Error in rpc request (from remote system)\n  002003 (42S02): SQL compilation error:\n  Object 'CTE_COUNTRY' does not exist or not authorized.", 'raw_sql': "with cte_gender as \n(select user_id, gender from \n(select user_id, properties_gender as gender, row_number() over(partition by user_id order by timestamp desc) as rn from \n{{ source('ecommerce', 'identifies') }} where timestamp >= '{{ var('start_date') }}' and timestamp <= '{{ var('end_date') }}'\nand properties_gender is not null and properties_gender != '') where rn = 1),\n\ncte_age as \n(select user_id, age from\n(select user_id, \n(CASE WHEN dateadd(year, datediff (year, properties_birthday, getdate()), properties_birthday) > getdate()\n      THEN datediff(year, properties_birthday, getdate()) - 1\n      ELSE datediff(year, properties_birthday, getdate())\n END) as age, row_number() over(partition by user_id order by timestamp desc) as rn \nfrom {{ source('ecommerce', 'identifies') }} where timestamp >= '{{ var('start_date') }}' and timestamp <= '{{ var('end_date') }}'\nand properties_birthday is not null and properties_birthday!='') where rn = 1),\n\nctg_country as \n(select user_id, country from \n(select user_id, properties_country as country, row_number() over(partition by user_id order by timestamp desc) as rn from \n{{ source('ecommerce', 'identifies') }} where timestamp >= '{{ var('start_date') }}' and timestamp <= '{{ var('end_date') }}'\nand properties_country is not null and properties_country != '') where rn = 1)\n\nselect coalesce(a.user_id, b.user_id, c.user_id) \nas user_id, gender, age, country \nfrom cte_gender a full outer join cte_age b full outer join cte_country c on a.user_id = b.user_id = c.user_id\nlimit 500\n/* limit added automatically by dbt cloud */", 'compiled_sql': "with cte_gender as \n(select user_id, gender from \n(select user_id, properties_gender as gender, row_number() over(partition by user_id order by timestamp desc) as rn from \nanalytics_db.data_apps_simulated.identifies where timestamp >= '2021-05-01' and timestamp <= '2022-06-29'\nand properties_gender is not null and properties_gender != '') where rn = 1),\n\ncte_age as \n(select user_id, age from\n(select user_id, \n(CASE WHEN dateadd(year, datediff (year, properties_birthday, getdate()), properties_birthday) > getdate()\n      THEN datediff(year, properties_birthday, getdate()) - 1\n      ELSE datediff(year, properties_birthday, getdate())\n END) as age, row_number() over(partition by user_id order by timestamp desc) as rn \nfrom analytics_db.data_apps_simulated.identifies where timestamp >= '2021-05-01' and timestamp <= '2022-06-29'\nand properties_birthday is not null and properties_birthday!='') where rn = 1),\n\nctg_country as \n(select user_id, country from \n(select user_id, properties_country as country, row_number() over(partition by user_id order by timestamp desc) as rn from \nanalytics_db.data_apps_simulated.identifies where timestamp >= '2021-05-01' and timestamp <= '2022-06-29'\nand properties_country is not null and properties_country != '') where rn = 1)\n\nselect coalesce(a.user_id, b.user_id, c.user_id) \nas user_id, gender, age, country \nfrom cte_gender a full outer join cte_age b full outer join cte_country c on a.user_id = b.user_id = c.user_id\nlimit 500\n/* limit added automatically by dbt cloud */", 'tags': None}, None)
Traceback (most recent call last):
  File "/usr/local/lib/python3.8/dist-packages/dbt_rpc/task/sql_commands.py", line 147, in _in_thread
    self.node_results.append(runner.safe_run(self.manifest))
  File "/usr/local/lib/python3.8/dist-packages/dbt/task/base.py", line 377, in safe_run
    result = self.error_result(ctx.node, error, started, [])
  File "/usr/local/lib/python3.8/dist-packages/dbt_rpc/rpc/node_runners.py", line 56, in error_result
    raise error
dbt_rpc.rpc.error.RPCException: RPCException(10003, Database Error, {'type': 'DatabaseException', 'message': "Database Error in rpc request (from remote system)\n  002003 (42S02): SQL compilation error:\n  Object 'CTE_COUNTRY' does not exist or not authorized.", 'raw_sql': "with cte_gender as \n(select user_id, gender from \n(select user_id, properties_gender as gender, row_number() over(partition by user_id order by timestamp desc) as rn from \n{{ source('ecommerce', 'identifies') }} where timestamp >= '{{ var('start_date') }}' and timestamp <= '{{ var('end_date') }}'\nand properties_gender is not null and properties_gender != '') where rn = 1),\n\ncte_age as \n(select user_id, age from\n(select user_id, \n(CASE WHEN dateadd(year, datediff (year, properties_birthday, getdate()), properties_birthday) > getdate()\n      THEN datediff(year, properties_birthday, getdate()) - 1\n      ELSE datediff(year, properties_birthday, getdate())\n END) as age, row_number() over(partition by user_id order by timestamp desc) as rn \nfrom {{ source('ecommerce', 'identifies') }} where timestamp >= '{{ var('start_date') }}' and timestamp <= '{{ var('end_date') }}'\nand properties_birthday is not null and properties_birthday!='') where rn = 1),\n\nctg_country as \n(select user_id, country from \n(select user_id, properties_country as country, row_number() over(partition by user_id order by timestamp desc) as rn from \n{{ source('ecommerce', 'identifies') }} where timestamp >= '{{ var('start_date') }}' and timestamp <= '{{ var('end_date') }}'\nand properties_country is not null and properties_country != '') where rn = 1)\n\nselect coalesce(a.user_id, b.user_id, c.user_id) \nas user_id, gender, age, country \nfrom cte_gender a full outer join cte_age b full outer join cte_country c on a.user_id = b.user_id = c.user_id\nlimit 500\n/* limit added automatically by dbt cloud */", 'compiled_sql': "with cte_gender as \n(select user_id, gender from \n(select user_id, properties_gender as gender, row_number() over(partition by user_id order by timestamp desc) as rn from \nanalytics_db.data_apps_simulated.identifies where timestamp >= '2021-05-01' and timestamp <= '2022-06-29'\nand properties_gender is not null and properties_gender != '') where rn = 1),\n\ncte_age as \n(select user_id, age from\n(select user_id, \n(CASE WHEN dateadd(year, datediff (year, properties_birthday, getdate()), properties_birthday) > getdate()\n      THEN datediff(year, properties_birthday, getdate()) - 1\n      ELSE datediff(year, properties_birthday, getdate())\n END) as age, row_number() over(partition by user_id order by timestamp desc) as rn \nfrom analytics_db.data_apps_simulated.identifies where timestamp >= '2021-05-01' and timestamp <= '2022-06-29'\nand properties_birthday is not null and properties_birthday!='') where rn = 1),\n\nctg_country as \n(select user_id, country from \n(select user_id, properties_country as country, row_number() over(partition by user_id order by timestamp desc) as rn from \nanalytics_db.data_apps_simulated.identifies where timestamp >= '2021-05-01' and timestamp <= '2022-06-29'\nand properties_country is not null and properties_country != '') where rn = 1)\n\nselect coalesce(a.user_id, b.user_id, c.user_id) \nas user_id, gender, age, country \nfrom cte_gender a full outer join cte_age b full outer join cte_country c on a.user_id = b.user_id = c.user_id\nlimit 500\n/* limit added automatically by dbt cloud */", 'tags': None}, None)
2022-07-04 04:22:38.163632 (Thread-64): handling poll request
2022-07-04 04:22:38.164050 (Thread-64): 04:22:38  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '08022227-1dd0-4d09-94f1-e256bf2507d1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb1605b4fa0>]}
2022-07-04 04:22:38.164712 (Thread-64): sending response (<Response 20484 bytes [200 OK]>) to 10.0.12.141
2022-07-04 04:22:51.260033 (Thread-65): 04:22:51  Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
2022-07-04 04:22:51.260511 (Thread-65): 04:22:51  Partial parsing: updated file: ecommerce_data_model_dbt://models/data_model/stg_user_traits.sql
2022-07-04 04:22:51.265191 (Thread-65): 04:22:51  1603: static parser failed on data_model/stg_user_traits.sql
2022-07-04 04:22:51.271462 (Thread-65): 04:22:51  1602: parser fallback to jinja rendering on data_model/stg_user_traits.sql
2022-07-04 04:22:51.308735 (Thread-65): 04:22:51  [WARNING]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.data-apps-ecommerce-template.data_model

2022-07-04 04:22:51.314325 (Thread-65): 04:22:51  Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '08022227-1dd0-4d09-94f1-e256bf2507d1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb1605282b0>]}
2022-07-04 04:22:52.039937 (Thread-66): handling status request
2022-07-04 04:22:52.040354 (Thread-66): 04:22:52  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '08022227-1dd0-4d09-94f1-e256bf2507d1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb1604f8d90>]}
2022-07-04 04:22:52.040886 (Thread-66): sending response (<Response 2351 bytes [200 OK]>) to 10.0.12.141
2022-07-04 04:22:52.073591 (Thread-67): handling status request
2022-07-04 04:22:52.073999 (Thread-67): 04:22:52  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '08022227-1dd0-4d09-94f1-e256bf2507d1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb1604f8c70>]}
2022-07-04 04:22:52.074487 (Thread-67): sending response (<Response 2351 bytes [200 OK]>) to 10.0.12.141
2022-07-04 04:22:52.599032 (Thread-68): handling status request
2022-07-04 04:22:52.599457 (Thread-68): 04:22:52  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '08022227-1dd0-4d09-94f1-e256bf2507d1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb1604f87c0>]}
2022-07-04 04:22:52.600044 (Thread-68): sending response (<Response 2351 bytes [200 OK]>) to 10.0.12.141
2022-07-04 04:22:53.012708 (Thread-69): handling run_sql request
2022-07-04 04:22:53.013129 (Thread-69): 04:22:53  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '08022227-1dd0-4d09-94f1-e256bf2507d1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb1604f8a90>]}
2022-07-04 04:22:55.364386 (Thread-69): sending response (<Response 139 bytes [200 OK]>) to 10.0.12.141
2022-07-04 04:22:55.391777 (MainThread): 04:22:55  Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'eed3d5a3-9534-4a59-8ed6-7afef7f97e90', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbd1ab0a5e0>]}
2022-07-04 04:22:55.392345 (MainThread): 04:22:55  Found 8 models, 0 tests, 0 snapshots, 0 analyses, 179 macros, 0 operations, 0 seed files, 15 sources, 0 exposures, 0 metrics
2022-07-04 04:22:55.392974 (Thread-1): 04:22:55  Acquiring new snowflake connection "rpc.ecommerce_data_model_dbt.request"
2022-07-04 04:22:55.393119 (Thread-1): 04:22:55  Began compiling node rpc.ecommerce_data_model_dbt.request
2022-07-04 04:22:55.393211 (Thread-1): 04:22:55  Compiling rpc.ecommerce_data_model_dbt.request
2022-07-04 04:22:55.397236 (Thread-1): 04:22:55  finished collecting timing info
2022-07-04 04:22:55.397372 (Thread-1): 04:22:55  Began executing node rpc.ecommerce_data_model_dbt.request
2022-07-04 04:22:55.399437 (Thread-1): 04:22:55  Using snowflake connection "rpc.ecommerce_data_model_dbt.request"
2022-07-04 04:22:55.399538 (Thread-1): 04:22:55  On rpc.ecommerce_data_model_dbt.request: with cte_gender as 
(select user_id, gender from 
(select user_id, properties_gender as gender, row_number() over(partition by user_id order by timestamp desc) as rn from 
analytics_db.data_apps_simulated.identifies where timestamp >= '2021-05-01' and timestamp <= '2022-06-29'
and properties_gender is not null and properties_gender != '') where rn = 1),

cte_age as 
(select user_id, age from
(select user_id, 
(CASE WHEN dateadd(year, datediff (year, properties_birthday, getdate()), properties_birthday) > getdate()
      THEN datediff(year, properties_birthday, getdate()) - 1
      ELSE datediff(year, properties_birthday, getdate())
 END) as age, row_number() over(partition by user_id order by timestamp desc) as rn 
from analytics_db.data_apps_simulated.identifies where timestamp >= '2021-05-01' and timestamp <= '2022-06-29'
and properties_birthday is not null and properties_birthday!='') where rn = 1),

cte_country as 
(select user_id, country from 
(select user_id, properties_country as country, row_number() over(partition by user_id order by timestamp desc) as rn from 
analytics_db.data_apps_simulated.identifies where timestamp >= '2021-05-01' and timestamp <= '2022-06-29'
and properties_country is not null and properties_country != '') where rn = 1)

select coalesce(a.user_id, b.user_id, c.user_id) 
as user_id, gender, age, country 
from cte_gender a full outer join cte_age b full outer join cte_country c on a.user_id = b.user_id = c.user_id
limit 500
/* limit added automatically by dbt cloud */
2022-07-04 04:22:55.399623 (Thread-1): 04:22:55  Opening a new connection, currently in state init
2022-07-04 04:22:55.736856 (Thread-70): handling poll request
2022-07-04 04:22:55.737355 (Thread-70): 04:22:55  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '08022227-1dd0-4d09-94f1-e256bf2507d1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb1605a2220>]}
2022-07-04 04:22:55.738312 (Thread-70): sending response (<Response 5273 bytes [200 OK]>) to 10.0.12.141
2022-07-04 04:22:57.114881 (Thread-71): handling poll request
2022-07-04 04:22:57.115299 (Thread-71): 04:22:57  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '08022227-1dd0-4d09-94f1-e256bf2507d1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb1605a21c0>]}
2022-07-04 04:22:57.115800 (Thread-71): sending response (<Response 399 bytes [200 OK]>) to 10.0.12.141
2022-07-04 04:22:57.136006 (Thread-1): 04:22:57  Snowflake adapter: Snowflake query id: 01a55fa6-0602-3238-0019-82030464fd7e
2022-07-04 04:22:57.136197 (Thread-1): 04:22:57  Snowflake adapter: Snowflake error: 100037 (22018): Boolean value 'user1' is not recognized
2022-07-04 04:22:57.136358 (Thread-1): 04:22:57  finished collecting timing info
2022-07-04 04:22:57.136514 (Thread-1): 04:22:57  On rpc.ecommerce_data_model_dbt.request: Close
2022-07-04 04:22:57.243623 (Thread-1): Got an exception: Database Error
  100037 (22018): Boolean value 'user1' is not recognized
Traceback (most recent call last):
  File "/usr/local/lib/python3.8/dist-packages/dbt/adapters/snowflake/connections.py", line 206, in exception_handler
    yield
  File "/usr/local/lib/python3.8/dist-packages/dbt/adapters/sql/connections.py", line 74, in add_query
    cursor.execute(sql, bindings)
  File "/usr/local/lib/python3.8/dist-packages/snowflake/connector/cursor.py", line 721, in execute
    Error.errorhandler_wrapper(
  File "/usr/local/lib/python3.8/dist-packages/snowflake/connector/errors.py", line 258, in errorhandler_wrapper
    cursor.errorhandler(connection, cursor, error_class, error_value)
  File "/usr/local/lib/python3.8/dist-packages/snowflake/connector/errors.py", line 188, in default_errorhandler
    raise error_class(
snowflake.connector.errors.ProgrammingError: 100037 (22018): Boolean value 'user1' is not recognized

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/usr/local/lib/python3.8/dist-packages/dbt/task/base.py", line 361, in safe_run
    result = self.compile_and_execute(manifest, ctx)
  File "/usr/local/lib/python3.8/dist-packages/dbt/task/base.py", line 314, in compile_and_execute
    result = self.run(ctx.node, manifest)
  File "/usr/local/lib/python3.8/dist-packages/dbt/task/base.py", line 403, in run
    return self.execute(compiled_node, manifest)
  File "/usr/local/lib/python3.8/dist-packages/dbt_rpc/rpc/node_runners.py", line 90, in execute
    _, execute_result = self.adapter.execute(
  File "/usr/local/lib/python3.8/dist-packages/dbt/adapters/base/impl.py", line 225, in execute
    return self.connections.execute(
  File "/usr/local/lib/python3.8/dist-packages/dbt/adapters/sql/connections.py", line 127, in execute
    _, cursor = self.add_query(sql, auto_begin)
  File "/usr/local/lib/python3.8/dist-packages/dbt/adapters/snowflake/connections.py", line 433, in add_query
    connection, cursor = super().add_query(
  File "/usr/local/lib/python3.8/dist-packages/dbt/adapters/sql/connections.py", line 83, in add_query
    return connection, cursor
  File "/usr/lib/python3.8/contextlib.py", line 131, in __exit__
    self.gen.throw(type, value, traceback)
  File "/usr/local/lib/python3.8/dist-packages/dbt/adapters/snowflake/connections.py", line 223, in exception_handler
    raise DatabaseException(msg)
dbt.exceptions.DatabaseException: Database Error
  100037 (22018): Boolean value 'user1' is not recognized
2022-07-04 04:22:57.244579 (Thread-1): Got exception RPCException(10003, Database Error, {'type': 'DatabaseException', 'message': "Database Error in rpc request (from remote system)\n  100037 (22018): Boolean value 'user1' is not recognized", 'raw_sql': "with cte_gender as \n(select user_id, gender from \n(select user_id, properties_gender as gender, row_number() over(partition by user_id order by timestamp desc) as rn from \n{{ source('ecommerce', 'identifies') }} where timestamp >= '{{ var('start_date') }}' and timestamp <= '{{ var('end_date') }}'\nand properties_gender is not null and properties_gender != '') where rn = 1),\n\ncte_age as \n(select user_id, age from\n(select user_id, \n(CASE WHEN dateadd(year, datediff (year, properties_birthday, getdate()), properties_birthday) > getdate()\n      THEN datediff(year, properties_birthday, getdate()) - 1\n      ELSE datediff(year, properties_birthday, getdate())\n END) as age, row_number() over(partition by user_id order by timestamp desc) as rn \nfrom {{ source('ecommerce', 'identifies') }} where timestamp >= '{{ var('start_date') }}' and timestamp <= '{{ var('end_date') }}'\nand properties_birthday is not null and properties_birthday!='') where rn = 1),\n\ncte_country as \n(select user_id, country from \n(select user_id, properties_country as country, row_number() over(partition by user_id order by timestamp desc) as rn from \n{{ source('ecommerce', 'identifies') }} where timestamp >= '{{ var('start_date') }}' and timestamp <= '{{ var('end_date') }}'\nand properties_country is not null and properties_country != '') where rn = 1)\n\nselect coalesce(a.user_id, b.user_id, c.user_id) \nas user_id, gender, age, country \nfrom cte_gender a full outer join cte_age b full outer join cte_country c on a.user_id = b.user_id = c.user_id\nlimit 500\n/* limit added automatically by dbt cloud */", 'compiled_sql': "with cte_gender as \n(select user_id, gender from \n(select user_id, properties_gender as gender, row_number() over(partition by user_id order by timestamp desc) as rn from \nanalytics_db.data_apps_simulated.identifies where timestamp >= '2021-05-01' and timestamp <= '2022-06-29'\nand properties_gender is not null and properties_gender != '') where rn = 1),\n\ncte_age as \n(select user_id, age from\n(select user_id, \n(CASE WHEN dateadd(year, datediff (year, properties_birthday, getdate()), properties_birthday) > getdate()\n      THEN datediff(year, properties_birthday, getdate()) - 1\n      ELSE datediff(year, properties_birthday, getdate())\n END) as age, row_number() over(partition by user_id order by timestamp desc) as rn \nfrom analytics_db.data_apps_simulated.identifies where timestamp >= '2021-05-01' and timestamp <= '2022-06-29'\nand properties_birthday is not null and properties_birthday!='') where rn = 1),\n\ncte_country as \n(select user_id, country from \n(select user_id, properties_country as country, row_number() over(partition by user_id order by timestamp desc) as rn from \nanalytics_db.data_apps_simulated.identifies where timestamp >= '2021-05-01' and timestamp <= '2022-06-29'\nand properties_country is not null and properties_country != '') where rn = 1)\n\nselect coalesce(a.user_id, b.user_id, c.user_id) \nas user_id, gender, age, country \nfrom cte_gender a full outer join cte_age b full outer join cte_country c on a.user_id = b.user_id = c.user_id\nlimit 500\n/* limit added automatically by dbt cloud */", 'tags': None}, None)
Traceback (most recent call last):
  File "/usr/local/lib/python3.8/dist-packages/dbt_rpc/task/sql_commands.py", line 147, in _in_thread
    self.node_results.append(runner.safe_run(self.manifest))
  File "/usr/local/lib/python3.8/dist-packages/dbt/task/base.py", line 377, in safe_run
    result = self.error_result(ctx.node, error, started, [])
  File "/usr/local/lib/python3.8/dist-packages/dbt_rpc/rpc/node_runners.py", line 56, in error_result
    raise error
dbt_rpc.rpc.error.RPCException: RPCException(10003, Database Error, {'type': 'DatabaseException', 'message': "Database Error in rpc request (from remote system)\n  100037 (22018): Boolean value 'user1' is not recognized", 'raw_sql': "with cte_gender as \n(select user_id, gender from \n(select user_id, properties_gender as gender, row_number() over(partition by user_id order by timestamp desc) as rn from \n{{ source('ecommerce', 'identifies') }} where timestamp >= '{{ var('start_date') }}' and timestamp <= '{{ var('end_date') }}'\nand properties_gender is not null and properties_gender != '') where rn = 1),\n\ncte_age as \n(select user_id, age from\n(select user_id, \n(CASE WHEN dateadd(year, datediff (year, properties_birthday, getdate()), properties_birthday) > getdate()\n      THEN datediff(year, properties_birthday, getdate()) - 1\n      ELSE datediff(year, properties_birthday, getdate())\n END) as age, row_number() over(partition by user_id order by timestamp desc) as rn \nfrom {{ source('ecommerce', 'identifies') }} where timestamp >= '{{ var('start_date') }}' and timestamp <= '{{ var('end_date') }}'\nand properties_birthday is not null and properties_birthday!='') where rn = 1),\n\ncte_country as \n(select user_id, country from \n(select user_id, properties_country as country, row_number() over(partition by user_id order by timestamp desc) as rn from \n{{ source('ecommerce', 'identifies') }} where timestamp >= '{{ var('start_date') }}' and timestamp <= '{{ var('end_date') }}'\nand properties_country is not null and properties_country != '') where rn = 1)\n\nselect coalesce(a.user_id, b.user_id, c.user_id) \nas user_id, gender, age, country \nfrom cte_gender a full outer join cte_age b full outer join cte_country c on a.user_id = b.user_id = c.user_id\nlimit 500\n/* limit added automatically by dbt cloud */", 'compiled_sql': "with cte_gender as \n(select user_id, gender from \n(select user_id, properties_gender as gender, row_number() over(partition by user_id order by timestamp desc) as rn from \nanalytics_db.data_apps_simulated.identifies where timestamp >= '2021-05-01' and timestamp <= '2022-06-29'\nand properties_gender is not null and properties_gender != '') where rn = 1),\n\ncte_age as \n(select user_id, age from\n(select user_id, \n(CASE WHEN dateadd(year, datediff (year, properties_birthday, getdate()), properties_birthday) > getdate()\n      THEN datediff(year, properties_birthday, getdate()) - 1\n      ELSE datediff(year, properties_birthday, getdate())\n END) as age, row_number() over(partition by user_id order by timestamp desc) as rn \nfrom analytics_db.data_apps_simulated.identifies where timestamp >= '2021-05-01' and timestamp <= '2022-06-29'\nand properties_birthday is not null and properties_birthday!='') where rn = 1),\n\ncte_country as \n(select user_id, country from \n(select user_id, properties_country as country, row_number() over(partition by user_id order by timestamp desc) as rn from \nanalytics_db.data_apps_simulated.identifies where timestamp >= '2021-05-01' and timestamp <= '2022-06-29'\nand properties_country is not null and properties_country != '') where rn = 1)\n\nselect coalesce(a.user_id, b.user_id, c.user_id) \nas user_id, gender, age, country \nfrom cte_gender a full outer join cte_age b full outer join cte_country c on a.user_id = b.user_id = c.user_id\nlimit 500\n/* limit added automatically by dbt cloud */", 'tags': None}, None)
2022-07-04 04:22:58.508285 (Thread-72): handling poll request
2022-07-04 04:22:58.508690 (Thread-72): 04:22:58  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '08022227-1dd0-4d09-94f1-e256bf2507d1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb1605bb340>]}
2022-07-04 04:22:58.509380 (Thread-72): sending response (<Response 20199 bytes [200 OK]>) to 10.0.12.141
2022-07-04 04:23:19.786147 (Thread-73): handling status request
2022-07-04 04:23:19.786549 (Thread-73): 04:23:19  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '08022227-1dd0-4d09-94f1-e256bf2507d1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb1605b8f10>]}
2022-07-04 04:23:19.787088 (Thread-73): sending response (<Response 2351 bytes [200 OK]>) to 10.0.12.141
2022-07-04 04:23:20.150498 (Thread-74): handling run_sql request
2022-07-04 04:23:20.150901 (Thread-74): 04:23:20  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '08022227-1dd0-4d09-94f1-e256bf2507d1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb1605b8850>]}
2022-07-04 04:23:22.477325 (Thread-74): sending response (<Response 139 bytes [200 OK]>) to 10.0.12.141
2022-07-04 04:23:22.504433 (MainThread): 04:23:22  Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '1c08f087-01b9-4fb8-a205-3e9575d3ac6d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0ff8bca610>]}
2022-07-04 04:23:22.504981 (MainThread): 04:23:22  Found 8 models, 0 tests, 0 snapshots, 0 analyses, 179 macros, 0 operations, 0 seed files, 15 sources, 0 exposures, 0 metrics
2022-07-04 04:23:22.505598 (Thread-1): 04:23:22  Acquiring new snowflake connection "rpc.ecommerce_data_model_dbt.request"
2022-07-04 04:23:22.505734 (Thread-1): 04:23:22  Began compiling node rpc.ecommerce_data_model_dbt.request
2022-07-04 04:23:22.505828 (Thread-1): 04:23:22  Compiling rpc.ecommerce_data_model_dbt.request
2022-07-04 04:23:22.509798 (Thread-1): 04:23:22  finished collecting timing info
2022-07-04 04:23:22.509961 (Thread-1): 04:23:22  Began executing node rpc.ecommerce_data_model_dbt.request
2022-07-04 04:23:22.512028 (Thread-1): 04:23:22  Using snowflake connection "rpc.ecommerce_data_model_dbt.request"
2022-07-04 04:23:22.512127 (Thread-1): 04:23:22  On rpc.ecommerce_data_model_dbt.request: with cte_gender as 
(select user_id, gender from 
(select user_id, properties_gender as gender, row_number() over(partition by user_id order by timestamp desc) as rn from 
analytics_db.data_apps_simulated.identifies where timestamp >= '2021-05-01' and timestamp <= '2022-06-29'
and properties_gender is not null and properties_gender != '') where rn = 1),

cte_age as 
(select user_id, age from
(select user_id, 
(CASE WHEN dateadd(year, datediff (year, properties_birthday, getdate()), properties_birthday) > getdate()
      THEN datediff(year, properties_birthday, getdate()) - 1
      ELSE datediff(year, properties_birthday, getdate())
 END) as age, row_number() over(partition by user_id order by timestamp desc) as rn 
from analytics_db.data_apps_simulated.identifies where timestamp >= '2021-05-01' and timestamp <= '2022-06-29'
and properties_birthday is not null and properties_birthday!='') where rn = 1),

cte_country as 
(select user_id, country from 
(select user_id, properties_country as country, row_number() over(partition by user_id order by timestamp desc) as rn from 
analytics_db.data_apps_simulated.identifies where timestamp >= '2021-05-01' and timestamp <= '2022-06-29'
and properties_country is not null and properties_country != '') where rn = 1)

select coalesce(a.user_id, b.user_id, c.user_id) 
as user_id, gender, age, country 
from cte_gender a full outer join cte_age b full outer join cte_country c on a.user_id = b.user_id and b.user_id = c.user_id
limit 500
/* limit added automatically by dbt cloud */
2022-07-04 04:23:22.512208 (Thread-1): 04:23:22  Opening a new connection, currently in state init
2022-07-04 04:23:22.876388 (Thread-75): handling poll request
2022-07-04 04:23:22.876873 (Thread-75): 04:23:22  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '08022227-1dd0-4d09-94f1-e256bf2507d1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb160522250>]}
2022-07-04 04:23:22.877747 (Thread-75): sending response (<Response 5287 bytes [200 OK]>) to 10.0.12.141
2022-07-04 04:23:23.820959 (Thread-1): 04:23:23  SQL status: SUCCESS 17 in 1.31 seconds
2022-07-04 04:23:23.822656 (Thread-1): 04:23:23  finished collecting timing info
2022-07-04 04:23:23.822840 (Thread-1): 04:23:23  On rpc.ecommerce_data_model_dbt.request: Close
2022-07-04 04:23:24.252308 (Thread-76): handling poll request
2022-07-04 04:23:24.252698 (Thread-76): 04:23:24  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '08022227-1dd0-4d09-94f1-e256bf2507d1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb1605229a0>]}
2022-07-04 04:23:24.253662 (Thread-76): sending response (<Response 10256 bytes [200 OK]>) to 10.0.12.141
2022-07-04 04:24:13.896491 (Thread-77): handling status request
2022-07-04 04:24:13.896924 (Thread-77): 04:24:13  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '08022227-1dd0-4d09-94f1-e256bf2507d1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb160522b80>]}
2022-07-04 04:24:13.897498 (Thread-77): sending response (<Response 2351 bytes [200 OK]>) to 10.0.12.141
2022-07-04 04:24:14.270610 (Thread-78): handling run_sql request
2022-07-04 04:24:14.271011 (Thread-78): 04:24:14  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '08022227-1dd0-4d09-94f1-e256bf2507d1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb160522910>]}
2022-07-04 04:24:16.612501 (Thread-78): sending response (<Response 139 bytes [200 OK]>) to 10.0.12.141
2022-07-04 04:24:16.640756 (MainThread): 04:24:16  Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'c27fbe7c-8813-4298-9167-5163c37d6d93', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1a22d4a520>]}
2022-07-04 04:24:16.641322 (MainThread): 04:24:16  Found 8 models, 0 tests, 0 snapshots, 0 analyses, 179 macros, 0 operations, 0 seed files, 15 sources, 0 exposures, 0 metrics
2022-07-04 04:24:16.641954 (Thread-1): 04:24:16  Acquiring new snowflake connection "rpc.ecommerce_data_model_dbt.request"
2022-07-04 04:24:16.642104 (Thread-1): 04:24:16  Began compiling node rpc.ecommerce_data_model_dbt.request
2022-07-04 04:24:16.642201 (Thread-1): 04:24:16  Compiling rpc.ecommerce_data_model_dbt.request
2022-07-04 04:24:16.646169 (Thread-1): 04:24:16  finished collecting timing info
2022-07-04 04:24:16.646304 (Thread-1): 04:24:16  Began executing node rpc.ecommerce_data_model_dbt.request
2022-07-04 04:24:16.648298 (Thread-1): 04:24:16  Using snowflake connection "rpc.ecommerce_data_model_dbt.request"
2022-07-04 04:24:16.648398 (Thread-1): 04:24:16  On rpc.ecommerce_data_model_dbt.request: with cte_gender as 
(select user_id, gender from 
(select user_id, properties_gender as gender, row_number() over(partition by user_id order by timestamp desc) as rn from 
analytics_db.data_apps_simulated.identifies where timestamp >= '2021-05-01' and timestamp <= '2022-06-29'
and properties_gender is not null and properties_gender != '') where rn = 1),

cte_age as 
(select user_id, age from
(select user_id, 
(CASE WHEN dateadd(year, datediff (year, properties_birthday, getdate()), properties_birthday) > getdate()
      THEN datediff(year, properties_birthday, getdate()) - 1
      ELSE datediff(year, properties_birthday, getdate())
 END) as age, row_number() over(partition by user_id order by timestamp desc) as rn 
from analytics_db.data_apps_simulated.identifies where timestamp >= '2021-05-01' and timestamp <= '2022-06-29'
and properties_birthday is not null and properties_birthday!='') where rn = 1),

cte_country as 
(select user_id, country from 
(select user_id, properties_country as country, row_number() over(partition by user_id order by timestamp desc) as rn from 
analytics_db.data_apps_simulated.identifies where timestamp >= '2021-05-01' and timestamp <= '2022-06-29'
and properties_country is not null and properties_country != '') where rn = 1)

select coalesce(a.user_id, b.user_id, c.user_id) 
as user_id, gender, age, country 
from cte_gender (a full outer join cte_age b on a.user_id = b.user_id) full outer join cte_country c on b.user_id = c.user_id
limit 500
/* limit added automatically by dbt cloud */
2022-07-04 04:24:16.648480 (Thread-1): 04:24:16  Opening a new connection, currently in state init
2022-07-04 04:24:16.991445 (Thread-79): handling poll request
2022-07-04 04:24:16.991925 (Thread-79): 04:24:16  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '08022227-1dd0-4d09-94f1-e256bf2507d1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb160528dc0>]}
2022-07-04 04:24:16.992821 (Thread-79): sending response (<Response 5288 bytes [200 OK]>) to 10.0.12.141
2022-07-04 04:24:17.299586 (Thread-1): 04:24:17  Snowflake adapter: Snowflake query id: 01a55fa8-0602-327e-0019-82030465c9f2
2022-07-04 04:24:17.299798 (Thread-1): 04:24:17  Snowflake adapter: Snowflake error: 001003 (42000): SQL compilation error:
syntax error line 25 at position 16 unexpected '('.
syntax error line 25 at position 69 unexpected ')'.
2022-07-04 04:24:17.299965 (Thread-1): 04:24:17  finished collecting timing info
2022-07-04 04:24:17.300122 (Thread-1): 04:24:17  On rpc.ecommerce_data_model_dbt.request: Close
2022-07-04 04:24:17.374014 (Thread-1): Got an exception: Database Error
  001003 (42000): SQL compilation error:
  syntax error line 25 at position 16 unexpected '('.
  syntax error line 25 at position 69 unexpected ')'.
Traceback (most recent call last):
  File "/usr/local/lib/python3.8/dist-packages/dbt/adapters/snowflake/connections.py", line 206, in exception_handler
    yield
  File "/usr/local/lib/python3.8/dist-packages/dbt/adapters/sql/connections.py", line 74, in add_query
    cursor.execute(sql, bindings)
  File "/usr/local/lib/python3.8/dist-packages/snowflake/connector/cursor.py", line 721, in execute
    Error.errorhandler_wrapper(
  File "/usr/local/lib/python3.8/dist-packages/snowflake/connector/errors.py", line 258, in errorhandler_wrapper
    cursor.errorhandler(connection, cursor, error_class, error_value)
  File "/usr/local/lib/python3.8/dist-packages/snowflake/connector/errors.py", line 188, in default_errorhandler
    raise error_class(
snowflake.connector.errors.ProgrammingError: 001003 (42000): SQL compilation error:
syntax error line 25 at position 16 unexpected '('.
syntax error line 25 at position 69 unexpected ')'.

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/usr/local/lib/python3.8/dist-packages/dbt/task/base.py", line 361, in safe_run
    result = self.compile_and_execute(manifest, ctx)
  File "/usr/local/lib/python3.8/dist-packages/dbt/task/base.py", line 314, in compile_and_execute
    result = self.run(ctx.node, manifest)
  File "/usr/local/lib/python3.8/dist-packages/dbt/task/base.py", line 403, in run
    return self.execute(compiled_node, manifest)
  File "/usr/local/lib/python3.8/dist-packages/dbt_rpc/rpc/node_runners.py", line 90, in execute
    _, execute_result = self.adapter.execute(
  File "/usr/local/lib/python3.8/dist-packages/dbt/adapters/base/impl.py", line 225, in execute
    return self.connections.execute(
  File "/usr/local/lib/python3.8/dist-packages/dbt/adapters/sql/connections.py", line 127, in execute
    _, cursor = self.add_query(sql, auto_begin)
  File "/usr/local/lib/python3.8/dist-packages/dbt/adapters/snowflake/connections.py", line 433, in add_query
    connection, cursor = super().add_query(
  File "/usr/local/lib/python3.8/dist-packages/dbt/adapters/sql/connections.py", line 83, in add_query
    return connection, cursor
  File "/usr/lib/python3.8/contextlib.py", line 131, in __exit__
    self.gen.throw(type, value, traceback)
  File "/usr/local/lib/python3.8/dist-packages/dbt/adapters/snowflake/connections.py", line 223, in exception_handler
    raise DatabaseException(msg)
dbt.exceptions.DatabaseException: Database Error
  001003 (42000): SQL compilation error:
  syntax error line 25 at position 16 unexpected '('.
  syntax error line 25 at position 69 unexpected ')'.
2022-07-04 04:24:17.374960 (Thread-1): Got exception RPCException(10003, Database Error, {'type': 'DatabaseException', 'message': "Database Error in rpc request (from remote system)\n  001003 (42000): SQL compilation error:\n  syntax error line 25 at position 16 unexpected '('.\n  syntax error line 25 at position 69 unexpected ')'.", 'raw_sql': "with cte_gender as \n(select user_id, gender from \n(select user_id, properties_gender as gender, row_number() over(partition by user_id order by timestamp desc) as rn from \n{{ source('ecommerce', 'identifies') }} where timestamp >= '{{ var('start_date') }}' and timestamp <= '{{ var('end_date') }}'\nand properties_gender is not null and properties_gender != '') where rn = 1),\n\ncte_age as \n(select user_id, age from\n(select user_id, \n(CASE WHEN dateadd(year, datediff (year, properties_birthday, getdate()), properties_birthday) > getdate()\n      THEN datediff(year, properties_birthday, getdate()) - 1\n      ELSE datediff(year, properties_birthday, getdate())\n END) as age, row_number() over(partition by user_id order by timestamp desc) as rn \nfrom {{ source('ecommerce', 'identifies') }} where timestamp >= '{{ var('start_date') }}' and timestamp <= '{{ var('end_date') }}'\nand properties_birthday is not null and properties_birthday!='') where rn = 1),\n\ncte_country as \n(select user_id, country from \n(select user_id, properties_country as country, row_number() over(partition by user_id order by timestamp desc) as rn from \n{{ source('ecommerce', 'identifies') }} where timestamp >= '{{ var('start_date') }}' and timestamp <= '{{ var('end_date') }}'\nand properties_country is not null and properties_country != '') where rn = 1)\n\nselect coalesce(a.user_id, b.user_id, c.user_id) \nas user_id, gender, age, country \nfrom cte_gender (a full outer join cte_age b on a.user_id = b.user_id) full outer join cte_country c on b.user_id = c.user_id\nlimit 500\n/* limit added automatically by dbt cloud */", 'compiled_sql': "with cte_gender as \n(select user_id, gender from \n(select user_id, properties_gender as gender, row_number() over(partition by user_id order by timestamp desc) as rn from \nanalytics_db.data_apps_simulated.identifies where timestamp >= '2021-05-01' and timestamp <= '2022-06-29'\nand properties_gender is not null and properties_gender != '') where rn = 1),\n\ncte_age as \n(select user_id, age from\n(select user_id, \n(CASE WHEN dateadd(year, datediff (year, properties_birthday, getdate()), properties_birthday) > getdate()\n      THEN datediff(year, properties_birthday, getdate()) - 1\n      ELSE datediff(year, properties_birthday, getdate())\n END) as age, row_number() over(partition by user_id order by timestamp desc) as rn \nfrom analytics_db.data_apps_simulated.identifies where timestamp >= '2021-05-01' and timestamp <= '2022-06-29'\nand properties_birthday is not null and properties_birthday!='') where rn = 1),\n\ncte_country as \n(select user_id, country from \n(select user_id, properties_country as country, row_number() over(partition by user_id order by timestamp desc) as rn from \nanalytics_db.data_apps_simulated.identifies where timestamp >= '2021-05-01' and timestamp <= '2022-06-29'\nand properties_country is not null and properties_country != '') where rn = 1)\n\nselect coalesce(a.user_id, b.user_id, c.user_id) \nas user_id, gender, age, country \nfrom cte_gender (a full outer join cte_age b on a.user_id = b.user_id) full outer join cte_country c on b.user_id = c.user_id\nlimit 500\n/* limit added automatically by dbt cloud */", 'tags': None}, None)
Traceback (most recent call last):
  File "/usr/local/lib/python3.8/dist-packages/dbt_rpc/task/sql_commands.py", line 147, in _in_thread
    self.node_results.append(runner.safe_run(self.manifest))
  File "/usr/local/lib/python3.8/dist-packages/dbt/task/base.py", line 377, in safe_run
    result = self.error_result(ctx.node, error, started, [])
  File "/usr/local/lib/python3.8/dist-packages/dbt_rpc/rpc/node_runners.py", line 56, in error_result
    raise error
dbt_rpc.rpc.error.RPCException: RPCException(10003, Database Error, {'type': 'DatabaseException', 'message': "Database Error in rpc request (from remote system)\n  001003 (42000): SQL compilation error:\n  syntax error line 25 at position 16 unexpected '('.\n  syntax error line 25 at position 69 unexpected ')'.", 'raw_sql': "with cte_gender as \n(select user_id, gender from \n(select user_id, properties_gender as gender, row_number() over(partition by user_id order by timestamp desc) as rn from \n{{ source('ecommerce', 'identifies') }} where timestamp >= '{{ var('start_date') }}' and timestamp <= '{{ var('end_date') }}'\nand properties_gender is not null and properties_gender != '') where rn = 1),\n\ncte_age as \n(select user_id, age from\n(select user_id, \n(CASE WHEN dateadd(year, datediff (year, properties_birthday, getdate()), properties_birthday) > getdate()\n      THEN datediff(year, properties_birthday, getdate()) - 1\n      ELSE datediff(year, properties_birthday, getdate())\n END) as age, row_number() over(partition by user_id order by timestamp desc) as rn \nfrom {{ source('ecommerce', 'identifies') }} where timestamp >= '{{ var('start_date') }}' and timestamp <= '{{ var('end_date') }}'\nand properties_birthday is not null and properties_birthday!='') where rn = 1),\n\ncte_country as \n(select user_id, country from \n(select user_id, properties_country as country, row_number() over(partition by user_id order by timestamp desc) as rn from \n{{ source('ecommerce', 'identifies') }} where timestamp >= '{{ var('start_date') }}' and timestamp <= '{{ var('end_date') }}'\nand properties_country is not null and properties_country != '') where rn = 1)\n\nselect coalesce(a.user_id, b.user_id, c.user_id) \nas user_id, gender, age, country \nfrom cte_gender (a full outer join cte_age b on a.user_id = b.user_id) full outer join cte_country c on b.user_id = c.user_id\nlimit 500\n/* limit added automatically by dbt cloud */", 'compiled_sql': "with cte_gender as \n(select user_id, gender from \n(select user_id, properties_gender as gender, row_number() over(partition by user_id order by timestamp desc) as rn from \nanalytics_db.data_apps_simulated.identifies where timestamp >= '2021-05-01' and timestamp <= '2022-06-29'\nand properties_gender is not null and properties_gender != '') where rn = 1),\n\ncte_age as \n(select user_id, age from\n(select user_id, \n(CASE WHEN dateadd(year, datediff (year, properties_birthday, getdate()), properties_birthday) > getdate()\n      THEN datediff(year, properties_birthday, getdate()) - 1\n      ELSE datediff(year, properties_birthday, getdate())\n END) as age, row_number() over(partition by user_id order by timestamp desc) as rn \nfrom analytics_db.data_apps_simulated.identifies where timestamp >= '2021-05-01' and timestamp <= '2022-06-29'\nand properties_birthday is not null and properties_birthday!='') where rn = 1),\n\ncte_country as \n(select user_id, country from \n(select user_id, properties_country as country, row_number() over(partition by user_id order by timestamp desc) as rn from \nanalytics_db.data_apps_simulated.identifies where timestamp >= '2021-05-01' and timestamp <= '2022-06-29'\nand properties_country is not null and properties_country != '') where rn = 1)\n\nselect coalesce(a.user_id, b.user_id, c.user_id) \nas user_id, gender, age, country \nfrom cte_gender (a full outer join cte_age b on a.user_id = b.user_id) full outer join cte_country c on b.user_id = c.user_id\nlimit 500\n/* limit added automatically by dbt cloud */", 'tags': None}, None)
2022-07-04 04:24:18.360716 (Thread-80): handling poll request
2022-07-04 04:24:18.361137 (Thread-80): 04:24:18  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '08022227-1dd0-4d09-94f1-e256bf2507d1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb1605282e0>]}
2022-07-04 04:24:18.361804 (Thread-80): sending response (<Response 20951 bytes [200 OK]>) to 10.0.12.141
2022-07-04 04:24:36.128598 (Thread-81): handling status request
2022-07-04 04:24:36.129035 (Thread-81): 04:24:36  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '08022227-1dd0-4d09-94f1-e256bf2507d1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb16051a7f0>]}
2022-07-04 04:24:36.129693 (Thread-81): sending response (<Response 2351 bytes [200 OK]>) to 10.0.12.141
2022-07-04 04:24:36.537213 (Thread-82): handling run_sql request
2022-07-04 04:24:36.537629 (Thread-82): 04:24:36  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '08022227-1dd0-4d09-94f1-e256bf2507d1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb16051a9d0>]}
2022-07-04 04:24:38.882539 (Thread-82): sending response (<Response 139 bytes [200 OK]>) to 10.0.12.141
2022-07-04 04:24:38.909662 (MainThread): 04:24:38  Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '5804cc1f-06d7-4a42-93b1-ce5ece027497', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7effa758a520>]}
2022-07-04 04:24:38.910249 (MainThread): 04:24:38  Found 8 models, 0 tests, 0 snapshots, 0 analyses, 179 macros, 0 operations, 0 seed files, 15 sources, 0 exposures, 0 metrics
2022-07-04 04:24:38.910853 (Thread-1): 04:24:38  Acquiring new snowflake connection "rpc.ecommerce_data_model_dbt.request"
2022-07-04 04:24:38.910984 (Thread-1): 04:24:38  Began compiling node rpc.ecommerce_data_model_dbt.request
2022-07-04 04:24:38.911077 (Thread-1): 04:24:38  Compiling rpc.ecommerce_data_model_dbt.request
2022-07-04 04:24:38.915188 (Thread-1): 04:24:38  finished collecting timing info
2022-07-04 04:24:38.915329 (Thread-1): 04:24:38  Began executing node rpc.ecommerce_data_model_dbt.request
2022-07-04 04:24:38.917444 (Thread-1): 04:24:38  Using snowflake connection "rpc.ecommerce_data_model_dbt.request"
2022-07-04 04:24:38.917544 (Thread-1): 04:24:38  On rpc.ecommerce_data_model_dbt.request: with cte_gender as 
(select user_id, gender from 
(select user_id, properties_gender as gender, row_number() over(partition by user_id order by timestamp desc) as rn from 
analytics_db.data_apps_simulated.identifies where timestamp >= '2021-05-01' and timestamp <= '2022-06-29'
and properties_gender is not null and properties_gender != '') where rn = 1),

cte_age as 
(select user_id, age from
(select user_id, 
(CASE WHEN dateadd(year, datediff (year, properties_birthday, getdate()), properties_birthday) > getdate()
      THEN datediff(year, properties_birthday, getdate()) - 1
      ELSE datediff(year, properties_birthday, getdate())
 END) as age, row_number() over(partition by user_id order by timestamp desc) as rn 
from analytics_db.data_apps_simulated.identifies where timestamp >= '2021-05-01' and timestamp <= '2022-06-29'
and properties_birthday is not null and properties_birthday!='') where rn = 1),

cte_country as 
(select user_id, country from 
(select user_id, properties_country as country, row_number() over(partition by user_id order by timestamp desc) as rn from 
analytics_db.data_apps_simulated.identifies where timestamp >= '2021-05-01' and timestamp <= '2022-06-29'
and properties_country is not null and properties_country != '') where rn = 1)

select coalesce(a.user_id, b.user_id, c.user_id) 
as user_id, gender, age, country 
from (cte_gender a full outer join cte_age b on a.user_id = b.user_id) full outer join cte_country c on b.user_id = c.user_id
limit 500
/* limit added automatically by dbt cloud */
2022-07-04 04:24:38.917626 (Thread-1): 04:24:38  Opening a new connection, currently in state init
2022-07-04 04:24:39.246761 (Thread-83): handling poll request
2022-07-04 04:24:39.247258 (Thread-83): 04:24:39  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '08022227-1dd0-4d09-94f1-e256bf2507d1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb1605129a0>]}
2022-07-04 04:24:39.248121 (Thread-83): sending response (<Response 5288 bytes [200 OK]>) to 10.0.12.141
2022-07-04 04:24:39.965502 (Thread-1): 04:24:39  SQL status: SUCCESS 7 in 1.05 seconds
2022-07-04 04:24:39.967031 (Thread-1): 04:24:39  finished collecting timing info
2022-07-04 04:24:39.967213 (Thread-1): 04:24:39  On rpc.ecommerce_data_model_dbt.request: Close
2022-07-04 04:24:41.338958 (Thread-84): handling poll request
2022-07-04 04:24:41.339369 (Thread-84): 04:24:41  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '08022227-1dd0-4d09-94f1-e256bf2507d1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb160512fd0>]}
2022-07-04 04:24:41.340277 (Thread-84): sending response (<Response 9978 bytes [200 OK]>) to 10.0.12.141
2022-07-04 04:28:54.510503 (Thread-85): handling status request
2022-07-04 04:28:54.512949 (Thread-85): 04:28:54  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '08022227-1dd0-4d09-94f1-e256bf2507d1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb1604b9550>]}
2022-07-04 04:28:54.513506 (Thread-85): sending response (<Response 2351 bytes [200 OK]>) to 10.0.12.141
2022-07-04 04:28:54.915068 (Thread-86): handling run_sql request
2022-07-04 04:28:54.915473 (Thread-86): 04:28:54  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '08022227-1dd0-4d09-94f1-e256bf2507d1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb1604b9730>]}
2022-07-04 04:28:57.245352 (Thread-86): sending response (<Response 139 bytes [200 OK]>) to 10.0.12.141
2022-07-04 04:28:57.273844 (MainThread): 04:28:57  Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '168e3b6e-06be-4858-bfdc-c2e34133fbe6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f66cb9ca400>]}
2022-07-04 04:28:57.274424 (MainThread): 04:28:57  Found 8 models, 0 tests, 0 snapshots, 0 analyses, 179 macros, 0 operations, 0 seed files, 15 sources, 0 exposures, 0 metrics
2022-07-04 04:28:57.275039 (Thread-1): 04:28:57  Acquiring new snowflake connection "rpc.ecommerce_data_model_dbt.request"
2022-07-04 04:28:57.275172 (Thread-1): 04:28:57  Began compiling node rpc.ecommerce_data_model_dbt.request
2022-07-04 04:28:57.275264 (Thread-1): 04:28:57  Compiling rpc.ecommerce_data_model_dbt.request
2022-07-04 04:28:57.279184 (Thread-1): 04:28:57  finished collecting timing info
2022-07-04 04:28:57.279320 (Thread-1): 04:28:57  Began executing node rpc.ecommerce_data_model_dbt.request
2022-07-04 04:28:57.281345 (Thread-1): 04:28:57  Using snowflake connection "rpc.ecommerce_data_model_dbt.request"
2022-07-04 04:28:57.281445 (Thread-1): 04:28:57  On rpc.ecommerce_data_model_dbt.request: with cte_gender as 
(select user_id, gender from 
(select user_id, properties_gender as gender, row_number() over(partition by user_id order by timestamp desc) as rn from 
analytics_db.data_apps_simulated.identifies where timestamp >= '2021-05-01' and timestamp <= '2022-06-29'
and properties_gender is not null and properties_gender != '') where rn = 1),

cte_age as 
(select user_id, age from
(select user_id, 
(CASE WHEN dateadd(year, datediff (year, properties_birthday, getdate()), properties_birthday) > getdate()
      THEN datediff(year, properties_birthday, getdate()) - 1
      ELSE datediff(year, properties_birthday, getdate())
 END) as age, row_number() over(partition by user_id order by timestamp desc) as rn 
from analytics_db.data_apps_simulated.identifies where timestamp >= '2021-05-01' and timestamp <= '2022-06-29'
and properties_birthday is not null and properties_birthday!='') where rn = 1),

cte_country as 
(select user_id, country from 
(select user_id, properties_country as country, row_number() over(partition by user_id order by timestamp desc) as rn from 
analytics_db.data_apps_simulated.identifies where timestamp >= '2021-05-01' and timestamp <= '2022-06-29'
and properties_country is not null and properties_country != '') where rn = 1)

select coalesce(a.user_id, b.user_id, c.user_id) 
as user_id, gender, age, country 
from (cte_gender a full outer join cte_age b on a.user_id = b.user_id) full outer join cte_country c on c.user_id = user_id
limit 500
/* limit added automatically by dbt cloud */
2022-07-04 04:28:57.281529 (Thread-1): 04:28:57  Opening a new connection, currently in state init
2022-07-04 04:28:57.625531 (Thread-87): handling poll request
2022-07-04 04:28:57.626047 (Thread-87): 04:28:57  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '08022227-1dd0-4d09-94f1-e256bf2507d1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb1604b7610>]}
2022-07-04 04:28:57.626905 (Thread-87): sending response (<Response 5286 bytes [200 OK]>) to 10.0.12.141
2022-07-04 04:28:58.012434 (Thread-1): 04:28:58  Snowflake adapter: Snowflake query id: 01a55fac-0602-327e-0019-82030465ca02
2022-07-04 04:28:58.012633 (Thread-1): 04:28:58  Snowflake adapter: Snowflake error: 002028 (42601): SQL compilation error:
ambiguous column name 'USER_ID'
2022-07-04 04:28:58.012811 (Thread-1): 04:28:58  finished collecting timing info
2022-07-04 04:28:58.012974 (Thread-1): 04:28:58  On rpc.ecommerce_data_model_dbt.request: Close
2022-07-04 04:28:58.085354 (Thread-1): Got an exception: Database Error
  002028 (42601): SQL compilation error:
  ambiguous column name 'USER_ID'
Traceback (most recent call last):
  File "/usr/local/lib/python3.8/dist-packages/dbt/adapters/snowflake/connections.py", line 206, in exception_handler
    yield
  File "/usr/local/lib/python3.8/dist-packages/dbt/adapters/sql/connections.py", line 74, in add_query
    cursor.execute(sql, bindings)
  File "/usr/local/lib/python3.8/dist-packages/snowflake/connector/cursor.py", line 721, in execute
    Error.errorhandler_wrapper(
  File "/usr/local/lib/python3.8/dist-packages/snowflake/connector/errors.py", line 258, in errorhandler_wrapper
    cursor.errorhandler(connection, cursor, error_class, error_value)
  File "/usr/local/lib/python3.8/dist-packages/snowflake/connector/errors.py", line 188, in default_errorhandler
    raise error_class(
snowflake.connector.errors.ProgrammingError: 002028 (42601): SQL compilation error:
ambiguous column name 'USER_ID'

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/usr/local/lib/python3.8/dist-packages/dbt/task/base.py", line 361, in safe_run
    result = self.compile_and_execute(manifest, ctx)
  File "/usr/local/lib/python3.8/dist-packages/dbt/task/base.py", line 314, in compile_and_execute
    result = self.run(ctx.node, manifest)
  File "/usr/local/lib/python3.8/dist-packages/dbt/task/base.py", line 403, in run
    return self.execute(compiled_node, manifest)
  File "/usr/local/lib/python3.8/dist-packages/dbt_rpc/rpc/node_runners.py", line 90, in execute
    _, execute_result = self.adapter.execute(
  File "/usr/local/lib/python3.8/dist-packages/dbt/adapters/base/impl.py", line 225, in execute
    return self.connections.execute(
  File "/usr/local/lib/python3.8/dist-packages/dbt/adapters/sql/connections.py", line 127, in execute
    _, cursor = self.add_query(sql, auto_begin)
  File "/usr/local/lib/python3.8/dist-packages/dbt/adapters/snowflake/connections.py", line 433, in add_query
    connection, cursor = super().add_query(
  File "/usr/local/lib/python3.8/dist-packages/dbt/adapters/sql/connections.py", line 83, in add_query
    return connection, cursor
  File "/usr/lib/python3.8/contextlib.py", line 131, in __exit__
    self.gen.throw(type, value, traceback)
  File "/usr/local/lib/python3.8/dist-packages/dbt/adapters/snowflake/connections.py", line 223, in exception_handler
    raise DatabaseException(msg)
dbt.exceptions.DatabaseException: Database Error
  002028 (42601): SQL compilation error:
  ambiguous column name 'USER_ID'
2022-07-04 04:28:58.086382 (Thread-1): Got exception RPCException(10003, Database Error, {'type': 'DatabaseException', 'message': "Database Error in rpc request (from remote system)\n  002028 (42601): SQL compilation error:\n  ambiguous column name 'USER_ID'", 'raw_sql': "with cte_gender as \n(select user_id, gender from \n(select user_id, properties_gender as gender, row_number() over(partition by user_id order by timestamp desc) as rn from \n{{ source('ecommerce', 'identifies') }} where timestamp >= '{{ var('start_date') }}' and timestamp <= '{{ var('end_date') }}'\nand properties_gender is not null and properties_gender != '') where rn = 1),\n\ncte_age as \n(select user_id, age from\n(select user_id, \n(CASE WHEN dateadd(year, datediff (year, properties_birthday, getdate()), properties_birthday) > getdate()\n      THEN datediff(year, properties_birthday, getdate()) - 1\n      ELSE datediff(year, properties_birthday, getdate())\n END) as age, row_number() over(partition by user_id order by timestamp desc) as rn \nfrom {{ source('ecommerce', 'identifies') }} where timestamp >= '{{ var('start_date') }}' and timestamp <= '{{ var('end_date') }}'\nand properties_birthday is not null and properties_birthday!='') where rn = 1),\n\ncte_country as \n(select user_id, country from \n(select user_id, properties_country as country, row_number() over(partition by user_id order by timestamp desc) as rn from \n{{ source('ecommerce', 'identifies') }} where timestamp >= '{{ var('start_date') }}' and timestamp <= '{{ var('end_date') }}'\nand properties_country is not null and properties_country != '') where rn = 1)\n\nselect coalesce(a.user_id, b.user_id, c.user_id) \nas user_id, gender, age, country \nfrom (cte_gender a full outer join cte_age b on a.user_id = b.user_id) full outer join cte_country c on c.user_id = user_id\nlimit 500\n/* limit added automatically by dbt cloud */", 'compiled_sql': "with cte_gender as \n(select user_id, gender from \n(select user_id, properties_gender as gender, row_number() over(partition by user_id order by timestamp desc) as rn from \nanalytics_db.data_apps_simulated.identifies where timestamp >= '2021-05-01' and timestamp <= '2022-06-29'\nand properties_gender is not null and properties_gender != '') where rn = 1),\n\ncte_age as \n(select user_id, age from\n(select user_id, \n(CASE WHEN dateadd(year, datediff (year, properties_birthday, getdate()), properties_birthday) > getdate()\n      THEN datediff(year, properties_birthday, getdate()) - 1\n      ELSE datediff(year, properties_birthday, getdate())\n END) as age, row_number() over(partition by user_id order by timestamp desc) as rn \nfrom analytics_db.data_apps_simulated.identifies where timestamp >= '2021-05-01' and timestamp <= '2022-06-29'\nand properties_birthday is not null and properties_birthday!='') where rn = 1),\n\ncte_country as \n(select user_id, country from \n(select user_id, properties_country as country, row_number() over(partition by user_id order by timestamp desc) as rn from \nanalytics_db.data_apps_simulated.identifies where timestamp >= '2021-05-01' and timestamp <= '2022-06-29'\nand properties_country is not null and properties_country != '') where rn = 1)\n\nselect coalesce(a.user_id, b.user_id, c.user_id) \nas user_id, gender, age, country \nfrom (cte_gender a full outer join cte_age b on a.user_id = b.user_id) full outer join cte_country c on c.user_id = user_id\nlimit 500\n/* limit added automatically by dbt cloud */", 'tags': None}, None)
Traceback (most recent call last):
  File "/usr/local/lib/python3.8/dist-packages/dbt_rpc/task/sql_commands.py", line 147, in _in_thread
    self.node_results.append(runner.safe_run(self.manifest))
  File "/usr/local/lib/python3.8/dist-packages/dbt/task/base.py", line 377, in safe_run
    result = self.error_result(ctx.node, error, started, [])
  File "/usr/local/lib/python3.8/dist-packages/dbt_rpc/rpc/node_runners.py", line 56, in error_result
    raise error
dbt_rpc.rpc.error.RPCException: RPCException(10003, Database Error, {'type': 'DatabaseException', 'message': "Database Error in rpc request (from remote system)\n  002028 (42601): SQL compilation error:\n  ambiguous column name 'USER_ID'", 'raw_sql': "with cte_gender as \n(select user_id, gender from \n(select user_id, properties_gender as gender, row_number() over(partition by user_id order by timestamp desc) as rn from \n{{ source('ecommerce', 'identifies') }} where timestamp >= '{{ var('start_date') }}' and timestamp <= '{{ var('end_date') }}'\nand properties_gender is not null and properties_gender != '') where rn = 1),\n\ncte_age as \n(select user_id, age from\n(select user_id, \n(CASE WHEN dateadd(year, datediff (year, properties_birthday, getdate()), properties_birthday) > getdate()\n      THEN datediff(year, properties_birthday, getdate()) - 1\n      ELSE datediff(year, properties_birthday, getdate())\n END) as age, row_number() over(partition by user_id order by timestamp desc) as rn \nfrom {{ source('ecommerce', 'identifies') }} where timestamp >= '{{ var('start_date') }}' and timestamp <= '{{ var('end_date') }}'\nand properties_birthday is not null and properties_birthday!='') where rn = 1),\n\ncte_country as \n(select user_id, country from \n(select user_id, properties_country as country, row_number() over(partition by user_id order by timestamp desc) as rn from \n{{ source('ecommerce', 'identifies') }} where timestamp >= '{{ var('start_date') }}' and timestamp <= '{{ var('end_date') }}'\nand properties_country is not null and properties_country != '') where rn = 1)\n\nselect coalesce(a.user_id, b.user_id, c.user_id) \nas user_id, gender, age, country \nfrom (cte_gender a full outer join cte_age b on a.user_id = b.user_id) full outer join cte_country c on c.user_id = user_id\nlimit 500\n/* limit added automatically by dbt cloud */", 'compiled_sql': "with cte_gender as \n(select user_id, gender from \n(select user_id, properties_gender as gender, row_number() over(partition by user_id order by timestamp desc) as rn from \nanalytics_db.data_apps_simulated.identifies where timestamp >= '2021-05-01' and timestamp <= '2022-06-29'\nand properties_gender is not null and properties_gender != '') where rn = 1),\n\ncte_age as \n(select user_id, age from\n(select user_id, \n(CASE WHEN dateadd(year, datediff (year, properties_birthday, getdate()), properties_birthday) > getdate()\n      THEN datediff(year, properties_birthday, getdate()) - 1\n      ELSE datediff(year, properties_birthday, getdate())\n END) as age, row_number() over(partition by user_id order by timestamp desc) as rn \nfrom analytics_db.data_apps_simulated.identifies where timestamp >= '2021-05-01' and timestamp <= '2022-06-29'\nand properties_birthday is not null and properties_birthday!='') where rn = 1),\n\ncte_country as \n(select user_id, country from \n(select user_id, properties_country as country, row_number() over(partition by user_id order by timestamp desc) as rn from \nanalytics_db.data_apps_simulated.identifies where timestamp >= '2021-05-01' and timestamp <= '2022-06-29'\nand properties_country is not null and properties_country != '') where rn = 1)\n\nselect coalesce(a.user_id, b.user_id, c.user_id) \nas user_id, gender, age, country \nfrom (cte_gender a full outer join cte_age b on a.user_id = b.user_id) full outer join cte_country c on c.user_id = user_id\nlimit 500\n/* limit added automatically by dbt cloud */", 'tags': None}, None)
2022-07-04 04:28:58.989496 (Thread-88): handling poll request
2022-07-04 04:28:58.989904 (Thread-88): 04:28:58  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '08022227-1dd0-4d09-94f1-e256bf2507d1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb16050b1f0>]}
2022-07-04 04:28:58.990609 (Thread-88): sending response (<Response 20414 bytes [200 OK]>) to 10.0.12.141
2022-07-04 04:34:30.124453 (Thread-89): handling status request
2022-07-04 04:34:30.126511 (Thread-89): 04:34:30  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '08022227-1dd0-4d09-94f1-e256bf2507d1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb1605041f0>]}
2022-07-04 04:34:30.127072 (Thread-89): sending response (<Response 2351 bytes [200 OK]>) to 10.0.12.141
2022-07-04 04:34:30.489606 (Thread-90): handling run_sql request
2022-07-04 04:34:30.490052 (Thread-90): 04:34:30  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '08022227-1dd0-4d09-94f1-e256bf2507d1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb1605042b0>]}
2022-07-04 04:34:32.888529 (Thread-90): sending response (<Response 139 bytes [200 OK]>) to 10.0.12.141
2022-07-04 04:34:32.918022 (MainThread): 04:34:32  Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'e79681e3-218f-4aaa-b23c-977ec132e99f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f73d967b5b0>]}
2022-07-04 04:34:32.918623 (MainThread): 04:34:32  Found 8 models, 0 tests, 0 snapshots, 0 analyses, 179 macros, 0 operations, 0 seed files, 15 sources, 0 exposures, 0 metrics
2022-07-04 04:34:32.919258 (Thread-1): 04:34:32  Acquiring new snowflake connection "rpc.ecommerce_data_model_dbt.request"
2022-07-04 04:34:32.919389 (Thread-1): 04:34:32  Began compiling node rpc.ecommerce_data_model_dbt.request
2022-07-04 04:34:32.919481 (Thread-1): 04:34:32  Compiling rpc.ecommerce_data_model_dbt.request
2022-07-04 04:34:32.923551 (Thread-1): 04:34:32  finished collecting timing info
2022-07-04 04:34:32.923687 (Thread-1): 04:34:32  Began executing node rpc.ecommerce_data_model_dbt.request
2022-07-04 04:34:32.925725 (Thread-1): 04:34:32  Using snowflake connection "rpc.ecommerce_data_model_dbt.request"
2022-07-04 04:34:32.925823 (Thread-1): 04:34:32  On rpc.ecommerce_data_model_dbt.request: with cte_gender as 
(select user_id, gender from 
(select user_id, properties_gender as gender, row_number() over(partition by user_id order by timestamp desc) as rn from 
analytics_db.data_apps_simulated.identifies where timestamp >= '2021-05-01' and timestamp <= '2022-06-29'
and properties_gender is not null and properties_gender != '') where rn = 1),

cte_age as 
(select user_id, age from
(select user_id, 
(CASE WHEN dateadd(year, datediff (year, properties_birthday, getdate()), properties_birthday) > getdate()
      THEN datediff(year, properties_birthday, getdate()) - 1
      ELSE datediff(year, properties_birthday, getdate())
 END) as age, row_number() over(partition by user_id order by timestamp desc) as rn 
from analytics_db.data_apps_simulated.identifies where timestamp >= '2021-05-01' and timestamp <= '2022-06-29'
and properties_birthday is not null and properties_birthday!='') where rn = 1),

cte_country as 
(select user_id, country from 
(select user_id, properties_country as country, row_number() over(partition by user_id order by timestamp desc) as rn from 
analytics_db.data_apps_simulated.identifies where timestamp >= '2021-05-01' and timestamp <= '2022-06-29'
and properties_country is not null and properties_country != '') where rn = 1)

select coalesce(a.user_id, b.user_id, c.user_id) 
as user_id, gender, age, country 
from (cte_gender a full outer join cte_age b on a.user_id = b.user_id) full outer join cte_country c on b.user_id = c.user_id
limit 500
/* limit added automatically by dbt cloud */
2022-07-04 04:34:32.925906 (Thread-1): 04:34:32  Opening a new connection, currently in state init
2022-07-04 04:34:33.251358 (Thread-91): handling poll request
2022-07-04 04:34:33.251890 (Thread-91): 04:34:33  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '08022227-1dd0-4d09-94f1-e256bf2507d1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb160504370>]}
2022-07-04 04:34:33.252777 (Thread-91): sending response (<Response 5288 bytes [200 OK]>) to 10.0.12.141
2022-07-04 04:34:33.676669 (Thread-92): handling status request
2022-07-04 04:34:33.677072 (Thread-92): 04:34:33  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '08022227-1dd0-4d09-94f1-e256bf2507d1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb160505b50>]}
2022-07-04 04:34:33.681538 (Thread-93): handling status request
2022-07-04 04:34:33.682047 (Thread-93): 04:34:33  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '08022227-1dd0-4d09-94f1-e256bf2507d1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb1604ff220>]}
2022-07-04 04:34:33.699013 (Thread-92): sending response (<Response 2328 bytes [200 OK]>) to 10.0.12.141
2022-07-04 04:34:33.699486 (Thread-93): sending response (<Response 2328 bytes [200 OK]>) to 10.0.12.141
2022-07-04 04:34:33.708946 (Thread-94): handling list request
2022-07-04 04:34:33.709292 (Thread-94): 04:34:33  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '08022227-1dd0-4d09-94f1-e256bf2507d1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb160505df0>]}
2022-07-04 04:34:33.845605 (Thread-95): handling list request
2022-07-04 04:34:33.847570 (Thread-95): 04:34:33  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '08022227-1dd0-4d09-94f1-e256bf2507d1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb19c3e2dc0>]}
2022-07-04 04:34:33.885937 (Thread-94): sending response (<Response 1772 bytes [200 OK]>) to 10.0.12.141
2022-07-04 04:34:33.877252 (Thread-94): 04:34:33  Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '08022227-1dd0-4d09-94f1-e256bf2507d1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb16d343130>]}
2022-07-04 04:34:33.877551 (Thread-94): 04:34:33  Found 8 models, 0 tests, 0 snapshots, 0 analyses, 179 macros, 0 operations, 0 seed files, 15 sources, 0 exposures, 0 metrics
2022-07-04 04:34:33.878151 (Thread-95): 04:34:33  Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '08022227-1dd0-4d09-94f1-e256bf2507d1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb16d343220>]}
2022-07-04 04:34:33.878414 (Thread-95): 04:34:33  Found 8 models, 0 tests, 0 snapshots, 0 analyses, 179 macros, 0 operations, 0 seed files, 15 sources, 0 exposures, 0 metrics
2022-07-04 04:34:33.887480 (Thread-95): sending response (<Response 3197 bytes [200 OK]>) to 10.0.12.141
2022-07-04 04:34:33.919131 (Thread-1): 04:34:33  SQL status: SUCCESS 7 in 0.99 seconds
2022-07-04 04:34:33.920644 (Thread-1): 04:34:33  finished collecting timing info
2022-07-04 04:34:33.920820 (Thread-1): 04:34:33  On rpc.ecommerce_data_model_dbt.request: Close
2022-07-04 04:34:34.615330 (Thread-96): handling poll request
2022-07-04 04:34:34.615731 (Thread-96): 04:34:34  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '08022227-1dd0-4d09-94f1-e256bf2507d1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb16d349be0>]}
2022-07-04 04:34:34.616541 (Thread-96): sending response (<Response 9977 bytes [200 OK]>) to 10.0.12.141
2022-07-04 04:35:24.919538 (Thread-97): handling status request
2022-07-04 04:35:24.919948 (Thread-97): 04:35:24  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '08022227-1dd0-4d09-94f1-e256bf2507d1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb16d349e20>]}
2022-07-04 04:35:24.920465 (Thread-97): sending response (<Response 2351 bytes [200 OK]>) to 10.0.12.141
2022-07-04 04:35:25.315544 (Thread-98): handling run_sql request
2022-07-04 04:35:25.315944 (Thread-98): 04:35:25  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '08022227-1dd0-4d09-94f1-e256bf2507d1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb16d349e50>]}
2022-07-04 04:35:27.625707 (Thread-98): sending response (<Response 139 bytes [200 OK]>) to 10.0.12.141
2022-07-04 04:35:27.653053 (MainThread): 04:35:27  Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '445a6247-d72d-4aaa-9808-643037931136', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9f7c74a640>]}
2022-07-04 04:35:27.653633 (MainThread): 04:35:27  Found 8 models, 0 tests, 0 snapshots, 0 analyses, 179 macros, 0 operations, 0 seed files, 15 sources, 0 exposures, 0 metrics
2022-07-04 04:35:27.654266 (Thread-1): 04:35:27  Acquiring new snowflake connection "rpc.ecommerce_data_model_dbt.request"
2022-07-04 04:35:27.654398 (Thread-1): 04:35:27  Began compiling node rpc.ecommerce_data_model_dbt.request
2022-07-04 04:35:27.654492 (Thread-1): 04:35:27  Compiling rpc.ecommerce_data_model_dbt.request
2022-07-04 04:35:27.658468 (Thread-1): 04:35:27  finished collecting timing info
2022-07-04 04:35:27.658602 (Thread-1): 04:35:27  Began executing node rpc.ecommerce_data_model_dbt.request
2022-07-04 04:35:27.660546 (Thread-1): 04:35:27  Using snowflake connection "rpc.ecommerce_data_model_dbt.request"
2022-07-04 04:35:27.660644 (Thread-1): 04:35:27  On rpc.ecommerce_data_model_dbt.request: with cte_gender as 
(select user_id, gender from 
(select user_id, properties_gender as gender, row_number() over(partition by user_id order by timestamp desc) as rn from 
analytics_db.data_apps_simulated.identifies where timestamp >= '2021-05-01' and timestamp <= '2022-06-29'
and properties_gender is not null and properties_gender != '') where rn = 1),

cte_age as 
(select user_id, age from
(select user_id, 
(CASE WHEN dateadd(year, datediff (year, properties_birthday, getdate()), properties_birthday) > getdate()
      THEN datediff(year, properties_birthday, getdate()) - 1
      ELSE datediff(year, properties_birthday, getdate())
 END) as age, row_number() over(partition by user_id order by timestamp desc) as rn 
from analytics_db.data_apps_simulated.identifies where timestamp >= '2021-05-01' and timestamp <= '2022-06-29'
and properties_birthday is not null and properties_birthday!='') where rn = 1),

cte_country as 
(select user_id, country from 
(select user_id, properties_country as country, row_number() over(partition by user_id order by timestamp desc) as rn from 
analytics_db.data_apps_simulated.identifies where timestamp >= '2021-05-01' and timestamp <= '2022-06-29'
and properties_country is not null and properties_country != '') where rn = 1)

select coalesce(a.user_id, b.user_id) 
as user_id, gender, age 
from cte_gender a full outer join cte_age b on a.user_id = b.user_id
limit 500
/* limit added automatically by dbt cloud */
2022-07-04 04:35:27.660725 (Thread-1): 04:35:27  Opening a new connection, currently in state init
2022-07-04 04:35:28.024592 (Thread-99): handling poll request
2022-07-04 04:35:28.025126 (Thread-99): 04:35:28  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '08022227-1dd0-4d09-94f1-e256bf2507d1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb16d3423d0>]}
2022-07-04 04:35:28.026063 (Thread-99): sending response (<Response 5210 bytes [200 OK]>) to 10.0.12.141
2022-07-04 04:35:28.657043 (Thread-1): 04:35:28  SQL status: SUCCESS 5 in 1.0 seconds
2022-07-04 04:35:28.658606 (Thread-1): 04:35:28  finished collecting timing info
2022-07-04 04:35:28.658785 (Thread-1): 04:35:28  On rpc.ecommerce_data_model_dbt.request: Close
2022-07-04 04:35:29.403759 (Thread-100): handling poll request
2022-07-04 04:35:29.404168 (Thread-100): 04:35:29  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '08022227-1dd0-4d09-94f1-e256bf2507d1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb16d34cbb0>]}
2022-07-04 04:35:29.405116 (Thread-100): sending response (<Response 9566 bytes [200 OK]>) to 10.0.12.141
2022-07-04 04:35:52.851205 (Thread-101): handling status request
2022-07-04 04:35:52.851623 (Thread-101): 04:35:52  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '08022227-1dd0-4d09-94f1-e256bf2507d1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb16d34cd00>]}
2022-07-04 04:35:52.852182 (Thread-101): sending response (<Response 2351 bytes [200 OK]>) to 10.0.12.141
2022-07-04 04:35:53.247896 (Thread-102): handling run_sql request
2022-07-04 04:35:53.248315 (Thread-102): 04:35:53  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '08022227-1dd0-4d09-94f1-e256bf2507d1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb16d34ce80>]}
2022-07-04 04:35:55.592269 (Thread-102): sending response (<Response 139 bytes [200 OK]>) to 10.0.12.141
2022-07-04 04:35:55.620817 (MainThread): 04:35:55  Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'c7d8a0df-b848-4cc2-8d16-e2b9789bac95', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f942a1ca640>]}
2022-07-04 04:35:55.621403 (MainThread): 04:35:55  Found 8 models, 0 tests, 0 snapshots, 0 analyses, 179 macros, 0 operations, 0 seed files, 15 sources, 0 exposures, 0 metrics
2022-07-04 04:35:55.622029 (Thread-1): 04:35:55  Acquiring new snowflake connection "rpc.ecommerce_data_model_dbt.request"
2022-07-04 04:35:55.622170 (Thread-1): 04:35:55  Began compiling node rpc.ecommerce_data_model_dbt.request
2022-07-04 04:35:55.622271 (Thread-1): 04:35:55  Compiling rpc.ecommerce_data_model_dbt.request
2022-07-04 04:35:55.626266 (Thread-1): 04:35:55  finished collecting timing info
2022-07-04 04:35:55.626397 (Thread-1): 04:35:55  Began executing node rpc.ecommerce_data_model_dbt.request
2022-07-04 04:35:55.628350 (Thread-1): 04:35:55  Using snowflake connection "rpc.ecommerce_data_model_dbt.request"
2022-07-04 04:35:55.628460 (Thread-1): 04:35:55  On rpc.ecommerce_data_model_dbt.request: with cte_gender as 
(select user_id, gender from 
(select user_id, properties_gender as gender, row_number() over(partition by user_id order by timestamp desc) as rn from 
analytics_db.data_apps_simulated.identifies where timestamp >= '2021-05-01' and timestamp <= '2022-06-29'
and properties_gender is not null and properties_gender != '') where rn = 1),

cte_age as 
(select user_id, age from
(select user_id, 
(CASE WHEN dateadd(year, datediff (year, properties_birthday, getdate()), properties_birthday) > getdate()
      THEN datediff(year, properties_birthday, getdate()) - 1
      ELSE datediff(year, properties_birthday, getdate())
 END) as age, row_number() over(partition by user_id order by timestamp desc) as rn 
from analytics_db.data_apps_simulated.identifies where timestamp >= '2021-05-01' and timestamp <= '2022-06-29'
and properties_birthday is not null and properties_birthday!='') where rn = 1),

cte_country as 
(select user_id, country from 
(select user_id, properties_country as country, row_number() over(partition by user_id order by timestamp desc) as rn from 
analytics_db.data_apps_simulated.identifies where timestamp >= '2021-05-01' and timestamp <= '2022-06-29'
and properties_country is not null and properties_country != '') where rn = 1)

select coalesce(a.user_id, c.user_id) 
as user_id, gender, country 
from cte_gender a full outer join cte_country c on a.user_id = c.user_id
limit 500
/* limit added automatically by dbt cloud */
2022-07-04 04:35:55.628543 (Thread-1): 04:35:55  Opening a new connection, currently in state init
2022-07-04 04:35:56.010945 (Thread-103): handling poll request
2022-07-04 04:35:56.011463 (Thread-103): 04:35:56  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '08022227-1dd0-4d09-94f1-e256bf2507d1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb16d352190>]}
2022-07-04 04:35:56.012353 (Thread-103): sending response (<Response 5219 bytes [200 OK]>) to 10.0.12.141
2022-07-04 04:35:56.702685 (Thread-1): 04:35:56  SQL status: SUCCESS 5 in 1.07 seconds
2022-07-04 04:35:56.704061 (Thread-1): 04:35:56  finished collecting timing info
2022-07-04 04:35:56.704237 (Thread-1): 04:35:56  On rpc.ecommerce_data_model_dbt.request: Close
2022-07-04 04:35:57.383713 (Thread-104): handling poll request
2022-07-04 04:35:57.384160 (Thread-104): 04:35:57  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '08022227-1dd0-4d09-94f1-e256bf2507d1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb16d359d60>]}
2022-07-04 04:35:57.385052 (Thread-104): sending response (<Response 9609 bytes [200 OK]>) to 10.0.12.141
2022-07-04 04:36:16.626153 (Thread-105): handling status request
2022-07-04 04:36:16.626563 (Thread-105): 04:36:16  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '08022227-1dd0-4d09-94f1-e256bf2507d1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb16d3528b0>]}
2022-07-04 04:36:16.627542 (Thread-105): sending response (<Response 2351 bytes [200 OK]>) to 10.0.12.141
2022-07-04 04:36:17.014785 (Thread-106): handling run_sql request
2022-07-04 04:36:17.015211 (Thread-106): 04:36:17  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '08022227-1dd0-4d09-94f1-e256bf2507d1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb16d342490>]}
2022-07-04 04:36:19.328512 (Thread-106): sending response (<Response 139 bytes [200 OK]>) to 10.0.12.141
2022-07-04 04:36:19.355408 (MainThread): 04:36:19  Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '7ac8b0e4-8f40-4dcf-82d9-7f1e1b68904c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe36f78a4c0>]}
2022-07-04 04:36:19.355952 (MainThread): 04:36:19  Found 8 models, 0 tests, 0 snapshots, 0 analyses, 179 macros, 0 operations, 0 seed files, 15 sources, 0 exposures, 0 metrics
2022-07-04 04:36:19.356562 (Thread-1): 04:36:19  Acquiring new snowflake connection "rpc.ecommerce_data_model_dbt.request"
2022-07-04 04:36:19.356695 (Thread-1): 04:36:19  Began compiling node rpc.ecommerce_data_model_dbt.request
2022-07-04 04:36:19.356787 (Thread-1): 04:36:19  Compiling rpc.ecommerce_data_model_dbt.request
2022-07-04 04:36:19.360672 (Thread-1): 04:36:19  finished collecting timing info
2022-07-04 04:36:19.360805 (Thread-1): 04:36:19  Began executing node rpc.ecommerce_data_model_dbt.request
2022-07-04 04:36:19.362747 (Thread-1): 04:36:19  Using snowflake connection "rpc.ecommerce_data_model_dbt.request"
2022-07-04 04:36:19.362844 (Thread-1): 04:36:19  On rpc.ecommerce_data_model_dbt.request: with cte_gender as 
(select user_id, gender from 
(select user_id, properties_gender as gender, row_number() over(partition by user_id order by timestamp desc) as rn from 
analytics_db.data_apps_simulated.identifies where timestamp >= '2021-05-01' and timestamp <= '2022-06-29'
and properties_gender is not null and properties_gender != '') where rn = 1),

cte_age as 
(select user_id, age from
(select user_id, 
(CASE WHEN dateadd(year, datediff (year, properties_birthday, getdate()), properties_birthday) > getdate()
      THEN datediff(year, properties_birthday, getdate()) - 1
      ELSE datediff(year, properties_birthday, getdate())
 END) as age, row_number() over(partition by user_id order by timestamp desc) as rn 
from analytics_db.data_apps_simulated.identifies where timestamp >= '2021-05-01' and timestamp <= '2022-06-29'
and properties_birthday is not null and properties_birthday!='') where rn = 1),

cte_country as 
(select user_id, country from 
(select user_id, properties_country as country, row_number() over(partition by user_id order by timestamp desc) as rn from 
analytics_db.data_apps_simulated.identifies where timestamp >= '2021-05-01' and timestamp <= '2022-06-29'
and properties_country is not null and properties_country != '') where rn = 1)

select coalesce(b.user_id, c.user_id) 
as user_id, age, country 
from cte_age b full outer join cte_country c on a.user_id = c.user_id
limit 500
/* limit added automatically by dbt cloud */
2022-07-04 04:36:19.362925 (Thread-1): 04:36:19  Opening a new connection, currently in state init
2022-07-04 04:36:19.701383 (Thread-107): handling poll request
2022-07-04 04:36:19.701859 (Thread-107): 04:36:19  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '08022227-1dd0-4d09-94f1-e256bf2507d1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb16d34a070>]}
2022-07-04 04:36:19.702770 (Thread-107): sending response (<Response 5213 bytes [200 OK]>) to 10.0.12.141
2022-07-04 04:36:20.025696 (Thread-1): 04:36:20  Snowflake adapter: Snowflake query id: 01a55fb4-0602-2ed5-0019-82030465d502
2022-07-04 04:36:20.025902 (Thread-1): 04:36:20  Snowflake adapter: Snowflake error: 000904 (42000): SQL compilation error: error line 25 at position 48
invalid identifier 'A.USER_ID'
2022-07-04 04:36:20.026096 (Thread-1): 04:36:20  finished collecting timing info
2022-07-04 04:36:20.026257 (Thread-1): 04:36:20  On rpc.ecommerce_data_model_dbt.request: Close
2022-07-04 04:36:20.090121 (Thread-1): Got an exception: Database Error
  000904 (42000): SQL compilation error: error line 25 at position 48
  invalid identifier 'A.USER_ID'
Traceback (most recent call last):
  File "/usr/local/lib/python3.8/dist-packages/dbt/adapters/snowflake/connections.py", line 206, in exception_handler
    yield
  File "/usr/local/lib/python3.8/dist-packages/dbt/adapters/sql/connections.py", line 74, in add_query
    cursor.execute(sql, bindings)
  File "/usr/local/lib/python3.8/dist-packages/snowflake/connector/cursor.py", line 721, in execute
    Error.errorhandler_wrapper(
  File "/usr/local/lib/python3.8/dist-packages/snowflake/connector/errors.py", line 258, in errorhandler_wrapper
    cursor.errorhandler(connection, cursor, error_class, error_value)
  File "/usr/local/lib/python3.8/dist-packages/snowflake/connector/errors.py", line 188, in default_errorhandler
    raise error_class(
snowflake.connector.errors.ProgrammingError: 000904 (42000): SQL compilation error: error line 25 at position 48
invalid identifier 'A.USER_ID'

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/usr/local/lib/python3.8/dist-packages/dbt/task/base.py", line 361, in safe_run
    result = self.compile_and_execute(manifest, ctx)
  File "/usr/local/lib/python3.8/dist-packages/dbt/task/base.py", line 314, in compile_and_execute
    result = self.run(ctx.node, manifest)
  File "/usr/local/lib/python3.8/dist-packages/dbt/task/base.py", line 403, in run
    return self.execute(compiled_node, manifest)
  File "/usr/local/lib/python3.8/dist-packages/dbt_rpc/rpc/node_runners.py", line 90, in execute
    _, execute_result = self.adapter.execute(
  File "/usr/local/lib/python3.8/dist-packages/dbt/adapters/base/impl.py", line 225, in execute
    return self.connections.execute(
  File "/usr/local/lib/python3.8/dist-packages/dbt/adapters/sql/connections.py", line 127, in execute
    _, cursor = self.add_query(sql, auto_begin)
  File "/usr/local/lib/python3.8/dist-packages/dbt/adapters/snowflake/connections.py", line 433, in add_query
    connection, cursor = super().add_query(
  File "/usr/local/lib/python3.8/dist-packages/dbt/adapters/sql/connections.py", line 83, in add_query
    return connection, cursor
  File "/usr/lib/python3.8/contextlib.py", line 131, in __exit__
    self.gen.throw(type, value, traceback)
  File "/usr/local/lib/python3.8/dist-packages/dbt/adapters/snowflake/connections.py", line 223, in exception_handler
    raise DatabaseException(msg)
dbt.exceptions.DatabaseException: Database Error
  000904 (42000): SQL compilation error: error line 25 at position 48
  invalid identifier 'A.USER_ID'
2022-07-04 04:36:20.091087 (Thread-1): Got exception RPCException(10003, Database Error, {'type': 'DatabaseException', 'message': "Database Error in rpc request (from remote system)\n  000904 (42000): SQL compilation error: error line 25 at position 48\n  invalid identifier 'A.USER_ID'", 'raw_sql': "with cte_gender as \n(select user_id, gender from \n(select user_id, properties_gender as gender, row_number() over(partition by user_id order by timestamp desc) as rn from \n{{ source('ecommerce', 'identifies') }} where timestamp >= '{{ var('start_date') }}' and timestamp <= '{{ var('end_date') }}'\nand properties_gender is not null and properties_gender != '') where rn = 1),\n\ncte_age as \n(select user_id, age from\n(select user_id, \n(CASE WHEN dateadd(year, datediff (year, properties_birthday, getdate()), properties_birthday) > getdate()\n      THEN datediff(year, properties_birthday, getdate()) - 1\n      ELSE datediff(year, properties_birthday, getdate())\n END) as age, row_number() over(partition by user_id order by timestamp desc) as rn \nfrom {{ source('ecommerce', 'identifies') }} where timestamp >= '{{ var('start_date') }}' and timestamp <= '{{ var('end_date') }}'\nand properties_birthday is not null and properties_birthday!='') where rn = 1),\n\ncte_country as \n(select user_id, country from \n(select user_id, properties_country as country, row_number() over(partition by user_id order by timestamp desc) as rn from \n{{ source('ecommerce', 'identifies') }} where timestamp >= '{{ var('start_date') }}' and timestamp <= '{{ var('end_date') }}'\nand properties_country is not null and properties_country != '') where rn = 1)\n\nselect coalesce(b.user_id, c.user_id) \nas user_id, age, country \nfrom cte_age b full outer join cte_country c on a.user_id = c.user_id\nlimit 500\n/* limit added automatically by dbt cloud */", 'compiled_sql': "with cte_gender as \n(select user_id, gender from \n(select user_id, properties_gender as gender, row_number() over(partition by user_id order by timestamp desc) as rn from \nanalytics_db.data_apps_simulated.identifies where timestamp >= '2021-05-01' and timestamp <= '2022-06-29'\nand properties_gender is not null and properties_gender != '') where rn = 1),\n\ncte_age as \n(select user_id, age from\n(select user_id, \n(CASE WHEN dateadd(year, datediff (year, properties_birthday, getdate()), properties_birthday) > getdate()\n      THEN datediff(year, properties_birthday, getdate()) - 1\n      ELSE datediff(year, properties_birthday, getdate())\n END) as age, row_number() over(partition by user_id order by timestamp desc) as rn \nfrom analytics_db.data_apps_simulated.identifies where timestamp >= '2021-05-01' and timestamp <= '2022-06-29'\nand properties_birthday is not null and properties_birthday!='') where rn = 1),\n\ncte_country as \n(select user_id, country from \n(select user_id, properties_country as country, row_number() over(partition by user_id order by timestamp desc) as rn from \nanalytics_db.data_apps_simulated.identifies where timestamp >= '2021-05-01' and timestamp <= '2022-06-29'\nand properties_country is not null and properties_country != '') where rn = 1)\n\nselect coalesce(b.user_id, c.user_id) \nas user_id, age, country \nfrom cte_age b full outer join cte_country c on a.user_id = c.user_id\nlimit 500\n/* limit added automatically by dbt cloud */", 'tags': None}, None)
Traceback (most recent call last):
  File "/usr/local/lib/python3.8/dist-packages/dbt_rpc/task/sql_commands.py", line 147, in _in_thread
    self.node_results.append(runner.safe_run(self.manifest))
  File "/usr/local/lib/python3.8/dist-packages/dbt/task/base.py", line 377, in safe_run
    result = self.error_result(ctx.node, error, started, [])
  File "/usr/local/lib/python3.8/dist-packages/dbt_rpc/rpc/node_runners.py", line 56, in error_result
    raise error
dbt_rpc.rpc.error.RPCException: RPCException(10003, Database Error, {'type': 'DatabaseException', 'message': "Database Error in rpc request (from remote system)\n  000904 (42000): SQL compilation error: error line 25 at position 48\n  invalid identifier 'A.USER_ID'", 'raw_sql': "with cte_gender as \n(select user_id, gender from \n(select user_id, properties_gender as gender, row_number() over(partition by user_id order by timestamp desc) as rn from \n{{ source('ecommerce', 'identifies') }} where timestamp >= '{{ var('start_date') }}' and timestamp <= '{{ var('end_date') }}'\nand properties_gender is not null and properties_gender != '') where rn = 1),\n\ncte_age as \n(select user_id, age from\n(select user_id, \n(CASE WHEN dateadd(year, datediff (year, properties_birthday, getdate()), properties_birthday) > getdate()\n      THEN datediff(year, properties_birthday, getdate()) - 1\n      ELSE datediff(year, properties_birthday, getdate())\n END) as age, row_number() over(partition by user_id order by timestamp desc) as rn \nfrom {{ source('ecommerce', 'identifies') }} where timestamp >= '{{ var('start_date') }}' and timestamp <= '{{ var('end_date') }}'\nand properties_birthday is not null and properties_birthday!='') where rn = 1),\n\ncte_country as \n(select user_id, country from \n(select user_id, properties_country as country, row_number() over(partition by user_id order by timestamp desc) as rn from \n{{ source('ecommerce', 'identifies') }} where timestamp >= '{{ var('start_date') }}' and timestamp <= '{{ var('end_date') }}'\nand properties_country is not null and properties_country != '') where rn = 1)\n\nselect coalesce(b.user_id, c.user_id) \nas user_id, age, country \nfrom cte_age b full outer join cte_country c on a.user_id = c.user_id\nlimit 500\n/* limit added automatically by dbt cloud */", 'compiled_sql': "with cte_gender as \n(select user_id, gender from \n(select user_id, properties_gender as gender, row_number() over(partition by user_id order by timestamp desc) as rn from \nanalytics_db.data_apps_simulated.identifies where timestamp >= '2021-05-01' and timestamp <= '2022-06-29'\nand properties_gender is not null and properties_gender != '') where rn = 1),\n\ncte_age as \n(select user_id, age from\n(select user_id, \n(CASE WHEN dateadd(year, datediff (year, properties_birthday, getdate()), properties_birthday) > getdate()\n      THEN datediff(year, properties_birthday, getdate()) - 1\n      ELSE datediff(year, properties_birthday, getdate())\n END) as age, row_number() over(partition by user_id order by timestamp desc) as rn \nfrom analytics_db.data_apps_simulated.identifies where timestamp >= '2021-05-01' and timestamp <= '2022-06-29'\nand properties_birthday is not null and properties_birthday!='') where rn = 1),\n\ncte_country as \n(select user_id, country from \n(select user_id, properties_country as country, row_number() over(partition by user_id order by timestamp desc) as rn from \nanalytics_db.data_apps_simulated.identifies where timestamp >= '2021-05-01' and timestamp <= '2022-06-29'\nand properties_country is not null and properties_country != '') where rn = 1)\n\nselect coalesce(b.user_id, c.user_id) \nas user_id, age, country \nfrom cte_age b full outer join cte_country c on a.user_id = c.user_id\nlimit 500\n/* limit added automatically by dbt cloud */", 'tags': None}, None)
2022-07-04 04:36:21.068429 (Thread-108): handling poll request
2022-07-04 04:36:21.068855 (Thread-108): 04:36:21  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '08022227-1dd0-4d09-94f1-e256bf2507d1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb16d34a3d0>]}
2022-07-04 04:36:21.069539 (Thread-108): sending response (<Response 20099 bytes [200 OK]>) to 10.0.12.141
2022-07-04 04:36:28.638273 (Thread-109): handling status request
2022-07-04 04:36:28.638685 (Thread-109): 04:36:28  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '08022227-1dd0-4d09-94f1-e256bf2507d1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb16d34a9a0>]}
2022-07-04 04:36:28.639233 (Thread-109): sending response (<Response 2351 bytes [200 OK]>) to 10.0.12.141
2022-07-04 04:36:29.007385 (Thread-110): handling run_sql request
2022-07-04 04:36:29.007802 (Thread-110): 04:36:29  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '08022227-1dd0-4d09-94f1-e256bf2507d1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb16d34aaf0>]}
2022-07-04 04:36:31.335380 (Thread-110): sending response (<Response 139 bytes [200 OK]>) to 10.0.12.141
2022-07-04 04:36:31.362438 (MainThread): 04:36:31  Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '84b71632-a4b5-4871-acbb-ba26776f98da', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fddbd6ca550>]}
2022-07-04 04:36:31.362995 (MainThread): 04:36:31  Found 8 models, 0 tests, 0 snapshots, 0 analyses, 179 macros, 0 operations, 0 seed files, 15 sources, 0 exposures, 0 metrics
2022-07-04 04:36:31.363606 (Thread-1): 04:36:31  Acquiring new snowflake connection "rpc.ecommerce_data_model_dbt.request"
2022-07-04 04:36:31.363725 (Thread-1): 04:36:31  Began compiling node rpc.ecommerce_data_model_dbt.request
2022-07-04 04:36:31.363816 (Thread-1): 04:36:31  Compiling rpc.ecommerce_data_model_dbt.request
2022-07-04 04:36:31.367801 (Thread-1): 04:36:31  finished collecting timing info
2022-07-04 04:36:31.367933 (Thread-1): 04:36:31  Began executing node rpc.ecommerce_data_model_dbt.request
2022-07-04 04:36:31.369895 (Thread-1): 04:36:31  Using snowflake connection "rpc.ecommerce_data_model_dbt.request"
2022-07-04 04:36:31.370033 (Thread-1): 04:36:31  On rpc.ecommerce_data_model_dbt.request: with cte_gender as 
(select user_id, gender from 
(select user_id, properties_gender as gender, row_number() over(partition by user_id order by timestamp desc) as rn from 
analytics_db.data_apps_simulated.identifies where timestamp >= '2021-05-01' and timestamp <= '2022-06-29'
and properties_gender is not null and properties_gender != '') where rn = 1),

cte_age as 
(select user_id, age from
(select user_id, 
(CASE WHEN dateadd(year, datediff (year, properties_birthday, getdate()), properties_birthday) > getdate()
      THEN datediff(year, properties_birthday, getdate()) - 1
      ELSE datediff(year, properties_birthday, getdate())
 END) as age, row_number() over(partition by user_id order by timestamp desc) as rn 
from analytics_db.data_apps_simulated.identifies where timestamp >= '2021-05-01' and timestamp <= '2022-06-29'
and properties_birthday is not null and properties_birthday!='') where rn = 1),

cte_country as 
(select user_id, country from 
(select user_id, properties_country as country, row_number() over(partition by user_id order by timestamp desc) as rn from 
analytics_db.data_apps_simulated.identifies where timestamp >= '2021-05-01' and timestamp <= '2022-06-29'
and properties_country is not null and properties_country != '') where rn = 1)

select coalesce(b.user_id, c.user_id) 
as user_id, age, country 
from cte_age b full outer join cte_country c on b.user_id = c.user_id
limit 500
/* limit added automatically by dbt cloud */
2022-07-04 04:36:31.370120 (Thread-1): 04:36:31  Opening a new connection, currently in state init
2022-07-04 04:36:31.726482 (Thread-111): handling poll request
2022-07-04 04:36:31.726974 (Thread-111): 04:36:31  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '08022227-1dd0-4d09-94f1-e256bf2507d1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb16d35f1f0>]}
2022-07-04 04:36:31.727834 (Thread-111): sending response (<Response 5213 bytes [200 OK]>) to 10.0.12.141
2022-07-04 04:36:32.547535 (Thread-1): 04:36:32  SQL status: SUCCESS 5 in 1.18 seconds
2022-07-04 04:36:32.549064 (Thread-1): 04:36:32  finished collecting timing info
2022-07-04 04:36:32.549249 (Thread-1): 04:36:32  On rpc.ecommerce_data_model_dbt.request: Close
2022-07-04 04:36:33.091697 (Thread-112): handling poll request
2022-07-04 04:36:33.092136 (Thread-112): 04:36:33  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '08022227-1dd0-4d09-94f1-e256bf2507d1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb16d35fd60>]}
2022-07-04 04:36:33.093095 (Thread-112): sending response (<Response 9587 bytes [200 OK]>) to 10.0.12.141
2022-07-04 04:37:08.507781 (Thread-113): handling status request
2022-07-04 04:37:08.508184 (Thread-113): 04:37:08  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '08022227-1dd0-4d09-94f1-e256bf2507d1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb16d2e5550>]}
2022-07-04 04:37:08.508759 (Thread-113): sending response (<Response 2351 bytes [200 OK]>) to 10.0.12.141
2022-07-04 04:37:08.875288 (Thread-114): handling run_sql request
2022-07-04 04:37:08.875701 (Thread-114): 04:37:08  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '08022227-1dd0-4d09-94f1-e256bf2507d1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb16d2e5310>]}
2022-07-04 04:37:11.198998 (Thread-114): sending response (<Response 139 bytes [200 OK]>) to 10.0.12.141
2022-07-04 04:37:11.227406 (MainThread): 04:37:11  Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'dd2342ac-08eb-4350-84ed-e9422f6ba7d7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcd730ca5b0>]}
2022-07-04 04:37:11.227960 (MainThread): 04:37:11  Found 8 models, 0 tests, 0 snapshots, 0 analyses, 179 macros, 0 operations, 0 seed files, 15 sources, 0 exposures, 0 metrics
2022-07-04 04:37:11.228551 (Thread-1): 04:37:11  Acquiring new snowflake connection "rpc.ecommerce_data_model_dbt.request"
2022-07-04 04:37:11.228683 (Thread-1): 04:37:11  Began compiling node rpc.ecommerce_data_model_dbt.request
2022-07-04 04:37:11.228775 (Thread-1): 04:37:11  Compiling rpc.ecommerce_data_model_dbt.request
2022-07-04 04:37:11.232654 (Thread-1): 04:37:11  finished collecting timing info
2022-07-04 04:37:11.232782 (Thread-1): 04:37:11  Began executing node rpc.ecommerce_data_model_dbt.request
2022-07-04 04:37:11.234770 (Thread-1): 04:37:11  Using snowflake connection "rpc.ecommerce_data_model_dbt.request"
2022-07-04 04:37:11.234867 (Thread-1): 04:37:11  On rpc.ecommerce_data_model_dbt.request: with cte_gender as 
(select user_id, gender from 
(select user_id, properties_gender as gender, row_number() over(partition by user_id order by timestamp desc) as rn from 
analytics_db.data_apps_simulated.identifies where timestamp >= '2021-05-01' and timestamp <= '2022-06-29'
and properties_gender is not null and properties_gender != '') where rn = 1),

cte_age as 
(select user_id, age from
(select user_id, 
(CASE WHEN dateadd(year, datediff (year, properties_birthday, getdate()), properties_birthday) > getdate()
      THEN datediff(year, properties_birthday, getdate()) - 1
      ELSE datediff(year, properties_birthday, getdate())
 END) as age, row_number() over(partition by user_id order by timestamp desc) as rn 
from analytics_db.data_apps_simulated.identifies where timestamp >= '2021-05-01' and timestamp <= '2022-06-29'
and properties_birthday is not null and properties_birthday!='') where rn = 1),

cte_country as 
(select user_id, country from 
(select user_id, properties_country as country, row_number() over(partition by user_id order by timestamp desc) as rn from 
analytics_db.data_apps_simulated.identifies where timestamp >= '2021-05-01' and timestamp <= '2022-06-29'
and properties_country is not null and properties_country != '') where rn = 1)

select coalesce(a.user_id, b.user_id, c.user_id) 
as user_id, age, country 
from cte_gender, cte_age b full outer join cte_country c on b.user_id = c.user_id
limit 500
/* limit added automatically by dbt cloud */
2022-07-04 04:37:11.234948 (Thread-1): 04:37:11  Opening a new connection, currently in state init
2022-07-04 04:37:11.576856 (Thread-115): handling poll request
2022-07-04 04:37:11.577357 (Thread-115): 04:37:11  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '08022227-1dd0-4d09-94f1-e256bf2507d1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb16d31c6d0>]}
2022-07-04 04:37:11.578268 (Thread-115): sending response (<Response 5236 bytes [200 OK]>) to 10.0.12.141
2022-07-04 04:37:11.945995 (Thread-1): 04:37:11  Snowflake adapter: Snowflake query id: 01a55fb5-0602-2ed5-0019-82030465d506
2022-07-04 04:37:11.946185 (Thread-1): 04:37:11  Snowflake adapter: Snowflake error: 000904 (42000): SQL compilation error: error line 23 at position 16
invalid identifier 'A.USER_ID'
2022-07-04 04:37:11.946342 (Thread-1): 04:37:11  finished collecting timing info
2022-07-04 04:37:11.946525 (Thread-1): 04:37:11  On rpc.ecommerce_data_model_dbt.request: Close
2022-07-04 04:37:12.366144 (Thread-1): Got an exception: Database Error
  000904 (42000): SQL compilation error: error line 23 at position 16
  invalid identifier 'A.USER_ID'
Traceback (most recent call last):
  File "/usr/local/lib/python3.8/dist-packages/dbt/adapters/snowflake/connections.py", line 206, in exception_handler
    yield
  File "/usr/local/lib/python3.8/dist-packages/dbt/adapters/sql/connections.py", line 74, in add_query
    cursor.execute(sql, bindings)
  File "/usr/local/lib/python3.8/dist-packages/snowflake/connector/cursor.py", line 721, in execute
    Error.errorhandler_wrapper(
  File "/usr/local/lib/python3.8/dist-packages/snowflake/connector/errors.py", line 258, in errorhandler_wrapper
    cursor.errorhandler(connection, cursor, error_class, error_value)
  File "/usr/local/lib/python3.8/dist-packages/snowflake/connector/errors.py", line 188, in default_errorhandler
    raise error_class(
snowflake.connector.errors.ProgrammingError: 000904 (42000): SQL compilation error: error line 23 at position 16
invalid identifier 'A.USER_ID'

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/usr/local/lib/python3.8/dist-packages/dbt/task/base.py", line 361, in safe_run
    result = self.compile_and_execute(manifest, ctx)
  File "/usr/local/lib/python3.8/dist-packages/dbt/task/base.py", line 314, in compile_and_execute
    result = self.run(ctx.node, manifest)
  File "/usr/local/lib/python3.8/dist-packages/dbt/task/base.py", line 403, in run
    return self.execute(compiled_node, manifest)
  File "/usr/local/lib/python3.8/dist-packages/dbt_rpc/rpc/node_runners.py", line 90, in execute
    _, execute_result = self.adapter.execute(
  File "/usr/local/lib/python3.8/dist-packages/dbt/adapters/base/impl.py", line 225, in execute
    return self.connections.execute(
  File "/usr/local/lib/python3.8/dist-packages/dbt/adapters/sql/connections.py", line 127, in execute
    _, cursor = self.add_query(sql, auto_begin)
  File "/usr/local/lib/python3.8/dist-packages/dbt/adapters/snowflake/connections.py", line 433, in add_query
    connection, cursor = super().add_query(
  File "/usr/local/lib/python3.8/dist-packages/dbt/adapters/sql/connections.py", line 83, in add_query
    return connection, cursor
  File "/usr/lib/python3.8/contextlib.py", line 131, in __exit__
    self.gen.throw(type, value, traceback)
  File "/usr/local/lib/python3.8/dist-packages/dbt/adapters/snowflake/connections.py", line 223, in exception_handler
    raise DatabaseException(msg)
dbt.exceptions.DatabaseException: Database Error
  000904 (42000): SQL compilation error: error line 23 at position 16
  invalid identifier 'A.USER_ID'
2022-07-04 04:37:12.367122 (Thread-1): Got exception RPCException(10003, Database Error, {'type': 'DatabaseException', 'message': "Database Error in rpc request (from remote system)\n  000904 (42000): SQL compilation error: error line 23 at position 16\n  invalid identifier 'A.USER_ID'", 'raw_sql': "with cte_gender as \n(select user_id, gender from \n(select user_id, properties_gender as gender, row_number() over(partition by user_id order by timestamp desc) as rn from \n{{ source('ecommerce', 'identifies') }} where timestamp >= '{{ var('start_date') }}' and timestamp <= '{{ var('end_date') }}'\nand properties_gender is not null and properties_gender != '') where rn = 1),\n\ncte_age as \n(select user_id, age from\n(select user_id, \n(CASE WHEN dateadd(year, datediff (year, properties_birthday, getdate()), properties_birthday) > getdate()\n      THEN datediff(year, properties_birthday, getdate()) - 1\n      ELSE datediff(year, properties_birthday, getdate())\n END) as age, row_number() over(partition by user_id order by timestamp desc) as rn \nfrom {{ source('ecommerce', 'identifies') }} where timestamp >= '{{ var('start_date') }}' and timestamp <= '{{ var('end_date') }}'\nand properties_birthday is not null and properties_birthday!='') where rn = 1),\n\ncte_country as \n(select user_id, country from \n(select user_id, properties_country as country, row_number() over(partition by user_id order by timestamp desc) as rn from \n{{ source('ecommerce', 'identifies') }} where timestamp >= '{{ var('start_date') }}' and timestamp <= '{{ var('end_date') }}'\nand properties_country is not null and properties_country != '') where rn = 1)\n\nselect coalesce(a.user_id, b.user_id, c.user_id) \nas user_id, age, country \nfrom cte_gender, cte_age b full outer join cte_country c on b.user_id = c.user_id\nlimit 500\n/* limit added automatically by dbt cloud */", 'compiled_sql': "with cte_gender as \n(select user_id, gender from \n(select user_id, properties_gender as gender, row_number() over(partition by user_id order by timestamp desc) as rn from \nanalytics_db.data_apps_simulated.identifies where timestamp >= '2021-05-01' and timestamp <= '2022-06-29'\nand properties_gender is not null and properties_gender != '') where rn = 1),\n\ncte_age as \n(select user_id, age from\n(select user_id, \n(CASE WHEN dateadd(year, datediff (year, properties_birthday, getdate()), properties_birthday) > getdate()\n      THEN datediff(year, properties_birthday, getdate()) - 1\n      ELSE datediff(year, properties_birthday, getdate())\n END) as age, row_number() over(partition by user_id order by timestamp desc) as rn \nfrom analytics_db.data_apps_simulated.identifies where timestamp >= '2021-05-01' and timestamp <= '2022-06-29'\nand properties_birthday is not null and properties_birthday!='') where rn = 1),\n\ncte_country as \n(select user_id, country from \n(select user_id, properties_country as country, row_number() over(partition by user_id order by timestamp desc) as rn from \nanalytics_db.data_apps_simulated.identifies where timestamp >= '2021-05-01' and timestamp <= '2022-06-29'\nand properties_country is not null and properties_country != '') where rn = 1)\n\nselect coalesce(a.user_id, b.user_id, c.user_id) \nas user_id, age, country \nfrom cte_gender, cte_age b full outer join cte_country c on b.user_id = c.user_id\nlimit 500\n/* limit added automatically by dbt cloud */", 'tags': None}, None)
Traceback (most recent call last):
  File "/usr/local/lib/python3.8/dist-packages/dbt_rpc/task/sql_commands.py", line 147, in _in_thread
    self.node_results.append(runner.safe_run(self.manifest))
  File "/usr/local/lib/python3.8/dist-packages/dbt/task/base.py", line 377, in safe_run
    result = self.error_result(ctx.node, error, started, [])
  File "/usr/local/lib/python3.8/dist-packages/dbt_rpc/rpc/node_runners.py", line 56, in error_result
    raise error
dbt_rpc.rpc.error.RPCException: RPCException(10003, Database Error, {'type': 'DatabaseException', 'message': "Database Error in rpc request (from remote system)\n  000904 (42000): SQL compilation error: error line 23 at position 16\n  invalid identifier 'A.USER_ID'", 'raw_sql': "with cte_gender as \n(select user_id, gender from \n(select user_id, properties_gender as gender, row_number() over(partition by user_id order by timestamp desc) as rn from \n{{ source('ecommerce', 'identifies') }} where timestamp >= '{{ var('start_date') }}' and timestamp <= '{{ var('end_date') }}'\nand properties_gender is not null and properties_gender != '') where rn = 1),\n\ncte_age as \n(select user_id, age from\n(select user_id, \n(CASE WHEN dateadd(year, datediff (year, properties_birthday, getdate()), properties_birthday) > getdate()\n      THEN datediff(year, properties_birthday, getdate()) - 1\n      ELSE datediff(year, properties_birthday, getdate())\n END) as age, row_number() over(partition by user_id order by timestamp desc) as rn \nfrom {{ source('ecommerce', 'identifies') }} where timestamp >= '{{ var('start_date') }}' and timestamp <= '{{ var('end_date') }}'\nand properties_birthday is not null and properties_birthday!='') where rn = 1),\n\ncte_country as \n(select user_id, country from \n(select user_id, properties_country as country, row_number() over(partition by user_id order by timestamp desc) as rn from \n{{ source('ecommerce', 'identifies') }} where timestamp >= '{{ var('start_date') }}' and timestamp <= '{{ var('end_date') }}'\nand properties_country is not null and properties_country != '') where rn = 1)\n\nselect coalesce(a.user_id, b.user_id, c.user_id) \nas user_id, age, country \nfrom cte_gender, cte_age b full outer join cte_country c on b.user_id = c.user_id\nlimit 500\n/* limit added automatically by dbt cloud */", 'compiled_sql': "with cte_gender as \n(select user_id, gender from \n(select user_id, properties_gender as gender, row_number() over(partition by user_id order by timestamp desc) as rn from \nanalytics_db.data_apps_simulated.identifies where timestamp >= '2021-05-01' and timestamp <= '2022-06-29'\nand properties_gender is not null and properties_gender != '') where rn = 1),\n\ncte_age as \n(select user_id, age from\n(select user_id, \n(CASE WHEN dateadd(year, datediff (year, properties_birthday, getdate()), properties_birthday) > getdate()\n      THEN datediff(year, properties_birthday, getdate()) - 1\n      ELSE datediff(year, properties_birthday, getdate())\n END) as age, row_number() over(partition by user_id order by timestamp desc) as rn \nfrom analytics_db.data_apps_simulated.identifies where timestamp >= '2021-05-01' and timestamp <= '2022-06-29'\nand properties_birthday is not null and properties_birthday!='') where rn = 1),\n\ncte_country as \n(select user_id, country from \n(select user_id, properties_country as country, row_number() over(partition by user_id order by timestamp desc) as rn from \nanalytics_db.data_apps_simulated.identifies where timestamp >= '2021-05-01' and timestamp <= '2022-06-29'\nand properties_country is not null and properties_country != '') where rn = 1)\n\nselect coalesce(a.user_id, b.user_id, c.user_id) \nas user_id, age, country \nfrom cte_gender, cte_age b full outer join cte_country c on b.user_id = c.user_id\nlimit 500\n/* limit added automatically by dbt cloud */", 'tags': None}, None)
2022-07-04 04:37:12.959107 (Thread-116): handling poll request
2022-07-04 04:37:12.959519 (Thread-116): 04:37:12  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '08022227-1dd0-4d09-94f1-e256bf2507d1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb16d31c2b0>]}
2022-07-04 04:37:12.960177 (Thread-116): sending response (<Response 20260 bytes [200 OK]>) to 10.0.12.141
2022-07-04 04:37:15.371572 (Thread-117): handling status request
2022-07-04 04:37:15.371993 (Thread-117): 04:37:15  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '08022227-1dd0-4d09-94f1-e256bf2507d1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb16d34ed60>]}
2022-07-04 04:37:15.372584 (Thread-117): sending response (<Response 2351 bytes [200 OK]>) to 10.0.12.141
2022-07-04 04:37:15.785253 (Thread-118): handling run_sql request
2022-07-04 04:37:15.785663 (Thread-118): 04:37:15  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '08022227-1dd0-4d09-94f1-e256bf2507d1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb16d34ed30>]}
2022-07-04 04:37:18.093411 (Thread-118): sending response (<Response 139 bytes [200 OK]>) to 10.0.12.141
2022-07-04 04:37:18.120268 (MainThread): 04:37:18  Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'c9bccba9-0cd4-4a12-a264-12615d75b7e9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7feaff90a6d0>]}
2022-07-04 04:37:18.120838 (MainThread): 04:37:18  Found 8 models, 0 tests, 0 snapshots, 0 analyses, 179 macros, 0 operations, 0 seed files, 15 sources, 0 exposures, 0 metrics
2022-07-04 04:37:18.121503 (Thread-1): 04:37:18  Acquiring new snowflake connection "rpc.ecommerce_data_model_dbt.request"
2022-07-04 04:37:18.121639 (Thread-1): 04:37:18  Began compiling node rpc.ecommerce_data_model_dbt.request
2022-07-04 04:37:18.121730 (Thread-1): 04:37:18  Compiling rpc.ecommerce_data_model_dbt.request
2022-07-04 04:37:18.125603 (Thread-1): 04:37:18  finished collecting timing info
2022-07-04 04:37:18.125753 (Thread-1): 04:37:18  Began executing node rpc.ecommerce_data_model_dbt.request
2022-07-04 04:37:18.127812 (Thread-1): 04:37:18  Using snowflake connection "rpc.ecommerce_data_model_dbt.request"
2022-07-04 04:37:18.127914 (Thread-1): 04:37:18  On rpc.ecommerce_data_model_dbt.request: with cte_gender as 
(select user_id, gender from 
(select user_id, properties_gender as gender, row_number() over(partition by user_id order by timestamp desc) as rn from 
analytics_db.data_apps_simulated.identifies where timestamp >= '2021-05-01' and timestamp <= '2022-06-29'
and properties_gender is not null and properties_gender != '') where rn = 1),

cte_age as 
(select user_id, age from
(select user_id, 
(CASE WHEN dateadd(year, datediff (year, properties_birthday, getdate()), properties_birthday) > getdate()
      THEN datediff(year, properties_birthday, getdate()) - 1
      ELSE datediff(year, properties_birthday, getdate())
 END) as age, row_number() over(partition by user_id order by timestamp desc) as rn 
from analytics_db.data_apps_simulated.identifies where timestamp >= '2021-05-01' and timestamp <= '2022-06-29'
and properties_birthday is not null and properties_birthday!='') where rn = 1),

cte_country as 
(select user_id, country from 
(select user_id, properties_country as country, row_number() over(partition by user_id order by timestamp desc) as rn from 
analytics_db.data_apps_simulated.identifies where timestamp >= '2021-05-01' and timestamp <= '2022-06-29'
and properties_country is not null and properties_country != '') where rn = 1)

select coalesce(a.user_id, b.user_id, c.user_id) 
as user_id, age, country 
from cte_gender a, cte_age b full outer join cte_country c on b.user_id = c.user_id
limit 500
/* limit added automatically by dbt cloud */
2022-07-04 04:37:18.127997 (Thread-1): 04:37:18  Opening a new connection, currently in state init
2022-07-04 04:37:18.458148 (Thread-119): handling poll request
2022-07-04 04:37:18.458625 (Thread-119): 04:37:18  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '08022227-1dd0-4d09-94f1-e256bf2507d1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb16d2ac040>]}
2022-07-04 04:37:18.459470 (Thread-119): sending response (<Response 5238 bytes [200 OK]>) to 10.0.12.141
2022-07-04 04:37:19.142980 (Thread-1): 04:37:19  SQL status: SUCCESS 25 in 1.01 seconds
2022-07-04 04:37:19.144650 (Thread-1): 04:37:19  finished collecting timing info
2022-07-04 04:37:19.144835 (Thread-1): 04:37:19  On rpc.ecommerce_data_model_dbt.request: Close
2022-07-04 04:37:19.841788 (Thread-120): handling poll request
2022-07-04 04:37:19.842215 (Thread-120): 04:37:19  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '08022227-1dd0-4d09-94f1-e256bf2507d1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb16c0ec280>]}
2022-07-04 04:37:19.870545 (Thread-120): sending response (<Response 10170 bytes [200 OK]>) to 10.0.12.141
2022-07-04 04:38:30.431208 (Thread-121): handling status request
2022-07-04 04:38:30.431650 (Thread-121): 04:38:30  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '08022227-1dd0-4d09-94f1-e256bf2507d1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb160735f10>]}
2022-07-04 04:38:30.432222 (Thread-121): sending response (<Response 2351 bytes [200 OK]>) to 10.0.12.141
2022-07-04 04:38:30.813200 (Thread-122): handling run_sql request
2022-07-04 04:38:30.813613 (Thread-122): 04:38:30  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '08022227-1dd0-4d09-94f1-e256bf2507d1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb160735fd0>]}
2022-07-04 04:38:33.147893 (Thread-122): sending response (<Response 139 bytes [200 OK]>) to 10.0.12.141
2022-07-04 04:38:33.176590 (MainThread): 04:38:33  Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '95a29514-bf10-4765-929c-27e9dd5bab94', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f91288ca610>]}
2022-07-04 04:38:33.177179 (MainThread): 04:38:33  Found 8 models, 0 tests, 0 snapshots, 0 analyses, 179 macros, 0 operations, 0 seed files, 15 sources, 0 exposures, 0 metrics
2022-07-04 04:38:33.177823 (Thread-1): 04:38:33  Acquiring new snowflake connection "rpc.ecommerce_data_model_dbt.request"
2022-07-04 04:38:33.177979 (Thread-1): 04:38:33  Began compiling node rpc.ecommerce_data_model_dbt.request
2022-07-04 04:38:33.178073 (Thread-1): 04:38:33  Compiling rpc.ecommerce_data_model_dbt.request
2022-07-04 04:38:33.182018 (Thread-1): 04:38:33  finished collecting timing info
2022-07-04 04:38:33.182151 (Thread-1): 04:38:33  Began executing node rpc.ecommerce_data_model_dbt.request
2022-07-04 04:38:33.184155 (Thread-1): 04:38:33  Using snowflake connection "rpc.ecommerce_data_model_dbt.request"
2022-07-04 04:38:33.184252 (Thread-1): 04:38:33  On rpc.ecommerce_data_model_dbt.request: with cte_gender as 
(select user_id, gender from 
(select user_id, properties_gender as gender, row_number() over(partition by user_id order by timestamp desc) as rn from 
analytics_db.data_apps_simulated.identifies where timestamp >= '2021-05-01' and timestamp <= '2022-06-29'
and properties_gender is not null and properties_gender != '') where rn = 1),

cte_age as 
(select user_id, age from
(select user_id, 
(CASE WHEN dateadd(year, datediff (year, properties_birthday, getdate()), properties_birthday) > getdate()
      THEN datediff(year, properties_birthday, getdate()) - 1
      ELSE datediff(year, properties_birthday, getdate())
 END) as age, row_number() over(partition by user_id order by timestamp desc) as rn 
from analytics_db.data_apps_simulated.identifies where timestamp >= '2021-05-01' and timestamp <= '2022-06-29'
and properties_birthday is not null and properties_birthday!='') where rn = 1),

cte_country as 
(select user_id, country from 
(select user_id, properties_country as country, row_number() over(partition by user_id order by timestamp desc) as rn from 
analytics_db.data_apps_simulated.identifies where timestamp >= '2021-05-01' and timestamp <= '2022-06-29'
and properties_country is not null and properties_country != '') where rn = 1)

select coalesce(a.user_id, b.user_id, c.user_id) 
as user_id, gender, age, country 
from (cte_gneder a full outer join cte_age b on a.user_id = b.user_id) full outer join cte_country c on b.user_id = c.user_id
limit 500
/* limit added automatically by dbt cloud */
2022-07-04 04:38:33.184332 (Thread-1): 04:38:33  Opening a new connection, currently in state init
2022-07-04 04:38:33.558634 (Thread-123): handling poll request
2022-07-04 04:38:33.559124 (Thread-123): 04:38:33  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '08022227-1dd0-4d09-94f1-e256bf2507d1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb1604ff3d0>]}
2022-07-04 04:38:33.560494 (Thread-123): sending response (<Response 5288 bytes [200 OK]>) to 10.0.12.141
2022-07-04 04:38:33.888364 (Thread-1): 04:38:33  Snowflake adapter: Snowflake query id: 01a55fb6-0602-3238-0019-82030464fe2a
2022-07-04 04:38:33.888562 (Thread-1): 04:38:33  Snowflake adapter: Snowflake error: 002003 (42S02): SQL compilation error:
Object 'CTE_GNEDER' does not exist or not authorized.
2022-07-04 04:38:33.888725 (Thread-1): 04:38:33  finished collecting timing info
2022-07-04 04:38:33.888882 (Thread-1): 04:38:33  On rpc.ecommerce_data_model_dbt.request: Close
2022-07-04 04:38:33.964808 (Thread-1): Got an exception: Database Error
  002003 (42S02): SQL compilation error:
  Object 'CTE_GNEDER' does not exist or not authorized.
Traceback (most recent call last):
  File "/usr/local/lib/python3.8/dist-packages/dbt/adapters/snowflake/connections.py", line 206, in exception_handler
    yield
  File "/usr/local/lib/python3.8/dist-packages/dbt/adapters/sql/connections.py", line 74, in add_query
    cursor.execute(sql, bindings)
  File "/usr/local/lib/python3.8/dist-packages/snowflake/connector/cursor.py", line 721, in execute
    Error.errorhandler_wrapper(
  File "/usr/local/lib/python3.8/dist-packages/snowflake/connector/errors.py", line 258, in errorhandler_wrapper
    cursor.errorhandler(connection, cursor, error_class, error_value)
  File "/usr/local/lib/python3.8/dist-packages/snowflake/connector/errors.py", line 188, in default_errorhandler
    raise error_class(
snowflake.connector.errors.ProgrammingError: 002003 (42S02): SQL compilation error:
Object 'CTE_GNEDER' does not exist or not authorized.

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/usr/local/lib/python3.8/dist-packages/dbt/task/base.py", line 361, in safe_run
    result = self.compile_and_execute(manifest, ctx)
  File "/usr/local/lib/python3.8/dist-packages/dbt/task/base.py", line 314, in compile_and_execute
    result = self.run(ctx.node, manifest)
  File "/usr/local/lib/python3.8/dist-packages/dbt/task/base.py", line 403, in run
    return self.execute(compiled_node, manifest)
  File "/usr/local/lib/python3.8/dist-packages/dbt_rpc/rpc/node_runners.py", line 90, in execute
    _, execute_result = self.adapter.execute(
  File "/usr/local/lib/python3.8/dist-packages/dbt/adapters/base/impl.py", line 225, in execute
    return self.connections.execute(
  File "/usr/local/lib/python3.8/dist-packages/dbt/adapters/sql/connections.py", line 127, in execute
    _, cursor = self.add_query(sql, auto_begin)
  File "/usr/local/lib/python3.8/dist-packages/dbt/adapters/snowflake/connections.py", line 433, in add_query
    connection, cursor = super().add_query(
  File "/usr/local/lib/python3.8/dist-packages/dbt/adapters/sql/connections.py", line 83, in add_query
    return connection, cursor
  File "/usr/lib/python3.8/contextlib.py", line 131, in __exit__
    self.gen.throw(type, value, traceback)
  File "/usr/local/lib/python3.8/dist-packages/dbt/adapters/snowflake/connections.py", line 223, in exception_handler
    raise DatabaseException(msg)
dbt.exceptions.DatabaseException: Database Error
  002003 (42S02): SQL compilation error:
  Object 'CTE_GNEDER' does not exist or not authorized.
2022-07-04 04:38:33.965772 (Thread-1): Got exception RPCException(10003, Database Error, {'type': 'DatabaseException', 'message': "Database Error in rpc request (from remote system)\n  002003 (42S02): SQL compilation error:\n  Object 'CTE_GNEDER' does not exist or not authorized.", 'raw_sql': "with cte_gender as \n(select user_id, gender from \n(select user_id, properties_gender as gender, row_number() over(partition by user_id order by timestamp desc) as rn from \n{{ source('ecommerce', 'identifies') }} where timestamp >= '{{ var('start_date') }}' and timestamp <= '{{ var('end_date') }}'\nand properties_gender is not null and properties_gender != '') where rn = 1),\n\ncte_age as \n(select user_id, age from\n(select user_id, \n(CASE WHEN dateadd(year, datediff (year, properties_birthday, getdate()), properties_birthday) > getdate()\n      THEN datediff(year, properties_birthday, getdate()) - 1\n      ELSE datediff(year, properties_birthday, getdate())\n END) as age, row_number() over(partition by user_id order by timestamp desc) as rn \nfrom {{ source('ecommerce', 'identifies') }} where timestamp >= '{{ var('start_date') }}' and timestamp <= '{{ var('end_date') }}'\nand properties_birthday is not null and properties_birthday!='') where rn = 1),\n\ncte_country as \n(select user_id, country from \n(select user_id, properties_country as country, row_number() over(partition by user_id order by timestamp desc) as rn from \n{{ source('ecommerce', 'identifies') }} where timestamp >= '{{ var('start_date') }}' and timestamp <= '{{ var('end_date') }}'\nand properties_country is not null and properties_country != '') where rn = 1)\n\nselect coalesce(a.user_id, b.user_id, c.user_id) \nas user_id, gender, age, country \nfrom (cte_gneder a full outer join cte_age b on a.user_id = b.user_id) full outer join cte_country c on b.user_id = c.user_id\nlimit 500\n/* limit added automatically by dbt cloud */", 'compiled_sql': "with cte_gender as \n(select user_id, gender from \n(select user_id, properties_gender as gender, row_number() over(partition by user_id order by timestamp desc) as rn from \nanalytics_db.data_apps_simulated.identifies where timestamp >= '2021-05-01' and timestamp <= '2022-06-29'\nand properties_gender is not null and properties_gender != '') where rn = 1),\n\ncte_age as \n(select user_id, age from\n(select user_id, \n(CASE WHEN dateadd(year, datediff (year, properties_birthday, getdate()), properties_birthday) > getdate()\n      THEN datediff(year, properties_birthday, getdate()) - 1\n      ELSE datediff(year, properties_birthday, getdate())\n END) as age, row_number() over(partition by user_id order by timestamp desc) as rn \nfrom analytics_db.data_apps_simulated.identifies where timestamp >= '2021-05-01' and timestamp <= '2022-06-29'\nand properties_birthday is not null and properties_birthday!='') where rn = 1),\n\ncte_country as \n(select user_id, country from \n(select user_id, properties_country as country, row_number() over(partition by user_id order by timestamp desc) as rn from \nanalytics_db.data_apps_simulated.identifies where timestamp >= '2021-05-01' and timestamp <= '2022-06-29'\nand properties_country is not null and properties_country != '') where rn = 1)\n\nselect coalesce(a.user_id, b.user_id, c.user_id) \nas user_id, gender, age, country \nfrom (cte_gneder a full outer join cte_age b on a.user_id = b.user_id) full outer join cte_country c on b.user_id = c.user_id\nlimit 500\n/* limit added automatically by dbt cloud */", 'tags': None}, None)
Traceback (most recent call last):
  File "/usr/local/lib/python3.8/dist-packages/dbt_rpc/task/sql_commands.py", line 147, in _in_thread
    self.node_results.append(runner.safe_run(self.manifest))
  File "/usr/local/lib/python3.8/dist-packages/dbt/task/base.py", line 377, in safe_run
    result = self.error_result(ctx.node, error, started, [])
  File "/usr/local/lib/python3.8/dist-packages/dbt_rpc/rpc/node_runners.py", line 56, in error_result
    raise error
dbt_rpc.rpc.error.RPCException: RPCException(10003, Database Error, {'type': 'DatabaseException', 'message': "Database Error in rpc request (from remote system)\n  002003 (42S02): SQL compilation error:\n  Object 'CTE_GNEDER' does not exist or not authorized.", 'raw_sql': "with cte_gender as \n(select user_id, gender from \n(select user_id, properties_gender as gender, row_number() over(partition by user_id order by timestamp desc) as rn from \n{{ source('ecommerce', 'identifies') }} where timestamp >= '{{ var('start_date') }}' and timestamp <= '{{ var('end_date') }}'\nand properties_gender is not null and properties_gender != '') where rn = 1),\n\ncte_age as \n(select user_id, age from\n(select user_id, \n(CASE WHEN dateadd(year, datediff (year, properties_birthday, getdate()), properties_birthday) > getdate()\n      THEN datediff(year, properties_birthday, getdate()) - 1\n      ELSE datediff(year, properties_birthday, getdate())\n END) as age, row_number() over(partition by user_id order by timestamp desc) as rn \nfrom {{ source('ecommerce', 'identifies') }} where timestamp >= '{{ var('start_date') }}' and timestamp <= '{{ var('end_date') }}'\nand properties_birthday is not null and properties_birthday!='') where rn = 1),\n\ncte_country as \n(select user_id, country from \n(select user_id, properties_country as country, row_number() over(partition by user_id order by timestamp desc) as rn from \n{{ source('ecommerce', 'identifies') }} where timestamp >= '{{ var('start_date') }}' and timestamp <= '{{ var('end_date') }}'\nand properties_country is not null and properties_country != '') where rn = 1)\n\nselect coalesce(a.user_id, b.user_id, c.user_id) \nas user_id, gender, age, country \nfrom (cte_gneder a full outer join cte_age b on a.user_id = b.user_id) full outer join cte_country c on b.user_id = c.user_id\nlimit 500\n/* limit added automatically by dbt cloud */", 'compiled_sql': "with cte_gender as \n(select user_id, gender from \n(select user_id, properties_gender as gender, row_number() over(partition by user_id order by timestamp desc) as rn from \nanalytics_db.data_apps_simulated.identifies where timestamp >= '2021-05-01' and timestamp <= '2022-06-29'\nand properties_gender is not null and properties_gender != '') where rn = 1),\n\ncte_age as \n(select user_id, age from\n(select user_id, \n(CASE WHEN dateadd(year, datediff (year, properties_birthday, getdate()), properties_birthday) > getdate()\n      THEN datediff(year, properties_birthday, getdate()) - 1\n      ELSE datediff(year, properties_birthday, getdate())\n END) as age, row_number() over(partition by user_id order by timestamp desc) as rn \nfrom analytics_db.data_apps_simulated.identifies where timestamp >= '2021-05-01' and timestamp <= '2022-06-29'\nand properties_birthday is not null and properties_birthday!='') where rn = 1),\n\ncte_country as \n(select user_id, country from \n(select user_id, properties_country as country, row_number() over(partition by user_id order by timestamp desc) as rn from \nanalytics_db.data_apps_simulated.identifies where timestamp >= '2021-05-01' and timestamp <= '2022-06-29'\nand properties_country is not null and properties_country != '') where rn = 1)\n\nselect coalesce(a.user_id, b.user_id, c.user_id) \nas user_id, gender, age, country \nfrom (cte_gneder a full outer join cte_age b on a.user_id = b.user_id) full outer join cte_country c on b.user_id = c.user_id\nlimit 500\n/* limit added automatically by dbt cloud */", 'tags': None}, None)
2022-07-04 04:38:34.941199 (Thread-124): handling poll request
2022-07-04 04:38:34.941603 (Thread-124): 04:38:34  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '08022227-1dd0-4d09-94f1-e256bf2507d1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb1604ff2e0>]}
2022-07-04 04:38:34.942302 (Thread-124): sending response (<Response 20582 bytes [200 OK]>) to 10.0.12.141
2022-07-04 04:38:44.998645 (Thread-125): handling status request
2022-07-04 04:38:44.999048 (Thread-125): 04:38:44  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '08022227-1dd0-4d09-94f1-e256bf2507d1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb1604ffd00>]}
2022-07-04 04:38:44.999598 (Thread-125): sending response (<Response 2351 bytes [200 OK]>) to 10.0.12.141
2022-07-04 04:38:45.376876 (Thread-127): handling run_sql request
2022-07-04 04:38:45.377901 (Thread-127): 04:38:45  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '08022227-1dd0-4d09-94f1-e256bf2507d1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb1607a6130>]}
2022-07-04 04:38:45.378433 (Thread-127): sending response (<Response 292 bytes [200 OK]>) to 10.0.12.141
2022-07-04 04:38:45.464299 (Thread-126): 04:38:45  Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
2022-07-04 04:38:45.464770 (Thread-126): 04:38:45  Partial parsing: updated file: ecommerce_data_model_dbt://models/data_model/stg_user_traits.sql
2022-07-04 04:38:45.469141 (Thread-126): 04:38:45  1603: static parser failed on data_model/stg_user_traits.sql
2022-07-04 04:38:45.474605 (Thread-126): 04:38:45  1602: parser fallback to jinja rendering on data_model/stg_user_traits.sql
2022-07-04 04:38:45.510321 (Thread-126): 04:38:45  [WARNING]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.data-apps-ecommerce-template.data_model

2022-07-04 04:38:45.515448 (Thread-126): 04:38:45  Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '08022227-1dd0-4d09-94f1-e256bf2507d1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb160427760>]}
2022-07-04 04:38:46.169399 (Thread-128): handling status request
2022-07-04 04:38:46.169818 (Thread-128): 04:38:46  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '08022227-1dd0-4d09-94f1-e256bf2507d1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb160469f10>]}
2022-07-04 04:38:46.170354 (Thread-128): sending response (<Response 2357 bytes [200 OK]>) to 10.0.12.141
2022-07-04 04:38:46.215818 (Thread-129): handling status request
2022-07-04 04:38:46.216179 (Thread-129): 04:38:46  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '08022227-1dd0-4d09-94f1-e256bf2507d1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb16c143b50>]}
2022-07-04 04:38:46.216651 (Thread-129): sending response (<Response 2357 bytes [200 OK]>) to 10.0.12.141
2022-07-04 04:38:49.850018 (Thread-130): 04:38:49  Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
2022-07-04 04:38:49.850243 (Thread-130): 04:38:49  Partial parsing enabled, no changes found, skipping parsing
2022-07-04 04:38:49.850714 (Thread-130): 04:38:49  [WARNING]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.data-apps-ecommerce-template.data_model

2022-07-04 04:38:49.856021 (Thread-130): 04:38:49  Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '08022227-1dd0-4d09-94f1-e256bf2507d1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb1603ae7f0>]}
2022-07-04 04:38:50.548301 (Thread-131): handling status request
2022-07-04 04:38:50.548712 (Thread-131): 04:38:50  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '08022227-1dd0-4d09-94f1-e256bf2507d1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb1604645e0>]}
2022-07-04 04:38:50.549217 (Thread-131): sending response (<Response 1703 bytes [200 OK]>) to 10.0.12.141
2022-07-04 04:38:50.647069 (Thread-132): handling status request
2022-07-04 04:38:50.647491 (Thread-132): 04:38:50  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '08022227-1dd0-4d09-94f1-e256bf2507d1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb160464400>]}
2022-07-04 04:38:50.647974 (Thread-132): sending response (<Response 1703 bytes [200 OK]>) to 10.0.12.141
2022-07-04 04:38:52.656136 (Thread-133): handling status request
2022-07-04 04:38:52.656560 (Thread-133): 04:38:52  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '08022227-1dd0-4d09-94f1-e256bf2507d1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb160464250>]}
2022-07-04 04:38:52.657045 (Thread-133): sending response (<Response 1703 bytes [200 OK]>) to 10.0.12.141
2022-07-04 04:38:53.015095 (Thread-134): handling run_sql request
2022-07-04 04:38:53.015521 (Thread-134): 04:38:53  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '08022227-1dd0-4d09-94f1-e256bf2507d1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb1604640a0>]}
2022-07-04 04:38:55.357452 (Thread-134): sending response (<Response 139 bytes [200 OK]>) to 10.0.12.141
2022-07-04 04:38:55.384579 (MainThread): 04:38:55  Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '2ea4feef-ee40-415b-bff5-1d1303b1d5d0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcdad8a2430>]}
2022-07-04 04:38:55.385158 (MainThread): 04:38:55  Found 8 models, 0 tests, 0 snapshots, 0 analyses, 179 macros, 0 operations, 0 seed files, 15 sources, 0 exposures, 0 metrics
2022-07-04 04:38:55.385765 (Thread-1): 04:38:55  Acquiring new snowflake connection "rpc.ecommerce_data_model_dbt.request"
2022-07-04 04:38:55.385896 (Thread-1): 04:38:55  Began compiling node rpc.ecommerce_data_model_dbt.request
2022-07-04 04:38:55.386015 (Thread-1): 04:38:55  Compiling rpc.ecommerce_data_model_dbt.request
2022-07-04 04:38:55.389979 (Thread-1): 04:38:55  finished collecting timing info
2022-07-04 04:38:55.390113 (Thread-1): 04:38:55  Began executing node rpc.ecommerce_data_model_dbt.request
2022-07-04 04:38:55.392102 (Thread-1): 04:38:55  Using snowflake connection "rpc.ecommerce_data_model_dbt.request"
2022-07-04 04:38:55.392202 (Thread-1): 04:38:55  On rpc.ecommerce_data_model_dbt.request: with cte_gender as 
(select user_id, gender from 
(select user_id, properties_gender as gender, row_number() over(partition by user_id order by timestamp desc) as rn from 
analytics_db.data_apps_simulated.identifies where timestamp >= '2021-05-01' and timestamp <= '2022-06-29'
and properties_gender is not null and properties_gender != '') where rn = 1),

cte_age as 
(select user_id, age from
(select user_id, 
(CASE WHEN dateadd(year, datediff (year, properties_birthday, getdate()), properties_birthday) > getdate()
      THEN datediff(year, properties_birthday, getdate()) - 1
      ELSE datediff(year, properties_birthday, getdate())
 END) as age, row_number() over(partition by user_id order by timestamp desc) as rn 
from analytics_db.data_apps_simulated.identifies where timestamp >= '2021-05-01' and timestamp <= '2022-06-29'
and properties_birthday is not null and properties_birthday!='') where rn = 1),

cte_country as 
(select user_id, country from 
(select user_id, properties_country as country, row_number() over(partition by user_id order by timestamp desc) as rn from 
analytics_db.data_apps_simulated.identifies where timestamp >= '2021-05-01' and timestamp <= '2022-06-29'
and properties_country is not null and properties_country != '') where rn = 1)

select coalesce(a.user_id, b.user_id, c.user_id) 
as user_id, gender, age, country 
from (cte_gender a full outer join cte_age b on a.user_id = b.user_id) full outer join cte_country c on b.user_id = c.user_id
limit 500
/* limit added automatically by dbt cloud */
2022-07-04 04:38:55.392334 (Thread-1): 04:38:55  Opening a new connection, currently in state init
2022-07-04 04:38:55.730904 (Thread-135): handling poll request
2022-07-04 04:38:55.731386 (Thread-135): 04:38:55  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '08022227-1dd0-4d09-94f1-e256bf2507d1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb1607a02e0>]}
2022-07-04 04:38:55.732320 (Thread-135): sending response (<Response 5288 bytes [200 OK]>) to 10.0.12.141
2022-07-04 04:38:56.467694 (Thread-1): 04:38:56  SQL status: SUCCESS 7 in 1.08 seconds
2022-07-04 04:38:56.469224 (Thread-1): 04:38:56  finished collecting timing info
2022-07-04 04:38:56.469406 (Thread-1): 04:38:56  On rpc.ecommerce_data_model_dbt.request: Close
2022-07-04 04:38:57.104718 (Thread-136): handling poll request
2022-07-04 04:38:57.105116 (Thread-136): 04:38:57  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '08022227-1dd0-4d09-94f1-e256bf2507d1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb1607a2d90>]}
2022-07-04 04:38:57.106092 (Thread-136): sending response (<Response 9980 bytes [200 OK]>) to 10.0.12.141
2022-07-04 04:40:55.907593 (Thread-137): 04:40:55  Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
2022-07-04 04:40:55.909370 (Thread-137): 04:40:55  Partial parsing: updated file: ecommerce_data_model_dbt://models/data_model/stg_user_traits.sql
2022-07-04 04:40:55.913743 (Thread-137): 04:40:55  1603: static parser failed on data_model/stg_user_traits.sql
2022-07-04 04:40:55.919115 (Thread-137): 04:40:55  1602: parser fallback to jinja rendering on data_model/stg_user_traits.sql
2022-07-04 04:40:55.952835 (Thread-137): 04:40:55  [WARNING]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.data-apps-ecommerce-template.data_model

2022-07-04 04:40:55.958317 (Thread-137): 04:40:55  Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '08022227-1dd0-4d09-94f1-e256bf2507d1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb16032bf70>]}
2022-07-04 04:40:56.646452 (Thread-138): handling status request
2022-07-04 04:40:56.646857 (Thread-138): 04:40:56  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '08022227-1dd0-4d09-94f1-e256bf2507d1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb16036be20>]}
2022-07-04 04:40:56.647386 (Thread-138): sending response (<Response 2357 bytes [200 OK]>) to 10.0.12.141
2022-07-04 04:40:56.680328 (Thread-139): handling status request
2022-07-04 04:40:56.680648 (Thread-139): 04:40:56  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '08022227-1dd0-4d09-94f1-e256bf2507d1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb16036bf10>]}
2022-07-04 04:40:56.681098 (Thread-139): sending response (<Response 2357 bytes [200 OK]>) to 10.0.12.141
2022-07-04 04:40:57.278930 (Thread-140): handling status request
2022-07-04 04:40:57.279328 (Thread-140): 04:40:57  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '08022227-1dd0-4d09-94f1-e256bf2507d1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb16036bfa0>]}
2022-07-04 04:40:57.279819 (Thread-140): sending response (<Response 2357 bytes [200 OK]>) to 10.0.12.141
2022-07-04 04:40:57.637433 (Thread-141): handling run_sql request
2022-07-04 04:40:57.637840 (Thread-141): 04:40:57  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '08022227-1dd0-4d09-94f1-e256bf2507d1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb16073c400>]}
2022-07-04 04:40:59.959872 (Thread-141): sending response (<Response 139 bytes [200 OK]>) to 10.0.12.141
2022-07-04 04:40:59.986742 (MainThread): 04:40:59  Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '62dd9024-52d8-4a33-9e76-22613b6f1815', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa04278a5b0>]}
2022-07-04 04:40:59.987276 (MainThread): 04:40:59  Found 8 models, 0 tests, 0 snapshots, 0 analyses, 179 macros, 0 operations, 0 seed files, 15 sources, 0 exposures, 0 metrics
2022-07-04 04:40:59.987875 (Thread-1): 04:40:59  Acquiring new snowflake connection "rpc.ecommerce_data_model_dbt.request"
2022-07-04 04:40:59.988008 (Thread-1): 04:40:59  Began compiling node rpc.ecommerce_data_model_dbt.request
2022-07-04 04:40:59.988100 (Thread-1): 04:40:59  Compiling rpc.ecommerce_data_model_dbt.request
2022-07-04 04:40:59.992121 (Thread-1): 04:40:59  finished collecting timing info
2022-07-04 04:40:59.992250 (Thread-1): 04:40:59  Began executing node rpc.ecommerce_data_model_dbt.request
2022-07-04 04:40:59.994280 (Thread-1): 04:40:59  Using snowflake connection "rpc.ecommerce_data_model_dbt.request"
2022-07-04 04:40:59.994377 (Thread-1): 04:40:59  On rpc.ecommerce_data_model_dbt.request: with cte_gender as 
(select user_id, gender from 
(select user_id, properties_gender as gender, row_number() over(partition by user_id order by timestamp desc) as rn from 
analytics_db.data_apps_simulated.identifies where timestamp >= '2021-05-01' and timestamp <= '2022-06-29'
and properties_gender is not null and properties_gender != '') where rn = 1),

cte_age as 
(select user_id, age from
(select user_id, 
(CASE WHEN dateadd(year, datediff (year, properties_birthday, getdate()), properties_birthday) > getdate()
      THEN datediff(year, properties_birthday, getdate()) - 1
      ELSE datediff(year, properties_birthday, getdate())
 END) as age, row_number() over(partition by user_id order by timestamp desc) as rn 
from analytics_db.data_apps_simulated.identifies where timestamp >= '2021-05-01' and timestamp <= '2022-06-29'
and properties_birthday is not null and properties_birthday!='') where rn = 1),

cte_country as 
(select user_id, country from 
(select user_id, properties_country as country, row_number() over(partition by user_id order by timestamp desc) as rn from 
analytics_db.data_apps_simulated.identifies where timestamp >= '2021-05-01' and timestamp <= '2022-06-29'
and properties_country is not null and properties_country != '') where rn = 1)

select coalesce(a.user_id, b.user_id, c.user_id) 
as user_id, gender, age, country 
from (cte_gender a full outer join cte_age b on a.user_id = b.user_id) full outer join cte_country c on c.user_id = coalesce(a.user_id,b.user_id)
limit 500
/* limit added automatically by dbt cloud */
2022-07-04 04:40:59.994459 (Thread-1): 04:40:59  Opening a new connection, currently in state init
2022-07-04 04:41:00.362262 (Thread-142): handling poll request
2022-07-04 04:41:00.362732 (Thread-142): 04:41:00  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '08022227-1dd0-4d09-94f1-e256bf2507d1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb1602ff220>]}
2022-07-04 04:41:00.363627 (Thread-142): sending response (<Response 5308 bytes [200 OK]>) to 10.0.12.141
2022-07-04 04:41:01.083389 (Thread-1): 04:41:01  SQL status: SUCCESS 5 in 1.09 seconds
2022-07-04 04:41:01.084882 (Thread-1): 04:41:01  finished collecting timing info
2022-07-04 04:41:01.085064 (Thread-1): 04:41:01  On rpc.ecommerce_data_model_dbt.request: Close
2022-07-04 04:41:01.729987 (Thread-143): handling poll request
2022-07-04 04:41:01.730405 (Thread-143): 04:41:01  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '08022227-1dd0-4d09-94f1-e256bf2507d1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb1602ff880>]}
2022-07-04 04:41:01.731373 (Thread-143): sending response (<Response 10001 bytes [200 OK]>) to 10.0.12.141
2022-07-04 04:41:13.554323 (Thread-144): 04:41:13  Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
2022-07-04 04:41:13.554802 (Thread-144): 04:41:13  Partial parsing: updated file: ecommerce_data_model_dbt://models/data_model/stg_user_traits.sql
2022-07-04 04:41:13.559986 (Thread-144): 04:41:13  1603: static parser failed on data_model/stg_user_traits.sql
2022-07-04 04:41:13.565740 (Thread-144): 04:41:13  1602: parser fallback to jinja rendering on data_model/stg_user_traits.sql
2022-07-04 04:41:13.600467 (Thread-144): 04:41:13  [WARNING]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.data-apps-ecommerce-template.data_model

2022-07-04 04:41:13.606191 (Thread-144): 04:41:13  Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '08022227-1dd0-4d09-94f1-e256bf2507d1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb160259460>]}
2022-07-04 04:41:14.331107 (Thread-145): handling status request
2022-07-04 04:41:14.331507 (Thread-145): 04:41:14  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '08022227-1dd0-4d09-94f1-e256bf2507d1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb1602a2eb0>]}
2022-07-04 04:41:14.332026 (Thread-145): sending response (<Response 2357 bytes [200 OK]>) to 10.0.12.141
2022-07-04 04:41:14.348216 (Thread-146): handling status request
2022-07-04 04:41:14.348590 (Thread-146): 04:41:14  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '08022227-1dd0-4d09-94f1-e256bf2507d1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb1602a2be0>]}
2022-07-04 04:41:14.349064 (Thread-146): sending response (<Response 2357 bytes [200 OK]>) to 10.0.12.141
2022-07-04 04:41:46.495035 (Thread-147): 04:41:46  Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
2022-07-04 04:41:46.495273 (Thread-147): 04:41:46  Partial parsing enabled, no changes found, skipping parsing
2022-07-04 04:41:46.495756 (Thread-147): 04:41:46  [WARNING]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.data-apps-ecommerce-template.data_model

2022-07-04 04:41:46.501095 (Thread-147): 04:41:46  Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '08022227-1dd0-4d09-94f1-e256bf2507d1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb1601fed90>]}
2022-07-04 04:41:47.289975 (Thread-148): handling status request
2022-07-04 04:41:47.290376 (Thread-148): 04:41:47  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '08022227-1dd0-4d09-94f1-e256bf2507d1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb16024e700>]}
2022-07-04 04:41:47.290859 (Thread-148): sending response (<Response 1703 bytes [200 OK]>) to 10.0.12.141
2022-07-04 04:41:47.291876 (Thread-149): handling status request
2022-07-04 04:41:47.292266 (Thread-149): 04:41:47  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '08022227-1dd0-4d09-94f1-e256bf2507d1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb16024eac0>]}
2022-07-04 04:41:47.292697 (Thread-149): sending response (<Response 1703 bytes [200 OK]>) to 10.0.12.141
2022-07-04 04:42:32.644595 (Thread-150): 04:42:32  Partial parsing enabled: 0 files deleted, 1 files added, 0 files changed.
2022-07-04 04:42:32.644987 (Thread-150): 04:42:32  Partial parsing: added file: ecommerce_data_model_dbt://models/data_model/temp_folder/state.sql
2022-07-04 04:42:32.648713 (Thread-150): 04:42:32  1699: static parser successfully parsed data_model/temp_folder/state.sql
2022-07-04 04:42:32.689845 (Thread-150): 04:42:32  [WARNING]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.data-apps-ecommerce-template.data_model

2022-07-04 04:42:32.695140 (Thread-150): 04:42:32  Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '08022227-1dd0-4d09-94f1-e256bf2507d1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb160128bb0>]}
2022-07-04 04:42:33.467960 (Thread-151): handling status request
2022-07-04 04:42:33.468448 (Thread-151): 04:42:33  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '08022227-1dd0-4d09-94f1-e256bf2507d1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb160300ac0>]}
2022-07-04 04:42:33.469000 (Thread-151): sending response (<Response 2053 bytes [200 OK]>) to 10.0.12.141
2022-07-04 04:42:33.488989 (Thread-152): handling status request
2022-07-04 04:42:33.489385 (Thread-152): 04:42:33  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '08022227-1dd0-4d09-94f1-e256bf2507d1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb160300640>]}
2022-07-04 04:42:33.489875 (Thread-152): sending response (<Response 2053 bytes [200 OK]>) to 10.0.12.141
2022-07-04 04:43:14.545075 (Thread-153): handling status request
2022-07-04 04:43:14.545530 (Thread-153): 04:43:14  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '08022227-1dd0-4d09-94f1-e256bf2507d1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb1602fb130>]}
2022-07-04 04:43:14.546095 (Thread-153): sending response (<Response 2053 bytes [200 OK]>) to 10.0.12.141
2022-07-04 04:43:14.950469 (Thread-154): handling run_sql request
2022-07-04 04:43:14.950888 (Thread-154): 04:43:14  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '08022227-1dd0-4d09-94f1-e256bf2507d1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb1602fb700>]}
2022-07-04 04:43:17.265042 (Thread-154): sending response (<Response 139 bytes [200 OK]>) to 10.0.12.141
2022-07-04 04:43:17.290319 (MainThread): 04:43:17  Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'a18ceadd-52b2-473f-8544-4702c11a7048', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0557dcb8b0>]}
2022-07-04 04:43:17.290871 (MainThread): 04:43:17  Found 9 models, 0 tests, 0 snapshots, 0 analyses, 179 macros, 0 operations, 0 seed files, 15 sources, 0 exposures, 0 metrics
2022-07-04 04:43:17.291475 (Thread-1): 04:43:17  Acquiring new snowflake connection "rpc.ecommerce_data_model_dbt.request"
2022-07-04 04:43:17.291607 (Thread-1): 04:43:17  Began compiling node rpc.ecommerce_data_model_dbt.request
2022-07-04 04:43:17.291738 (Thread-1): 04:43:17  Compiling rpc.ecommerce_data_model_dbt.request
2022-07-04 04:43:17.294314 (Thread-1): 04:43:17  finished collecting timing info
2022-07-04 04:43:17.294443 (Thread-1): 04:43:17  Began executing node rpc.ecommerce_data_model_dbt.request
2022-07-04 04:43:17.295213 (Thread-1): 04:43:17  Using snowflake connection "rpc.ecommerce_data_model_dbt.request"
2022-07-04 04:43:17.295301 (Thread-1): 04:43:17  On rpc.ecommerce_data_model_dbt.request: select user_id, state from 
(select user_id, properties_state as state, row_number() over(partition by user_id order by timestamp desc) as rn from 
analytics_db.data_apps_simulated.identifies where timestamp >= '2021-05-01' and timestamp <= '2022-06-29'
and properties_state is not null and properties_state != '') where rn = 1
limit 500
/* limit added automatically by dbt cloud */
2022-07-04 04:43:17.295381 (Thread-1): 04:43:17  Opening a new connection, currently in state init
2022-07-04 04:43:17.656998 (Thread-155): handling poll request
2022-07-04 04:43:17.657482 (Thread-155): 04:43:17  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '08022227-1dd0-4d09-94f1-e256bf2507d1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb160257460>]}
2022-07-04 04:43:17.658453 (Thread-155): sending response (<Response 4113 bytes [200 OK]>) to 10.0.12.141
2022-07-04 04:43:18.091925 (Thread-1): 04:43:18  SQL status: SUCCESS 5 in 0.8 seconds
2022-07-04 04:43:18.093340 (Thread-1): 04:43:18  finished collecting timing info
2022-07-04 04:43:18.093524 (Thread-1): 04:43:18  On rpc.ecommerce_data_model_dbt.request: Close
2022-07-04 04:43:19.050152 (Thread-156): handling poll request
2022-07-04 04:43:19.050552 (Thread-156): 04:43:19  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '08022227-1dd0-4d09-94f1-e256bf2507d1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb160257a30>]}
2022-07-04 04:43:19.051439 (Thread-156): sending response (<Response 4926 bytes [200 OK]>) to 10.0.12.141
2022-07-04 04:43:25.636586 (Thread-157): 04:43:25  Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
2022-07-04 04:43:25.637081 (Thread-157): 04:43:25  Partial parsing: updated file: ecommerce_data_model_dbt://models/data_model/temp_folder/state.sql
2022-07-04 04:43:25.641354 (Thread-157): 04:43:25  1603: static parser failed on data_model/temp_folder/state.sql
2022-07-04 04:43:25.645480 (Thread-157): 04:43:25  1602: parser fallback to jinja rendering on data_model/temp_folder/state.sql
2022-07-04 04:43:25.682165 (Thread-157): 04:43:25  [WARNING]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.data-apps-ecommerce-template.data_model

2022-07-04 04:43:25.687759 (Thread-157): 04:43:25  Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '08022227-1dd0-4d09-94f1-e256bf2507d1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb1600e8fd0>]}
2022-07-04 04:43:26.377977 (Thread-158): handling status request
2022-07-04 04:43:26.378378 (Thread-158): 04:43:26  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '08022227-1dd0-4d09-94f1-e256bf2507d1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb1603059a0>]}
2022-07-04 04:43:26.378892 (Thread-158): sending response (<Response 2363 bytes [200 OK]>) to 10.0.12.141
2022-07-04 04:43:26.413120 (Thread-159): handling status request
2022-07-04 04:43:26.413518 (Thread-159): 04:43:26  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '08022227-1dd0-4d09-94f1-e256bf2507d1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb1601e6430>]}
2022-07-04 04:43:26.414053 (Thread-159): sending response (<Response 2363 bytes [200 OK]>) to 10.0.12.141
2022-07-04 04:46:35.323972 (Thread-160): handling status request
2022-07-04 04:46:35.325967 (Thread-160): 04:46:35  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '08022227-1dd0-4d09-94f1-e256bf2507d1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb1602d9280>]}
2022-07-04 04:46:35.326471 (Thread-160): sending response (<Response 2363 bytes [200 OK]>) to 10.0.12.141
2022-07-04 04:46:35.683153 (Thread-161): handling run_sql request
2022-07-04 04:46:35.683585 (Thread-161): 04:46:35  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '08022227-1dd0-4d09-94f1-e256bf2507d1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb1601bc100>]}
2022-07-04 04:46:38.045169 (Thread-161): sending response (<Response 139 bytes [200 OK]>) to 10.0.12.141
2022-07-04 04:46:38.075019 (MainThread): 04:46:38  Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'aa991ce2-687c-43b1-86a9-2e42f7b22cb0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f04a3fcc7f0>]}
2022-07-04 04:46:38.075570 (MainThread): 04:46:38  Found 9 models, 0 tests, 0 snapshots, 0 analyses, 179 macros, 0 operations, 0 seed files, 15 sources, 0 exposures, 0 metrics
2022-07-04 04:46:38.076190 (Thread-1): 04:46:38  Acquiring new snowflake connection "rpc.ecommerce_data_model_dbt.request"
2022-07-04 04:46:38.076323 (Thread-1): 04:46:38  Began compiling node rpc.ecommerce_data_model_dbt.request
2022-07-04 04:46:38.076427 (Thread-1): 04:46:38  Compiling rpc.ecommerce_data_model_dbt.request
2022-07-04 04:46:38.081034 (Thread-1): 04:46:38  finished collecting timing info
2022-07-04 04:46:38.081296 (Thread-1): 04:46:38  Began executing node rpc.ecommerce_data_model_dbt.request
2022-07-04 04:46:38.083665 (Thread-1): 04:46:38  Using snowflake connection "rpc.ecommerce_data_model_dbt.request"
2022-07-04 04:46:38.083760 (Thread-1): 04:46:38  On rpc.ecommerce_data_model_dbt.request: with cte_gender as 
(select user_id, gender from 
(select user_id, properties_gender as gender, row_number() over(partition by user_id order by timestamp desc) as rn from 
analytics_db.data_apps_simulated.identifies where timestamp >= '2021-05-01' and timestamp <= '2022-06-29'
and properties_gender is not null and properties_gender != '') where rn = 1),

cte_age as 
(select user_id, age from
(select user_id, 
(CASE WHEN dateadd(year, datediff (year, properties_birthday, getdate()), properties_birthday) > getdate()
      THEN datediff(year, properties_birthday, getdate()) - 1
      ELSE datediff(year, properties_birthday, getdate())
 END) as age, row_number() over(partition by user_id order by timestamp desc) as rn 
from analytics_db.data_apps_simulated.identifies where timestamp >= '2021-05-01' and timestamp <= '2022-06-29'
and properties_birthday is not null and properties_birthday!='') where rn = 1),

cte_country as 
(select user_id, country from 
(select user_id, properties_country as country, row_number() over(partition by user_id order by timestamp desc) as rn from 
analytics_db.data_apps_simulated.identifies where timestamp >= '2021-05-01' and timestamp <= '2022-06-29'
and properties_country is not null and properties_country != '') where rn = 1)

cte_state as 
(select user_id, state from 
(select user_id, properties_state as state, row_number() over(partition by user_id order by timestamp desc) as rn from 
analytics_db.data_apps_simulated.identifies where timestamp >= '2021-05-01' and timestamp <= '2022-06-29'
and properties_state is not null and properties_state != '') where rn = 1)

select coalesce(a.user_id, b.user_id, c.user_id, d.user_id) 
as user_id, gender, age, country, state
from ((cte_gender a full outer join cte_age b on a.user_id = b.user_id) 
full outer join cte_country c on c.user_id = coalesce(a.user_id, b.user_id))
full outer join cte_state d on d.user_id = coalesce(a.user_id, b.user_id, c.user_id)
limit 500
/* limit added automatically by dbt cloud */
2022-07-04 04:46:38.083841 (Thread-1): 04:46:38  Opening a new connection, currently in state init
2022-07-04 04:46:38.449050 (Thread-162): handling poll request
2022-07-04 04:46:38.449523 (Thread-162): 04:46:38  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '08022227-1dd0-4d09-94f1-e256bf2507d1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb1600e6760>]}
2022-07-04 04:46:38.450487 (Thread-162): sending response (<Response 5767 bytes [200 OK]>) to 10.0.12.141
2022-07-04 04:46:38.793462 (Thread-1): 04:46:38  Snowflake adapter: Snowflake query id: 01a55fbe-0602-327e-0019-82030465ca9a
2022-07-04 04:46:38.793654 (Thread-1): 04:46:38  Snowflake adapter: Snowflake error: 001003 (42000): SQL compilation error:
syntax error line 23 at position 0 unexpected 'cte_state'.
syntax error line 25 at position 106 unexpected ')'.
2022-07-04 04:46:38.793811 (Thread-1): 04:46:38  finished collecting timing info
2022-07-04 04:46:38.794011 (Thread-1): 04:46:38  On rpc.ecommerce_data_model_dbt.request: Close
2022-07-04 04:46:38.873894 (Thread-1): Got an exception: Database Error
  001003 (42000): SQL compilation error:
  syntax error line 23 at position 0 unexpected 'cte_state'.
  syntax error line 25 at position 106 unexpected ')'.
Traceback (most recent call last):
  File "/usr/local/lib/python3.8/dist-packages/dbt/adapters/snowflake/connections.py", line 206, in exception_handler
    yield
  File "/usr/local/lib/python3.8/dist-packages/dbt/adapters/sql/connections.py", line 74, in add_query
    cursor.execute(sql, bindings)
  File "/usr/local/lib/python3.8/dist-packages/snowflake/connector/cursor.py", line 721, in execute
    Error.errorhandler_wrapper(
  File "/usr/local/lib/python3.8/dist-packages/snowflake/connector/errors.py", line 258, in errorhandler_wrapper
    cursor.errorhandler(connection, cursor, error_class, error_value)
  File "/usr/local/lib/python3.8/dist-packages/snowflake/connector/errors.py", line 188, in default_errorhandler
    raise error_class(
snowflake.connector.errors.ProgrammingError: 001003 (42000): SQL compilation error:
syntax error line 23 at position 0 unexpected 'cte_state'.
syntax error line 25 at position 106 unexpected ')'.

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/usr/local/lib/python3.8/dist-packages/dbt/task/base.py", line 361, in safe_run
    result = self.compile_and_execute(manifest, ctx)
  File "/usr/local/lib/python3.8/dist-packages/dbt/task/base.py", line 314, in compile_and_execute
    result = self.run(ctx.node, manifest)
  File "/usr/local/lib/python3.8/dist-packages/dbt/task/base.py", line 403, in run
    return self.execute(compiled_node, manifest)
  File "/usr/local/lib/python3.8/dist-packages/dbt_rpc/rpc/node_runners.py", line 90, in execute
    _, execute_result = self.adapter.execute(
  File "/usr/local/lib/python3.8/dist-packages/dbt/adapters/base/impl.py", line 225, in execute
    return self.connections.execute(
  File "/usr/local/lib/python3.8/dist-packages/dbt/adapters/sql/connections.py", line 127, in execute
    _, cursor = self.add_query(sql, auto_begin)
  File "/usr/local/lib/python3.8/dist-packages/dbt/adapters/snowflake/connections.py", line 433, in add_query
    connection, cursor = super().add_query(
  File "/usr/local/lib/python3.8/dist-packages/dbt/adapters/sql/connections.py", line 83, in add_query
    return connection, cursor
  File "/usr/lib/python3.8/contextlib.py", line 131, in __exit__
    self.gen.throw(type, value, traceback)
  File "/usr/local/lib/python3.8/dist-packages/dbt/adapters/snowflake/connections.py", line 223, in exception_handler
    raise DatabaseException(msg)
dbt.exceptions.DatabaseException: Database Error
  001003 (42000): SQL compilation error:
  syntax error line 23 at position 0 unexpected 'cte_state'.
  syntax error line 25 at position 106 unexpected ')'.
2022-07-04 04:46:38.874882 (Thread-1): Got exception RPCException(10003, Database Error, {'type': 'DatabaseException', 'message': "Database Error in rpc request (from remote system)\n  001003 (42000): SQL compilation error:\n  syntax error line 23 at position 0 unexpected 'cte_state'.\n  syntax error line 25 at position 106 unexpected ')'.", 'raw_sql': "with cte_gender as \n(select user_id, gender from \n(select user_id, properties_gender as gender, row_number() over(partition by user_id order by timestamp desc) as rn from \n{{ source('ecommerce', 'identifies') }} where timestamp >= '{{ var('start_date') }}' and timestamp <= '{{ var('end_date') }}'\nand properties_gender is not null and properties_gender != '') where rn = 1),\n\ncte_age as \n(select user_id, age from\n(select user_id, \n(CASE WHEN dateadd(year, datediff (year, properties_birthday, getdate()), properties_birthday) > getdate()\n      THEN datediff(year, properties_birthday, getdate()) - 1\n      ELSE datediff(year, properties_birthday, getdate())\n END) as age, row_number() over(partition by user_id order by timestamp desc) as rn \nfrom {{ source('ecommerce', 'identifies') }} where timestamp >= '{{ var('start_date') }}' and timestamp <= '{{ var('end_date') }}'\nand properties_birthday is not null and properties_birthday!='') where rn = 1),\n\ncte_country as \n(select user_id, country from \n(select user_id, properties_country as country, row_number() over(partition by user_id order by timestamp desc) as rn from \n{{ source('ecommerce', 'identifies') }} where timestamp >= '{{ var('start_date') }}' and timestamp <= '{{ var('end_date') }}'\nand properties_country is not null and properties_country != '') where rn = 1)\n\ncte_state as \n(select user_id, state from \n(select user_id, properties_state as state, row_number() over(partition by user_id order by timestamp desc) as rn from \n{{ source('ecommerce', 'identifies') }} where timestamp >= '{{ var('start_date') }}' and timestamp <= '{{ var('end_date') }}'\nand properties_state is not null and properties_state != '') where rn = 1)\n\nselect coalesce(a.user_id, b.user_id, c.user_id, d.user_id) \nas user_id, gender, age, country, state\nfrom ((cte_gender a full outer join cte_age b on a.user_id = b.user_id) \nfull outer join cte_country c on c.user_id = coalesce(a.user_id, b.user_id))\nfull outer join cte_state d on d.user_id = coalesce(a.user_id, b.user_id, c.user_id)\nlimit 500\n/* limit added automatically by dbt cloud */", 'compiled_sql': "with cte_gender as \n(select user_id, gender from \n(select user_id, properties_gender as gender, row_number() over(partition by user_id order by timestamp desc) as rn from \nanalytics_db.data_apps_simulated.identifies where timestamp >= '2021-05-01' and timestamp <= '2022-06-29'\nand properties_gender is not null and properties_gender != '') where rn = 1),\n\ncte_age as \n(select user_id, age from\n(select user_id, \n(CASE WHEN dateadd(year, datediff (year, properties_birthday, getdate()), properties_birthday) > getdate()\n      THEN datediff(year, properties_birthday, getdate()) - 1\n      ELSE datediff(year, properties_birthday, getdate())\n END) as age, row_number() over(partition by user_id order by timestamp desc) as rn \nfrom analytics_db.data_apps_simulated.identifies where timestamp >= '2021-05-01' and timestamp <= '2022-06-29'\nand properties_birthday is not null and properties_birthday!='') where rn = 1),\n\ncte_country as \n(select user_id, country from \n(select user_id, properties_country as country, row_number() over(partition by user_id order by timestamp desc) as rn from \nanalytics_db.data_apps_simulated.identifies where timestamp >= '2021-05-01' and timestamp <= '2022-06-29'\nand properties_country is not null and properties_country != '') where rn = 1)\n\ncte_state as \n(select user_id, state from \n(select user_id, properties_state as state, row_number() over(partition by user_id order by timestamp desc) as rn from \nanalytics_db.data_apps_simulated.identifies where timestamp >= '2021-05-01' and timestamp <= '2022-06-29'\nand properties_state is not null and properties_state != '') where rn = 1)\n\nselect coalesce(a.user_id, b.user_id, c.user_id, d.user_id) \nas user_id, gender, age, country, state\nfrom ((cte_gender a full outer join cte_age b on a.user_id = b.user_id) \nfull outer join cte_country c on c.user_id = coalesce(a.user_id, b.user_id))\nfull outer join cte_state d on d.user_id = coalesce(a.user_id, b.user_id, c.user_id)\nlimit 500\n/* limit added automatically by dbt cloud */", 'tags': None}, None)
Traceback (most recent call last):
  File "/usr/local/lib/python3.8/dist-packages/dbt_rpc/task/sql_commands.py", line 147, in _in_thread
    self.node_results.append(runner.safe_run(self.manifest))
  File "/usr/local/lib/python3.8/dist-packages/dbt/task/base.py", line 377, in safe_run
    result = self.error_result(ctx.node, error, started, [])
  File "/usr/local/lib/python3.8/dist-packages/dbt_rpc/rpc/node_runners.py", line 56, in error_result
    raise error
dbt_rpc.rpc.error.RPCException: RPCException(10003, Database Error, {'type': 'DatabaseException', 'message': "Database Error in rpc request (from remote system)\n  001003 (42000): SQL compilation error:\n  syntax error line 23 at position 0 unexpected 'cte_state'.\n  syntax error line 25 at position 106 unexpected ')'.", 'raw_sql': "with cte_gender as \n(select user_id, gender from \n(select user_id, properties_gender as gender, row_number() over(partition by user_id order by timestamp desc) as rn from \n{{ source('ecommerce', 'identifies') }} where timestamp >= '{{ var('start_date') }}' and timestamp <= '{{ var('end_date') }}'\nand properties_gender is not null and properties_gender != '') where rn = 1),\n\ncte_age as \n(select user_id, age from\n(select user_id, \n(CASE WHEN dateadd(year, datediff (year, properties_birthday, getdate()), properties_birthday) > getdate()\n      THEN datediff(year, properties_birthday, getdate()) - 1\n      ELSE datediff(year, properties_birthday, getdate())\n END) as age, row_number() over(partition by user_id order by timestamp desc) as rn \nfrom {{ source('ecommerce', 'identifies') }} where timestamp >= '{{ var('start_date') }}' and timestamp <= '{{ var('end_date') }}'\nand properties_birthday is not null and properties_birthday!='') where rn = 1),\n\ncte_country as \n(select user_id, country from \n(select user_id, properties_country as country, row_number() over(partition by user_id order by timestamp desc) as rn from \n{{ source('ecommerce', 'identifies') }} where timestamp >= '{{ var('start_date') }}' and timestamp <= '{{ var('end_date') }}'\nand properties_country is not null and properties_country != '') where rn = 1)\n\ncte_state as \n(select user_id, state from \n(select user_id, properties_state as state, row_number() over(partition by user_id order by timestamp desc) as rn from \n{{ source('ecommerce', 'identifies') }} where timestamp >= '{{ var('start_date') }}' and timestamp <= '{{ var('end_date') }}'\nand properties_state is not null and properties_state != '') where rn = 1)\n\nselect coalesce(a.user_id, b.user_id, c.user_id, d.user_id) \nas user_id, gender, age, country, state\nfrom ((cte_gender a full outer join cte_age b on a.user_id = b.user_id) \nfull outer join cte_country c on c.user_id = coalesce(a.user_id, b.user_id))\nfull outer join cte_state d on d.user_id = coalesce(a.user_id, b.user_id, c.user_id)\nlimit 500\n/* limit added automatically by dbt cloud */", 'compiled_sql': "with cte_gender as \n(select user_id, gender from \n(select user_id, properties_gender as gender, row_number() over(partition by user_id order by timestamp desc) as rn from \nanalytics_db.data_apps_simulated.identifies where timestamp >= '2021-05-01' and timestamp <= '2022-06-29'\nand properties_gender is not null and properties_gender != '') where rn = 1),\n\ncte_age as \n(select user_id, age from\n(select user_id, \n(CASE WHEN dateadd(year, datediff (year, properties_birthday, getdate()), properties_birthday) > getdate()\n      THEN datediff(year, properties_birthday, getdate()) - 1\n      ELSE datediff(year, properties_birthday, getdate())\n END) as age, row_number() over(partition by user_id order by timestamp desc) as rn \nfrom analytics_db.data_apps_simulated.identifies where timestamp >= '2021-05-01' and timestamp <= '2022-06-29'\nand properties_birthday is not null and properties_birthday!='') where rn = 1),\n\ncte_country as \n(select user_id, country from \n(select user_id, properties_country as country, row_number() over(partition by user_id order by timestamp desc) as rn from \nanalytics_db.data_apps_simulated.identifies where timestamp >= '2021-05-01' and timestamp <= '2022-06-29'\nand properties_country is not null and properties_country != '') where rn = 1)\n\ncte_state as \n(select user_id, state from \n(select user_id, properties_state as state, row_number() over(partition by user_id order by timestamp desc) as rn from \nanalytics_db.data_apps_simulated.identifies where timestamp >= '2021-05-01' and timestamp <= '2022-06-29'\nand properties_state is not null and properties_state != '') where rn = 1)\n\nselect coalesce(a.user_id, b.user_id, c.user_id, d.user_id) \nas user_id, gender, age, country, state\nfrom ((cte_gender a full outer join cte_age b on a.user_id = b.user_id) \nfull outer join cte_country c on c.user_id = coalesce(a.user_id, b.user_id))\nfull outer join cte_state d on d.user_id = coalesce(a.user_id, b.user_id, c.user_id)\nlimit 500\n/* limit added automatically by dbt cloud */", 'tags': None}, None)
2022-07-04 04:46:39.847824 (Thread-163): handling poll request
2022-07-04 04:46:39.848254 (Thread-163): 04:46:39  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '08022227-1dd0-4d09-94f1-e256bf2507d1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb1600e6b80>]}
2022-07-04 04:46:39.848943 (Thread-163): sending response (<Response 24452 bytes [200 OK]>) to 10.0.12.141
2022-07-04 04:46:53.584640 (Thread-164): handling status request
2022-07-04 04:46:53.585051 (Thread-164): 04:46:53  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '08022227-1dd0-4d09-94f1-e256bf2507d1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb1600e68e0>]}
2022-07-04 04:46:53.585596 (Thread-164): sending response (<Response 2363 bytes [200 OK]>) to 10.0.12.141
2022-07-04 04:46:53.956096 (Thread-165): handling run_sql request
2022-07-04 04:46:53.956526 (Thread-165): 04:46:53  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '08022227-1dd0-4d09-94f1-e256bf2507d1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb1600e6f10>]}
2022-07-04 04:46:56.314481 (Thread-165): sending response (<Response 139 bytes [200 OK]>) to 10.0.12.141
2022-07-04 04:46:56.342403 (MainThread): 04:46:56  Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '3deac3b2-9b0e-43d5-a9dd-553fd34db6bb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2da4e14970>]}
2022-07-04 04:46:56.342948 (MainThread): 04:46:56  Found 9 models, 0 tests, 0 snapshots, 0 analyses, 179 macros, 0 operations, 0 seed files, 15 sources, 0 exposures, 0 metrics
2022-07-04 04:46:56.343548 (Thread-1): 04:46:56  Acquiring new snowflake connection "rpc.ecommerce_data_model_dbt.request"
2022-07-04 04:46:56.343679 (Thread-1): 04:46:56  Began compiling node rpc.ecommerce_data_model_dbt.request
2022-07-04 04:46:56.343786 (Thread-1): 04:46:56  Compiling rpc.ecommerce_data_model_dbt.request
2022-07-04 04:46:56.348316 (Thread-1): 04:46:56  finished collecting timing info
2022-07-04 04:46:56.348571 (Thread-1): 04:46:56  Began executing node rpc.ecommerce_data_model_dbt.request
2022-07-04 04:46:56.350882 (Thread-1): 04:46:56  Using snowflake connection "rpc.ecommerce_data_model_dbt.request"
2022-07-04 04:46:56.350976 (Thread-1): 04:46:56  On rpc.ecommerce_data_model_dbt.request: with cte_gender as 
(select user_id, gender from 
(select user_id, properties_gender as gender, row_number() over(partition by user_id order by timestamp desc) as rn from 
analytics_db.data_apps_simulated.identifies where timestamp >= '2021-05-01' and timestamp <= '2022-06-29'
and properties_gender is not null and properties_gender != '') where rn = 1),

cte_age as 
(select user_id, age from
(select user_id, 
(CASE WHEN dateadd(year, datediff (year, properties_birthday, getdate()), properties_birthday) > getdate()
      THEN datediff(year, properties_birthday, getdate()) - 1
      ELSE datediff(year, properties_birthday, getdate())
 END) as age, row_number() over(partition by user_id order by timestamp desc) as rn 
from analytics_db.data_apps_simulated.identifies where timestamp >= '2021-05-01' and timestamp <= '2022-06-29'
and properties_birthday is not null and properties_birthday!='') where rn = 1),

cte_country as 
(select user_id, country from 
(select user_id, properties_country as country, row_number() over(partition by user_id order by timestamp desc) as rn from 
analytics_db.data_apps_simulated.identifies where timestamp >= '2021-05-01' and timestamp <= '2022-06-29'
and properties_country is not null and properties_country != '') where rn = 1),

cte_state as 
(select user_id, state from 
(select user_id, properties_state as state, row_number() over(partition by user_id order by timestamp desc) as rn from 
analytics_db.data_apps_simulated.identifies where timestamp >= '2021-05-01' and timestamp <= '2022-06-29'
and properties_state is not null and properties_state != '') where rn = 1)

select coalesce(a.user_id, b.user_id, c.user_id, d.user_id) 
as user_id, gender, age, country, state
from ((cte_gender a full outer join cte_age b on a.user_id = b.user_id) 
full outer join cte_country c on c.user_id = coalesce(a.user_id, b.user_id))
full outer join cte_state d on d.user_id = coalesce(a.user_id, b.user_id, c.user_id)
limit 500
/* limit added automatically by dbt cloud */
2022-07-04 04:46:56.351056 (Thread-1): 04:46:56  Opening a new connection, currently in state init
2022-07-04 04:46:56.700297 (Thread-166): handling poll request
2022-07-04 04:46:56.700758 (Thread-166): 04:46:56  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '08022227-1dd0-4d09-94f1-e256bf2507d1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb1600e5d90>]}
2022-07-04 04:46:56.701651 (Thread-166): sending response (<Response 5768 bytes [200 OK]>) to 10.0.12.141
2022-07-04 04:46:57.482361 (Thread-1): 04:46:57  SQL status: SUCCESS 5 in 1.13 seconds
2022-07-04 04:46:57.483877 (Thread-1): 04:46:57  finished collecting timing info
2022-07-04 04:46:57.484074 (Thread-1): 04:46:57  On rpc.ecommerce_data_model_dbt.request: Close
2022-07-04 04:46:58.082797 (Thread-167): handling poll request
2022-07-04 04:46:58.083187 (Thread-167): 04:46:58  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '08022227-1dd0-4d09-94f1-e256bf2507d1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb1600df370>]}
2022-07-04 04:46:58.084153 (Thread-167): sending response (<Response 12036 bytes [200 OK]>) to 10.0.12.141
2022-07-04 04:47:11.851445 (Thread-168): 04:47:11  Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
2022-07-04 04:47:11.851924 (Thread-168): 04:47:11  Partial parsing: updated file: ecommerce_data_model_dbt://models/data_model/stg_user_traits.sql
2022-07-04 04:47:11.856570 (Thread-168): 04:47:11  1603: static parser failed on data_model/stg_user_traits.sql
2022-07-04 04:47:11.863436 (Thread-168): 04:47:11  1602: parser fallback to jinja rendering on data_model/stg_user_traits.sql
2022-07-04 04:47:11.902280 (Thread-168): 04:47:11  [WARNING]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.data-apps-ecommerce-template.data_model

2022-07-04 04:47:11.907659 (Thread-168): 04:47:11  Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '08022227-1dd0-4d09-94f1-e256bf2507d1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb1107f6550>]}
2022-07-04 04:47:12.582757 (Thread-169): handling status request
2022-07-04 04:47:12.583389 (Thread-169): 04:47:12  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '08022227-1dd0-4d09-94f1-e256bf2507d1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb1600dcd60>]}
2022-07-04 04:47:12.583955 (Thread-169): sending response (<Response 2357 bytes [200 OK]>) to 10.0.12.141
2022-07-04 04:47:12.591804 (Thread-170): handling status request
2022-07-04 04:47:12.592083 (Thread-170): 04:47:12  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '08022227-1dd0-4d09-94f1-e256bf2507d1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb1602d9760>]}
2022-07-04 04:47:12.592489 (Thread-170): sending response (<Response 2357 bytes [200 OK]>) to 10.0.12.141
2022-07-04 04:47:41.793500 (Thread-171): 04:47:41  Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
2022-07-04 04:47:41.793728 (Thread-171): 04:47:41  Partial parsing enabled, no changes found, skipping parsing
2022-07-04 04:47:41.794275 (Thread-171): 04:47:41  [WARNING]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.data-apps-ecommerce-template.data_model

2022-07-04 04:47:41.799418 (Thread-171): 04:47:41  Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '08022227-1dd0-4d09-94f1-e256bf2507d1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb11079eee0>]}
2022-07-04 04:47:42.611949 (Thread-172): handling status request
2022-07-04 04:47:42.612370 (Thread-172): 04:47:42  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '08022227-1dd0-4d09-94f1-e256bf2507d1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb11074d940>]}
2022-07-04 04:47:42.612852 (Thread-172): sending response (<Response 1703 bytes [200 OK]>) to 10.0.12.141
2022-07-04 04:47:42.656732 (Thread-173): handling status request
2022-07-04 04:47:42.657128 (Thread-173): 04:47:42  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '08022227-1dd0-4d09-94f1-e256bf2507d1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb11074d7f0>]}
2022-07-04 04:47:42.663833 (Thread-173): sending response (<Response 1703 bytes [200 OK]>) to 10.0.12.141
2022-07-04 04:49:53.616902 (Thread-174): 04:49:53  Partial parsing enabled: 0 files deleted, 1 files added, 0 files changed.
2022-07-04 04:49:53.618024 (Thread-174): 04:49:53  Partial parsing: added file: ecommerce_data_model_dbt://models/data_model/temp_folder/email_domain.sql
2022-07-04 04:49:53.622347 (Thread-174): 04:49:53  1699: static parser successfully parsed data_model/temp_folder/email_domain.sql
2022-07-04 04:49:53.664571 (Thread-174): 04:49:53  [WARNING]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.data-apps-ecommerce-template.data_model

2022-07-04 04:49:53.670061 (Thread-174): 04:49:53  Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '08022227-1dd0-4d09-94f1-e256bf2507d1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb110661c40>]}
2022-07-04 04:49:54.319374 (Thread-175): handling status request
2022-07-04 04:49:54.319794 (Thread-175): 04:49:54  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '08022227-1dd0-4d09-94f1-e256bf2507d1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb1600aa5e0>]}
2022-07-04 04:49:54.320326 (Thread-175): sending response (<Response 2067 bytes [200 OK]>) to 10.0.12.141
2022-07-04 04:49:54.415365 (Thread-176): handling status request
2022-07-04 04:49:54.415798 (Thread-176): 04:49:54  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '08022227-1dd0-4d09-94f1-e256bf2507d1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb1600aa3a0>]}
2022-07-04 04:49:54.416330 (Thread-176): sending response (<Response 2067 bytes [200 OK]>) to 10.0.12.141
2022-07-04 05:04:43.050951 (Thread-177): handling status request
2022-07-04 05:04:43.052948 (Thread-177): 05:04:43  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '08022227-1dd0-4d09-94f1-e256bf2507d1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb1107bbcd0>]}
2022-07-04 05:04:43.053461 (Thread-177): sending response (<Response 2067 bytes [200 OK]>) to 10.0.12.141
2022-07-04 05:04:43.448829 (Thread-178): handling run_sql request
2022-07-04 05:04:43.449232 (Thread-178): 05:04:43  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '08022227-1dd0-4d09-94f1-e256bf2507d1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb1107bbe80>]}
2022-07-04 05:04:45.856212 (Thread-178): sending response (<Response 139 bytes [200 OK]>) to 10.0.12.141
2022-07-04 05:04:45.884861 (MainThread): 05:04:45  Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'a114736c-bb0b-443d-8734-6ab9f59e225d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7e9d275a00>]}
2022-07-04 05:04:45.885414 (MainThread): 05:04:45  Found 10 models, 0 tests, 0 snapshots, 0 analyses, 179 macros, 0 operations, 0 seed files, 15 sources, 0 exposures, 0 metrics
2022-07-04 05:04:45.886033 (Thread-1): 05:04:45  Acquiring new snowflake connection "rpc.ecommerce_data_model_dbt.request"
2022-07-04 05:04:45.886158 (Thread-1): 05:04:45  Began compiling node rpc.ecommerce_data_model_dbt.request
2022-07-04 05:04:45.886256 (Thread-1): 05:04:45  Compiling rpc.ecommerce_data_model_dbt.request
2022-07-04 05:04:45.888774 (Thread-1): 05:04:45  finished collecting timing info
2022-07-04 05:04:45.888905 (Thread-1): 05:04:45  Began executing node rpc.ecommerce_data_model_dbt.request
2022-07-04 05:04:45.889751 (Thread-1): 05:04:45  Using snowflake connection "rpc.ecommerce_data_model_dbt.request"
2022-07-04 05:04:45.889839 (Thread-1): 05:04:45  On rpc.ecommerce_data_model_dbt.request: select user_id, email_domain from 
(select user_id, substring(properties_email, charindex( '@', properties_email) + 1, len(properties_email)) as email_domain, row_number() over(partition by user_id order by timestamp desc) as rn from 
analytics_db.data_apps_simulated.identifies where timestamp >= '2021-05-01' and timestamp <= '2022-06-29'
and properties_email is not null and properties_email != '') where rn = 1
limit 500
/* limit added automatically by dbt cloud */
2022-07-04 05:04:45.889953 (Thread-1): 05:04:45  Opening a new connection, currently in state init
2022-07-04 05:04:46.231772 (Thread-179): handling poll request
2022-07-04 05:04:46.232242 (Thread-179): 05:04:46  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '08022227-1dd0-4d09-94f1-e256bf2507d1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb11063d7c0>]}
2022-07-04 05:04:46.233173 (Thread-179): sending response (<Response 4208 bytes [200 OK]>) to 10.0.12.141
2022-07-04 05:04:46.814866 (Thread-1): 05:04:46  SQL status: SUCCESS 5 in 0.92 seconds
2022-07-04 05:04:46.816304 (Thread-1): 05:04:46  finished collecting timing info
2022-07-04 05:04:46.816492 (Thread-1): 05:04:46  On rpc.ecommerce_data_model_dbt.request: Close
2022-07-04 05:04:47.615513 (Thread-180): handling poll request
2022-07-04 05:04:47.615916 (Thread-180): 05:04:47  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '08022227-1dd0-4d09-94f1-e256bf2507d1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb110643250>]}
2022-07-04 05:04:47.638529 (Thread-180): sending response (<Response 5305 bytes [200 OK]>) to 10.0.12.141
2022-07-04 05:06:42.332365 (Thread-181): 05:06:42  Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
2022-07-04 05:06:42.334374 (Thread-181): 05:06:42  Partial parsing: updated file: ecommerce_data_model_dbt://models/data_model/stg_user_traits.sql
2022-07-04 05:06:42.338945 (Thread-181): 05:06:42  1603: static parser failed on data_model/stg_user_traits.sql
2022-07-04 05:06:42.345974 (Thread-181): 05:06:42  1602: parser fallback to jinja rendering on data_model/stg_user_traits.sql
2022-07-04 05:06:42.383440 (Thread-181): 05:06:42  [WARNING]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.data-apps-ecommerce-template.data_model

2022-07-04 05:06:42.388970 (Thread-181): 05:06:42  Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '08022227-1dd0-4d09-94f1-e256bf2507d1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb110674490>]}
2022-07-04 05:06:43.067240 (Thread-182): handling status request
2022-07-04 05:06:43.067663 (Thread-182): 05:06:43  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '08022227-1dd0-4d09-94f1-e256bf2507d1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb110758f70>]}
2022-07-04 05:06:43.068196 (Thread-182): sending response (<Response 2357 bytes [200 OK]>) to 10.0.12.141
2022-07-04 05:06:43.149367 (Thread-183): handling status request
2022-07-04 05:06:43.149766 (Thread-183): 05:06:43  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '08022227-1dd0-4d09-94f1-e256bf2507d1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb110758e20>]}
2022-07-04 05:06:43.150298 (Thread-183): sending response (<Response 2357 bytes [200 OK]>) to 10.0.12.141
2022-07-04 05:06:44.196963 (Thread-184): handling status request
2022-07-04 05:06:44.197370 (Thread-184): 05:06:44  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '08022227-1dd0-4d09-94f1-e256bf2507d1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb110758ca0>]}
2022-07-04 05:06:44.197866 (Thread-184): sending response (<Response 2357 bytes [200 OK]>) to 10.0.12.141
2022-07-04 05:06:44.595941 (Thread-185): handling run_sql request
2022-07-04 05:06:44.596353 (Thread-185): 05:06:44  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '08022227-1dd0-4d09-94f1-e256bf2507d1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb110758790>]}
2022-07-04 05:06:46.948512 (Thread-185): sending response (<Response 139 bytes [200 OK]>) to 10.0.12.141
2022-07-04 05:06:46.978574 (MainThread): 05:06:46  Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'f45441f9-2fd0-41d5-8237-4a0c82f821a6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe3c1710a90>]}
2022-07-04 05:06:46.979107 (MainThread): 05:06:46  Found 10 models, 0 tests, 0 snapshots, 0 analyses, 179 macros, 0 operations, 0 seed files, 15 sources, 0 exposures, 0 metrics
2022-07-04 05:06:46.979713 (Thread-1): 05:06:46  Acquiring new snowflake connection "rpc.ecommerce_data_model_dbt.request"
2022-07-04 05:06:46.979843 (Thread-1): 05:06:46  Began compiling node rpc.ecommerce_data_model_dbt.request
2022-07-04 05:06:46.979933 (Thread-1): 05:06:46  Compiling rpc.ecommerce_data_model_dbt.request
2022-07-04 05:06:46.985210 (Thread-1): 05:06:46  finished collecting timing info
2022-07-04 05:06:46.985344 (Thread-1): 05:06:46  Began executing node rpc.ecommerce_data_model_dbt.request
2022-07-04 05:06:46.988245 (Thread-1): 05:06:46  Using snowflake connection "rpc.ecommerce_data_model_dbt.request"
2022-07-04 05:06:46.988341 (Thread-1): 05:06:46  On rpc.ecommerce_data_model_dbt.request: with cte_gender as 
(select user_id, gender from 
(select user_id, properties_gender as gender, row_number() over(partition by user_id order by timestamp desc) as rn from 
analytics_db.data_apps_simulated.identifies where timestamp >= '2021-05-01' and timestamp <= '2022-06-29'
and properties_gender is not null and properties_gender != '') where rn = 1),

cte_age as 
(select user_id, age from
(select user_id, 
(CASE WHEN dateadd(year, datediff (year, properties_birthday, getdate()), properties_birthday) > getdate()
      THEN datediff(year, properties_birthday, getdate()) - 1
      ELSE datediff(year, properties_birthday, getdate())
 END) as age, row_number() over(partition by user_id order by timestamp desc) as rn 
from analytics_db.data_apps_simulated.identifies where timestamp >= '2021-05-01' and timestamp <= '2022-06-29'
and properties_birthday is not null and properties_birthday!='') where rn = 1),

cte_country as 
(select user_id, country from 
(select user_id, properties_country as country, row_number() over(partition by user_id order by timestamp desc) as rn from 
analytics_db.data_apps_simulated.identifies where timestamp >= '2021-05-01' and timestamp <= '2022-06-29'
and properties_country is not null and properties_country != '') where rn = 1),

cte_state as 
(select user_id, state from 
(select user_id, properties_state as state, row_number() over(partition by user_id order by timestamp desc) as rn from 
analytics_db.data_apps_simulated.identifies where timestamp >= '2021-05-01' and timestamp <= '2022-06-29'
and properties_state is not null and properties_state != '') where rn = 1)

cte_email_domain as 
(select user_id, email_domain from 
(select user_id, substring(properties_email, charindex( '@', properties_email) + 1, len(properties_email)) as email_domain, row_number() over(partition by user_id order by timestamp desc) as rn from 
analytics_db.data_apps_simulated.identifies where timestamp >= '2021-05-01' and timestamp <= '2022-06-29'
and properties_email is not null and properties_email != '') where rn = 1)

select coalesce(a.user_id, b.user_id, c.user_id, d.user_id,e.user_id) 
as user_id, gender, age, country, state, email_domain
from (((cte_gender a full outer join cte_age b on a.user_id = b.user_id) 
full outer join cte_country c on c.user_id = coalesce(a.user_id, b.user_id))
full outer join cte_state d on d.user_id = coalesce(a.user_id, b.user_id, c.user_id))
full outer join cte_email_domain e on e.user_id = coalesce(a.user_id, b.user_id, c.user_id,d.user_id, e.user_id)
limit 500
/* limit added automatically by dbt cloud */
2022-07-04 05:06:46.988425 (Thread-1): 05:06:46  Opening a new connection, currently in state init
2022-07-04 05:06:47.338063 (Thread-186): handling poll request
2022-07-04 05:06:47.338560 (Thread-186): 05:06:47  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '08022227-1dd0-4d09-94f1-e256bf2507d1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb110788310>]}
2022-07-04 05:06:47.339522 (Thread-186): sending response (<Response 6354 bytes [200 OK]>) to 10.0.12.141
2022-07-04 05:06:47.644935 (Thread-1): 05:06:47  Snowflake adapter: Snowflake query id: 01a55fd2-0602-2ed5-0019-82030465d72e
2022-07-04 05:06:47.645134 (Thread-1): 05:06:47  Snowflake adapter: Snowflake error: 001003 (42000): SQL compilation error:
syntax error line 29 at position 0 unexpected 'cte_email_domain'.
syntax error line 31 at position 186 unexpected ')'.
2022-07-04 05:06:47.645295 (Thread-1): 05:06:47  finished collecting timing info
2022-07-04 05:06:47.645451 (Thread-1): 05:06:47  On rpc.ecommerce_data_model_dbt.request: Close
2022-07-04 05:06:47.782733 (Thread-1): Got an exception: Database Error
  001003 (42000): SQL compilation error:
  syntax error line 29 at position 0 unexpected 'cte_email_domain'.
  syntax error line 31 at position 186 unexpected ')'.
Traceback (most recent call last):
  File "/usr/local/lib/python3.8/dist-packages/dbt/adapters/snowflake/connections.py", line 206, in exception_handler
    yield
  File "/usr/local/lib/python3.8/dist-packages/dbt/adapters/sql/connections.py", line 74, in add_query
    cursor.execute(sql, bindings)
  File "/usr/local/lib/python3.8/dist-packages/snowflake/connector/cursor.py", line 721, in execute
    Error.errorhandler_wrapper(
  File "/usr/local/lib/python3.8/dist-packages/snowflake/connector/errors.py", line 258, in errorhandler_wrapper
    cursor.errorhandler(connection, cursor, error_class, error_value)
  File "/usr/local/lib/python3.8/dist-packages/snowflake/connector/errors.py", line 188, in default_errorhandler
    raise error_class(
snowflake.connector.errors.ProgrammingError: 001003 (42000): SQL compilation error:
syntax error line 29 at position 0 unexpected 'cte_email_domain'.
syntax error line 31 at position 186 unexpected ')'.

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/usr/local/lib/python3.8/dist-packages/dbt/task/base.py", line 361, in safe_run
    result = self.compile_and_execute(manifest, ctx)
  File "/usr/local/lib/python3.8/dist-packages/dbt/task/base.py", line 314, in compile_and_execute
    result = self.run(ctx.node, manifest)
  File "/usr/local/lib/python3.8/dist-packages/dbt/task/base.py", line 403, in run
    return self.execute(compiled_node, manifest)
  File "/usr/local/lib/python3.8/dist-packages/dbt_rpc/rpc/node_runners.py", line 90, in execute
    _, execute_result = self.adapter.execute(
  File "/usr/local/lib/python3.8/dist-packages/dbt/adapters/base/impl.py", line 225, in execute
    return self.connections.execute(
  File "/usr/local/lib/python3.8/dist-packages/dbt/adapters/sql/connections.py", line 127, in execute
    _, cursor = self.add_query(sql, auto_begin)
  File "/usr/local/lib/python3.8/dist-packages/dbt/adapters/snowflake/connections.py", line 433, in add_query
    connection, cursor = super().add_query(
  File "/usr/local/lib/python3.8/dist-packages/dbt/adapters/sql/connections.py", line 83, in add_query
    return connection, cursor
  File "/usr/lib/python3.8/contextlib.py", line 131, in __exit__
    self.gen.throw(type, value, traceback)
  File "/usr/local/lib/python3.8/dist-packages/dbt/adapters/snowflake/connections.py", line 223, in exception_handler
    raise DatabaseException(msg)
dbt.exceptions.DatabaseException: Database Error
  001003 (42000): SQL compilation error:
  syntax error line 29 at position 0 unexpected 'cte_email_domain'.
  syntax error line 31 at position 186 unexpected ')'.
2022-07-04 05:06:47.783723 (Thread-1): Got exception RPCException(10003, Database Error, {'type': 'DatabaseException', 'message': "Database Error in rpc request (from remote system)\n  001003 (42000): SQL compilation error:\n  syntax error line 29 at position 0 unexpected 'cte_email_domain'.\n  syntax error line 31 at position 186 unexpected ')'.", 'raw_sql': "with cte_gender as \n(select user_id, gender from \n(select user_id, properties_gender as gender, row_number() over(partition by user_id order by timestamp desc) as rn from \n{{ source('ecommerce', 'identifies') }} where timestamp >= '{{ var('start_date') }}' and timestamp <= '{{ var('end_date') }}'\nand properties_gender is not null and properties_gender != '') where rn = 1),\n\ncte_age as \n(select user_id, age from\n(select user_id, \n(CASE WHEN dateadd(year, datediff (year, properties_birthday, getdate()), properties_birthday) > getdate()\n      THEN datediff(year, properties_birthday, getdate()) - 1\n      ELSE datediff(year, properties_birthday, getdate())\n END) as age, row_number() over(partition by user_id order by timestamp desc) as rn \nfrom {{ source('ecommerce', 'identifies') }} where timestamp >= '{{ var('start_date') }}' and timestamp <= '{{ var('end_date') }}'\nand properties_birthday is not null and properties_birthday!='') where rn = 1),\n\ncte_country as \n(select user_id, country from \n(select user_id, properties_country as country, row_number() over(partition by user_id order by timestamp desc) as rn from \n{{ source('ecommerce', 'identifies') }} where timestamp >= '{{ var('start_date') }}' and timestamp <= '{{ var('end_date') }}'\nand properties_country is not null and properties_country != '') where rn = 1),\n\ncte_state as \n(select user_id, state from \n(select user_id, properties_state as state, row_number() over(partition by user_id order by timestamp desc) as rn from \n{{ source('ecommerce', 'identifies') }} where timestamp >= '{{ var('start_date') }}' and timestamp <= '{{ var('end_date') }}'\nand properties_state is not null and properties_state != '') where rn = 1)\n\ncte_email_domain as \n(select user_id, email_domain from \n(select user_id, substring(properties_email, charindex( '@', properties_email) + 1, len(properties_email)) as email_domain, row_number() over(partition by user_id order by timestamp desc) as rn from \n{{ source('ecommerce', 'identifies') }} where timestamp >= '{{ var('start_date') }}' and timestamp <= '{{ var('end_date') }}'\nand properties_email is not null and properties_email != '') where rn = 1)\n\nselect coalesce(a.user_id, b.user_id, c.user_id, d.user_id,e.user_id) \nas user_id, gender, age, country, state, email_domain\nfrom (((cte_gender a full outer join cte_age b on a.user_id = b.user_id) \nfull outer join cte_country c on c.user_id = coalesce(a.user_id, b.user_id))\nfull outer join cte_state d on d.user_id = coalesce(a.user_id, b.user_id, c.user_id))\nfull outer join cte_email_domain e on e.user_id = coalesce(a.user_id, b.user_id, c.user_id,d.user_id, e.user_id)\nlimit 500\n/* limit added automatically by dbt cloud */", 'compiled_sql': "with cte_gender as \n(select user_id, gender from \n(select user_id, properties_gender as gender, row_number() over(partition by user_id order by timestamp desc) as rn from \nanalytics_db.data_apps_simulated.identifies where timestamp >= '2021-05-01' and timestamp <= '2022-06-29'\nand properties_gender is not null and properties_gender != '') where rn = 1),\n\ncte_age as \n(select user_id, age from\n(select user_id, \n(CASE WHEN dateadd(year, datediff (year, properties_birthday, getdate()), properties_birthday) > getdate()\n      THEN datediff(year, properties_birthday, getdate()) - 1\n      ELSE datediff(year, properties_birthday, getdate())\n END) as age, row_number() over(partition by user_id order by timestamp desc) as rn \nfrom analytics_db.data_apps_simulated.identifies where timestamp >= '2021-05-01' and timestamp <= '2022-06-29'\nand properties_birthday is not null and properties_birthday!='') where rn = 1),\n\ncte_country as \n(select user_id, country from \n(select user_id, properties_country as country, row_number() over(partition by user_id order by timestamp desc) as rn from \nanalytics_db.data_apps_simulated.identifies where timestamp >= '2021-05-01' and timestamp <= '2022-06-29'\nand properties_country is not null and properties_country != '') where rn = 1),\n\ncte_state as \n(select user_id, state from \n(select user_id, properties_state as state, row_number() over(partition by user_id order by timestamp desc) as rn from \nanalytics_db.data_apps_simulated.identifies where timestamp >= '2021-05-01' and timestamp <= '2022-06-29'\nand properties_state is not null and properties_state != '') where rn = 1)\n\ncte_email_domain as \n(select user_id, email_domain from \n(select user_id, substring(properties_email, charindex( '@', properties_email) + 1, len(properties_email)) as email_domain, row_number() over(partition by user_id order by timestamp desc) as rn from \nanalytics_db.data_apps_simulated.identifies where timestamp >= '2021-05-01' and timestamp <= '2022-06-29'\nand properties_email is not null and properties_email != '') where rn = 1)\n\nselect coalesce(a.user_id, b.user_id, c.user_id, d.user_id,e.user_id) \nas user_id, gender, age, country, state, email_domain\nfrom (((cte_gender a full outer join cte_age b on a.user_id = b.user_id) \nfull outer join cte_country c on c.user_id = coalesce(a.user_id, b.user_id))\nfull outer join cte_state d on d.user_id = coalesce(a.user_id, b.user_id, c.user_id))\nfull outer join cte_email_domain e on e.user_id = coalesce(a.user_id, b.user_id, c.user_id,d.user_id, e.user_id)\nlimit 500\n/* limit added automatically by dbt cloud */", 'tags': None}, None)
Traceback (most recent call last):
  File "/usr/local/lib/python3.8/dist-packages/dbt_rpc/task/sql_commands.py", line 147, in _in_thread
    self.node_results.append(runner.safe_run(self.manifest))
  File "/usr/local/lib/python3.8/dist-packages/dbt/task/base.py", line 377, in safe_run
    result = self.error_result(ctx.node, error, started, [])
  File "/usr/local/lib/python3.8/dist-packages/dbt_rpc/rpc/node_runners.py", line 56, in error_result
    raise error
dbt_rpc.rpc.error.RPCException: RPCException(10003, Database Error, {'type': 'DatabaseException', 'message': "Database Error in rpc request (from remote system)\n  001003 (42000): SQL compilation error:\n  syntax error line 29 at position 0 unexpected 'cte_email_domain'.\n  syntax error line 31 at position 186 unexpected ')'.", 'raw_sql': "with cte_gender as \n(select user_id, gender from \n(select user_id, properties_gender as gender, row_number() over(partition by user_id order by timestamp desc) as rn from \n{{ source('ecommerce', 'identifies') }} where timestamp >= '{{ var('start_date') }}' and timestamp <= '{{ var('end_date') }}'\nand properties_gender is not null and properties_gender != '') where rn = 1),\n\ncte_age as \n(select user_id, age from\n(select user_id, \n(CASE WHEN dateadd(year, datediff (year, properties_birthday, getdate()), properties_birthday) > getdate()\n      THEN datediff(year, properties_birthday, getdate()) - 1\n      ELSE datediff(year, properties_birthday, getdate())\n END) as age, row_number() over(partition by user_id order by timestamp desc) as rn \nfrom {{ source('ecommerce', 'identifies') }} where timestamp >= '{{ var('start_date') }}' and timestamp <= '{{ var('end_date') }}'\nand properties_birthday is not null and properties_birthday!='') where rn = 1),\n\ncte_country as \n(select user_id, country from \n(select user_id, properties_country as country, row_number() over(partition by user_id order by timestamp desc) as rn from \n{{ source('ecommerce', 'identifies') }} where timestamp >= '{{ var('start_date') }}' and timestamp <= '{{ var('end_date') }}'\nand properties_country is not null and properties_country != '') where rn = 1),\n\ncte_state as \n(select user_id, state from \n(select user_id, properties_state as state, row_number() over(partition by user_id order by timestamp desc) as rn from \n{{ source('ecommerce', 'identifies') }} where timestamp >= '{{ var('start_date') }}' and timestamp <= '{{ var('end_date') }}'\nand properties_state is not null and properties_state != '') where rn = 1)\n\ncte_email_domain as \n(select user_id, email_domain from \n(select user_id, substring(properties_email, charindex( '@', properties_email) + 1, len(properties_email)) as email_domain, row_number() over(partition by user_id order by timestamp desc) as rn from \n{{ source('ecommerce', 'identifies') }} where timestamp >= '{{ var('start_date') }}' and timestamp <= '{{ var('end_date') }}'\nand properties_email is not null and properties_email != '') where rn = 1)\n\nselect coalesce(a.user_id, b.user_id, c.user_id, d.user_id,e.user_id) \nas user_id, gender, age, country, state, email_domain\nfrom (((cte_gender a full outer join cte_age b on a.user_id = b.user_id) \nfull outer join cte_country c on c.user_id = coalesce(a.user_id, b.user_id))\nfull outer join cte_state d on d.user_id = coalesce(a.user_id, b.user_id, c.user_id))\nfull outer join cte_email_domain e on e.user_id = coalesce(a.user_id, b.user_id, c.user_id,d.user_id, e.user_id)\nlimit 500\n/* limit added automatically by dbt cloud */", 'compiled_sql': "with cte_gender as \n(select user_id, gender from \n(select user_id, properties_gender as gender, row_number() over(partition by user_id order by timestamp desc) as rn from \nanalytics_db.data_apps_simulated.identifies where timestamp >= '2021-05-01' and timestamp <= '2022-06-29'\nand properties_gender is not null and properties_gender != '') where rn = 1),\n\ncte_age as \n(select user_id, age from\n(select user_id, \n(CASE WHEN dateadd(year, datediff (year, properties_birthday, getdate()), properties_birthday) > getdate()\n      THEN datediff(year, properties_birthday, getdate()) - 1\n      ELSE datediff(year, properties_birthday, getdate())\n END) as age, row_number() over(partition by user_id order by timestamp desc) as rn \nfrom analytics_db.data_apps_simulated.identifies where timestamp >= '2021-05-01' and timestamp <= '2022-06-29'\nand properties_birthday is not null and properties_birthday!='') where rn = 1),\n\ncte_country as \n(select user_id, country from \n(select user_id, properties_country as country, row_number() over(partition by user_id order by timestamp desc) as rn from \nanalytics_db.data_apps_simulated.identifies where timestamp >= '2021-05-01' and timestamp <= '2022-06-29'\nand properties_country is not null and properties_country != '') where rn = 1),\n\ncte_state as \n(select user_id, state from \n(select user_id, properties_state as state, row_number() over(partition by user_id order by timestamp desc) as rn from \nanalytics_db.data_apps_simulated.identifies where timestamp >= '2021-05-01' and timestamp <= '2022-06-29'\nand properties_state is not null and properties_state != '') where rn = 1)\n\ncte_email_domain as \n(select user_id, email_domain from \n(select user_id, substring(properties_email, charindex( '@', properties_email) + 1, len(properties_email)) as email_domain, row_number() over(partition by user_id order by timestamp desc) as rn from \nanalytics_db.data_apps_simulated.identifies where timestamp >= '2021-05-01' and timestamp <= '2022-06-29'\nand properties_email is not null and properties_email != '') where rn = 1)\n\nselect coalesce(a.user_id, b.user_id, c.user_id, d.user_id,e.user_id) \nas user_id, gender, age, country, state, email_domain\nfrom (((cte_gender a full outer join cte_age b on a.user_id = b.user_id) \nfull outer join cte_country c on c.user_id = coalesce(a.user_id, b.user_id))\nfull outer join cte_state d on d.user_id = coalesce(a.user_id, b.user_id, c.user_id))\nfull outer join cte_email_domain e on e.user_id = coalesce(a.user_id, b.user_id, c.user_id,d.user_id, e.user_id)\nlimit 500\n/* limit added automatically by dbt cloud */", 'tags': None}, None)
2022-07-04 05:06:48.717347 (Thread-187): handling poll request
2022-07-04 05:06:48.717754 (Thread-187): 05:06:48  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '08022227-1dd0-4d09-94f1-e256bf2507d1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb1107880d0>]}
2022-07-04 05:06:48.718612 (Thread-187): sending response (<Response 28692 bytes [200 OK]>) to 10.0.12.141
2022-07-04 05:06:50.338356 (Thread-188): handling status request
2022-07-04 05:06:50.338785 (Thread-188): 05:06:50  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '08022227-1dd0-4d09-94f1-e256bf2507d1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb11078dc70>]}
2022-07-04 05:06:50.339368 (Thread-188): sending response (<Response 2357 bytes [200 OK]>) to 10.0.12.141
2022-07-04 05:06:50.732858 (Thread-189): handling run_sql request
2022-07-04 05:06:50.733261 (Thread-189): 05:06:50  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '08022227-1dd0-4d09-94f1-e256bf2507d1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb1600aa3d0>]}
2022-07-04 05:06:51.572451 (Thread-190): 05:06:51  Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
2022-07-04 05:06:51.573037 (Thread-190): 05:06:51  Partial parsing: updated file: ecommerce_data_model_dbt://models/data_model/stg_user_traits.sql
2022-07-04 05:06:51.577634 (Thread-190): 05:06:51  1603: static parser failed on data_model/stg_user_traits.sql
2022-07-04 05:06:51.584549 (Thread-190): 05:06:51  1602: parser fallback to jinja rendering on data_model/stg_user_traits.sql
2022-07-04 05:06:51.623169 (Thread-190): 05:06:51  [WARNING]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.data-apps-ecommerce-template.data_model

2022-07-04 05:06:51.628902 (Thread-190): 05:06:51  Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '08022227-1dd0-4d09-94f1-e256bf2507d1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb1105a1b80>]}
2022-07-04 05:06:52.610302 (Thread-191): handling status request
2022-07-04 05:06:52.610699 (Thread-191): 05:06:52  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '08022227-1dd0-4d09-94f1-e256bf2507d1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb110674d00>]}
2022-07-04 05:06:52.611333 (Thread-191): sending response (<Response 2357 bytes [200 OK]>) to 10.0.12.141
2022-07-04 05:06:52.653495 (Thread-192): handling status request
2022-07-04 05:06:52.653877 (Thread-192): 05:06:52  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '08022227-1dd0-4d09-94f1-e256bf2507d1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb110598a60>]}
2022-07-04 05:06:52.654377 (Thread-192): sending response (<Response 2357 bytes [200 OK]>) to 10.0.12.141
2022-07-04 05:06:53.094835 (Thread-189): sending response (<Response 139 bytes [200 OK]>) to 10.0.12.141
2022-07-04 05:06:53.125133 (MainThread): 05:06:53  Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'c3c19b83-4ab6-44ab-9061-9c571ab5714b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4ac0dd0b50>]}
2022-07-04 05:06:53.125701 (MainThread): 05:06:53  Found 10 models, 0 tests, 0 snapshots, 0 analyses, 179 macros, 0 operations, 0 seed files, 15 sources, 0 exposures, 0 metrics
2022-07-04 05:06:53.126340 (Thread-1): 05:06:53  Acquiring new snowflake connection "rpc.ecommerce_data_model_dbt.request"
2022-07-04 05:06:53.126476 (Thread-1): 05:06:53  Began compiling node rpc.ecommerce_data_model_dbt.request
2022-07-04 05:06:53.126573 (Thread-1): 05:06:53  Compiling rpc.ecommerce_data_model_dbt.request
2022-07-04 05:06:53.132028 (Thread-1): 05:06:53  finished collecting timing info
2022-07-04 05:06:53.132166 (Thread-1): 05:06:53  Began executing node rpc.ecommerce_data_model_dbt.request
2022-07-04 05:06:53.135050 (Thread-1): 05:06:53  Using snowflake connection "rpc.ecommerce_data_model_dbt.request"
2022-07-04 05:06:53.135149 (Thread-1): 05:06:53  On rpc.ecommerce_data_model_dbt.request: with cte_gender as 
(select user_id, gender from 
(select user_id, properties_gender as gender, row_number() over(partition by user_id order by timestamp desc) as rn from 
analytics_db.data_apps_simulated.identifies where timestamp >= '2021-05-01' and timestamp <= '2022-06-29'
and properties_gender is not null and properties_gender != '') where rn = 1),

cte_age as 
(select user_id, age from
(select user_id, 
(CASE WHEN dateadd(year, datediff (year, properties_birthday, getdate()), properties_birthday) > getdate()
      THEN datediff(year, properties_birthday, getdate()) - 1
      ELSE datediff(year, properties_birthday, getdate())
 END) as age, row_number() over(partition by user_id order by timestamp desc) as rn 
from analytics_db.data_apps_simulated.identifies where timestamp >= '2021-05-01' and timestamp <= '2022-06-29'
and properties_birthday is not null and properties_birthday!='') where rn = 1),

cte_country as 
(select user_id, country from 
(select user_id, properties_country as country, row_number() over(partition by user_id order by timestamp desc) as rn from 
analytics_db.data_apps_simulated.identifies where timestamp >= '2021-05-01' and timestamp <= '2022-06-29'
and properties_country is not null and properties_country != '') where rn = 1),

cte_state as 
(select user_id, state from 
(select user_id, properties_state as state, row_number() over(partition by user_id order by timestamp desc) as rn from 
analytics_db.data_apps_simulated.identifies where timestamp >= '2021-05-01' and timestamp <= '2022-06-29'
and properties_state is not null and properties_state != '') where rn = 1),

cte_email_domain as 
(select user_id, email_domain from 
(select user_id, substring(properties_email, charindex( '@', properties_email) + 1, len(properties_email)) as email_domain, row_number() over(partition by user_id order by timestamp desc) as rn from 
analytics_db.data_apps_simulated.identifies where timestamp >= '2021-05-01' and timestamp <= '2022-06-29'
and properties_email is not null and properties_email != '') where rn = 1)

select coalesce(a.user_id, b.user_id, c.user_id, d.user_id,e.user_id) 
as user_id, gender, age, country, state, email_domain
from (((cte_gender a full outer join cte_age b on a.user_id = b.user_id) 
full outer join cte_country c on c.user_id = coalesce(a.user_id, b.user_id))
full outer join cte_state d on d.user_id = coalesce(a.user_id, b.user_id, c.user_id))
full outer join cte_email_domain e on e.user_id = coalesce(a.user_id, b.user_id, c.user_id,d.user_id, e.user_id)
limit 500
/* limit added automatically by dbt cloud */
2022-07-04 05:06:53.135234 (Thread-1): 05:06:53  Opening a new connection, currently in state init
2022-07-04 05:06:53.468343 (Thread-193): handling poll request
2022-07-04 05:06:53.468740 (Thread-193): 05:06:53  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '08022227-1dd0-4d09-94f1-e256bf2507d1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb110598a60>]}
2022-07-04 05:06:53.469418 (Thread-193): sending response (<Response 6355 bytes [200 OK]>) to 10.0.12.141
2022-07-04 05:06:54.311521 (Thread-1): 05:06:54  SQL status: SUCCESS 5 in 1.18 seconds
2022-07-04 05:06:54.313072 (Thread-1): 05:06:54  finished collecting timing info
2022-07-04 05:06:54.313258 (Thread-1): 05:06:54  On rpc.ecommerce_data_model_dbt.request: Close
2022-07-04 05:06:54.843723 (Thread-194): handling poll request
2022-07-04 05:06:54.844116 (Thread-194): 05:06:54  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '08022227-1dd0-4d09-94f1-e256bf2507d1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb1105cd190>]}
2022-07-04 05:06:54.844974 (Thread-194): sending response (<Response 14595 bytes [200 OK]>) to 10.0.12.141
2022-07-04 05:06:56.569709 (Thread-195): 05:06:56  Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
2022-07-04 05:06:56.569958 (Thread-195): 05:06:56  Partial parsing enabled, no changes found, skipping parsing
2022-07-04 05:06:56.570487 (Thread-195): 05:06:56  [WARNING]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.data-apps-ecommerce-template.data_model

2022-07-04 05:06:56.576249 (Thread-195): 05:06:56  Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '08022227-1dd0-4d09-94f1-e256bf2507d1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb1105b1e80>]}
2022-07-04 05:06:57.333584 (Thread-196): handling status request
2022-07-04 05:06:57.334048 (Thread-196): 05:06:57  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '08022227-1dd0-4d09-94f1-e256bf2507d1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb11063dc70>]}
2022-07-04 05:06:57.334527 (Thread-196): sending response (<Response 1703 bytes [200 OK]>) to 10.0.12.141
2022-07-04 05:06:57.370425 (Thread-197): handling status request
2022-07-04 05:06:57.370790 (Thread-197): 05:06:57  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '08022227-1dd0-4d09-94f1-e256bf2507d1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb1105981f0>]}
2022-07-04 05:06:57.371247 (Thread-197): sending response (<Response 1703 bytes [200 OK]>) to 10.0.12.141
2022-07-04 05:06:58.071432 (Thread-198): handling status request
2022-07-04 05:06:58.071850 (Thread-198): 05:06:58  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '08022227-1dd0-4d09-94f1-e256bf2507d1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb110598100>]}
2022-07-04 05:06:58.072352 (Thread-198): sending response (<Response 1703 bytes [200 OK]>) to 10.0.12.141
2022-07-04 05:06:58.442612 (Thread-199): handling run_sql request
2022-07-04 05:06:58.443012 (Thread-199): 05:06:58  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '08022227-1dd0-4d09-94f1-e256bf2507d1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb11070ddf0>]}
2022-07-04 05:07:00.765968 (Thread-199): sending response (<Response 139 bytes [200 OK]>) to 10.0.12.141
2022-07-04 05:07:00.795618 (MainThread): 05:07:00  Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '1fb2ceb5-e002-432c-ac7e-aa7e6bed6686', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdb31f4c8e0>]}
2022-07-04 05:07:00.796179 (MainThread): 05:07:00  Found 10 models, 0 tests, 0 snapshots, 0 analyses, 179 macros, 0 operations, 0 seed files, 15 sources, 0 exposures, 0 metrics
2022-07-04 05:07:00.796787 (Thread-1): 05:07:00  Acquiring new snowflake connection "rpc.ecommerce_data_model_dbt.request"
2022-07-04 05:07:00.796920 (Thread-1): 05:07:00  Began compiling node rpc.ecommerce_data_model_dbt.request
2022-07-04 05:07:00.797016 (Thread-1): 05:07:00  Compiling rpc.ecommerce_data_model_dbt.request
2022-07-04 05:07:00.802734 (Thread-1): 05:07:00  finished collecting timing info
2022-07-04 05:07:00.802877 (Thread-1): 05:07:00  Began executing node rpc.ecommerce_data_model_dbt.request
2022-07-04 05:07:00.805790 (Thread-1): 05:07:00  Using snowflake connection "rpc.ecommerce_data_model_dbt.request"
2022-07-04 05:07:00.805887 (Thread-1): 05:07:00  On rpc.ecommerce_data_model_dbt.request: with cte_gender as 
(select user_id, gender from 
(select user_id, properties_gender as gender, row_number() over(partition by user_id order by timestamp desc) as rn from 
analytics_db.data_apps_simulated.identifies where timestamp >= '2021-05-01' and timestamp <= '2022-06-29'
and properties_gender is not null and properties_gender != '') where rn = 1),

cte_age as 
(select user_id, age from
(select user_id, 
(CASE WHEN dateadd(year, datediff (year, properties_birthday, getdate()), properties_birthday) > getdate()
      THEN datediff(year, properties_birthday, getdate()) - 1
      ELSE datediff(year, properties_birthday, getdate())
 END) as age, row_number() over(partition by user_id order by timestamp desc) as rn 
from analytics_db.data_apps_simulated.identifies where timestamp >= '2021-05-01' and timestamp <= '2022-06-29'
and properties_birthday is not null and properties_birthday!='') where rn = 1),

cte_country as 
(select user_id, country from 
(select user_id, properties_country as country, row_number() over(partition by user_id order by timestamp desc) as rn from 
analytics_db.data_apps_simulated.identifies where timestamp >= '2021-05-01' and timestamp <= '2022-06-29'
and properties_country is not null and properties_country != '') where rn = 1),

cte_state as 
(select user_id, state from 
(select user_id, properties_state as state, row_number() over(partition by user_id order by timestamp desc) as rn from 
analytics_db.data_apps_simulated.identifies where timestamp >= '2021-05-01' and timestamp <= '2022-06-29'
and properties_state is not null and properties_state != '') where rn = 1),

cte_email_domain as 
(select user_id, email_domain from 
(select user_id, substring(properties_email, charindex( '@', properties_email) + 1, len(properties_email)) as email_domain, row_number() over(partition by user_id order by timestamp desc) as rn from 
analytics_db.data_apps_simulated.identifies where timestamp >= '2021-05-01' and timestamp <= '2022-06-29'
and properties_email is not null and properties_email != '') where rn = 1)

select coalesce(a.user_id, b.user_id, c.user_id, d.user_id,e.user_id) 
as user_id, gender, age, country, state, email_domain
from (((cte_gender a full outer join cte_age b on a.user_id = b.user_id) 
full outer join cte_country c on c.user_id = coalesce(a.user_id, b.user_id))
full outer join cte_state d on d.user_id = coalesce(a.user_id, b.user_id, c.user_id))
full outer join cte_email_domain e on e.user_id = coalesce(a.user_id, b.user_id, c.user_id,d.user_id, e.user_id)
limit 500
/* limit added automatically by dbt cloud */
2022-07-04 05:07:00.806003 (Thread-1): 05:07:00  Opening a new connection, currently in state init
2022-07-04 05:07:01.135927 (Thread-200): handling poll request
2022-07-04 05:07:01.136410 (Thread-200): 05:07:01  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '08022227-1dd0-4d09-94f1-e256bf2507d1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb110788dc0>]}
2022-07-04 05:07:01.137320 (Thread-200): sending response (<Response 6365 bytes [200 OK]>) to 10.0.12.141
2022-07-04 05:07:02.126119 (Thread-1): 05:07:02  SQL status: SUCCESS 5 in 1.32 seconds
2022-07-04 05:07:02.127682 (Thread-1): 05:07:02  finished collecting timing info
2022-07-04 05:07:02.127864 (Thread-1): 05:07:02  On rpc.ecommerce_data_model_dbt.request: Close
2022-07-04 05:07:02.515189 (Thread-201): handling poll request
2022-07-04 05:07:02.515610 (Thread-201): 05:07:02  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '08022227-1dd0-4d09-94f1-e256bf2507d1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb110652460>]}
2022-07-04 05:07:02.516621 (Thread-201): sending response (<Response 14597 bytes [200 OK]>) to 10.0.12.141
2022-07-04 05:09:56.679521 (Thread-202): 05:09:56  Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
2022-07-04 05:09:56.681164 (Thread-202): 05:09:56  Partial parsing enabled, no changes found, skipping parsing
2022-07-04 05:09:56.681779 (Thread-202): 05:09:56  [WARNING]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.data-apps-ecommerce-template.data_model

2022-07-04 05:09:56.688157 (Thread-202): 05:09:56  Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '08022227-1dd0-4d09-94f1-e256bf2507d1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb1105b83a0>]}
2022-07-04 05:09:57.469087 (Thread-203): handling status request
2022-07-04 05:09:57.469512 (Thread-203): 05:09:57  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '08022227-1dd0-4d09-94f1-e256bf2507d1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb1105f60d0>]}
2022-07-04 05:09:57.470084 (Thread-203): sending response (<Response 1703 bytes [200 OK]>) to 10.0.12.141
2022-07-04 05:09:57.816126 (Thread-204): handling status request
2022-07-04 05:09:57.816538 (Thread-204): 05:09:57  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '08022227-1dd0-4d09-94f1-e256bf2507d1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb1104e2b80>]}
2022-07-04 05:09:57.817024 (Thread-204): sending response (<Response 1703 bytes [200 OK]>) to 10.0.12.141
2022-07-04 05:10:11.738357 (Thread-205): 05:10:11  Partial parsing enabled: 0 files deleted, 1 files added, 0 files changed.
2022-07-04 05:10:11.738742 (Thread-205): 05:10:11  Partial parsing: added file: ecommerce_data_model_dbt://models/data_model/temp_folder/user_traits_test.sql
2022-07-04 05:10:11.743197 (Thread-205): 05:10:11  1699: static parser successfully parsed data_model/temp_folder/user_traits_test.sql
2022-07-04 05:10:11.778529 (Thread-205): 05:10:11  [WARNING]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.data-apps-ecommerce-template.data_model

2022-07-04 05:10:11.783727 (Thread-205): 05:10:11  Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '08022227-1dd0-4d09-94f1-e256bf2507d1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb1104304f0>]}
2022-07-04 05:10:12.434891 (Thread-206): handling status request
2022-07-04 05:10:12.435313 (Thread-206): 05:10:12  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '08022227-1dd0-4d09-94f1-e256bf2507d1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb1104d8520>]}
2022-07-04 05:10:12.435818 (Thread-206): sending response (<Response 2075 bytes [200 OK]>) to 10.0.12.141
2022-07-04 05:10:12.482348 (Thread-207): handling status request
2022-07-04 05:10:12.482727 (Thread-207): 05:10:12  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '08022227-1dd0-4d09-94f1-e256bf2507d1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb1104d8370>]}
2022-07-04 05:10:12.483215 (Thread-207): sending response (<Response 2075 bytes [200 OK]>) to 10.0.12.141
2022-07-04 05:11:07.688436 (Thread-208): handling status request
2022-07-04 05:11:07.688872 (Thread-208): 05:11:07  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '08022227-1dd0-4d09-94f1-e256bf2507d1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb110607790>]}
2022-07-04 05:11:07.689413 (Thread-208): sending response (<Response 2075 bytes [200 OK]>) to 10.0.12.141
2022-07-04 05:11:08.065098 (Thread-209): handling run_sql request
2022-07-04 05:11:08.065500 (Thread-209): 05:11:08  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '08022227-1dd0-4d09-94f1-e256bf2507d1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb1106073a0>]}
2022-07-04 05:11:10.367046 (Thread-209): sending response (<Response 139 bytes [200 OK]>) to 10.0.12.141
2022-07-04 05:11:10.394983 (MainThread): dbt runtime exception
Traceback (most recent call last):
  File "/usr/local/lib/python3.8/dist-packages/dbt_rpc/rpc/task_handler.py", line 102, in task_exec
    result = self.task.handle_request()
  File "/usr/local/lib/python3.8/dist-packages/dbt_rpc/task/sql_commands.py", line 164, in handle_request
    node = self._get_exec_node()
  File "/usr/local/lib/python3.8/dist-packages/dbt_rpc/task/sql_commands.py", line 125, in _get_exec_node
    add_new_refs(
  File "/usr/local/lib/python3.8/dist-packages/dbt_rpc/task/sql_commands.py", line 50, in add_new_refs
    process_node(config, manifest, node)
  File "/usr/local/lib/python3.8/dist-packages/dbt/parser/manifest.py", line 1278, in process_node
    _process_refs_for_node(manifest, config.project_name, node)
  File "/usr/local/lib/python3.8/dist-packages/dbt/parser/manifest.py", line 1163, in _process_refs_for_node
    invalid_ref_fail_unless_test(
  File "/usr/local/lib/python3.8/dist-packages/dbt/parser/manifest.py", line 901, in invalid_ref_fail_unless_test
    ref_target_not_found(
  File "/usr/local/lib/python3.8/dist-packages/dbt/exceptions.py", line 621, in ref_target_not_found
    raise_compiler_error(msg, model)
  File "/usr/local/lib/python3.8/dist-packages/dbt/exceptions.py", line 441, in raise_compiler_error
    raise CompilationException(msg, node)
dbt.exceptions.CompilationException: Compilation Error in rpc request (from remote system)
  Rpc 'rpc.ecommerce_data_model_dbt.request' (from remote system) depends on a node named 'gender.sql' which was not found
2022-07-04 05:11:10.736289 (Thread-210): handling poll request
2022-07-04 05:11:10.736765 (Thread-210): 05:11:10  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '08022227-1dd0-4d09-94f1-e256bf2507d1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb11060cd00>]}
2022-07-04 05:11:10.761477 (Thread-210): sending response (<Response 4909 bytes [200 OK]>) to 10.0.12.141
2022-07-04 05:11:28.951822 (Thread-211): 05:11:28  Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
2022-07-04 05:11:28.952303 (Thread-211): 05:11:28  Partial parsing: updated file: ecommerce_data_model_dbt://models/data_model/temp_folder/gender.sql
2022-07-04 05:11:28.956646 (Thread-211): 05:11:28  1603: static parser failed on data_model/temp_folder/gender.sql
2022-07-04 05:11:28.960942 (Thread-211): 05:11:28  1602: parser fallback to jinja rendering on data_model/temp_folder/gender.sql
2022-07-04 05:11:28.997990 (Thread-211): 05:11:28  [WARNING]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.data-apps-ecommerce-template.data_model

2022-07-04 05:11:29.003157 (Thread-211): 05:11:29  Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '08022227-1dd0-4d09-94f1-e256bf2507d1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb1103b54f0>]}
2022-07-04 05:11:29.649175 (Thread-212): handling status request
2022-07-04 05:11:29.649570 (Thread-212): 05:11:29  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '08022227-1dd0-4d09-94f1-e256bf2507d1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb11038e850>]}
2022-07-04 05:11:29.650113 (Thread-212): sending response (<Response 2366 bytes [200 OK]>) to 10.0.12.141
2022-07-04 05:11:29.697070 (Thread-213): handling status request
2022-07-04 05:11:29.697377 (Thread-213): 05:11:29  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '08022227-1dd0-4d09-94f1-e256bf2507d1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb11038ef10>]}
2022-07-04 05:11:29.697819 (Thread-213): sending response (<Response 2366 bytes [200 OK]>) to 10.0.12.141
2022-07-04 05:11:35.786049 (Thread-214): handling status request
2022-07-04 05:11:35.786476 (Thread-214): 05:11:35  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '08022227-1dd0-4d09-94f1-e256bf2507d1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb1105f6700>]}
2022-07-04 05:11:35.786994 (Thread-214): sending response (<Response 2366 bytes [200 OK]>) to 10.0.12.141
2022-07-04 05:11:36.187508 (Thread-215): handling run_sql request
2022-07-04 05:11:36.187921 (Thread-215): 05:11:36  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '08022227-1dd0-4d09-94f1-e256bf2507d1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb1105f6670>]}
2022-07-04 05:11:38.509224 (Thread-215): sending response (<Response 139 bytes [200 OK]>) to 10.0.12.141
2022-07-04 05:11:38.537464 (MainThread): dbt runtime exception
Traceback (most recent call last):
  File "/usr/local/lib/python3.8/dist-packages/dbt_rpc/rpc/task_handler.py", line 102, in task_exec
    result = self.task.handle_request()
  File "/usr/local/lib/python3.8/dist-packages/dbt_rpc/task/sql_commands.py", line 164, in handle_request
    node = self._get_exec_node()
  File "/usr/local/lib/python3.8/dist-packages/dbt_rpc/task/sql_commands.py", line 125, in _get_exec_node
    add_new_refs(
  File "/usr/local/lib/python3.8/dist-packages/dbt_rpc/task/sql_commands.py", line 50, in add_new_refs
    process_node(config, manifest, node)
  File "/usr/local/lib/python3.8/dist-packages/dbt/parser/manifest.py", line 1278, in process_node
    _process_refs_for_node(manifest, config.project_name, node)
  File "/usr/local/lib/python3.8/dist-packages/dbt/parser/manifest.py", line 1163, in _process_refs_for_node
    invalid_ref_fail_unless_test(
  File "/usr/local/lib/python3.8/dist-packages/dbt/parser/manifest.py", line 901, in invalid_ref_fail_unless_test
    ref_target_not_found(
  File "/usr/local/lib/python3.8/dist-packages/dbt/exceptions.py", line 621, in ref_target_not_found
    raise_compiler_error(msg, model)
  File "/usr/local/lib/python3.8/dist-packages/dbt/exceptions.py", line 441, in raise_compiler_error
    raise CompilationException(msg, node)
dbt.exceptions.CompilationException: Compilation Error in rpc request (from remote system)
  Rpc 'rpc.ecommerce_data_model_dbt.request' (from remote system) depends on a node named 'gender_table' which was not found
2022-07-04 05:11:38.892868 (Thread-216): handling poll request
2022-07-04 05:11:38.893362 (Thread-216): 05:11:38  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '08022227-1dd0-4d09-94f1-e256bf2507d1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb110648d30>]}
2022-07-04 05:11:38.894172 (Thread-216): sending response (<Response 4915 bytes [200 OK]>) to 10.0.12.141
2022-07-04 05:11:49.044249 (Thread-217): 05:11:49  Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
2022-07-04 05:11:49.044475 (Thread-217): 05:11:49  Partial parsing enabled, no changes found, skipping parsing
2022-07-04 05:11:49.045057 (Thread-217): 05:11:49  [WARNING]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.data-apps-ecommerce-template.data_model

2022-07-04 05:11:49.050744 (Thread-217): 05:11:49  Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '08022227-1dd0-4d09-94f1-e256bf2507d1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb1107c5130>]}
2022-07-04 05:11:49.649844 (Thread-218): handling status request
2022-07-04 05:11:49.650276 (Thread-218): 05:11:49  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '08022227-1dd0-4d09-94f1-e256bf2507d1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb1106728e0>]}
2022-07-04 05:11:49.650768 (Thread-218): sending response (<Response 1703 bytes [200 OK]>) to 10.0.12.141
2022-07-04 05:11:49.652348 (Thread-219): handling status request
2022-07-04 05:11:49.652624 (Thread-219): 05:11:49  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '08022227-1dd0-4d09-94f1-e256bf2507d1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb110672400>]}
2022-07-04 05:11:49.653001 (Thread-219): sending response (<Response 1703 bytes [200 OK]>) to 10.0.12.141
2022-07-04 05:11:50.316164 (Thread-220): handling status request
2022-07-04 05:11:50.316582 (Thread-220): 05:11:50  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '08022227-1dd0-4d09-94f1-e256bf2507d1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb110672c10>]}
2022-07-04 05:11:50.317079 (Thread-220): sending response (<Response 1703 bytes [200 OK]>) to 10.0.12.141
2022-07-04 05:11:50.802108 (Thread-221): handling run_sql request
2022-07-04 05:11:50.802515 (Thread-221): 05:11:50  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '08022227-1dd0-4d09-94f1-e256bf2507d1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb1106729d0>]}
2022-07-04 05:11:53.135873 (Thread-221): sending response (<Response 139 bytes [200 OK]>) to 10.0.12.141
2022-07-04 05:11:53.161394 (MainThread): 05:11:53  Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'cd80552a-8512-467b-964d-57af48b1b06d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4dd134fc10>]}
2022-07-04 05:11:53.161972 (MainThread): 05:11:53  Found 11 models, 0 tests, 0 snapshots, 0 analyses, 179 macros, 0 operations, 0 seed files, 15 sources, 0 exposures, 0 metrics
2022-07-04 05:11:53.162592 (Thread-1): 05:11:53  Acquiring new snowflake connection "rpc.ecommerce_data_model_dbt.request"
2022-07-04 05:11:53.162726 (Thread-1): 05:11:53  Began compiling node rpc.ecommerce_data_model_dbt.request
2022-07-04 05:11:53.162824 (Thread-1): 05:11:53  Compiling rpc.ecommerce_data_model_dbt.request
2022-07-04 05:11:53.165339 (Thread-1): 05:11:53  finished collecting timing info
2022-07-04 05:11:53.165471 (Thread-1): 05:11:53  Began executing node rpc.ecommerce_data_model_dbt.request
2022-07-04 05:11:53.166341 (Thread-1): 05:11:53  Using snowflake connection "rpc.ecommerce_data_model_dbt.request"
2022-07-04 05:11:53.166438 (Thread-1): 05:11:53  On rpc.ecommerce_data_model_dbt.request: select user_id, gender from 
(select user_id, properties_gender as gender, row_number() over(partition by user_id order by timestamp desc) as rn from 
analytics_db.data_apps_simulated.identifies where timestamp >= '2021-05-01' and timestamp <= '2022-06-29'
and properties_gender is not null and properties_gender != '') where rn = 1 as gender_table
limit 500
/* limit added automatically by dbt cloud */
2022-07-04 05:11:53.166521 (Thread-1): 05:11:53  Opening a new connection, currently in state init
2022-07-04 05:11:53.529453 (Thread-222): handling poll request
2022-07-04 05:11:53.529973 (Thread-222): 05:11:53  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '08022227-1dd0-4d09-94f1-e256bf2507d1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb110648f40>]}
2022-07-04 05:11:53.530894 (Thread-222): sending response (<Response 4146 bytes [200 OK]>) to 10.0.12.141
2022-07-04 05:11:54.273476 (Thread-1): 05:11:54  Snowflake adapter: Snowflake query id: 01a55fd7-0602-3256-0019-82030465bdaa
2022-07-04 05:11:54.273680 (Thread-1): 05:11:54  Snowflake adapter: Snowflake error: 001003 (42000): SQL compilation error:
syntax error line 4 at position 76 unexpected 'as'.
2022-07-04 05:11:54.273844 (Thread-1): 05:11:54  finished collecting timing info
2022-07-04 05:11:54.274046 (Thread-1): 05:11:54  On rpc.ecommerce_data_model_dbt.request: Close
2022-07-04 05:11:54.356020 (Thread-1): Got an exception: Database Error
  001003 (42000): SQL compilation error:
  syntax error line 4 at position 76 unexpected 'as'.
Traceback (most recent call last):
  File "/usr/local/lib/python3.8/dist-packages/dbt/adapters/snowflake/connections.py", line 206, in exception_handler
    yield
  File "/usr/local/lib/python3.8/dist-packages/dbt/adapters/sql/connections.py", line 74, in add_query
    cursor.execute(sql, bindings)
  File "/usr/local/lib/python3.8/dist-packages/snowflake/connector/cursor.py", line 721, in execute
    Error.errorhandler_wrapper(
  File "/usr/local/lib/python3.8/dist-packages/snowflake/connector/errors.py", line 258, in errorhandler_wrapper
    cursor.errorhandler(connection, cursor, error_class, error_value)
  File "/usr/local/lib/python3.8/dist-packages/snowflake/connector/errors.py", line 188, in default_errorhandler
    raise error_class(
snowflake.connector.errors.ProgrammingError: 001003 (42000): SQL compilation error:
syntax error line 4 at position 76 unexpected 'as'.

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/usr/local/lib/python3.8/dist-packages/dbt/task/base.py", line 361, in safe_run
    result = self.compile_and_execute(manifest, ctx)
  File "/usr/local/lib/python3.8/dist-packages/dbt/task/base.py", line 314, in compile_and_execute
    result = self.run(ctx.node, manifest)
  File "/usr/local/lib/python3.8/dist-packages/dbt/task/base.py", line 403, in run
    return self.execute(compiled_node, manifest)
  File "/usr/local/lib/python3.8/dist-packages/dbt_rpc/rpc/node_runners.py", line 90, in execute
    _, execute_result = self.adapter.execute(
  File "/usr/local/lib/python3.8/dist-packages/dbt/adapters/base/impl.py", line 225, in execute
    return self.connections.execute(
  File "/usr/local/lib/python3.8/dist-packages/dbt/adapters/sql/connections.py", line 127, in execute
    _, cursor = self.add_query(sql, auto_begin)
  File "/usr/local/lib/python3.8/dist-packages/dbt/adapters/snowflake/connections.py", line 433, in add_query
    connection, cursor = super().add_query(
  File "/usr/local/lib/python3.8/dist-packages/dbt/adapters/sql/connections.py", line 83, in add_query
    return connection, cursor
  File "/usr/lib/python3.8/contextlib.py", line 131, in __exit__
    self.gen.throw(type, value, traceback)
  File "/usr/local/lib/python3.8/dist-packages/dbt/adapters/snowflake/connections.py", line 223, in exception_handler
    raise DatabaseException(msg)
dbt.exceptions.DatabaseException: Database Error
  001003 (42000): SQL compilation error:
  syntax error line 4 at position 76 unexpected 'as'.
2022-07-04 05:11:54.356944 (Thread-1): Got exception RPCException(10003, Database Error, {'type': 'DatabaseException', 'message': "Database Error in rpc request (from remote system)\n  001003 (42000): SQL compilation error:\n  syntax error line 4 at position 76 unexpected 'as'.", 'raw_sql': "select user_id, gender from \r\n(select user_id, properties_gender as gender, row_number() over(partition by user_id order by timestamp desc) as rn from \r\n{{ source('ecommerce', 'identifies') }} where timestamp >= '{{ var('start_date') }}' and timestamp <= '{{ var('end_date') }}'\r\nand properties_gender is not null and properties_gender != '') where rn = 1 as gender_table\nlimit 500\n/* limit added automatically by dbt cloud */", 'compiled_sql': "select user_id, gender from \n(select user_id, properties_gender as gender, row_number() over(partition by user_id order by timestamp desc) as rn from \nanalytics_db.data_apps_simulated.identifies where timestamp >= '2021-05-01' and timestamp <= '2022-06-29'\nand properties_gender is not null and properties_gender != '') where rn = 1 as gender_table\nlimit 500\n/* limit added automatically by dbt cloud */", 'tags': None}, None)
Traceback (most recent call last):
  File "/usr/local/lib/python3.8/dist-packages/dbt_rpc/task/sql_commands.py", line 147, in _in_thread
    self.node_results.append(runner.safe_run(self.manifest))
  File "/usr/local/lib/python3.8/dist-packages/dbt/task/base.py", line 377, in safe_run
    result = self.error_result(ctx.node, error, started, [])
  File "/usr/local/lib/python3.8/dist-packages/dbt_rpc/rpc/node_runners.py", line 56, in error_result
    raise error
dbt_rpc.rpc.error.RPCException: RPCException(10003, Database Error, {'type': 'DatabaseException', 'message': "Database Error in rpc request (from remote system)\n  001003 (42000): SQL compilation error:\n  syntax error line 4 at position 76 unexpected 'as'.", 'raw_sql': "select user_id, gender from \r\n(select user_id, properties_gender as gender, row_number() over(partition by user_id order by timestamp desc) as rn from \r\n{{ source('ecommerce', 'identifies') }} where timestamp >= '{{ var('start_date') }}' and timestamp <= '{{ var('end_date') }}'\r\nand properties_gender is not null and properties_gender != '') where rn = 1 as gender_table\nlimit 500\n/* limit added automatically by dbt cloud */", 'compiled_sql': "select user_id, gender from \n(select user_id, properties_gender as gender, row_number() over(partition by user_id order by timestamp desc) as rn from \nanalytics_db.data_apps_simulated.identifies where timestamp >= '2021-05-01' and timestamp <= '2022-06-29'\nand properties_gender is not null and properties_gender != '') where rn = 1 as gender_table\nlimit 500\n/* limit added automatically by dbt cloud */", 'tags': None}, None)
2022-07-04 05:11:54.911467 (Thread-223): handling poll request
2022-07-04 05:11:54.911871 (Thread-223): 05:11:54  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '08022227-1dd0-4d09-94f1-e256bf2507d1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb110648ac0>]}
2022-07-04 05:11:54.912537 (Thread-223): sending response (<Response 12316 bytes [200 OK]>) to 10.0.12.141
2022-07-04 05:12:06.742320 (Thread-224): 05:12:06  Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
2022-07-04 05:12:06.742808 (Thread-224): 05:12:06  Partial parsing: updated file: ecommerce_data_model_dbt://models/data_model/temp_folder/gender.sql
2022-07-04 05:12:06.747155 (Thread-224): 05:12:06  1603: static parser failed on data_model/temp_folder/gender.sql
2022-07-04 05:12:06.751464 (Thread-224): 05:12:06  1602: parser fallback to jinja rendering on data_model/temp_folder/gender.sql
2022-07-04 05:12:06.789951 (Thread-224): 05:12:06  [WARNING]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.data-apps-ecommerce-template.data_model

2022-07-04 05:12:06.795162 (Thread-224): 05:12:06  Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '08022227-1dd0-4d09-94f1-e256bf2507d1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb16052ba30>]}
2022-07-04 05:12:07.501100 (Thread-225): handling status request
2022-07-04 05:12:07.501511 (Thread-225): 05:12:07  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '08022227-1dd0-4d09-94f1-e256bf2507d1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb160114eb0>]}
2022-07-04 05:12:07.502057 (Thread-225): sending response (<Response 2366 bytes [200 OK]>) to 10.0.12.141
2022-07-04 05:12:07.574588 (Thread-226): handling status request
2022-07-04 05:12:07.574993 (Thread-226): 05:12:07  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '08022227-1dd0-4d09-94f1-e256bf2507d1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb160115dc0>]}
2022-07-04 05:12:07.575504 (Thread-226): sending response (<Response 2366 bytes [200 OK]>) to 10.0.12.141
2022-07-04 05:12:08.487962 (Thread-227): handling status request
2022-07-04 05:12:08.488390 (Thread-227): 05:12:08  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '08022227-1dd0-4d09-94f1-e256bf2507d1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb160115a30>]}
2022-07-04 05:12:08.488935 (Thread-227): sending response (<Response 2366 bytes [200 OK]>) to 10.0.12.141
2022-07-04 05:12:08.863866 (Thread-228): handling run_sql request
2022-07-04 05:12:08.864281 (Thread-228): 05:12:08  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '08022227-1dd0-4d09-94f1-e256bf2507d1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb1601156d0>]}
2022-07-04 05:12:11.193571 (Thread-228): sending response (<Response 139 bytes [200 OK]>) to 10.0.12.141
2022-07-04 05:12:11.219266 (MainThread): 05:12:11  Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '856bf5c6-da6e-45d0-87e0-7a231d5a7981', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f91575918b0>]}
2022-07-04 05:12:11.219843 (MainThread): 05:12:11  Found 11 models, 0 tests, 0 snapshots, 0 analyses, 179 macros, 0 operations, 0 seed files, 15 sources, 0 exposures, 0 metrics
2022-07-04 05:12:11.220487 (Thread-1): 05:12:11  Acquiring new snowflake connection "rpc.ecommerce_data_model_dbt.request"
2022-07-04 05:12:11.220626 (Thread-1): 05:12:11  Began compiling node rpc.ecommerce_data_model_dbt.request
2022-07-04 05:12:11.220724 (Thread-1): 05:12:11  Compiling rpc.ecommerce_data_model_dbt.request
2022-07-04 05:12:11.223418 (Thread-1): 05:12:11  finished collecting timing info
2022-07-04 05:12:11.223555 (Thread-1): 05:12:11  Began executing node rpc.ecommerce_data_model_dbt.request
2022-07-04 05:12:11.224367 (Thread-1): 05:12:11  Using snowflake connection "rpc.ecommerce_data_model_dbt.request"
2022-07-04 05:12:11.224459 (Thread-1): 05:12:11  On rpc.ecommerce_data_model_dbt.request: select user_id, gender from 
(select user_id, properties_gender as gender, row_number() over(partition by user_id order by timestamp desc) as rn from 
analytics_db.data_apps_simulated.identifies where timestamp >= '2021-05-01' and timestamp <= '2022-06-29'
and properties_gender is not null and properties_gender != '') where rn = 1
limit 500
/* limit added automatically by dbt cloud */
2022-07-04 05:12:11.224541 (Thread-1): 05:12:11  Opening a new connection, currently in state init
2022-07-04 05:12:11.559115 (Thread-229): handling poll request
2022-07-04 05:12:11.559626 (Thread-229): 05:12:11  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '08022227-1dd0-4d09-94f1-e256bf2507d1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb1601e6df0>]}
2022-07-04 05:12:11.560559 (Thread-229): sending response (<Response 4130 bytes [200 OK]>) to 10.0.12.141
2022-07-04 05:12:12.927337 (Thread-230): handling poll request
2022-07-04 05:12:12.927764 (Thread-230): 05:12:12  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '08022227-1dd0-4d09-94f1-e256bf2507d1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb1601e6d90>]}
2022-07-04 05:12:12.928268 (Thread-230): sending response (<Response 402 bytes [200 OK]>) to 10.0.12.141
2022-07-04 05:12:14.320666 (Thread-231): handling poll request
2022-07-04 05:12:14.321109 (Thread-231): 05:12:14  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '08022227-1dd0-4d09-94f1-e256bf2507d1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb1601e6c40>]}
2022-07-04 05:12:14.321621 (Thread-231): sending response (<Response 402 bytes [200 OK]>) to 10.0.12.141
2022-07-04 05:12:15.684914 (Thread-232): handling poll request
2022-07-04 05:12:15.685312 (Thread-232): 05:12:15  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '08022227-1dd0-4d09-94f1-e256bf2507d1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb1601e6ee0>]}
2022-07-04 05:12:15.685802 (Thread-232): sending response (<Response 402 bytes [200 OK]>) to 10.0.12.141
2022-07-04 05:12:17.048171 (Thread-233): handling poll request
2022-07-04 05:12:17.048574 (Thread-233): 05:12:17  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '08022227-1dd0-4d09-94f1-e256bf2507d1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb1601e69a0>]}
2022-07-04 05:12:17.049069 (Thread-233): sending response (<Response 402 bytes [200 OK]>) to 10.0.12.141
2022-07-04 05:12:18.414787 (Thread-234): handling poll request
2022-07-04 05:12:18.415216 (Thread-234): 05:12:18  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '08022227-1dd0-4d09-94f1-e256bf2507d1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb160128700>]}
2022-07-04 05:12:18.415725 (Thread-234): sending response (<Response 402 bytes [200 OK]>) to 10.0.12.141
2022-07-04 05:12:19.781869 (Thread-235): handling poll request
2022-07-04 05:12:19.782300 (Thread-235): 05:12:19  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '08022227-1dd0-4d09-94f1-e256bf2507d1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb1601285b0>]}
2022-07-04 05:12:19.782808 (Thread-235): sending response (<Response 403 bytes [200 OK]>) to 10.0.12.141
2022-07-04 05:12:21.181471 (Thread-236): handling poll request
2022-07-04 05:12:21.181893 (Thread-236): 05:12:21  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '08022227-1dd0-4d09-94f1-e256bf2507d1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb160128490>]}
2022-07-04 05:12:21.182446 (Thread-236): sending response (<Response 403 bytes [200 OK]>) to 10.0.12.141
2022-07-04 05:12:23.016964 (Thread-237): handling poll request
2022-07-04 05:12:23.017401 (Thread-237): 05:12:23  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '08022227-1dd0-4d09-94f1-e256bf2507d1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb1600dcc10>]}
2022-07-04 05:12:23.017894 (Thread-237): sending response (<Response 402 bytes [200 OK]>) to 10.0.12.141
2022-07-04 05:12:24.404275 (Thread-238): handling poll request
2022-07-04 05:12:24.404682 (Thread-238): 05:12:24  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '08022227-1dd0-4d09-94f1-e256bf2507d1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb1600dcbb0>]}
2022-07-04 05:12:24.405201 (Thread-238): sending response (<Response 402 bytes [200 OK]>) to 10.0.12.141
2022-07-04 05:12:25.770296 (Thread-239): handling poll request
2022-07-04 05:12:25.770722 (Thread-239): 05:12:25  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '08022227-1dd0-4d09-94f1-e256bf2507d1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb1600dcee0>]}
2022-07-04 05:12:25.771223 (Thread-239): sending response (<Response 403 bytes [200 OK]>) to 10.0.12.141
2022-07-04 05:12:27.136723 (Thread-240): handling poll request
2022-07-04 05:12:27.137153 (Thread-240): 05:12:27  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '08022227-1dd0-4d09-94f1-e256bf2507d1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb1600dc520>]}
2022-07-04 05:12:27.159189 (Thread-240): sending response (<Response 403 bytes [200 OK]>) to 10.0.12.141
2022-07-04 05:12:28.526807 (Thread-241): handling poll request
2022-07-04 05:12:28.527228 (Thread-241): 05:12:28  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '08022227-1dd0-4d09-94f1-e256bf2507d1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb1600dca90>]}
2022-07-04 05:12:28.527718 (Thread-241): sending response (<Response 402 bytes [200 OK]>) to 10.0.12.141
2022-07-04 05:12:28.782092 (Thread-242): handling kill request
2022-07-04 05:12:28.782522 (Thread-242): 05:12:28  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '08022227-1dd0-4d09-94f1-e256bf2507d1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb1600dc790>]}
2022-07-04 05:12:28.783102 (Thread-242): sending response (<Response 113 bytes [200 OK]>) to 10.0.12.141
2022-07-04 05:12:28.783299 (MainThread): 05:12:28  Snowflake adapter: Cancelling query 'rpc.ecommerce_data_model_dbt.request' (7179823858899942)
2022-07-04 05:12:28.783685 (MainThread): dbt runtime exception
Traceback (most recent call last):
  File "/usr/local/lib/python3.8/dist-packages/dbt_rpc/task/sql_commands.py", line 173, in handle_request
    thread_done.wait()
  File "/usr/lib/python3.8/threading.py", line 558, in wait
    signaled = self._cond.wait(timeout)
  File "/usr/lib/python3.8/threading.py", line 302, in wait
    waiter.acquire()
KeyboardInterrupt

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/usr/local/lib/python3.8/dist-packages/dbt_rpc/rpc/task_handler.py", line 102, in task_exec
    result = self.task.handle_request()
  File "/usr/local/lib/python3.8/dist-packages/dbt_rpc/task/sql_commands.py", line 178, in handle_request
    for conn_name in adapter.cancel_open_connections():
  File "/usr/local/lib/python3.8/dist-packages/dbt/adapters/base/impl.py", line 1059, in cancel_open_connections
    return self.connections.cancel_open()
  File "/usr/local/lib/python3.8/dist-packages/dbt/adapters/sql/connections.py", line 47, in cancel_open
    self.cancel(connection)
  File "/usr/local/lib/python3.8/dist-packages/dbt/adapters/snowflake/connections.py", line 343, in cancel
    _, cursor = self.add_query(sql)
  File "/usr/local/lib/python3.8/dist-packages/dbt/adapters/snowflake/connections.py", line 433, in add_query
    connection, cursor = super().add_query(
  File "/usr/local/lib/python3.8/dist-packages/dbt/adapters/sql/connections.py", line 59, in add_query
    connection = self.get_thread_connection()
  File "/usr/local/lib/python3.8/dist-packages/dbt/adapters/base/connections.py", line 69, in get_thread_connection
    raise dbt.exceptions.InvalidConnectionException(
dbt.exceptions.InvalidConnectionException: Runtime Error
  connection never acquired for thread (1248, 140262391715648), have [(1248, 140262203447040)]
2022-07-04 05:12:29.990314 (Thread-243): handling poll request
2022-07-04 05:12:29.990749 (Thread-243): 05:12:29  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '08022227-1dd0-4d09-94f1-e256bf2507d1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb1600dc490>]}
2022-07-04 05:12:29.991349 (Thread-243): sending response (<Response 2892 bytes [200 OK]>) to 10.0.12.141
2022-07-04 05:12:42.382673 (Thread-244): 05:12:42  Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
2022-07-04 05:12:42.383185 (Thread-244): 05:12:42  Partial parsing: updated file: ecommerce_data_model_dbt://models/data_model/temp_folder/email_domain.sql
2022-07-04 05:12:42.387572 (Thread-244): 05:12:42  1603: static parser failed on data_model/temp_folder/email_domain.sql
2022-07-04 05:12:42.391684 (Thread-244): 05:12:42  1602: parser fallback to jinja rendering on data_model/temp_folder/email_domain.sql
2022-07-04 05:12:42.433546 (Thread-244): 05:12:42  [WARNING]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.data-apps-ecommerce-template.data_model

2022-07-04 05:12:42.439028 (Thread-244): 05:12:42  Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '08022227-1dd0-4d09-94f1-e256bf2507d1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb11034df40>]}
2022-07-04 05:12:43.186957 (Thread-245): handling status request
2022-07-04 05:12:43.187376 (Thread-245): 05:12:43  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '08022227-1dd0-4d09-94f1-e256bf2507d1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb1600e87c0>]}
2022-07-04 05:12:43.187900 (Thread-245): sending response (<Response 2384 bytes [200 OK]>) to 10.0.12.141
2022-07-04 05:12:43.215232 (Thread-246): handling status request
2022-07-04 05:12:43.215588 (Thread-246): 05:12:43  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '08022227-1dd0-4d09-94f1-e256bf2507d1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb1602593d0>]}
2022-07-04 05:12:43.216056 (Thread-246): sending response (<Response 2384 bytes [200 OK]>) to 10.0.12.141
2022-07-04 05:12:45.465173 (Thread-247): handling status request
2022-07-04 05:12:45.465596 (Thread-247): 05:12:45  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '08022227-1dd0-4d09-94f1-e256bf2507d1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb1602ca4c0>]}
2022-07-04 05:12:45.466242 (Thread-247): sending response (<Response 2384 bytes [200 OK]>) to 10.0.12.141
2022-07-04 05:12:45.854091 (Thread-248): handling run_sql request
2022-07-04 05:12:45.854491 (Thread-248): 05:12:45  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '08022227-1dd0-4d09-94f1-e256bf2507d1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb1602ca5e0>]}
2022-07-04 05:12:48.176384 (Thread-248): sending response (<Response 139 bytes [200 OK]>) to 10.0.12.141
2022-07-04 05:12:48.201641 (MainThread): 05:12:48  Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '6c023eb4-189c-4fd1-8c32-8a66fff737f5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcb2ddd1e20>]}
2022-07-04 05:12:48.214358 (MainThread): 05:12:48  Found 11 models, 0 tests, 0 snapshots, 0 analyses, 179 macros, 0 operations, 0 seed files, 15 sources, 0 exposures, 0 metrics
2022-07-04 05:12:48.214973 (Thread-1): 05:12:48  Acquiring new snowflake connection "rpc.ecommerce_data_model_dbt.request"
2022-07-04 05:12:48.215115 (Thread-1): 05:12:48  Began compiling node rpc.ecommerce_data_model_dbt.request
2022-07-04 05:12:48.215217 (Thread-1): 05:12:48  Compiling rpc.ecommerce_data_model_dbt.request
2022-07-04 05:12:48.217708 (Thread-1): 05:12:48  finished collecting timing info
2022-07-04 05:12:48.217842 (Thread-1): 05:12:48  Began executing node rpc.ecommerce_data_model_dbt.request
2022-07-04 05:12:48.218701 (Thread-1): 05:12:48  Using snowflake connection "rpc.ecommerce_data_model_dbt.request"
2022-07-04 05:12:48.218798 (Thread-1): 05:12:48  On rpc.ecommerce_data_model_dbt.request: select user_id, gender from 
(select user_id, properties_gender as gender, row_number() over(partition by user_id order by timestamp desc) as rn from 
analytics_db.data_apps_simulated.identifies where timestamp >= '2021-05-01' and timestamp <= '2022-06-29'
and properties_gender is not null and properties_gender != '') where rn = 1
limit 500
/* limit added automatically by dbt cloud */
2022-07-04 05:12:48.218916 (Thread-1): 05:12:48  Opening a new connection, currently in state init
2022-07-04 05:12:48.555884 (Thread-249): handling poll request
2022-07-04 05:12:48.556364 (Thread-249): 05:12:48  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '08022227-1dd0-4d09-94f1-e256bf2507d1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb1602d9ee0>]}
2022-07-04 05:12:48.557298 (Thread-249): sending response (<Response 4130 bytes [200 OK]>) to 10.0.12.141
2022-07-04 05:12:48.921739 (Thread-1): 05:12:48  SQL status: SUCCESS 5 in 0.7 seconds
2022-07-04 05:12:48.923222 (Thread-1): 05:12:48  finished collecting timing info
2022-07-04 05:12:48.923407 (Thread-1): 05:12:48  On rpc.ecommerce_data_model_dbt.request: Close
2022-07-04 05:12:49.925676 (Thread-250): handling poll request
2022-07-04 05:12:49.926161 (Thread-250): 05:12:49  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '08022227-1dd0-4d09-94f1-e256bf2507d1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb160294190>]}
2022-07-04 05:12:49.927140 (Thread-250): sending response (<Response 4917 bytes [200 OK]>) to 10.0.12.141
2022-07-04 05:12:53.568342 (Thread-251): 05:12:53  Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
2022-07-04 05:12:53.568623 (Thread-251): 05:12:53  Partial parsing enabled, no changes found, skipping parsing
2022-07-04 05:12:53.569297 (Thread-251): 05:12:53  [WARNING]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.data-apps-ecommerce-template.data_model

2022-07-04 05:12:53.575774 (Thread-251): 05:12:53  Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '08022227-1dd0-4d09-94f1-e256bf2507d1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb110310b50>]}
2022-07-04 05:12:54.377097 (Thread-252): handling status request
2022-07-04 05:12:54.377508 (Thread-252): 05:12:54  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '08022227-1dd0-4d09-94f1-e256bf2507d1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb11034d3a0>]}
2022-07-04 05:12:54.378051 (Thread-252): sending response (<Response 1703 bytes [200 OK]>) to 10.0.12.141
2022-07-04 05:12:54.384212 (Thread-253): handling status request
2022-07-04 05:12:54.384525 (Thread-253): 05:12:54  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '08022227-1dd0-4d09-94f1-e256bf2507d1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb1600b3610>]}
2022-07-04 05:12:54.384972 (Thread-253): sending response (<Response 1703 bytes [200 OK]>) to 10.0.12.141
2022-07-04 05:12:56.343204 (Thread-254): handling status request
2022-07-04 05:12:56.343644 (Thread-254): 05:12:56  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '08022227-1dd0-4d09-94f1-e256bf2507d1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb16052b820>]}
2022-07-04 05:12:56.344142 (Thread-254): sending response (<Response 1703 bytes [200 OK]>) to 10.0.12.141
2022-07-04 05:12:56.754752 (Thread-255): handling run_sql request
2022-07-04 05:12:56.755172 (Thread-255): 05:12:56  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '08022227-1dd0-4d09-94f1-e256bf2507d1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb160115250>]}
2022-07-04 05:12:59.079776 (Thread-255): sending response (<Response 139 bytes [200 OK]>) to 10.0.12.141
2022-07-04 05:12:59.109514 (MainThread): 05:12:59  Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'efe30970-09c2-4d39-932a-c66350060b41', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6a9c2cfb20>]}
2022-07-04 05:12:59.110111 (MainThread): 05:12:59  Found 11 models, 0 tests, 0 snapshots, 0 analyses, 179 macros, 0 operations, 0 seed files, 15 sources, 0 exposures, 0 metrics
2022-07-04 05:12:59.110725 (Thread-1): 05:12:59  Acquiring new snowflake connection "rpc.ecommerce_data_model_dbt.request"
2022-07-04 05:12:59.110858 (Thread-1): 05:12:59  Began compiling node rpc.ecommerce_data_model_dbt.request
2022-07-04 05:12:59.110956 (Thread-1): 05:12:59  Compiling rpc.ecommerce_data_model_dbt.request
2022-07-04 05:12:59.116373 (Thread-1): 05:12:59  finished collecting timing info
2022-07-04 05:12:59.116511 (Thread-1): 05:12:59  Began executing node rpc.ecommerce_data_model_dbt.request
2022-07-04 05:12:59.119436 (Thread-1): 05:12:59  Using snowflake connection "rpc.ecommerce_data_model_dbt.request"
2022-07-04 05:12:59.119535 (Thread-1): 05:12:59  On rpc.ecommerce_data_model_dbt.request: with cte_gender as 
(select user_id, gender from 
(select user_id, properties_gender as gender, row_number() over(partition by user_id order by timestamp desc) as rn from 
analytics_db.data_apps_simulated.identifies where timestamp >= '2021-05-01' and timestamp <= '2022-06-29'
and properties_gender is not null and properties_gender != '') where rn = 1),

cte_age as 
(select user_id, age from
(select user_id, 
(CASE WHEN dateadd(year, datediff (year, properties_birthday, getdate()), properties_birthday) > getdate()
      THEN datediff(year, properties_birthday, getdate()) - 1
      ELSE datediff(year, properties_birthday, getdate())
 END) as age, row_number() over(partition by user_id order by timestamp desc) as rn 
from analytics_db.data_apps_simulated.identifies where timestamp >= '2021-05-01' and timestamp <= '2022-06-29'
and properties_birthday is not null and properties_birthday!='') where rn = 1),

cte_country as 
(select user_id, country from 
(select user_id, properties_country as country, row_number() over(partition by user_id order by timestamp desc) as rn from 
analytics_db.data_apps_simulated.identifies where timestamp >= '2021-05-01' and timestamp <= '2022-06-29'
and properties_country is not null and properties_country != '') where rn = 1),

cte_state as 
(select user_id, state from 
(select user_id, properties_state as state, row_number() over(partition by user_id order by timestamp desc) as rn from 
analytics_db.data_apps_simulated.identifies where timestamp >= '2021-05-01' and timestamp <= '2022-06-29'
and properties_state is not null and properties_state != '') where rn = 1),

cte_email_domain as 
(select user_id, email_domain from 
(select user_id, substring(properties_email, charindex( '@', properties_email) + 1, len(properties_email)) as email_domain, row_number() over(partition by user_id order by timestamp desc) as rn from 
analytics_db.data_apps_simulated.identifies where timestamp >= '2021-05-01' and timestamp <= '2022-06-29'
and properties_email is not null and properties_email != '') where rn = 1)

select coalesce(a.user_id, b.user_id, c.user_id, d.user_id,e.user_id) 
as user_id, gender, age, country, state, email_domain
from (((cte_gender a full outer join cte_age b on a.user_id = b.user_id) 
full outer join cte_country c on c.user_id = coalesce(a.user_id, b.user_id))
full outer join cte_state d on d.user_id = coalesce(a.user_id, b.user_id, c.user_id))
full outer join cte_email_domain e on e.user_id = coalesce(a.user_id, b.user_id, c.user_id,d.user_id, e.user_id)
limit 500
/* limit added automatically by dbt cloud */
2022-07-04 05:12:59.119618 (Thread-1): 05:12:59  Opening a new connection, currently in state init
2022-07-04 05:12:59.447504 (Thread-256): handling poll request
2022-07-04 05:12:59.447982 (Thread-256): 05:12:59  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '08022227-1dd0-4d09-94f1-e256bf2507d1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb160458dc0>]}
2022-07-04 05:12:59.448891 (Thread-256): sending response (<Response 6365 bytes [200 OK]>) to 10.0.12.141
2022-07-04 05:13:00.658703 (Thread-1): 05:13:00  SQL status: SUCCESS 5 in 1.54 seconds
2022-07-04 05:13:00.660257 (Thread-1): 05:13:00  finished collecting timing info
2022-07-04 05:13:00.660437 (Thread-1): 05:13:00  On rpc.ecommerce_data_model_dbt.request: Close
2022-07-04 05:13:00.816032 (Thread-257): handling poll request
2022-07-04 05:13:00.816453 (Thread-257): 05:13:00  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '08022227-1dd0-4d09-94f1-e256bf2507d1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb160072400>]}
2022-07-04 05:13:00.817005 (Thread-257): sending response (<Response 1387 bytes [200 OK]>) to 10.0.12.141
2022-07-04 05:13:02.197061 (Thread-258): handling poll request
2022-07-04 05:13:02.197465 (Thread-258): 05:13:02  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '08022227-1dd0-4d09-94f1-e256bf2507d1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb1600724f0>]}
2022-07-04 05:13:02.198472 (Thread-258): sending response (<Response 13610 bytes [200 OK]>) to 10.0.12.141
2022-07-04 05:15:01.280834 (Thread-259): handling status request
2022-07-04 05:15:01.282752 (Thread-259): 05:15:01  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '08022227-1dd0-4d09-94f1-e256bf2507d1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb1600729a0>]}
2022-07-04 05:15:01.283297 (Thread-259): sending response (<Response 1703 bytes [200 OK]>) to 10.0.12.141
2022-07-04 05:15:01.671743 (Thread-260): handling run_sql request
2022-07-04 05:15:01.672161 (Thread-260): 05:15:01  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '08022227-1dd0-4d09-94f1-e256bf2507d1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb1600721c0>]}
2022-07-04 05:15:04.065839 (Thread-260): sending response (<Response 139 bytes [200 OK]>) to 10.0.12.141
2022-07-04 05:15:04.096651 (MainThread): 05:15:04  Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '9d0dd458-b971-454c-beac-d9829cdf6feb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb33d9cfc10>]}
2022-07-04 05:15:04.097237 (MainThread): 05:15:04  Found 11 models, 0 tests, 0 snapshots, 0 analyses, 179 macros, 0 operations, 0 seed files, 15 sources, 0 exposures, 0 metrics
2022-07-04 05:15:04.097860 (Thread-1): 05:15:04  Acquiring new snowflake connection "rpc.ecommerce_data_model_dbt.request"
2022-07-04 05:15:04.098027 (Thread-1): 05:15:04  Began compiling node rpc.ecommerce_data_model_dbt.request
2022-07-04 05:15:04.098123 (Thread-1): 05:15:04  Compiling rpc.ecommerce_data_model_dbt.request
2022-07-04 05:15:04.103280 (Thread-1): 05:15:04  finished collecting timing info
2022-07-04 05:15:04.103432 (Thread-1): 05:15:04  Began executing node rpc.ecommerce_data_model_dbt.request
2022-07-04 05:15:04.106092 (Thread-1): 05:15:04  Using snowflake connection "rpc.ecommerce_data_model_dbt.request"
2022-07-04 05:15:04.106192 (Thread-1): 05:15:04  On rpc.ecommerce_data_model_dbt.request: with cte_gender as 
(select * from ANALYTICS_DB.dbt_ecommerce features.gender),

cte_age as 
(select user_id, age from
(select user_id, 
(CASE WHEN dateadd(year, datediff (year, properties_birthday, getdate()), properties_birthday) > getdate()
      THEN datediff(year, properties_birthday, getdate()) - 1
      ELSE datediff(year, properties_birthday, getdate())
 END) as age, row_number() over(partition by user_id order by timestamp desc) as rn 
from analytics_db.data_apps_simulated.identifies where timestamp >= '2021-05-01' and timestamp <= '2022-06-29'
and properties_birthday is not null and properties_birthday!='') where rn = 1),

cte_country as 
(select user_id, country from 
(select user_id, properties_country as country, row_number() over(partition by user_id order by timestamp desc) as rn from 
analytics_db.data_apps_simulated.identifies where timestamp >= '2021-05-01' and timestamp <= '2022-06-29'
and properties_country is not null and properties_country != '') where rn = 1),

cte_state as 
(select user_id, state from 
(select user_id, properties_state as state, row_number() over(partition by user_id order by timestamp desc) as rn from 
analytics_db.data_apps_simulated.identifies where timestamp >= '2021-05-01' and timestamp <= '2022-06-29'
and properties_state is not null and properties_state != '') where rn = 1),

cte_email_domain as 
(select user_id, email_domain from 
(select user_id, substring(properties_email, charindex( '@', properties_email) + 1, len(properties_email)) as email_domain, row_number() over(partition by user_id order by timestamp desc) as rn from 
analytics_db.data_apps_simulated.identifies where timestamp >= '2021-05-01' and timestamp <= '2022-06-29'
and properties_email is not null and properties_email != '') where rn = 1)

select coalesce(a.user_id, b.user_id, c.user_id, d.user_id,e.user_id) 
as user_id, gender, age, country, state, email_domain
from (((cte_gender a full outer join cte_age b on a.user_id = b.user_id) 
full outer join cte_country c on c.user_id = coalesce(a.user_id, b.user_id))
full outer join cte_state d on d.user_id = coalesce(a.user_id, b.user_id, c.user_id))
full outer join cte_email_domain e on e.user_id = coalesce(a.user_id, b.user_id, c.user_id,d.user_id, e.user_id)
limit 500
/* limit added automatically by dbt cloud */
2022-07-04 05:15:04.106277 (Thread-1): 05:15:04  Opening a new connection, currently in state init
2022-07-04 05:15:04.484155 (Thread-261): handling poll request
2022-07-04 05:15:04.484648 (Thread-261): 05:15:04  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '08022227-1dd0-4d09-94f1-e256bf2507d1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb160441970>]}
2022-07-04 05:15:04.485559 (Thread-261): sending response (<Response 6097 bytes [200 OK]>) to 10.0.12.141
2022-07-04 05:15:04.793172 (Thread-1): 05:15:04  Snowflake adapter: Snowflake query id: 01a55fdb-0602-327e-0019-82030465ccb2
2022-07-04 05:15:04.793362 (Thread-1): 05:15:04  Snowflake adapter: Snowflake error: 001003 (42000): SQL compilation error:
syntax error line 2 at position 50 unexpected '.'.
2022-07-04 05:15:04.793519 (Thread-1): 05:15:04  finished collecting timing info
2022-07-04 05:15:04.793676 (Thread-1): 05:15:04  On rpc.ecommerce_data_model_dbt.request: Close
2022-07-04 05:15:04.870807 (Thread-1): Got an exception: Database Error
  001003 (42000): SQL compilation error:
  syntax error line 2 at position 50 unexpected '.'.
Traceback (most recent call last):
  File "/usr/local/lib/python3.8/dist-packages/dbt/adapters/snowflake/connections.py", line 206, in exception_handler
    yield
  File "/usr/local/lib/python3.8/dist-packages/dbt/adapters/sql/connections.py", line 74, in add_query
    cursor.execute(sql, bindings)
  File "/usr/local/lib/python3.8/dist-packages/snowflake/connector/cursor.py", line 721, in execute
    Error.errorhandler_wrapper(
  File "/usr/local/lib/python3.8/dist-packages/snowflake/connector/errors.py", line 258, in errorhandler_wrapper
    cursor.errorhandler(connection, cursor, error_class, error_value)
  File "/usr/local/lib/python3.8/dist-packages/snowflake/connector/errors.py", line 188, in default_errorhandler
    raise error_class(
snowflake.connector.errors.ProgrammingError: 001003 (42000): SQL compilation error:
syntax error line 2 at position 50 unexpected '.'.

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/usr/local/lib/python3.8/dist-packages/dbt/task/base.py", line 361, in safe_run
    result = self.compile_and_execute(manifest, ctx)
  File "/usr/local/lib/python3.8/dist-packages/dbt/task/base.py", line 314, in compile_and_execute
    result = self.run(ctx.node, manifest)
  File "/usr/local/lib/python3.8/dist-packages/dbt/task/base.py", line 403, in run
    return self.execute(compiled_node, manifest)
  File "/usr/local/lib/python3.8/dist-packages/dbt_rpc/rpc/node_runners.py", line 90, in execute
    _, execute_result = self.adapter.execute(
  File "/usr/local/lib/python3.8/dist-packages/dbt/adapters/base/impl.py", line 225, in execute
    return self.connections.execute(
  File "/usr/local/lib/python3.8/dist-packages/dbt/adapters/sql/connections.py", line 127, in execute
    _, cursor = self.add_query(sql, auto_begin)
  File "/usr/local/lib/python3.8/dist-packages/dbt/adapters/snowflake/connections.py", line 433, in add_query
    connection, cursor = super().add_query(
  File "/usr/local/lib/python3.8/dist-packages/dbt/adapters/sql/connections.py", line 83, in add_query
    return connection, cursor
  File "/usr/lib/python3.8/contextlib.py", line 131, in __exit__
    self.gen.throw(type, value, traceback)
  File "/usr/local/lib/python3.8/dist-packages/dbt/adapters/snowflake/connections.py", line 223, in exception_handler
    raise DatabaseException(msg)
dbt.exceptions.DatabaseException: Database Error
  001003 (42000): SQL compilation error:
  syntax error line 2 at position 50 unexpected '.'.
2022-07-04 05:15:04.871798 (Thread-1): Got exception RPCException(10003, Database Error, {'type': 'DatabaseException', 'message': "Database Error in rpc request (from remote system)\n  001003 (42000): SQL compilation error:\n  syntax error line 2 at position 50 unexpected '.'.", 'raw_sql': "with cte_gender as \r\n(select * from {{ref('gender')}}),\r\n\r\ncte_age as \r\n(select user_id, age from\r\n(select user_id, \r\n(CASE WHEN dateadd(year, datediff (year, properties_birthday, getdate()), properties_birthday) > getdate()\r\n      THEN datediff(year, properties_birthday, getdate()) - 1\r\n      ELSE datediff(year, properties_birthday, getdate())\r\n END) as age, row_number() over(partition by user_id order by timestamp desc) as rn \r\nfrom {{ source('ecommerce', 'identifies') }} where timestamp >= '{{ var('start_date') }}' and timestamp <= '{{ var('end_date') }}'\r\nand properties_birthday is not null and properties_birthday!='') where rn = 1),\r\n\r\ncte_country as \r\n(select user_id, country from \r\n(select user_id, properties_country as country, row_number() over(partition by user_id order by timestamp desc) as rn from \r\n{{ source('ecommerce', 'identifies') }} where timestamp >= '{{ var('start_date') }}' and timestamp <= '{{ var('end_date') }}'\r\nand properties_country is not null and properties_country != '') where rn = 1),\r\n\r\ncte_state as \r\n(select user_id, state from \r\n(select user_id, properties_state as state, row_number() over(partition by user_id order by timestamp desc) as rn from \r\n{{ source('ecommerce', 'identifies') }} where timestamp >= '{{ var('start_date') }}' and timestamp <= '{{ var('end_date') }}'\r\nand properties_state is not null and properties_state != '') where rn = 1),\r\n\r\ncte_email_domain as \r\n(select user_id, email_domain from \r\n(select user_id, substring(properties_email, charindex( '@', properties_email) + 1, len(properties_email)) as email_domain, row_number() over(partition by user_id order by timestamp desc) as rn from \r\n{{ source('ecommerce', 'identifies') }} where timestamp >= '{{ var('start_date') }}' and timestamp <= '{{ var('end_date') }}'\r\nand properties_email is not null and properties_email != '') where rn = 1)\r\n\r\nselect coalesce(a.user_id, b.user_id, c.user_id, d.user_id,e.user_id) \r\nas user_id, gender, age, country, state, email_domain\r\nfrom (((cte_gender a full outer join cte_age b on a.user_id = b.user_id) \r\nfull outer join cte_country c on c.user_id = coalesce(a.user_id, b.user_id))\r\nfull outer join cte_state d on d.user_id = coalesce(a.user_id, b.user_id, c.user_id))\r\nfull outer join cte_email_domain e on e.user_id = coalesce(a.user_id, b.user_id, c.user_id,d.user_id, e.user_id)\nlimit 500\n/* limit added automatically by dbt cloud */", 'compiled_sql': "with cte_gender as \n(select * from ANALYTICS_DB.dbt_ecommerce features.gender),\n\ncte_age as \n(select user_id, age from\n(select user_id, \n(CASE WHEN dateadd(year, datediff (year, properties_birthday, getdate()), properties_birthday) > getdate()\n      THEN datediff(year, properties_birthday, getdate()) - 1\n      ELSE datediff(year, properties_birthday, getdate())\n END) as age, row_number() over(partition by user_id order by timestamp desc) as rn \nfrom analytics_db.data_apps_simulated.identifies where timestamp >= '2021-05-01' and timestamp <= '2022-06-29'\nand properties_birthday is not null and properties_birthday!='') where rn = 1),\n\ncte_country as \n(select user_id, country from \n(select user_id, properties_country as country, row_number() over(partition by user_id order by timestamp desc) as rn from \nanalytics_db.data_apps_simulated.identifies where timestamp >= '2021-05-01' and timestamp <= '2022-06-29'\nand properties_country is not null and properties_country != '') where rn = 1),\n\ncte_state as \n(select user_id, state from \n(select user_id, properties_state as state, row_number() over(partition by user_id order by timestamp desc) as rn from \nanalytics_db.data_apps_simulated.identifies where timestamp >= '2021-05-01' and timestamp <= '2022-06-29'\nand properties_state is not null and properties_state != '') where rn = 1),\n\ncte_email_domain as \n(select user_id, email_domain from \n(select user_id, substring(properties_email, charindex( '@', properties_email) + 1, len(properties_email)) as email_domain, row_number() over(partition by user_id order by timestamp desc) as rn from \nanalytics_db.data_apps_simulated.identifies where timestamp >= '2021-05-01' and timestamp <= '2022-06-29'\nand properties_email is not null and properties_email != '') where rn = 1)\n\nselect coalesce(a.user_id, b.user_id, c.user_id, d.user_id,e.user_id) \nas user_id, gender, age, country, state, email_domain\nfrom (((cte_gender a full outer join cte_age b on a.user_id = b.user_id) \nfull outer join cte_country c on c.user_id = coalesce(a.user_id, b.user_id))\nfull outer join cte_state d on d.user_id = coalesce(a.user_id, b.user_id, c.user_id))\nfull outer join cte_email_domain e on e.user_id = coalesce(a.user_id, b.user_id, c.user_id,d.user_id, e.user_id)\nlimit 500\n/* limit added automatically by dbt cloud */", 'tags': None}, None)
Traceback (most recent call last):
  File "/usr/local/lib/python3.8/dist-packages/dbt_rpc/task/sql_commands.py", line 147, in _in_thread
    self.node_results.append(runner.safe_run(self.manifest))
  File "/usr/local/lib/python3.8/dist-packages/dbt/task/base.py", line 377, in safe_run
    result = self.error_result(ctx.node, error, started, [])
  File "/usr/local/lib/python3.8/dist-packages/dbt_rpc/rpc/node_runners.py", line 56, in error_result
    raise error
dbt_rpc.rpc.error.RPCException: RPCException(10003, Database Error, {'type': 'DatabaseException', 'message': "Database Error in rpc request (from remote system)\n  001003 (42000): SQL compilation error:\n  syntax error line 2 at position 50 unexpected '.'.", 'raw_sql': "with cte_gender as \r\n(select * from {{ref('gender')}}),\r\n\r\ncte_age as \r\n(select user_id, age from\r\n(select user_id, \r\n(CASE WHEN dateadd(year, datediff (year, properties_birthday, getdate()), properties_birthday) > getdate()\r\n      THEN datediff(year, properties_birthday, getdate()) - 1\r\n      ELSE datediff(year, properties_birthday, getdate())\r\n END) as age, row_number() over(partition by user_id order by timestamp desc) as rn \r\nfrom {{ source('ecommerce', 'identifies') }} where timestamp >= '{{ var('start_date') }}' and timestamp <= '{{ var('end_date') }}'\r\nand properties_birthday is not null and properties_birthday!='') where rn = 1),\r\n\r\ncte_country as \r\n(select user_id, country from \r\n(select user_id, properties_country as country, row_number() over(partition by user_id order by timestamp desc) as rn from \r\n{{ source('ecommerce', 'identifies') }} where timestamp >= '{{ var('start_date') }}' and timestamp <= '{{ var('end_date') }}'\r\nand properties_country is not null and properties_country != '') where rn = 1),\r\n\r\ncte_state as \r\n(select user_id, state from \r\n(select user_id, properties_state as state, row_number() over(partition by user_id order by timestamp desc) as rn from \r\n{{ source('ecommerce', 'identifies') }} where timestamp >= '{{ var('start_date') }}' and timestamp <= '{{ var('end_date') }}'\r\nand properties_state is not null and properties_state != '') where rn = 1),\r\n\r\ncte_email_domain as \r\n(select user_id, email_domain from \r\n(select user_id, substring(properties_email, charindex( '@', properties_email) + 1, len(properties_email)) as email_domain, row_number() over(partition by user_id order by timestamp desc) as rn from \r\n{{ source('ecommerce', 'identifies') }} where timestamp >= '{{ var('start_date') }}' and timestamp <= '{{ var('end_date') }}'\r\nand properties_email is not null and properties_email != '') where rn = 1)\r\n\r\nselect coalesce(a.user_id, b.user_id, c.user_id, d.user_id,e.user_id) \r\nas user_id, gender, age, country, state, email_domain\r\nfrom (((cte_gender a full outer join cte_age b on a.user_id = b.user_id) \r\nfull outer join cte_country c on c.user_id = coalesce(a.user_id, b.user_id))\r\nfull outer join cte_state d on d.user_id = coalesce(a.user_id, b.user_id, c.user_id))\r\nfull outer join cte_email_domain e on e.user_id = coalesce(a.user_id, b.user_id, c.user_id,d.user_id, e.user_id)\nlimit 500\n/* limit added automatically by dbt cloud */", 'compiled_sql': "with cte_gender as \n(select * from ANALYTICS_DB.dbt_ecommerce features.gender),\n\ncte_age as \n(select user_id, age from\n(select user_id, \n(CASE WHEN dateadd(year, datediff (year, properties_birthday, getdate()), properties_birthday) > getdate()\n      THEN datediff(year, properties_birthday, getdate()) - 1\n      ELSE datediff(year, properties_birthday, getdate())\n END) as age, row_number() over(partition by user_id order by timestamp desc) as rn \nfrom analytics_db.data_apps_simulated.identifies where timestamp >= '2021-05-01' and timestamp <= '2022-06-29'\nand properties_birthday is not null and properties_birthday!='') where rn = 1),\n\ncte_country as \n(select user_id, country from \n(select user_id, properties_country as country, row_number() over(partition by user_id order by timestamp desc) as rn from \nanalytics_db.data_apps_simulated.identifies where timestamp >= '2021-05-01' and timestamp <= '2022-06-29'\nand properties_country is not null and properties_country != '') where rn = 1),\n\ncte_state as \n(select user_id, state from \n(select user_id, properties_state as state, row_number() over(partition by user_id order by timestamp desc) as rn from \nanalytics_db.data_apps_simulated.identifies where timestamp >= '2021-05-01' and timestamp <= '2022-06-29'\nand properties_state is not null and properties_state != '') where rn = 1),\n\ncte_email_domain as \n(select user_id, email_domain from \n(select user_id, substring(properties_email, charindex( '@', properties_email) + 1, len(properties_email)) as email_domain, row_number() over(partition by user_id order by timestamp desc) as rn from \nanalytics_db.data_apps_simulated.identifies where timestamp >= '2021-05-01' and timestamp <= '2022-06-29'\nand properties_email is not null and properties_email != '') where rn = 1)\n\nselect coalesce(a.user_id, b.user_id, c.user_id, d.user_id,e.user_id) \nas user_id, gender, age, country, state, email_domain\nfrom (((cte_gender a full outer join cte_age b on a.user_id = b.user_id) \nfull outer join cte_country c on c.user_id = coalesce(a.user_id, b.user_id))\nfull outer join cte_state d on d.user_id = coalesce(a.user_id, b.user_id, c.user_id))\nfull outer join cte_email_domain e on e.user_id = coalesce(a.user_id, b.user_id, c.user_id,d.user_id, e.user_id)\nlimit 500\n/* limit added automatically by dbt cloud */", 'tags': None}, None)
2022-07-04 05:15:05.874267 (Thread-262): handling poll request
2022-07-04 05:15:05.874688 (Thread-262): 05:15:05  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '08022227-1dd0-4d09-94f1-e256bf2507d1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb160441c70>]}
2022-07-04 05:15:05.875458 (Thread-262): sending response (<Response 26421 bytes [200 OK]>) to 10.0.12.141
2022-07-04 05:15:15.885388 (Thread-263): handling status request
2022-07-04 05:15:15.885792 (Thread-263): 05:15:15  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '08022227-1dd0-4d09-94f1-e256bf2507d1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb16044b130>]}
2022-07-04 05:15:15.886358 (Thread-263): sending response (<Response 1703 bytes [200 OK]>) to 10.0.12.141
2022-07-04 05:15:16.297351 (Thread-264): handling compile_sql request
2022-07-04 05:15:16.297785 (Thread-264): 05:15:16  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '08022227-1dd0-4d09-94f1-e256bf2507d1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb16044b310>]}
2022-07-04 05:15:18.645752 (Thread-264): sending response (<Response 139 bytes [200 OK]>) to 10.0.12.141
2022-07-04 05:15:18.674945 (MainThread): 05:15:18  Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '4ef443b6-4805-4033-b685-0318c14608d0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3f92fcfca0>]}
2022-07-04 05:15:18.675533 (MainThread): 05:15:18  Found 11 models, 0 tests, 0 snapshots, 0 analyses, 179 macros, 0 operations, 0 seed files, 15 sources, 0 exposures, 0 metrics
2022-07-04 05:15:18.676134 (Thread-1): 05:15:18  Acquiring new snowflake connection "rpc.ecommerce_data_model_dbt.request"
2022-07-04 05:15:18.676266 (Thread-1): 05:15:18  Began compiling node rpc.ecommerce_data_model_dbt.request
2022-07-04 05:15:18.676357 (Thread-1): 05:15:18  Compiling rpc.ecommerce_data_model_dbt.request
2022-07-04 05:15:18.681286 (Thread-1): 05:15:18  finished collecting timing info
2022-07-04 05:15:18.681417 (Thread-1): 05:15:18  Began executing node rpc.ecommerce_data_model_dbt.request
2022-07-04 05:15:18.681514 (Thread-1): 05:15:18  finished collecting timing info
2022-07-04 05:15:19.011538 (Thread-265): handling poll request
2022-07-04 05:15:19.012011 (Thread-265): 05:15:19  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '08022227-1dd0-4d09-94f1-e256bf2507d1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb16044b340>]}
2022-07-04 05:15:19.013265 (Thread-265): sending response (<Response 15019 bytes [200 OK]>) to 10.0.12.141
2022-07-04 05:16:36.310431 (Thread-266): 05:16:36  Partial parsing enabled: 1 files deleted, 1 files added, 0 files changed.
2022-07-04 05:16:36.312254 (Thread-266): 05:16:36  Partial parsing: added file: ecommerce_data_model_dbt://models/data_model/temp_folder/stg_gender.sql
2022-07-04 05:16:36.312414 (Thread-266): 05:16:36  Partial parsing: deleted file: ecommerce_data_model_dbt://models/data_model/temp_folder/gender.sql
2022-07-04 05:16:36.317489 (Thread-266): 05:16:36  1603: static parser failed on data_model/temp_folder/stg_gender.sql
2022-07-04 05:16:36.321581 (Thread-266): 05:16:36  1602: parser fallback to jinja rendering on data_model/temp_folder/stg_gender.sql
2022-07-04 05:16:36.356980 (Thread-266): 05:16:36  [WARNING]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.data-apps-ecommerce-template.data_model

2022-07-04 05:16:36.362578 (Thread-266): 05:16:36  Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '08022227-1dd0-4d09-94f1-e256bf2507d1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb1102f6e80>]}
2022-07-04 05:16:37.022016 (Thread-267): handling status request
2022-07-04 05:16:37.022418 (Thread-267): 05:16:37  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '08022227-1dd0-4d09-94f1-e256bf2507d1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb1102d47c0>]}
2022-07-04 05:16:37.022944 (Thread-267): sending response (<Response 2716 bytes [200 OK]>) to 10.0.12.141
2022-07-04 05:16:37.070843 (Thread-268): handling status request
2022-07-04 05:16:37.071298 (Thread-268): 05:16:37  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '08022227-1dd0-4d09-94f1-e256bf2507d1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb1102d43a0>]}
2022-07-04 05:16:37.071901 (Thread-268): sending response (<Response 2716 bytes [200 OK]>) to 10.0.12.141
2022-07-04 05:16:47.459154 (Thread-269): 05:16:47  Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
2022-07-04 05:16:47.459389 (Thread-269): 05:16:47  Partial parsing enabled, no changes found, skipping parsing
2022-07-04 05:16:47.459923 (Thread-269): 05:16:47  [WARNING]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.data-apps-ecommerce-template.data_model

2022-07-04 05:16:47.465247 (Thread-269): 05:16:47  Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '08022227-1dd0-4d09-94f1-e256bf2507d1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb1101fc8b0>]}
2022-07-04 05:16:48.256583 (Thread-270): handling status request
2022-07-04 05:16:48.256983 (Thread-270): 05:16:48  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '08022227-1dd0-4d09-94f1-e256bf2507d1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb1102d1700>]}
2022-07-04 05:16:48.279244 (Thread-270): sending response (<Response 1703 bytes [200 OK]>) to 10.0.12.141
2022-07-04 05:16:48.339406 (Thread-271): handling status request
2022-07-04 05:16:48.339769 (Thread-271): 05:16:48  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '08022227-1dd0-4d09-94f1-e256bf2507d1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb1102d1670>]}
2022-07-04 05:16:48.340228 (Thread-271): sending response (<Response 1703 bytes [200 OK]>) to 10.0.12.141
2022-07-04 05:16:50.078057 (Thread-272): 05:16:50  Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
2022-07-04 05:16:50.078535 (Thread-272): 05:16:50  Partial parsing: updated file: ecommerce_data_model_dbt://models/data_model/temp_folder/user_traits_test.sql
2022-07-04 05:16:50.082829 (Thread-272): 05:16:50  1603: static parser failed on data_model/temp_folder/user_traits_test.sql
2022-07-04 05:16:50.089092 (Thread-272): 05:16:50  1602: parser fallback to jinja rendering on data_model/temp_folder/user_traits_test.sql
2022-07-04 05:16:50.124934 (Thread-272): 05:16:50  [WARNING]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.data-apps-ecommerce-template.data_model

2022-07-04 05:16:50.130492 (Thread-272): 05:16:50  Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '08022227-1dd0-4d09-94f1-e256bf2507d1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb1101f7dc0>]}
2022-07-04 05:16:50.798411 (Thread-273): handling status request
2022-07-04 05:16:50.798826 (Thread-273): 05:16:50  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '08022227-1dd0-4d09-94f1-e256bf2507d1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb1102d82b0>]}
2022-07-04 05:16:50.799368 (Thread-273): sending response (<Response 2396 bytes [200 OK]>) to 10.0.12.141
2022-07-04 05:16:50.830032 (Thread-274): handling status request
2022-07-04 05:16:50.830426 (Thread-274): 05:16:50  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '08022227-1dd0-4d09-94f1-e256bf2507d1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb1102d8790>]}
2022-07-04 05:16:50.830921 (Thread-274): sending response (<Response 2396 bytes [200 OK]>) to 10.0.12.141
2022-07-04 05:16:51.936217 (Thread-275): handling status request
2022-07-04 05:16:51.936637 (Thread-275): 05:16:51  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '08022227-1dd0-4d09-94f1-e256bf2507d1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb1102d8e20>]}
2022-07-04 05:16:51.937144 (Thread-275): sending response (<Response 2396 bytes [200 OK]>) to 10.0.12.141
2022-07-04 05:16:52.321187 (Thread-276): handling run_sql request
2022-07-04 05:16:52.321588 (Thread-276): 05:16:52  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '08022227-1dd0-4d09-94f1-e256bf2507d1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb110310430>]}
2022-07-04 05:16:54.683121 (Thread-276): sending response (<Response 139 bytes [200 OK]>) to 10.0.12.141
2022-07-04 05:16:54.712065 (MainThread): 05:16:54  Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '7b65c7da-492d-4717-a28e-423af1690af8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f714407df40>]}
2022-07-04 05:16:54.712656 (MainThread): 05:16:54  Found 11 models, 0 tests, 0 snapshots, 0 analyses, 179 macros, 0 operations, 0 seed files, 15 sources, 0 exposures, 0 metrics
2022-07-04 05:16:54.713278 (Thread-1): 05:16:54  Acquiring new snowflake connection "rpc.ecommerce_data_model_dbt.request"
2022-07-04 05:16:54.713405 (Thread-1): 05:16:54  Began compiling node rpc.ecommerce_data_model_dbt.request
2022-07-04 05:16:54.713500 (Thread-1): 05:16:54  Compiling rpc.ecommerce_data_model_dbt.request
2022-07-04 05:16:54.718516 (Thread-1): 05:16:54  finished collecting timing info
2022-07-04 05:16:54.718651 (Thread-1): 05:16:54  Began executing node rpc.ecommerce_data_model_dbt.request
2022-07-04 05:16:54.721254 (Thread-1): 05:16:54  Using snowflake connection "rpc.ecommerce_data_model_dbt.request"
2022-07-04 05:16:54.721345 (Thread-1): 05:16:54  On rpc.ecommerce_data_model_dbt.request: with cte_gender as 
(select * from ANALYTICS_DB.dbt_ecommerce features.stg_gender),

cte_age as 
(select user_id, age from
(select user_id, 
(CASE WHEN dateadd(year, datediff (year, properties_birthday, getdate()), properties_birthday) > getdate()
      THEN datediff(year, properties_birthday, getdate()) - 1
      ELSE datediff(year, properties_birthday, getdate())
 END) as age, row_number() over(partition by user_id order by timestamp desc) as rn 
from analytics_db.data_apps_simulated.identifies where timestamp >= '2021-05-01' and timestamp <= '2022-06-29'
and properties_birthday is not null and properties_birthday!='') where rn = 1),

cte_country as 
(select user_id, country from 
(select user_id, properties_country as country, row_number() over(partition by user_id order by timestamp desc) as rn from 
analytics_db.data_apps_simulated.identifies where timestamp >= '2021-05-01' and timestamp <= '2022-06-29'
and properties_country is not null and properties_country != '') where rn = 1),

cte_state as 
(select user_id, state from 
(select user_id, properties_state as state, row_number() over(partition by user_id order by timestamp desc) as rn from 
analytics_db.data_apps_simulated.identifies where timestamp >= '2021-05-01' and timestamp <= '2022-06-29'
and properties_state is not null and properties_state != '') where rn = 1),

cte_email_domain as 
(select user_id, email_domain from 
(select user_id, substring(properties_email, charindex( '@', properties_email) + 1, len(properties_email)) as email_domain, row_number() over(partition by user_id order by timestamp desc) as rn from 
analytics_db.data_apps_simulated.identifies where timestamp >= '2021-05-01' and timestamp <= '2022-06-29'
and properties_email is not null and properties_email != '') where rn = 1)

select coalesce(a.user_id, b.user_id, c.user_id, d.user_id,e.user_id) 
as user_id, gender, age, country, state, email_domain
from (((cte_gender a full outer join cte_age b on a.user_id = b.user_id) 
full outer join cte_country c on c.user_id = coalesce(a.user_id, b.user_id))
full outer join cte_state d on d.user_id = coalesce(a.user_id, b.user_id, c.user_id))
full outer join cte_email_domain e on e.user_id = coalesce(a.user_id, b.user_id, c.user_id,d.user_id, e.user_id)
limit 500
/* limit added automatically by dbt cloud */
2022-07-04 05:16:54.721424 (Thread-1): 05:16:54  Opening a new connection, currently in state init
2022-07-04 05:16:55.086705 (Thread-277): handling poll request
2022-07-04 05:16:55.087227 (Thread-277): 05:16:55  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '08022227-1dd0-4d09-94f1-e256bf2507d1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb1104079a0>]}
2022-07-04 05:16:55.088168 (Thread-277): sending response (<Response 6103 bytes [200 OK]>) to 10.0.12.141
2022-07-04 05:16:55.474509 (Thread-1): 05:16:55  Snowflake adapter: Snowflake query id: 01a55fdc-0602-3238-0019-82030465e0c2
2022-07-04 05:16:55.474709 (Thread-1): 05:16:55  Snowflake adapter: Snowflake error: 001003 (42000): SQL compilation error:
syntax error line 2 at position 50 unexpected '.'.
2022-07-04 05:16:55.474872 (Thread-1): 05:16:55  finished collecting timing info
2022-07-04 05:16:55.475050 (Thread-1): 05:16:55  On rpc.ecommerce_data_model_dbt.request: Close
2022-07-04 05:16:55.557296 (Thread-1): Got an exception: Database Error
  001003 (42000): SQL compilation error:
  syntax error line 2 at position 50 unexpected '.'.
Traceback (most recent call last):
  File "/usr/local/lib/python3.8/dist-packages/dbt/adapters/snowflake/connections.py", line 206, in exception_handler
    yield
  File "/usr/local/lib/python3.8/dist-packages/dbt/adapters/sql/connections.py", line 74, in add_query
    cursor.execute(sql, bindings)
  File "/usr/local/lib/python3.8/dist-packages/snowflake/connector/cursor.py", line 721, in execute
    Error.errorhandler_wrapper(
  File "/usr/local/lib/python3.8/dist-packages/snowflake/connector/errors.py", line 258, in errorhandler_wrapper
    cursor.errorhandler(connection, cursor, error_class, error_value)
  File "/usr/local/lib/python3.8/dist-packages/snowflake/connector/errors.py", line 188, in default_errorhandler
    raise error_class(
snowflake.connector.errors.ProgrammingError: 001003 (42000): SQL compilation error:
syntax error line 2 at position 50 unexpected '.'.

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/usr/local/lib/python3.8/dist-packages/dbt/task/base.py", line 361, in safe_run
    result = self.compile_and_execute(manifest, ctx)
  File "/usr/local/lib/python3.8/dist-packages/dbt/task/base.py", line 314, in compile_and_execute
    result = self.run(ctx.node, manifest)
  File "/usr/local/lib/python3.8/dist-packages/dbt/task/base.py", line 403, in run
    return self.execute(compiled_node, manifest)
  File "/usr/local/lib/python3.8/dist-packages/dbt_rpc/rpc/node_runners.py", line 90, in execute
    _, execute_result = self.adapter.execute(
  File "/usr/local/lib/python3.8/dist-packages/dbt/adapters/base/impl.py", line 225, in execute
    return self.connections.execute(
  File "/usr/local/lib/python3.8/dist-packages/dbt/adapters/sql/connections.py", line 127, in execute
    _, cursor = self.add_query(sql, auto_begin)
  File "/usr/local/lib/python3.8/dist-packages/dbt/adapters/snowflake/connections.py", line 433, in add_query
    connection, cursor = super().add_query(
  File "/usr/local/lib/python3.8/dist-packages/dbt/adapters/sql/connections.py", line 83, in add_query
    return connection, cursor
  File "/usr/lib/python3.8/contextlib.py", line 131, in __exit__
    self.gen.throw(type, value, traceback)
  File "/usr/local/lib/python3.8/dist-packages/dbt/adapters/snowflake/connections.py", line 223, in exception_handler
    raise DatabaseException(msg)
dbt.exceptions.DatabaseException: Database Error
  001003 (42000): SQL compilation error:
  syntax error line 2 at position 50 unexpected '.'.
2022-07-04 05:16:55.558279 (Thread-1): Got exception RPCException(10003, Database Error, {'type': 'DatabaseException', 'message': "Database Error in rpc request (from remote system)\n  001003 (42000): SQL compilation error:\n  syntax error line 2 at position 50 unexpected '.'.", 'raw_sql': "with cte_gender as \r\n(select * from {{ref('stg_gender')}}),\r\n\r\ncte_age as \r\n(select user_id, age from\r\n(select user_id, \r\n(CASE WHEN dateadd(year, datediff (year, properties_birthday, getdate()), properties_birthday) > getdate()\r\n      THEN datediff(year, properties_birthday, getdate()) - 1\r\n      ELSE datediff(year, properties_birthday, getdate())\r\n END) as age, row_number() over(partition by user_id order by timestamp desc) as rn \r\nfrom {{ source('ecommerce', 'identifies') }} where timestamp >= '{{ var('start_date') }}' and timestamp <= '{{ var('end_date') }}'\r\nand properties_birthday is not null and properties_birthday!='') where rn = 1),\r\n\r\ncte_country as \r\n(select user_id, country from \r\n(select user_id, properties_country as country, row_number() over(partition by user_id order by timestamp desc) as rn from \r\n{{ source('ecommerce', 'identifies') }} where timestamp >= '{{ var('start_date') }}' and timestamp <= '{{ var('end_date') }}'\r\nand properties_country is not null and properties_country != '') where rn = 1),\r\n\r\ncte_state as \r\n(select user_id, state from \r\n(select user_id, properties_state as state, row_number() over(partition by user_id order by timestamp desc) as rn from \r\n{{ source('ecommerce', 'identifies') }} where timestamp >= '{{ var('start_date') }}' and timestamp <= '{{ var('end_date') }}'\r\nand properties_state is not null and properties_state != '') where rn = 1),\r\n\r\ncte_email_domain as \r\n(select user_id, email_domain from \r\n(select user_id, substring(properties_email, charindex( '@', properties_email) + 1, len(properties_email)) as email_domain, row_number() over(partition by user_id order by timestamp desc) as rn from \r\n{{ source('ecommerce', 'identifies') }} where timestamp >= '{{ var('start_date') }}' and timestamp <= '{{ var('end_date') }}'\r\nand properties_email is not null and properties_email != '') where rn = 1)\r\n\r\nselect coalesce(a.user_id, b.user_id, c.user_id, d.user_id,e.user_id) \r\nas user_id, gender, age, country, state, email_domain\r\nfrom (((cte_gender a full outer join cte_age b on a.user_id = b.user_id) \r\nfull outer join cte_country c on c.user_id = coalesce(a.user_id, b.user_id))\r\nfull outer join cte_state d on d.user_id = coalesce(a.user_id, b.user_id, c.user_id))\r\nfull outer join cte_email_domain e on e.user_id = coalesce(a.user_id, b.user_id, c.user_id,d.user_id, e.user_id)\nlimit 500\n/* limit added automatically by dbt cloud */", 'compiled_sql': "with cte_gender as \n(select * from ANALYTICS_DB.dbt_ecommerce features.stg_gender),\n\ncte_age as \n(select user_id, age from\n(select user_id, \n(CASE WHEN dateadd(year, datediff (year, properties_birthday, getdate()), properties_birthday) > getdate()\n      THEN datediff(year, properties_birthday, getdate()) - 1\n      ELSE datediff(year, properties_birthday, getdate())\n END) as age, row_number() over(partition by user_id order by timestamp desc) as rn \nfrom analytics_db.data_apps_simulated.identifies where timestamp >= '2021-05-01' and timestamp <= '2022-06-29'\nand properties_birthday is not null and properties_birthday!='') where rn = 1),\n\ncte_country as \n(select user_id, country from \n(select user_id, properties_country as country, row_number() over(partition by user_id order by timestamp desc) as rn from \nanalytics_db.data_apps_simulated.identifies where timestamp >= '2021-05-01' and timestamp <= '2022-06-29'\nand properties_country is not null and properties_country != '') where rn = 1),\n\ncte_state as \n(select user_id, state from \n(select user_id, properties_state as state, row_number() over(partition by user_id order by timestamp desc) as rn from \nanalytics_db.data_apps_simulated.identifies where timestamp >= '2021-05-01' and timestamp <= '2022-06-29'\nand properties_state is not null and properties_state != '') where rn = 1),\n\ncte_email_domain as \n(select user_id, email_domain from \n(select user_id, substring(properties_email, charindex( '@', properties_email) + 1, len(properties_email)) as email_domain, row_number() over(partition by user_id order by timestamp desc) as rn from \nanalytics_db.data_apps_simulated.identifies where timestamp >= '2021-05-01' and timestamp <= '2022-06-29'\nand properties_email is not null and properties_email != '') where rn = 1)\n\nselect coalesce(a.user_id, b.user_id, c.user_id, d.user_id,e.user_id) \nas user_id, gender, age, country, state, email_domain\nfrom (((cte_gender a full outer join cte_age b on a.user_id = b.user_id) \nfull outer join cte_country c on c.user_id = coalesce(a.user_id, b.user_id))\nfull outer join cte_state d on d.user_id = coalesce(a.user_id, b.user_id, c.user_id))\nfull outer join cte_email_domain e on e.user_id = coalesce(a.user_id, b.user_id, c.user_id,d.user_id, e.user_id)\nlimit 500\n/* limit added automatically by dbt cloud */", 'tags': None}, None)
Traceback (most recent call last):
  File "/usr/local/lib/python3.8/dist-packages/dbt_rpc/task/sql_commands.py", line 147, in _in_thread
    self.node_results.append(runner.safe_run(self.manifest))
  File "/usr/local/lib/python3.8/dist-packages/dbt/task/base.py", line 377, in safe_run
    result = self.error_result(ctx.node, error, started, [])
  File "/usr/local/lib/python3.8/dist-packages/dbt_rpc/rpc/node_runners.py", line 56, in error_result
    raise error
dbt_rpc.rpc.error.RPCException: RPCException(10003, Database Error, {'type': 'DatabaseException', 'message': "Database Error in rpc request (from remote system)\n  001003 (42000): SQL compilation error:\n  syntax error line 2 at position 50 unexpected '.'.", 'raw_sql': "with cte_gender as \r\n(select * from {{ref('stg_gender')}}),\r\n\r\ncte_age as \r\n(select user_id, age from\r\n(select user_id, \r\n(CASE WHEN dateadd(year, datediff (year, properties_birthday, getdate()), properties_birthday) > getdate()\r\n      THEN datediff(year, properties_birthday, getdate()) - 1\r\n      ELSE datediff(year, properties_birthday, getdate())\r\n END) as age, row_number() over(partition by user_id order by timestamp desc) as rn \r\nfrom {{ source('ecommerce', 'identifies') }} where timestamp >= '{{ var('start_date') }}' and timestamp <= '{{ var('end_date') }}'\r\nand properties_birthday is not null and properties_birthday!='') where rn = 1),\r\n\r\ncte_country as \r\n(select user_id, country from \r\n(select user_id, properties_country as country, row_number() over(partition by user_id order by timestamp desc) as rn from \r\n{{ source('ecommerce', 'identifies') }} where timestamp >= '{{ var('start_date') }}' and timestamp <= '{{ var('end_date') }}'\r\nand properties_country is not null and properties_country != '') where rn = 1),\r\n\r\ncte_state as \r\n(select user_id, state from \r\n(select user_id, properties_state as state, row_number() over(partition by user_id order by timestamp desc) as rn from \r\n{{ source('ecommerce', 'identifies') }} where timestamp >= '{{ var('start_date') }}' and timestamp <= '{{ var('end_date') }}'\r\nand properties_state is not null and properties_state != '') where rn = 1),\r\n\r\ncte_email_domain as \r\n(select user_id, email_domain from \r\n(select user_id, substring(properties_email, charindex( '@', properties_email) + 1, len(properties_email)) as email_domain, row_number() over(partition by user_id order by timestamp desc) as rn from \r\n{{ source('ecommerce', 'identifies') }} where timestamp >= '{{ var('start_date') }}' and timestamp <= '{{ var('end_date') }}'\r\nand properties_email is not null and properties_email != '') where rn = 1)\r\n\r\nselect coalesce(a.user_id, b.user_id, c.user_id, d.user_id,e.user_id) \r\nas user_id, gender, age, country, state, email_domain\r\nfrom (((cte_gender a full outer join cte_age b on a.user_id = b.user_id) \r\nfull outer join cte_country c on c.user_id = coalesce(a.user_id, b.user_id))\r\nfull outer join cte_state d on d.user_id = coalesce(a.user_id, b.user_id, c.user_id))\r\nfull outer join cte_email_domain e on e.user_id = coalesce(a.user_id, b.user_id, c.user_id,d.user_id, e.user_id)\nlimit 500\n/* limit added automatically by dbt cloud */", 'compiled_sql': "with cte_gender as \n(select * from ANALYTICS_DB.dbt_ecommerce features.stg_gender),\n\ncte_age as \n(select user_id, age from\n(select user_id, \n(CASE WHEN dateadd(year, datediff (year, properties_birthday, getdate()), properties_birthday) > getdate()\n      THEN datediff(year, properties_birthday, getdate()) - 1\n      ELSE datediff(year, properties_birthday, getdate())\n END) as age, row_number() over(partition by user_id order by timestamp desc) as rn \nfrom analytics_db.data_apps_simulated.identifies where timestamp >= '2021-05-01' and timestamp <= '2022-06-29'\nand properties_birthday is not null and properties_birthday!='') where rn = 1),\n\ncte_country as \n(select user_id, country from \n(select user_id, properties_country as country, row_number() over(partition by user_id order by timestamp desc) as rn from \nanalytics_db.data_apps_simulated.identifies where timestamp >= '2021-05-01' and timestamp <= '2022-06-29'\nand properties_country is not null and properties_country != '') where rn = 1),\n\ncte_state as \n(select user_id, state from \n(select user_id, properties_state as state, row_number() over(partition by user_id order by timestamp desc) as rn from \nanalytics_db.data_apps_simulated.identifies where timestamp >= '2021-05-01' and timestamp <= '2022-06-29'\nand properties_state is not null and properties_state != '') where rn = 1),\n\ncte_email_domain as \n(select user_id, email_domain from \n(select user_id, substring(properties_email, charindex( '@', properties_email) + 1, len(properties_email)) as email_domain, row_number() over(partition by user_id order by timestamp desc) as rn from \nanalytics_db.data_apps_simulated.identifies where timestamp >= '2021-05-01' and timestamp <= '2022-06-29'\nand properties_email is not null and properties_email != '') where rn = 1)\n\nselect coalesce(a.user_id, b.user_id, c.user_id, d.user_id,e.user_id) \nas user_id, gender, age, country, state, email_domain\nfrom (((cte_gender a full outer join cte_age b on a.user_id = b.user_id) \nfull outer join cte_country c on c.user_id = coalesce(a.user_id, b.user_id))\nfull outer join cte_state d on d.user_id = coalesce(a.user_id, b.user_id, c.user_id))\nfull outer join cte_email_domain e on e.user_id = coalesce(a.user_id, b.user_id, c.user_id,d.user_id, e.user_id)\nlimit 500\n/* limit added automatically by dbt cloud */", 'tags': None}, None)
2022-07-04 05:16:56.455491 (Thread-278): handling poll request
2022-07-04 05:16:56.455889 (Thread-278): 05:16:56  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '08022227-1dd0-4d09-94f1-e256bf2507d1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb110407d30>]}
2022-07-04 05:16:56.456587 (Thread-278): sending response (<Response 26449 bytes [200 OK]>) to 10.0.12.141
2022-07-04 05:17:00.227066 (Thread-279): handling status request
2022-07-04 05:17:00.227483 (Thread-279): 05:17:00  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '08022227-1dd0-4d09-94f1-e256bf2507d1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb1103b5640>]}
2022-07-04 05:17:00.228034 (Thread-279): sending response (<Response 2396 bytes [200 OK]>) to 10.0.12.141
2022-07-04 05:17:00.593369 (Thread-280): handling compile_sql request
2022-07-04 05:17:00.593798 (Thread-280): 05:17:00  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '08022227-1dd0-4d09-94f1-e256bf2507d1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb1103b5a30>]}
2022-07-04 05:17:02.959010 (Thread-280): sending response (<Response 139 bytes [200 OK]>) to 10.0.12.141
2022-07-04 05:17:02.988329 (MainThread): 05:17:02  Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '2e9c5459-bbd2-4ffa-b5bf-96cfed19b3e9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd22ebd1f40>]}
2022-07-04 05:17:02.988928 (MainThread): 05:17:02  Found 11 models, 0 tests, 0 snapshots, 0 analyses, 179 macros, 0 operations, 0 seed files, 15 sources, 0 exposures, 0 metrics
2022-07-04 05:17:02.989567 (Thread-1): 05:17:02  Acquiring new snowflake connection "rpc.ecommerce_data_model_dbt.request"
2022-07-04 05:17:02.989701 (Thread-1): 05:17:02  Began compiling node rpc.ecommerce_data_model_dbt.request
2022-07-04 05:17:02.989797 (Thread-1): 05:17:02  Compiling rpc.ecommerce_data_model_dbt.request
2022-07-04 05:17:02.995080 (Thread-1): 05:17:02  finished collecting timing info
2022-07-04 05:17:02.995226 (Thread-1): 05:17:02  Began executing node rpc.ecommerce_data_model_dbt.request
2022-07-04 05:17:02.995328 (Thread-1): 05:17:02  finished collecting timing info
2022-07-04 05:17:03.329092 (Thread-281): handling poll request
2022-07-04 05:17:03.329574 (Thread-281): 05:17:03  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '08022227-1dd0-4d09-94f1-e256bf2507d1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb11032b460>]}
2022-07-04 05:17:03.330886 (Thread-281): sending response (<Response 15043 bytes [200 OK]>) to 10.0.12.141
2022-07-04 05:17:34.283548 (Thread-282): handling status request
2022-07-04 05:17:34.284375 (Thread-283): handling status request
2022-07-04 05:17:34.284789 (Thread-282): 05:17:34  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '08022227-1dd0-4d09-94f1-e256bf2507d1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb11032bf40>]}
2022-07-04 05:17:34.285112 (Thread-283): 05:17:34  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '08022227-1dd0-4d09-94f1-e256bf2507d1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb11032be50>]}
2022-07-04 05:17:34.285681 (Thread-282): sending response (<Response 2373 bytes [200 OK]>) to 10.0.12.141
2022-07-04 05:17:34.286236 (Thread-283): sending response (<Response 2373 bytes [200 OK]>) to 10.0.12.141
2022-07-04 05:17:34.310110 (Thread-284): handling list request
2022-07-04 05:17:34.310433 (Thread-284): 05:17:34  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '08022227-1dd0-4d09-94f1-e256bf2507d1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb11032bc70>]}
2022-07-04 05:17:34.350404 (Thread-285): sending response (<Response 214 bytes [200 OK]>) to 10.0.12.141
2022-07-04 05:17:35.716898 (Thread-286): handling status request
2022-07-04 05:17:35.717299 (Thread-286): 05:17:35  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '08022227-1dd0-4d09-94f1-e256bf2507d1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb11032b1f0>]}
2022-07-04 05:17:35.717806 (Thread-286): sending response (<Response 2373 bytes [200 OK]>) to 10.0.12.141
2022-07-04 05:17:35.768832 (Thread-287): handling list request
2022-07-04 05:17:35.769190 (Thread-287): 05:17:35  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '08022227-1dd0-4d09-94f1-e256bf2507d1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb11032bdc0>]}
2022-07-04 05:17:35.798757 (Thread-287): 05:17:35  Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '08022227-1dd0-4d09-94f1-e256bf2507d1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb1602fbfa0>]}
2022-07-04 05:17:35.799058 (Thread-287): 05:17:35  Found 11 models, 0 tests, 0 snapshots, 0 analyses, 179 macros, 0 operations, 0 seed files, 15 sources, 0 exposures, 0 metrics
2022-07-04 05:17:35.801632 (Thread-287): sending response (<Response 2916 bytes [200 OK]>) to 10.0.12.141
2022-07-04 05:19:16.616495 (Thread-288): handling status request
2022-07-04 05:19:16.618377 (Thread-288): 05:19:16  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '08022227-1dd0-4d09-94f1-e256bf2507d1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb1101eb040>]}
2022-07-04 05:19:16.618907 (Thread-288): sending response (<Response 2396 bytes [200 OK]>) to 10.0.12.141
2022-07-04 05:19:17.029040 (Thread-289): handling run_sql request
2022-07-04 05:19:17.029451 (Thread-289): 05:19:17  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '08022227-1dd0-4d09-94f1-e256bf2507d1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb1101eb3a0>]}
2022-07-04 05:19:19.357202 (Thread-289): sending response (<Response 139 bytes [200 OK]>) to 10.0.12.141
2022-07-04 05:19:19.386189 (MainThread): 05:19:19  Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '83cf35f2-0b5b-4baa-8ae1-238d4ec1e877', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1c0f751ee0>]}
2022-07-04 05:19:19.386723 (MainThread): 05:19:19  Found 11 models, 0 tests, 0 snapshots, 0 analyses, 179 macros, 0 operations, 0 seed files, 15 sources, 0 exposures, 0 metrics
2022-07-04 05:19:19.387309 (Thread-1): 05:19:19  Acquiring new snowflake connection "rpc.ecommerce_data_model_dbt.request"
2022-07-04 05:19:19.387440 (Thread-1): 05:19:19  Began compiling node rpc.ecommerce_data_model_dbt.request
2022-07-04 05:19:19.387543 (Thread-1): 05:19:19  Compiling rpc.ecommerce_data_model_dbt.request
2022-07-04 05:19:19.392399 (Thread-1): 05:19:19  finished collecting timing info
2022-07-04 05:19:19.392545 (Thread-1): 05:19:19  Began executing node rpc.ecommerce_data_model_dbt.request
2022-07-04 05:19:19.395361 (Thread-1): 05:19:19  Using snowflake connection "rpc.ecommerce_data_model_dbt.request"
2022-07-04 05:19:19.395471 (Thread-1): 05:19:19  On rpc.ecommerce_data_model_dbt.request: with cte_gender as 
(select * from ANALYTICS_DB.data-apps-ecommerce-template.cte_gender),

cte_age as 
(select user_id, age from
(select user_id, 
(CASE WHEN dateadd(year, datediff (year, properties_birthday, getdate()), properties_birthday) > getdate()
      THEN datediff(year, properties_birthday, getdate()) - 1
      ELSE datediff(year, properties_birthday, getdate())
 END) as age, row_number() over(partition by user_id order by timestamp desc) as rn 
from analytics_db.data_apps_simulated.identifies where timestamp >= '2021-05-01' and timestamp <= '2022-06-29'
and properties_birthday is not null and properties_birthday!='') where rn = 1),

cte_country as 
(select user_id, country from 
(select user_id, properties_country as country, row_number() over(partition by user_id order by timestamp desc) as rn from 
analytics_db.data_apps_simulated.identifies where timestamp >= '2021-05-01' and timestamp <= '2022-06-29'
and properties_country is not null and properties_country != '') where rn = 1),

cte_state as 
(select user_id, state from 
(select user_id, properties_state as state, row_number() over(partition by user_id order by timestamp desc) as rn from 
analytics_db.data_apps_simulated.identifies where timestamp >= '2021-05-01' and timestamp <= '2022-06-29'
and properties_state is not null and properties_state != '') where rn = 1),

cte_email_domain as 
(select user_id, email_domain from 
(select user_id, substring(properties_email, charindex( '@', properties_email) + 1, len(properties_email)) as email_domain, row_number() over(partition by user_id order by timestamp desc) as rn from 
analytics_db.data_apps_simulated.identifies where timestamp >= '2021-05-01' and timestamp <= '2022-06-29'
and properties_email is not null and properties_email != '') where rn = 1)

select coalesce(a.user_id, b.user_id, c.user_id, d.user_id,e.user_id) 
as user_id, gender, age, country, state, email_domain
from (((cte_gender a full outer join cte_age b on a.user_id = b.user_id) 
full outer join cte_country c on c.user_id = coalesce(a.user_id, b.user_id))
full outer join cte_state d on d.user_id = coalesce(a.user_id, b.user_id, c.user_id))
full outer join cte_email_domain e on e.user_id = coalesce(a.user_id, b.user_id, c.user_id,d.user_id, e.user_id)
limit 500
/* limit added automatically by dbt cloud */
2022-07-04 05:19:19.395560 (Thread-1): 05:19:19  Opening a new connection, currently in state init
2022-07-04 05:19:19.753014 (Thread-290): handling poll request
2022-07-04 05:19:19.753489 (Thread-290): 05:19:19  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '08022227-1dd0-4d09-94f1-e256bf2507d1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb1101e1e20>]}
2022-07-04 05:19:19.754438 (Thread-290): sending response (<Response 6109 bytes [200 OK]>) to 10.0.12.141
2022-07-04 05:19:20.150401 (Thread-1): 05:19:20  Snowflake adapter: Snowflake query id: 01a55fdf-0602-3238-0019-82030465e0c6
2022-07-04 05:19:20.150590 (Thread-1): 05:19:20  Snowflake adapter: Snowflake error: 001003 (42000): SQL compilation error:
syntax error line 2 at position 32 unexpected '-'.
2022-07-04 05:19:20.150763 (Thread-1): 05:19:20  finished collecting timing info
2022-07-04 05:19:20.150930 (Thread-1): 05:19:20  On rpc.ecommerce_data_model_dbt.request: Close
2022-07-04 05:19:20.224205 (Thread-1): Got an exception: Database Error
  001003 (42000): SQL compilation error:
  syntax error line 2 at position 32 unexpected '-'.
Traceback (most recent call last):
  File "/usr/local/lib/python3.8/dist-packages/dbt/adapters/snowflake/connections.py", line 206, in exception_handler
    yield
  File "/usr/local/lib/python3.8/dist-packages/dbt/adapters/sql/connections.py", line 74, in add_query
    cursor.execute(sql, bindings)
  File "/usr/local/lib/python3.8/dist-packages/snowflake/connector/cursor.py", line 721, in execute
    Error.errorhandler_wrapper(
  File "/usr/local/lib/python3.8/dist-packages/snowflake/connector/errors.py", line 258, in errorhandler_wrapper
    cursor.errorhandler(connection, cursor, error_class, error_value)
  File "/usr/local/lib/python3.8/dist-packages/snowflake/connector/errors.py", line 188, in default_errorhandler
    raise error_class(
snowflake.connector.errors.ProgrammingError: 001003 (42000): SQL compilation error:
syntax error line 2 at position 32 unexpected '-'.

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/usr/local/lib/python3.8/dist-packages/dbt/task/base.py", line 361, in safe_run
    result = self.compile_and_execute(manifest, ctx)
  File "/usr/local/lib/python3.8/dist-packages/dbt/task/base.py", line 314, in compile_and_execute
    result = self.run(ctx.node, manifest)
  File "/usr/local/lib/python3.8/dist-packages/dbt/task/base.py", line 403, in run
    return self.execute(compiled_node, manifest)
  File "/usr/local/lib/python3.8/dist-packages/dbt_rpc/rpc/node_runners.py", line 90, in execute
    _, execute_result = self.adapter.execute(
  File "/usr/local/lib/python3.8/dist-packages/dbt/adapters/base/impl.py", line 225, in execute
    return self.connections.execute(
  File "/usr/local/lib/python3.8/dist-packages/dbt/adapters/sql/connections.py", line 127, in execute
    _, cursor = self.add_query(sql, auto_begin)
  File "/usr/local/lib/python3.8/dist-packages/dbt/adapters/snowflake/connections.py", line 433, in add_query
    connection, cursor = super().add_query(
  File "/usr/local/lib/python3.8/dist-packages/dbt/adapters/sql/connections.py", line 83, in add_query
    return connection, cursor
  File "/usr/lib/python3.8/contextlib.py", line 131, in __exit__
    self.gen.throw(type, value, traceback)
  File "/usr/local/lib/python3.8/dist-packages/dbt/adapters/snowflake/connections.py", line 223, in exception_handler
    raise DatabaseException(msg)
dbt.exceptions.DatabaseException: Database Error
  001003 (42000): SQL compilation error:
  syntax error line 2 at position 32 unexpected '-'.
2022-07-04 05:19:20.225491 (Thread-1): Got exception RPCException(10003, Database Error, {'type': 'DatabaseException', 'message': "Database Error in rpc request (from remote system)\n  001003 (42000): SQL compilation error:\n  syntax error line 2 at position 32 unexpected '-'.", 'raw_sql': "with cte_gender as \r\n(select * from ANALYTICS_DB.data-apps-ecommerce-template.cte_gender),\r\n\r\ncte_age as \r\n(select user_id, age from\r\n(select user_id, \r\n(CASE WHEN dateadd(year, datediff (year, properties_birthday, getdate()), properties_birthday) > getdate()\r\n      THEN datediff(year, properties_birthday, getdate()) - 1\r\n      ELSE datediff(year, properties_birthday, getdate())\r\n END) as age, row_number() over(partition by user_id order by timestamp desc) as rn \r\nfrom {{ source('ecommerce', 'identifies') }} where timestamp >= '{{ var('start_date') }}' and timestamp <= '{{ var('end_date') }}'\r\nand properties_birthday is not null and properties_birthday!='') where rn = 1),\r\n\r\ncte_country as \r\n(select user_id, country from \r\n(select user_id, properties_country as country, row_number() over(partition by user_id order by timestamp desc) as rn from \r\n{{ source('ecommerce', 'identifies') }} where timestamp >= '{{ var('start_date') }}' and timestamp <= '{{ var('end_date') }}'\r\nand properties_country is not null and properties_country != '') where rn = 1),\r\n\r\ncte_state as \r\n(select user_id, state from \r\n(select user_id, properties_state as state, row_number() over(partition by user_id order by timestamp desc) as rn from \r\n{{ source('ecommerce', 'identifies') }} where timestamp >= '{{ var('start_date') }}' and timestamp <= '{{ var('end_date') }}'\r\nand properties_state is not null and properties_state != '') where rn = 1),\r\n\r\ncte_email_domain as \r\n(select user_id, email_domain from \r\n(select user_id, substring(properties_email, charindex( '@', properties_email) + 1, len(properties_email)) as email_domain, row_number() over(partition by user_id order by timestamp desc) as rn from \r\n{{ source('ecommerce', 'identifies') }} where timestamp >= '{{ var('start_date') }}' and timestamp <= '{{ var('end_date') }}'\r\nand properties_email is not null and properties_email != '') where rn = 1)\r\n\r\nselect coalesce(a.user_id, b.user_id, c.user_id, d.user_id,e.user_id) \r\nas user_id, gender, age, country, state, email_domain\r\nfrom (((cte_gender a full outer join cte_age b on a.user_id = b.user_id) \r\nfull outer join cte_country c on c.user_id = coalesce(a.user_id, b.user_id))\r\nfull outer join cte_state d on d.user_id = coalesce(a.user_id, b.user_id, c.user_id))\r\nfull outer join cte_email_domain e on e.user_id = coalesce(a.user_id, b.user_id, c.user_id,d.user_id, e.user_id)\nlimit 500\n/* limit added automatically by dbt cloud */", 'compiled_sql': "with cte_gender as \n(select * from ANALYTICS_DB.data-apps-ecommerce-template.cte_gender),\n\ncte_age as \n(select user_id, age from\n(select user_id, \n(CASE WHEN dateadd(year, datediff (year, properties_birthday, getdate()), properties_birthday) > getdate()\n      THEN datediff(year, properties_birthday, getdate()) - 1\n      ELSE datediff(year, properties_birthday, getdate())\n END) as age, row_number() over(partition by user_id order by timestamp desc) as rn \nfrom analytics_db.data_apps_simulated.identifies where timestamp >= '2021-05-01' and timestamp <= '2022-06-29'\nand properties_birthday is not null and properties_birthday!='') where rn = 1),\n\ncte_country as \n(select user_id, country from \n(select user_id, properties_country as country, row_number() over(partition by user_id order by timestamp desc) as rn from \nanalytics_db.data_apps_simulated.identifies where timestamp >= '2021-05-01' and timestamp <= '2022-06-29'\nand properties_country is not null and properties_country != '') where rn = 1),\n\ncte_state as \n(select user_id, state from \n(select user_id, properties_state as state, row_number() over(partition by user_id order by timestamp desc) as rn from \nanalytics_db.data_apps_simulated.identifies where timestamp >= '2021-05-01' and timestamp <= '2022-06-29'\nand properties_state is not null and properties_state != '') where rn = 1),\n\ncte_email_domain as \n(select user_id, email_domain from \n(select user_id, substring(properties_email, charindex( '@', properties_email) + 1, len(properties_email)) as email_domain, row_number() over(partition by user_id order by timestamp desc) as rn from \nanalytics_db.data_apps_simulated.identifies where timestamp >= '2021-05-01' and timestamp <= '2022-06-29'\nand properties_email is not null and properties_email != '') where rn = 1)\n\nselect coalesce(a.user_id, b.user_id, c.user_id, d.user_id,e.user_id) \nas user_id, gender, age, country, state, email_domain\nfrom (((cte_gender a full outer join cte_age b on a.user_id = b.user_id) \nfull outer join cte_country c on c.user_id = coalesce(a.user_id, b.user_id))\nfull outer join cte_state d on d.user_id = coalesce(a.user_id, b.user_id, c.user_id))\nfull outer join cte_email_domain e on e.user_id = coalesce(a.user_id, b.user_id, c.user_id,d.user_id, e.user_id)\nlimit 500\n/* limit added automatically by dbt cloud */", 'tags': None}, None)
Traceback (most recent call last):
  File "/usr/local/lib/python3.8/dist-packages/dbt_rpc/task/sql_commands.py", line 147, in _in_thread
    self.node_results.append(runner.safe_run(self.manifest))
  File "/usr/local/lib/python3.8/dist-packages/dbt/task/base.py", line 377, in safe_run
    result = self.error_result(ctx.node, error, started, [])
  File "/usr/local/lib/python3.8/dist-packages/dbt_rpc/rpc/node_runners.py", line 56, in error_result
    raise error
dbt_rpc.rpc.error.RPCException: RPCException(10003, Database Error, {'type': 'DatabaseException', 'message': "Database Error in rpc request (from remote system)\n  001003 (42000): SQL compilation error:\n  syntax error line 2 at position 32 unexpected '-'.", 'raw_sql': "with cte_gender as \r\n(select * from ANALYTICS_DB.data-apps-ecommerce-template.cte_gender),\r\n\r\ncte_age as \r\n(select user_id, age from\r\n(select user_id, \r\n(CASE WHEN dateadd(year, datediff (year, properties_birthday, getdate()), properties_birthday) > getdate()\r\n      THEN datediff(year, properties_birthday, getdate()) - 1\r\n      ELSE datediff(year, properties_birthday, getdate())\r\n END) as age, row_number() over(partition by user_id order by timestamp desc) as rn \r\nfrom {{ source('ecommerce', 'identifies') }} where timestamp >= '{{ var('start_date') }}' and timestamp <= '{{ var('end_date') }}'\r\nand properties_birthday is not null and properties_birthday!='') where rn = 1),\r\n\r\ncte_country as \r\n(select user_id, country from \r\n(select user_id, properties_country as country, row_number() over(partition by user_id order by timestamp desc) as rn from \r\n{{ source('ecommerce', 'identifies') }} where timestamp >= '{{ var('start_date') }}' and timestamp <= '{{ var('end_date') }}'\r\nand properties_country is not null and properties_country != '') where rn = 1),\r\n\r\ncte_state as \r\n(select user_id, state from \r\n(select user_id, properties_state as state, row_number() over(partition by user_id order by timestamp desc) as rn from \r\n{{ source('ecommerce', 'identifies') }} where timestamp >= '{{ var('start_date') }}' and timestamp <= '{{ var('end_date') }}'\r\nand properties_state is not null and properties_state != '') where rn = 1),\r\n\r\ncte_email_domain as \r\n(select user_id, email_domain from \r\n(select user_id, substring(properties_email, charindex( '@', properties_email) + 1, len(properties_email)) as email_domain, row_number() over(partition by user_id order by timestamp desc) as rn from \r\n{{ source('ecommerce', 'identifies') }} where timestamp >= '{{ var('start_date') }}' and timestamp <= '{{ var('end_date') }}'\r\nand properties_email is not null and properties_email != '') where rn = 1)\r\n\r\nselect coalesce(a.user_id, b.user_id, c.user_id, d.user_id,e.user_id) \r\nas user_id, gender, age, country, state, email_domain\r\nfrom (((cte_gender a full outer join cte_age b on a.user_id = b.user_id) \r\nfull outer join cte_country c on c.user_id = coalesce(a.user_id, b.user_id))\r\nfull outer join cte_state d on d.user_id = coalesce(a.user_id, b.user_id, c.user_id))\r\nfull outer join cte_email_domain e on e.user_id = coalesce(a.user_id, b.user_id, c.user_id,d.user_id, e.user_id)\nlimit 500\n/* limit added automatically by dbt cloud */", 'compiled_sql': "with cte_gender as \n(select * from ANALYTICS_DB.data-apps-ecommerce-template.cte_gender),\n\ncte_age as \n(select user_id, age from\n(select user_id, \n(CASE WHEN dateadd(year, datediff (year, properties_birthday, getdate()), properties_birthday) > getdate()\n      THEN datediff(year, properties_birthday, getdate()) - 1\n      ELSE datediff(year, properties_birthday, getdate())\n END) as age, row_number() over(partition by user_id order by timestamp desc) as rn \nfrom analytics_db.data_apps_simulated.identifies where timestamp >= '2021-05-01' and timestamp <= '2022-06-29'\nand properties_birthday is not null and properties_birthday!='') where rn = 1),\n\ncte_country as \n(select user_id, country from \n(select user_id, properties_country as country, row_number() over(partition by user_id order by timestamp desc) as rn from \nanalytics_db.data_apps_simulated.identifies where timestamp >= '2021-05-01' and timestamp <= '2022-06-29'\nand properties_country is not null and properties_country != '') where rn = 1),\n\ncte_state as \n(select user_id, state from \n(select user_id, properties_state as state, row_number() over(partition by user_id order by timestamp desc) as rn from \nanalytics_db.data_apps_simulated.identifies where timestamp >= '2021-05-01' and timestamp <= '2022-06-29'\nand properties_state is not null and properties_state != '') where rn = 1),\n\ncte_email_domain as \n(select user_id, email_domain from \n(select user_id, substring(properties_email, charindex( '@', properties_email) + 1, len(properties_email)) as email_domain, row_number() over(partition by user_id order by timestamp desc) as rn from \nanalytics_db.data_apps_simulated.identifies where timestamp >= '2021-05-01' and timestamp <= '2022-06-29'\nand properties_email is not null and properties_email != '') where rn = 1)\n\nselect coalesce(a.user_id, b.user_id, c.user_id, d.user_id,e.user_id) \nas user_id, gender, age, country, state, email_domain\nfrom (((cte_gender a full outer join cte_age b on a.user_id = b.user_id) \nfull outer join cte_country c on c.user_id = coalesce(a.user_id, b.user_id))\nfull outer join cte_state d on d.user_id = coalesce(a.user_id, b.user_id, c.user_id))\nfull outer join cte_email_domain e on e.user_id = coalesce(a.user_id, b.user_id, c.user_id,d.user_id, e.user_id)\nlimit 500\n/* limit added automatically by dbt cloud */", 'tags': None}, None)
2022-07-04 05:19:21.171333 (Thread-291): handling poll request
2022-07-04 05:19:21.171755 (Thread-291): 05:19:21  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '08022227-1dd0-4d09-94f1-e256bf2507d1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb1101e1a90>]}
2022-07-04 05:19:21.172493 (Thread-291): sending response (<Response 26566 bytes [200 OK]>) to 10.0.12.141
2022-07-04 05:19:35.324571 (Thread-292): handling status request
2022-07-04 05:19:35.324968 (Thread-292): 05:19:35  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '08022227-1dd0-4d09-94f1-e256bf2507d1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb1101dc580>]}
2022-07-04 05:19:35.325503 (Thread-292): sending response (<Response 2396 bytes [200 OK]>) to 10.0.12.141
2022-07-04 05:19:35.719743 (Thread-293): handling run_sql request
2022-07-04 05:19:35.720161 (Thread-293): 05:19:35  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '08022227-1dd0-4d09-94f1-e256bf2507d1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb1101dc520>]}
2022-07-04 05:19:38.041155 (Thread-293): sending response (<Response 139 bytes [200 OK]>) to 10.0.12.141
2022-07-04 05:19:38.069622 (MainThread): 05:19:38  Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'd6379980-d393-43fd-a52a-88d4e6940c35', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f21bc991e80>]}
2022-07-04 05:19:38.070214 (MainThread): 05:19:38  Found 11 models, 0 tests, 0 snapshots, 0 analyses, 179 macros, 0 operations, 0 seed files, 15 sources, 0 exposures, 0 metrics
2022-07-04 05:19:38.070820 (Thread-1): 05:19:38  Acquiring new snowflake connection "rpc.ecommerce_data_model_dbt.request"
2022-07-04 05:19:38.070970 (Thread-1): 05:19:38  Began compiling node rpc.ecommerce_data_model_dbt.request
2022-07-04 05:19:38.071068 (Thread-1): 05:19:38  Compiling rpc.ecommerce_data_model_dbt.request
2022-07-04 05:19:38.075958 (Thread-1): 05:19:38  finished collecting timing info
2022-07-04 05:19:38.076096 (Thread-1): 05:19:38  Began executing node rpc.ecommerce_data_model_dbt.request
2022-07-04 05:19:38.078805 (Thread-1): 05:19:38  Using snowflake connection "rpc.ecommerce_data_model_dbt.request"
2022-07-04 05:19:38.078919 (Thread-1): 05:19:38  On rpc.ecommerce_data_model_dbt.request: with cte_gender as 
(select * from ANALYTICS_DB.data-apps-ecommerce-template.stg_gender),

cte_age as 
(select user_id, age from
(select user_id, 
(CASE WHEN dateadd(year, datediff (year, properties_birthday, getdate()), properties_birthday) > getdate()
      THEN datediff(year, properties_birthday, getdate()) - 1
      ELSE datediff(year, properties_birthday, getdate())
 END) as age, row_number() over(partition by user_id order by timestamp desc) as rn 
from analytics_db.data_apps_simulated.identifies where timestamp >= '2021-05-01' and timestamp <= '2022-06-29'
and properties_birthday is not null and properties_birthday!='') where rn = 1),

cte_country as 
(select user_id, country from 
(select user_id, properties_country as country, row_number() over(partition by user_id order by timestamp desc) as rn from 
analytics_db.data_apps_simulated.identifies where timestamp >= '2021-05-01' and timestamp <= '2022-06-29'
and properties_country is not null and properties_country != '') where rn = 1),

cte_state as 
(select user_id, state from 
(select user_id, properties_state as state, row_number() over(partition by user_id order by timestamp desc) as rn from 
analytics_db.data_apps_simulated.identifies where timestamp >= '2021-05-01' and timestamp <= '2022-06-29'
and properties_state is not null and properties_state != '') where rn = 1),

cte_email_domain as 
(select user_id, email_domain from 
(select user_id, substring(properties_email, charindex( '@', properties_email) + 1, len(properties_email)) as email_domain, row_number() over(partition by user_id order by timestamp desc) as rn from 
analytics_db.data_apps_simulated.identifies where timestamp >= '2021-05-01' and timestamp <= '2022-06-29'
and properties_email is not null and properties_email != '') where rn = 1)

select coalesce(a.user_id, b.user_id, c.user_id, d.user_id,e.user_id) 
as user_id, gender, age, country, state, email_domain
from (((cte_gender a full outer join cte_age b on a.user_id = b.user_id) 
full outer join cte_country c on c.user_id = coalesce(a.user_id, b.user_id))
full outer join cte_state d on d.user_id = coalesce(a.user_id, b.user_id, c.user_id))
full outer join cte_email_domain e on e.user_id = coalesce(a.user_id, b.user_id, c.user_id,d.user_id, e.user_id)
limit 500
/* limit added automatically by dbt cloud */
2022-07-04 05:19:38.079006 (Thread-1): 05:19:38  Opening a new connection, currently in state init
2022-07-04 05:19:38.423572 (Thread-294): handling poll request
2022-07-04 05:19:38.424049 (Thread-294): 05:19:38  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '08022227-1dd0-4d09-94f1-e256bf2507d1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb1101e1c10>]}
2022-07-04 05:19:38.424899 (Thread-294): sending response (<Response 6109 bytes [200 OK]>) to 10.0.12.141
2022-07-04 05:19:38.700297 (Thread-1): 05:19:38  Snowflake adapter: Snowflake query id: 01a55fdf-0602-3238-0019-82030465e0ce
2022-07-04 05:19:38.700493 (Thread-1): 05:19:38  Snowflake adapter: Snowflake error: 001003 (42000): SQL compilation error:
syntax error line 2 at position 32 unexpected '-'.
2022-07-04 05:19:38.700662 (Thread-1): 05:19:38  finished collecting timing info
2022-07-04 05:19:38.700825 (Thread-1): 05:19:38  On rpc.ecommerce_data_model_dbt.request: Close
2022-07-04 05:19:38.754982 (Thread-1): Got an exception: Database Error
  001003 (42000): SQL compilation error:
  syntax error line 2 at position 32 unexpected '-'.
Traceback (most recent call last):
  File "/usr/local/lib/python3.8/dist-packages/dbt/adapters/snowflake/connections.py", line 206, in exception_handler
    yield
  File "/usr/local/lib/python3.8/dist-packages/dbt/adapters/sql/connections.py", line 74, in add_query
    cursor.execute(sql, bindings)
  File "/usr/local/lib/python3.8/dist-packages/snowflake/connector/cursor.py", line 721, in execute
    Error.errorhandler_wrapper(
  File "/usr/local/lib/python3.8/dist-packages/snowflake/connector/errors.py", line 258, in errorhandler_wrapper
    cursor.errorhandler(connection, cursor, error_class, error_value)
  File "/usr/local/lib/python3.8/dist-packages/snowflake/connector/errors.py", line 188, in default_errorhandler
    raise error_class(
snowflake.connector.errors.ProgrammingError: 001003 (42000): SQL compilation error:
syntax error line 2 at position 32 unexpected '-'.

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/usr/local/lib/python3.8/dist-packages/dbt/task/base.py", line 361, in safe_run
    result = self.compile_and_execute(manifest, ctx)
  File "/usr/local/lib/python3.8/dist-packages/dbt/task/base.py", line 314, in compile_and_execute
    result = self.run(ctx.node, manifest)
  File "/usr/local/lib/python3.8/dist-packages/dbt/task/base.py", line 403, in run
    return self.execute(compiled_node, manifest)
  File "/usr/local/lib/python3.8/dist-packages/dbt_rpc/rpc/node_runners.py", line 90, in execute
    _, execute_result = self.adapter.execute(
  File "/usr/local/lib/python3.8/dist-packages/dbt/adapters/base/impl.py", line 225, in execute
    return self.connections.execute(
  File "/usr/local/lib/python3.8/dist-packages/dbt/adapters/sql/connections.py", line 127, in execute
    _, cursor = self.add_query(sql, auto_begin)
  File "/usr/local/lib/python3.8/dist-packages/dbt/adapters/snowflake/connections.py", line 433, in add_query
    connection, cursor = super().add_query(
  File "/usr/local/lib/python3.8/dist-packages/dbt/adapters/sql/connections.py", line 83, in add_query
    return connection, cursor
  File "/usr/lib/python3.8/contextlib.py", line 131, in __exit__
    self.gen.throw(type, value, traceback)
  File "/usr/local/lib/python3.8/dist-packages/dbt/adapters/snowflake/connections.py", line 223, in exception_handler
    raise DatabaseException(msg)
dbt.exceptions.DatabaseException: Database Error
  001003 (42000): SQL compilation error:
  syntax error line 2 at position 32 unexpected '-'.
2022-07-04 05:19:38.756164 (Thread-1): Got exception RPCException(10003, Database Error, {'type': 'DatabaseException', 'message': "Database Error in rpc request (from remote system)\n  001003 (42000): SQL compilation error:\n  syntax error line 2 at position 32 unexpected '-'.", 'raw_sql': "with cte_gender as \r\n(select * from ANALYTICS_DB.data-apps-ecommerce-template.stg_gender),\r\n\r\ncte_age as \r\n(select user_id, age from\r\n(select user_id, \r\n(CASE WHEN dateadd(year, datediff (year, properties_birthday, getdate()), properties_birthday) > getdate()\r\n      THEN datediff(year, properties_birthday, getdate()) - 1\r\n      ELSE datediff(year, properties_birthday, getdate())\r\n END) as age, row_number() over(partition by user_id order by timestamp desc) as rn \r\nfrom {{ source('ecommerce', 'identifies') }} where timestamp >= '{{ var('start_date') }}' and timestamp <= '{{ var('end_date') }}'\r\nand properties_birthday is not null and properties_birthday!='') where rn = 1),\r\n\r\ncte_country as \r\n(select user_id, country from \r\n(select user_id, properties_country as country, row_number() over(partition by user_id order by timestamp desc) as rn from \r\n{{ source('ecommerce', 'identifies') }} where timestamp >= '{{ var('start_date') }}' and timestamp <= '{{ var('end_date') }}'\r\nand properties_country is not null and properties_country != '') where rn = 1),\r\n\r\ncte_state as \r\n(select user_id, state from \r\n(select user_id, properties_state as state, row_number() over(partition by user_id order by timestamp desc) as rn from \r\n{{ source('ecommerce', 'identifies') }} where timestamp >= '{{ var('start_date') }}' and timestamp <= '{{ var('end_date') }}'\r\nand properties_state is not null and properties_state != '') where rn = 1),\r\n\r\ncte_email_domain as \r\n(select user_id, email_domain from \r\n(select user_id, substring(properties_email, charindex( '@', properties_email) + 1, len(properties_email)) as email_domain, row_number() over(partition by user_id order by timestamp desc) as rn from \r\n{{ source('ecommerce', 'identifies') }} where timestamp >= '{{ var('start_date') }}' and timestamp <= '{{ var('end_date') }}'\r\nand properties_email is not null and properties_email != '') where rn = 1)\r\n\r\nselect coalesce(a.user_id, b.user_id, c.user_id, d.user_id,e.user_id) \r\nas user_id, gender, age, country, state, email_domain\r\nfrom (((cte_gender a full outer join cte_age b on a.user_id = b.user_id) \r\nfull outer join cte_country c on c.user_id = coalesce(a.user_id, b.user_id))\r\nfull outer join cte_state d on d.user_id = coalesce(a.user_id, b.user_id, c.user_id))\r\nfull outer join cte_email_domain e on e.user_id = coalesce(a.user_id, b.user_id, c.user_id,d.user_id, e.user_id)\nlimit 500\n/* limit added automatically by dbt cloud */", 'compiled_sql': "with cte_gender as \n(select * from ANALYTICS_DB.data-apps-ecommerce-template.stg_gender),\n\ncte_age as \n(select user_id, age from\n(select user_id, \n(CASE WHEN dateadd(year, datediff (year, properties_birthday, getdate()), properties_birthday) > getdate()\n      THEN datediff(year, properties_birthday, getdate()) - 1\n      ELSE datediff(year, properties_birthday, getdate())\n END) as age, row_number() over(partition by user_id order by timestamp desc) as rn \nfrom analytics_db.data_apps_simulated.identifies where timestamp >= '2021-05-01' and timestamp <= '2022-06-29'\nand properties_birthday is not null and properties_birthday!='') where rn = 1),\n\ncte_country as \n(select user_id, country from \n(select user_id, properties_country as country, row_number() over(partition by user_id order by timestamp desc) as rn from \nanalytics_db.data_apps_simulated.identifies where timestamp >= '2021-05-01' and timestamp <= '2022-06-29'\nand properties_country is not null and properties_country != '') where rn = 1),\n\ncte_state as \n(select user_id, state from \n(select user_id, properties_state as state, row_number() over(partition by user_id order by timestamp desc) as rn from \nanalytics_db.data_apps_simulated.identifies where timestamp >= '2021-05-01' and timestamp <= '2022-06-29'\nand properties_state is not null and properties_state != '') where rn = 1),\n\ncte_email_domain as \n(select user_id, email_domain from \n(select user_id, substring(properties_email, charindex( '@', properties_email) + 1, len(properties_email)) as email_domain, row_number() over(partition by user_id order by timestamp desc) as rn from \nanalytics_db.data_apps_simulated.identifies where timestamp >= '2021-05-01' and timestamp <= '2022-06-29'\nand properties_email is not null and properties_email != '') where rn = 1)\n\nselect coalesce(a.user_id, b.user_id, c.user_id, d.user_id,e.user_id) \nas user_id, gender, age, country, state, email_domain\nfrom (((cte_gender a full outer join cte_age b on a.user_id = b.user_id) \nfull outer join cte_country c on c.user_id = coalesce(a.user_id, b.user_id))\nfull outer join cte_state d on d.user_id = coalesce(a.user_id, b.user_id, c.user_id))\nfull outer join cte_email_domain e on e.user_id = coalesce(a.user_id, b.user_id, c.user_id,d.user_id, e.user_id)\nlimit 500\n/* limit added automatically by dbt cloud */", 'tags': None}, None)
Traceback (most recent call last):
  File "/usr/local/lib/python3.8/dist-packages/dbt_rpc/task/sql_commands.py", line 147, in _in_thread
    self.node_results.append(runner.safe_run(self.manifest))
  File "/usr/local/lib/python3.8/dist-packages/dbt/task/base.py", line 377, in safe_run
    result = self.error_result(ctx.node, error, started, [])
  File "/usr/local/lib/python3.8/dist-packages/dbt_rpc/rpc/node_runners.py", line 56, in error_result
    raise error
dbt_rpc.rpc.error.RPCException: RPCException(10003, Database Error, {'type': 'DatabaseException', 'message': "Database Error in rpc request (from remote system)\n  001003 (42000): SQL compilation error:\n  syntax error line 2 at position 32 unexpected '-'.", 'raw_sql': "with cte_gender as \r\n(select * from ANALYTICS_DB.data-apps-ecommerce-template.stg_gender),\r\n\r\ncte_age as \r\n(select user_id, age from\r\n(select user_id, \r\n(CASE WHEN dateadd(year, datediff (year, properties_birthday, getdate()), properties_birthday) > getdate()\r\n      THEN datediff(year, properties_birthday, getdate()) - 1\r\n      ELSE datediff(year, properties_birthday, getdate())\r\n END) as age, row_number() over(partition by user_id order by timestamp desc) as rn \r\nfrom {{ source('ecommerce', 'identifies') }} where timestamp >= '{{ var('start_date') }}' and timestamp <= '{{ var('end_date') }}'\r\nand properties_birthday is not null and properties_birthday!='') where rn = 1),\r\n\r\ncte_country as \r\n(select user_id, country from \r\n(select user_id, properties_country as country, row_number() over(partition by user_id order by timestamp desc) as rn from \r\n{{ source('ecommerce', 'identifies') }} where timestamp >= '{{ var('start_date') }}' and timestamp <= '{{ var('end_date') }}'\r\nand properties_country is not null and properties_country != '') where rn = 1),\r\n\r\ncte_state as \r\n(select user_id, state from \r\n(select user_id, properties_state as state, row_number() over(partition by user_id order by timestamp desc) as rn from \r\n{{ source('ecommerce', 'identifies') }} where timestamp >= '{{ var('start_date') }}' and timestamp <= '{{ var('end_date') }}'\r\nand properties_state is not null and properties_state != '') where rn = 1),\r\n\r\ncte_email_domain as \r\n(select user_id, email_domain from \r\n(select user_id, substring(properties_email, charindex( '@', properties_email) + 1, len(properties_email)) as email_domain, row_number() over(partition by user_id order by timestamp desc) as rn from \r\n{{ source('ecommerce', 'identifies') }} where timestamp >= '{{ var('start_date') }}' and timestamp <= '{{ var('end_date') }}'\r\nand properties_email is not null and properties_email != '') where rn = 1)\r\n\r\nselect coalesce(a.user_id, b.user_id, c.user_id, d.user_id,e.user_id) \r\nas user_id, gender, age, country, state, email_domain\r\nfrom (((cte_gender a full outer join cte_age b on a.user_id = b.user_id) \r\nfull outer join cte_country c on c.user_id = coalesce(a.user_id, b.user_id))\r\nfull outer join cte_state d on d.user_id = coalesce(a.user_id, b.user_id, c.user_id))\r\nfull outer join cte_email_domain e on e.user_id = coalesce(a.user_id, b.user_id, c.user_id,d.user_id, e.user_id)\nlimit 500\n/* limit added automatically by dbt cloud */", 'compiled_sql': "with cte_gender as \n(select * from ANALYTICS_DB.data-apps-ecommerce-template.stg_gender),\n\ncte_age as \n(select user_id, age from\n(select user_id, \n(CASE WHEN dateadd(year, datediff (year, properties_birthday, getdate()), properties_birthday) > getdate()\n      THEN datediff(year, properties_birthday, getdate()) - 1\n      ELSE datediff(year, properties_birthday, getdate())\n END) as age, row_number() over(partition by user_id order by timestamp desc) as rn \nfrom analytics_db.data_apps_simulated.identifies where timestamp >= '2021-05-01' and timestamp <= '2022-06-29'\nand properties_birthday is not null and properties_birthday!='') where rn = 1),\n\ncte_country as \n(select user_id, country from \n(select user_id, properties_country as country, row_number() over(partition by user_id order by timestamp desc) as rn from \nanalytics_db.data_apps_simulated.identifies where timestamp >= '2021-05-01' and timestamp <= '2022-06-29'\nand properties_country is not null and properties_country != '') where rn = 1),\n\ncte_state as \n(select user_id, state from \n(select user_id, properties_state as state, row_number() over(partition by user_id order by timestamp desc) as rn from \nanalytics_db.data_apps_simulated.identifies where timestamp >= '2021-05-01' and timestamp <= '2022-06-29'\nand properties_state is not null and properties_state != '') where rn = 1),\n\ncte_email_domain as \n(select user_id, email_domain from \n(select user_id, substring(properties_email, charindex( '@', properties_email) + 1, len(properties_email)) as email_domain, row_number() over(partition by user_id order by timestamp desc) as rn from \nanalytics_db.data_apps_simulated.identifies where timestamp >= '2021-05-01' and timestamp <= '2022-06-29'\nand properties_email is not null and properties_email != '') where rn = 1)\n\nselect coalesce(a.user_id, b.user_id, c.user_id, d.user_id,e.user_id) \nas user_id, gender, age, country, state, email_domain\nfrom (((cte_gender a full outer join cte_age b on a.user_id = b.user_id) \nfull outer join cte_country c on c.user_id = coalesce(a.user_id, b.user_id))\nfull outer join cte_state d on d.user_id = coalesce(a.user_id, b.user_id, c.user_id))\nfull outer join cte_email_domain e on e.user_id = coalesce(a.user_id, b.user_id, c.user_id,d.user_id, e.user_id)\nlimit 500\n/* limit added automatically by dbt cloud */", 'tags': None}, None)
2022-07-04 05:19:39.632530 (Thread-295): handling kill request
2022-07-04 05:19:39.632939 (Thread-295): 05:19:39  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '08022227-1dd0-4d09-94f1-e256bf2507d1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb1102d82e0>]}
2022-07-04 05:19:39.633463 (Thread-295): sending response (<Response 115 bytes [200 OK]>) to 10.0.12.141
2022-07-04 05:19:39.787892 (Thread-296): handling poll request
2022-07-04 05:19:39.788283 (Thread-296): 05:19:39  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '08022227-1dd0-4d09-94f1-e256bf2507d1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb1101eb8e0>]}
2022-07-04 05:19:39.789011 (Thread-296): sending response (<Response 26566 bytes [200 OK]>) to 10.0.12.141
2022-07-04 05:19:40.601677 (Thread-297): 05:19:40  Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
2022-07-04 05:19:40.602209 (Thread-297): 05:19:40  Partial parsing: updated file: ecommerce_data_model_dbt://models/data_model/temp_folder/user_traits_test.sql
2022-07-04 05:19:40.607573 (Thread-297): 05:19:40  1603: static parser failed on data_model/temp_folder/user_traits_test.sql
2022-07-04 05:19:40.613716 (Thread-297): 05:19:40  1602: parser fallback to jinja rendering on data_model/temp_folder/user_traits_test.sql
2022-07-04 05:19:40.651886 (Thread-297): 05:19:40  [WARNING]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.data-apps-ecommerce-template.data_model

2022-07-04 05:19:40.657300 (Thread-297): 05:19:40  Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '08022227-1dd0-4d09-94f1-e256bf2507d1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb110177d60>]}
2022-07-04 05:19:41.406745 (Thread-298): handling status request
2022-07-04 05:19:41.407182 (Thread-298): 05:19:41  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '08022227-1dd0-4d09-94f1-e256bf2507d1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb110148dc0>]}
2022-07-04 05:19:41.407711 (Thread-298): sending response (<Response 2396 bytes [200 OK]>) to 10.0.12.141
2022-07-04 05:19:41.421481 (Thread-299): handling status request
2022-07-04 05:19:41.421881 (Thread-299): 05:19:41  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '08022227-1dd0-4d09-94f1-e256bf2507d1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb1102d9370>]}
2022-07-04 05:19:41.422421 (Thread-299): sending response (<Response 2396 bytes [200 OK]>) to 10.0.12.141
2022-07-04 05:19:43.188008 (Thread-300): handling status request
2022-07-04 05:19:43.188431 (Thread-300): 05:19:43  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '08022227-1dd0-4d09-94f1-e256bf2507d1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb1102d9520>]}
2022-07-04 05:19:43.188937 (Thread-300): sending response (<Response 2396 bytes [200 OK]>) to 10.0.12.141
2022-07-04 05:19:43.585688 (Thread-301): handling run_sql request
2022-07-04 05:19:43.586142 (Thread-301): 05:19:43  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '08022227-1dd0-4d09-94f1-e256bf2507d1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb11015c040>]}
2022-07-04 05:19:45.933199 (Thread-301): sending response (<Response 139 bytes [200 OK]>) to 10.0.12.141
2022-07-04 05:19:45.961654 (MainThread): 05:19:45  Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'b2dbe91f-995b-42d6-b283-1b68e480bc65', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb0174f2490>]}
2022-07-04 05:19:45.962272 (MainThread): 05:19:45  Found 11 models, 0 tests, 0 snapshots, 0 analyses, 179 macros, 0 operations, 0 seed files, 15 sources, 0 exposures, 0 metrics
2022-07-04 05:19:45.962905 (Thread-1): 05:19:45  Acquiring new snowflake connection "rpc.ecommerce_data_model_dbt.request"
2022-07-04 05:19:45.963043 (Thread-1): 05:19:45  Began compiling node rpc.ecommerce_data_model_dbt.request
2022-07-04 05:19:45.963138 (Thread-1): 05:19:45  Compiling rpc.ecommerce_data_model_dbt.request
2022-07-04 05:19:45.968118 (Thread-1): 05:19:45  finished collecting timing info
2022-07-04 05:19:45.968262 (Thread-1): 05:19:45  Began executing node rpc.ecommerce_data_model_dbt.request
2022-07-04 05:19:45.970994 (Thread-1): 05:19:45  Using snowflake connection "rpc.ecommerce_data_model_dbt.request"
2022-07-04 05:19:45.971097 (Thread-1): 05:19:45  On rpc.ecommerce_data_model_dbt.request: with cte_gender as 
(select * from ANALYTICS_DB.data-apps-ecommerce-template.stg_gender),

cte_age as 
(select user_id, age from
(select user_id, 
(CASE WHEN dateadd(year, datediff (year, properties_birthday, getdate()), properties_birthday) > getdate()
      THEN datediff(year, properties_birthday, getdate()) - 1
      ELSE datediff(year, properties_birthday, getdate())
 END) as age, row_number() over(partition by user_id order by timestamp desc) as rn 
from analytics_db.data_apps_simulated.identifies where timestamp >= '2021-05-01' and timestamp <= '2022-06-29'
and properties_birthday is not null and properties_birthday!='') where rn = 1),

cte_country as 
(select user_id, country from 
(select user_id, properties_country as country, row_number() over(partition by user_id order by timestamp desc) as rn from 
analytics_db.data_apps_simulated.identifies where timestamp >= '2021-05-01' and timestamp <= '2022-06-29'
and properties_country is not null and properties_country != '') where rn = 1),

cte_state as 
(select user_id, state from 
(select user_id, properties_state as state, row_number() over(partition by user_id order by timestamp desc) as rn from 
analytics_db.data_apps_simulated.identifies where timestamp >= '2021-05-01' and timestamp <= '2022-06-29'
and properties_state is not null and properties_state != '') where rn = 1),

cte_email_domain as 
(select user_id, email_domain from 
(select user_id, substring(properties_email, charindex( '@', properties_email) + 1, len(properties_email)) as email_domain, row_number() over(partition by user_id order by timestamp desc) as rn from 
analytics_db.data_apps_simulated.identifies where timestamp >= '2021-05-01' and timestamp <= '2022-06-29'
and properties_email is not null and properties_email != '') where rn = 1)

select coalesce(a.user_id, b.user_id, c.user_id, d.user_id,e.user_id) 
as user_id, gender, age, country, state, email_domain
from (((cte_gender a full outer join cte_age b on a.user_id = b.user_id) 
full outer join cte_country c on c.user_id = coalesce(a.user_id, b.user_id))
full outer join cte_state d on d.user_id = coalesce(a.user_id, b.user_id, c.user_id))
full outer join cte_email_domain e on e.user_id = coalesce(a.user_id, b.user_id, c.user_id,d.user_id, e.user_id)
limit 500
/* limit added automatically by dbt cloud */
2022-07-04 05:19:45.971183 (Thread-1): 05:19:45  Opening a new connection, currently in state init
2022-07-04 05:19:46.319964 (Thread-302): handling poll request
2022-07-04 05:19:46.320442 (Thread-302): 05:19:46  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '08022227-1dd0-4d09-94f1-e256bf2507d1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb110177d30>]}
2022-07-04 05:19:46.321483 (Thread-302): sending response (<Response 6109 bytes [200 OK]>) to 10.0.12.141
2022-07-04 05:19:46.605379 (Thread-1): 05:19:46  Snowflake adapter: Snowflake query id: 01a55fdf-0602-327e-0019-82030465ccbe
2022-07-04 05:19:46.605576 (Thread-1): 05:19:46  Snowflake adapter: Snowflake error: 001003 (42000): SQL compilation error:
syntax error line 2 at position 32 unexpected '-'.
2022-07-04 05:19:46.605753 (Thread-1): 05:19:46  finished collecting timing info
2022-07-04 05:19:46.605909 (Thread-1): 05:19:46  On rpc.ecommerce_data_model_dbt.request: Close
2022-07-04 05:19:46.694728 (Thread-1): Got an exception: Database Error
  001003 (42000): SQL compilation error:
  syntax error line 2 at position 32 unexpected '-'.
Traceback (most recent call last):
  File "/usr/local/lib/python3.8/dist-packages/dbt/adapters/snowflake/connections.py", line 206, in exception_handler
    yield
  File "/usr/local/lib/python3.8/dist-packages/dbt/adapters/sql/connections.py", line 74, in add_query
    cursor.execute(sql, bindings)
  File "/usr/local/lib/python3.8/dist-packages/snowflake/connector/cursor.py", line 721, in execute
    Error.errorhandler_wrapper(
  File "/usr/local/lib/python3.8/dist-packages/snowflake/connector/errors.py", line 258, in errorhandler_wrapper
    cursor.errorhandler(connection, cursor, error_class, error_value)
  File "/usr/local/lib/python3.8/dist-packages/snowflake/connector/errors.py", line 188, in default_errorhandler
    raise error_class(
snowflake.connector.errors.ProgrammingError: 001003 (42000): SQL compilation error:
syntax error line 2 at position 32 unexpected '-'.

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/usr/local/lib/python3.8/dist-packages/dbt/task/base.py", line 361, in safe_run
    result = self.compile_and_execute(manifest, ctx)
  File "/usr/local/lib/python3.8/dist-packages/dbt/task/base.py", line 314, in compile_and_execute
    result = self.run(ctx.node, manifest)
  File "/usr/local/lib/python3.8/dist-packages/dbt/task/base.py", line 403, in run
    return self.execute(compiled_node, manifest)
  File "/usr/local/lib/python3.8/dist-packages/dbt_rpc/rpc/node_runners.py", line 90, in execute
    _, execute_result = self.adapter.execute(
  File "/usr/local/lib/python3.8/dist-packages/dbt/adapters/base/impl.py", line 225, in execute
    return self.connections.execute(
  File "/usr/local/lib/python3.8/dist-packages/dbt/adapters/sql/connections.py", line 127, in execute
    _, cursor = self.add_query(sql, auto_begin)
  File "/usr/local/lib/python3.8/dist-packages/dbt/adapters/snowflake/connections.py", line 433, in add_query
    connection, cursor = super().add_query(
  File "/usr/local/lib/python3.8/dist-packages/dbt/adapters/sql/connections.py", line 83, in add_query
    return connection, cursor
  File "/usr/lib/python3.8/contextlib.py", line 131, in __exit__
    self.gen.throw(type, value, traceback)
  File "/usr/local/lib/python3.8/dist-packages/dbt/adapters/snowflake/connections.py", line 223, in exception_handler
    raise DatabaseException(msg)
dbt.exceptions.DatabaseException: Database Error
  001003 (42000): SQL compilation error:
  syntax error line 2 at position 32 unexpected '-'.
2022-07-04 05:19:46.695736 (Thread-1): Got exception RPCException(10003, Database Error, {'type': 'DatabaseException', 'message': "Database Error in rpc request (from remote system)\n  001003 (42000): SQL compilation error:\n  syntax error line 2 at position 32 unexpected '-'.", 'raw_sql': "with cte_gender as \r\n(select * from ANALYTICS_DB.data-apps-ecommerce-template.stg_gender),\r\n\r\ncte_age as \r\n(select user_id, age from\r\n(select user_id, \r\n(CASE WHEN dateadd(year, datediff (year, properties_birthday, getdate()), properties_birthday) > getdate()\r\n      THEN datediff(year, properties_birthday, getdate()) - 1\r\n      ELSE datediff(year, properties_birthday, getdate())\r\n END) as age, row_number() over(partition by user_id order by timestamp desc) as rn \r\nfrom {{ source('ecommerce', 'identifies') }} where timestamp >= '{{ var('start_date') }}' and timestamp <= '{{ var('end_date') }}'\r\nand properties_birthday is not null and properties_birthday!='') where rn = 1),\r\n\r\ncte_country as \r\n(select user_id, country from \r\n(select user_id, properties_country as country, row_number() over(partition by user_id order by timestamp desc) as rn from \r\n{{ source('ecommerce', 'identifies') }} where timestamp >= '{{ var('start_date') }}' and timestamp <= '{{ var('end_date') }}'\r\nand properties_country is not null and properties_country != '') where rn = 1),\r\n\r\ncte_state as \r\n(select user_id, state from \r\n(select user_id, properties_state as state, row_number() over(partition by user_id order by timestamp desc) as rn from \r\n{{ source('ecommerce', 'identifies') }} where timestamp >= '{{ var('start_date') }}' and timestamp <= '{{ var('end_date') }}'\r\nand properties_state is not null and properties_state != '') where rn = 1),\r\n\r\ncte_email_domain as \r\n(select user_id, email_domain from \r\n(select user_id, substring(properties_email, charindex( '@', properties_email) + 1, len(properties_email)) as email_domain, row_number() over(partition by user_id order by timestamp desc) as rn from \r\n{{ source('ecommerce', 'identifies') }} where timestamp >= '{{ var('start_date') }}' and timestamp <= '{{ var('end_date') }}'\r\nand properties_email is not null and properties_email != '') where rn = 1)\r\n\r\nselect coalesce(a.user_id, b.user_id, c.user_id, d.user_id,e.user_id) \r\nas user_id, gender, age, country, state, email_domain\r\nfrom (((cte_gender a full outer join cte_age b on a.user_id = b.user_id) \r\nfull outer join cte_country c on c.user_id = coalesce(a.user_id, b.user_id))\r\nfull outer join cte_state d on d.user_id = coalesce(a.user_id, b.user_id, c.user_id))\r\nfull outer join cte_email_domain e on e.user_id = coalesce(a.user_id, b.user_id, c.user_id,d.user_id, e.user_id)\nlimit 500\n/* limit added automatically by dbt cloud */", 'compiled_sql': "with cte_gender as \n(select * from ANALYTICS_DB.data-apps-ecommerce-template.stg_gender),\n\ncte_age as \n(select user_id, age from\n(select user_id, \n(CASE WHEN dateadd(year, datediff (year, properties_birthday, getdate()), properties_birthday) > getdate()\n      THEN datediff(year, properties_birthday, getdate()) - 1\n      ELSE datediff(year, properties_birthday, getdate())\n END) as age, row_number() over(partition by user_id order by timestamp desc) as rn \nfrom analytics_db.data_apps_simulated.identifies where timestamp >= '2021-05-01' and timestamp <= '2022-06-29'\nand properties_birthday is not null and properties_birthday!='') where rn = 1),\n\ncte_country as \n(select user_id, country from \n(select user_id, properties_country as country, row_number() over(partition by user_id order by timestamp desc) as rn from \nanalytics_db.data_apps_simulated.identifies where timestamp >= '2021-05-01' and timestamp <= '2022-06-29'\nand properties_country is not null and properties_country != '') where rn = 1),\n\ncte_state as \n(select user_id, state from \n(select user_id, properties_state as state, row_number() over(partition by user_id order by timestamp desc) as rn from \nanalytics_db.data_apps_simulated.identifies where timestamp >= '2021-05-01' and timestamp <= '2022-06-29'\nand properties_state is not null and properties_state != '') where rn = 1),\n\ncte_email_domain as \n(select user_id, email_domain from \n(select user_id, substring(properties_email, charindex( '@', properties_email) + 1, len(properties_email)) as email_domain, row_number() over(partition by user_id order by timestamp desc) as rn from \nanalytics_db.data_apps_simulated.identifies where timestamp >= '2021-05-01' and timestamp <= '2022-06-29'\nand properties_email is not null and properties_email != '') where rn = 1)\n\nselect coalesce(a.user_id, b.user_id, c.user_id, d.user_id,e.user_id) \nas user_id, gender, age, country, state, email_domain\nfrom (((cte_gender a full outer join cte_age b on a.user_id = b.user_id) \nfull outer join cte_country c on c.user_id = coalesce(a.user_id, b.user_id))\nfull outer join cte_state d on d.user_id = coalesce(a.user_id, b.user_id, c.user_id))\nfull outer join cte_email_domain e on e.user_id = coalesce(a.user_id, b.user_id, c.user_id,d.user_id, e.user_id)\nlimit 500\n/* limit added automatically by dbt cloud */", 'tags': None}, None)
Traceback (most recent call last):
  File "/usr/local/lib/python3.8/dist-packages/dbt_rpc/task/sql_commands.py", line 147, in _in_thread
    self.node_results.append(runner.safe_run(self.manifest))
  File "/usr/local/lib/python3.8/dist-packages/dbt/task/base.py", line 377, in safe_run
    result = self.error_result(ctx.node, error, started, [])
  File "/usr/local/lib/python3.8/dist-packages/dbt_rpc/rpc/node_runners.py", line 56, in error_result
    raise error
dbt_rpc.rpc.error.RPCException: RPCException(10003, Database Error, {'type': 'DatabaseException', 'message': "Database Error in rpc request (from remote system)\n  001003 (42000): SQL compilation error:\n  syntax error line 2 at position 32 unexpected '-'.", 'raw_sql': "with cte_gender as \r\n(select * from ANALYTICS_DB.data-apps-ecommerce-template.stg_gender),\r\n\r\ncte_age as \r\n(select user_id, age from\r\n(select user_id, \r\n(CASE WHEN dateadd(year, datediff (year, properties_birthday, getdate()), properties_birthday) > getdate()\r\n      THEN datediff(year, properties_birthday, getdate()) - 1\r\n      ELSE datediff(year, properties_birthday, getdate())\r\n END) as age, row_number() over(partition by user_id order by timestamp desc) as rn \r\nfrom {{ source('ecommerce', 'identifies') }} where timestamp >= '{{ var('start_date') }}' and timestamp <= '{{ var('end_date') }}'\r\nand properties_birthday is not null and properties_birthday!='') where rn = 1),\r\n\r\ncte_country as \r\n(select user_id, country from \r\n(select user_id, properties_country as country, row_number() over(partition by user_id order by timestamp desc) as rn from \r\n{{ source('ecommerce', 'identifies') }} where timestamp >= '{{ var('start_date') }}' and timestamp <= '{{ var('end_date') }}'\r\nand properties_country is not null and properties_country != '') where rn = 1),\r\n\r\ncte_state as \r\n(select user_id, state from \r\n(select user_id, properties_state as state, row_number() over(partition by user_id order by timestamp desc) as rn from \r\n{{ source('ecommerce', 'identifies') }} where timestamp >= '{{ var('start_date') }}' and timestamp <= '{{ var('end_date') }}'\r\nand properties_state is not null and properties_state != '') where rn = 1),\r\n\r\ncte_email_domain as \r\n(select user_id, email_domain from \r\n(select user_id, substring(properties_email, charindex( '@', properties_email) + 1, len(properties_email)) as email_domain, row_number() over(partition by user_id order by timestamp desc) as rn from \r\n{{ source('ecommerce', 'identifies') }} where timestamp >= '{{ var('start_date') }}' and timestamp <= '{{ var('end_date') }}'\r\nand properties_email is not null and properties_email != '') where rn = 1)\r\n\r\nselect coalesce(a.user_id, b.user_id, c.user_id, d.user_id,e.user_id) \r\nas user_id, gender, age, country, state, email_domain\r\nfrom (((cte_gender a full outer join cte_age b on a.user_id = b.user_id) \r\nfull outer join cte_country c on c.user_id = coalesce(a.user_id, b.user_id))\r\nfull outer join cte_state d on d.user_id = coalesce(a.user_id, b.user_id, c.user_id))\r\nfull outer join cte_email_domain e on e.user_id = coalesce(a.user_id, b.user_id, c.user_id,d.user_id, e.user_id)\nlimit 500\n/* limit added automatically by dbt cloud */", 'compiled_sql': "with cte_gender as \n(select * from ANALYTICS_DB.data-apps-ecommerce-template.stg_gender),\n\ncte_age as \n(select user_id, age from\n(select user_id, \n(CASE WHEN dateadd(year, datediff (year, properties_birthday, getdate()), properties_birthday) > getdate()\n      THEN datediff(year, properties_birthday, getdate()) - 1\n      ELSE datediff(year, properties_birthday, getdate())\n END) as age, row_number() over(partition by user_id order by timestamp desc) as rn \nfrom analytics_db.data_apps_simulated.identifies where timestamp >= '2021-05-01' and timestamp <= '2022-06-29'\nand properties_birthday is not null and properties_birthday!='') where rn = 1),\n\ncte_country as \n(select user_id, country from \n(select user_id, properties_country as country, row_number() over(partition by user_id order by timestamp desc) as rn from \nanalytics_db.data_apps_simulated.identifies where timestamp >= '2021-05-01' and timestamp <= '2022-06-29'\nand properties_country is not null and properties_country != '') where rn = 1),\n\ncte_state as \n(select user_id, state from \n(select user_id, properties_state as state, row_number() over(partition by user_id order by timestamp desc) as rn from \nanalytics_db.data_apps_simulated.identifies where timestamp >= '2021-05-01' and timestamp <= '2022-06-29'\nand properties_state is not null and properties_state != '') where rn = 1),\n\ncte_email_domain as \n(select user_id, email_domain from \n(select user_id, substring(properties_email, charindex( '@', properties_email) + 1, len(properties_email)) as email_domain, row_number() over(partition by user_id order by timestamp desc) as rn from \nanalytics_db.data_apps_simulated.identifies where timestamp >= '2021-05-01' and timestamp <= '2022-06-29'\nand properties_email is not null and properties_email != '') where rn = 1)\n\nselect coalesce(a.user_id, b.user_id, c.user_id, d.user_id,e.user_id) \nas user_id, gender, age, country, state, email_domain\nfrom (((cte_gender a full outer join cte_age b on a.user_id = b.user_id) \nfull outer join cte_country c on c.user_id = coalesce(a.user_id, b.user_id))\nfull outer join cte_state d on d.user_id = coalesce(a.user_id, b.user_id, c.user_id))\nfull outer join cte_email_domain e on e.user_id = coalesce(a.user_id, b.user_id, c.user_id,d.user_id, e.user_id)\nlimit 500\n/* limit added automatically by dbt cloud */", 'tags': None}, None)
2022-07-04 05:19:47.689656 (Thread-303): handling poll request
2022-07-04 05:19:47.690104 (Thread-303): 05:19:47  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '08022227-1dd0-4d09-94f1-e256bf2507d1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb1101769a0>]}
2022-07-04 05:19:47.690856 (Thread-303): sending response (<Response 26566 bytes [200 OK]>) to 10.0.12.141
2022-07-04 05:19:59.180122 (Thread-304): 05:19:59  Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
2022-07-04 05:19:59.180633 (Thread-304): 05:19:59  Partial parsing: updated file: ecommerce_data_model_dbt://models/data_model/temp_folder/user_traits_test.sql
2022-07-04 05:19:59.185345 (Thread-304): 05:19:59  1603: static parser failed on data_model/temp_folder/user_traits_test.sql
2022-07-04 05:19:59.191524 (Thread-304): 05:19:59  1602: parser fallback to jinja rendering on data_model/temp_folder/user_traits_test.sql
2022-07-04 05:19:59.228459 (Thread-304): 05:19:59  [WARNING]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.data-apps-ecommerce-template.data_model

2022-07-04 05:19:59.233609 (Thread-304): 05:19:59  Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '08022227-1dd0-4d09-94f1-e256bf2507d1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb1100b5b20>]}
2022-07-04 05:19:59.948615 (Thread-305): handling status request
2022-07-04 05:19:59.949036 (Thread-305): 05:19:59  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '08022227-1dd0-4d09-94f1-e256bf2507d1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb110083ee0>]}
2022-07-04 05:19:59.949548 (Thread-305): sending response (<Response 2396 bytes [200 OK]>) to 10.0.12.141
2022-07-04 05:20:00.362149 (Thread-306): handling status request
2022-07-04 05:20:00.362531 (Thread-306): 05:20:00  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '08022227-1dd0-4d09-94f1-e256bf2507d1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb110083ca0>]}
2022-07-04 05:20:00.363090 (Thread-306): sending response (<Response 2396 bytes [200 OK]>) to 10.0.12.141
2022-07-04 05:20:00.438617 (Thread-307): handling status request
2022-07-04 05:20:00.439020 (Thread-307): 05:20:00  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '08022227-1dd0-4d09-94f1-e256bf2507d1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb110083bb0>]}
2022-07-04 05:20:00.439514 (Thread-307): sending response (<Response 2396 bytes [200 OK]>) to 10.0.12.141
2022-07-04 05:20:00.807794 (Thread-308): handling run_sql request
2022-07-04 05:20:00.808211 (Thread-308): 05:20:00  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '08022227-1dd0-4d09-94f1-e256bf2507d1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb110083a90>]}
2022-07-04 05:20:03.180452 (Thread-308): sending response (<Response 139 bytes [200 OK]>) to 10.0.12.141
2022-07-04 05:20:03.209095 (MainThread): 05:20:03  Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '56e2e12e-b05f-4de3-a983-1035558d9aee', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe4d4191f40>]}
2022-07-04 05:20:03.209679 (MainThread): 05:20:03  Found 11 models, 0 tests, 0 snapshots, 0 analyses, 179 macros, 0 operations, 0 seed files, 15 sources, 0 exposures, 0 metrics
2022-07-04 05:20:03.210323 (Thread-1): 05:20:03  Acquiring new snowflake connection "rpc.ecommerce_data_model_dbt.request"
2022-07-04 05:20:03.210450 (Thread-1): 05:20:03  Began compiling node rpc.ecommerce_data_model_dbt.request
2022-07-04 05:20:03.210543 (Thread-1): 05:20:03  Compiling rpc.ecommerce_data_model_dbt.request
2022-07-04 05:20:03.215531 (Thread-1): 05:20:03  finished collecting timing info
2022-07-04 05:20:03.215670 (Thread-1): 05:20:03  Began executing node rpc.ecommerce_data_model_dbt.request
2022-07-04 05:20:03.218408 (Thread-1): 05:20:03  Using snowflake connection "rpc.ecommerce_data_model_dbt.request"
2022-07-04 05:20:03.218508 (Thread-1): 05:20:03  On rpc.ecommerce_data_model_dbt.request: with cte_gender as 
(select * from ANALYTICS_DB.data_apps_ecommerce_template.stg_gender),

cte_age as 
(select user_id, age from
(select user_id, 
(CASE WHEN dateadd(year, datediff (year, properties_birthday, getdate()), properties_birthday) > getdate()
      THEN datediff(year, properties_birthday, getdate()) - 1
      ELSE datediff(year, properties_birthday, getdate())
 END) as age, row_number() over(partition by user_id order by timestamp desc) as rn 
from analytics_db.data_apps_simulated.identifies where timestamp >= '2021-05-01' and timestamp <= '2022-06-29'
and properties_birthday is not null and properties_birthday!='') where rn = 1),

cte_country as 
(select user_id, country from 
(select user_id, properties_country as country, row_number() over(partition by user_id order by timestamp desc) as rn from 
analytics_db.data_apps_simulated.identifies where timestamp >= '2021-05-01' and timestamp <= '2022-06-29'
and properties_country is not null and properties_country != '') where rn = 1),

cte_state as 
(select user_id, state from 
(select user_id, properties_state as state, row_number() over(partition by user_id order by timestamp desc) as rn from 
analytics_db.data_apps_simulated.identifies where timestamp >= '2021-05-01' and timestamp <= '2022-06-29'
and properties_state is not null and properties_state != '') where rn = 1),

cte_email_domain as 
(select user_id, email_domain from 
(select user_id, substring(properties_email, charindex( '@', properties_email) + 1, len(properties_email)) as email_domain, row_number() over(partition by user_id order by timestamp desc) as rn from 
analytics_db.data_apps_simulated.identifies where timestamp >= '2021-05-01' and timestamp <= '2022-06-29'
and properties_email is not null and properties_email != '') where rn = 1)

select coalesce(a.user_id, b.user_id, c.user_id, d.user_id,e.user_id) 
as user_id, gender, age, country, state, email_domain
from (((cte_gender a full outer join cte_age b on a.user_id = b.user_id) 
full outer join cte_country c on c.user_id = coalesce(a.user_id, b.user_id))
full outer join cte_state d on d.user_id = coalesce(a.user_id, b.user_id, c.user_id))
full outer join cte_email_domain e on e.user_id = coalesce(a.user_id, b.user_id, c.user_id,d.user_id, e.user_id)
limit 500
/* limit added automatically by dbt cloud */
2022-07-04 05:20:03.218590 (Thread-1): 05:20:03  Opening a new connection, currently in state init
2022-07-04 05:20:03.558052 (Thread-309): handling poll request
2022-07-04 05:20:03.558537 (Thread-309): 05:20:03  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '08022227-1dd0-4d09-94f1-e256bf2507d1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb1101365e0>]}
2022-07-04 05:20:03.559460 (Thread-309): sending response (<Response 6109 bytes [200 OK]>) to 10.0.12.141
2022-07-04 05:20:03.917393 (Thread-1): 05:20:03  Snowflake adapter: Snowflake query id: 01a55fe0-0602-3256-0019-82030465bdbe
2022-07-04 05:20:03.917581 (Thread-1): 05:20:03  Snowflake adapter: Snowflake error: 002003 (02000): SQL compilation error:
Schema 'ANALYTICS_DB.DATA_APPS_ECOMMERCE_TEMPLATE' does not exist or not authorized.
2022-07-04 05:20:03.917745 (Thread-1): 05:20:03  finished collecting timing info
2022-07-04 05:20:03.917898 (Thread-1): 05:20:03  On rpc.ecommerce_data_model_dbt.request: Close
2022-07-04 05:20:03.976728 (Thread-1): Got an exception: Database Error
  002003 (02000): SQL compilation error:
  Schema 'ANALYTICS_DB.DATA_APPS_ECOMMERCE_TEMPLATE' does not exist or not authorized.
Traceback (most recent call last):
  File "/usr/local/lib/python3.8/dist-packages/dbt/adapters/snowflake/connections.py", line 206, in exception_handler
    yield
  File "/usr/local/lib/python3.8/dist-packages/dbt/adapters/sql/connections.py", line 74, in add_query
    cursor.execute(sql, bindings)
  File "/usr/local/lib/python3.8/dist-packages/snowflake/connector/cursor.py", line 721, in execute
    Error.errorhandler_wrapper(
  File "/usr/local/lib/python3.8/dist-packages/snowflake/connector/errors.py", line 258, in errorhandler_wrapper
    cursor.errorhandler(connection, cursor, error_class, error_value)
  File "/usr/local/lib/python3.8/dist-packages/snowflake/connector/errors.py", line 188, in default_errorhandler
    raise error_class(
snowflake.connector.errors.ProgrammingError: 002003 (02000): SQL compilation error:
Schema 'ANALYTICS_DB.DATA_APPS_ECOMMERCE_TEMPLATE' does not exist or not authorized.

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/usr/local/lib/python3.8/dist-packages/dbt/task/base.py", line 361, in safe_run
    result = self.compile_and_execute(manifest, ctx)
  File "/usr/local/lib/python3.8/dist-packages/dbt/task/base.py", line 314, in compile_and_execute
    result = self.run(ctx.node, manifest)
  File "/usr/local/lib/python3.8/dist-packages/dbt/task/base.py", line 403, in run
    return self.execute(compiled_node, manifest)
  File "/usr/local/lib/python3.8/dist-packages/dbt_rpc/rpc/node_runners.py", line 90, in execute
    _, execute_result = self.adapter.execute(
  File "/usr/local/lib/python3.8/dist-packages/dbt/adapters/base/impl.py", line 225, in execute
    return self.connections.execute(
  File "/usr/local/lib/python3.8/dist-packages/dbt/adapters/sql/connections.py", line 127, in execute
    _, cursor = self.add_query(sql, auto_begin)
  File "/usr/local/lib/python3.8/dist-packages/dbt/adapters/snowflake/connections.py", line 433, in add_query
    connection, cursor = super().add_query(
  File "/usr/local/lib/python3.8/dist-packages/dbt/adapters/sql/connections.py", line 83, in add_query
    return connection, cursor
  File "/usr/lib/python3.8/contextlib.py", line 131, in __exit__
    self.gen.throw(type, value, traceback)
  File "/usr/local/lib/python3.8/dist-packages/dbt/adapters/snowflake/connections.py", line 223, in exception_handler
    raise DatabaseException(msg)
dbt.exceptions.DatabaseException: Database Error
  002003 (02000): SQL compilation error:
  Schema 'ANALYTICS_DB.DATA_APPS_ECOMMERCE_TEMPLATE' does not exist or not authorized.
2022-07-04 05:20:03.977698 (Thread-1): Got exception RPCException(10003, Database Error, {'type': 'DatabaseException', 'message': "Database Error in rpc request (from remote system)\n  002003 (02000): SQL compilation error:\n  Schema 'ANALYTICS_DB.DATA_APPS_ECOMMERCE_TEMPLATE' does not exist or not authorized.", 'raw_sql': "with cte_gender as \r\n(select * from ANALYTICS_DB.data_apps_ecommerce_template.stg_gender),\r\n\r\ncte_age as \r\n(select user_id, age from\r\n(select user_id, \r\n(CASE WHEN dateadd(year, datediff (year, properties_birthday, getdate()), properties_birthday) > getdate()\r\n      THEN datediff(year, properties_birthday, getdate()) - 1\r\n      ELSE datediff(year, properties_birthday, getdate())\r\n END) as age, row_number() over(partition by user_id order by timestamp desc) as rn \r\nfrom {{ source('ecommerce', 'identifies') }} where timestamp >= '{{ var('start_date') }}' and timestamp <= '{{ var('end_date') }}'\r\nand properties_birthday is not null and properties_birthday!='') where rn = 1),\r\n\r\ncte_country as \r\n(select user_id, country from \r\n(select user_id, properties_country as country, row_number() over(partition by user_id order by timestamp desc) as rn from \r\n{{ source('ecommerce', 'identifies') }} where timestamp >= '{{ var('start_date') }}' and timestamp <= '{{ var('end_date') }}'\r\nand properties_country is not null and properties_country != '') where rn = 1),\r\n\r\ncte_state as \r\n(select user_id, state from \r\n(select user_id, properties_state as state, row_number() over(partition by user_id order by timestamp desc) as rn from \r\n{{ source('ecommerce', 'identifies') }} where timestamp >= '{{ var('start_date') }}' and timestamp <= '{{ var('end_date') }}'\r\nand properties_state is not null and properties_state != '') where rn = 1),\r\n\r\ncte_email_domain as \r\n(select user_id, email_domain from \r\n(select user_id, substring(properties_email, charindex( '@', properties_email) + 1, len(properties_email)) as email_domain, row_number() over(partition by user_id order by timestamp desc) as rn from \r\n{{ source('ecommerce', 'identifies') }} where timestamp >= '{{ var('start_date') }}' and timestamp <= '{{ var('end_date') }}'\r\nand properties_email is not null and properties_email != '') where rn = 1)\r\n\r\nselect coalesce(a.user_id, b.user_id, c.user_id, d.user_id,e.user_id) \r\nas user_id, gender, age, country, state, email_domain\r\nfrom (((cte_gender a full outer join cte_age b on a.user_id = b.user_id) \r\nfull outer join cte_country c on c.user_id = coalesce(a.user_id, b.user_id))\r\nfull outer join cte_state d on d.user_id = coalesce(a.user_id, b.user_id, c.user_id))\r\nfull outer join cte_email_domain e on e.user_id = coalesce(a.user_id, b.user_id, c.user_id,d.user_id, e.user_id)\nlimit 500\n/* limit added automatically by dbt cloud */", 'compiled_sql': "with cte_gender as \n(select * from ANALYTICS_DB.data_apps_ecommerce_template.stg_gender),\n\ncte_age as \n(select user_id, age from\n(select user_id, \n(CASE WHEN dateadd(year, datediff (year, properties_birthday, getdate()), properties_birthday) > getdate()\n      THEN datediff(year, properties_birthday, getdate()) - 1\n      ELSE datediff(year, properties_birthday, getdate())\n END) as age, row_number() over(partition by user_id order by timestamp desc) as rn \nfrom analytics_db.data_apps_simulated.identifies where timestamp >= '2021-05-01' and timestamp <= '2022-06-29'\nand properties_birthday is not null and properties_birthday!='') where rn = 1),\n\ncte_country as \n(select user_id, country from \n(select user_id, properties_country as country, row_number() over(partition by user_id order by timestamp desc) as rn from \nanalytics_db.data_apps_simulated.identifies where timestamp >= '2021-05-01' and timestamp <= '2022-06-29'\nand properties_country is not null and properties_country != '') where rn = 1),\n\ncte_state as \n(select user_id, state from \n(select user_id, properties_state as state, row_number() over(partition by user_id order by timestamp desc) as rn from \nanalytics_db.data_apps_simulated.identifies where timestamp >= '2021-05-01' and timestamp <= '2022-06-29'\nand properties_state is not null and properties_state != '') where rn = 1),\n\ncte_email_domain as \n(select user_id, email_domain from \n(select user_id, substring(properties_email, charindex( '@', properties_email) + 1, len(properties_email)) as email_domain, row_number() over(partition by user_id order by timestamp desc) as rn from \nanalytics_db.data_apps_simulated.identifies where timestamp >= '2021-05-01' and timestamp <= '2022-06-29'\nand properties_email is not null and properties_email != '') where rn = 1)\n\nselect coalesce(a.user_id, b.user_id, c.user_id, d.user_id,e.user_id) \nas user_id, gender, age, country, state, email_domain\nfrom (((cte_gender a full outer join cte_age b on a.user_id = b.user_id) \nfull outer join cte_country c on c.user_id = coalesce(a.user_id, b.user_id))\nfull outer join cte_state d on d.user_id = coalesce(a.user_id, b.user_id, c.user_id))\nfull outer join cte_email_domain e on e.user_id = coalesce(a.user_id, b.user_id, c.user_id,d.user_id, e.user_id)\nlimit 500\n/* limit added automatically by dbt cloud */", 'tags': None}, None)
Traceback (most recent call last):
  File "/usr/local/lib/python3.8/dist-packages/dbt_rpc/task/sql_commands.py", line 147, in _in_thread
    self.node_results.append(runner.safe_run(self.manifest))
  File "/usr/local/lib/python3.8/dist-packages/dbt/task/base.py", line 377, in safe_run
    result = self.error_result(ctx.node, error, started, [])
  File "/usr/local/lib/python3.8/dist-packages/dbt_rpc/rpc/node_runners.py", line 56, in error_result
    raise error
dbt_rpc.rpc.error.RPCException: RPCException(10003, Database Error, {'type': 'DatabaseException', 'message': "Database Error in rpc request (from remote system)\n  002003 (02000): SQL compilation error:\n  Schema 'ANALYTICS_DB.DATA_APPS_ECOMMERCE_TEMPLATE' does not exist or not authorized.", 'raw_sql': "with cte_gender as \r\n(select * from ANALYTICS_DB.data_apps_ecommerce_template.stg_gender),\r\n\r\ncte_age as \r\n(select user_id, age from\r\n(select user_id, \r\n(CASE WHEN dateadd(year, datediff (year, properties_birthday, getdate()), properties_birthday) > getdate()\r\n      THEN datediff(year, properties_birthday, getdate()) - 1\r\n      ELSE datediff(year, properties_birthday, getdate())\r\n END) as age, row_number() over(partition by user_id order by timestamp desc) as rn \r\nfrom {{ source('ecommerce', 'identifies') }} where timestamp >= '{{ var('start_date') }}' and timestamp <= '{{ var('end_date') }}'\r\nand properties_birthday is not null and properties_birthday!='') where rn = 1),\r\n\r\ncte_country as \r\n(select user_id, country from \r\n(select user_id, properties_country as country, row_number() over(partition by user_id order by timestamp desc) as rn from \r\n{{ source('ecommerce', 'identifies') }} where timestamp >= '{{ var('start_date') }}' and timestamp <= '{{ var('end_date') }}'\r\nand properties_country is not null and properties_country != '') where rn = 1),\r\n\r\ncte_state as \r\n(select user_id, state from \r\n(select user_id, properties_state as state, row_number() over(partition by user_id order by timestamp desc) as rn from \r\n{{ source('ecommerce', 'identifies') }} where timestamp >= '{{ var('start_date') }}' and timestamp <= '{{ var('end_date') }}'\r\nand properties_state is not null and properties_state != '') where rn = 1),\r\n\r\ncte_email_domain as \r\n(select user_id, email_domain from \r\n(select user_id, substring(properties_email, charindex( '@', properties_email) + 1, len(properties_email)) as email_domain, row_number() over(partition by user_id order by timestamp desc) as rn from \r\n{{ source('ecommerce', 'identifies') }} where timestamp >= '{{ var('start_date') }}' and timestamp <= '{{ var('end_date') }}'\r\nand properties_email is not null and properties_email != '') where rn = 1)\r\n\r\nselect coalesce(a.user_id, b.user_id, c.user_id, d.user_id,e.user_id) \r\nas user_id, gender, age, country, state, email_domain\r\nfrom (((cte_gender a full outer join cte_age b on a.user_id = b.user_id) \r\nfull outer join cte_country c on c.user_id = coalesce(a.user_id, b.user_id))\r\nfull outer join cte_state d on d.user_id = coalesce(a.user_id, b.user_id, c.user_id))\r\nfull outer join cte_email_domain e on e.user_id = coalesce(a.user_id, b.user_id, c.user_id,d.user_id, e.user_id)\nlimit 500\n/* limit added automatically by dbt cloud */", 'compiled_sql': "with cte_gender as \n(select * from ANALYTICS_DB.data_apps_ecommerce_template.stg_gender),\n\ncte_age as \n(select user_id, age from\n(select user_id, \n(CASE WHEN dateadd(year, datediff (year, properties_birthday, getdate()), properties_birthday) > getdate()\n      THEN datediff(year, properties_birthday, getdate()) - 1\n      ELSE datediff(year, properties_birthday, getdate())\n END) as age, row_number() over(partition by user_id order by timestamp desc) as rn \nfrom analytics_db.data_apps_simulated.identifies where timestamp >= '2021-05-01' and timestamp <= '2022-06-29'\nand properties_birthday is not null and properties_birthday!='') where rn = 1),\n\ncte_country as \n(select user_id, country from \n(select user_id, properties_country as country, row_number() over(partition by user_id order by timestamp desc) as rn from \nanalytics_db.data_apps_simulated.identifies where timestamp >= '2021-05-01' and timestamp <= '2022-06-29'\nand properties_country is not null and properties_country != '') where rn = 1),\n\ncte_state as \n(select user_id, state from \n(select user_id, properties_state as state, row_number() over(partition by user_id order by timestamp desc) as rn from \nanalytics_db.data_apps_simulated.identifies where timestamp >= '2021-05-01' and timestamp <= '2022-06-29'\nand properties_state is not null and properties_state != '') where rn = 1),\n\ncte_email_domain as \n(select user_id, email_domain from \n(select user_id, substring(properties_email, charindex( '@', properties_email) + 1, len(properties_email)) as email_domain, row_number() over(partition by user_id order by timestamp desc) as rn from \nanalytics_db.data_apps_simulated.identifies where timestamp >= '2021-05-01' and timestamp <= '2022-06-29'\nand properties_email is not null and properties_email != '') where rn = 1)\n\nselect coalesce(a.user_id, b.user_id, c.user_id, d.user_id,e.user_id) \nas user_id, gender, age, country, state, email_domain\nfrom (((cte_gender a full outer join cte_age b on a.user_id = b.user_id) \nfull outer join cte_country c on c.user_id = coalesce(a.user_id, b.user_id))\nfull outer join cte_state d on d.user_id = coalesce(a.user_id, b.user_id, c.user_id))\nfull outer join cte_email_domain e on e.user_id = coalesce(a.user_id, b.user_id, c.user_id,d.user_id, e.user_id)\nlimit 500\n/* limit added automatically by dbt cloud */", 'tags': None}, None)
2022-07-04 05:20:04.939795 (Thread-310): handling poll request
2022-07-04 05:20:04.940176 (Thread-310): 05:20:04  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '08022227-1dd0-4d09-94f1-e256bf2507d1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb110136370>]}
2022-07-04 05:20:04.940885 (Thread-310): sending response (<Response 26804 bytes [200 OK]>) to 10.0.12.141
2022-07-04 05:20:28.123804 (Thread-311): 05:20:28  Partial parsing enabled: 1 files deleted, 0 files added, 0 files changed.
2022-07-04 05:20:28.124167 (Thread-311): 05:20:28  Partial parsing: deleted file: ecommerce_data_model_dbt://models/data_model/temp_folder/user_traits_test.sql
2022-07-04 05:20:28.161792 (Thread-311): 05:20:28  [WARNING]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.data-apps-ecommerce-template.data_model

2022-07-04 05:20:28.167619 (Thread-311): 05:20:28  Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '08022227-1dd0-4d09-94f1-e256bf2507d1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb0f0f8ddf0>]}
2022-07-04 05:20:28.893111 (Thread-312): handling status request
2022-07-04 05:20:28.893528 (Thread-312): 05:20:28  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '08022227-1dd0-4d09-94f1-e256bf2507d1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb0f0f80fd0>]}
2022-07-04 05:20:28.894069 (Thread-312): sending response (<Response 1752 bytes [200 OK]>) to 10.0.12.141
2022-07-04 05:20:28.913261 (Thread-313): handling status request
2022-07-04 05:20:28.913577 (Thread-313): 05:20:28  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '08022227-1dd0-4d09-94f1-e256bf2507d1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb0f0f80eb0>]}
2022-07-04 05:20:28.914037 (Thread-313): sending response (<Response 1752 bytes [200 OK]>) to 10.0.12.141
2022-07-04 05:20:39.840102 (Thread-314): 05:20:39  Partial parsing enabled: 1 files deleted, 1 files added, 0 files changed.
2022-07-04 05:20:39.840517 (Thread-314): 05:20:39  Partial parsing: added file: ecommerce_data_model_dbt://models/data_model/temp_folder/gender.sql
2022-07-04 05:20:39.840656 (Thread-314): 05:20:39  Partial parsing: deleted file: ecommerce_data_model_dbt://models/data_model/temp_folder/stg_gender.sql
2022-07-04 05:20:39.844766 (Thread-314): 05:20:39  1603: static parser failed on data_model/temp_folder/gender.sql
2022-07-04 05:20:39.849262 (Thread-314): 05:20:39  1602: parser fallback to jinja rendering on data_model/temp_folder/gender.sql
2022-07-04 05:20:39.882483 (Thread-314): 05:20:39  [WARNING]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.data-apps-ecommerce-template.data_model

2022-07-04 05:20:39.887704 (Thread-314): 05:20:39  Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '08022227-1dd0-4d09-94f1-e256bf2507d1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb0f0eeda90>]}
2022-07-04 05:20:40.583587 (Thread-315): handling status request
2022-07-04 05:20:40.584010 (Thread-315): 05:20:40  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '08022227-1dd0-4d09-94f1-e256bf2507d1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb11008aaf0>]}
2022-07-04 05:20:40.584534 (Thread-315): sending response (<Response 2708 bytes [200 OK]>) to 10.0.12.141
2022-07-04 05:20:40.983182 (Thread-316): handling status request
2022-07-04 05:20:40.983641 (Thread-316): 05:20:40  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '08022227-1dd0-4d09-94f1-e256bf2507d1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb11008ac40>]}
2022-07-04 05:20:40.984212 (Thread-316): sending response (<Response 2708 bytes [200 OK]>) to 10.0.12.141
2022-07-04 05:20:43.604091 (Thread-317): 05:20:43  Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
2022-07-04 05:20:43.604343 (Thread-317): 05:20:43  Partial parsing enabled, no changes found, skipping parsing
2022-07-04 05:20:43.604891 (Thread-317): 05:20:43  [WARNING]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.data-apps-ecommerce-template.data_model

2022-07-04 05:20:43.610505 (Thread-317): 05:20:43  Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '08022227-1dd0-4d09-94f1-e256bf2507d1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb0f0e41700>]}
2022-07-04 05:20:44.370330 (Thread-318): handling status request
2022-07-04 05:20:44.370739 (Thread-318): 05:20:44  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '08022227-1dd0-4d09-94f1-e256bf2507d1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb1102edfa0>]}
2022-07-04 05:20:44.371254 (Thread-318): sending response (<Response 1703 bytes [200 OK]>) to 10.0.12.141
2022-07-04 05:20:44.446718 (Thread-319): handling status request
2022-07-04 05:20:44.447128 (Thread-319): 05:20:44  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '08022227-1dd0-4d09-94f1-e256bf2507d1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb1100fd310>]}
2022-07-04 05:20:44.447626 (Thread-319): sending response (<Response 1703 bytes [200 OK]>) to 10.0.12.141
2022-07-04 05:20:57.721615 (Thread-320): handling status request
2022-07-04 05:20:57.722082 (Thread-320): 05:20:57  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '08022227-1dd0-4d09-94f1-e256bf2507d1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb0f0ec41c0>]}
2022-07-04 05:20:57.722553 (Thread-320): sending response (<Response 1703 bytes [200 OK]>) to 10.0.12.141
2022-07-04 05:20:58.086978 (Thread-321): handling run_sql request
2022-07-04 05:20:58.087428 (Thread-321): 05:20:58  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '08022227-1dd0-4d09-94f1-e256bf2507d1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb1100fd310>]}
2022-07-04 05:21:00.403758 (Thread-321): sending response (<Response 139 bytes [200 OK]>) to 10.0.12.141
2022-07-04 05:21:00.429018 (MainThread): 05:21:00  Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '325f8d87-a85c-4c9e-ade7-855c32a331f4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0d488cc9d0>]}
2022-07-04 05:21:00.429553 (MainThread): 05:21:00  Found 10 models, 0 tests, 0 snapshots, 0 analyses, 179 macros, 0 operations, 0 seed files, 15 sources, 0 exposures, 0 metrics
2022-07-04 05:21:00.430166 (Thread-1): 05:21:00  Acquiring new snowflake connection "rpc.ecommerce_data_model_dbt.request"
2022-07-04 05:21:00.430299 (Thread-1): 05:21:00  Began compiling node rpc.ecommerce_data_model_dbt.request
2022-07-04 05:21:00.430406 (Thread-1): 05:21:00  Compiling rpc.ecommerce_data_model_dbt.request
2022-07-04 05:21:00.432994 (Thread-1): 05:21:00  finished collecting timing info
2022-07-04 05:21:00.433125 (Thread-1): 05:21:00  Began executing node rpc.ecommerce_data_model_dbt.request
2022-07-04 05:21:00.434124 (Thread-1): 05:21:00  Using snowflake connection "rpc.ecommerce_data_model_dbt.request"
2022-07-04 05:21:00.434217 (Thread-1): 05:21:00  On rpc.ecommerce_data_model_dbt.request: /*
  This is your scratchpad.
  You can write and preview dbt code here without building it as a model or saving it as an analysis. 
  
  Tips for using the IDE:
  - Press [CTRL] + [Space] or type two underscores [__] to get common snippets of SQL, Jinja and YAML
  - Press [CTRL] + [O] to open a file picker
  - Press [F1] to get a list of keyboard shortcuts
  
  Press [CTRL] + [Enter] or click the 'Preview' button to see the results of the query.
  You can also review the generated SQL query in the 'Compiled SQL' tab.
  */
      select 1 as my_column
          union all 
      
      select 2 as my_column
          union all 
      
      select 3 as my_column
          union all 
      
      select 4 as my_column
          union all 
      
      select 5 as my_column
          union all 
      
      select 6 as my_column
          union all 
      
      select 7 as my_column
          union all 
      
      select 8 as my_column
          union all 
      
      select 9 as my_column
limit 500
/* limit added automatically by dbt cloud */
2022-07-04 05:21:00.434308 (Thread-1): 05:21:00  Opening a new connection, currently in state init
2022-07-04 05:21:00.784573 (Thread-322): handling poll request
2022-07-04 05:21:00.785052 (Thread-322): 05:21:00  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '08022227-1dd0-4d09-94f1-e256bf2507d1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb0f0e41fd0>]}
2022-07-04 05:21:00.785992 (Thread-322): sending response (<Response 4835 bytes [200 OK]>) to 10.0.12.141
2022-07-04 05:21:02.116141 (Thread-1): 05:21:02  SQL status: SUCCESS 9 in 1.68 seconds
2022-07-04 05:21:02.117651 (Thread-1): 05:21:02  finished collecting timing info
2022-07-04 05:21:02.117830 (Thread-1): 05:21:02  On rpc.ecommerce_data_model_dbt.request: Close
2022-07-04 05:21:02.181983 (Thread-323): handling poll request
2022-07-04 05:21:02.182383 (Thread-323): 05:21:02  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '08022227-1dd0-4d09-94f1-e256bf2507d1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb0f0e41550>]}
2022-07-04 05:21:02.182948 (Thread-323): sending response (<Response 1390 bytes [200 OK]>) to 10.0.12.141
2022-07-04 05:21:03.598127 (Thread-324): handling poll request
2022-07-04 05:21:03.598540 (Thread-324): 05:21:03  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '08022227-1dd0-4d09-94f1-e256bf2507d1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb0f0e452b0>]}
2022-07-04 05:21:03.599478 (Thread-324): sending response (<Response 5923 bytes [200 OK]>) to 10.0.12.141
2022-07-04 05:21:13.254639 (Thread-325): 05:21:13  Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
2022-07-04 05:21:13.254888 (Thread-325): 05:21:13  Partial parsing enabled, no changes found, skipping parsing
2022-07-04 05:21:13.255505 (Thread-325): 05:21:13  [WARNING]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.data-apps-ecommerce-template.data_model

2022-07-04 05:21:13.261765 (Thread-325): 05:21:13  Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '08022227-1dd0-4d09-94f1-e256bf2507d1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb0f0e3f7c0>]}
2022-07-04 05:21:14.016543 (Thread-326): handling status request
2022-07-04 05:21:14.016962 (Thread-326): 05:21:14  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '08022227-1dd0-4d09-94f1-e256bf2507d1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb0f0df3df0>]}
2022-07-04 05:21:14.017471 (Thread-326): sending response (<Response 1703 bytes [200 OK]>) to 10.0.12.141
2022-07-04 05:21:14.054395 (Thread-327): handling status request
2022-07-04 05:21:14.054845 (Thread-327): 05:21:14  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '08022227-1dd0-4d09-94f1-e256bf2507d1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb0f0df3ca0>]}
2022-07-04 05:21:14.075500 (Thread-327): sending response (<Response 1703 bytes [200 OK]>) to 10.0.12.141
2022-07-04 05:21:29.513617 (Thread-328): 05:21:29  Partial parsing enabled: 0 files deleted, 1 files added, 0 files changed.
2022-07-04 05:21:29.514056 (Thread-328): 05:21:29  Partial parsing: added file: ecommerce_data_model_dbt://models/data_model/temp_folder/is_member.sql
2022-07-04 05:21:29.518733 (Thread-328): 05:21:29  1699: static parser successfully parsed data_model/temp_folder/is_member.sql
2022-07-04 05:21:29.558483 (Thread-328): 05:21:29  [WARNING]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.data-apps-ecommerce-template.data_model

2022-07-04 05:21:29.563720 (Thread-328): 05:21:29  Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '08022227-1dd0-4d09-94f1-e256bf2507d1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb0f0d34040>]}
2022-07-04 05:21:30.382636 (Thread-329): handling status request
2022-07-04 05:21:30.383042 (Thread-329): 05:21:30  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '08022227-1dd0-4d09-94f1-e256bf2507d1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb11008f160>]}
2022-07-04 05:21:30.383604 (Thread-329): sending response (<Response 2061 bytes [200 OK]>) to 10.0.12.141
2022-07-04 05:21:30.384799 (Thread-330): handling status request
2022-07-04 05:21:30.385230 (Thread-330): 05:21:30  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '08022227-1dd0-4d09-94f1-e256bf2507d1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb0f0f58160>]}
2022-07-04 05:21:30.385676 (Thread-330): sending response (<Response 2061 bytes [200 OK]>) to 10.0.12.141
2022-07-04 05:25:51.490756 (Thread-331): handling status request
2022-07-04 05:25:51.491817 (Thread-331): 05:25:51  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '08022227-1dd0-4d09-94f1-e256bf2507d1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb0f0e41760>]}
2022-07-04 05:25:51.492329 (Thread-331): sending response (<Response 2061 bytes [200 OK]>) to 10.0.12.141
2022-07-04 05:25:51.888758 (Thread-332): handling run_sql request
2022-07-04 05:25:51.889197 (Thread-332): 05:25:51  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '08022227-1dd0-4d09-94f1-e256bf2507d1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb0f0e45610>]}
2022-07-04 05:25:54.228656 (Thread-332): sending response (<Response 139 bytes [200 OK]>) to 10.0.12.141
2022-07-04 05:25:54.255665 (MainThread): 05:25:54  Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'acb25d42-b771-4744-a031-8413a8b35bc3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f91bee23d60>]}
2022-07-04 05:25:54.256270 (MainThread): 05:25:54  Found 11 models, 0 tests, 0 snapshots, 0 analyses, 179 macros, 0 operations, 0 seed files, 15 sources, 0 exposures, 0 metrics
2022-07-04 05:25:54.256948 (Thread-1): 05:25:54  Acquiring new snowflake connection "rpc.ecommerce_data_model_dbt.request"
2022-07-04 05:25:54.257092 (Thread-1): 05:25:54  Began compiling node rpc.ecommerce_data_model_dbt.request
2022-07-04 05:25:54.257187 (Thread-1): 05:25:54  Compiling rpc.ecommerce_data_model_dbt.request
2022-07-04 05:25:54.260020 (Thread-1): 05:25:54  finished collecting timing info
2022-07-04 05:25:54.260166 (Thread-1): 05:25:54  Began executing node rpc.ecommerce_data_model_dbt.request
2022-07-04 05:25:54.260938 (Thread-1): 05:25:54  Using snowflake connection "rpc.ecommerce_data_model_dbt.request"
2022-07-04 05:25:54.261032 (Thread-1): 05:25:54  On rpc.ecommerce_data_model_dbt.request: select user_id, properties_is_member as is_member, row_number() over(partition by user_id order by timestamp desc) as rn from 
analytics_db.data_apps_simulated.identifies where timestamp >= '2021-05-01' and timestamp <= '2022-06-29'
and is_member is not null and is_member != ''
limit 500
/* limit added automatically by dbt cloud */
2022-07-04 05:25:54.261116 (Thread-1): 05:25:54  Opening a new connection, currently in state init
2022-07-04 05:25:54.619970 (Thread-333): handling poll request
2022-07-04 05:25:54.620502 (Thread-333): 05:25:54  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '08022227-1dd0-4d09-94f1-e256bf2507d1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb0f0e47160>]}
2022-07-04 05:25:54.621420 (Thread-333): sending response (<Response 4078 bytes [200 OK]>) to 10.0.12.141
2022-07-04 05:25:55.391421 (Thread-1): 05:25:55  Snowflake adapter: Snowflake query id: 01a55fe5-0602-3256-0019-82030465bdca
2022-07-04 05:25:55.391615 (Thread-1): 05:25:55  Snowflake adapter: Snowflake error: 100037 (22018): Boolean value '' is not recognized
2022-07-04 05:25:55.391784 (Thread-1): 05:25:55  finished collecting timing info
2022-07-04 05:25:55.391946 (Thread-1): 05:25:55  On rpc.ecommerce_data_model_dbt.request: Close
2022-07-04 05:25:55.451094 (Thread-1): Got an exception: Database Error
  100037 (22018): Boolean value '' is not recognized
Traceback (most recent call last):
  File "/usr/local/lib/python3.8/dist-packages/dbt/adapters/snowflake/connections.py", line 206, in exception_handler
    yield
  File "/usr/local/lib/python3.8/dist-packages/dbt/adapters/sql/connections.py", line 74, in add_query
    cursor.execute(sql, bindings)
  File "/usr/local/lib/python3.8/dist-packages/snowflake/connector/cursor.py", line 721, in execute
    Error.errorhandler_wrapper(
  File "/usr/local/lib/python3.8/dist-packages/snowflake/connector/errors.py", line 258, in errorhandler_wrapper
    cursor.errorhandler(connection, cursor, error_class, error_value)
  File "/usr/local/lib/python3.8/dist-packages/snowflake/connector/errors.py", line 188, in default_errorhandler
    raise error_class(
snowflake.connector.errors.ProgrammingError: 100037 (22018): Boolean value '' is not recognized

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/usr/local/lib/python3.8/dist-packages/dbt/task/base.py", line 361, in safe_run
    result = self.compile_and_execute(manifest, ctx)
  File "/usr/local/lib/python3.8/dist-packages/dbt/task/base.py", line 314, in compile_and_execute
    result = self.run(ctx.node, manifest)
  File "/usr/local/lib/python3.8/dist-packages/dbt/task/base.py", line 403, in run
    return self.execute(compiled_node, manifest)
  File "/usr/local/lib/python3.8/dist-packages/dbt_rpc/rpc/node_runners.py", line 90, in execute
    _, execute_result = self.adapter.execute(
  File "/usr/local/lib/python3.8/dist-packages/dbt/adapters/base/impl.py", line 225, in execute
    return self.connections.execute(
  File "/usr/local/lib/python3.8/dist-packages/dbt/adapters/sql/connections.py", line 127, in execute
    _, cursor = self.add_query(sql, auto_begin)
  File "/usr/local/lib/python3.8/dist-packages/dbt/adapters/snowflake/connections.py", line 433, in add_query
    connection, cursor = super().add_query(
  File "/usr/local/lib/python3.8/dist-packages/dbt/adapters/sql/connections.py", line 83, in add_query
    return connection, cursor
  File "/usr/lib/python3.8/contextlib.py", line 131, in __exit__
    self.gen.throw(type, value, traceback)
  File "/usr/local/lib/python3.8/dist-packages/dbt/adapters/snowflake/connections.py", line 223, in exception_handler
    raise DatabaseException(msg)
dbt.exceptions.DatabaseException: Database Error
  100037 (22018): Boolean value '' is not recognized
2022-07-04 05:25:55.452013 (Thread-1): Got exception RPCException(10003, Database Error, {'type': 'DatabaseException', 'message': "Database Error in rpc request (from remote system)\n  100037 (22018): Boolean value '' is not recognized", 'raw_sql': "select user_id, properties_is_member as is_member, row_number() over(partition by user_id order by timestamp desc) as rn from \r\n{{ source('ecommerce', 'identifies') }} where timestamp >= '{{ var('start_date') }}' and timestamp <= '{{ var('end_date') }}'\r\nand is_member is not null and is_member != ''\nlimit 500\n/* limit added automatically by dbt cloud */", 'compiled_sql': "select user_id, properties_is_member as is_member, row_number() over(partition by user_id order by timestamp desc) as rn from \nanalytics_db.data_apps_simulated.identifies where timestamp >= '2021-05-01' and timestamp <= '2022-06-29'\nand is_member is not null and is_member != ''\nlimit 500\n/* limit added automatically by dbt cloud */", 'tags': None}, None)
Traceback (most recent call last):
  File "/usr/local/lib/python3.8/dist-packages/dbt_rpc/task/sql_commands.py", line 147, in _in_thread
    self.node_results.append(runner.safe_run(self.manifest))
  File "/usr/local/lib/python3.8/dist-packages/dbt/task/base.py", line 377, in safe_run
    result = self.error_result(ctx.node, error, started, [])
  File "/usr/local/lib/python3.8/dist-packages/dbt_rpc/rpc/node_runners.py", line 56, in error_result
    raise error
dbt_rpc.rpc.error.RPCException: RPCException(10003, Database Error, {'type': 'DatabaseException', 'message': "Database Error in rpc request (from remote system)\n  100037 (22018): Boolean value '' is not recognized", 'raw_sql': "select user_id, properties_is_member as is_member, row_number() over(partition by user_id order by timestamp desc) as rn from \r\n{{ source('ecommerce', 'identifies') }} where timestamp >= '{{ var('start_date') }}' and timestamp <= '{{ var('end_date') }}'\r\nand is_member is not null and is_member != ''\nlimit 500\n/* limit added automatically by dbt cloud */", 'compiled_sql': "select user_id, properties_is_member as is_member, row_number() over(partition by user_id order by timestamp desc) as rn from \nanalytics_db.data_apps_simulated.identifies where timestamp >= '2021-05-01' and timestamp <= '2022-06-29'\nand is_member is not null and is_member != ''\nlimit 500\n/* limit added automatically by dbt cloud */", 'tags': None}, None)
2022-07-04 05:25:55.988552 (Thread-334): handling poll request
2022-07-04 05:25:55.988951 (Thread-334): 05:25:55  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '08022227-1dd0-4d09-94f1-e256bf2507d1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb0f0d15d90>]}
2022-07-04 05:25:55.989603 (Thread-334): sending response (<Response 11511 bytes [200 OK]>) to 10.0.12.141
2022-07-04 05:26:19.025337 (Thread-335): handling status request
2022-07-04 05:26:19.025760 (Thread-335): 05:26:19  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '08022227-1dd0-4d09-94f1-e256bf2507d1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb0f0d151f0>]}
2022-07-04 05:26:19.026356 (Thread-335): sending response (<Response 2061 bytes [200 OK]>) to 10.0.12.141
2022-07-04 05:26:19.398990 (Thread-336): handling run_sql request
2022-07-04 05:26:19.399406 (Thread-336): 05:26:19  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '08022227-1dd0-4d09-94f1-e256bf2507d1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb0f0d156a0>]}
2022-07-04 05:26:21.772026 (Thread-336): sending response (<Response 139 bytes [200 OK]>) to 10.0.12.141
2022-07-04 05:26:21.797874 (MainThread): 05:26:21  Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '85047295-dff6-4ac8-b2a1-0047fcd3be70', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fde4a74fdc0>]}
2022-07-04 05:26:21.798531 (MainThread): 05:26:21  Found 11 models, 0 tests, 0 snapshots, 0 analyses, 179 macros, 0 operations, 0 seed files, 15 sources, 0 exposures, 0 metrics
2022-07-04 05:26:21.799169 (Thread-1): 05:26:21  Acquiring new snowflake connection "rpc.ecommerce_data_model_dbt.request"
2022-07-04 05:26:21.799304 (Thread-1): 05:26:21  Began compiling node rpc.ecommerce_data_model_dbt.request
2022-07-04 05:26:21.799403 (Thread-1): 05:26:21  Compiling rpc.ecommerce_data_model_dbt.request
2022-07-04 05:26:21.802017 (Thread-1): 05:26:21  finished collecting timing info
2022-07-04 05:26:21.802151 (Thread-1): 05:26:21  Began executing node rpc.ecommerce_data_model_dbt.request
2022-07-04 05:26:21.802926 (Thread-1): 05:26:21  Using snowflake connection "rpc.ecommerce_data_model_dbt.request"
2022-07-04 05:26:21.803019 (Thread-1): 05:26:21  On rpc.ecommerce_data_model_dbt.request: select user_id, properties_is_member as is_member, row_number() over(partition by user_id order by timestamp desc) as rn from 
analytics_db.data_apps_simulated.identifies where timestamp >= '2021-05-01' and timestamp <= '2022-06-29'
and is_member is not null and is_member != '') where rn = 1
limit 500
/* limit added automatically by dbt cloud */
2022-07-04 05:26:21.803101 (Thread-1): 05:26:21  Opening a new connection, currently in state init
2022-07-04 05:26:22.142510 (Thread-337): handling poll request
2022-07-04 05:26:22.143005 (Thread-337): 05:26:22  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '08022227-1dd0-4d09-94f1-e256bf2507d1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb0f0d943d0>]}
2022-07-04 05:26:22.143861 (Thread-337): sending response (<Response 4091 bytes [200 OK]>) to 10.0.12.141
2022-07-04 05:26:22.505854 (Thread-1): 05:26:22  Snowflake adapter: Snowflake query id: 01a55fe6-0602-3238-0019-82030465e0e2
2022-07-04 05:26:22.506079 (Thread-1): 05:26:22  Snowflake adapter: Snowflake error: 001003 (42000): SQL compilation error:
syntax error line 3 at position 45 unexpected ')'.
2022-07-04 05:26:22.506244 (Thread-1): 05:26:22  finished collecting timing info
2022-07-04 05:26:22.506399 (Thread-1): 05:26:22  On rpc.ecommerce_data_model_dbt.request: Close
2022-07-04 05:26:22.560575 (Thread-1): Got an exception: Database Error
  001003 (42000): SQL compilation error:
  syntax error line 3 at position 45 unexpected ')'.
Traceback (most recent call last):
  File "/usr/local/lib/python3.8/dist-packages/dbt/adapters/snowflake/connections.py", line 206, in exception_handler
    yield
  File "/usr/local/lib/python3.8/dist-packages/dbt/adapters/sql/connections.py", line 74, in add_query
    cursor.execute(sql, bindings)
  File "/usr/local/lib/python3.8/dist-packages/snowflake/connector/cursor.py", line 721, in execute
    Error.errorhandler_wrapper(
  File "/usr/local/lib/python3.8/dist-packages/snowflake/connector/errors.py", line 258, in errorhandler_wrapper
    cursor.errorhandler(connection, cursor, error_class, error_value)
  File "/usr/local/lib/python3.8/dist-packages/snowflake/connector/errors.py", line 188, in default_errorhandler
    raise error_class(
snowflake.connector.errors.ProgrammingError: 001003 (42000): SQL compilation error:
syntax error line 3 at position 45 unexpected ')'.

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/usr/local/lib/python3.8/dist-packages/dbt/task/base.py", line 361, in safe_run
    result = self.compile_and_execute(manifest, ctx)
  File "/usr/local/lib/python3.8/dist-packages/dbt/task/base.py", line 314, in compile_and_execute
    result = self.run(ctx.node, manifest)
  File "/usr/local/lib/python3.8/dist-packages/dbt/task/base.py", line 403, in run
    return self.execute(compiled_node, manifest)
  File "/usr/local/lib/python3.8/dist-packages/dbt_rpc/rpc/node_runners.py", line 90, in execute
    _, execute_result = self.adapter.execute(
  File "/usr/local/lib/python3.8/dist-packages/dbt/adapters/base/impl.py", line 225, in execute
    return self.connections.execute(
  File "/usr/local/lib/python3.8/dist-packages/dbt/adapters/sql/connections.py", line 127, in execute
    _, cursor = self.add_query(sql, auto_begin)
  File "/usr/local/lib/python3.8/dist-packages/dbt/adapters/snowflake/connections.py", line 433, in add_query
    connection, cursor = super().add_query(
  File "/usr/local/lib/python3.8/dist-packages/dbt/adapters/sql/connections.py", line 83, in add_query
    return connection, cursor
  File "/usr/lib/python3.8/contextlib.py", line 131, in __exit__
    self.gen.throw(type, value, traceback)
  File "/usr/local/lib/python3.8/dist-packages/dbt/adapters/snowflake/connections.py", line 223, in exception_handler
    raise DatabaseException(msg)
dbt.exceptions.DatabaseException: Database Error
  001003 (42000): SQL compilation error:
  syntax error line 3 at position 45 unexpected ')'.
2022-07-04 05:26:22.561503 (Thread-1): Got exception RPCException(10003, Database Error, {'type': 'DatabaseException', 'message': "Database Error in rpc request (from remote system)\n  001003 (42000): SQL compilation error:\n  syntax error line 3 at position 45 unexpected ')'.", 'raw_sql': "select user_id, properties_is_member as is_member, row_number() over(partition by user_id order by timestamp desc) as rn from \r\n{{ source('ecommerce', 'identifies') }} where timestamp >= '{{ var('start_date') }}' and timestamp <= '{{ var('end_date') }}'\r\nand is_member is not null and is_member != '') where rn = 1\nlimit 500\n/* limit added automatically by dbt cloud */", 'compiled_sql': "select user_id, properties_is_member as is_member, row_number() over(partition by user_id order by timestamp desc) as rn from \nanalytics_db.data_apps_simulated.identifies where timestamp >= '2021-05-01' and timestamp <= '2022-06-29'\nand is_member is not null and is_member != '') where rn = 1\nlimit 500\n/* limit added automatically by dbt cloud */", 'tags': None}, None)
Traceback (most recent call last):
  File "/usr/local/lib/python3.8/dist-packages/dbt_rpc/task/sql_commands.py", line 147, in _in_thread
    self.node_results.append(runner.safe_run(self.manifest))
  File "/usr/local/lib/python3.8/dist-packages/dbt/task/base.py", line 377, in safe_run
    result = self.error_result(ctx.node, error, started, [])
  File "/usr/local/lib/python3.8/dist-packages/dbt_rpc/rpc/node_runners.py", line 56, in error_result
    raise error
dbt_rpc.rpc.error.RPCException: RPCException(10003, Database Error, {'type': 'DatabaseException', 'message': "Database Error in rpc request (from remote system)\n  001003 (42000): SQL compilation error:\n  syntax error line 3 at position 45 unexpected ')'.", 'raw_sql': "select user_id, properties_is_member as is_member, row_number() over(partition by user_id order by timestamp desc) as rn from \r\n{{ source('ecommerce', 'identifies') }} where timestamp >= '{{ var('start_date') }}' and timestamp <= '{{ var('end_date') }}'\r\nand is_member is not null and is_member != '') where rn = 1\nlimit 500\n/* limit added automatically by dbt cloud */", 'compiled_sql': "select user_id, properties_is_member as is_member, row_number() over(partition by user_id order by timestamp desc) as rn from \nanalytics_db.data_apps_simulated.identifies where timestamp >= '2021-05-01' and timestamp <= '2022-06-29'\nand is_member is not null and is_member != '') where rn = 1\nlimit 500\n/* limit added automatically by dbt cloud */", 'tags': None}, None)
2022-07-04 05:26:23.552145 (Thread-338): handling poll request
2022-07-04 05:26:23.552559 (Thread-338): 05:26:23  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '08022227-1dd0-4d09-94f1-e256bf2507d1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb0f0d94340>]}
2022-07-04 05:26:23.553250 (Thread-338): sending response (<Response 11901 bytes [200 OK]>) to 10.0.12.141
2022-07-04 05:27:16.149534 (Thread-339): handling status request
2022-07-04 05:27:16.150035 (Thread-339): 05:27:16  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '08022227-1dd0-4d09-94f1-e256bf2507d1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb0f0df39a0>]}
2022-07-04 05:27:16.150583 (Thread-339): sending response (<Response 2061 bytes [200 OK]>) to 10.0.12.141
2022-07-04 05:27:16.553664 (Thread-340): handling run_sql request
2022-07-04 05:27:16.554093 (Thread-340): 05:27:16  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '08022227-1dd0-4d09-94f1-e256bf2507d1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb0f0ec46d0>]}
2022-07-04 05:27:18.872031 (Thread-340): sending response (<Response 139 bytes [200 OK]>) to 10.0.12.141
2022-07-04 05:27:18.898552 (MainThread): 05:27:18  Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '75ccc2e1-b224-42cb-9caf-ab98254ee7d2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc4d8c49dc0>]}
2022-07-04 05:27:18.899109 (MainThread): 05:27:18  Found 11 models, 0 tests, 0 snapshots, 0 analyses, 179 macros, 0 operations, 0 seed files, 15 sources, 0 exposures, 0 metrics
2022-07-04 05:27:18.899729 (Thread-1): 05:27:18  Acquiring new snowflake connection "rpc.ecommerce_data_model_dbt.request"
2022-07-04 05:27:18.899862 (Thread-1): 05:27:18  Began compiling node rpc.ecommerce_data_model_dbt.request
2022-07-04 05:27:18.899961 (Thread-1): 05:27:18  Compiling rpc.ecommerce_data_model_dbt.request
2022-07-04 05:27:18.902469 (Thread-1): 05:27:18  finished collecting timing info
2022-07-04 05:27:18.902598 (Thread-1): 05:27:18  Began executing node rpc.ecommerce_data_model_dbt.request
2022-07-04 05:27:18.903416 (Thread-1): 05:27:18  Using snowflake connection "rpc.ecommerce_data_model_dbt.request"
2022-07-04 05:27:18.903514 (Thread-1): 05:27:18  On rpc.ecommerce_data_model_dbt.request: select user_id, is_member from
(select user_id, properties_is_member as is_member, row_number() over(partition by user_id order by timestamp desc) as rn from 
analytics_db.data_apps_simulated.identifies where timestamp >= '2021-05-01' and timestamp <= '2022-06-29'
and is_member is not null and is_member != '') where rn = 1
limit 500
/* limit added automatically by dbt cloud */
2022-07-04 05:27:18.903595 (Thread-1): 05:27:18  Opening a new connection, currently in state init
2022-07-04 05:27:19.271802 (Thread-341): handling poll request
2022-07-04 05:27:19.272300 (Thread-341): 05:27:19  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '08022227-1dd0-4d09-94f1-e256bf2507d1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb0f0ee69a0>]}
2022-07-04 05:27:19.273205 (Thread-341): sending response (<Response 4125 bytes [200 OK]>) to 10.0.12.141
2022-07-04 05:27:19.927674 (Thread-1): 05:27:19  Snowflake adapter: Snowflake query id: 01a55fe7-0602-327e-0019-82030465ccd2
2022-07-04 05:27:19.927874 (Thread-1): 05:27:19  Snowflake adapter: Snowflake error: 100037 (22018): Boolean value '' is not recognized
2022-07-04 05:27:19.928037 (Thread-1): 05:27:19  finished collecting timing info
2022-07-04 05:27:19.928192 (Thread-1): 05:27:19  On rpc.ecommerce_data_model_dbt.request: Close
2022-07-04 05:27:19.993602 (Thread-1): Got an exception: Database Error
  100037 (22018): Boolean value '' is not recognized
Traceback (most recent call last):
  File "/usr/local/lib/python3.8/dist-packages/dbt/adapters/snowflake/connections.py", line 206, in exception_handler
    yield
  File "/usr/local/lib/python3.8/dist-packages/dbt/adapters/sql/connections.py", line 74, in add_query
    cursor.execute(sql, bindings)
  File "/usr/local/lib/python3.8/dist-packages/snowflake/connector/cursor.py", line 721, in execute
    Error.errorhandler_wrapper(
  File "/usr/local/lib/python3.8/dist-packages/snowflake/connector/errors.py", line 258, in errorhandler_wrapper
    cursor.errorhandler(connection, cursor, error_class, error_value)
  File "/usr/local/lib/python3.8/dist-packages/snowflake/connector/errors.py", line 188, in default_errorhandler
    raise error_class(
snowflake.connector.errors.ProgrammingError: 100037 (22018): Boolean value '' is not recognized

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/usr/local/lib/python3.8/dist-packages/dbt/task/base.py", line 361, in safe_run
    result = self.compile_and_execute(manifest, ctx)
  File "/usr/local/lib/python3.8/dist-packages/dbt/task/base.py", line 314, in compile_and_execute
    result = self.run(ctx.node, manifest)
  File "/usr/local/lib/python3.8/dist-packages/dbt/task/base.py", line 403, in run
    return self.execute(compiled_node, manifest)
  File "/usr/local/lib/python3.8/dist-packages/dbt_rpc/rpc/node_runners.py", line 90, in execute
    _, execute_result = self.adapter.execute(
  File "/usr/local/lib/python3.8/dist-packages/dbt/adapters/base/impl.py", line 225, in execute
    return self.connections.execute(
  File "/usr/local/lib/python3.8/dist-packages/dbt/adapters/sql/connections.py", line 127, in execute
    _, cursor = self.add_query(sql, auto_begin)
  File "/usr/local/lib/python3.8/dist-packages/dbt/adapters/snowflake/connections.py", line 433, in add_query
    connection, cursor = super().add_query(
  File "/usr/local/lib/python3.8/dist-packages/dbt/adapters/sql/connections.py", line 83, in add_query
    return connection, cursor
  File "/usr/lib/python3.8/contextlib.py", line 131, in __exit__
    self.gen.throw(type, value, traceback)
  File "/usr/local/lib/python3.8/dist-packages/dbt/adapters/snowflake/connections.py", line 223, in exception_handler
    raise DatabaseException(msg)
dbt.exceptions.DatabaseException: Database Error
  100037 (22018): Boolean value '' is not recognized
2022-07-04 05:27:19.994593 (Thread-1): Got exception RPCException(10003, Database Error, {'type': 'DatabaseException', 'message': "Database Error in rpc request (from remote system)\n  100037 (22018): Boolean value '' is not recognized", 'raw_sql': "select user_id, is_member from\r\n(select user_id, properties_is_member as is_member, row_number() over(partition by user_id order by timestamp desc) as rn from \r\n{{ source('ecommerce', 'identifies') }} where timestamp >= '{{ var('start_date') }}' and timestamp <= '{{ var('end_date') }}'\r\nand is_member is not null and is_member != '') where rn = 1\nlimit 500\n/* limit added automatically by dbt cloud */", 'compiled_sql': "select user_id, is_member from\n(select user_id, properties_is_member as is_member, row_number() over(partition by user_id order by timestamp desc) as rn from \nanalytics_db.data_apps_simulated.identifies where timestamp >= '2021-05-01' and timestamp <= '2022-06-29'\nand is_member is not null and is_member != '') where rn = 1\nlimit 500\n/* limit added automatically by dbt cloud */", 'tags': None}, None)
Traceback (most recent call last):
  File "/usr/local/lib/python3.8/dist-packages/dbt_rpc/task/sql_commands.py", line 147, in _in_thread
    self.node_results.append(runner.safe_run(self.manifest))
  File "/usr/local/lib/python3.8/dist-packages/dbt/task/base.py", line 377, in safe_run
    result = self.error_result(ctx.node, error, started, [])
  File "/usr/local/lib/python3.8/dist-packages/dbt_rpc/rpc/node_runners.py", line 56, in error_result
    raise error
dbt_rpc.rpc.error.RPCException: RPCException(10003, Database Error, {'type': 'DatabaseException', 'message': "Database Error in rpc request (from remote system)\n  100037 (22018): Boolean value '' is not recognized", 'raw_sql': "select user_id, is_member from\r\n(select user_id, properties_is_member as is_member, row_number() over(partition by user_id order by timestamp desc) as rn from \r\n{{ source('ecommerce', 'identifies') }} where timestamp >= '{{ var('start_date') }}' and timestamp <= '{{ var('end_date') }}'\r\nand is_member is not null and is_member != '') where rn = 1\nlimit 500\n/* limit added automatically by dbt cloud */", 'compiled_sql': "select user_id, is_member from\n(select user_id, properties_is_member as is_member, row_number() over(partition by user_id order by timestamp desc) as rn from \nanalytics_db.data_apps_simulated.identifies where timestamp >= '2021-05-01' and timestamp <= '2022-06-29'\nand is_member is not null and is_member != '') where rn = 1\nlimit 500\n/* limit added automatically by dbt cloud */", 'tags': None}, None)
2022-07-04 05:27:20.657476 (Thread-342): handling poll request
2022-07-04 05:27:20.657899 (Thread-342): 05:27:20  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '08022227-1dd0-4d09-94f1-e256bf2507d1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb0f0e3f610>]}
2022-07-04 05:27:20.658656 (Thread-342): sending response (<Response 11852 bytes [200 OK]>) to 10.0.12.141
2022-07-04 05:27:37.038286 (Thread-343): handling status request
2022-07-04 05:27:37.038728 (Thread-343): 05:27:37  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '08022227-1dd0-4d09-94f1-e256bf2507d1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb0f0d34280>]}
2022-07-04 05:27:37.039269 (Thread-343): sending response (<Response 2061 bytes [200 OK]>) to 10.0.12.141
2022-07-04 05:27:37.430434 (Thread-344): handling run_sql request
2022-07-04 05:27:37.430854 (Thread-344): 05:27:37  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '08022227-1dd0-4d09-94f1-e256bf2507d1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb0f0d34370>]}
2022-07-04 05:27:39.766239 (Thread-344): sending response (<Response 139 bytes [200 OK]>) to 10.0.12.141
2022-07-04 05:27:39.791692 (MainThread): 05:27:39  Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '8ef7ae08-1595-4be4-8088-cd3a57449511', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f170007cd00>]}
2022-07-04 05:27:39.792237 (MainThread): 05:27:39  Found 11 models, 0 tests, 0 snapshots, 0 analyses, 179 macros, 0 operations, 0 seed files, 15 sources, 0 exposures, 0 metrics
2022-07-04 05:27:39.792853 (Thread-1): 05:27:39  Acquiring new snowflake connection "rpc.ecommerce_data_model_dbt.request"
2022-07-04 05:27:39.792987 (Thread-1): 05:27:39  Began compiling node rpc.ecommerce_data_model_dbt.request
2022-07-04 05:27:39.793083 (Thread-1): 05:27:39  Compiling rpc.ecommerce_data_model_dbt.request
2022-07-04 05:27:39.795676 (Thread-1): 05:27:39  finished collecting timing info
2022-07-04 05:27:39.795807 (Thread-1): 05:27:39  Began executing node rpc.ecommerce_data_model_dbt.request
2022-07-04 05:27:39.796573 (Thread-1): 05:27:39  Using snowflake connection "rpc.ecommerce_data_model_dbt.request"
2022-07-04 05:27:39.796662 (Thread-1): 05:27:39  On rpc.ecommerce_data_model_dbt.request: select user_id, is_member from
(select user_id, properties_is_member as is_member, row_number() over(partition by user_id order by timestamp desc) as rn from 
analytics_db.data_apps_simulated.identifies where timestamp >= '2021-05-01' and timestamp <= '2022-06-29'
and is_member is not null) where rn = 1
limit 500
/* limit added automatically by dbt cloud */
2022-07-04 05:27:39.796743 (Thread-1): 05:27:39  Opening a new connection, currently in state init
2022-07-04 05:27:40.132777 (Thread-345): handling poll request
2022-07-04 05:27:40.133265 (Thread-345): 05:27:40  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '08022227-1dd0-4d09-94f1-e256bf2507d1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb0f0d32610>]}
2022-07-04 05:27:40.134196 (Thread-345): sending response (<Response 4105 bytes [200 OK]>) to 10.0.12.141
2022-07-04 05:27:40.732239 (Thread-1): 05:27:40  SQL status: SUCCESS 1 in 0.94 seconds
2022-07-04 05:27:40.733654 (Thread-1): 05:27:40  finished collecting timing info
2022-07-04 05:27:40.733837 (Thread-1): 05:27:40  On rpc.ecommerce_data_model_dbt.request: Close
2022-07-04 05:27:41.502480 (Thread-346): handling poll request
2022-07-04 05:27:41.502941 (Thread-346): 05:27:41  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '08022227-1dd0-4d09-94f1-e256bf2507d1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb0f0d32ac0>]}
2022-07-04 05:27:41.503950 (Thread-346): sending response (<Response 4749 bytes [200 OK]>) to 10.0.12.141
2022-07-04 05:27:47.193905 (Thread-347): 05:27:47  Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
2022-07-04 05:27:47.194424 (Thread-347): 05:27:47  Partial parsing: updated file: ecommerce_data_model_dbt://models/data_model/temp_folder/is_member.sql
2022-07-04 05:27:47.198697 (Thread-347): 05:27:47  1603: static parser failed on data_model/temp_folder/is_member.sql
2022-07-04 05:27:47.202875 (Thread-347): 05:27:47  1602: parser fallback to jinja rendering on data_model/temp_folder/is_member.sql
2022-07-04 05:27:47.241193 (Thread-347): 05:27:47  [WARNING]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.data-apps-ecommerce-template.data_model

2022-07-04 05:27:47.246640 (Thread-347): 05:27:47  Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '08022227-1dd0-4d09-94f1-e256bf2507d1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb0f0c99bb0>]}
2022-07-04 05:27:48.004879 (Thread-348): handling status request
2022-07-04 05:27:48.005286 (Thread-348): 05:27:48  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '08022227-1dd0-4d09-94f1-e256bf2507d1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb0f0e42a60>]}
2022-07-04 05:27:48.005813 (Thread-348): sending response (<Response 2375 bytes [200 OK]>) to 10.0.12.141
2022-07-04 05:27:48.028931 (Thread-349): handling status request
2022-07-04 05:27:48.029286 (Thread-349): 05:27:48  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '08022227-1dd0-4d09-94f1-e256bf2507d1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb0f0e42790>]}
2022-07-04 05:27:48.029763 (Thread-349): sending response (<Response 2375 bytes [200 OK]>) to 10.0.12.141
2022-07-04 05:29:30.714083 (Thread-350): 05:29:30  Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
2022-07-04 05:29:30.715251 (Thread-350): 05:29:30  Partial parsing: updated file: ecommerce_data_model_dbt://models/data_model/stg_user_traits.sql
2022-07-04 05:29:30.719461 (Thread-350): 05:29:30  1603: static parser failed on data_model/stg_user_traits.sql
2022-07-04 05:29:30.726511 (Thread-350): 05:29:30  1602: parser fallback to jinja rendering on data_model/stg_user_traits.sql
2022-07-04 05:29:30.760752 (Thread-350): 05:29:30  [WARNING]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.data-apps-ecommerce-template.data_model

2022-07-04 05:29:30.765625 (Thread-350): 05:29:30  Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '08022227-1dd0-4d09-94f1-e256bf2507d1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb0f0c47eb0>]}
2022-07-04 05:29:31.498889 (Thread-351): handling status request
2022-07-04 05:29:31.499339 (Thread-351): 05:29:31  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '08022227-1dd0-4d09-94f1-e256bf2507d1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb0f0ced910>]}
2022-07-04 05:29:31.499878 (Thread-351): sending response (<Response 2357 bytes [200 OK]>) to 10.0.12.141
2022-07-04 05:29:31.505702 (Thread-352): handling status request
2022-07-04 05:29:31.506043 (Thread-352): 05:29:31  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '08022227-1dd0-4d09-94f1-e256bf2507d1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb0f0ced730>]}
2022-07-04 05:29:31.506498 (Thread-352): sending response (<Response 2357 bytes [200 OK]>) to 10.0.12.141
2022-07-04 05:29:32.241131 (Thread-353): handling status request
2022-07-04 05:29:32.241548 (Thread-353): 05:29:32  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '08022227-1dd0-4d09-94f1-e256bf2507d1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb0f0ced2b0>]}
2022-07-04 05:29:32.242121 (Thread-353): sending response (<Response 2357 bytes [200 OK]>) to 10.0.12.141
2022-07-04 05:29:32.605472 (Thread-354): handling run_sql request
2022-07-04 05:29:32.605877 (Thread-354): 05:29:32  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '08022227-1dd0-4d09-94f1-e256bf2507d1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb0f0ced0d0>]}
2022-07-04 05:29:34.952594 (Thread-354): sending response (<Response 139 bytes [200 OK]>) to 10.0.12.141
2022-07-04 05:29:34.983108 (MainThread): 05:29:34  Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '571c778a-f99d-4b6d-bf76-d101e9bcf34c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8c756d1f70>]}
2022-07-04 05:29:34.983813 (MainThread): 05:29:34  Found 11 models, 0 tests, 0 snapshots, 0 analyses, 179 macros, 0 operations, 0 seed files, 15 sources, 0 exposures, 0 metrics
2022-07-04 05:29:34.984487 (Thread-1): 05:29:34  Acquiring new snowflake connection "rpc.ecommerce_data_model_dbt.request"
2022-07-04 05:29:34.984617 (Thread-1): 05:29:34  Began compiling node rpc.ecommerce_data_model_dbt.request
2022-07-04 05:29:34.984711 (Thread-1): 05:29:34  Compiling rpc.ecommerce_data_model_dbt.request
2022-07-04 05:29:34.990735 (Thread-1): 05:29:34  finished collecting timing info
2022-07-04 05:29:34.990868 (Thread-1): 05:29:34  Began executing node rpc.ecommerce_data_model_dbt.request
2022-07-04 05:29:34.994126 (Thread-1): 05:29:34  Using snowflake connection "rpc.ecommerce_data_model_dbt.request"
2022-07-04 05:29:34.994221 (Thread-1): 05:29:34  On rpc.ecommerce_data_model_dbt.request: with cte_gender as 
(select user_id, gender from 
(select user_id, properties_gender as gender, row_number() over(partition by user_id order by timestamp desc) as rn from 
analytics_db.data_apps_simulated.identifies where timestamp >= '2021-05-01' and timestamp <= '2022-06-29'
and properties_gender is not null and properties_gender != '') where rn = 1),

cte_age as 
(select user_id, age from
(select user_id, 
(CASE WHEN dateadd(year, datediff (year, properties_birthday, getdate()), properties_birthday) > getdate()
      THEN datediff(year, properties_birthday, getdate()) - 1
      ELSE datediff(year, properties_birthday, getdate())
 END) as age, row_number() over(partition by user_id order by timestamp desc) as rn 
from analytics_db.data_apps_simulated.identifies where timestamp >= '2021-05-01' and timestamp <= '2022-06-29'
and properties_birthday is not null and properties_birthday!='') where rn = 1),

cte_country as 
(select user_id, country from 
(select user_id, properties_country as country, row_number() over(partition by user_id order by timestamp desc) as rn from 
analytics_db.data_apps_simulated.identifies where timestamp >= '2021-05-01' and timestamp <= '2022-06-29'
and properties_country is not null and properties_country != '') where rn = 1),

cte_state as 
(select user_id, state from 
(select user_id, properties_state as state, row_number() over(partition by user_id order by timestamp desc) as rn from 
analytics_db.data_apps_simulated.identifies where timestamp >= '2021-05-01' and timestamp <= '2022-06-29'
and properties_state is not null and properties_state != '') where rn = 1),

cte_email_domain as 
(select user_id, email_domain from 
(select user_id, substring(properties_email, charindex( '@', properties_email) + 1, len(properties_email)) as email_domain, row_number() over(partition by user_id order by timestamp desc) as rn from 
analytics_db.data_apps_simulated.identifies where timestamp >= '2021-05-01' and timestamp <= '2022-06-29'
and properties_email is not null and properties_email != '') where rn = 1),

cte_is_member as 
(select user_id, is_member from
(select user_id, properties_is_member as is_member, row_number() over(partition by user_id order by timestamp desc) as rn from 
analytics_db.data_apps_simulated.identifies where timestamp >= '2021-05-01' and timestamp <= '2022-06-29'
and is_member is not null) where rn = 1)

select coalesce(a.user_id, b.user_id, c.user_id, d.user_id, e.user_id, f.user_id) 
as user_id, gender, age, country, state, email_domain, is_member
from ((((cte_gender a full outer join cte_age b on a.user_id = b.user_id) 
full outer join cte_country c on c.user_id = coalesce(a.user_id, b.user_id))
full outer join cte_state d on d.user_id = coalesce(a.user_id, b.user_id, c.user_id))
full outer join cte_email_domain e on e.user_id = coalesce(a.user_id, b.user_id, c.user_id,d.user_id))
full outer join cte_is_member f on f.user_id = coalesce(a.user_id, b.user_id, c.user_id,d.user_id, e.user_id)
limit 500
/* limit added automatically by dbt cloud */
2022-07-04 05:29:34.994303 (Thread-1): 05:29:34  Opening a new connection, currently in state init
2022-07-04 05:29:35.328755 (Thread-355): handling poll request
2022-07-04 05:29:35.329310 (Thread-355): 05:29:35  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '08022227-1dd0-4d09-94f1-e256bf2507d1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb0f0cc4790>]}
2022-07-04 05:29:35.330280 (Thread-355): sending response (<Response 6823 bytes [200 OK]>) to 10.0.12.141
2022-07-04 05:29:36.445021 (Thread-1): 05:29:36  SQL status: SUCCESS 5 in 1.45 seconds
2022-07-04 05:29:36.446639 (Thread-1): 05:29:36  finished collecting timing info
2022-07-04 05:29:36.446825 (Thread-1): 05:29:36  On rpc.ecommerce_data_model_dbt.request: Close
2022-07-04 05:29:36.695406 (Thread-356): handling poll request
2022-07-04 05:29:36.695840 (Thread-356): 05:29:36  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '08022227-1dd0-4d09-94f1-e256bf2507d1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb0f0cc4040>]}
2022-07-04 05:29:36.696411 (Thread-356): sending response (<Response 1387 bytes [200 OK]>) to 10.0.12.141
2022-07-04 05:29:38.094636 (Thread-357): handling poll request
2022-07-04 05:29:38.095047 (Thread-357): 05:29:38  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '08022227-1dd0-4d09-94f1-e256bf2507d1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb0f0c81f40>]}
2022-07-04 05:29:38.118015 (Thread-357): sending response (<Response 15609 bytes [200 OK]>) to 10.0.12.141
2022-07-04 05:30:18.964766 (Thread-358): 05:30:18  Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
2022-07-04 05:30:18.964987 (Thread-358): 05:30:18  Partial parsing enabled, no changes found, skipping parsing
2022-07-04 05:30:18.965570 (Thread-358): 05:30:18  [WARNING]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.data-apps-ecommerce-template.data_model

2022-07-04 05:30:18.971552 (Thread-358): 05:30:18  Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '08022227-1dd0-4d09-94f1-e256bf2507d1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb0f0c33940>]}
2022-07-04 05:30:19.773034 (Thread-359): handling status request
2022-07-04 05:30:19.773444 (Thread-359): 05:30:19  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '08022227-1dd0-4d09-94f1-e256bf2507d1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb0f0b90d90>]}
2022-07-04 05:30:19.773972 (Thread-359): sending response (<Response 1703 bytes [200 OK]>) to 10.0.12.141
2022-07-04 05:30:19.805621 (Thread-360): handling status request
2022-07-04 05:30:19.805997 (Thread-360): 05:30:19  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '08022227-1dd0-4d09-94f1-e256bf2507d1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb0f0b90c40>]}
2022-07-04 05:30:19.806452 (Thread-360): sending response (<Response 1703 bytes [200 OK]>) to 10.0.12.141
2022-07-04 05:30:34.650472 (Thread-361): 05:30:34  Partial parsing enabled: 0 files deleted, 1 files added, 0 files changed.
2022-07-04 05:30:34.650921 (Thread-361): 05:30:34  Partial parsing: added file: ecommerce_data_model_dbt://models/data_model/temp_folder/has_mobile_app.sql
2022-07-04 05:30:34.655691 (Thread-361): 05:30:34  1699: static parser successfully parsed data_model/temp_folder/has_mobile_app.sql
2022-07-04 05:30:34.693594 (Thread-361): 05:30:34  [WARNING]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.data-apps-ecommerce-template.data_model

2022-07-04 05:30:34.699191 (Thread-361): 05:30:34  Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '08022227-1dd0-4d09-94f1-e256bf2507d1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb0f0adb7c0>]}
2022-07-04 05:30:35.399916 (Thread-362): handling status request
2022-07-04 05:30:35.400320 (Thread-362): 05:30:35  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '08022227-1dd0-4d09-94f1-e256bf2507d1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb0f0c35be0>]}
2022-07-04 05:30:35.400826 (Thread-362): sending response (<Response 2071 bytes [200 OK]>) to 10.0.12.141
2022-07-04 05:30:35.442879 (Thread-363): handling status request
2022-07-04 05:30:35.443249 (Thread-363): 05:30:35  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '08022227-1dd0-4d09-94f1-e256bf2507d1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb0f0c354f0>]}
2022-07-04 05:30:35.443735 (Thread-363): sending response (<Response 2071 bytes [200 OK]>) to 10.0.12.141
2022-07-04 05:35:00.501269 (Thread-364): 05:35:00  Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
2022-07-04 05:35:00.502365 (Thread-364): 05:35:00  Partial parsing: updated file: ecommerce_data_model_dbt://models/data_model/temp_folder/has_mobile_app.sql
2022-07-04 05:35:00.506132 (Thread-364): 05:35:00  1603: static parser failed on data_model/temp_folder/has_mobile_app.sql
2022-07-04 05:35:00.509871 (Thread-364): 05:35:00  1602: parser fallback to jinja rendering on data_model/temp_folder/has_mobile_app.sql
2022-07-04 05:35:00.546982 (Thread-364): 05:35:00  [WARNING]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.data-apps-ecommerce-template.data_model

2022-07-04 05:35:00.554241 (Thread-364): 05:35:00  Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '08022227-1dd0-4d09-94f1-e256bf2507d1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb0f0eed610>]}
2022-07-04 05:35:01.108062 (Thread-365): handling status request
2022-07-04 05:35:01.108505 (Thread-365): 05:35:01  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '08022227-1dd0-4d09-94f1-e256bf2507d1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb0f0b950d0>]}
2022-07-04 05:35:01.109038 (Thread-365): sending response (<Response 2390 bytes [200 OK]>) to 10.0.12.141
2022-07-04 05:35:01.155616 (Thread-366): handling status request
2022-07-04 05:35:01.155967 (Thread-366): 05:35:01  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '08022227-1dd0-4d09-94f1-e256bf2507d1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb0f0b95340>]}
2022-07-04 05:35:01.156450 (Thread-366): sending response (<Response 2390 bytes [200 OK]>) to 10.0.12.141
2022-07-04 05:35:01.541790 (Thread-367): handling status request
2022-07-04 05:35:01.542225 (Thread-367): 05:35:01  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '08022227-1dd0-4d09-94f1-e256bf2507d1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb0f0cf0fa0>]}
2022-07-04 05:35:01.542710 (Thread-367): sending response (<Response 2390 bytes [200 OK]>) to 10.0.12.141
2022-07-04 05:35:01.925266 (Thread-368): handling run_sql request
2022-07-04 05:35:01.925723 (Thread-368): 05:35:01  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '08022227-1dd0-4d09-94f1-e256bf2507d1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb1602576d0>]}
2022-07-04 05:35:04.277536 (Thread-368): sending response (<Response 139 bytes [200 OK]>) to 10.0.12.141
2022-07-04 05:35:04.303846 (MainThread): 05:35:04  Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '9cef81a1-3f31-4694-9ada-52c098897615', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd8841d4190>]}
2022-07-04 05:35:04.304442 (MainThread): 05:35:04  Found 12 models, 0 tests, 0 snapshots, 0 analyses, 179 macros, 0 operations, 0 seed files, 15 sources, 0 exposures, 0 metrics
2022-07-04 05:35:04.305068 (Thread-1): 05:35:04  Acquiring new snowflake connection "rpc.ecommerce_data_model_dbt.request"
2022-07-04 05:35:04.305206 (Thread-1): 05:35:04  Began compiling node rpc.ecommerce_data_model_dbt.request
2022-07-04 05:35:04.305298 (Thread-1): 05:35:04  Compiling rpc.ecommerce_data_model_dbt.request
2022-07-04 05:35:04.307873 (Thread-1): 05:35:04  finished collecting timing info
2022-07-04 05:35:04.308008 (Thread-1): 05:35:04  Began executing node rpc.ecommerce_data_model_dbt.request
2022-07-04 05:35:04.308815 (Thread-1): 05:35:04  Using snowflake connection "rpc.ecommerce_data_model_dbt.request"
2022-07-04 05:35:04.308907 (Thread-1): 05:35:04  On rpc.ecommerce_data_model_dbt.request: select user_id, has_mobile_app from 
(select user_id, (TRUE) as has_mobile_app, row_number() over(partition by user_id order by timestamp desc) as rn from 
analytics_db.data_apps_simulated.identifies where timestamp >= '2021-05-01' and timestamp <= '2022-06-29'
and context_device_type = 'android' or context_device_type = 'iOS') where rn = 1
limit 500
/* limit added automatically by dbt cloud */
2022-07-04 05:35:04.308990 (Thread-1): 05:35:04  Opening a new connection, currently in state init
2022-07-04 05:35:04.672347 (Thread-369): handling poll request
2022-07-04 05:35:04.672856 (Thread-369): 05:35:04  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '08022227-1dd0-4d09-94f1-e256bf2507d1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb0f0b5f5b0>]}
2022-07-04 05:35:04.673838 (Thread-369): sending response (<Response 4148 bytes [200 OK]>) to 10.0.12.141
2022-07-04 05:35:05.280261 (Thread-1): 05:35:05  SQL status: SUCCESS 2 in 0.97 seconds
2022-07-04 05:35:05.281669 (Thread-1): 05:35:05  finished collecting timing info
2022-07-04 05:35:05.281845 (Thread-1): 05:35:05  On rpc.ecommerce_data_model_dbt.request: Close
2022-07-04 05:35:06.041997 (Thread-370): handling poll request
2022-07-04 05:35:06.042388 (Thread-370): 05:35:06  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '08022227-1dd0-4d09-94f1-e256bf2507d1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb0f0b5ffd0>]}
2022-07-04 05:35:06.043280 (Thread-370): sending response (<Response 4928 bytes [200 OK]>) to 10.0.12.141
2022-07-04 05:36:32.443604 (Thread-371): 05:36:32  Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
2022-07-04 05:36:32.445814 (Thread-371): 05:36:32  Partial parsing: updated file: ecommerce_data_model_dbt://models/data_model/temp_folder/has_mobile_app.sql
2022-07-04 05:36:32.450045 (Thread-371): 05:36:32  1603: static parser failed on data_model/temp_folder/has_mobile_app.sql
2022-07-04 05:36:32.454173 (Thread-371): 05:36:32  1602: parser fallback to jinja rendering on data_model/temp_folder/has_mobile_app.sql
2022-07-04 05:36:32.487592 (Thread-371): 05:36:32  [WARNING]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.data-apps-ecommerce-template.data_model

2022-07-04 05:36:32.493741 (Thread-371): 05:36:32  Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '08022227-1dd0-4d09-94f1-e256bf2507d1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb1102d4c40>]}
2022-07-04 05:36:33.214851 (Thread-372): handling status request
2022-07-04 05:36:33.215258 (Thread-372): 05:36:33  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '08022227-1dd0-4d09-94f1-e256bf2507d1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb0f0ce94c0>]}
2022-07-04 05:36:33.215782 (Thread-372): sending response (<Response 2390 bytes [200 OK]>) to 10.0.12.141
2022-07-04 05:36:33.256923 (Thread-373): handling status request
2022-07-04 05:36:33.257341 (Thread-373): 05:36:33  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '08022227-1dd0-4d09-94f1-e256bf2507d1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb0f0b5fa00>]}
2022-07-04 05:36:33.257852 (Thread-373): sending response (<Response 2390 bytes [200 OK]>) to 10.0.12.141
2022-07-04 05:36:33.817518 (Thread-374): handling status request
2022-07-04 05:36:33.817953 (Thread-374): 05:36:33  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '08022227-1dd0-4d09-94f1-e256bf2507d1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb0f0b5fbe0>]}
2022-07-04 05:36:33.818460 (Thread-374): sending response (<Response 2390 bytes [200 OK]>) to 10.0.12.141
2022-07-04 05:36:34.246622 (Thread-375): handling run_sql request
2022-07-04 05:36:34.247056 (Thread-375): 05:36:34  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '08022227-1dd0-4d09-94f1-e256bf2507d1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb0f0c2eaf0>]}
2022-07-04 05:36:36.561525 (Thread-375): sending response (<Response 139 bytes [200 OK]>) to 10.0.12.141
2022-07-04 05:36:36.586597 (MainThread): 05:36:36  Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '7d8ee405-fc2f-4148-a0a7-84172b8046f9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc2c58ab1c0>]}
2022-07-04 05:36:36.587162 (MainThread): 05:36:36  Found 12 models, 0 tests, 0 snapshots, 0 analyses, 179 macros, 0 operations, 0 seed files, 15 sources, 0 exposures, 0 metrics
2022-07-04 05:36:36.587771 (Thread-1): 05:36:36  Acquiring new snowflake connection "rpc.ecommerce_data_model_dbt.request"
2022-07-04 05:36:36.587909 (Thread-1): 05:36:36  Began compiling node rpc.ecommerce_data_model_dbt.request
2022-07-04 05:36:36.588008 (Thread-1): 05:36:36  Compiling rpc.ecommerce_data_model_dbt.request
2022-07-04 05:36:36.590694 (Thread-1): 05:36:36  finished collecting timing info
2022-07-04 05:36:36.590828 (Thread-1): 05:36:36  Began executing node rpc.ecommerce_data_model_dbt.request
2022-07-04 05:36:36.591729 (Thread-1): 05:36:36  Using snowflake connection "rpc.ecommerce_data_model_dbt.request"
2022-07-04 05:36:36.591821 (Thread-1): 05:36:36  On rpc.ecommerce_data_model_dbt.request: select user_id, has_mobile_app from 
(select user_id, 
(CASE WHEN context_device_type = 'android' or context_device_type = 'iOS'
      THEN TRUE
      ELSE FALSE
END) as has_mobile_app, row_number() over(partition by user_id order by timestamp desc) as rn from 
analytics_db.data_apps_simulated.identifies where timestamp >= '2021-05-01' and timestamp <= '2022-06-29'
and context_device_type is not null and context_device_type != '') where rn = 1
limit 500
/* limit added automatically by dbt cloud */
2022-07-04 05:36:36.591906 (Thread-1): 05:36:36  Opening a new connection, currently in state init
2022-07-04 05:36:36.923034 (Thread-376): handling poll request
2022-07-04 05:36:36.923504 (Thread-376): 05:36:36  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '08022227-1dd0-4d09-94f1-e256bf2507d1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb0f0e67a60>]}
2022-07-04 05:36:36.924435 (Thread-376): sending response (<Response 4257 bytes [200 OK]>) to 10.0.12.141
2022-07-04 05:36:37.438015 (Thread-1): 05:36:37  SQL status: SUCCESS 6 in 0.85 seconds
2022-07-04 05:36:37.439472 (Thread-1): 05:36:37  finished collecting timing info
2022-07-04 05:36:37.439658 (Thread-1): 05:36:37  On rpc.ecommerce_data_model_dbt.request: Close
2022-07-04 05:36:38.298699 (Thread-377): handling poll request
2022-07-04 05:36:38.299103 (Thread-377): 05:36:38  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '08022227-1dd0-4d09-94f1-e256bf2507d1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb0f0e42be0>]}
2022-07-04 05:36:38.300026 (Thread-377): sending response (<Response 5449 bytes [200 OK]>) to 10.0.12.141
2022-07-04 05:37:07.355861 (Thread-378): 05:37:07  Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
2022-07-04 05:37:07.356447 (Thread-378): 05:37:07  Partial parsing: updated file: ecommerce_data_model_dbt://models/data_model/temp_folder/has_mobile_app.sql
2022-07-04 05:37:07.361493 (Thread-378): 05:37:07  1603: static parser failed on data_model/temp_folder/has_mobile_app.sql
2022-07-04 05:37:07.365636 (Thread-378): 05:37:07  1602: parser fallback to jinja rendering on data_model/temp_folder/has_mobile_app.sql
2022-07-04 05:37:07.402535 (Thread-378): 05:37:07  [WARNING]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.data-apps-ecommerce-template.data_model

2022-07-04 05:37:07.407989 (Thread-378): 05:37:07  Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '08022227-1dd0-4d09-94f1-e256bf2507d1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb0f0d36be0>]}
2022-07-04 05:37:08.132230 (Thread-379): handling status request
2022-07-04 05:37:08.132657 (Thread-379): 05:37:08  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '08022227-1dd0-4d09-94f1-e256bf2507d1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb16052bc40>]}
2022-07-04 05:37:08.133185 (Thread-379): sending response (<Response 2390 bytes [200 OK]>) to 10.0.12.141
2022-07-04 05:37:08.214629 (Thread-380): handling status request
2022-07-04 05:37:08.215039 (Thread-380): 05:37:08  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '08022227-1dd0-4d09-94f1-e256bf2507d1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb16052b8e0>]}
2022-07-04 05:37:08.215551 (Thread-380): sending response (<Response 2390 bytes [200 OK]>) to 10.0.12.141
2022-07-04 05:37:08.802940 (Thread-381): handling status request
2022-07-04 05:37:08.803348 (Thread-381): 05:37:08  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '08022227-1dd0-4d09-94f1-e256bf2507d1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb16052b7c0>]}
2022-07-04 05:37:08.803838 (Thread-381): sending response (<Response 2390 bytes [200 OK]>) to 10.0.12.141
2022-07-04 05:37:09.201068 (Thread-382): handling run_sql request
2022-07-04 05:37:09.201500 (Thread-382): 05:37:09  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '08022227-1dd0-4d09-94f1-e256bf2507d1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb16052bb20>]}
2022-07-04 05:37:11.537043 (Thread-382): sending response (<Response 139 bytes [200 OK]>) to 10.0.12.141
2022-07-04 05:37:11.562792 (MainThread): 05:37:11  Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '4b80c8a3-fdcc-486c-803c-fe4f82692e1f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f937bbd4280>]}
2022-07-04 05:37:11.563370 (MainThread): 05:37:11  Found 12 models, 0 tests, 0 snapshots, 0 analyses, 179 macros, 0 operations, 0 seed files, 15 sources, 0 exposures, 0 metrics
2022-07-04 05:37:11.563983 (Thread-1): 05:37:11  Acquiring new snowflake connection "rpc.ecommerce_data_model_dbt.request"
2022-07-04 05:37:11.564118 (Thread-1): 05:37:11  Began compiling node rpc.ecommerce_data_model_dbt.request
2022-07-04 05:37:11.564213 (Thread-1): 05:37:11  Compiling rpc.ecommerce_data_model_dbt.request
2022-07-04 05:37:11.566836 (Thread-1): 05:37:11  finished collecting timing info
2022-07-04 05:37:11.566969 (Thread-1): 05:37:11  Began executing node rpc.ecommerce_data_model_dbt.request
2022-07-04 05:37:11.567873 (Thread-1): 05:37:11  Using snowflake connection "rpc.ecommerce_data_model_dbt.request"
2022-07-04 05:37:11.567964 (Thread-1): 05:37:11  On rpc.ecommerce_data_model_dbt.request: select user_id, has_mobile_app from 
(select user_id, 
(CASE WHEN context_device_type = 'android' or context_device_type = 'iOS'
      THEN TRUE
      ELSE FALSE
END) as has_mobile_app, row_number() over(partition by user_id order by timestamp desc) as rn from 
analytics_db.data_apps_simulated.identifies where timestamp >= '2021-05-01' and timestamp <= '2022-06-29'
and context_device_type is not null and context_device_type != '' and user_id is not null) where rn = 1
limit 500
/* limit added automatically by dbt cloud */
2022-07-04 05:37:11.568046 (Thread-1): 05:37:11  Opening a new connection, currently in state init
2022-07-04 05:37:11.931243 (Thread-383): handling poll request
2022-07-04 05:37:11.931733 (Thread-383): 05:37:11  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '08022227-1dd0-4d09-94f1-e256bf2507d1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb0f0cede50>]}
2022-07-04 05:37:11.932712 (Thread-383): sending response (<Response 4281 bytes [200 OK]>) to 10.0.12.141
2022-07-04 05:37:12.326944 (Thread-1): 05:37:12  SQL status: SUCCESS 5 in 0.76 seconds
2022-07-04 05:37:12.328418 (Thread-1): 05:37:12  finished collecting timing info
2022-07-04 05:37:12.328603 (Thread-1): 05:37:12  On rpc.ecommerce_data_model_dbt.request: Close
2022-07-04 05:37:13.738708 (Thread-384): handling poll request
2022-07-04 05:37:13.739116 (Thread-384): 05:37:13  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '08022227-1dd0-4d09-94f1-e256bf2507d1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb0f0c7bd00>]}
2022-07-04 05:37:13.740053 (Thread-384): sending response (<Response 5530 bytes [200 OK]>) to 10.0.12.141
2022-07-04 05:38:52.356689 (Thread-385): 05:38:52  Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
2022-07-04 05:38:52.358936 (Thread-385): 05:38:52  Partial parsing: updated file: ecommerce_data_model_dbt://models/data_model/stg_user_traits.sql
2022-07-04 05:38:52.364099 (Thread-385): 05:38:52  1603: static parser failed on data_model/stg_user_traits.sql
2022-07-04 05:38:52.372206 (Thread-385): 05:38:52  1602: parser fallback to jinja rendering on data_model/stg_user_traits.sql
2022-07-04 05:38:52.409317 (Thread-385): 05:38:52  [WARNING]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.data-apps-ecommerce-template.data_model

2022-07-04 05:38:52.414550 (Thread-385): 05:38:52  Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '08022227-1dd0-4d09-94f1-e256bf2507d1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb0f0f863d0>]}
2022-07-04 05:38:53.160862 (Thread-386): handling status request
2022-07-04 05:38:53.161271 (Thread-386): 05:38:53  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '08022227-1dd0-4d09-94f1-e256bf2507d1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb0f0f762e0>]}
2022-07-04 05:38:53.161798 (Thread-386): sending response (<Response 2357 bytes [200 OK]>) to 10.0.12.141
2022-07-04 05:38:53.307080 (Thread-387): handling status request
2022-07-04 05:38:53.307487 (Thread-387): 05:38:53  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '08022227-1dd0-4d09-94f1-e256bf2507d1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb0f0f767c0>]}
2022-07-04 05:38:53.328947 (Thread-387): sending response (<Response 2357 bytes [200 OK]>) to 10.0.12.141
2022-07-04 05:38:54.540063 (Thread-388): handling status request
2022-07-04 05:38:54.540535 (Thread-388): 05:38:54  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '08022227-1dd0-4d09-94f1-e256bf2507d1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb0f0f761f0>]}
2022-07-04 05:38:54.541081 (Thread-388): sending response (<Response 2357 bytes [200 OK]>) to 10.0.12.141
2022-07-04 05:38:54.945903 (Thread-389): handling run_sql request
2022-07-04 05:38:54.946361 (Thread-389): 05:38:54  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '08022227-1dd0-4d09-94f1-e256bf2507d1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb0f0f76100>]}
2022-07-04 05:38:57.253857 (Thread-389): sending response (<Response 139 bytes [200 OK]>) to 10.0.12.141
2022-07-04 05:38:57.285835 (MainThread): 05:38:57  Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '9ea28105-d384-46aa-b1ca-d7bfdf3a125f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0f9c794220>]}
2022-07-04 05:38:57.286396 (MainThread): 05:38:57  Found 12 models, 0 tests, 0 snapshots, 0 analyses, 179 macros, 0 operations, 0 seed files, 15 sources, 0 exposures, 0 metrics
2022-07-04 05:38:57.286977 (Thread-1): 05:38:57  Acquiring new snowflake connection "rpc.ecommerce_data_model_dbt.request"
2022-07-04 05:38:57.287105 (Thread-1): 05:38:57  Began compiling node rpc.ecommerce_data_model_dbt.request
2022-07-04 05:38:57.287199 (Thread-1): 05:38:57  Compiling rpc.ecommerce_data_model_dbt.request
2022-07-04 05:38:57.293810 (Thread-1): 05:38:57  finished collecting timing info
2022-07-04 05:38:57.293967 (Thread-1): 05:38:57  Began executing node rpc.ecommerce_data_model_dbt.request
2022-07-04 05:38:57.297947 (Thread-1): 05:38:57  Using snowflake connection "rpc.ecommerce_data_model_dbt.request"
2022-07-04 05:38:57.298048 (Thread-1): 05:38:57  On rpc.ecommerce_data_model_dbt.request: with cte_gender as 
(select user_id, gender from 
(select user_id, properties_gender as gender, row_number() over(partition by user_id order by timestamp desc) as rn from 
analytics_db.data_apps_simulated.identifies where timestamp >= '2021-05-01' and timestamp <= '2022-06-29'
and properties_gender is not null and properties_gender != '') where rn = 1),

cte_age as 
(select user_id, age from
(select user_id, 
(CASE WHEN dateadd(year, datediff (year, properties_birthday, getdate()), properties_birthday) > getdate()
      THEN datediff(year, properties_birthday, getdate()) - 1
      ELSE datediff(year, properties_birthday, getdate())
 END) as age, row_number() over(partition by user_id order by timestamp desc) as rn 
from analytics_db.data_apps_simulated.identifies where timestamp >= '2021-05-01' and timestamp <= '2022-06-29'
and properties_birthday is not null and properties_birthday!='') where rn = 1),

cte_country as 
(select user_id, country from 
(select user_id, properties_country as country, row_number() over(partition by user_id order by timestamp desc) as rn from 
analytics_db.data_apps_simulated.identifies where timestamp >= '2021-05-01' and timestamp <= '2022-06-29'
and properties_country is not null and properties_country != '') where rn = 1),

cte_state as 
(select user_id, state from 
(select user_id, properties_state as state, row_number() over(partition by user_id order by timestamp desc) as rn from 
analytics_db.data_apps_simulated.identifies where timestamp >= '2021-05-01' and timestamp <= '2022-06-29'
and properties_state is not null and properties_state != '') where rn = 1),

cte_email_domain as 
(select user_id, email_domain from 
(select user_id, substring(properties_email, charindex( '@', properties_email) + 1, len(properties_email)) as email_domain, row_number() over(partition by user_id order by timestamp desc) as rn from 
analytics_db.data_apps_simulated.identifies where timestamp >= '2021-05-01' and timestamp <= '2022-06-29'
and properties_email is not null and properties_email != '') where rn = 1),

cte_is_member as 
(select user_id, is_member from
(select user_id, properties_is_member as is_member, row_number() over(partition by user_id order by timestamp desc) as rn from 
analytics_db.data_apps_simulated.identifies where timestamp >= '2021-05-01' and timestamp <= '2022-06-29'
and is_member is not null) where rn = 1),

cte_has_mobile_app as 
(select user_id, has_mobile_app from 
(select user_id, 
(CASE WHEN context_device_type = 'android' or context_device_type = 'iOS'
      THEN TRUE
      ELSE FALSE
END) as has_mobile_app, row_number() over(partition by user_id order by timestamp desc) as rn from 
analytics_db.data_apps_simulated.identifies where timestamp >= '2021-05-01' and timestamp <= '2022-06-29'
and context_device_type is not null and context_device_type != '' and user_id is not null) where rn = 1)

select coalesce(a.user_id, b.user_id, c.user_id, d.user_id, e.user_id, f.user_id, g.user_id) 
as user_id, gender, age, country, state, email_domain, is_member, has_mobile_app
from (((((cte_gender a full outer join cte_age b on a.user_id = b.user_id) 
full outer join cte_country c on c.user_id = coalesce(a.user_id, b.user_id))
full outer join cte_state d on d.user_id = coalesce(a.user_id, b.user_id, c.user_id))
full outer join cte_email_domain e on e.user_id = coalesce(a.user_id, b.user_id, c.user_id,d.user_id))
full outer join cte_is_member f on f.user_id = coalesce(a.user_id, b.user_id, c.user_id,d.user_id, e.user_id))
full outer join cte_has_mobile_app on g.user_id = coalesce(a.user_id, b.user_id, c.user_id,d.user_id, e.user_id, f.user_id)
limit 500
/* limit added automatically by dbt cloud */
2022-07-04 05:38:57.298129 (Thread-1): 05:38:57  Opening a new connection, currently in state init
2022-07-04 05:38:57.658671 (Thread-390): handling poll request
2022-07-04 05:38:57.659169 (Thread-390): 05:38:57  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '08022227-1dd0-4d09-94f1-e256bf2507d1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb0f0f86ee0>]}
2022-07-04 05:38:57.660130 (Thread-390): sending response (<Response 7486 bytes [200 OK]>) to 10.0.12.141
2022-07-04 05:38:57.998076 (Thread-1): 05:38:57  Snowflake adapter: Snowflake query id: 01a55ff2-0602-327e-0019-82030465cd5e
2022-07-04 05:38:57.998271 (Thread-1): 05:38:57  Snowflake adapter: Snowflake error: 000904 (42000): SQL compilation error: error line 51 at position 82
invalid identifier 'G.USER_ID'
2022-07-04 05:38:57.998432 (Thread-1): 05:38:57  finished collecting timing info
2022-07-04 05:38:57.998586 (Thread-1): 05:38:57  On rpc.ecommerce_data_model_dbt.request: Close
2022-07-04 05:38:58.072325 (Thread-1): Got an exception: Database Error
  000904 (42000): SQL compilation error: error line 51 at position 82
  invalid identifier 'G.USER_ID'
Traceback (most recent call last):
  File "/usr/local/lib/python3.8/dist-packages/dbt/adapters/snowflake/connections.py", line 206, in exception_handler
    yield
  File "/usr/local/lib/python3.8/dist-packages/dbt/adapters/sql/connections.py", line 74, in add_query
    cursor.execute(sql, bindings)
  File "/usr/local/lib/python3.8/dist-packages/snowflake/connector/cursor.py", line 721, in execute
    Error.errorhandler_wrapper(
  File "/usr/local/lib/python3.8/dist-packages/snowflake/connector/errors.py", line 258, in errorhandler_wrapper
    cursor.errorhandler(connection, cursor, error_class, error_value)
  File "/usr/local/lib/python3.8/dist-packages/snowflake/connector/errors.py", line 188, in default_errorhandler
    raise error_class(
snowflake.connector.errors.ProgrammingError: 000904 (42000): SQL compilation error: error line 51 at position 82
invalid identifier 'G.USER_ID'

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/usr/local/lib/python3.8/dist-packages/dbt/task/base.py", line 361, in safe_run
    result = self.compile_and_execute(manifest, ctx)
  File "/usr/local/lib/python3.8/dist-packages/dbt/task/base.py", line 314, in compile_and_execute
    result = self.run(ctx.node, manifest)
  File "/usr/local/lib/python3.8/dist-packages/dbt/task/base.py", line 403, in run
    return self.execute(compiled_node, manifest)
  File "/usr/local/lib/python3.8/dist-packages/dbt_rpc/rpc/node_runners.py", line 90, in execute
    _, execute_result = self.adapter.execute(
  File "/usr/local/lib/python3.8/dist-packages/dbt/adapters/base/impl.py", line 225, in execute
    return self.connections.execute(
  File "/usr/local/lib/python3.8/dist-packages/dbt/adapters/sql/connections.py", line 127, in execute
    _, cursor = self.add_query(sql, auto_begin)
  File "/usr/local/lib/python3.8/dist-packages/dbt/adapters/snowflake/connections.py", line 433, in add_query
    connection, cursor = super().add_query(
  File "/usr/local/lib/python3.8/dist-packages/dbt/adapters/sql/connections.py", line 83, in add_query
    return connection, cursor
  File "/usr/lib/python3.8/contextlib.py", line 131, in __exit__
    self.gen.throw(type, value, traceback)
  File "/usr/local/lib/python3.8/dist-packages/dbt/adapters/snowflake/connections.py", line 223, in exception_handler
    raise DatabaseException(msg)
dbt.exceptions.DatabaseException: Database Error
  000904 (42000): SQL compilation error: error line 51 at position 82
  invalid identifier 'G.USER_ID'
2022-07-04 05:38:58.073367 (Thread-1): Got exception RPCException(10003, Database Error, {'type': 'DatabaseException', 'message': "Database Error in rpc request (from remote system)\n  000904 (42000): SQL compilation error: error line 51 at position 82\n  invalid identifier 'G.USER_ID'", 'raw_sql': "with cte_gender as \n(select user_id, gender from \n(select user_id, properties_gender as gender, row_number() over(partition by user_id order by timestamp desc) as rn from \n{{ source('ecommerce', 'identifies') }} where timestamp >= '{{ var('start_date') }}' and timestamp <= '{{ var('end_date') }}'\nand properties_gender is not null and properties_gender != '') where rn = 1),\n\ncte_age as \n(select user_id, age from\n(select user_id, \n(CASE WHEN dateadd(year, datediff (year, properties_birthday, getdate()), properties_birthday) > getdate()\n      THEN datediff(year, properties_birthday, getdate()) - 1\n      ELSE datediff(year, properties_birthday, getdate())\n END) as age, row_number() over(partition by user_id order by timestamp desc) as rn \nfrom {{ source('ecommerce', 'identifies') }} where timestamp >= '{{ var('start_date') }}' and timestamp <= '{{ var('end_date') }}'\nand properties_birthday is not null and properties_birthday!='') where rn = 1),\n\ncte_country as \n(select user_id, country from \n(select user_id, properties_country as country, row_number() over(partition by user_id order by timestamp desc) as rn from \n{{ source('ecommerce', 'identifies') }} where timestamp >= '{{ var('start_date') }}' and timestamp <= '{{ var('end_date') }}'\nand properties_country is not null and properties_country != '') where rn = 1),\n\ncte_state as \n(select user_id, state from \n(select user_id, properties_state as state, row_number() over(partition by user_id order by timestamp desc) as rn from \n{{ source('ecommerce', 'identifies') }} where timestamp >= '{{ var('start_date') }}' and timestamp <= '{{ var('end_date') }}'\nand properties_state is not null and properties_state != '') where rn = 1),\n\ncte_email_domain as \n(select user_id, email_domain from \n(select user_id, substring(properties_email, charindex( '@', properties_email) + 1, len(properties_email)) as email_domain, row_number() over(partition by user_id order by timestamp desc) as rn from \n{{ source('ecommerce', 'identifies') }} where timestamp >= '{{ var('start_date') }}' and timestamp <= '{{ var('end_date') }}'\nand properties_email is not null and properties_email != '') where rn = 1),\n\ncte_is_member as \n(select user_id, is_member from\n(select user_id, properties_is_member as is_member, row_number() over(partition by user_id order by timestamp desc) as rn from \n{{ source('ecommerce', 'identifies') }} where timestamp >= '{{ var('start_date') }}' and timestamp <= '{{ var('end_date') }}'\nand is_member is not null) where rn = 1),\n\ncte_has_mobile_app as \n(select user_id, has_mobile_app from \n(select user_id, \n(CASE WHEN context_device_type = 'android' or context_device_type = 'iOS'\n      THEN TRUE\n      ELSE FALSE\nEND) as has_mobile_app, row_number() over(partition by user_id order by timestamp desc) as rn from \n{{ source('ecommerce', 'identifies') }} where timestamp >= '{{ var('start_date') }}' and timestamp <= '{{ var('end_date') }}'\nand context_device_type is not null and context_device_type != '' and user_id is not null) where rn = 1)\n\nselect coalesce(a.user_id, b.user_id, c.user_id, d.user_id, e.user_id, f.user_id, g.user_id) \nas user_id, gender, age, country, state, email_domain, is_member, has_mobile_app\nfrom (((((cte_gender a full outer join cte_age b on a.user_id = b.user_id) \nfull outer join cte_country c on c.user_id = coalesce(a.user_id, b.user_id))\nfull outer join cte_state d on d.user_id = coalesce(a.user_id, b.user_id, c.user_id))\nfull outer join cte_email_domain e on e.user_id = coalesce(a.user_id, b.user_id, c.user_id,d.user_id))\nfull outer join cte_is_member f on f.user_id = coalesce(a.user_id, b.user_id, c.user_id,d.user_id, e.user_id))\nfull outer join cte_has_mobile_app on g.user_id = coalesce(a.user_id, b.user_id, c.user_id,d.user_id, e.user_id, f.user_id)\nlimit 500\n/* limit added automatically by dbt cloud */", 'compiled_sql': "with cte_gender as \n(select user_id, gender from \n(select user_id, properties_gender as gender, row_number() over(partition by user_id order by timestamp desc) as rn from \nanalytics_db.data_apps_simulated.identifies where timestamp >= '2021-05-01' and timestamp <= '2022-06-29'\nand properties_gender is not null and properties_gender != '') where rn = 1),\n\ncte_age as \n(select user_id, age from\n(select user_id, \n(CASE WHEN dateadd(year, datediff (year, properties_birthday, getdate()), properties_birthday) > getdate()\n      THEN datediff(year, properties_birthday, getdate()) - 1\n      ELSE datediff(year, properties_birthday, getdate())\n END) as age, row_number() over(partition by user_id order by timestamp desc) as rn \nfrom analytics_db.data_apps_simulated.identifies where timestamp >= '2021-05-01' and timestamp <= '2022-06-29'\nand properties_birthday is not null and properties_birthday!='') where rn = 1),\n\ncte_country as \n(select user_id, country from \n(select user_id, properties_country as country, row_number() over(partition by user_id order by timestamp desc) as rn from \nanalytics_db.data_apps_simulated.identifies where timestamp >= '2021-05-01' and timestamp <= '2022-06-29'\nand properties_country is not null and properties_country != '') where rn = 1),\n\ncte_state as \n(select user_id, state from \n(select user_id, properties_state as state, row_number() over(partition by user_id order by timestamp desc) as rn from \nanalytics_db.data_apps_simulated.identifies where timestamp >= '2021-05-01' and timestamp <= '2022-06-29'\nand properties_state is not null and properties_state != '') where rn = 1),\n\ncte_email_domain as \n(select user_id, email_domain from \n(select user_id, substring(properties_email, charindex( '@', properties_email) + 1, len(properties_email)) as email_domain, row_number() over(partition by user_id order by timestamp desc) as rn from \nanalytics_db.data_apps_simulated.identifies where timestamp >= '2021-05-01' and timestamp <= '2022-06-29'\nand properties_email is not null and properties_email != '') where rn = 1),\n\ncte_is_member as \n(select user_id, is_member from\n(select user_id, properties_is_member as is_member, row_number() over(partition by user_id order by timestamp desc) as rn from \nanalytics_db.data_apps_simulated.identifies where timestamp >= '2021-05-01' and timestamp <= '2022-06-29'\nand is_member is not null) where rn = 1),\n\ncte_has_mobile_app as \n(select user_id, has_mobile_app from \n(select user_id, \n(CASE WHEN context_device_type = 'android' or context_device_type = 'iOS'\n      THEN TRUE\n      ELSE FALSE\nEND) as has_mobile_app, row_number() over(partition by user_id order by timestamp desc) as rn from \nanalytics_db.data_apps_simulated.identifies where timestamp >= '2021-05-01' and timestamp <= '2022-06-29'\nand context_device_type is not null and context_device_type != '' and user_id is not null) where rn = 1)\n\nselect coalesce(a.user_id, b.user_id, c.user_id, d.user_id, e.user_id, f.user_id, g.user_id) \nas user_id, gender, age, country, state, email_domain, is_member, has_mobile_app\nfrom (((((cte_gender a full outer join cte_age b on a.user_id = b.user_id) \nfull outer join cte_country c on c.user_id = coalesce(a.user_id, b.user_id))\nfull outer join cte_state d on d.user_id = coalesce(a.user_id, b.user_id, c.user_id))\nfull outer join cte_email_domain e on e.user_id = coalesce(a.user_id, b.user_id, c.user_id,d.user_id))\nfull outer join cte_is_member f on f.user_id = coalesce(a.user_id, b.user_id, c.user_id,d.user_id, e.user_id))\nfull outer join cte_has_mobile_app on g.user_id = coalesce(a.user_id, b.user_id, c.user_id,d.user_id, e.user_id, f.user_id)\nlimit 500\n/* limit added automatically by dbt cloud */", 'tags': None}, None)
Traceback (most recent call last):
  File "/usr/local/lib/python3.8/dist-packages/dbt_rpc/task/sql_commands.py", line 147, in _in_thread
    self.node_results.append(runner.safe_run(self.manifest))
  File "/usr/local/lib/python3.8/dist-packages/dbt/task/base.py", line 377, in safe_run
    result = self.error_result(ctx.node, error, started, [])
  File "/usr/local/lib/python3.8/dist-packages/dbt_rpc/rpc/node_runners.py", line 56, in error_result
    raise error
dbt_rpc.rpc.error.RPCException: RPCException(10003, Database Error, {'type': 'DatabaseException', 'message': "Database Error in rpc request (from remote system)\n  000904 (42000): SQL compilation error: error line 51 at position 82\n  invalid identifier 'G.USER_ID'", 'raw_sql': "with cte_gender as \n(select user_id, gender from \n(select user_id, properties_gender as gender, row_number() over(partition by user_id order by timestamp desc) as rn from \n{{ source('ecommerce', 'identifies') }} where timestamp >= '{{ var('start_date') }}' and timestamp <= '{{ var('end_date') }}'\nand properties_gender is not null and properties_gender != '') where rn = 1),\n\ncte_age as \n(select user_id, age from\n(select user_id, \n(CASE WHEN dateadd(year, datediff (year, properties_birthday, getdate()), properties_birthday) > getdate()\n      THEN datediff(year, properties_birthday, getdate()) - 1\n      ELSE datediff(year, properties_birthday, getdate())\n END) as age, row_number() over(partition by user_id order by timestamp desc) as rn \nfrom {{ source('ecommerce', 'identifies') }} where timestamp >= '{{ var('start_date') }}' and timestamp <= '{{ var('end_date') }}'\nand properties_birthday is not null and properties_birthday!='') where rn = 1),\n\ncte_country as \n(select user_id, country from \n(select user_id, properties_country as country, row_number() over(partition by user_id order by timestamp desc) as rn from \n{{ source('ecommerce', 'identifies') }} where timestamp >= '{{ var('start_date') }}' and timestamp <= '{{ var('end_date') }}'\nand properties_country is not null and properties_country != '') where rn = 1),\n\ncte_state as \n(select user_id, state from \n(select user_id, properties_state as state, row_number() over(partition by user_id order by timestamp desc) as rn from \n{{ source('ecommerce', 'identifies') }} where timestamp >= '{{ var('start_date') }}' and timestamp <= '{{ var('end_date') }}'\nand properties_state is not null and properties_state != '') where rn = 1),\n\ncte_email_domain as \n(select user_id, email_domain from \n(select user_id, substring(properties_email, charindex( '@', properties_email) + 1, len(properties_email)) as email_domain, row_number() over(partition by user_id order by timestamp desc) as rn from \n{{ source('ecommerce', 'identifies') }} where timestamp >= '{{ var('start_date') }}' and timestamp <= '{{ var('end_date') }}'\nand properties_email is not null and properties_email != '') where rn = 1),\n\ncte_is_member as \n(select user_id, is_member from\n(select user_id, properties_is_member as is_member, row_number() over(partition by user_id order by timestamp desc) as rn from \n{{ source('ecommerce', 'identifies') }} where timestamp >= '{{ var('start_date') }}' and timestamp <= '{{ var('end_date') }}'\nand is_member is not null) where rn = 1),\n\ncte_has_mobile_app as \n(select user_id, has_mobile_app from \n(select user_id, \n(CASE WHEN context_device_type = 'android' or context_device_type = 'iOS'\n      THEN TRUE\n      ELSE FALSE\nEND) as has_mobile_app, row_number() over(partition by user_id order by timestamp desc) as rn from \n{{ source('ecommerce', 'identifies') }} where timestamp >= '{{ var('start_date') }}' and timestamp <= '{{ var('end_date') }}'\nand context_device_type is not null and context_device_type != '' and user_id is not null) where rn = 1)\n\nselect coalesce(a.user_id, b.user_id, c.user_id, d.user_id, e.user_id, f.user_id, g.user_id) \nas user_id, gender, age, country, state, email_domain, is_member, has_mobile_app\nfrom (((((cte_gender a full outer join cte_age b on a.user_id = b.user_id) \nfull outer join cte_country c on c.user_id = coalesce(a.user_id, b.user_id))\nfull outer join cte_state d on d.user_id = coalesce(a.user_id, b.user_id, c.user_id))\nfull outer join cte_email_domain e on e.user_id = coalesce(a.user_id, b.user_id, c.user_id,d.user_id))\nfull outer join cte_is_member f on f.user_id = coalesce(a.user_id, b.user_id, c.user_id,d.user_id, e.user_id))\nfull outer join cte_has_mobile_app on g.user_id = coalesce(a.user_id, b.user_id, c.user_id,d.user_id, e.user_id, f.user_id)\nlimit 500\n/* limit added automatically by dbt cloud */", 'compiled_sql': "with cte_gender as \n(select user_id, gender from \n(select user_id, properties_gender as gender, row_number() over(partition by user_id order by timestamp desc) as rn from \nanalytics_db.data_apps_simulated.identifies where timestamp >= '2021-05-01' and timestamp <= '2022-06-29'\nand properties_gender is not null and properties_gender != '') where rn = 1),\n\ncte_age as \n(select user_id, age from\n(select user_id, \n(CASE WHEN dateadd(year, datediff (year, properties_birthday, getdate()), properties_birthday) > getdate()\n      THEN datediff(year, properties_birthday, getdate()) - 1\n      ELSE datediff(year, properties_birthday, getdate())\n END) as age, row_number() over(partition by user_id order by timestamp desc) as rn \nfrom analytics_db.data_apps_simulated.identifies where timestamp >= '2021-05-01' and timestamp <= '2022-06-29'\nand properties_birthday is not null and properties_birthday!='') where rn = 1),\n\ncte_country as \n(select user_id, country from \n(select user_id, properties_country as country, row_number() over(partition by user_id order by timestamp desc) as rn from \nanalytics_db.data_apps_simulated.identifies where timestamp >= '2021-05-01' and timestamp <= '2022-06-29'\nand properties_country is not null and properties_country != '') where rn = 1),\n\ncte_state as \n(select user_id, state from \n(select user_id, properties_state as state, row_number() over(partition by user_id order by timestamp desc) as rn from \nanalytics_db.data_apps_simulated.identifies where timestamp >= '2021-05-01' and timestamp <= '2022-06-29'\nand properties_state is not null and properties_state != '') where rn = 1),\n\ncte_email_domain as \n(select user_id, email_domain from \n(select user_id, substring(properties_email, charindex( '@', properties_email) + 1, len(properties_email)) as email_domain, row_number() over(partition by user_id order by timestamp desc) as rn from \nanalytics_db.data_apps_simulated.identifies where timestamp >= '2021-05-01' and timestamp <= '2022-06-29'\nand properties_email is not null and properties_email != '') where rn = 1),\n\ncte_is_member as \n(select user_id, is_member from\n(select user_id, properties_is_member as is_member, row_number() over(partition by user_id order by timestamp desc) as rn from \nanalytics_db.data_apps_simulated.identifies where timestamp >= '2021-05-01' and timestamp <= '2022-06-29'\nand is_member is not null) where rn = 1),\n\ncte_has_mobile_app as \n(select user_id, has_mobile_app from \n(select user_id, \n(CASE WHEN context_device_type = 'android' or context_device_type = 'iOS'\n      THEN TRUE\n      ELSE FALSE\nEND) as has_mobile_app, row_number() over(partition by user_id order by timestamp desc) as rn from \nanalytics_db.data_apps_simulated.identifies where timestamp >= '2021-05-01' and timestamp <= '2022-06-29'\nand context_device_type is not null and context_device_type != '' and user_id is not null) where rn = 1)\n\nselect coalesce(a.user_id, b.user_id, c.user_id, d.user_id, e.user_id, f.user_id, g.user_id) \nas user_id, gender, age, country, state, email_domain, is_member, has_mobile_app\nfrom (((((cte_gender a full outer join cte_age b on a.user_id = b.user_id) \nfull outer join cte_country c on c.user_id = coalesce(a.user_id, b.user_id))\nfull outer join cte_state d on d.user_id = coalesce(a.user_id, b.user_id, c.user_id))\nfull outer join cte_email_domain e on e.user_id = coalesce(a.user_id, b.user_id, c.user_id,d.user_id))\nfull outer join cte_is_member f on f.user_id = coalesce(a.user_id, b.user_id, c.user_id,d.user_id, e.user_id))\nfull outer join cte_has_mobile_app on g.user_id = coalesce(a.user_id, b.user_id, c.user_id,d.user_id, e.user_id, f.user_id)\nlimit 500\n/* limit added automatically by dbt cloud */", 'tags': None}, None)
2022-07-04 05:38:59.045609 (Thread-391): handling poll request
2022-07-04 05:38:59.046045 (Thread-391): 05:38:59  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '08022227-1dd0-4d09-94f1-e256bf2507d1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb0f0f86dc0>]}
2022-07-04 05:38:59.046818 (Thread-391): sending response (<Response 36322 bytes [200 OK]>) to 10.0.12.141
2022-07-04 05:39:11.921219 (Thread-392): 05:39:11  Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
2022-07-04 05:39:11.921750 (Thread-392): 05:39:11  Partial parsing: updated file: ecommerce_data_model_dbt://models/data_model/stg_user_traits.sql
2022-07-04 05:39:11.926170 (Thread-392): 05:39:11  1603: static parser failed on data_model/stg_user_traits.sql
2022-07-04 05:39:11.934105 (Thread-392): 05:39:11  1602: parser fallback to jinja rendering on data_model/stg_user_traits.sql
2022-07-04 05:39:11.972900 (Thread-392): 05:39:11  [WARNING]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.data-apps-ecommerce-template.data_model

2022-07-04 05:39:11.978585 (Thread-392): 05:39:11  Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '08022227-1dd0-4d09-94f1-e256bf2507d1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb0f0f12940>]}
2022-07-04 05:39:12.675811 (Thread-393): handling status request
2022-07-04 05:39:12.676220 (Thread-393): 05:39:12  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '08022227-1dd0-4d09-94f1-e256bf2507d1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb0f0f373a0>]}
2022-07-04 05:39:12.676760 (Thread-393): sending response (<Response 2357 bytes [200 OK]>) to 10.0.12.141
2022-07-04 05:39:12.706708 (Thread-394): handling status request
2022-07-04 05:39:12.707071 (Thread-394): 05:39:12  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '08022227-1dd0-4d09-94f1-e256bf2507d1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb0f0f37f40>]}
2022-07-04 05:39:12.707567 (Thread-394): sending response (<Response 2357 bytes [200 OK]>) to 10.0.12.141
2022-07-04 05:39:13.653675 (Thread-395): handling status request
2022-07-04 05:39:13.654129 (Thread-395): 05:39:13  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '08022227-1dd0-4d09-94f1-e256bf2507d1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb0f0f37e20>]}
2022-07-04 05:39:13.654640 (Thread-395): sending response (<Response 2357 bytes [200 OK]>) to 10.0.12.141
2022-07-04 05:39:14.017255 (Thread-396): handling run_sql request
2022-07-04 05:39:14.017651 (Thread-396): 05:39:14  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '08022227-1dd0-4d09-94f1-e256bf2507d1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb0f0f37fa0>]}
2022-07-04 05:39:16.340751 (Thread-396): sending response (<Response 139 bytes [200 OK]>) to 10.0.12.141
2022-07-04 05:39:16.372667 (MainThread): 05:39:16  Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'e085115d-9fba-40e6-a836-f045c9d509e3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5bd1514190>]}
2022-07-04 05:39:16.373205 (MainThread): 05:39:16  Found 12 models, 0 tests, 0 snapshots, 0 analyses, 179 macros, 0 operations, 0 seed files, 15 sources, 0 exposures, 0 metrics
2022-07-04 05:39:16.373801 (Thread-1): 05:39:16  Acquiring new snowflake connection "rpc.ecommerce_data_model_dbt.request"
2022-07-04 05:39:16.373968 (Thread-1): 05:39:16  Began compiling node rpc.ecommerce_data_model_dbt.request
2022-07-04 05:39:16.374079 (Thread-1): 05:39:16  Compiling rpc.ecommerce_data_model_dbt.request
2022-07-04 05:39:16.380727 (Thread-1): 05:39:16  finished collecting timing info
2022-07-04 05:39:16.380862 (Thread-1): 05:39:16  Began executing node rpc.ecommerce_data_model_dbt.request
2022-07-04 05:39:16.384935 (Thread-1): 05:39:16  Using snowflake connection "rpc.ecommerce_data_model_dbt.request"
2022-07-04 05:39:16.385037 (Thread-1): 05:39:16  On rpc.ecommerce_data_model_dbt.request: with cte_gender as 
(select user_id, gender from 
(select user_id, properties_gender as gender, row_number() over(partition by user_id order by timestamp desc) as rn from 
analytics_db.data_apps_simulated.identifies where timestamp >= '2021-05-01' and timestamp <= '2022-06-29'
and properties_gender is not null and properties_gender != '') where rn = 1),

cte_age as 
(select user_id, age from
(select user_id, 
(CASE WHEN dateadd(year, datediff (year, properties_birthday, getdate()), properties_birthday) > getdate()
      THEN datediff(year, properties_birthday, getdate()) - 1
      ELSE datediff(year, properties_birthday, getdate())
 END) as age, row_number() over(partition by user_id order by timestamp desc) as rn 
from analytics_db.data_apps_simulated.identifies where timestamp >= '2021-05-01' and timestamp <= '2022-06-29'
and properties_birthday is not null and properties_birthday!='') where rn = 1),

cte_country as 
(select user_id, country from 
(select user_id, properties_country as country, row_number() over(partition by user_id order by timestamp desc) as rn from 
analytics_db.data_apps_simulated.identifies where timestamp >= '2021-05-01' and timestamp <= '2022-06-29'
and properties_country is not null and properties_country != '') where rn = 1),

cte_state as 
(select user_id, state from 
(select user_id, properties_state as state, row_number() over(partition by user_id order by timestamp desc) as rn from 
analytics_db.data_apps_simulated.identifies where timestamp >= '2021-05-01' and timestamp <= '2022-06-29'
and properties_state is not null and properties_state != '') where rn = 1),

cte_email_domain as 
(select user_id, email_domain from 
(select user_id, substring(properties_email, charindex( '@', properties_email) + 1, len(properties_email)) as email_domain, row_number() over(partition by user_id order by timestamp desc) as rn from 
analytics_db.data_apps_simulated.identifies where timestamp >= '2021-05-01' and timestamp <= '2022-06-29'
and properties_email is not null and properties_email != '') where rn = 1),

cte_is_member as 
(select user_id, is_member from
(select user_id, properties_is_member as is_member, row_number() over(partition by user_id order by timestamp desc) as rn from 
analytics_db.data_apps_simulated.identifies where timestamp >= '2021-05-01' and timestamp <= '2022-06-29'
and is_member is not null) where rn = 1),

cte_has_mobile_app as 
(select user_id, has_mobile_app from 
(select user_id, 
(CASE WHEN context_device_type = 'android' or context_device_type = 'iOS'
      THEN TRUE
      ELSE FALSE
END) as has_mobile_app, row_number() over(partition by user_id order by timestamp desc) as rn from 
analytics_db.data_apps_simulated.identifies where timestamp >= '2021-05-01' and timestamp <= '2022-06-29'
and context_device_type is not null and context_device_type != '' and user_id is not null) where rn = 1)

select coalesce(a.user_id, b.user_id, c.user_id, d.user_id, e.user_id, f.user_id, g.user_id) 
as user_id, gender, age, country, state, email_domain, is_member, has_mobile_app
from (((((cte_gender a full outer join cte_age b on a.user_id = b.user_id) 
full outer join cte_country c on c.user_id = coalesce(a.user_id, b.user_id))
full outer join cte_state d on d.user_id = coalesce(a.user_id, b.user_id, c.user_id))
full outer join cte_email_domain e on e.user_id = coalesce(a.user_id, b.user_id, c.user_id,d.user_id))
full outer join cte_is_member f on f.user_id = coalesce(a.user_id, b.user_id, c.user_id,d.user_id, e.user_id))
full outer join cte_has_mobile_app g on g.user_id = coalesce(a.user_id, b.user_id, c.user_id,d.user_id, e.user_id, f.user_id)
limit 500
/* limit added automatically by dbt cloud */
2022-07-04 05:39:16.385123 (Thread-1): 05:39:16  Opening a new connection, currently in state init
2022-07-04 05:39:16.702765 (Thread-397): handling poll request
2022-07-04 05:39:16.703234 (Thread-397): 05:39:16  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '08022227-1dd0-4d09-94f1-e256bf2507d1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb0f0f12730>]}
2022-07-04 05:39:16.704159 (Thread-397): sending response (<Response 7488 bytes [200 OK]>) to 10.0.12.141
2022-07-04 05:39:18.042696 (Thread-1): 05:39:18  SQL status: SUCCESS 5 in 1.66 seconds
2022-07-04 05:39:18.044308 (Thread-1): 05:39:18  finished collecting timing info
2022-07-04 05:39:18.044495 (Thread-1): 05:39:18  On rpc.ecommerce_data_model_dbt.request: Close
2022-07-04 05:39:18.077205 (Thread-398): handling poll request
2022-07-04 05:39:18.077580 (Thread-398): 05:39:18  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '08022227-1dd0-4d09-94f1-e256bf2507d1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb0f0f194c0>]}
2022-07-04 05:39:18.078135 (Thread-398): sending response (<Response 1387 bytes [200 OK]>) to 10.0.12.141
2022-07-04 05:39:19.454620 (Thread-399): handling poll request
2022-07-04 05:39:19.455016 (Thread-399): 05:39:19  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '08022227-1dd0-4d09-94f1-e256bf2507d1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb0f0f19880>]}
2022-07-04 05:39:19.456040 (Thread-399): sending response (<Response 18447 bytes [200 OK]>) to 10.0.12.141
2022-07-04 05:40:29.588072 (Thread-400): 05:40:29  Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
2022-07-04 05:40:29.590041 (Thread-400): 05:40:29  Partial parsing: updated file: ecommerce_data_model_dbt://models/data_model/temp_folder/is_member.sql
2022-07-04 05:40:29.594596 (Thread-400): 05:40:29  1603: static parser failed on data_model/temp_folder/is_member.sql
2022-07-04 05:40:29.598468 (Thread-400): 05:40:29  1602: parser fallback to jinja rendering on data_model/temp_folder/is_member.sql
2022-07-04 05:40:29.630876 (Thread-400): 05:40:29  [WARNING]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.data-apps-ecommerce-template.data_model

2022-07-04 05:40:29.635772 (Thread-400): 05:40:29  Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '08022227-1dd0-4d09-94f1-e256bf2507d1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb0f0a37e20>]}
2022-07-04 05:40:30.407992 (Thread-401): handling status request
2022-07-04 05:40:30.408405 (Thread-401): 05:40:30  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '08022227-1dd0-4d09-94f1-e256bf2507d1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb0f0f33e80>]}
2022-07-04 05:40:30.408935 (Thread-401): sending response (<Response 2375 bytes [200 OK]>) to 10.0.12.141
2022-07-04 05:40:30.451835 (Thread-402): handling status request
2022-07-04 05:40:30.452194 (Thread-402): 05:40:30  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '08022227-1dd0-4d09-94f1-e256bf2507d1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb0f0f33130>]}
2022-07-04 05:40:30.452689 (Thread-402): sending response (<Response 2375 bytes [200 OK]>) to 10.0.12.141
2022-07-04 05:40:30.594116 (Thread-403): handling status request
2022-07-04 05:40:30.594535 (Thread-403): 05:40:30  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '08022227-1dd0-4d09-94f1-e256bf2507d1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb0f0a1d3d0>]}
2022-07-04 05:40:30.595048 (Thread-403): sending response (<Response 2375 bytes [200 OK]>) to 10.0.12.141
2022-07-04 05:40:30.988701 (Thread-404): handling run_sql request
2022-07-04 05:40:30.989103 (Thread-404): 05:40:30  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '08022227-1dd0-4d09-94f1-e256bf2507d1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb0f0ab0790>]}
2022-07-04 05:40:33.330895 (Thread-404): sending response (<Response 139 bytes [200 OK]>) to 10.0.12.141
2022-07-04 05:40:33.356166 (MainThread): 05:40:33  Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'e4ea2bdd-3379-475b-8283-486866ee0b9e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f24cda91220>]}
2022-07-04 05:40:33.356750 (MainThread): 05:40:33  Found 12 models, 0 tests, 0 snapshots, 0 analyses, 179 macros, 0 operations, 0 seed files, 15 sources, 0 exposures, 0 metrics
2022-07-04 05:40:33.357347 (Thread-1): 05:40:33  Acquiring new snowflake connection "rpc.ecommerce_data_model_dbt.request"
2022-07-04 05:40:33.357481 (Thread-1): 05:40:33  Began compiling node rpc.ecommerce_data_model_dbt.request
2022-07-04 05:40:33.357577 (Thread-1): 05:40:33  Compiling rpc.ecommerce_data_model_dbt.request
2022-07-04 05:40:33.360229 (Thread-1): 05:40:33  finished collecting timing info
2022-07-04 05:40:33.360369 (Thread-1): 05:40:33  Began executing node rpc.ecommerce_data_model_dbt.request
2022-07-04 05:40:33.361195 (Thread-1): 05:40:33  Using snowflake connection "rpc.ecommerce_data_model_dbt.request"
2022-07-04 05:40:33.361284 (Thread-1): 05:40:33  On rpc.ecommerce_data_model_dbt.request: select user_id, is_member from
(select user_id, 
(CASE WHEN properties_is_member is TRUE
      THEN TRUE
      ELSE FALSE
END) as is_member, row_number() over(partition by user_id order by timestamp desc) as rn from 
analytics_db.data_apps_simulated.identifies where timestamp >= '2021-05-01' and timestamp <= '2022-06-29'
and user_id is not null) where rn = 1
limit 500
/* limit added automatically by dbt cloud */
2022-07-04 05:40:33.361365 (Thread-1): 05:40:33  Opening a new connection, currently in state init
2022-07-04 05:40:33.722849 (Thread-405): handling poll request
2022-07-04 05:40:33.723346 (Thread-405): 05:40:33  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '08022227-1dd0-4d09-94f1-e256bf2507d1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb0f0f1e790>]}
2022-07-04 05:40:33.724290 (Thread-405): sending response (<Response 4165 bytes [200 OK]>) to 10.0.12.141
2022-07-04 05:40:34.030428 (Thread-1): 05:40:34  Snowflake adapter: Snowflake query id: 01a55ff4-0602-2ed5-0019-82030465d806
2022-07-04 05:40:34.030633 (Thread-1): 05:40:34  Snowflake adapter: Snowflake error: 001003 (42000): SQL compilation error:
syntax error line 3 at position 32 unexpected 'is'.
syntax error line 4 at position 6 unexpected 'THEN'.
syntax error line 6 at position 29 unexpected '('.
syntax error line 6 at position 81 unexpected ')'.
2022-07-04 05:40:34.030802 (Thread-1): 05:40:34  finished collecting timing info
2022-07-04 05:40:34.030960 (Thread-1): 05:40:34  On rpc.ecommerce_data_model_dbt.request: Close
2022-07-04 05:40:34.126370 (Thread-1): Got an exception: Database Error
  001003 (42000): SQL compilation error:
  syntax error line 3 at position 32 unexpected 'is'.
  syntax error line 4 at position 6 unexpected 'THEN'.
  syntax error line 6 at position 29 unexpected '('.
  syntax error line 6 at position 81 unexpected ')'.
Traceback (most recent call last):
  File "/usr/local/lib/python3.8/dist-packages/dbt/adapters/snowflake/connections.py", line 206, in exception_handler
    yield
  File "/usr/local/lib/python3.8/dist-packages/dbt/adapters/sql/connections.py", line 74, in add_query
    cursor.execute(sql, bindings)
  File "/usr/local/lib/python3.8/dist-packages/snowflake/connector/cursor.py", line 721, in execute
    Error.errorhandler_wrapper(
  File "/usr/local/lib/python3.8/dist-packages/snowflake/connector/errors.py", line 258, in errorhandler_wrapper
    cursor.errorhandler(connection, cursor, error_class, error_value)
  File "/usr/local/lib/python3.8/dist-packages/snowflake/connector/errors.py", line 188, in default_errorhandler
    raise error_class(
snowflake.connector.errors.ProgrammingError: 001003 (42000): SQL compilation error:
syntax error line 3 at position 32 unexpected 'is'.
syntax error line 4 at position 6 unexpected 'THEN'.
syntax error line 6 at position 29 unexpected '('.
syntax error line 6 at position 81 unexpected ')'.

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/usr/local/lib/python3.8/dist-packages/dbt/task/base.py", line 361, in safe_run
    result = self.compile_and_execute(manifest, ctx)
  File "/usr/local/lib/python3.8/dist-packages/dbt/task/base.py", line 314, in compile_and_execute
    result = self.run(ctx.node, manifest)
  File "/usr/local/lib/python3.8/dist-packages/dbt/task/base.py", line 403, in run
    return self.execute(compiled_node, manifest)
  File "/usr/local/lib/python3.8/dist-packages/dbt_rpc/rpc/node_runners.py", line 90, in execute
    _, execute_result = self.adapter.execute(
  File "/usr/local/lib/python3.8/dist-packages/dbt/adapters/base/impl.py", line 225, in execute
    return self.connections.execute(
  File "/usr/local/lib/python3.8/dist-packages/dbt/adapters/sql/connections.py", line 127, in execute
    _, cursor = self.add_query(sql, auto_begin)
  File "/usr/local/lib/python3.8/dist-packages/dbt/adapters/snowflake/connections.py", line 433, in add_query
    connection, cursor = super().add_query(
  File "/usr/local/lib/python3.8/dist-packages/dbt/adapters/sql/connections.py", line 83, in add_query
    return connection, cursor
  File "/usr/lib/python3.8/contextlib.py", line 131, in __exit__
    self.gen.throw(type, value, traceback)
  File "/usr/local/lib/python3.8/dist-packages/dbt/adapters/snowflake/connections.py", line 223, in exception_handler
    raise DatabaseException(msg)
dbt.exceptions.DatabaseException: Database Error
  001003 (42000): SQL compilation error:
  syntax error line 3 at position 32 unexpected 'is'.
  syntax error line 4 at position 6 unexpected 'THEN'.
  syntax error line 6 at position 29 unexpected '('.
  syntax error line 6 at position 81 unexpected ')'.
2022-07-04 05:40:34.127332 (Thread-1): Got exception RPCException(10003, Database Error, {'type': 'DatabaseException', 'message': "Database Error in rpc request (from remote system)\n  001003 (42000): SQL compilation error:\n  syntax error line 3 at position 32 unexpected 'is'.\n  syntax error line 4 at position 6 unexpected 'THEN'.\n  syntax error line 6 at position 29 unexpected '('.\n  syntax error line 6 at position 81 unexpected ')'.", 'raw_sql': "select user_id, is_member from\r\n(select user_id, \r\n(CASE WHEN properties_is_member is TRUE\r\n      THEN TRUE\r\n      ELSE FALSE\r\nEND) as is_member, row_number() over(partition by user_id order by timestamp desc) as rn from \r\n{{ source('ecommerce', 'identifies') }} where timestamp >= '{{ var('start_date') }}' and timestamp <= '{{ var('end_date') }}'\r\nand user_id is not null) where rn = 1\nlimit 500\n/* limit added automatically by dbt cloud */", 'compiled_sql': "select user_id, is_member from\n(select user_id, \n(CASE WHEN properties_is_member is TRUE\n      THEN TRUE\n      ELSE FALSE\nEND) as is_member, row_number() over(partition by user_id order by timestamp desc) as rn from \nanalytics_db.data_apps_simulated.identifies where timestamp >= '2021-05-01' and timestamp <= '2022-06-29'\nand user_id is not null) where rn = 1\nlimit 500\n/* limit added automatically by dbt cloud */", 'tags': None}, None)
Traceback (most recent call last):
  File "/usr/local/lib/python3.8/dist-packages/dbt_rpc/task/sql_commands.py", line 147, in _in_thread
    self.node_results.append(runner.safe_run(self.manifest))
  File "/usr/local/lib/python3.8/dist-packages/dbt/task/base.py", line 377, in safe_run
    result = self.error_result(ctx.node, error, started, [])
  File "/usr/local/lib/python3.8/dist-packages/dbt_rpc/rpc/node_runners.py", line 56, in error_result
    raise error
dbt_rpc.rpc.error.RPCException: RPCException(10003, Database Error, {'type': 'DatabaseException', 'message': "Database Error in rpc request (from remote system)\n  001003 (42000): SQL compilation error:\n  syntax error line 3 at position 32 unexpected 'is'.\n  syntax error line 4 at position 6 unexpected 'THEN'.\n  syntax error line 6 at position 29 unexpected '('.\n  syntax error line 6 at position 81 unexpected ')'.", 'raw_sql': "select user_id, is_member from\r\n(select user_id, \r\n(CASE WHEN properties_is_member is TRUE\r\n      THEN TRUE\r\n      ELSE FALSE\r\nEND) as is_member, row_number() over(partition by user_id order by timestamp desc) as rn from \r\n{{ source('ecommerce', 'identifies') }} where timestamp >= '{{ var('start_date') }}' and timestamp <= '{{ var('end_date') }}'\r\nand user_id is not null) where rn = 1\nlimit 500\n/* limit added automatically by dbt cloud */", 'compiled_sql': "select user_id, is_member from\n(select user_id, \n(CASE WHEN properties_is_member is TRUE\n      THEN TRUE\n      ELSE FALSE\nEND) as is_member, row_number() over(partition by user_id order by timestamp desc) as rn from \nanalytics_db.data_apps_simulated.identifies where timestamp >= '2021-05-01' and timestamp <= '2022-06-29'\nand user_id is not null) where rn = 1\nlimit 500\n/* limit added automatically by dbt cloud */", 'tags': None}, None)
2022-07-04 05:40:35.103090 (Thread-406): handling poll request
2022-07-04 05:40:35.103509 (Thread-406): 05:40:35  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '08022227-1dd0-4d09-94f1-e256bf2507d1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb0f0a35fd0>]}
2022-07-04 05:40:35.104242 (Thread-406): sending response (<Response 13621 bytes [200 OK]>) to 10.0.12.141
2022-07-04 05:41:30.814927 (Thread-407): handling status request
2022-07-04 05:41:30.815369 (Thread-407): 05:41:30  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '08022227-1dd0-4d09-94f1-e256bf2507d1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb0f0a35700>]}
2022-07-04 05:41:30.815943 (Thread-407): sending response (<Response 2375 bytes [200 OK]>) to 10.0.12.141
2022-07-04 05:41:31.226010 (Thread-408): handling run_sql request
2022-07-04 05:41:31.226445 (Thread-408): 05:41:31  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '08022227-1dd0-4d09-94f1-e256bf2507d1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb0f0a35b80>]}
2022-07-04 05:41:33.551699 (Thread-408): sending response (<Response 139 bytes [200 OK]>) to 10.0.12.141
2022-07-04 05:41:33.578612 (MainThread): 05:41:33  Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '1e17877e-56b2-404f-8308-843eab190526', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd97a914220>]}
2022-07-04 05:41:33.579231 (MainThread): 05:41:33  Found 12 models, 0 tests, 0 snapshots, 0 analyses, 179 macros, 0 operations, 0 seed files, 15 sources, 0 exposures, 0 metrics
2022-07-04 05:41:33.579852 (Thread-1): 05:41:33  Acquiring new snowflake connection "rpc.ecommerce_data_model_dbt.request"
2022-07-04 05:41:33.579985 (Thread-1): 05:41:33  Began compiling node rpc.ecommerce_data_model_dbt.request
2022-07-04 05:41:33.580084 (Thread-1): 05:41:33  Compiling rpc.ecommerce_data_model_dbt.request
2022-07-04 05:41:33.582740 (Thread-1): 05:41:33  finished collecting timing info
2022-07-04 05:41:33.582870 (Thread-1): 05:41:33  Began executing node rpc.ecommerce_data_model_dbt.request
2022-07-04 05:41:33.583733 (Thread-1): 05:41:33  Using snowflake connection "rpc.ecommerce_data_model_dbt.request"
2022-07-04 05:41:33.583829 (Thread-1): 05:41:33  On rpc.ecommerce_data_model_dbt.request: select user_id, is_member from
(select user_id, 
(CASE WHEN properties_is_member = TRUE
      THEN TRUE
      ELSE FALSE
END) as is_member, row_number() over(partition by user_id order by timestamp desc) as rn from 
analytics_db.data_apps_simulated.identifies where timestamp >= '2021-05-01' and timestamp <= '2022-06-29'
and user_id is not null) where rn = 1
limit 500
/* limit added automatically by dbt cloud */
2022-07-04 05:41:33.583914 (Thread-1): 05:41:33  Opening a new connection, currently in state init
2022-07-04 05:41:33.958328 (Thread-409): handling poll request
2022-07-04 05:41:33.958814 (Thread-409): 05:41:33  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '08022227-1dd0-4d09-94f1-e256bf2507d1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb0f0f0e730>]}
2022-07-04 05:41:33.959715 (Thread-409): sending response (<Response 4164 bytes [200 OK]>) to 10.0.12.141
2022-07-04 05:41:34.311652 (Thread-1): 05:41:34  SQL status: SUCCESS 5 in 0.73 seconds
2022-07-04 05:41:34.313118 (Thread-1): 05:41:34  finished collecting timing info
2022-07-04 05:41:34.313320 (Thread-1): 05:41:34  On rpc.ecommerce_data_model_dbt.request: Close
2022-07-04 05:41:35.371716 (Thread-410): handling poll request
2022-07-04 05:41:35.372117 (Thread-410): 05:41:35  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '08022227-1dd0-4d09-94f1-e256bf2507d1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb0f0f0edc0>]}
2022-07-04 05:41:35.373049 (Thread-410): sending response (<Response 5073 bytes [200 OK]>) to 10.0.12.141
2022-07-04 05:41:39.171727 (Thread-411): 05:41:39  Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
2022-07-04 05:41:39.172220 (Thread-411): 05:41:39  Partial parsing: updated file: ecommerce_data_model_dbt://models/data_model/temp_folder/is_member.sql
2022-07-04 05:41:39.176456 (Thread-411): 05:41:39  1603: static parser failed on data_model/temp_folder/is_member.sql
2022-07-04 05:41:39.180649 (Thread-411): 05:41:39  1602: parser fallback to jinja rendering on data_model/temp_folder/is_member.sql
2022-07-04 05:41:39.214734 (Thread-411): 05:41:39  [WARNING]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.data-apps-ecommerce-template.data_model

2022-07-04 05:41:39.219815 (Thread-411): 05:41:39  Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '08022227-1dd0-4d09-94f1-e256bf2507d1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb0f0933970>]}
2022-07-04 05:41:39.961689 (Thread-412): handling status request
2022-07-04 05:41:39.962189 (Thread-412): 05:41:39  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '08022227-1dd0-4d09-94f1-e256bf2507d1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb0f0b36b80>]}
2022-07-04 05:41:39.962748 (Thread-412): sending response (<Response 2375 bytes [200 OK]>) to 10.0.12.141
2022-07-04 05:41:39.979777 (Thread-413): handling status request
2022-07-04 05:41:39.980097 (Thread-413): 05:41:39  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '08022227-1dd0-4d09-94f1-e256bf2507d1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb0f09714c0>]}
2022-07-04 05:41:39.980574 (Thread-413): sending response (<Response 2375 bytes [200 OK]>) to 10.0.12.141
2022-07-04 05:41:57.219951 (Thread-414): 05:41:57  Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
2022-07-04 05:41:57.220399 (Thread-414): 05:41:57  Partial parsing: updated file: ecommerce_data_model_dbt://models/data_model/stg_user_traits.sql
2022-07-04 05:41:57.224713 (Thread-414): 05:41:57  1603: static parser failed on data_model/stg_user_traits.sql
2022-07-04 05:41:57.232438 (Thread-414): 05:41:57  1602: parser fallback to jinja rendering on data_model/stg_user_traits.sql
2022-07-04 05:41:57.267679 (Thread-414): 05:41:57  [WARNING]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.data-apps-ecommerce-template.data_model

2022-07-04 05:41:57.272740 (Thread-414): 05:41:57  Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '08022227-1dd0-4d09-94f1-e256bf2507d1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb0f08b4730>]}
2022-07-04 05:41:58.007389 (Thread-415): handling status request
2022-07-04 05:41:58.007799 (Thread-415): 05:41:58  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '08022227-1dd0-4d09-94f1-e256bf2507d1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb0f096d970>]}
2022-07-04 05:41:58.008339 (Thread-415): sending response (<Response 2357 bytes [200 OK]>) to 10.0.12.141
2022-07-04 05:41:58.160802 (Thread-416): handling status request
2022-07-04 05:41:58.161227 (Thread-416): 05:41:58  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '08022227-1dd0-4d09-94f1-e256bf2507d1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb0f096d790>]}
2022-07-04 05:41:58.161737 (Thread-416): sending response (<Response 2357 bytes [200 OK]>) to 10.0.12.141
2022-07-04 05:41:59.473456 (Thread-417): handling status request
2022-07-04 05:41:59.473863 (Thread-417): 05:41:59  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '08022227-1dd0-4d09-94f1-e256bf2507d1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb0f096d130>]}
2022-07-04 05:41:59.519139 (Thread-417): sending response (<Response 2357 bytes [200 OK]>) to 10.0.12.141
2022-07-04 05:41:59.897988 (Thread-418): handling run_sql request
2022-07-04 05:41:59.898389 (Thread-418): 05:41:59  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '08022227-1dd0-4d09-94f1-e256bf2507d1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb0f0946070>]}
2022-07-04 05:42:02.243185 (Thread-418): sending response (<Response 139 bytes [200 OK]>) to 10.0.12.141
2022-07-04 05:42:02.275330 (MainThread): 05:42:02  Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '5e9ebd83-8592-4cd9-91d4-cc6e45165749', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7feff8297220>]}
2022-07-04 05:42:02.275893 (MainThread): 05:42:02  Found 12 models, 0 tests, 0 snapshots, 0 analyses, 179 macros, 0 operations, 0 seed files, 15 sources, 0 exposures, 0 metrics
2022-07-04 05:42:02.276489 (Thread-1): 05:42:02  Acquiring new snowflake connection "rpc.ecommerce_data_model_dbt.request"
2022-07-04 05:42:02.276621 (Thread-1): 05:42:02  Began compiling node rpc.ecommerce_data_model_dbt.request
2022-07-04 05:42:02.276713 (Thread-1): 05:42:02  Compiling rpc.ecommerce_data_model_dbt.request
2022-07-04 05:42:02.283297 (Thread-1): 05:42:02  finished collecting timing info
2022-07-04 05:42:02.283434 (Thread-1): 05:42:02  Began executing node rpc.ecommerce_data_model_dbt.request
2022-07-04 05:42:02.287455 (Thread-1): 05:42:02  Using snowflake connection "rpc.ecommerce_data_model_dbt.request"
2022-07-04 05:42:02.287554 (Thread-1): 05:42:02  On rpc.ecommerce_data_model_dbt.request: with cte_gender as 
(select user_id, gender from 
(select user_id, properties_gender as gender, row_number() over(partition by user_id order by timestamp desc) as rn from 
analytics_db.data_apps_simulated.identifies where timestamp >= '2021-05-01' and timestamp <= '2022-06-29'
and properties_gender is not null and properties_gender != '') where rn = 1),

cte_age as 
(select user_id, age from
(select user_id, 
(CASE WHEN dateadd(year, datediff (year, properties_birthday, getdate()), properties_birthday) > getdate()
      THEN datediff(year, properties_birthday, getdate()) - 1
      ELSE datediff(year, properties_birthday, getdate())
 END) as age, row_number() over(partition by user_id order by timestamp desc) as rn 
from analytics_db.data_apps_simulated.identifies where timestamp >= '2021-05-01' and timestamp <= '2022-06-29'
and properties_birthday is not null and properties_birthday!='') where rn = 1),

cte_country as 
(select user_id, country from 
(select user_id, properties_country as country, row_number() over(partition by user_id order by timestamp desc) as rn from 
analytics_db.data_apps_simulated.identifies where timestamp >= '2021-05-01' and timestamp <= '2022-06-29'
and properties_country is not null and properties_country != '') where rn = 1),

cte_state as 
(select user_id, state from 
(select user_id, properties_state as state, row_number() over(partition by user_id order by timestamp desc) as rn from 
analytics_db.data_apps_simulated.identifies where timestamp >= '2021-05-01' and timestamp <= '2022-06-29'
and properties_state is not null and properties_state != '') where rn = 1),

cte_email_domain as 
(select user_id, email_domain from 
(select user_id, substring(properties_email, charindex( '@', properties_email) + 1, len(properties_email)) as email_domain, row_number() over(partition by user_id order by timestamp desc) as rn from 
analytics_db.data_apps_simulated.identifies where timestamp >= '2021-05-01' and timestamp <= '2022-06-29'
and properties_email is not null and properties_email != '') where rn = 1),

cte_is_member as 
(select user_id, is_member from
(select user_id, 
(CASE WHEN properties_is_member = TRUE
      THEN TRUE
      ELSE FALSE
END) as is_member, row_number() over(partition by user_id order by timestamp desc) as rn from 
analytics_db.data_apps_simulated.identifies where timestamp >= '2021-05-01' and timestamp <= '2022-06-29'
and user_id is not null) where rn = 1),

cte_has_mobile_app as 
(select user_id, has_mobile_app from 
(select user_id, 
(CASE WHEN context_device_type = 'android' or context_device_type = 'iOS'
      THEN TRUE
      ELSE FALSE
END) as has_mobile_app, row_number() over(partition by user_id order by timestamp desc) as rn from 
analytics_db.data_apps_simulated.identifies where timestamp >= '2021-05-01' and timestamp <= '2022-06-29'
and context_device_type is not null and context_device_type != '' and user_id is not null) where rn = 1)

select coalesce(a.user_id, b.user_id, c.user_id, d.user_id, e.user_id, f.user_id, g.user_id) 
as user_id, gender, age, country, state, email_domain, is_member, has_mobile_app
from (((((cte_gender a full outer join cte_age b on a.user_id = b.user_id) 
full outer join cte_country c on c.user_id = coalesce(a.user_id, b.user_id))
full outer join cte_state d on d.user_id = coalesce(a.user_id, b.user_id, c.user_id))
full outer join cte_email_domain e on e.user_id = coalesce(a.user_id, b.user_id, c.user_id,d.user_id))
full outer join cte_is_member f on f.user_id = coalesce(a.user_id, b.user_id, c.user_id,d.user_id, e.user_id))
full outer join cte_has_mobile_app g on g.user_id = coalesce(a.user_id, b.user_id, c.user_id,d.user_id, e.user_id, f.user_id)
limit 500
/* limit added automatically by dbt cloud */
2022-07-04 05:42:02.287637 (Thread-1): 05:42:02  Opening a new connection, currently in state init
2022-07-04 05:42:02.618501 (Thread-419): handling poll request
2022-07-04 05:42:02.618980 (Thread-419): 05:42:02  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '08022227-1dd0-4d09-94f1-e256bf2507d1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb0f0a20520>]}
2022-07-04 05:42:02.619914 (Thread-419): sending response (<Response 7547 bytes [200 OK]>) to 10.0.12.141
2022-07-04 05:42:03.934905 (Thread-1): 05:42:03  SQL status: SUCCESS 5 in 1.65 seconds
2022-07-04 05:42:03.936499 (Thread-1): 05:42:03  finished collecting timing info
2022-07-04 05:42:03.936682 (Thread-1): 05:42:03  On rpc.ecommerce_data_model_dbt.request: Close
2022-07-04 05:42:03.996583 (Thread-420): handling poll request
2022-07-04 05:42:03.997012 (Thread-420): 05:42:03  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '08022227-1dd0-4d09-94f1-e256bf2507d1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb0f0a20130>]}
2022-07-04 05:42:03.997566 (Thread-420): sending response (<Response 1387 bytes [200 OK]>) to 10.0.12.141
2022-07-04 05:42:05.398100 (Thread-421): handling poll request
2022-07-04 05:42:05.398509 (Thread-421): 05:42:05  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '08022227-1dd0-4d09-94f1-e256bf2507d1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb0f0f0e160>]}
2022-07-04 05:42:05.399517 (Thread-421): sending response (<Response 18687 bytes [200 OK]>) to 10.0.12.141
2022-07-04 05:44:34.785127 (Thread-422): 05:44:34  Partial parsing enabled: 0 files deleted, 1 files added, 0 files changed.
2022-07-04 05:44:34.786978 (Thread-422): 05:44:34  Partial parsing: added file: ecommerce_data_model_dbt://models/data_model/temp_folder/utm_url_sequence.sql
2022-07-04 05:44:34.792033 (Thread-422): 05:44:34  1699: static parser successfully parsed data_model/temp_folder/utm_url_sequence.sql
2022-07-04 05:44:34.834239 (Thread-422): 05:44:34  [WARNING]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.data-apps-ecommerce-template.data_model

2022-07-04 05:44:34.839604 (Thread-422): 05:44:34  Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '08022227-1dd0-4d09-94f1-e256bf2507d1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb0f0832490>]}
2022-07-04 05:44:35.627124 (Thread-423): handling status request
2022-07-04 05:44:35.627589 (Thread-423): 05:44:35  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '08022227-1dd0-4d09-94f1-e256bf2507d1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb0f09cf0a0>]}
2022-07-04 05:44:35.628136 (Thread-423): sending response (<Response 2075 bytes [200 OK]>) to 10.0.12.141
2022-07-04 05:44:35.691549 (Thread-424): handling status request
2022-07-04 05:44:35.691941 (Thread-424): 05:44:35  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '08022227-1dd0-4d09-94f1-e256bf2507d1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb0f0a20730>]}
2022-07-04 05:44:35.692437 (Thread-424): sending response (<Response 2075 bytes [200 OK]>) to 10.0.12.141
2022-07-04 05:46:13.942534 (Thread-425): 05:46:13  Partial parsing enabled: 0 files deleted, 1 files added, 0 files changed.
2022-07-04 05:46:13.943545 (Thread-425): 05:46:13  Partial parsing: added file: ecommerce_data_model_dbt://models/data_model/temp_folder/is_active_on_website.sql
2022-07-04 05:46:13.947287 (Thread-425): 05:46:13  1699: static parser successfully parsed data_model/temp_folder/is_active_on_website.sql
2022-07-04 05:46:13.980628 (Thread-425): 05:46:13  [WARNING]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.data-apps-ecommerce-template.data_model

2022-07-04 05:46:13.985964 (Thread-425): 05:46:13  Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '08022227-1dd0-4d09-94f1-e256bf2507d1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb0f0777c10>]}
2022-07-04 05:46:14.765095 (Thread-426): handling status request
2022-07-04 05:46:14.765501 (Thread-426): 05:46:14  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '08022227-1dd0-4d09-94f1-e256bf2507d1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb0f07570d0>]}
2022-07-04 05:46:14.766034 (Thread-426): sending response (<Response 2083 bytes [200 OK]>) to 10.0.12.141
2022-07-04 05:46:14.815220 (Thread-427): handling status request
2022-07-04 05:46:14.815667 (Thread-427): 05:46:14  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '08022227-1dd0-4d09-94f1-e256bf2507d1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb0f0962610>]}
2022-07-04 05:46:14.816171 (Thread-427): sending response (<Response 2083 bytes [200 OK]>) to 10.0.12.141
2022-07-04 05:47:02.853153 (Thread-428): 05:47:02  Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
2022-07-04 05:47:02.853687 (Thread-428): 05:47:02  Partial parsing: updated file: ecommerce_data_model_dbt://models/data_model/temp_folder/is_active_on_website.sql
2022-07-04 05:47:02.857696 (Thread-428): 05:47:02  1603: static parser failed on data_model/temp_folder/is_active_on_website.sql
2022-07-04 05:47:02.861660 (Thread-428): 05:47:02  1602: parser fallback to jinja rendering on data_model/temp_folder/is_active_on_website.sql
2022-07-04 05:47:02.898451 (Thread-428): 05:47:02  [WARNING]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.data-apps-ecommerce-template.data_model

2022-07-04 05:47:02.904623 (Thread-428): 05:47:02  Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '08022227-1dd0-4d09-94f1-e256bf2507d1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb0f069e4c0>]}
2022-07-04 05:47:03.631185 (Thread-429): handling status request
2022-07-04 05:47:03.631613 (Thread-429): 05:47:03  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '08022227-1dd0-4d09-94f1-e256bf2507d1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb0f074d580>]}
2022-07-04 05:47:03.632157 (Thread-429): sending response (<Response 2408 bytes [200 OK]>) to 10.0.12.141
2022-07-04 05:47:03.638054 (Thread-430): handling status request
2022-07-04 05:47:03.638359 (Thread-430): 05:47:03  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '08022227-1dd0-4d09-94f1-e256bf2507d1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb0f074d3a0>]}
2022-07-04 05:47:03.638775 (Thread-430): sending response (<Response 2408 bytes [200 OK]>) to 10.0.12.141
2022-07-04 05:47:04.505873 (Thread-431): handling status request
2022-07-04 05:47:04.506337 (Thread-431): 05:47:04  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '08022227-1dd0-4d09-94f1-e256bf2507d1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb0f074d2e0>]}
2022-07-04 05:47:04.506839 (Thread-431): sending response (<Response 2408 bytes [200 OK]>) to 10.0.12.141
2022-07-04 05:47:04.888624 (Thread-432): handling run_sql request
2022-07-04 05:47:04.889027 (Thread-432): 05:47:04  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '08022227-1dd0-4d09-94f1-e256bf2507d1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb0f08afc40>]}
2022-07-04 05:47:07.195870 (Thread-432): sending response (<Response 139 bytes [200 OK]>) to 10.0.12.141
2022-07-04 05:47:07.221088 (MainThread): 05:47:07  Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '0a347e1e-7fae-45e5-8a62-17b5925a0c21', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9d420d5730>]}
2022-07-04 05:47:07.221656 (MainThread): 05:47:07  Found 14 models, 0 tests, 0 snapshots, 0 analyses, 179 macros, 0 operations, 0 seed files, 15 sources, 0 exposures, 0 metrics
2022-07-04 05:47:07.222302 (Thread-1): 05:47:07  Acquiring new snowflake connection "rpc.ecommerce_data_model_dbt.request"
2022-07-04 05:47:07.222437 (Thread-1): 05:47:07  Began compiling node rpc.ecommerce_data_model_dbt.request
2022-07-04 05:47:07.222534 (Thread-1): 05:47:07  Compiling rpc.ecommerce_data_model_dbt.request
2022-07-04 05:47:07.225066 (Thread-1): 05:47:07  finished collecting timing info
2022-07-04 05:47:07.225199 (Thread-1): 05:47:07  Began executing node rpc.ecommerce_data_model_dbt.request
2022-07-04 05:47:07.226120 (Thread-1): 05:47:07  Using snowflake connection "rpc.ecommerce_data_model_dbt.request"
2022-07-04 05:47:07.226213 (Thread-1): 05:47:07  On rpc.ecommerce_data_model_dbt.request: select user_id, is_active_on_website from 
(select user_id, 
(CASE WHEN context_device_type like "%PC"
      THEN TRUE
      ELSE FALSE
END) as has_mobile_app, row_number() over(partition by user_id order by timestamp desc) as rn from 
analytics_db.data_apps_simulated.identifies where timestamp >= '2021-05-01' and timestamp <= '2022-06-29'
and context_device_type is not null and context_device_type != '' and user_id is not null) where rn = 1
limit 500
/* limit added automatically by dbt cloud */
2022-07-04 05:47:07.226294 (Thread-1): 05:47:07  Opening a new connection, currently in state init
2022-07-04 05:47:07.562759 (Thread-433): handling poll request
2022-07-04 05:47:07.563245 (Thread-433): 05:47:07  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '08022227-1dd0-4d09-94f1-e256bf2507d1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb0f07aa490>]}
2022-07-04 05:47:07.564205 (Thread-433): sending response (<Response 4263 bytes [200 OK]>) to 10.0.12.141
2022-07-04 05:47:07.884987 (Thread-1): 05:47:07  Snowflake adapter: Snowflake query id: 01a55ffb-0602-3238-0019-82030465e192
2022-07-04 05:47:07.885192 (Thread-1): 05:47:07  Snowflake adapter: Snowflake error: 000904 (42000): SQL compilation error: error line 3 at position 36
invalid identifier '"%PC"'
2022-07-04 05:47:07.885358 (Thread-1): 05:47:07  finished collecting timing info
2022-07-04 05:47:07.885514 (Thread-1): 05:47:07  On rpc.ecommerce_data_model_dbt.request: Close
2022-07-04 05:47:07.934368 (Thread-1): Got an exception: Database Error
  000904 (42000): SQL compilation error: error line 3 at position 36
  invalid identifier '"%PC"'
Traceback (most recent call last):
  File "/usr/local/lib/python3.8/dist-packages/dbt/adapters/snowflake/connections.py", line 206, in exception_handler
    yield
  File "/usr/local/lib/python3.8/dist-packages/dbt/adapters/sql/connections.py", line 74, in add_query
    cursor.execute(sql, bindings)
  File "/usr/local/lib/python3.8/dist-packages/snowflake/connector/cursor.py", line 721, in execute
    Error.errorhandler_wrapper(
  File "/usr/local/lib/python3.8/dist-packages/snowflake/connector/errors.py", line 258, in errorhandler_wrapper
    cursor.errorhandler(connection, cursor, error_class, error_value)
  File "/usr/local/lib/python3.8/dist-packages/snowflake/connector/errors.py", line 188, in default_errorhandler
    raise error_class(
snowflake.connector.errors.ProgrammingError: 000904 (42000): SQL compilation error: error line 3 at position 36
invalid identifier '"%PC"'

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/usr/local/lib/python3.8/dist-packages/dbt/task/base.py", line 361, in safe_run
    result = self.compile_and_execute(manifest, ctx)
  File "/usr/local/lib/python3.8/dist-packages/dbt/task/base.py", line 314, in compile_and_execute
    result = self.run(ctx.node, manifest)
  File "/usr/local/lib/python3.8/dist-packages/dbt/task/base.py", line 403, in run
    return self.execute(compiled_node, manifest)
  File "/usr/local/lib/python3.8/dist-packages/dbt_rpc/rpc/node_runners.py", line 90, in execute
    _, execute_result = self.adapter.execute(
  File "/usr/local/lib/python3.8/dist-packages/dbt/adapters/base/impl.py", line 225, in execute
    return self.connections.execute(
  File "/usr/local/lib/python3.8/dist-packages/dbt/adapters/sql/connections.py", line 127, in execute
    _, cursor = self.add_query(sql, auto_begin)
  File "/usr/local/lib/python3.8/dist-packages/dbt/adapters/snowflake/connections.py", line 433, in add_query
    connection, cursor = super().add_query(
  File "/usr/local/lib/python3.8/dist-packages/dbt/adapters/sql/connections.py", line 83, in add_query
    return connection, cursor
  File "/usr/lib/python3.8/contextlib.py", line 131, in __exit__
    self.gen.throw(type, value, traceback)
  File "/usr/local/lib/python3.8/dist-packages/dbt/adapters/snowflake/connections.py", line 223, in exception_handler
    raise DatabaseException(msg)
dbt.exceptions.DatabaseException: Database Error
  000904 (42000): SQL compilation error: error line 3 at position 36
  invalid identifier '"%PC"'
2022-07-04 05:47:07.935250 (Thread-1): Got exception RPCException(10003, Database Error, {'type': 'DatabaseException', 'message': 'Database Error in rpc request (from remote system)\n  000904 (42000): SQL compilation error: error line 3 at position 36\n  invalid identifier \'"%PC"\'', 'raw_sql': 'select user_id, is_active_on_website from \r\n(select user_id, \r\n(CASE WHEN context_device_type like "%PC"\r\n      THEN TRUE\r\n      ELSE FALSE\r\nEND) as has_mobile_app, row_number() over(partition by user_id order by timestamp desc) as rn from \r\n{{ source(\'ecommerce\', \'identifies\') }} where timestamp >= \'{{ var(\'start_date\') }}\' and timestamp <= \'{{ var(\'end_date\') }}\'\r\nand context_device_type is not null and context_device_type != \'\' and user_id is not null) where rn = 1\nlimit 500\n/* limit added automatically by dbt cloud */', 'compiled_sql': 'select user_id, is_active_on_website from \n(select user_id, \n(CASE WHEN context_device_type like "%PC"\n      THEN TRUE\n      ELSE FALSE\nEND) as has_mobile_app, row_number() over(partition by user_id order by timestamp desc) as rn from \nanalytics_db.data_apps_simulated.identifies where timestamp >= \'2021-05-01\' and timestamp <= \'2022-06-29\'\nand context_device_type is not null and context_device_type != \'\' and user_id is not null) where rn = 1\nlimit 500\n/* limit added automatically by dbt cloud */', 'tags': None}, None)
Traceback (most recent call last):
  File "/usr/local/lib/python3.8/dist-packages/dbt_rpc/task/sql_commands.py", line 147, in _in_thread
    self.node_results.append(runner.safe_run(self.manifest))
  File "/usr/local/lib/python3.8/dist-packages/dbt/task/base.py", line 377, in safe_run
    result = self.error_result(ctx.node, error, started, [])
  File "/usr/local/lib/python3.8/dist-packages/dbt_rpc/rpc/node_runners.py", line 56, in error_result
    raise error
dbt_rpc.rpc.error.RPCException: RPCException(10003, Database Error, {'type': 'DatabaseException', 'message': 'Database Error in rpc request (from remote system)\n  000904 (42000): SQL compilation error: error line 3 at position 36\n  invalid identifier \'"%PC"\'', 'raw_sql': 'select user_id, is_active_on_website from \r\n(select user_id, \r\n(CASE WHEN context_device_type like "%PC"\r\n      THEN TRUE\r\n      ELSE FALSE\r\nEND) as has_mobile_app, row_number() over(partition by user_id order by timestamp desc) as rn from \r\n{{ source(\'ecommerce\', \'identifies\') }} where timestamp >= \'{{ var(\'start_date\') }}\' and timestamp <= \'{{ var(\'end_date\') }}\'\r\nand context_device_type is not null and context_device_type != \'\' and user_id is not null) where rn = 1\nlimit 500\n/* limit added automatically by dbt cloud */', 'compiled_sql': 'select user_id, is_active_on_website from \n(select user_id, \n(CASE WHEN context_device_type like "%PC"\n      THEN TRUE\n      ELSE FALSE\nEND) as has_mobile_app, row_number() over(partition by user_id order by timestamp desc) as rn from \nanalytics_db.data_apps_simulated.identifies where timestamp >= \'2021-05-01\' and timestamp <= \'2022-06-29\'\nand context_device_type is not null and context_device_type != \'\' and user_id is not null) where rn = 1\nlimit 500\n/* limit added automatically by dbt cloud */', 'tags': None}, None)
2022-07-04 05:47:08.932771 (Thread-434): handling poll request
2022-07-04 05:47:08.933197 (Thread-434): 05:47:08  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '08022227-1dd0-4d09-94f1-e256bf2507d1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb0f07aa220>]}
2022-07-04 05:47:08.933892 (Thread-434): sending response (<Response 13210 bytes [200 OK]>) to 10.0.12.141
2022-07-04 05:47:35.035432 (Thread-435): 05:47:35  Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
2022-07-04 05:47:35.035976 (Thread-435): 05:47:35  Partial parsing: updated file: ecommerce_data_model_dbt://models/data_model/temp_folder/is_active_on_website.sql
2022-07-04 05:47:35.040677 (Thread-435): 05:47:35  1603: static parser failed on data_model/temp_folder/is_active_on_website.sql
2022-07-04 05:47:35.044599 (Thread-435): 05:47:35  1602: parser fallback to jinja rendering on data_model/temp_folder/is_active_on_website.sql
2022-07-04 05:47:35.081527 (Thread-435): 05:47:35  [WARNING]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.data-apps-ecommerce-template.data_model

2022-07-04 05:47:35.087010 (Thread-435): 05:47:35  Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '08022227-1dd0-4d09-94f1-e256bf2507d1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb0f0634520>]}
2022-07-04 05:47:35.760637 (Thread-436): handling status request
2022-07-04 05:47:35.761070 (Thread-436): 05:47:35  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '08022227-1dd0-4d09-94f1-e256bf2507d1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb0f0699460>]}
2022-07-04 05:47:35.761616 (Thread-436): sending response (<Response 2408 bytes [200 OK]>) to 10.0.12.141
2022-07-04 05:47:35.819579 (Thread-437): handling status request
2022-07-04 05:47:35.819993 (Thread-437): 05:47:35  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '08022227-1dd0-4d09-94f1-e256bf2507d1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb0f06991f0>]}
2022-07-04 05:47:35.820514 (Thread-437): sending response (<Response 2408 bytes [200 OK]>) to 10.0.12.141
2022-07-04 05:47:36.380097 (Thread-438): handling status request
2022-07-04 05:47:36.380497 (Thread-438): 05:47:36  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '08022227-1dd0-4d09-94f1-e256bf2507d1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb0f0699100>]}
2022-07-04 05:47:36.380989 (Thread-438): sending response (<Response 2408 bytes [200 OK]>) to 10.0.12.141
2022-07-04 05:47:36.781973 (Thread-439): handling run_sql request
2022-07-04 05:47:36.782373 (Thread-439): 05:47:36  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '08022227-1dd0-4d09-94f1-e256bf2507d1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb0f08210a0>]}
2022-07-04 05:47:39.148523 (Thread-439): sending response (<Response 139 bytes [200 OK]>) to 10.0.12.141
2022-07-04 05:47:39.173768 (MainThread): 05:47:39  Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '886e6b98-e96d-46d3-866a-33ff3c01217b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7241aa7670>]}
2022-07-04 05:47:39.174351 (MainThread): 05:47:39  Found 14 models, 0 tests, 0 snapshots, 0 analyses, 179 macros, 0 operations, 0 seed files, 15 sources, 0 exposures, 0 metrics
2022-07-04 05:47:39.174961 (Thread-1): 05:47:39  Acquiring new snowflake connection "rpc.ecommerce_data_model_dbt.request"
2022-07-04 05:47:39.175099 (Thread-1): 05:47:39  Began compiling node rpc.ecommerce_data_model_dbt.request
2022-07-04 05:47:39.175198 (Thread-1): 05:47:39  Compiling rpc.ecommerce_data_model_dbt.request
2022-07-04 05:47:39.177783 (Thread-1): 05:47:39  finished collecting timing info
2022-07-04 05:47:39.177959 (Thread-1): 05:47:39  Began executing node rpc.ecommerce_data_model_dbt.request
2022-07-04 05:47:39.178891 (Thread-1): 05:47:39  Using snowflake connection "rpc.ecommerce_data_model_dbt.request"
2022-07-04 05:47:39.178988 (Thread-1): 05:47:39  On rpc.ecommerce_data_model_dbt.request: select user_id, is_active_on_website from 
(select user_id, 
(CASE WHEN context_device_type like '%PC'
      THEN TRUE
      ELSE FALSE
END) as has_mobile_app, row_number() over(partition by user_id order by timestamp desc) as rn from 
analytics_db.data_apps_simulated.identifies where timestamp >= '2021-05-01' and timestamp <= '2022-06-29'
and context_device_type is not null and context_device_type != '' and user_id is not null) where rn = 1
limit 500
/* limit added automatically by dbt cloud */
2022-07-04 05:47:39.179074 (Thread-1): 05:47:39  Opening a new connection, currently in state init
2022-07-04 05:47:39.541763 (Thread-440): handling poll request
2022-07-04 05:47:39.542266 (Thread-440): 05:47:39  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '08022227-1dd0-4d09-94f1-e256bf2507d1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb0f0600670>]}
2022-07-04 05:47:39.543163 (Thread-440): sending response (<Response 4261 bytes [200 OK]>) to 10.0.12.141
2022-07-04 05:47:39.821957 (Thread-1): 05:47:39  Snowflake adapter: Snowflake query id: 01a55ffb-0602-2ed5-0019-82030465d816
2022-07-04 05:47:39.822180 (Thread-1): 05:47:39  Snowflake adapter: Snowflake error: 000904 (42000): SQL compilation error: error line 1 at position 16
invalid identifier 'IS_ACTIVE_ON_WEBSITE'
2022-07-04 05:47:39.822348 (Thread-1): 05:47:39  finished collecting timing info
2022-07-04 05:47:39.822510 (Thread-1): 05:47:39  On rpc.ecommerce_data_model_dbt.request: Close
2022-07-04 05:47:39.882074 (Thread-1): Got an exception: Database Error
  000904 (42000): SQL compilation error: error line 1 at position 16
  invalid identifier 'IS_ACTIVE_ON_WEBSITE'
Traceback (most recent call last):
  File "/usr/local/lib/python3.8/dist-packages/dbt/adapters/snowflake/connections.py", line 206, in exception_handler
    yield
  File "/usr/local/lib/python3.8/dist-packages/dbt/adapters/sql/connections.py", line 74, in add_query
    cursor.execute(sql, bindings)
  File "/usr/local/lib/python3.8/dist-packages/snowflake/connector/cursor.py", line 721, in execute
    Error.errorhandler_wrapper(
  File "/usr/local/lib/python3.8/dist-packages/snowflake/connector/errors.py", line 258, in errorhandler_wrapper
    cursor.errorhandler(connection, cursor, error_class, error_value)
  File "/usr/local/lib/python3.8/dist-packages/snowflake/connector/errors.py", line 188, in default_errorhandler
    raise error_class(
snowflake.connector.errors.ProgrammingError: 000904 (42000): SQL compilation error: error line 1 at position 16
invalid identifier 'IS_ACTIVE_ON_WEBSITE'

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/usr/local/lib/python3.8/dist-packages/dbt/task/base.py", line 361, in safe_run
    result = self.compile_and_execute(manifest, ctx)
  File "/usr/local/lib/python3.8/dist-packages/dbt/task/base.py", line 314, in compile_and_execute
    result = self.run(ctx.node, manifest)
  File "/usr/local/lib/python3.8/dist-packages/dbt/task/base.py", line 403, in run
    return self.execute(compiled_node, manifest)
  File "/usr/local/lib/python3.8/dist-packages/dbt_rpc/rpc/node_runners.py", line 90, in execute
    _, execute_result = self.adapter.execute(
  File "/usr/local/lib/python3.8/dist-packages/dbt/adapters/base/impl.py", line 225, in execute
    return self.connections.execute(
  File "/usr/local/lib/python3.8/dist-packages/dbt/adapters/sql/connections.py", line 127, in execute
    _, cursor = self.add_query(sql, auto_begin)
  File "/usr/local/lib/python3.8/dist-packages/dbt/adapters/snowflake/connections.py", line 433, in add_query
    connection, cursor = super().add_query(
  File "/usr/local/lib/python3.8/dist-packages/dbt/adapters/sql/connections.py", line 83, in add_query
    return connection, cursor
  File "/usr/lib/python3.8/contextlib.py", line 131, in __exit__
    self.gen.throw(type, value, traceback)
  File "/usr/local/lib/python3.8/dist-packages/dbt/adapters/snowflake/connections.py", line 223, in exception_handler
    raise DatabaseException(msg)
dbt.exceptions.DatabaseException: Database Error
  000904 (42000): SQL compilation error: error line 1 at position 16
  invalid identifier 'IS_ACTIVE_ON_WEBSITE'
2022-07-04 05:47:39.883032 (Thread-1): Got exception RPCException(10003, Database Error, {'type': 'DatabaseException', 'message': "Database Error in rpc request (from remote system)\n  000904 (42000): SQL compilation error: error line 1 at position 16\n  invalid identifier 'IS_ACTIVE_ON_WEBSITE'", 'raw_sql': "select user_id, is_active_on_website from \r\n(select user_id, \r\n(CASE WHEN context_device_type like '%PC'\r\n      THEN TRUE\r\n      ELSE FALSE\r\nEND) as has_mobile_app, row_number() over(partition by user_id order by timestamp desc) as rn from \r\n{{ source('ecommerce', 'identifies') }} where timestamp >= '{{ var('start_date') }}' and timestamp <= '{{ var('end_date') }}'\r\nand context_device_type is not null and context_device_type != '' and user_id is not null) where rn = 1\nlimit 500\n/* limit added automatically by dbt cloud */", 'compiled_sql': "select user_id, is_active_on_website from \n(select user_id, \n(CASE WHEN context_device_type like '%PC'\n      THEN TRUE\n      ELSE FALSE\nEND) as has_mobile_app, row_number() over(partition by user_id order by timestamp desc) as rn from \nanalytics_db.data_apps_simulated.identifies where timestamp >= '2021-05-01' and timestamp <= '2022-06-29'\nand context_device_type is not null and context_device_type != '' and user_id is not null) where rn = 1\nlimit 500\n/* limit added automatically by dbt cloud */", 'tags': None}, None)
Traceback (most recent call last):
  File "/usr/local/lib/python3.8/dist-packages/dbt_rpc/task/sql_commands.py", line 147, in _in_thread
    self.node_results.append(runner.safe_run(self.manifest))
  File "/usr/local/lib/python3.8/dist-packages/dbt/task/base.py", line 377, in safe_run
    result = self.error_result(ctx.node, error, started, [])
  File "/usr/local/lib/python3.8/dist-packages/dbt_rpc/rpc/node_runners.py", line 56, in error_result
    raise error
dbt_rpc.rpc.error.RPCException: RPCException(10003, Database Error, {'type': 'DatabaseException', 'message': "Database Error in rpc request (from remote system)\n  000904 (42000): SQL compilation error: error line 1 at position 16\n  invalid identifier 'IS_ACTIVE_ON_WEBSITE'", 'raw_sql': "select user_id, is_active_on_website from \r\n(select user_id, \r\n(CASE WHEN context_device_type like '%PC'\r\n      THEN TRUE\r\n      ELSE FALSE\r\nEND) as has_mobile_app, row_number() over(partition by user_id order by timestamp desc) as rn from \r\n{{ source('ecommerce', 'identifies') }} where timestamp >= '{{ var('start_date') }}' and timestamp <= '{{ var('end_date') }}'\r\nand context_device_type is not null and context_device_type != '' and user_id is not null) where rn = 1\nlimit 500\n/* limit added automatically by dbt cloud */", 'compiled_sql': "select user_id, is_active_on_website from \n(select user_id, \n(CASE WHEN context_device_type like '%PC'\n      THEN TRUE\n      ELSE FALSE\nEND) as has_mobile_app, row_number() over(partition by user_id order by timestamp desc) as rn from \nanalytics_db.data_apps_simulated.identifies where timestamp >= '2021-05-01' and timestamp <= '2022-06-29'\nand context_device_type is not null and context_device_type != '' and user_id is not null) where rn = 1\nlimit 500\n/* limit added automatically by dbt cloud */", 'tags': None}, None)
2022-07-04 05:47:40.930526 (Thread-441): handling poll request
2022-07-04 05:47:40.930933 (Thread-441): 05:47:40  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '08022227-1dd0-4d09-94f1-e256bf2507d1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb0f074daf0>]}
2022-07-04 05:47:40.931598 (Thread-441): sending response (<Response 13211 bytes [200 OK]>) to 10.0.12.141
2022-07-04 05:48:00.953662 (Thread-442): 05:48:00  Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
2022-07-04 05:48:00.954264 (Thread-442): 05:48:00  Partial parsing: updated file: ecommerce_data_model_dbt://models/data_model/temp_folder/is_active_on_website.sql
2022-07-04 05:48:00.958497 (Thread-442): 05:48:00  1603: static parser failed on data_model/temp_folder/is_active_on_website.sql
2022-07-04 05:48:00.962685 (Thread-442): 05:48:00  1602: parser fallback to jinja rendering on data_model/temp_folder/is_active_on_website.sql
2022-07-04 05:48:00.999057 (Thread-442): 05:48:00  [WARNING]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.data-apps-ecommerce-template.data_model

2022-07-04 05:48:01.004181 (Thread-442): 05:48:01  Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '08022227-1dd0-4d09-94f1-e256bf2507d1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb0f0528f70>]}
2022-07-04 05:48:01.664009 (Thread-443): handling status request
2022-07-04 05:48:01.664422 (Thread-443): 05:48:01  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '08022227-1dd0-4d09-94f1-e256bf2507d1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb0f0563730>]}
2022-07-04 05:48:01.664954 (Thread-443): sending response (<Response 2408 bytes [200 OK]>) to 10.0.12.141
2022-07-04 05:48:01.722711 (Thread-444): handling status request
2022-07-04 05:48:01.723102 (Thread-444): 05:48:01  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '08022227-1dd0-4d09-94f1-e256bf2507d1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb0f0563670>]}
2022-07-04 05:48:01.723598 (Thread-444): sending response (<Response 2408 bytes [200 OK]>) to 10.0.12.141
2022-07-04 05:48:02.012232 (Thread-445): handling status request
2022-07-04 05:48:02.012634 (Thread-445): 05:48:02  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '08022227-1dd0-4d09-94f1-e256bf2507d1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb0f0563c40>]}
2022-07-04 05:48:02.013115 (Thread-445): sending response (<Response 2408 bytes [200 OK]>) to 10.0.12.141
2022-07-04 05:48:02.416777 (Thread-446): handling run_sql request
2022-07-04 05:48:02.417249 (Thread-446): 05:48:02  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '08022227-1dd0-4d09-94f1-e256bf2507d1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb0f0563af0>]}
2022-07-04 05:48:04.755667 (Thread-446): sending response (<Response 139 bytes [200 OK]>) to 10.0.12.141
2022-07-04 05:48:04.781079 (MainThread): 05:48:04  Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'a7e995e9-d3f3-4193-854e-99ca30bad734', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6b3d04c640>]}
2022-07-04 05:48:04.781650 (MainThread): 05:48:04  Found 14 models, 0 tests, 0 snapshots, 0 analyses, 179 macros, 0 operations, 0 seed files, 15 sources, 0 exposures, 0 metrics
2022-07-04 05:48:04.782291 (Thread-1): 05:48:04  Acquiring new snowflake connection "rpc.ecommerce_data_model_dbt.request"
2022-07-04 05:48:04.782426 (Thread-1): 05:48:04  Began compiling node rpc.ecommerce_data_model_dbt.request
2022-07-04 05:48:04.782526 (Thread-1): 05:48:04  Compiling rpc.ecommerce_data_model_dbt.request
2022-07-04 05:48:04.785103 (Thread-1): 05:48:04  finished collecting timing info
2022-07-04 05:48:04.785238 (Thread-1): 05:48:04  Began executing node rpc.ecommerce_data_model_dbt.request
2022-07-04 05:48:04.786176 (Thread-1): 05:48:04  Using snowflake connection "rpc.ecommerce_data_model_dbt.request"
2022-07-04 05:48:04.786270 (Thread-1): 05:48:04  On rpc.ecommerce_data_model_dbt.request: select user_id, is_active_on_website from 
(select user_id, 
(CASE WHEN context_device_type like '%PC'
      THEN TRUE
      ELSE FALSE
END) as is_active_on_website, row_number() over(partition by user_id order by timestamp desc) as rn from 
analytics_db.data_apps_simulated.identifies where timestamp >= '2021-05-01' and timestamp <= '2022-06-29'
and context_device_type is not null and context_device_type != '' and user_id is not null) where rn = 1
limit 500
/* limit added automatically by dbt cloud */
2022-07-04 05:48:04.786353 (Thread-1): 05:48:04  Opening a new connection, currently in state init
2022-07-04 05:48:05.124218 (Thread-447): handling poll request
2022-07-04 05:48:05.124688 (Thread-447): 05:48:05  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '08022227-1dd0-4d09-94f1-e256bf2507d1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb0f06325e0>]}
2022-07-04 05:48:05.185107 (Thread-447): sending response (<Response 4267 bytes [200 OK]>) to 10.0.12.141
2022-07-04 05:48:06.124964 (Thread-1): 05:48:06  SQL status: SUCCESS 5 in 1.34 seconds
2022-07-04 05:48:06.126951 (Thread-1): 05:48:06  finished collecting timing info
2022-07-04 05:48:06.127184 (Thread-1): 05:48:06  On rpc.ecommerce_data_model_dbt.request: Close
2022-07-04 05:48:07.382636 (Thread-448): handling poll request
2022-07-04 05:48:07.383046 (Thread-448): 05:48:07  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '08022227-1dd0-4d09-94f1-e256bf2507d1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb0f05275b0>]}
2022-07-04 05:48:07.383954 (Thread-448): sending response (<Response 5461 bytes [200 OK]>) to 10.0.12.141
2022-07-04 05:51:07.066969 (Thread-449): 05:51:07  Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
2022-07-04 05:51:07.068857 (Thread-449): 05:51:07  Partial parsing: updated file: ecommerce_data_model_dbt://models/data_model/temp_folder/is_active_on_website.sql
2022-07-04 05:51:07.073293 (Thread-449): 05:51:07  1603: static parser failed on data_model/temp_folder/is_active_on_website.sql
2022-07-04 05:51:07.077833 (Thread-449): 05:51:07  1602: parser fallback to jinja rendering on data_model/temp_folder/is_active_on_website.sql
2022-07-04 05:51:07.111879 (Thread-449): 05:51:07  [WARNING]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.data-apps-ecommerce-template.data_model

2022-07-04 05:51:07.118149 (Thread-449): 05:51:07  Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '08022227-1dd0-4d09-94f1-e256bf2507d1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb0f04b3340>]}
2022-07-04 05:51:07.814311 (Thread-450): handling status request
2022-07-04 05:51:07.814730 (Thread-450): 05:51:07  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '08022227-1dd0-4d09-94f1-e256bf2507d1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb0f04a29d0>]}
2022-07-04 05:51:07.815276 (Thread-450): sending response (<Response 2408 bytes [200 OK]>) to 10.0.12.141
2022-07-04 05:51:07.845037 (Thread-451): handling status request
2022-07-04 05:51:07.845473 (Thread-451): 05:51:07  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '08022227-1dd0-4d09-94f1-e256bf2507d1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb0f04a2f10>]}
2022-07-04 05:51:07.846018 (Thread-451): sending response (<Response 2408 bytes [200 OK]>) to 10.0.12.141
2022-07-04 05:51:08.587126 (Thread-452): handling status request
2022-07-04 05:51:08.587538 (Thread-452): 05:51:08  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '08022227-1dd0-4d09-94f1-e256bf2507d1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb0f04a24c0>]}
2022-07-04 05:51:08.588057 (Thread-452): sending response (<Response 2408 bytes [200 OK]>) to 10.0.12.141
2022-07-04 05:51:08.991922 (Thread-453): handling run_sql request
2022-07-04 05:51:08.992326 (Thread-453): 05:51:08  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '08022227-1dd0-4d09-94f1-e256bf2507d1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb0f04a2d30>]}
2022-07-04 05:51:11.337740 (Thread-453): sending response (<Response 139 bytes [200 OK]>) to 10.0.12.141
2022-07-04 05:51:11.364578 (MainThread): 05:51:11  Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'c3b974d6-870a-46cc-a6bb-c8eb16c3fb0c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0ef2955730>]}
2022-07-04 05:51:11.365167 (MainThread): 05:51:11  Found 14 models, 0 tests, 0 snapshots, 0 analyses, 179 macros, 0 operations, 0 seed files, 15 sources, 0 exposures, 0 metrics
2022-07-04 05:51:11.365796 (Thread-1): 05:51:11  Acquiring new snowflake connection "rpc.ecommerce_data_model_dbt.request"
2022-07-04 05:51:11.365962 (Thread-1): 05:51:11  Began compiling node rpc.ecommerce_data_model_dbt.request
2022-07-04 05:51:11.366069 (Thread-1): 05:51:11  Compiling rpc.ecommerce_data_model_dbt.request
2022-07-04 05:51:11.369057 (Thread-1): 05:51:11  finished collecting timing info
2022-07-04 05:51:11.369194 (Thread-1): 05:51:11  Began executing node rpc.ecommerce_data_model_dbt.request
2022-07-04 05:51:11.370341 (Thread-1): 05:51:11  Using snowflake connection "rpc.ecommerce_data_model_dbt.request"
2022-07-04 05:51:11.370444 (Thread-1): 05:51:11  On rpc.ecommerce_data_model_dbt.request: select user_id, is_active_on_website from 
(select user_id, 
(CASE WHEN context_device_type like '%PC'
      THEN TRUE
      ELSE (CASE WHEN user_id IN(select user_id from analytics_db.data_apps_simulated.identifies where context_device_type like '%PC')
            THEN TRUE
            ELSE FALSE
      END)
END) as is_active_on_website, row_number() over(partition by user_id order by timestamp desc) as rn from 
analytics_db.data_apps_simulated.identifies where timestamp >= '2021-05-01' and timestamp <= '2022-06-29'
and context_device_type is not null and context_device_type != '' and user_id is not null) where rn = 1
limit 500
/* limit added automatically by dbt cloud */
2022-07-04 05:51:11.370527 (Thread-1): 05:51:11  Opening a new connection, currently in state init
2022-07-04 05:51:11.724856 (Thread-454): handling poll request
2022-07-04 05:51:11.725348 (Thread-454): 05:51:11  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '08022227-1dd0-4d09-94f1-e256bf2507d1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb0f04b30d0>]}
2022-07-04 05:51:11.726302 (Thread-454): sending response (<Response 4443 bytes [200 OK]>) to 10.0.12.141
2022-07-04 05:51:12.503979 (Thread-1): 05:51:12  SQL status: SUCCESS 5 in 1.13 seconds
2022-07-04 05:51:12.505402 (Thread-1): 05:51:12  finished collecting timing info
2022-07-04 05:51:12.505584 (Thread-1): 05:51:12  On rpc.ecommerce_data_model_dbt.request: Close
2022-07-04 05:51:13.101566 (Thread-455): handling poll request
2022-07-04 05:51:13.102009 (Thread-455): 05:51:13  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '08022227-1dd0-4d09-94f1-e256bf2507d1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb0f04b31c0>]}
2022-07-04 05:51:13.102968 (Thread-455): sending response (<Response 6256 bytes [200 OK]>) to 10.0.12.141
2022-07-04 05:51:46.666952 (Thread-456): 05:51:46  Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
2022-07-04 05:51:46.667527 (Thread-456): 05:51:46  Partial parsing: updated file: ecommerce_data_model_dbt://models/data_model/temp_folder/is_active_on_website.sql
2022-07-04 05:51:46.672437 (Thread-456): 05:51:46  1603: static parser failed on data_model/temp_folder/is_active_on_website.sql
2022-07-04 05:51:46.676998 (Thread-456): 05:51:46  1602: parser fallback to jinja rendering on data_model/temp_folder/is_active_on_website.sql
2022-07-04 05:51:46.713794 (Thread-456): 05:51:46  [WARNING]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.data-apps-ecommerce-template.data_model

2022-07-04 05:51:46.719342 (Thread-456): 05:51:46  Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '08022227-1dd0-4d09-94f1-e256bf2507d1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb0f03a2f70>]}
2022-07-04 05:51:47.474069 (Thread-457): handling status request
2022-07-04 05:51:47.474493 (Thread-457): 05:51:47  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '08022227-1dd0-4d09-94f1-e256bf2507d1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb0f041a9a0>]}
2022-07-04 05:51:47.475026 (Thread-457): sending response (<Response 2408 bytes [200 OK]>) to 10.0.12.141
2022-07-04 05:51:47.481466 (Thread-458): handling status request
2022-07-04 05:51:47.481939 (Thread-458): 05:51:47  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '08022227-1dd0-4d09-94f1-e256bf2507d1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb0f041a880>]}
2022-07-04 05:51:47.482528 (Thread-458): sending response (<Response 2408 bytes [200 OK]>) to 10.0.12.141
2022-07-04 05:51:47.999067 (Thread-459): handling status request
2022-07-04 05:51:47.999468 (Thread-459): 05:51:47  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '08022227-1dd0-4d09-94f1-e256bf2507d1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb0f041aca0>]}
2022-07-04 05:51:47.999961 (Thread-459): sending response (<Response 2408 bytes [200 OK]>) to 10.0.12.141
2022-07-04 05:51:48.389251 (Thread-460): handling run_sql request
2022-07-04 05:51:48.389682 (Thread-460): 05:51:48  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '08022227-1dd0-4d09-94f1-e256bf2507d1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb0f041a760>]}
2022-07-04 05:51:50.751183 (Thread-460): sending response (<Response 139 bytes [200 OK]>) to 10.0.12.141
2022-07-04 05:51:50.777365 (MainThread): 05:51:50  Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'f35faf16-3a67-4ed7-8161-eb600d22e743', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff5519157f0>]}
2022-07-04 05:51:50.777947 (MainThread): 05:51:50  Found 14 models, 0 tests, 0 snapshots, 0 analyses, 179 macros, 0 operations, 0 seed files, 15 sources, 0 exposures, 0 metrics
2022-07-04 05:51:50.778552 (Thread-1): 05:51:50  Acquiring new snowflake connection "rpc.ecommerce_data_model_dbt.request"
2022-07-04 05:51:50.778691 (Thread-1): 05:51:50  Began compiling node rpc.ecommerce_data_model_dbt.request
2022-07-04 05:51:50.778786 (Thread-1): 05:51:50  Compiling rpc.ecommerce_data_model_dbt.request
2022-07-04 05:51:50.781540 (Thread-1): 05:51:50  finished collecting timing info
2022-07-04 05:51:50.781670 (Thread-1): 05:51:50  Began executing node rpc.ecommerce_data_model_dbt.request
2022-07-04 05:51:50.782671 (Thread-1): 05:51:50  Using snowflake connection "rpc.ecommerce_data_model_dbt.request"
2022-07-04 05:51:50.782765 (Thread-1): 05:51:50  On rpc.ecommerce_data_model_dbt.request: select user_id, is_active_on_website from 
(select user_id, 
(CASE WHEN user_id IN(select user_id from analytics_db.data_apps_simulated.identifies where context_device_type like '%PC')
      THEN TRUE
      ELSE FALSE
      END)
as is_active_on_website, row_number() over(partition by user_id order by timestamp desc) as rn from 
analytics_db.data_apps_simulated.identifies where timestamp >= '2021-05-01' and timestamp <= '2022-06-29'
and context_device_type is not null and context_device_type != '' and user_id is not null) where rn = 1
limit 500
/* limit added automatically by dbt cloud */
2022-07-04 05:51:50.782847 (Thread-1): 05:51:50  Opening a new connection, currently in state init
2022-07-04 05:51:51.135504 (Thread-461): handling poll request
2022-07-04 05:51:51.136018 (Thread-461): 05:51:51  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '08022227-1dd0-4d09-94f1-e256bf2507d1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb0f03e7910>]}
2022-07-04 05:51:51.136935 (Thread-461): sending response (<Response 4356 bytes [200 OK]>) to 10.0.12.141
2022-07-04 05:51:51.865775 (Thread-1): 05:51:51  SQL status: SUCCESS 5 in 1.08 seconds
2022-07-04 05:51:51.867279 (Thread-1): 05:51:51  finished collecting timing info
2022-07-04 05:51:51.867462 (Thread-1): 05:51:51  On rpc.ecommerce_data_model_dbt.request: Close
2022-07-04 05:51:52.512078 (Thread-462): handling poll request
2022-07-04 05:51:52.512477 (Thread-462): 05:51:52  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '08022227-1dd0-4d09-94f1-e256bf2507d1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb0f03f85b0>]}
2022-07-04 05:51:52.513394 (Thread-462): sending response (<Response 5896 bytes [200 OK]>) to 10.0.12.141
2022-07-04 05:52:41.942383 (Thread-463): 05:52:41  Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
2022-07-04 05:52:41.942953 (Thread-463): 05:52:41  Partial parsing: updated file: ecommerce_data_model_dbt://models/data_model/temp_folder/has_mobile_app.sql
2022-07-04 05:52:41.947280 (Thread-463): 05:52:41  1603: static parser failed on data_model/temp_folder/has_mobile_app.sql
2022-07-04 05:52:41.951711 (Thread-463): 05:52:41  1602: parser fallback to jinja rendering on data_model/temp_folder/has_mobile_app.sql
2022-07-04 05:52:41.986862 (Thread-463): 05:52:41  [WARNING]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.data-apps-ecommerce-template.data_model

2022-07-04 05:52:41.991977 (Thread-463): 05:52:41  Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '08022227-1dd0-4d09-94f1-e256bf2507d1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb0f02f4f10>]}
2022-07-04 05:52:42.719640 (Thread-464): handling status request
2022-07-04 05:52:42.720069 (Thread-464): 05:52:42  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '08022227-1dd0-4d09-94f1-e256bf2507d1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb0f02bf730>]}
2022-07-04 05:52:42.720600 (Thread-464): sending response (<Response 2390 bytes [200 OK]>) to 10.0.12.141
2022-07-04 05:52:42.773737 (Thread-465): handling status request
2022-07-04 05:52:42.774221 (Thread-465): 05:52:42  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '08022227-1dd0-4d09-94f1-e256bf2507d1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb0f02bf250>]}
2022-07-04 05:52:42.774753 (Thread-465): sending response (<Response 2390 bytes [200 OK]>) to 10.0.12.141
2022-07-04 05:52:44.732986 (Thread-466): handling status request
2022-07-04 05:52:44.733390 (Thread-466): 05:52:44  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '08022227-1dd0-4d09-94f1-e256bf2507d1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb0f02bfcd0>]}
2022-07-04 05:52:44.733882 (Thread-466): sending response (<Response 2390 bytes [200 OK]>) to 10.0.12.141
2022-07-04 05:52:45.106910 (Thread-467): handling run_sql request
2022-07-04 05:52:45.107311 (Thread-467): 05:52:45  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '08022227-1dd0-4d09-94f1-e256bf2507d1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb0f02bfb50>]}
2022-07-04 05:52:47.464979 (Thread-467): sending response (<Response 139 bytes [200 OK]>) to 10.0.12.141
2022-07-04 05:52:47.490675 (MainThread): 05:52:47  Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'cd634732-7d12-452b-a4d8-0b71c26b8fc9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff8110d69a0>]}
2022-07-04 05:52:47.491243 (MainThread): 05:52:47  Found 14 models, 0 tests, 0 snapshots, 0 analyses, 179 macros, 0 operations, 0 seed files, 15 sources, 0 exposures, 0 metrics
2022-07-04 05:52:47.491848 (Thread-1): 05:52:47  Acquiring new snowflake connection "rpc.ecommerce_data_model_dbt.request"
2022-07-04 05:52:47.491983 (Thread-1): 05:52:47  Began compiling node rpc.ecommerce_data_model_dbt.request
2022-07-04 05:52:47.492087 (Thread-1): 05:52:47  Compiling rpc.ecommerce_data_model_dbt.request
2022-07-04 05:52:47.495295 (Thread-1): 05:52:47  finished collecting timing info
2022-07-04 05:52:47.495440 (Thread-1): 05:52:47  Began executing node rpc.ecommerce_data_model_dbt.request
2022-07-04 05:52:47.496543 (Thread-1): 05:52:47  Using snowflake connection "rpc.ecommerce_data_model_dbt.request"
2022-07-04 05:52:47.496640 (Thread-1): 05:52:47  On rpc.ecommerce_data_model_dbt.request: select user_id, has_mobile_app from 
(select user_id, 
(CASE WHEN user_id IN(select user_id from analytics_db.data_apps_simulated.identifies where context_device_type  = 'android' or context_device_type = 'iOS')
      THEN TRUE
      ELSE FALSE
      END) as has_mobile_app, row_number() over(partition by user_id order by timestamp desc) as rn from 
analytics_db.data_apps_simulated.identifies where timestamp >= '2021-05-01' and timestamp <= '2022-06-29'
and context_device_type is not null and context_device_type != '' and user_id is not null) where rn = 1
limit 500
/* limit added automatically by dbt cloud */
2022-07-04 05:52:47.496862 (Thread-1): 05:52:47  Opening a new connection, currently in state init
2022-07-04 05:52:47.850483 (Thread-468): handling poll request
2022-07-04 05:52:47.850967 (Thread-468): 05:52:47  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '08022227-1dd0-4d09-94f1-e256bf2507d1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb0f03e4c70>]}
2022-07-04 05:52:47.851894 (Thread-468): sending response (<Response 4370 bytes [200 OK]>) to 10.0.12.141
2022-07-04 05:52:48.487448 (Thread-1): 05:52:48  SQL status: SUCCESS 5 in 0.99 seconds
2022-07-04 05:52:48.488916 (Thread-1): 05:52:48  finished collecting timing info
2022-07-04 05:52:48.489101 (Thread-1): 05:52:48  On rpc.ecommerce_data_model_dbt.request: Close
2022-07-04 05:52:49.238924 (Thread-469): handling poll request
2022-07-04 05:52:49.239348 (Thread-469): 05:52:49  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '08022227-1dd0-4d09-94f1-e256bf2507d1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb0f02f15b0>]}
2022-07-04 05:52:49.240311 (Thread-469): sending response (<Response 5963 bytes [200 OK]>) to 10.0.12.141
2022-07-04 05:53:18.419735 (Thread-470): 05:53:18  Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
2022-07-04 05:53:18.420307 (Thread-470): 05:53:18  Partial parsing: updated file: ecommerce_data_model_dbt://models/data_model/stg_user_traits.sql
2022-07-04 05:53:18.424887 (Thread-470): 05:53:18  1603: static parser failed on data_model/stg_user_traits.sql
2022-07-04 05:53:18.433118 (Thread-470): 05:53:18  1602: parser fallback to jinja rendering on data_model/stg_user_traits.sql
2022-07-04 05:53:18.473471 (Thread-470): 05:53:18  [WARNING]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.data-apps-ecommerce-template.data_model

2022-07-04 05:53:18.478615 (Thread-470): 05:53:18  Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '08022227-1dd0-4d09-94f1-e256bf2507d1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb0f020e070>]}
2022-07-04 05:53:19.163206 (Thread-471): handling status request
2022-07-04 05:53:19.163608 (Thread-471): 05:53:19  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '08022227-1dd0-4d09-94f1-e256bf2507d1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb0f01fdbe0>]}
2022-07-04 05:53:19.164154 (Thread-471): sending response (<Response 2357 bytes [200 OK]>) to 10.0.12.141
2022-07-04 05:53:19.244360 (Thread-472): handling status request
2022-07-04 05:53:19.244726 (Thread-472): 05:53:19  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '08022227-1dd0-4d09-94f1-e256bf2507d1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb0f01fdf70>]}
2022-07-04 05:53:19.245203 (Thread-472): sending response (<Response 2357 bytes [200 OK]>) to 10.0.12.141
2022-07-04 05:54:41.314827 (Thread-473): 05:54:41  Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
2022-07-04 05:54:41.315958 (Thread-473): 05:54:41  Partial parsing: updated file: ecommerce_data_model_dbt://models/data_model/stg_user_traits.sql
2022-07-04 05:54:41.321045 (Thread-473): 05:54:41  1603: static parser failed on data_model/stg_user_traits.sql
2022-07-04 05:54:41.330059 (Thread-473): 05:54:41  1602: parser fallback to jinja rendering on data_model/stg_user_traits.sql
2022-07-04 05:54:41.368089 (Thread-473): 05:54:41  [WARNING]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.data-apps-ecommerce-template.data_model

2022-07-04 05:54:41.373409 (Thread-473): 05:54:41  Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '08022227-1dd0-4d09-94f1-e256bf2507d1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb0f016ab20>]}
2022-07-04 05:54:42.034900 (Thread-474): handling status request
2022-07-04 05:54:42.035310 (Thread-474): 05:54:42  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '08022227-1dd0-4d09-94f1-e256bf2507d1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb0f01fd400>]}
2022-07-04 05:54:42.035862 (Thread-474): sending response (<Response 2357 bytes [200 OK]>) to 10.0.12.141
2022-07-04 05:54:42.074713 (Thread-475): handling status request
2022-07-04 05:54:42.075096 (Thread-475): 05:54:42  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '08022227-1dd0-4d09-94f1-e256bf2507d1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb0f01fd220>]}
2022-07-04 05:54:42.075580 (Thread-475): sending response (<Response 2357 bytes [200 OK]>) to 10.0.12.141
2022-07-04 05:54:43.624674 (Thread-476): handling status request
2022-07-04 05:54:43.625142 (Thread-476): 05:54:43  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '08022227-1dd0-4d09-94f1-e256bf2507d1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb0f021d460>]}
2022-07-04 05:54:43.625654 (Thread-476): sending response (<Response 2357 bytes [200 OK]>) to 10.0.12.141
2022-07-04 05:54:44.002278 (Thread-477): handling run_sql request
2022-07-04 05:54:44.002710 (Thread-477): 05:54:44  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '08022227-1dd0-4d09-94f1-e256bf2507d1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb0f026ffa0>]}
2022-07-04 05:54:46.360784 (Thread-477): sending response (<Response 139 bytes [200 OK]>) to 10.0.12.141
2022-07-04 05:54:46.395569 (MainThread): 05:54:46  Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'bcb96508-1037-4219-b152-ccbc18da8420', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc1dd4239d0>]}
2022-07-04 05:54:46.396156 (MainThread): 05:54:46  Found 14 models, 0 tests, 0 snapshots, 0 analyses, 179 macros, 0 operations, 0 seed files, 15 sources, 0 exposures, 0 metrics
2022-07-04 05:54:46.396762 (Thread-1): 05:54:46  Acquiring new snowflake connection "rpc.ecommerce_data_model_dbt.request"
2022-07-04 05:54:46.396893 (Thread-1): 05:54:46  Began compiling node rpc.ecommerce_data_model_dbt.request
2022-07-04 05:54:46.396987 (Thread-1): 05:54:46  Compiling rpc.ecommerce_data_model_dbt.request
2022-07-04 05:54:46.406870 (Thread-1): 05:54:46  finished collecting timing info
2022-07-04 05:54:46.407031 (Thread-1): 05:54:46  Began executing node rpc.ecommerce_data_model_dbt.request
2022-07-04 05:54:46.412106 (Thread-1): 05:54:46  Using snowflake connection "rpc.ecommerce_data_model_dbt.request"
2022-07-04 05:54:46.412215 (Thread-1): 05:54:46  On rpc.ecommerce_data_model_dbt.request: with cte_gender as 
(select user_id, gender from 
(select user_id, properties_gender as gender, row_number() over(partition by user_id order by timestamp desc) as rn from 
analytics_db.data_apps_simulated.identifies where timestamp >= '2021-05-01' and timestamp <= '2022-06-29'
and properties_gender is not null and properties_gender != '') where rn = 1),

cte_age as 
(select user_id, age from
(select user_id, 
(CASE WHEN dateadd(year, datediff (year, properties_birthday, getdate()), properties_birthday) > getdate()
      THEN datediff(year, properties_birthday, getdate()) - 1
      ELSE datediff(year, properties_birthday, getdate())
 END) as age, row_number() over(partition by user_id order by timestamp desc) as rn 
from analytics_db.data_apps_simulated.identifies where timestamp >= '2021-05-01' and timestamp <= '2022-06-29'
and properties_birthday is not null and properties_birthday!='') where rn = 1),

cte_country as 
(select user_id, country from 
(select user_id, properties_country as country, row_number() over(partition by user_id order by timestamp desc) as rn from 
analytics_db.data_apps_simulated.identifies where timestamp >= '2021-05-01' and timestamp <= '2022-06-29'
and properties_country is not null and properties_country != '') where rn = 1),

cte_state as 
(select user_id, state from 
(select user_id, properties_state as state, row_number() over(partition by user_id order by timestamp desc) as rn from 
analytics_db.data_apps_simulated.identifies where timestamp >= '2021-05-01' and timestamp <= '2022-06-29'
and properties_state is not null and properties_state != '') where rn = 1),

cte_email_domain as 
(select user_id, email_domain from 
(select user_id, substring(properties_email, charindex( '@', properties_email) + 1, len(properties_email)) as email_domain, row_number() over(partition by user_id order by timestamp desc) as rn from 
analytics_db.data_apps_simulated.identifies where timestamp >= '2021-05-01' and timestamp <= '2022-06-29'
and properties_email is not null and properties_email != '') where rn = 1),

cte_is_member as 
(select user_id, has_mobile_app from 
(select user_id, 
(CASE WHEN user_id IN(select user_id from analytics_db.data_apps_simulated.identifies where context_device_type  = 'android' or context_device_type = 'iOS')
      THEN TRUE
      ELSE FALSE
      END) as has_mobile_app, row_number() over(partition by user_id order by timestamp desc) as rn from 
analytics_db.data_apps_simulated.identifies where timestamp >= '2021-05-01' and timestamp <= '2022-06-29'
and context_device_type is not null and context_device_type != '' and user_id is not null) where rn = 1),

cte_has_mobile_app as 
(select user_id, has_mobile_app from 
(select user_id, 
(CASE WHEN context_device_type = 'android' or context_device_type = 'iOS'
      THEN TRUE
      ELSE FALSE
END) as has_mobile_app, row_number() over(partition by user_id order by timestamp desc) as rn from 
analytics_db.data_apps_simulated.identifies where timestamp >= '2021-05-01' and timestamp <= '2022-06-29'
and context_device_type is not null and context_device_type != '' and user_id is not null) where rn = 1),

cte_is_active_on_website as 
(select user_id, is_active_on_website from 
(select user_id, 
(CASE WHEN user_id IN(select user_id from analytics_db.data_apps_simulated.identifies where context_device_type like '%PC')
      THEN TRUE
      ELSE FALSE
      END)
as is_active_on_website, row_number() over(partition by user_id order by timestamp desc) as rn from 
analytics_db.data_apps_simulated.identifies where timestamp >= '2021-05-01' and timestamp <= '2022-06-29'
and context_device_type is not null and context_device_type != '' and user_id is not null) where rn = 1)

select coalesce(a.user_id, b.user_id, c.user_id, d.user_id, e.user_id, f.user_id, g.user_id, h.user_id) 
as user_id, gender, age, country, state, email_domain, is_member, has_mobile_app, is_active_on_website
from ((((((cte_gender a full outer join cte_age b on a.user_id = b.user_id) 
full outer join cte_country c on c.user_id = coalesce(a.user_id, b.user_id))
full outer join cte_state d on d.user_id = coalesce(a.user_id, b.user_id, c.user_id))
full outer join cte_email_domain e on e.user_id = coalesce(a.user_id, b.user_id, c.user_id,d.user_id))
full outer join cte_is_member f on f.user_id = coalesce(a.user_id, b.user_id, c.user_id,d.user_id, e.user_id))
full outer join cte_has_mobile_app g on g.user_id = coalesce(a.user_id, b.user_id, c.user_id,d.user_id, e.user_id, f.user_id))
full outer join cte_is_active_on_website on h.user_id = coalesce(a.user_id, b.user_id, c.user_id,d.user_id, e.user_id, f.user_id, g.user_id)
limit 500
/* limit added automatically by dbt cloud */
2022-07-04 05:54:46.412300 (Thread-1): 05:54:46  Opening a new connection, currently in state init
2022-07-04 05:54:46.762725 (Thread-478): handling poll request
2022-07-04 05:54:46.763209 (Thread-478): 05:54:46  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '08022227-1dd0-4d09-94f1-e256bf2507d1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb0f02ddf40>]}
2022-07-04 05:54:46.764147 (Thread-478): sending response (<Response 8509 bytes [200 OK]>) to 10.0.12.141
2022-07-04 05:54:47.129104 (Thread-1): 05:54:47  Snowflake adapter: Snowflake query id: 01a56002-0602-327e-0019-82030465cd7a
2022-07-04 05:54:47.129289 (Thread-1): 05:54:47  Snowflake adapter: Snowflake error: 000904 (42000): SQL compilation error: error line 66 at position 93
invalid identifier 'H.USER_ID'
2022-07-04 05:54:47.129449 (Thread-1): 05:54:47  finished collecting timing info
2022-07-04 05:54:47.129605 (Thread-1): 05:54:47  On rpc.ecommerce_data_model_dbt.request: Close
2022-07-04 05:54:47.181690 (Thread-1): Got an exception: Database Error
  000904 (42000): SQL compilation error: error line 66 at position 93
  invalid identifier 'H.USER_ID'
Traceback (most recent call last):
  File "/usr/local/lib/python3.8/dist-packages/dbt/adapters/snowflake/connections.py", line 206, in exception_handler
    yield
  File "/usr/local/lib/python3.8/dist-packages/dbt/adapters/sql/connections.py", line 74, in add_query
    cursor.execute(sql, bindings)
  File "/usr/local/lib/python3.8/dist-packages/snowflake/connector/cursor.py", line 721, in execute
    Error.errorhandler_wrapper(
  File "/usr/local/lib/python3.8/dist-packages/snowflake/connector/errors.py", line 258, in errorhandler_wrapper
    cursor.errorhandler(connection, cursor, error_class, error_value)
  File "/usr/local/lib/python3.8/dist-packages/snowflake/connector/errors.py", line 188, in default_errorhandler
    raise error_class(
snowflake.connector.errors.ProgrammingError: 000904 (42000): SQL compilation error: error line 66 at position 93
invalid identifier 'H.USER_ID'

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/usr/local/lib/python3.8/dist-packages/dbt/task/base.py", line 361, in safe_run
    result = self.compile_and_execute(manifest, ctx)
  File "/usr/local/lib/python3.8/dist-packages/dbt/task/base.py", line 314, in compile_and_execute
    result = self.run(ctx.node, manifest)
  File "/usr/local/lib/python3.8/dist-packages/dbt/task/base.py", line 403, in run
    return self.execute(compiled_node, manifest)
  File "/usr/local/lib/python3.8/dist-packages/dbt_rpc/rpc/node_runners.py", line 90, in execute
    _, execute_result = self.adapter.execute(
  File "/usr/local/lib/python3.8/dist-packages/dbt/adapters/base/impl.py", line 225, in execute
    return self.connections.execute(
  File "/usr/local/lib/python3.8/dist-packages/dbt/adapters/sql/connections.py", line 127, in execute
    _, cursor = self.add_query(sql, auto_begin)
  File "/usr/local/lib/python3.8/dist-packages/dbt/adapters/snowflake/connections.py", line 433, in add_query
    connection, cursor = super().add_query(
  File "/usr/local/lib/python3.8/dist-packages/dbt/adapters/sql/connections.py", line 83, in add_query
    return connection, cursor
  File "/usr/lib/python3.8/contextlib.py", line 131, in __exit__
    self.gen.throw(type, value, traceback)
  File "/usr/local/lib/python3.8/dist-packages/dbt/adapters/snowflake/connections.py", line 223, in exception_handler
    raise DatabaseException(msg)
dbt.exceptions.DatabaseException: Database Error
  000904 (42000): SQL compilation error: error line 66 at position 93
  invalid identifier 'H.USER_ID'
2022-07-04 05:54:47.182796 (Thread-1): Got exception RPCException(10003, Database Error, {'type': 'DatabaseException', 'message': "Database Error in rpc request (from remote system)\n  000904 (42000): SQL compilation error: error line 66 at position 93\n  invalid identifier 'H.USER_ID'", 'raw_sql': "with cte_gender as \n(select user_id, gender from \n(select user_id, properties_gender as gender, row_number() over(partition by user_id order by timestamp desc) as rn from \n{{ source('ecommerce', 'identifies') }} where timestamp >= '{{ var('start_date') }}' and timestamp <= '{{ var('end_date') }}'\nand properties_gender is not null and properties_gender != '') where rn = 1),\n\ncte_age as \n(select user_id, age from\n(select user_id, \n(CASE WHEN dateadd(year, datediff (year, properties_birthday, getdate()), properties_birthday) > getdate()\n      THEN datediff(year, properties_birthday, getdate()) - 1\n      ELSE datediff(year, properties_birthday, getdate())\n END) as age, row_number() over(partition by user_id order by timestamp desc) as rn \nfrom {{ source('ecommerce', 'identifies') }} where timestamp >= '{{ var('start_date') }}' and timestamp <= '{{ var('end_date') }}'\nand properties_birthday is not null and properties_birthday!='') where rn = 1),\n\ncte_country as \n(select user_id, country from \n(select user_id, properties_country as country, row_number() over(partition by user_id order by timestamp desc) as rn from \n{{ source('ecommerce', 'identifies') }} where timestamp >= '{{ var('start_date') }}' and timestamp <= '{{ var('end_date') }}'\nand properties_country is not null and properties_country != '') where rn = 1),\n\ncte_state as \n(select user_id, state from \n(select user_id, properties_state as state, row_number() over(partition by user_id order by timestamp desc) as rn from \n{{ source('ecommerce', 'identifies') }} where timestamp >= '{{ var('start_date') }}' and timestamp <= '{{ var('end_date') }}'\nand properties_state is not null and properties_state != '') where rn = 1),\n\ncte_email_domain as \n(select user_id, email_domain from \n(select user_id, substring(properties_email, charindex( '@', properties_email) + 1, len(properties_email)) as email_domain, row_number() over(partition by user_id order by timestamp desc) as rn from \n{{ source('ecommerce', 'identifies') }} where timestamp >= '{{ var('start_date') }}' and timestamp <= '{{ var('end_date') }}'\nand properties_email is not null and properties_email != '') where rn = 1),\n\ncte_is_member as \n(select user_id, has_mobile_app from \n(select user_id, \n(CASE WHEN user_id IN(select user_id from {{ source('ecommerce', 'identifies') }} where context_device_type  = 'android' or context_device_type = 'iOS')\n      THEN TRUE\n      ELSE FALSE\n      END) as has_mobile_app, row_number() over(partition by user_id order by timestamp desc) as rn from \n{{ source('ecommerce', 'identifies') }} where timestamp >= '{{ var('start_date') }}' and timestamp <= '{{ var('end_date') }}'\nand context_device_type is not null and context_device_type != '' and user_id is not null) where rn = 1),\n\ncte_has_mobile_app as \n(select user_id, has_mobile_app from \n(select user_id, \n(CASE WHEN context_device_type = 'android' or context_device_type = 'iOS'\n      THEN TRUE\n      ELSE FALSE\nEND) as has_mobile_app, row_number() over(partition by user_id order by timestamp desc) as rn from \n{{ source('ecommerce', 'identifies') }} where timestamp >= '{{ var('start_date') }}' and timestamp <= '{{ var('end_date') }}'\nand context_device_type is not null and context_device_type != '' and user_id is not null) where rn = 1),\n\ncte_is_active_on_website as \n(select user_id, is_active_on_website from \n(select user_id, \n(CASE WHEN user_id IN(select user_id from {{ source('ecommerce', 'identifies') }} where context_device_type like '%PC')\n      THEN TRUE\n      ELSE FALSE\n      END)\nas is_active_on_website, row_number() over(partition by user_id order by timestamp desc) as rn from \n{{ source('ecommerce', 'identifies') }} where timestamp >= '{{ var('start_date') }}' and timestamp <= '{{ var('end_date') }}'\nand context_device_type is not null and context_device_type != '' and user_id is not null) where rn = 1)\n\nselect coalesce(a.user_id, b.user_id, c.user_id, d.user_id, e.user_id, f.user_id, g.user_id, h.user_id) \nas user_id, gender, age, country, state, email_domain, is_member, has_mobile_app, is_active_on_website\nfrom ((((((cte_gender a full outer join cte_age b on a.user_id = b.user_id) \nfull outer join cte_country c on c.user_id = coalesce(a.user_id, b.user_id))\nfull outer join cte_state d on d.user_id = coalesce(a.user_id, b.user_id, c.user_id))\nfull outer join cte_email_domain e on e.user_id = coalesce(a.user_id, b.user_id, c.user_id,d.user_id))\nfull outer join cte_is_member f on f.user_id = coalesce(a.user_id, b.user_id, c.user_id,d.user_id, e.user_id))\nfull outer join cte_has_mobile_app g on g.user_id = coalesce(a.user_id, b.user_id, c.user_id,d.user_id, e.user_id, f.user_id))\nfull outer join cte_is_active_on_website on h.user_id = coalesce(a.user_id, b.user_id, c.user_id,d.user_id, e.user_id, f.user_id, g.user_id)\nlimit 500\n/* limit added automatically by dbt cloud */", 'compiled_sql': "with cte_gender as \n(select user_id, gender from \n(select user_id, properties_gender as gender, row_number() over(partition by user_id order by timestamp desc) as rn from \nanalytics_db.data_apps_simulated.identifies where timestamp >= '2021-05-01' and timestamp <= '2022-06-29'\nand properties_gender is not null and properties_gender != '') where rn = 1),\n\ncte_age as \n(select user_id, age from\n(select user_id, \n(CASE WHEN dateadd(year, datediff (year, properties_birthday, getdate()), properties_birthday) > getdate()\n      THEN datediff(year, properties_birthday, getdate()) - 1\n      ELSE datediff(year, properties_birthday, getdate())\n END) as age, row_number() over(partition by user_id order by timestamp desc) as rn \nfrom analytics_db.data_apps_simulated.identifies where timestamp >= '2021-05-01' and timestamp <= '2022-06-29'\nand properties_birthday is not null and properties_birthday!='') where rn = 1),\n\ncte_country as \n(select user_id, country from \n(select user_id, properties_country as country, row_number() over(partition by user_id order by timestamp desc) as rn from \nanalytics_db.data_apps_simulated.identifies where timestamp >= '2021-05-01' and timestamp <= '2022-06-29'\nand properties_country is not null and properties_country != '') where rn = 1),\n\ncte_state as \n(select user_id, state from \n(select user_id, properties_state as state, row_number() over(partition by user_id order by timestamp desc) as rn from \nanalytics_db.data_apps_simulated.identifies where timestamp >= '2021-05-01' and timestamp <= '2022-06-29'\nand properties_state is not null and properties_state != '') where rn = 1),\n\ncte_email_domain as \n(select user_id, email_domain from \n(select user_id, substring(properties_email, charindex( '@', properties_email) + 1, len(properties_email)) as email_domain, row_number() over(partition by user_id order by timestamp desc) as rn from \nanalytics_db.data_apps_simulated.identifies where timestamp >= '2021-05-01' and timestamp <= '2022-06-29'\nand properties_email is not null and properties_email != '') where rn = 1),\n\ncte_is_member as \n(select user_id, has_mobile_app from \n(select user_id, \n(CASE WHEN user_id IN(select user_id from analytics_db.data_apps_simulated.identifies where context_device_type  = 'android' or context_device_type = 'iOS')\n      THEN TRUE\n      ELSE FALSE\n      END) as has_mobile_app, row_number() over(partition by user_id order by timestamp desc) as rn from \nanalytics_db.data_apps_simulated.identifies where timestamp >= '2021-05-01' and timestamp <= '2022-06-29'\nand context_device_type is not null and context_device_type != '' and user_id is not null) where rn = 1),\n\ncte_has_mobile_app as \n(select user_id, has_mobile_app from \n(select user_id, \n(CASE WHEN context_device_type = 'android' or context_device_type = 'iOS'\n      THEN TRUE\n      ELSE FALSE\nEND) as has_mobile_app, row_number() over(partition by user_id order by timestamp desc) as rn from \nanalytics_db.data_apps_simulated.identifies where timestamp >= '2021-05-01' and timestamp <= '2022-06-29'\nand context_device_type is not null and context_device_type != '' and user_id is not null) where rn = 1),\n\ncte_is_active_on_website as \n(select user_id, is_active_on_website from \n(select user_id, \n(CASE WHEN user_id IN(select user_id from analytics_db.data_apps_simulated.identifies where context_device_type like '%PC')\n      THEN TRUE\n      ELSE FALSE\n      END)\nas is_active_on_website, row_number() over(partition by user_id order by timestamp desc) as rn from \nanalytics_db.data_apps_simulated.identifies where timestamp >= '2021-05-01' and timestamp <= '2022-06-29'\nand context_device_type is not null and context_device_type != '' and user_id is not null) where rn = 1)\n\nselect coalesce(a.user_id, b.user_id, c.user_id, d.user_id, e.user_id, f.user_id, g.user_id, h.user_id) \nas user_id, gender, age, country, state, email_domain, is_member, has_mobile_app, is_active_on_website\nfrom ((((((cte_gender a full outer join cte_age b on a.user_id = b.user_id) \nfull outer join cte_country c on c.user_id = coalesce(a.user_id, b.user_id))\nfull outer join cte_state d on d.user_id = coalesce(a.user_id, b.user_id, c.user_id))\nfull outer join cte_email_domain e on e.user_id = coalesce(a.user_id, b.user_id, c.user_id,d.user_id))\nfull outer join cte_is_member f on f.user_id = coalesce(a.user_id, b.user_id, c.user_id,d.user_id, e.user_id))\nfull outer join cte_has_mobile_app g on g.user_id = coalesce(a.user_id, b.user_id, c.user_id,d.user_id, e.user_id, f.user_id))\nfull outer join cte_is_active_on_website on h.user_id = coalesce(a.user_id, b.user_id, c.user_id,d.user_id, e.user_id, f.user_id, g.user_id)\nlimit 500\n/* limit added automatically by dbt cloud */", 'tags': None}, None)
Traceback (most recent call last):
  File "/usr/local/lib/python3.8/dist-packages/dbt_rpc/task/sql_commands.py", line 147, in _in_thread
    self.node_results.append(runner.safe_run(self.manifest))
  File "/usr/local/lib/python3.8/dist-packages/dbt/task/base.py", line 377, in safe_run
    result = self.error_result(ctx.node, error, started, [])
  File "/usr/local/lib/python3.8/dist-packages/dbt_rpc/rpc/node_runners.py", line 56, in error_result
    raise error
dbt_rpc.rpc.error.RPCException: RPCException(10003, Database Error, {'type': 'DatabaseException', 'message': "Database Error in rpc request (from remote system)\n  000904 (42000): SQL compilation error: error line 66 at position 93\n  invalid identifier 'H.USER_ID'", 'raw_sql': "with cte_gender as \n(select user_id, gender from \n(select user_id, properties_gender as gender, row_number() over(partition by user_id order by timestamp desc) as rn from \n{{ source('ecommerce', 'identifies') }} where timestamp >= '{{ var('start_date') }}' and timestamp <= '{{ var('end_date') }}'\nand properties_gender is not null and properties_gender != '') where rn = 1),\n\ncte_age as \n(select user_id, age from\n(select user_id, \n(CASE WHEN dateadd(year, datediff (year, properties_birthday, getdate()), properties_birthday) > getdate()\n      THEN datediff(year, properties_birthday, getdate()) - 1\n      ELSE datediff(year, properties_birthday, getdate())\n END) as age, row_number() over(partition by user_id order by timestamp desc) as rn \nfrom {{ source('ecommerce', 'identifies') }} where timestamp >= '{{ var('start_date') }}' and timestamp <= '{{ var('end_date') }}'\nand properties_birthday is not null and properties_birthday!='') where rn = 1),\n\ncte_country as \n(select user_id, country from \n(select user_id, properties_country as country, row_number() over(partition by user_id order by timestamp desc) as rn from \n{{ source('ecommerce', 'identifies') }} where timestamp >= '{{ var('start_date') }}' and timestamp <= '{{ var('end_date') }}'\nand properties_country is not null and properties_country != '') where rn = 1),\n\ncte_state as \n(select user_id, state from \n(select user_id, properties_state as state, row_number() over(partition by user_id order by timestamp desc) as rn from \n{{ source('ecommerce', 'identifies') }} where timestamp >= '{{ var('start_date') }}' and timestamp <= '{{ var('end_date') }}'\nand properties_state is not null and properties_state != '') where rn = 1),\n\ncte_email_domain as \n(select user_id, email_domain from \n(select user_id, substring(properties_email, charindex( '@', properties_email) + 1, len(properties_email)) as email_domain, row_number() over(partition by user_id order by timestamp desc) as rn from \n{{ source('ecommerce', 'identifies') }} where timestamp >= '{{ var('start_date') }}' and timestamp <= '{{ var('end_date') }}'\nand properties_email is not null and properties_email != '') where rn = 1),\n\ncte_is_member as \n(select user_id, has_mobile_app from \n(select user_id, \n(CASE WHEN user_id IN(select user_id from {{ source('ecommerce', 'identifies') }} where context_device_type  = 'android' or context_device_type = 'iOS')\n      THEN TRUE\n      ELSE FALSE\n      END) as has_mobile_app, row_number() over(partition by user_id order by timestamp desc) as rn from \n{{ source('ecommerce', 'identifies') }} where timestamp >= '{{ var('start_date') }}' and timestamp <= '{{ var('end_date') }}'\nand context_device_type is not null and context_device_type != '' and user_id is not null) where rn = 1),\n\ncte_has_mobile_app as \n(select user_id, has_mobile_app from \n(select user_id, \n(CASE WHEN context_device_type = 'android' or context_device_type = 'iOS'\n      THEN TRUE\n      ELSE FALSE\nEND) as has_mobile_app, row_number() over(partition by user_id order by timestamp desc) as rn from \n{{ source('ecommerce', 'identifies') }} where timestamp >= '{{ var('start_date') }}' and timestamp <= '{{ var('end_date') }}'\nand context_device_type is not null and context_device_type != '' and user_id is not null) where rn = 1),\n\ncte_is_active_on_website as \n(select user_id, is_active_on_website from \n(select user_id, \n(CASE WHEN user_id IN(select user_id from {{ source('ecommerce', 'identifies') }} where context_device_type like '%PC')\n      THEN TRUE\n      ELSE FALSE\n      END)\nas is_active_on_website, row_number() over(partition by user_id order by timestamp desc) as rn from \n{{ source('ecommerce', 'identifies') }} where timestamp >= '{{ var('start_date') }}' and timestamp <= '{{ var('end_date') }}'\nand context_device_type is not null and context_device_type != '' and user_id is not null) where rn = 1)\n\nselect coalesce(a.user_id, b.user_id, c.user_id, d.user_id, e.user_id, f.user_id, g.user_id, h.user_id) \nas user_id, gender, age, country, state, email_domain, is_member, has_mobile_app, is_active_on_website\nfrom ((((((cte_gender a full outer join cte_age b on a.user_id = b.user_id) \nfull outer join cte_country c on c.user_id = coalesce(a.user_id, b.user_id))\nfull outer join cte_state d on d.user_id = coalesce(a.user_id, b.user_id, c.user_id))\nfull outer join cte_email_domain e on e.user_id = coalesce(a.user_id, b.user_id, c.user_id,d.user_id))\nfull outer join cte_is_member f on f.user_id = coalesce(a.user_id, b.user_id, c.user_id,d.user_id, e.user_id))\nfull outer join cte_has_mobile_app g on g.user_id = coalesce(a.user_id, b.user_id, c.user_id,d.user_id, e.user_id, f.user_id))\nfull outer join cte_is_active_on_website on h.user_id = coalesce(a.user_id, b.user_id, c.user_id,d.user_id, e.user_id, f.user_id, g.user_id)\nlimit 500\n/* limit added automatically by dbt cloud */", 'compiled_sql': "with cte_gender as \n(select user_id, gender from \n(select user_id, properties_gender as gender, row_number() over(partition by user_id order by timestamp desc) as rn from \nanalytics_db.data_apps_simulated.identifies where timestamp >= '2021-05-01' and timestamp <= '2022-06-29'\nand properties_gender is not null and properties_gender != '') where rn = 1),\n\ncte_age as \n(select user_id, age from\n(select user_id, \n(CASE WHEN dateadd(year, datediff (year, properties_birthday, getdate()), properties_birthday) > getdate()\n      THEN datediff(year, properties_birthday, getdate()) - 1\n      ELSE datediff(year, properties_birthday, getdate())\n END) as age, row_number() over(partition by user_id order by timestamp desc) as rn \nfrom analytics_db.data_apps_simulated.identifies where timestamp >= '2021-05-01' and timestamp <= '2022-06-29'\nand properties_birthday is not null and properties_birthday!='') where rn = 1),\n\ncte_country as \n(select user_id, country from \n(select user_id, properties_country as country, row_number() over(partition by user_id order by timestamp desc) as rn from \nanalytics_db.data_apps_simulated.identifies where timestamp >= '2021-05-01' and timestamp <= '2022-06-29'\nand properties_country is not null and properties_country != '') where rn = 1),\n\ncte_state as \n(select user_id, state from \n(select user_id, properties_state as state, row_number() over(partition by user_id order by timestamp desc) as rn from \nanalytics_db.data_apps_simulated.identifies where timestamp >= '2021-05-01' and timestamp <= '2022-06-29'\nand properties_state is not null and properties_state != '') where rn = 1),\n\ncte_email_domain as \n(select user_id, email_domain from \n(select user_id, substring(properties_email, charindex( '@', properties_email) + 1, len(properties_email)) as email_domain, row_number() over(partition by user_id order by timestamp desc) as rn from \nanalytics_db.data_apps_simulated.identifies where timestamp >= '2021-05-01' and timestamp <= '2022-06-29'\nand properties_email is not null and properties_email != '') where rn = 1),\n\ncte_is_member as \n(select user_id, has_mobile_app from \n(select user_id, \n(CASE WHEN user_id IN(select user_id from analytics_db.data_apps_simulated.identifies where context_device_type  = 'android' or context_device_type = 'iOS')\n      THEN TRUE\n      ELSE FALSE\n      END) as has_mobile_app, row_number() over(partition by user_id order by timestamp desc) as rn from \nanalytics_db.data_apps_simulated.identifies where timestamp >= '2021-05-01' and timestamp <= '2022-06-29'\nand context_device_type is not null and context_device_type != '' and user_id is not null) where rn = 1),\n\ncte_has_mobile_app as \n(select user_id, has_mobile_app from \n(select user_id, \n(CASE WHEN context_device_type = 'android' or context_device_type = 'iOS'\n      THEN TRUE\n      ELSE FALSE\nEND) as has_mobile_app, row_number() over(partition by user_id order by timestamp desc) as rn from \nanalytics_db.data_apps_simulated.identifies where timestamp >= '2021-05-01' and timestamp <= '2022-06-29'\nand context_device_type is not null and context_device_type != '' and user_id is not null) where rn = 1),\n\ncte_is_active_on_website as \n(select user_id, is_active_on_website from \n(select user_id, \n(CASE WHEN user_id IN(select user_id from analytics_db.data_apps_simulated.identifies where context_device_type like '%PC')\n      THEN TRUE\n      ELSE FALSE\n      END)\nas is_active_on_website, row_number() over(partition by user_id order by timestamp desc) as rn from \nanalytics_db.data_apps_simulated.identifies where timestamp >= '2021-05-01' and timestamp <= '2022-06-29'\nand context_device_type is not null and context_device_type != '' and user_id is not null) where rn = 1)\n\nselect coalesce(a.user_id, b.user_id, c.user_id, d.user_id, e.user_id, f.user_id, g.user_id, h.user_id) \nas user_id, gender, age, country, state, email_domain, is_member, has_mobile_app, is_active_on_website\nfrom ((((((cte_gender a full outer join cte_age b on a.user_id = b.user_id) \nfull outer join cte_country c on c.user_id = coalesce(a.user_id, b.user_id))\nfull outer join cte_state d on d.user_id = coalesce(a.user_id, b.user_id, c.user_id))\nfull outer join cte_email_domain e on e.user_id = coalesce(a.user_id, b.user_id, c.user_id,d.user_id))\nfull outer join cte_is_member f on f.user_id = coalesce(a.user_id, b.user_id, c.user_id,d.user_id, e.user_id))\nfull outer join cte_has_mobile_app g on g.user_id = coalesce(a.user_id, b.user_id, c.user_id,d.user_id, e.user_id, f.user_id))\nfull outer join cte_is_active_on_website on h.user_id = coalesce(a.user_id, b.user_id, c.user_id,d.user_id, e.user_id, f.user_id, g.user_id)\nlimit 500\n/* limit added automatically by dbt cloud */", 'tags': None}, None)
2022-07-04 05:54:48.150073 (Thread-479): handling poll request
2022-07-04 05:54:48.150486 (Thread-479): 05:54:48  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '08022227-1dd0-4d09-94f1-e256bf2507d1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb0f02dd670>]}
2022-07-04 05:54:48.151271 (Thread-479): sending response (<Response 43583 bytes [200 OK]>) to 10.0.12.141
2022-07-04 05:54:59.459401 (Thread-480): 05:54:59  Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
2022-07-04 05:54:59.460005 (Thread-480): 05:54:59  Partial parsing: updated file: ecommerce_data_model_dbt://models/data_model/stg_user_traits.sql
2022-07-04 05:54:59.464616 (Thread-480): 05:54:59  1603: static parser failed on data_model/stg_user_traits.sql
2022-07-04 05:54:59.473695 (Thread-480): 05:54:59  1602: parser fallback to jinja rendering on data_model/stg_user_traits.sql
2022-07-04 05:54:59.513531 (Thread-480): 05:54:59  [WARNING]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.data-apps-ecommerce-template.data_model

2022-07-04 05:54:59.518936 (Thread-480): 05:54:59  Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '08022227-1dd0-4d09-94f1-e256bf2507d1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb0f083daf0>]}
2022-07-04 05:55:00.032889 (Thread-481): handling status request
2022-07-04 05:55:00.033294 (Thread-481): 05:55:00  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '08022227-1dd0-4d09-94f1-e256bf2507d1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb0f0533c70>]}
2022-07-04 05:55:00.033809 (Thread-481): sending response (<Response 2357 bytes [200 OK]>) to 10.0.12.141
2022-07-04 05:55:00.259001 (Thread-482): handling status request
2022-07-04 05:55:00.259400 (Thread-482): 05:55:00  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '08022227-1dd0-4d09-94f1-e256bf2507d1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb0f0533610>]}
2022-07-04 05:55:00.259909 (Thread-482): sending response (<Response 2357 bytes [200 OK]>) to 10.0.12.141
2022-07-04 05:55:00.594461 (Thread-483): handling status request
2022-07-04 05:55:00.594856 (Thread-483): 05:55:00  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '08022227-1dd0-4d09-94f1-e256bf2507d1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb0f03f8e80>]}
2022-07-04 05:55:00.595347 (Thread-483): sending response (<Response 2357 bytes [200 OK]>) to 10.0.12.141
2022-07-04 05:55:00.966614 (Thread-484): handling run_sql request
2022-07-04 05:55:00.967048 (Thread-484): 05:55:00  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '08022227-1dd0-4d09-94f1-e256bf2507d1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb0f03f8430>]}
2022-07-04 05:55:03.322697 (Thread-484): sending response (<Response 139 bytes [200 OK]>) to 10.0.12.141
2022-07-04 05:55:03.357898 (MainThread): 05:55:03  Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '097e7319-fe3a-4f5b-9452-fc9d12bdb1f5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f92a5f56a00>]}
2022-07-04 05:55:03.358513 (MainThread): 05:55:03  Found 14 models, 0 tests, 0 snapshots, 0 analyses, 179 macros, 0 operations, 0 seed files, 15 sources, 0 exposures, 0 metrics
2022-07-04 05:55:03.359156 (Thread-1): 05:55:03  Acquiring new snowflake connection "rpc.ecommerce_data_model_dbt.request"
2022-07-04 05:55:03.359292 (Thread-1): 05:55:03  Began compiling node rpc.ecommerce_data_model_dbt.request
2022-07-04 05:55:03.359394 (Thread-1): 05:55:03  Compiling rpc.ecommerce_data_model_dbt.request
2022-07-04 05:55:03.367811 (Thread-1): 05:55:03  finished collecting timing info
2022-07-04 05:55:03.367974 (Thread-1): 05:55:03  Began executing node rpc.ecommerce_data_model_dbt.request
2022-07-04 05:55:03.373036 (Thread-1): 05:55:03  Using snowflake connection "rpc.ecommerce_data_model_dbt.request"
2022-07-04 05:55:03.373154 (Thread-1): 05:55:03  On rpc.ecommerce_data_model_dbt.request: with cte_gender as 
(select user_id, gender from 
(select user_id, properties_gender as gender, row_number() over(partition by user_id order by timestamp desc) as rn from 
analytics_db.data_apps_simulated.identifies where timestamp >= '2021-05-01' and timestamp <= '2022-06-29'
and properties_gender is not null and properties_gender != '') where rn = 1),

cte_age as 
(select user_id, age from
(select user_id, 
(CASE WHEN dateadd(year, datediff (year, properties_birthday, getdate()), properties_birthday) > getdate()
      THEN datediff(year, properties_birthday, getdate()) - 1
      ELSE datediff(year, properties_birthday, getdate())
 END) as age, row_number() over(partition by user_id order by timestamp desc) as rn 
from analytics_db.data_apps_simulated.identifies where timestamp >= '2021-05-01' and timestamp <= '2022-06-29'
and properties_birthday is not null and properties_birthday!='') where rn = 1),

cte_country as 
(select user_id, country from 
(select user_id, properties_country as country, row_number() over(partition by user_id order by timestamp desc) as rn from 
analytics_db.data_apps_simulated.identifies where timestamp >= '2021-05-01' and timestamp <= '2022-06-29'
and properties_country is not null and properties_country != '') where rn = 1),

cte_state as 
(select user_id, state from 
(select user_id, properties_state as state, row_number() over(partition by user_id order by timestamp desc) as rn from 
analytics_db.data_apps_simulated.identifies where timestamp >= '2021-05-01' and timestamp <= '2022-06-29'
and properties_state is not null and properties_state != '') where rn = 1),

cte_email_domain as 
(select user_id, email_domain from 
(select user_id, substring(properties_email, charindex( '@', properties_email) + 1, len(properties_email)) as email_domain, row_number() over(partition by user_id order by timestamp desc) as rn from 
analytics_db.data_apps_simulated.identifies where timestamp >= '2021-05-01' and timestamp <= '2022-06-29'
and properties_email is not null and properties_email != '') where rn = 1),

cte_is_member as 
(select user_id, has_mobile_app from 
(select user_id, 
(CASE WHEN user_id IN(select user_id from analytics_db.data_apps_simulated.identifies where context_device_type  = 'android' or context_device_type = 'iOS')
      THEN TRUE
      ELSE FALSE
      END) as has_mobile_app, row_number() over(partition by user_id order by timestamp desc) as rn from 
analytics_db.data_apps_simulated.identifies where timestamp >= '2021-05-01' and timestamp <= '2022-06-29'
and context_device_type is not null and context_device_type != '' and user_id is not null) where rn = 1),

cte_has_mobile_app as 
(select user_id, has_mobile_app from 
(select user_id, 
(CASE WHEN context_device_type = 'android' or context_device_type = 'iOS'
      THEN TRUE
      ELSE FALSE
END) as has_mobile_app, row_number() over(partition by user_id order by timestamp desc) as rn from 
analytics_db.data_apps_simulated.identifies where timestamp >= '2021-05-01' and timestamp <= '2022-06-29'
and context_device_type is not null and context_device_type != '' and user_id is not null) where rn = 1),

cte_is_active_on_website as 
(select user_id, is_active_on_website from 
(select user_id, 
(CASE WHEN user_id IN(select user_id from analytics_db.data_apps_simulated.identifies where context_device_type like '%PC')
      THEN TRUE
      ELSE FALSE
      END)
as is_active_on_website, row_number() over(partition by user_id order by timestamp desc) as rn from 
analytics_db.data_apps_simulated.identifies where timestamp >= '2021-05-01' and timestamp <= '2022-06-29'
and context_device_type is not null and context_device_type != '' and user_id is not null) where rn = 1)

select coalesce(a.user_id, b.user_id, c.user_id, d.user_id, e.user_id, f.user_id, g.user_id, h.user_id) 
as user_id, gender, age, country, state, email_domain, is_member, has_mobile_app, is_active_on_website
from ((((((cte_gender a full outer join cte_age b on a.user_id = b.user_id) 
full outer join cte_country c on c.user_id = coalesce(a.user_id, b.user_id))
full outer join cte_state d on d.user_id = coalesce(a.user_id, b.user_id, c.user_id))
full outer join cte_email_domain e on e.user_id = coalesce(a.user_id, b.user_id, c.user_id,d.user_id))
full outer join cte_is_member f on f.user_id = coalesce(a.user_id, b.user_id, c.user_id,d.user_id, e.user_id))
full outer join cte_has_mobile_app g on g.user_id = coalesce(a.user_id, b.user_id, c.user_id,d.user_id, e.user_id, f.user_id))
full outer join cte_is_active_on_website as h on h.user_id = coalesce(a.user_id, b.user_id, c.user_id,d.user_id, e.user_id, f.user_id, g.user_id)
limit 500
/* limit added automatically by dbt cloud */
2022-07-04 05:55:03.373244 (Thread-1): 05:55:03  Opening a new connection, currently in state init
2022-07-04 05:55:03.692200 (Thread-485): handling poll request
2022-07-04 05:55:03.692675 (Thread-485): 05:55:03  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '08022227-1dd0-4d09-94f1-e256bf2507d1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb0f02f40d0>]}
2022-07-04 05:55:03.693630 (Thread-485): sending response (<Response 8514 bytes [200 OK]>) to 10.0.12.141
2022-07-04 05:55:04.077720 (Thread-1): 05:55:04  Snowflake adapter: Snowflake query id: 01a56003-0602-327e-0019-82030465cd7e
2022-07-04 05:55:04.077964 (Thread-1): 05:55:04  Snowflake adapter: Snowflake error: 000904 (42000): SQL compilation error: error line 67 at position 55
invalid identifier 'IS_MEMBER'
2022-07-04 05:55:04.078145 (Thread-1): 05:55:04  finished collecting timing info
2022-07-04 05:55:04.078306 (Thread-1): 05:55:04  On rpc.ecommerce_data_model_dbt.request: Close
2022-07-04 05:55:04.134211 (Thread-1): Got an exception: Database Error
  000904 (42000): SQL compilation error: error line 67 at position 55
  invalid identifier 'IS_MEMBER'
Traceback (most recent call last):
  File "/usr/local/lib/python3.8/dist-packages/dbt/adapters/snowflake/connections.py", line 206, in exception_handler
    yield
  File "/usr/local/lib/python3.8/dist-packages/dbt/adapters/sql/connections.py", line 74, in add_query
    cursor.execute(sql, bindings)
  File "/usr/local/lib/python3.8/dist-packages/snowflake/connector/cursor.py", line 721, in execute
    Error.errorhandler_wrapper(
  File "/usr/local/lib/python3.8/dist-packages/snowflake/connector/errors.py", line 258, in errorhandler_wrapper
    cursor.errorhandler(connection, cursor, error_class, error_value)
  File "/usr/local/lib/python3.8/dist-packages/snowflake/connector/errors.py", line 188, in default_errorhandler
    raise error_class(
snowflake.connector.errors.ProgrammingError: 000904 (42000): SQL compilation error: error line 67 at position 55
invalid identifier 'IS_MEMBER'

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/usr/local/lib/python3.8/dist-packages/dbt/task/base.py", line 361, in safe_run
    result = self.compile_and_execute(manifest, ctx)
  File "/usr/local/lib/python3.8/dist-packages/dbt/task/base.py", line 314, in compile_and_execute
    result = self.run(ctx.node, manifest)
  File "/usr/local/lib/python3.8/dist-packages/dbt/task/base.py", line 403, in run
    return self.execute(compiled_node, manifest)
  File "/usr/local/lib/python3.8/dist-packages/dbt_rpc/rpc/node_runners.py", line 90, in execute
    _, execute_result = self.adapter.execute(
  File "/usr/local/lib/python3.8/dist-packages/dbt/adapters/base/impl.py", line 225, in execute
    return self.connections.execute(
  File "/usr/local/lib/python3.8/dist-packages/dbt/adapters/sql/connections.py", line 127, in execute
    _, cursor = self.add_query(sql, auto_begin)
  File "/usr/local/lib/python3.8/dist-packages/dbt/adapters/snowflake/connections.py", line 433, in add_query
    connection, cursor = super().add_query(
  File "/usr/local/lib/python3.8/dist-packages/dbt/adapters/sql/connections.py", line 83, in add_query
    return connection, cursor
  File "/usr/lib/python3.8/contextlib.py", line 131, in __exit__
    self.gen.throw(type, value, traceback)
  File "/usr/local/lib/python3.8/dist-packages/dbt/adapters/snowflake/connections.py", line 223, in exception_handler
    raise DatabaseException(msg)
dbt.exceptions.DatabaseException: Database Error
  000904 (42000): SQL compilation error: error line 67 at position 55
  invalid identifier 'IS_MEMBER'
2022-07-04 05:55:04.135308 (Thread-1): Got exception RPCException(10003, Database Error, {'type': 'DatabaseException', 'message': "Database Error in rpc request (from remote system)\n  000904 (42000): SQL compilation error: error line 67 at position 55\n  invalid identifier 'IS_MEMBER'", 'raw_sql': "with cte_gender as \n(select user_id, gender from \n(select user_id, properties_gender as gender, row_number() over(partition by user_id order by timestamp desc) as rn from \n{{ source('ecommerce', 'identifies') }} where timestamp >= '{{ var('start_date') }}' and timestamp <= '{{ var('end_date') }}'\nand properties_gender is not null and properties_gender != '') where rn = 1),\n\ncte_age as \n(select user_id, age from\n(select user_id, \n(CASE WHEN dateadd(year, datediff (year, properties_birthday, getdate()), properties_birthday) > getdate()\n      THEN datediff(year, properties_birthday, getdate()) - 1\n      ELSE datediff(year, properties_birthday, getdate())\n END) as age, row_number() over(partition by user_id order by timestamp desc) as rn \nfrom {{ source('ecommerce', 'identifies') }} where timestamp >= '{{ var('start_date') }}' and timestamp <= '{{ var('end_date') }}'\nand properties_birthday is not null and properties_birthday!='') where rn = 1),\n\ncte_country as \n(select user_id, country from \n(select user_id, properties_country as country, row_number() over(partition by user_id order by timestamp desc) as rn from \n{{ source('ecommerce', 'identifies') }} where timestamp >= '{{ var('start_date') }}' and timestamp <= '{{ var('end_date') }}'\nand properties_country is not null and properties_country != '') where rn = 1),\n\ncte_state as \n(select user_id, state from \n(select user_id, properties_state as state, row_number() over(partition by user_id order by timestamp desc) as rn from \n{{ source('ecommerce', 'identifies') }} where timestamp >= '{{ var('start_date') }}' and timestamp <= '{{ var('end_date') }}'\nand properties_state is not null and properties_state != '') where rn = 1),\n\ncte_email_domain as \n(select user_id, email_domain from \n(select user_id, substring(properties_email, charindex( '@', properties_email) + 1, len(properties_email)) as email_domain, row_number() over(partition by user_id order by timestamp desc) as rn from \n{{ source('ecommerce', 'identifies') }} where timestamp >= '{{ var('start_date') }}' and timestamp <= '{{ var('end_date') }}'\nand properties_email is not null and properties_email != '') where rn = 1),\n\ncte_is_member as \n(select user_id, has_mobile_app from \n(select user_id, \n(CASE WHEN user_id IN(select user_id from {{ source('ecommerce', 'identifies') }} where context_device_type  = 'android' or context_device_type = 'iOS')\n      THEN TRUE\n      ELSE FALSE\n      END) as has_mobile_app, row_number() over(partition by user_id order by timestamp desc) as rn from \n{{ source('ecommerce', 'identifies') }} where timestamp >= '{{ var('start_date') }}' and timestamp <= '{{ var('end_date') }}'\nand context_device_type is not null and context_device_type != '' and user_id is not null) where rn = 1),\n\ncte_has_mobile_app as \n(select user_id, has_mobile_app from \n(select user_id, \n(CASE WHEN context_device_type = 'android' or context_device_type = 'iOS'\n      THEN TRUE\n      ELSE FALSE\nEND) as has_mobile_app, row_number() over(partition by user_id order by timestamp desc) as rn from \n{{ source('ecommerce', 'identifies') }} where timestamp >= '{{ var('start_date') }}' and timestamp <= '{{ var('end_date') }}'\nand context_device_type is not null and context_device_type != '' and user_id is not null) where rn = 1),\n\ncte_is_active_on_website as \n(select user_id, is_active_on_website from \n(select user_id, \n(CASE WHEN user_id IN(select user_id from {{ source('ecommerce', 'identifies') }} where context_device_type like '%PC')\n      THEN TRUE\n      ELSE FALSE\n      END)\nas is_active_on_website, row_number() over(partition by user_id order by timestamp desc) as rn from \n{{ source('ecommerce', 'identifies') }} where timestamp >= '{{ var('start_date') }}' and timestamp <= '{{ var('end_date') }}'\nand context_device_type is not null and context_device_type != '' and user_id is not null) where rn = 1)\n\nselect coalesce(a.user_id, b.user_id, c.user_id, d.user_id, e.user_id, f.user_id, g.user_id, h.user_id) \nas user_id, gender, age, country, state, email_domain, is_member, has_mobile_app, is_active_on_website\nfrom ((((((cte_gender a full outer join cte_age b on a.user_id = b.user_id) \nfull outer join cte_country c on c.user_id = coalesce(a.user_id, b.user_id))\nfull outer join cte_state d on d.user_id = coalesce(a.user_id, b.user_id, c.user_id))\nfull outer join cte_email_domain e on e.user_id = coalesce(a.user_id, b.user_id, c.user_id,d.user_id))\nfull outer join cte_is_member f on f.user_id = coalesce(a.user_id, b.user_id, c.user_id,d.user_id, e.user_id))\nfull outer join cte_has_mobile_app g on g.user_id = coalesce(a.user_id, b.user_id, c.user_id,d.user_id, e.user_id, f.user_id))\nfull outer join cte_is_active_on_website as h on h.user_id = coalesce(a.user_id, b.user_id, c.user_id,d.user_id, e.user_id, f.user_id, g.user_id)\nlimit 500\n/* limit added automatically by dbt cloud */", 'compiled_sql': "with cte_gender as \n(select user_id, gender from \n(select user_id, properties_gender as gender, row_number() over(partition by user_id order by timestamp desc) as rn from \nanalytics_db.data_apps_simulated.identifies where timestamp >= '2021-05-01' and timestamp <= '2022-06-29'\nand properties_gender is not null and properties_gender != '') where rn = 1),\n\ncte_age as \n(select user_id, age from\n(select user_id, \n(CASE WHEN dateadd(year, datediff (year, properties_birthday, getdate()), properties_birthday) > getdate()\n      THEN datediff(year, properties_birthday, getdate()) - 1\n      ELSE datediff(year, properties_birthday, getdate())\n END) as age, row_number() over(partition by user_id order by timestamp desc) as rn \nfrom analytics_db.data_apps_simulated.identifies where timestamp >= '2021-05-01' and timestamp <= '2022-06-29'\nand properties_birthday is not null and properties_birthday!='') where rn = 1),\n\ncte_country as \n(select user_id, country from \n(select user_id, properties_country as country, row_number() over(partition by user_id order by timestamp desc) as rn from \nanalytics_db.data_apps_simulated.identifies where timestamp >= '2021-05-01' and timestamp <= '2022-06-29'\nand properties_country is not null and properties_country != '') where rn = 1),\n\ncte_state as \n(select user_id, state from \n(select user_id, properties_state as state, row_number() over(partition by user_id order by timestamp desc) as rn from \nanalytics_db.data_apps_simulated.identifies where timestamp >= '2021-05-01' and timestamp <= '2022-06-29'\nand properties_state is not null and properties_state != '') where rn = 1),\n\ncte_email_domain as \n(select user_id, email_domain from \n(select user_id, substring(properties_email, charindex( '@', properties_email) + 1, len(properties_email)) as email_domain, row_number() over(partition by user_id order by timestamp desc) as rn from \nanalytics_db.data_apps_simulated.identifies where timestamp >= '2021-05-01' and timestamp <= '2022-06-29'\nand properties_email is not null and properties_email != '') where rn = 1),\n\ncte_is_member as \n(select user_id, has_mobile_app from \n(select user_id, \n(CASE WHEN user_id IN(select user_id from analytics_db.data_apps_simulated.identifies where context_device_type  = 'android' or context_device_type = 'iOS')\n      THEN TRUE\n      ELSE FALSE\n      END) as has_mobile_app, row_number() over(partition by user_id order by timestamp desc) as rn from \nanalytics_db.data_apps_simulated.identifies where timestamp >= '2021-05-01' and timestamp <= '2022-06-29'\nand context_device_type is not null and context_device_type != '' and user_id is not null) where rn = 1),\n\ncte_has_mobile_app as \n(select user_id, has_mobile_app from \n(select user_id, \n(CASE WHEN context_device_type = 'android' or context_device_type = 'iOS'\n      THEN TRUE\n      ELSE FALSE\nEND) as has_mobile_app, row_number() over(partition by user_id order by timestamp desc) as rn from \nanalytics_db.data_apps_simulated.identifies where timestamp >= '2021-05-01' and timestamp <= '2022-06-29'\nand context_device_type is not null and context_device_type != '' and user_id is not null) where rn = 1),\n\ncte_is_active_on_website as \n(select user_id, is_active_on_website from \n(select user_id, \n(CASE WHEN user_id IN(select user_id from analytics_db.data_apps_simulated.identifies where context_device_type like '%PC')\n      THEN TRUE\n      ELSE FALSE\n      END)\nas is_active_on_website, row_number() over(partition by user_id order by timestamp desc) as rn from \nanalytics_db.data_apps_simulated.identifies where timestamp >= '2021-05-01' and timestamp <= '2022-06-29'\nand context_device_type is not null and context_device_type != '' and user_id is not null) where rn = 1)\n\nselect coalesce(a.user_id, b.user_id, c.user_id, d.user_id, e.user_id, f.user_id, g.user_id, h.user_id) \nas user_id, gender, age, country, state, email_domain, is_member, has_mobile_app, is_active_on_website\nfrom ((((((cte_gender a full outer join cte_age b on a.user_id = b.user_id) \nfull outer join cte_country c on c.user_id = coalesce(a.user_id, b.user_id))\nfull outer join cte_state d on d.user_id = coalesce(a.user_id, b.user_id, c.user_id))\nfull outer join cte_email_domain e on e.user_id = coalesce(a.user_id, b.user_id, c.user_id,d.user_id))\nfull outer join cte_is_member f on f.user_id = coalesce(a.user_id, b.user_id, c.user_id,d.user_id, e.user_id))\nfull outer join cte_has_mobile_app g on g.user_id = coalesce(a.user_id, b.user_id, c.user_id,d.user_id, e.user_id, f.user_id))\nfull outer join cte_is_active_on_website as h on h.user_id = coalesce(a.user_id, b.user_id, c.user_id,d.user_id, e.user_id, f.user_id, g.user_id)\nlimit 500\n/* limit added automatically by dbt cloud */", 'tags': None}, None)
Traceback (most recent call last):
  File "/usr/local/lib/python3.8/dist-packages/dbt_rpc/task/sql_commands.py", line 147, in _in_thread
    self.node_results.append(runner.safe_run(self.manifest))
  File "/usr/local/lib/python3.8/dist-packages/dbt/task/base.py", line 377, in safe_run
    result = self.error_result(ctx.node, error, started, [])
  File "/usr/local/lib/python3.8/dist-packages/dbt_rpc/rpc/node_runners.py", line 56, in error_result
    raise error
dbt_rpc.rpc.error.RPCException: RPCException(10003, Database Error, {'type': 'DatabaseException', 'message': "Database Error in rpc request (from remote system)\n  000904 (42000): SQL compilation error: error line 67 at position 55\n  invalid identifier 'IS_MEMBER'", 'raw_sql': "with cte_gender as \n(select user_id, gender from \n(select user_id, properties_gender as gender, row_number() over(partition by user_id order by timestamp desc) as rn from \n{{ source('ecommerce', 'identifies') }} where timestamp >= '{{ var('start_date') }}' and timestamp <= '{{ var('end_date') }}'\nand properties_gender is not null and properties_gender != '') where rn = 1),\n\ncte_age as \n(select user_id, age from\n(select user_id, \n(CASE WHEN dateadd(year, datediff (year, properties_birthday, getdate()), properties_birthday) > getdate()\n      THEN datediff(year, properties_birthday, getdate()) - 1\n      ELSE datediff(year, properties_birthday, getdate())\n END) as age, row_number() over(partition by user_id order by timestamp desc) as rn \nfrom {{ source('ecommerce', 'identifies') }} where timestamp >= '{{ var('start_date') }}' and timestamp <= '{{ var('end_date') }}'\nand properties_birthday is not null and properties_birthday!='') where rn = 1),\n\ncte_country as \n(select user_id, country from \n(select user_id, properties_country as country, row_number() over(partition by user_id order by timestamp desc) as rn from \n{{ source('ecommerce', 'identifies') }} where timestamp >= '{{ var('start_date') }}' and timestamp <= '{{ var('end_date') }}'\nand properties_country is not null and properties_country != '') where rn = 1),\n\ncte_state as \n(select user_id, state from \n(select user_id, properties_state as state, row_number() over(partition by user_id order by timestamp desc) as rn from \n{{ source('ecommerce', 'identifies') }} where timestamp >= '{{ var('start_date') }}' and timestamp <= '{{ var('end_date') }}'\nand properties_state is not null and properties_state != '') where rn = 1),\n\ncte_email_domain as \n(select user_id, email_domain from \n(select user_id, substring(properties_email, charindex( '@', properties_email) + 1, len(properties_email)) as email_domain, row_number() over(partition by user_id order by timestamp desc) as rn from \n{{ source('ecommerce', 'identifies') }} where timestamp >= '{{ var('start_date') }}' and timestamp <= '{{ var('end_date') }}'\nand properties_email is not null and properties_email != '') where rn = 1),\n\ncte_is_member as \n(select user_id, has_mobile_app from \n(select user_id, \n(CASE WHEN user_id IN(select user_id from {{ source('ecommerce', 'identifies') }} where context_device_type  = 'android' or context_device_type = 'iOS')\n      THEN TRUE\n      ELSE FALSE\n      END) as has_mobile_app, row_number() over(partition by user_id order by timestamp desc) as rn from \n{{ source('ecommerce', 'identifies') }} where timestamp >= '{{ var('start_date') }}' and timestamp <= '{{ var('end_date') }}'\nand context_device_type is not null and context_device_type != '' and user_id is not null) where rn = 1),\n\ncte_has_mobile_app as \n(select user_id, has_mobile_app from \n(select user_id, \n(CASE WHEN context_device_type = 'android' or context_device_type = 'iOS'\n      THEN TRUE\n      ELSE FALSE\nEND) as has_mobile_app, row_number() over(partition by user_id order by timestamp desc) as rn from \n{{ source('ecommerce', 'identifies') }} where timestamp >= '{{ var('start_date') }}' and timestamp <= '{{ var('end_date') }}'\nand context_device_type is not null and context_device_type != '' and user_id is not null) where rn = 1),\n\ncte_is_active_on_website as \n(select user_id, is_active_on_website from \n(select user_id, \n(CASE WHEN user_id IN(select user_id from {{ source('ecommerce', 'identifies') }} where context_device_type like '%PC')\n      THEN TRUE\n      ELSE FALSE\n      END)\nas is_active_on_website, row_number() over(partition by user_id order by timestamp desc) as rn from \n{{ source('ecommerce', 'identifies') }} where timestamp >= '{{ var('start_date') }}' and timestamp <= '{{ var('end_date') }}'\nand context_device_type is not null and context_device_type != '' and user_id is not null) where rn = 1)\n\nselect coalesce(a.user_id, b.user_id, c.user_id, d.user_id, e.user_id, f.user_id, g.user_id, h.user_id) \nas user_id, gender, age, country, state, email_domain, is_member, has_mobile_app, is_active_on_website\nfrom ((((((cte_gender a full outer join cte_age b on a.user_id = b.user_id) \nfull outer join cte_country c on c.user_id = coalesce(a.user_id, b.user_id))\nfull outer join cte_state d on d.user_id = coalesce(a.user_id, b.user_id, c.user_id))\nfull outer join cte_email_domain e on e.user_id = coalesce(a.user_id, b.user_id, c.user_id,d.user_id))\nfull outer join cte_is_member f on f.user_id = coalesce(a.user_id, b.user_id, c.user_id,d.user_id, e.user_id))\nfull outer join cte_has_mobile_app g on g.user_id = coalesce(a.user_id, b.user_id, c.user_id,d.user_id, e.user_id, f.user_id))\nfull outer join cte_is_active_on_website as h on h.user_id = coalesce(a.user_id, b.user_id, c.user_id,d.user_id, e.user_id, f.user_id, g.user_id)\nlimit 500\n/* limit added automatically by dbt cloud */", 'compiled_sql': "with cte_gender as \n(select user_id, gender from \n(select user_id, properties_gender as gender, row_number() over(partition by user_id order by timestamp desc) as rn from \nanalytics_db.data_apps_simulated.identifies where timestamp >= '2021-05-01' and timestamp <= '2022-06-29'\nand properties_gender is not null and properties_gender != '') where rn = 1),\n\ncte_age as \n(select user_id, age from\n(select user_id, \n(CASE WHEN dateadd(year, datediff (year, properties_birthday, getdate()), properties_birthday) > getdate()\n      THEN datediff(year, properties_birthday, getdate()) - 1\n      ELSE datediff(year, properties_birthday, getdate())\n END) as age, row_number() over(partition by user_id order by timestamp desc) as rn \nfrom analytics_db.data_apps_simulated.identifies where timestamp >= '2021-05-01' and timestamp <= '2022-06-29'\nand properties_birthday is not null and properties_birthday!='') where rn = 1),\n\ncte_country as \n(select user_id, country from \n(select user_id, properties_country as country, row_number() over(partition by user_id order by timestamp desc) as rn from \nanalytics_db.data_apps_simulated.identifies where timestamp >= '2021-05-01' and timestamp <= '2022-06-29'\nand properties_country is not null and properties_country != '') where rn = 1),\n\ncte_state as \n(select user_id, state from \n(select user_id, properties_state as state, row_number() over(partition by user_id order by timestamp desc) as rn from \nanalytics_db.data_apps_simulated.identifies where timestamp >= '2021-05-01' and timestamp <= '2022-06-29'\nand properties_state is not null and properties_state != '') where rn = 1),\n\ncte_email_domain as \n(select user_id, email_domain from \n(select user_id, substring(properties_email, charindex( '@', properties_email) + 1, len(properties_email)) as email_domain, row_number() over(partition by user_id order by timestamp desc) as rn from \nanalytics_db.data_apps_simulated.identifies where timestamp >= '2021-05-01' and timestamp <= '2022-06-29'\nand properties_email is not null and properties_email != '') where rn = 1),\n\ncte_is_member as \n(select user_id, has_mobile_app from \n(select user_id, \n(CASE WHEN user_id IN(select user_id from analytics_db.data_apps_simulated.identifies where context_device_type  = 'android' or context_device_type = 'iOS')\n      THEN TRUE\n      ELSE FALSE\n      END) as has_mobile_app, row_number() over(partition by user_id order by timestamp desc) as rn from \nanalytics_db.data_apps_simulated.identifies where timestamp >= '2021-05-01' and timestamp <= '2022-06-29'\nand context_device_type is not null and context_device_type != '' and user_id is not null) where rn = 1),\n\ncte_has_mobile_app as \n(select user_id, has_mobile_app from \n(select user_id, \n(CASE WHEN context_device_type = 'android' or context_device_type = 'iOS'\n      THEN TRUE\n      ELSE FALSE\nEND) as has_mobile_app, row_number() over(partition by user_id order by timestamp desc) as rn from \nanalytics_db.data_apps_simulated.identifies where timestamp >= '2021-05-01' and timestamp <= '2022-06-29'\nand context_device_type is not null and context_device_type != '' and user_id is not null) where rn = 1),\n\ncte_is_active_on_website as \n(select user_id, is_active_on_website from \n(select user_id, \n(CASE WHEN user_id IN(select user_id from analytics_db.data_apps_simulated.identifies where context_device_type like '%PC')\n      THEN TRUE\n      ELSE FALSE\n      END)\nas is_active_on_website, row_number() over(partition by user_id order by timestamp desc) as rn from \nanalytics_db.data_apps_simulated.identifies where timestamp >= '2021-05-01' and timestamp <= '2022-06-29'\nand context_device_type is not null and context_device_type != '' and user_id is not null) where rn = 1)\n\nselect coalesce(a.user_id, b.user_id, c.user_id, d.user_id, e.user_id, f.user_id, g.user_id, h.user_id) \nas user_id, gender, age, country, state, email_domain, is_member, has_mobile_app, is_active_on_website\nfrom ((((((cte_gender a full outer join cte_age b on a.user_id = b.user_id) \nfull outer join cte_country c on c.user_id = coalesce(a.user_id, b.user_id))\nfull outer join cte_state d on d.user_id = coalesce(a.user_id, b.user_id, c.user_id))\nfull outer join cte_email_domain e on e.user_id = coalesce(a.user_id, b.user_id, c.user_id,d.user_id))\nfull outer join cte_is_member f on f.user_id = coalesce(a.user_id, b.user_id, c.user_id,d.user_id, e.user_id))\nfull outer join cte_has_mobile_app g on g.user_id = coalesce(a.user_id, b.user_id, c.user_id,d.user_id, e.user_id, f.user_id))\nfull outer join cte_is_active_on_website as h on h.user_id = coalesce(a.user_id, b.user_id, c.user_id,d.user_id, e.user_id, f.user_id, g.user_id)\nlimit 500\n/* limit added automatically by dbt cloud */", 'tags': None}, None)
2022-07-04 05:55:05.058580 (Thread-486): handling poll request
2022-07-04 05:55:05.059005 (Thread-486): 05:55:05  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '08022227-1dd0-4d09-94f1-e256bf2507d1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb0f02f4c70>]}
2022-07-04 05:55:05.059857 (Thread-486): sending response (<Response 43618 bytes [200 OK]>) to 10.0.12.141
2022-07-04 05:56:03.017088 (Thread-487): 05:56:03  Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
2022-07-04 05:56:03.017713 (Thread-487): 05:56:03  Partial parsing: updated file: ecommerce_data_model_dbt://models/data_model/stg_user_traits.sql
2022-07-04 05:56:03.022648 (Thread-487): 05:56:03  1603: static parser failed on data_model/stg_user_traits.sql
2022-07-04 05:56:03.032561 (Thread-487): 05:56:03  1602: parser fallback to jinja rendering on data_model/stg_user_traits.sql
2022-07-04 05:56:03.070230 (Thread-487): 05:56:03  [WARNING]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.data-apps-ecommerce-template.data_model

2022-07-04 05:56:03.075906 (Thread-487): 05:56:03  Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '08022227-1dd0-4d09-94f1-e256bf2507d1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb0f0ab0cd0>]}
2022-07-04 05:56:03.771659 (Thread-488): handling status request
2022-07-04 05:56:03.772082 (Thread-488): 05:56:03  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '08022227-1dd0-4d09-94f1-e256bf2507d1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb0f02c4550>]}
2022-07-04 05:56:03.772621 (Thread-488): sending response (<Response 2357 bytes [200 OK]>) to 10.0.12.141
2022-07-04 05:56:03.813315 (Thread-489): handling status request
2022-07-04 05:56:03.813702 (Thread-489): 05:56:03  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '08022227-1dd0-4d09-94f1-e256bf2507d1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb0f02f4be0>]}
2022-07-04 05:56:03.814221 (Thread-489): sending response (<Response 2357 bytes [200 OK]>) to 10.0.12.141
2022-07-04 05:56:05.788168 (Thread-490): handling status request
2022-07-04 05:56:05.788576 (Thread-490): 05:56:05  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '08022227-1dd0-4d09-94f1-e256bf2507d1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb0f02f4ee0>]}
2022-07-04 05:56:05.789067 (Thread-490): sending response (<Response 2357 bytes [200 OK]>) to 10.0.12.141
2022-07-04 05:56:06.188426 (Thread-491): handling run_sql request
2022-07-04 05:56:06.188837 (Thread-491): 05:56:06  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '08022227-1dd0-4d09-94f1-e256bf2507d1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb0f045e160>]}
2022-07-04 05:56:08.539895 (Thread-491): sending response (<Response 139 bytes [200 OK]>) to 10.0.12.141
2022-07-04 05:56:08.574597 (MainThread): 05:56:08  Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '49c67d38-1de6-4ebb-be40-ee2b24e64dbd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb32b516970>]}
2022-07-04 05:56:08.575150 (MainThread): 05:56:08  Found 14 models, 0 tests, 0 snapshots, 0 analyses, 179 macros, 0 operations, 0 seed files, 15 sources, 0 exposures, 0 metrics
2022-07-04 05:56:08.575786 (Thread-1): 05:56:08  Acquiring new snowflake connection "rpc.ecommerce_data_model_dbt.request"
2022-07-04 05:56:08.575925 (Thread-1): 05:56:08  Began compiling node rpc.ecommerce_data_model_dbt.request
2022-07-04 05:56:08.576022 (Thread-1): 05:56:08  Compiling rpc.ecommerce_data_model_dbt.request
2022-07-04 05:56:08.584041 (Thread-1): 05:56:08  finished collecting timing info
2022-07-04 05:56:08.584195 (Thread-1): 05:56:08  Began executing node rpc.ecommerce_data_model_dbt.request
2022-07-04 05:56:08.589094 (Thread-1): 05:56:08  Using snowflake connection "rpc.ecommerce_data_model_dbt.request"
2022-07-04 05:56:08.589199 (Thread-1): 05:56:08  On rpc.ecommerce_data_model_dbt.request: with cte_gender as 
(select user_id, gender from 
(select user_id, properties_gender as gender, row_number() over(partition by user_id order by timestamp desc) as rn from 
analytics_db.data_apps_simulated.identifies where timestamp >= '2021-05-01' and timestamp <= '2022-06-29'
and properties_gender is not null and properties_gender != '') where rn = 1),

cte_age as 
(select user_id, age from
(select user_id, 
(CASE WHEN dateadd(year, datediff (year, properties_birthday, getdate()), properties_birthday) > getdate()
      THEN datediff(year, properties_birthday, getdate()) - 1
      ELSE datediff(year, properties_birthday, getdate())
 END) as age, row_number() over(partition by user_id order by timestamp desc) as rn 
from analytics_db.data_apps_simulated.identifies where timestamp >= '2021-05-01' and timestamp <= '2022-06-29'
and properties_birthday is not null and properties_birthday!='') where rn = 1),

cte_country as 
(select user_id, country from 
(select user_id, properties_country as country, row_number() over(partition by user_id order by timestamp desc) as rn from 
analytics_db.data_apps_simulated.identifies where timestamp >= '2021-05-01' and timestamp <= '2022-06-29'
and properties_country is not null and properties_country != '') where rn = 1),

cte_state as 
(select user_id, state from 
(select user_id, properties_state as state, row_number() over(partition by user_id order by timestamp desc) as rn from 
analytics_db.data_apps_simulated.identifies where timestamp >= '2021-05-01' and timestamp <= '2022-06-29'
and properties_state is not null and properties_state != '') where rn = 1),

cte_email_domain as 
(select user_id, email_domain from 
(select user_id, substring(properties_email, charindex( '@', properties_email) + 1, len(properties_email)) as email_domain, row_number() over(partition by user_id order by timestamp desc) as rn from 
analytics_db.data_apps_simulated.identifies where timestamp >= '2021-05-01' and timestamp <= '2022-06-29'
and properties_email is not null and properties_email != '') where rn = 1),

cte_is_member as 
(select user_id, is_member from
(select user_id, 
(CASE WHEN properties_is_member = TRUE
      THEN TRUE
      ELSE FALSE
END) as is_member, row_number() over(partition by user_id order by timestamp desc) as rn from 
analytics_db.data_apps_simulated.identifies where timestamp >= '2021-05-01' and timestamp <= '2022-06-29'
and user_id is not null) where rn = 1),

cte_has_mobile_app as 
(select user_id, has_mobile_app from 
(select user_id, 
(CASE WHEN user_id IN(select user_id from analytics_db.data_apps_simulated.identifies where context_device_type  = 'android' or context_device_type = 'iOS')
      THEN TRUE
      ELSE FALSE
      END) as has_mobile_app, row_number() over(partition by user_id order by timestamp desc) as rn from 
analytics_db.data_apps_simulated.identifies where timestamp >= '2021-05-01' and timestamp <= '2022-06-29'
and context_device_type is not null and context_device_type != '' and user_id is not null) where rn = 1),

cte_is_active_on_website as 
(select user_id, is_active_on_website from 
(select user_id, 
(CASE WHEN user_id IN(select user_id from analytics_db.data_apps_simulated.identifies where context_device_type like '%PC')
      THEN TRUE
      ELSE FALSE
      END)
as is_active_on_website, row_number() over(partition by user_id order by timestamp desc) as rn from 
analytics_db.data_apps_simulated.identifies where timestamp >= '2021-05-01' and timestamp <= '2022-06-29'
and context_device_type is not null and context_device_type != '' and user_id is not null) where rn = 1)

select coalesce(a.user_id, b.user_id, c.user_id, d.user_id, e.user_id, f.user_id, g.user_id, h.user_id) 
as user_id, gender, age, country, state, email_domain, is_member, has_mobile_app, is_active_on_website
from ((((((cte_gender a full outer join cte_age b on a.user_id = b.user_id) 
full outer join cte_country c on c.user_id = coalesce(a.user_id, b.user_id))
full outer join cte_state d on d.user_id = coalesce(a.user_id, b.user_id, c.user_id))
full outer join cte_email_domain e on e.user_id = coalesce(a.user_id, b.user_id, c.user_id,d.user_id))
full outer join cte_is_member f on f.user_id = coalesce(a.user_id, b.user_id, c.user_id,d.user_id, e.user_id))
full outer join cte_has_mobile_app g on g.user_id = coalesce(a.user_id, b.user_id, c.user_id,d.user_id, e.user_id, f.user_id))
full outer join cte_is_active_on_website as h on h.user_id = coalesce(a.user_id, b.user_id, c.user_id,d.user_id, e.user_id, f.user_id, g.user_id)
limit 500
/* limit added automatically by dbt cloud */
2022-07-04 05:56:08.589286 (Thread-1): 05:56:08  Opening a new connection, currently in state init
2022-07-04 05:56:08.904720 (Thread-492): handling poll request
2022-07-04 05:56:08.905213 (Thread-492): 05:56:08  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '08022227-1dd0-4d09-94f1-e256bf2507d1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb0f044ff10>]}
2022-07-04 05:56:08.906214 (Thread-492): sending response (<Response 8401 bytes [200 OK]>) to 10.0.12.141
2022-07-04 05:56:10.287242 (Thread-493): handling poll request
2022-07-04 05:56:10.287670 (Thread-493): 05:56:10  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '08022227-1dd0-4d09-94f1-e256bf2507d1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb0f044fd60>]}
2022-07-04 05:56:10.288196 (Thread-493): sending response (<Response 399 bytes [200 OK]>) to 10.0.12.141
2022-07-04 05:56:10.424982 (Thread-1): 05:56:10  SQL status: SUCCESS 5 in 1.84 seconds
2022-07-04 05:56:10.426715 (Thread-1): 05:56:10  finished collecting timing info
2022-07-04 05:56:10.426907 (Thread-1): 05:56:10  On rpc.ecommerce_data_model_dbt.request: Close
2022-07-04 05:56:11.652016 (Thread-494): handling poll request
2022-07-04 05:56:11.652440 (Thread-494): 05:56:11  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '08022227-1dd0-4d09-94f1-e256bf2507d1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb0f044f280>]}
2022-07-04 05:56:11.653521 (Thread-494): sending response (<Response 23428 bytes [200 OK]>) to 10.0.12.141
2022-07-04 05:57:39.168188 (Thread-495): 05:57:39  Partial parsing enabled: 0 files deleted, 1 files added, 0 files changed.
2022-07-04 05:57:39.170370 (Thread-495): 05:57:39  Partial parsing: added file: ecommerce_data_model_dbt://models/data_model/temp_folder/preferred_login_device.sql
2022-07-04 05:57:39.174602 (Thread-495): 05:57:39  1699: static parser successfully parsed data_model/temp_folder/preferred_login_device.sql
2022-07-04 05:57:39.210308 (Thread-495): 05:57:39  [WARNING]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.data-apps-ecommerce-template.data_model

2022-07-04 05:57:39.216041 (Thread-495): 05:57:39  Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '08022227-1dd0-4d09-94f1-e256bf2507d1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb0f01ddf70>]}
2022-07-04 05:57:40.002808 (Thread-496): handling status request
2022-07-04 05:57:40.003272 (Thread-496): 05:57:40  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '08022227-1dd0-4d09-94f1-e256bf2507d1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb0f04b1a60>]}
2022-07-04 05:57:40.003917 (Thread-496): sending response (<Response 2087 bytes [200 OK]>) to 10.0.12.141
2022-07-04 05:57:40.048646 (Thread-497): handling status request
2022-07-04 05:57:40.049063 (Thread-497): 05:57:40  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '08022227-1dd0-4d09-94f1-e256bf2507d1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb0f0f33670>]}
2022-07-04 05:57:40.049561 (Thread-497): sending response (<Response 2087 bytes [200 OK]>) to 10.0.12.141
2022-07-04 05:57:54.402531 (Thread-498): 05:57:54  Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
2022-07-04 05:57:54.402770 (Thread-498): 05:57:54  Partial parsing enabled, no changes found, skipping parsing
2022-07-04 05:57:54.403409 (Thread-498): 05:57:54  [WARNING]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.data-apps-ecommerce-template.data_model

2022-07-04 05:57:54.409018 (Thread-498): 05:57:54  Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '08022227-1dd0-4d09-94f1-e256bf2507d1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb0f0949460>]}
2022-07-04 05:57:55.192941 (Thread-499): handling status request
2022-07-04 05:57:55.193375 (Thread-499): 05:57:55  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '08022227-1dd0-4d09-94f1-e256bf2507d1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb0f0f0a730>]}
2022-07-04 05:57:55.193898 (Thread-499): sending response (<Response 1703 bytes [200 OK]>) to 10.0.12.141
2022-07-04 05:57:55.339131 (Thread-500): handling status request
2022-07-04 05:57:55.339527 (Thread-500): 05:57:55  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '08022227-1dd0-4d09-94f1-e256bf2507d1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb0f0f0ac10>]}
2022-07-04 05:57:55.340018 (Thread-500): sending response (<Response 1703 bytes [200 OK]>) to 10.0.12.141
2022-07-04 05:58:39.124411 (Thread-501): 05:58:39  Partial parsing enabled: 0 files deleted, 1 files added, 0 files changed.
2022-07-04 05:58:39.124890 (Thread-501): 05:58:39  Partial parsing: added file: ecommerce_data_model_dbt://models/data_model/temp_folder/device_type.sql
2022-07-04 05:58:39.128685 (Thread-501): 05:58:39  1699: static parser successfully parsed data_model/temp_folder/device_type.sql
2022-07-04 05:58:39.191464 (Thread-501): 05:58:39  [WARNING]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.data-apps-ecommerce-template.data_model

2022-07-04 05:58:39.197050 (Thread-501): 05:58:39  Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '08022227-1dd0-4d09-94f1-e256bf2507d1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb0f08435e0>]}
2022-07-04 05:58:39.904232 (Thread-502): handling status request
2022-07-04 05:58:39.904638 (Thread-502): 05:58:39  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '08022227-1dd0-4d09-94f1-e256bf2507d1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb0f0ec0520>]}
2022-07-04 05:58:39.905143 (Thread-502): sending response (<Response 2065 bytes [200 OK]>) to 10.0.12.141
2022-07-04 05:58:39.943295 (Thread-503): handling status request
2022-07-04 05:58:39.943714 (Thread-503): 05:58:39  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '08022227-1dd0-4d09-94f1-e256bf2507d1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb0f0ec02e0>]}
2022-07-04 05:58:39.944217 (Thread-503): sending response (<Response 2065 bytes [200 OK]>) to 10.0.12.141
2022-07-04 05:59:26.412376 (Thread-504): 05:59:26  Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
2022-07-04 05:59:26.412931 (Thread-504): 05:59:26  Partial parsing: updated file: ecommerce_data_model_dbt://models/data_model/temp_folder/device_type.sql
2022-07-04 05:59:26.416769 (Thread-504): 05:59:26  1603: static parser failed on data_model/temp_folder/device_type.sql
2022-07-04 05:59:26.420525 (Thread-504): 05:59:26  1602: parser fallback to jinja rendering on data_model/temp_folder/device_type.sql
2022-07-04 05:59:26.458148 (Thread-504): 05:59:26  [WARNING]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.data-apps-ecommerce-template.data_model

2022-07-04 05:59:26.463262 (Thread-504): 05:59:26  Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '08022227-1dd0-4d09-94f1-e256bf2507d1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb0f09e6070>]}
2022-07-04 05:59:27.195307 (Thread-505): handling status request
2022-07-04 05:59:27.195729 (Thread-505): 05:59:27  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '08022227-1dd0-4d09-94f1-e256bf2507d1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb0f094ac10>]}
2022-07-04 05:59:27.196245 (Thread-505): sending response (<Response 2381 bytes [200 OK]>) to 10.0.12.141
2022-07-04 05:59:27.264953 (Thread-506): handling status request
2022-07-04 05:59:27.265356 (Thread-506): 05:59:27  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '08022227-1dd0-4d09-94f1-e256bf2507d1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb0f094a700>]}
2022-07-04 05:59:27.265854 (Thread-506): sending response (<Response 2381 bytes [200 OK]>) to 10.0.12.141
2022-07-04 05:59:39.489630 (Thread-507): 05:59:39  Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
2022-07-04 05:59:39.489844 (Thread-507): 05:59:39  Partial parsing enabled, no changes found, skipping parsing
2022-07-04 05:59:39.490540 (Thread-507): 05:59:39  [WARNING]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.data-apps-ecommerce-template.data_model

2022-07-04 05:59:39.496509 (Thread-507): 05:59:39  Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '08022227-1dd0-4d09-94f1-e256bf2507d1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb0f00f47f0>]}
2022-07-04 05:59:40.251167 (Thread-508): handling status request
2022-07-04 05:59:40.251610 (Thread-508): 05:59:40  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '08022227-1dd0-4d09-94f1-e256bf2507d1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb0f086c130>]}
2022-07-04 05:59:40.252145 (Thread-508): sending response (<Response 1703 bytes [200 OK]>) to 10.0.12.141
2022-07-04 05:59:40.542152 (Thread-509): handling status request
2022-07-04 05:59:40.542556 (Thread-509): 05:59:40  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '08022227-1dd0-4d09-94f1-e256bf2507d1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb0f0f12970>]}
2022-07-04 05:59:40.543048 (Thread-509): sending response (<Response 1703 bytes [200 OK]>) to 10.0.12.141
2022-07-04 06:01:14.192218 (Thread-510): 06:01:14  Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
2022-07-04 06:01:14.194713 (Thread-510): 06:01:14  Partial parsing: updated file: ecommerce_data_model_dbt://models/data_model/stg_user_traits.sql
2022-07-04 06:01:14.200138 (Thread-510): 06:01:14  1603: static parser failed on data_model/stg_user_traits.sql
2022-07-04 06:01:14.210233 (Thread-510): 06:01:14  1602: parser fallback to jinja rendering on data_model/stg_user_traits.sql
2022-07-04 06:01:14.247898 (Thread-510): 06:01:14  [WARNING]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.data-apps-ecommerce-template.data_model

2022-07-04 06:01:14.253952 (Thread-510): 06:01:14  Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '08022227-1dd0-4d09-94f1-e256bf2507d1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb0f0089d30>]}
2022-07-04 06:01:14.992778 (Thread-511): handling status request
2022-07-04 06:01:14.993188 (Thread-511): 06:01:14  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '08022227-1dd0-4d09-94f1-e256bf2507d1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb0f085dc10>]}
2022-07-04 06:01:14.993701 (Thread-511): sending response (<Response 2357 bytes [200 OK]>) to 10.0.12.141
2022-07-04 06:01:14.996571 (Thread-512): handling status request
2022-07-04 06:01:14.996939 (Thread-512): 06:01:14  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '08022227-1dd0-4d09-94f1-e256bf2507d1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb0f085da60>]}
2022-07-04 06:01:14.997349 (Thread-512): sending response (<Response 2357 bytes [200 OK]>) to 10.0.12.141
2022-07-04 06:01:16.953598 (Thread-513): handling status request
2022-07-04 06:01:16.954063 (Thread-513): 06:01:16  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '08022227-1dd0-4d09-94f1-e256bf2507d1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb0f085d8b0>]}
2022-07-04 06:01:16.954596 (Thread-513): sending response (<Response 2357 bytes [200 OK]>) to 10.0.12.141
2022-07-04 06:01:17.322784 (Thread-514): handling run_sql request
2022-07-04 06:01:17.323215 (Thread-514): 06:01:17  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '08022227-1dd0-4d09-94f1-e256bf2507d1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb0f085d700>]}
2022-07-04 06:01:19.689045 (Thread-514): sending response (<Response 139 bytes [200 OK]>) to 10.0.12.141
2022-07-04 06:01:19.726872 (MainThread): 06:01:19  Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'ca63496e-795f-45c6-9eb8-547379c45b91', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f62052dcf40>]}
2022-07-04 06:01:19.727509 (MainThread): 06:01:19  Found 16 models, 0 tests, 0 snapshots, 0 analyses, 179 macros, 0 operations, 0 seed files, 15 sources, 0 exposures, 0 metrics
2022-07-04 06:01:19.728175 (Thread-1): 06:01:19  Acquiring new snowflake connection "rpc.ecommerce_data_model_dbt.request"
2022-07-04 06:01:19.728304 (Thread-1): 06:01:19  Began compiling node rpc.ecommerce_data_model_dbt.request
2022-07-04 06:01:19.728397 (Thread-1): 06:01:19  Compiling rpc.ecommerce_data_model_dbt.request
2022-07-04 06:01:19.737093 (Thread-1): 06:01:19  finished collecting timing info
2022-07-04 06:01:19.737235 (Thread-1): 06:01:19  Began executing node rpc.ecommerce_data_model_dbt.request
2022-07-04 06:01:19.742638 (Thread-1): 06:01:19  Using snowflake connection "rpc.ecommerce_data_model_dbt.request"
2022-07-04 06:01:19.742745 (Thread-1): 06:01:19  On rpc.ecommerce_data_model_dbt.request: with cte_gender as 
(select user_id, gender from 
(select user_id, properties_gender as gender, row_number() over(partition by user_id order by timestamp desc) as rn from 
analytics_db.data_apps_simulated.identifies where timestamp >= '2021-05-01' and timestamp <= '2022-06-29'
and properties_gender is not null and properties_gender != '') where rn = 1),

cte_age as 
(select user_id, age from
(select user_id, 
(CASE WHEN dateadd(year, datediff (year, properties_birthday, getdate()), properties_birthday) > getdate()
      THEN datediff(year, properties_birthday, getdate()) - 1
      ELSE datediff(year, properties_birthday, getdate())
 END) as age, row_number() over(partition by user_id order by timestamp desc) as rn 
from analytics_db.data_apps_simulated.identifies where timestamp >= '2021-05-01' and timestamp <= '2022-06-29'
and properties_birthday is not null and properties_birthday!='') where rn = 1),

cte_country as 
(select user_id, country from 
(select user_id, properties_country as country, row_number() over(partition by user_id order by timestamp desc) as rn from 
analytics_db.data_apps_simulated.identifies where timestamp >= '2021-05-01' and timestamp <= '2022-06-29'
and properties_country is not null and properties_country != '') where rn = 1),

cte_state as 
(select user_id, state from 
(select user_id, properties_state as state, row_number() over(partition by user_id order by timestamp desc) as rn from 
analytics_db.data_apps_simulated.identifies where timestamp >= '2021-05-01' and timestamp <= '2022-06-29'
and properties_state is not null and properties_state != '') where rn = 1),

cte_email_domain as 
(select user_id, email_domain from 
(select user_id, substring(properties_email, charindex( '@', properties_email) + 1, len(properties_email)) as email_domain, row_number() over(partition by user_id order by timestamp desc) as rn from 
analytics_db.data_apps_simulated.identifies where timestamp >= '2021-05-01' and timestamp <= '2022-06-29'
and properties_email is not null and properties_email != '') where rn = 1),

cte_is_member as 
(select user_id, is_member from
(select user_id, 
(CASE WHEN properties_is_member = TRUE
      THEN TRUE
      ELSE FALSE
END) as is_member, row_number() over(partition by user_id order by timestamp desc) as rn from 
analytics_db.data_apps_simulated.identifies where timestamp >= '2021-05-01' and timestamp <= '2022-06-29'
and user_id is not null) where rn = 1),

cte_has_mobile_app as 
(select user_id, has_mobile_app from 
(select user_id, 
(CASE WHEN user_id IN(select user_id from analytics_db.data_apps_simulated.identifies where context_device_type  = 'android' or context_device_type = 'iOS')
      THEN TRUE
      ELSE FALSE
      END) as has_mobile_app, row_number() over(partition by user_id order by timestamp desc) as rn from 
analytics_db.data_apps_simulated.identifies where timestamp >= '2021-05-01' and timestamp <= '2022-06-29'
and context_device_type is not null and context_device_type != '' and user_id is not null) where rn = 1),

cte_is_active_on_website as 
(select user_id, is_active_on_website from 
(select user_id, 
(CASE WHEN user_id IN(select user_id from analytics_db.data_apps_simulated.identifies where context_device_type like '%PC')
      THEN TRUE
      ELSE FALSE
      END)
as is_active_on_website, row_number() over(partition by user_id order by timestamp desc) as rn from 
analytics_db.data_apps_simulated.identifies where timestamp >= '2021-05-01' and timestamp <= '2022-06-29'
and context_device_type is not null and context_device_type != '' and user_id is not null) where rn = 1),

cte_device_type as 
(select user_id, device_type from 
(select user_id, context_device_type as device_type, row_number() over(partition by user_id order by timestamp desc) as rn from 
analytics_db.data_apps_simulated.identifies where timestamp >= '2021-05-01' and timestamp <= '2022-06-29'
and device_type is not null and device_type != '') where rn = 1)

select coalesce(a.user_id, b.user_id, c.user_id, d.user_id, e.user_id, f.user_id, g.user_id, h.user_id, i.user_id) 
as user_id, gender, age, country, state, email_domain, is_member, has_mobile_app, is_active_on_website, device_type
from (((((((cte_gender a full outer join cte_age b on a.user_id = b.user_id) 
full outer join cte_country c on c.user_id = coalesce(a.user_id, b.user_id))
full outer join cte_state d on d.user_id = coalesce(a.user_id, b.user_id, c.user_id))
full outer join cte_email_domain e on e.user_id = coalesce(a.user_id, b.user_id, c.user_id,d.user_id))
full outer join cte_is_member f on f.user_id = coalesce(a.user_id, b.user_id, c.user_id,d.user_id, e.user_id))
full outer join cte_has_mobile_app g on g.user_id = coalesce(a.user_id, b.user_id, c.user_id,d.user_id, e.user_id, f.user_id))
full outer join cte_is_active_on_website as h on h.user_id = coalesce(a.user_id, b.user_id, c.user_id,d.user_id, e.user_id, f.user_id, g.user_id))
full outer join cte_device_type as i on i.user_id = coalesce(a.user_id, b.user_id, c.user_id,d.user_id, e.user_id, f.user_id, g.user_id, h.user_id)
limit 500
/* limit added automatically by dbt cloud */
2022-07-04 06:01:19.742829 (Thread-1): 06:01:19  Opening a new connection, currently in state init
2022-07-04 06:01:20.103579 (Thread-515): handling poll request
2022-07-04 06:01:20.104103 (Thread-515): 06:01:20  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '08022227-1dd0-4d09-94f1-e256bf2507d1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb0f09e64f0>]}
2022-07-04 06:01:20.105123 (Thread-515): sending response (<Response 8940 bytes [200 OK]>) to 10.0.12.141
2022-07-04 06:01:21.482488 (Thread-516): handling poll request
2022-07-04 06:01:21.482914 (Thread-516): 06:01:21  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '08022227-1dd0-4d09-94f1-e256bf2507d1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb0f09e61f0>]}
2022-07-04 06:01:21.483405 (Thread-516): sending response (<Response 399 bytes [200 OK]>) to 10.0.12.141
2022-07-04 06:01:22.495123 (Thread-1): 06:01:22  SQL status: SUCCESS 6 in 2.75 seconds
2022-07-04 06:01:22.496747 (Thread-1): 06:01:22  finished collecting timing info
2022-07-04 06:01:22.496925 (Thread-1): 06:01:22  On rpc.ecommerce_data_model_dbt.request: Close
2022-07-04 06:01:22.851383 (Thread-517): handling poll request
2022-07-04 06:01:22.851860 (Thread-517): 06:01:22  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '08022227-1dd0-4d09-94f1-e256bf2507d1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb0f09e6070>]}
2022-07-04 06:01:22.852467 (Thread-517): sending response (<Response 1387 bytes [200 OK]>) to 10.0.12.141
2022-07-04 06:01:24.263187 (Thread-518): handling poll request
2022-07-04 06:01:24.263668 (Thread-518): 06:01:24  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '08022227-1dd0-4d09-94f1-e256bf2507d1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb0f02c0880>]}
2022-07-04 06:01:24.264905 (Thread-518): sending response (<Response 24863 bytes [200 OK]>) to 10.0.12.141
2022-07-04 06:38:46.174974 (Thread-519): handling status request
2022-07-04 06:38:46.177069 (Thread-519): 06:38:46  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '08022227-1dd0-4d09-94f1-e256bf2507d1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb0f0a1c0d0>]}
2022-07-04 06:38:46.177646 (Thread-519): sending response (<Response 2357 bytes [200 OK]>) to 10.0.12.141
2022-07-04 06:38:46.579850 (Thread-520): handling run_sql request
2022-07-04 06:38:46.580260 (Thread-520): 06:38:46  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '08022227-1dd0-4d09-94f1-e256bf2507d1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb0f0a1c070>]}
2022-07-04 06:38:48.897843 (Thread-520): sending response (<Response 139 bytes [200 OK]>) to 10.0.12.141
2022-07-04 06:38:48.940227 (MainThread): 06:38:48  Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '65d1ae1a-a7db-4454-88ec-d6a2f42aaf8e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4987043fa0>]}
2022-07-04 06:38:48.940775 (MainThread): 06:38:48  Found 16 models, 0 tests, 0 snapshots, 0 analyses, 179 macros, 0 operations, 0 seed files, 15 sources, 0 exposures, 0 metrics
2022-07-04 06:38:48.941352 (Thread-1): 06:38:48  Acquiring new snowflake connection "rpc.ecommerce_data_model_dbt.request"
2022-07-04 06:38:48.941481 (Thread-1): 06:38:48  Began compiling node rpc.ecommerce_data_model_dbt.request
2022-07-04 06:38:48.941571 (Thread-1): 06:38:48  Compiling rpc.ecommerce_data_model_dbt.request
2022-07-04 06:38:48.950018 (Thread-1): 06:38:48  finished collecting timing info
2022-07-04 06:38:48.950153 (Thread-1): 06:38:48  Began executing node rpc.ecommerce_data_model_dbt.request
2022-07-04 06:38:48.955498 (Thread-1): 06:38:48  Using snowflake connection "rpc.ecommerce_data_model_dbt.request"
2022-07-04 06:38:48.955597 (Thread-1): 06:38:48  On rpc.ecommerce_data_model_dbt.request: with cte_gender as 
(select user_id, gender from 
(select user_id, properties_gender as gender, row_number() over(partition by user_id order by timestamp desc) as rn from 
analytics_db.data_apps_simulated.identifies where timestamp >= '2021-05-01' and timestamp <= '2022-06-29'
and properties_gender is not null and properties_gender != '') where rn = 1),

cte_age as 
(select user_id, age from
(select user_id, 
(CASE WHEN dateadd(year, datediff (year, properties_birthday, getdate()), properties_birthday) > getdate()
      THEN datediff(year, properties_birthday, getdate()) - 1
      ELSE datediff(year, properties_birthday, getdate())
 END) as age, row_number() over(partition by user_id order by timestamp desc) as rn 
from analytics_db.data_apps_simulated.identifies where timestamp >= '2021-05-01' and timestamp <= '2022-06-29'
and properties_birthday is not null and properties_birthday!='') where rn = 1),

cte_country as 
(select user_id, country from 
(select user_id, properties_country as country, row_number() over(partition by user_id order by timestamp desc) as rn from 
analytics_db.data_apps_simulated.identifies where timestamp >= '2021-05-01' and timestamp <= '2022-06-29'
and properties_country is not null and properties_country != '') where rn = 1),

cte_state as 
(select user_id, state from 
(select user_id, properties_state as state, row_number() over(partition by user_id order by timestamp desc) as rn from 
analytics_db.data_apps_simulated.identifies where timestamp >= '2021-05-01' and timestamp <= '2022-06-29'
and properties_state is not null and properties_state != '') where rn = 1),

cte_email_domain as 
(select user_id, email_domain from 
(select user_id, substring(properties_email, charindex( '@', properties_email) + 1, len(properties_email)) as email_domain, row_number() over(partition by user_id order by timestamp desc) as rn from 
analytics_db.data_apps_simulated.identifies where timestamp >= '2021-05-01' and timestamp <= '2022-06-29'
and properties_email is not null and properties_email != '') where rn = 1),

cte_is_member as 
(select user_id, is_member from
(select user_id, 
(CASE WHEN properties_is_member = TRUE
      THEN TRUE
      ELSE FALSE
END) as is_member, row_number() over(partition by user_id order by timestamp desc) as rn from 
analytics_db.data_apps_simulated.identifies where timestamp >= '2021-05-01' and timestamp <= '2022-06-29'
and user_id is not null) where rn = 1),

cte_has_mobile_app as 
(select user_id, has_mobile_app from 
(select user_id, 
(CASE WHEN user_id IN(select user_id from analytics_db.data_apps_simulated.identifies where context_device_type  = 'android' or context_device_type = 'iOS')
      THEN TRUE
      ELSE FALSE
      END) as has_mobile_app, row_number() over(partition by user_id order by timestamp desc) as rn from 
analytics_db.data_apps_simulated.identifies where timestamp >= '2021-05-01' and timestamp <= '2022-06-29'
and context_device_type is not null and context_device_type != '' and user_id is not null) where rn = 1),

cte_is_active_on_website as 
(select user_id, is_active_on_website from 
(select user_id, 
(CASE WHEN user_id IN(select user_id from analytics_db.data_apps_simulated.identifies where context_device_type like '%PC')
      THEN TRUE
      ELSE FALSE
      END)
as is_active_on_website, row_number() over(partition by user_id order by timestamp desc) as rn from 
analytics_db.data_apps_simulated.identifies where timestamp >= '2021-05-01' and timestamp <= '2022-06-29'
and context_device_type is not null and context_device_type != '' and user_id is not null) where rn = 1),

cte_device_type as 
(select user_id, device_type from 
(select user_id, context_device_type as device_type, row_number() over(partition by user_id order by timestamp desc) as rn from 
analytics_db.data_apps_simulated.identifies where timestamp >= '2021-05-01' and timestamp <= '2022-06-29'
and device_type is not null and device_type != '') where rn = 1)

select coalesce(a.user_id, b.user_id, c.user_id, d.user_id, e.user_id, f.user_id, g.user_id, h.user_id, i.user_id) 
as user_id, gender, age, country, state, email_domain, is_member, has_mobile_app, is_active_on_website, device_type
from (((((((cte_gender a full outer join cte_age b on a.user_id = b.user_id) 
full outer join cte_country c on c.user_id = coalesce(a.user_id, b.user_id))
full outer join cte_state d on d.user_id = coalesce(a.user_id, b.user_id, c.user_id))
full outer join cte_email_domain e on e.user_id = coalesce(a.user_id, b.user_id, c.user_id,d.user_id))
full outer join cte_is_member f on f.user_id = coalesce(a.user_id, b.user_id, c.user_id,d.user_id, e.user_id))
full outer join cte_has_mobile_app g on g.user_id = coalesce(a.user_id, b.user_id, c.user_id,d.user_id, e.user_id, f.user_id))
full outer join cte_is_active_on_website as h on h.user_id = coalesce(a.user_id, b.user_id, c.user_id,d.user_id, e.user_id, f.user_id, g.user_id))
full outer join cte_device_type as i on i.user_id = coalesce(a.user_id, b.user_id, c.user_id,d.user_id, e.user_id, f.user_id, g.user_id, h.user_id)
limit 500
/* limit added automatically by dbt cloud */
2022-07-04 06:38:48.955682 (Thread-1): 06:38:48  Opening a new connection, currently in state init
2022-07-04 06:38:49.268827 (Thread-521): handling poll request
2022-07-04 06:38:49.269319 (Thread-521): 06:38:49  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '08022227-1dd0-4d09-94f1-e256bf2507d1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb0f081cd30>]}
2022-07-04 06:38:49.270318 (Thread-521): sending response (<Response 8939 bytes [200 OK]>) to 10.0.12.141
2022-07-04 06:38:50.661677 (Thread-522): handling poll request
2022-07-04 06:38:50.662122 (Thread-522): 06:38:50  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '08022227-1dd0-4d09-94f1-e256bf2507d1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb0f08642e0>]}
2022-07-04 06:38:50.662620 (Thread-522): sending response (<Response 399 bytes [200 OK]>) to 10.0.12.141
2022-07-04 06:38:50.874100 (Thread-1): 06:38:50  SQL status: SUCCESS 6 in 1.92 seconds
2022-07-04 06:38:50.875773 (Thread-1): 06:38:50  finished collecting timing info
2022-07-04 06:38:50.875960 (Thread-1): 06:38:50  On rpc.ecommerce_data_model_dbt.request: Close
2022-07-04 06:38:52.031194 (Thread-523): handling poll request
2022-07-04 06:38:52.031594 (Thread-523): 06:38:52  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '08022227-1dd0-4d09-94f1-e256bf2507d1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb0f0f87250>]}
2022-07-04 06:38:52.032643 (Thread-523): sending response (<Response 25851 bytes [200 OK]>) to 10.0.12.141
2022-07-06 05:35:28.816603 (MainThread): Running with dbt=1.0.8
2022-07-06 05:35:29.101259 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt_rpc.task.server.RPCServerTask'>, debug=None, defer=None, exclude=None, fail_fast=None, host='0.0.0.0', log_cache_events=False, log_format=None, models=None, partial_parse=True, port=8580, printer_width=None, profile='user', profiles_dir='/usr/src/develop/.dbt', project_dir=None, record_timing_info=None, rpc_method=None, send_anonymous_usage_stats=None, single_threaded=False, state=None, static_parser=None, target=None, threads=None, use_colors=None, use_experimental_parser=None, vars='{}', version_check=None, warn_error=None, which='rpc', write_json=None)
2022-07-06 05:35:29.105873 (MainThread): Tracking: tracking
2022-07-06 05:35:29.110904 (MainThread): 05:35:29  Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f68e4dce370>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f68abc2b1f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f68abc2bd90>]}
2022-07-06 05:35:29.111330 (MainThread): Serving RPC server at 0.0.0.0:8580, pid=22
2022-07-06 05:35:29.111934 (MainThread): Supported methods: ['build', 'cli_args', 'compile', 'compile_sql', 'deps', 'docs.generate', 'gc', 'get-manifest', 'kill', 'list', 'poll', 'ps', 'run', 'run-operation', 'run_sql', 'seed', 'snapshot', 'snapshot-freshness', 'source-freshness', 'status', 'test']
2022-07-06 05:35:29.117290 (MainThread): Send requests to http://localhost:8580/jsonrpc
2022-07-06 05:35:29.247369 (Thread-12): 05:35:29  Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
2022-07-06 05:35:29.247611 (Thread-12): 05:35:29  Partial parsing enabled, no changes found, skipping parsing
2022-07-06 05:35:29.248414 (Thread-12): 05:35:29  [WARNING]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.data-apps-ecommerce-template.data_model

2022-07-06 05:35:29.255111 (Thread-12): 05:35:29  Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '659b7287-63c6-4870-93d6-1d76e1b93300', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f68a9d6f8e0>]}
2022-07-06 05:35:32.704670 (Thread-13): handling status request
2022-07-06 05:35:32.705117 (Thread-13): 05:35:32  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '659b7287-63c6-4870-93d6-1d76e1b93300', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f68a9d60dc0>]}
2022-07-06 05:35:32.705747 (Thread-13): sending response (<Response 1699 bytes [200 OK]>) to 10.0.38.61
2022-07-06 05:35:32.748108 (Thread-14): handling ps request
2022-07-06 05:35:32.748519 (Thread-14): 05:35:32  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '659b7287-63c6-4870-93d6-1d76e1b93300', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f68a9d60bb0>]}
2022-07-06 05:35:32.749018 (Thread-14): sending response (<Response 106 bytes [200 OK]>) to 10.0.38.61
2022-07-06 05:35:32.903305 (Thread-15): handling status request
2022-07-06 05:35:32.903713 (Thread-15): 05:35:32  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '659b7287-63c6-4870-93d6-1d76e1b93300', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f68a9d60610>]}
2022-07-06 05:35:32.904194 (Thread-15): sending response (<Response 1699 bytes [200 OK]>) to 10.0.38.61
2022-07-06 05:35:32.934022 (Thread-16): handling status request
2022-07-06 05:35:32.934480 (Thread-16): 05:35:32  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '659b7287-63c6-4870-93d6-1d76e1b93300', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f68a9d60ee0>]}
2022-07-06 05:35:32.934964 (Thread-16): sending response (<Response 1699 bytes [200 OK]>) to 10.0.38.61
2022-07-06 05:35:35.169805 (Thread-17): handling status request
2022-07-06 05:35:35.170216 (Thread-17): 05:35:35  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '659b7287-63c6-4870-93d6-1d76e1b93300', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f68abc40dc0>]}
2022-07-06 05:35:35.170688 (Thread-17): sending response (<Response 1676 bytes [200 OK]>) to 10.0.38.61
2022-07-06 05:35:35.183569 (Thread-18): handling list request
2022-07-06 05:35:35.183932 (Thread-18): 05:35:35  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '659b7287-63c6-4870-93d6-1d76e1b93300', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f68e953c040>]}
2022-07-06 05:35:35.222109 (Thread-18): 05:35:35  Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '659b7287-63c6-4870-93d6-1d76e1b93300', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f68a9df43a0>]}
2022-07-06 05:35:35.222538 (Thread-18): 05:35:35  Found 16 models, 0 tests, 0 snapshots, 0 analyses, 179 macros, 0 operations, 0 seed files, 15 sources, 0 exposures, 0 metrics
2022-07-06 05:35:35.225913 (Thread-18): sending response (<Response 2623 bytes [200 OK]>) to 10.0.38.61
2022-07-06 05:35:35.419684 (Thread-19): handling status request
2022-07-06 05:35:35.420087 (Thread-19): 05:35:35  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '659b7287-63c6-4870-93d6-1d76e1b93300', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f68a9d7c7f0>]}
2022-07-06 05:35:35.420573 (Thread-19): sending response (<Response 1699 bytes [200 OK]>) to 10.0.38.61
2022-07-06 05:41:32.259094 (Thread-20): handling status request
2022-07-06 05:41:32.261666 (Thread-20): 05:41:32  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '659b7287-63c6-4870-93d6-1d76e1b93300', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f68a9d7c3a0>]}
2022-07-06 05:41:32.262179 (Thread-20): sending response (<Response 1676 bytes [200 OK]>) to 10.0.38.61
2022-07-06 05:41:32.310735 (Thread-21): handling list request
2022-07-06 05:41:32.311120 (Thread-21): 05:41:32  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '659b7287-63c6-4870-93d6-1d76e1b93300', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f68a9d7c8b0>]}
2022-07-06 05:41:32.342177 (Thread-21): 05:41:32  Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '659b7287-63c6-4870-93d6-1d76e1b93300', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f68abc40d30>]}
2022-07-06 05:41:32.342582 (Thread-21): 05:41:32  Found 16 models, 0 tests, 0 snapshots, 0 analyses, 179 macros, 0 operations, 0 seed files, 15 sources, 0 exposures, 0 metrics
2022-07-06 05:41:32.349220 (Thread-21): sending response (<Response 2127 bytes [200 OK]>) to 10.0.38.61
2022-07-06 05:41:37.721260 (Thread-22): 05:41:37  Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
2022-07-06 05:41:37.721867 (Thread-22): 05:41:37  Partial parsing: updated file: ecommerce_data_model_dbt://models/data_model/temp_folder/has_mobile_app.sql
2022-07-06 05:41:37.733353 (Thread-22): 05:41:37  1603: static parser failed on data_model/temp_folder/has_mobile_app.sql
2022-07-06 05:41:37.746729 (Thread-22): 05:41:37  1602: parser fallback to jinja rendering on data_model/temp_folder/has_mobile_app.sql
2022-07-06 05:41:37.797995 (Thread-22): 05:41:37  [WARNING]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.data-apps-ecommerce-template.data_model

2022-07-06 05:41:37.803948 (Thread-22): 05:41:37  Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '659b7287-63c6-4870-93d6-1d76e1b93300', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f68a81b82b0>]}
2022-07-06 05:41:38.301655 (Thread-23): handling status request
2022-07-06 05:41:38.302063 (Thread-23): 05:41:38  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '659b7287-63c6-4870-93d6-1d76e1b93300', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f68a8c1d850>]}
2022-07-06 05:41:38.302562 (Thread-23): sending response (<Response 2361 bytes [200 OK]>) to 10.0.38.61
2022-07-06 05:41:38.313875 (Thread-24): handling list request
2022-07-06 05:41:38.314142 (Thread-24): 05:41:38  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '659b7287-63c6-4870-93d6-1d76e1b93300', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f68a8c1df40>]}
2022-07-06 05:41:38.346286 (Thread-24): 05:41:38  Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '659b7287-63c6-4870-93d6-1d76e1b93300', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f68a8c1dbb0>]}
2022-07-06 05:41:38.346782 (Thread-24): 05:41:38  Found 16 models, 0 tests, 0 snapshots, 0 analyses, 179 macros, 0 operations, 0 seed files, 15 sources, 0 exposures, 0 metrics
2022-07-06 05:41:38.351168 (Thread-24): sending response (<Response 2071 bytes [200 OK]>) to 10.0.38.61
2022-07-06 05:41:38.499992 (Thread-25): handling status request
2022-07-06 05:41:38.500453 (Thread-25): 05:41:38  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '659b7287-63c6-4870-93d6-1d76e1b93300', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f68e2b01d90>]}
2022-07-06 05:41:38.500978 (Thread-25): sending response (<Response 2384 bytes [200 OK]>) to 10.0.38.61
2022-07-06 05:41:38.569010 (Thread-26): handling status request
2022-07-06 05:41:38.569417 (Thread-26): 05:41:38  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '659b7287-63c6-4870-93d6-1d76e1b93300', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f68a94d4940>]}
2022-07-06 05:41:38.569893 (Thread-26): sending response (<Response 2384 bytes [200 OK]>) to 10.0.38.61
2022-07-06 05:41:39.499169 (Thread-27): handling status request
2022-07-06 05:41:39.499606 (Thread-27): 05:41:39  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '659b7287-63c6-4870-93d6-1d76e1b93300', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f68a94d4610>]}
2022-07-06 05:41:39.500117 (Thread-27): sending response (<Response 2361 bytes [200 OK]>) to 10.0.38.61
2022-07-06 05:41:39.506447 (Thread-28): handling list request
2022-07-06 05:41:39.506773 (Thread-28): 05:41:39  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '659b7287-63c6-4870-93d6-1d76e1b93300', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f68a81b8c40>]}
2022-07-06 05:41:39.536484 (Thread-28): 05:41:39  Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '659b7287-63c6-4870-93d6-1d76e1b93300', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f68a94d4d00>]}
2022-07-06 05:41:39.536873 (Thread-28): 05:41:39  Found 16 models, 0 tests, 0 snapshots, 0 analyses, 179 macros, 0 operations, 0 seed files, 15 sources, 0 exposures, 0 metrics
2022-07-06 05:41:39.539957 (Thread-28): sending response (<Response 2151 bytes [200 OK]>) to 10.0.38.61
2022-07-06 05:41:40.335985 (Thread-29): handling status request
2022-07-06 05:41:40.336404 (Thread-29): 05:41:40  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '659b7287-63c6-4870-93d6-1d76e1b93300', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f68a8c87580>]}
2022-07-06 05:41:40.336903 (Thread-29): sending response (<Response 2361 bytes [200 OK]>) to 10.0.38.61
2022-07-06 05:41:40.345790 (Thread-30): handling list request
2022-07-06 05:41:40.346108 (Thread-30): 05:41:40  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '659b7287-63c6-4870-93d6-1d76e1b93300', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f68a8c87250>]}
2022-07-06 05:41:40.384348 (Thread-30): 05:41:40  Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '659b7287-63c6-4870-93d6-1d76e1b93300', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f68a8c87940>]}
2022-07-06 05:41:40.384728 (Thread-30): 05:41:40  Found 16 models, 0 tests, 0 snapshots, 0 analyses, 179 macros, 0 operations, 0 seed files, 15 sources, 0 exposures, 0 metrics
2022-07-06 05:41:40.387644 (Thread-30): sending response (<Response 2059 bytes [200 OK]>) to 10.0.38.61
2022-07-06 05:41:43.174720 (Thread-31): 05:41:43  Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
2022-07-06 05:41:43.175262 (Thread-31): 05:41:43  Partial parsing: updated file: ecommerce_data_model_dbt://models/data_model/temp_folder/device_type.sql
2022-07-06 05:41:43.179076 (Thread-31): 05:41:43  1699: static parser successfully parsed data_model/temp_folder/device_type.sql
2022-07-06 05:41:43.216150 (Thread-31): 05:41:43  [WARNING]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.data-apps-ecommerce-template.data_model

2022-07-06 05:41:43.221922 (Thread-31): 05:41:43  Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '659b7287-63c6-4870-93d6-1d76e1b93300', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f68a80e1d90>]}
2022-07-06 05:41:43.747118 (Thread-32): handling status request
2022-07-06 05:41:43.747521 (Thread-32): 05:41:43  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '659b7287-63c6-4870-93d6-1d76e1b93300', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f68a8132e20>]}
2022-07-06 05:41:43.748002 (Thread-32): sending response (<Response 2039 bytes [200 OK]>) to 10.0.38.61
2022-07-06 05:41:43.754493 (Thread-33): handling list request
2022-07-06 05:41:43.754808 (Thread-33): 05:41:43  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '659b7287-63c6-4870-93d6-1d76e1b93300', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f68a8132d00>]}
2022-07-06 05:41:43.788476 (Thread-33): 05:41:43  Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '659b7287-63c6-4870-93d6-1d76e1b93300', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f68a8132670>]}
2022-07-06 05:41:43.788849 (Thread-33): 05:41:43  Found 16 models, 0 tests, 0 snapshots, 0 analyses, 179 macros, 0 operations, 0 seed files, 15 sources, 0 exposures, 0 metrics
2022-07-06 05:41:43.790239 (Thread-33): 05:41:43  The selection criterion '+models/data_model/temp_folder/device_type.sql+' does not match any nodes
2022-07-06 05:41:43.790413 (Thread-33): 05:41:43  No nodes selected!
2022-07-06 05:41:43.791860 (Thread-33): sending response (<Response 1956 bytes [200 OK]>) to 10.0.38.61
2022-07-06 05:41:43.912779 (Thread-34): handling status request
2022-07-06 05:41:43.913205 (Thread-34): 05:41:43  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '659b7287-63c6-4870-93d6-1d76e1b93300', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f68a81e1190>]}
2022-07-06 05:41:43.935204 (Thread-34): sending response (<Response 2062 bytes [200 OK]>) to 10.0.38.61
2022-07-06 05:41:43.954907 (Thread-35): handling status request
2022-07-06 05:41:43.955286 (Thread-35): 05:41:43  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '659b7287-63c6-4870-93d6-1d76e1b93300', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f68a81c8190>]}
2022-07-06 05:41:43.955744 (Thread-35): sending response (<Response 2062 bytes [200 OK]>) to 10.0.38.61
2022-07-06 05:41:44.289975 (Thread-36): handling status request
2022-07-06 05:41:44.290387 (Thread-36): 05:41:44  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '659b7287-63c6-4870-93d6-1d76e1b93300', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f68a80e1a00>]}
2022-07-06 05:41:44.290862 (Thread-36): sending response (<Response 2039 bytes [200 OK]>) to 10.0.38.61
2022-07-06 05:41:44.320121 (Thread-37): handling list request
2022-07-06 05:41:44.320517 (Thread-37): 05:41:44  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '659b7287-63c6-4870-93d6-1d76e1b93300', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f68a80e1df0>]}
2022-07-06 05:41:44.350816 (Thread-37): 05:41:44  Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '659b7287-63c6-4870-93d6-1d76e1b93300', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f68a81e1dc0>]}
2022-07-06 05:41:44.351225 (Thread-37): 05:41:44  Found 16 models, 0 tests, 0 snapshots, 0 analyses, 179 macros, 0 operations, 0 seed files, 15 sources, 0 exposures, 0 metrics
2022-07-06 05:41:44.354222 (Thread-37): sending response (<Response 2039 bytes [200 OK]>) to 10.0.38.61
2022-07-06 05:41:45.695117 (Thread-38): handling status request
2022-07-06 05:41:45.695523 (Thread-38): 05:41:45  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '659b7287-63c6-4870-93d6-1d76e1b93300', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f68a80bb2e0>]}
2022-07-06 05:41:45.695997 (Thread-38): sending response (<Response 2039 bytes [200 OK]>) to 10.0.38.61
2022-07-06 05:41:45.702498 (Thread-39): handling list request
2022-07-06 05:41:45.702819 (Thread-39): 05:41:45  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '659b7287-63c6-4870-93d6-1d76e1b93300', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f68a80bbb50>]}
2022-07-06 05:41:45.733916 (Thread-39): 05:41:45  Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '659b7287-63c6-4870-93d6-1d76e1b93300', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f68a80b7eb0>]}
2022-07-06 05:41:45.734266 (Thread-39): 05:41:45  Found 16 models, 0 tests, 0 snapshots, 0 analyses, 179 macros, 0 operations, 0 seed files, 15 sources, 0 exposures, 0 metrics
2022-07-06 05:41:45.737046 (Thread-39): sending response (<Response 2063 bytes [200 OK]>) to 10.0.38.61
2022-07-06 05:41:47.063253 (Thread-40): handling status request
2022-07-06 05:41:47.063663 (Thread-40): 05:41:47  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '659b7287-63c6-4870-93d6-1d76e1b93300', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f68a80b7610>]}
2022-07-06 05:41:47.064146 (Thread-40): sending response (<Response 2039 bytes [200 OK]>) to 10.0.38.61
2022-07-06 05:41:47.070176 (Thread-41): handling list request
2022-07-06 05:41:47.070499 (Thread-41): 05:41:47  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '659b7287-63c6-4870-93d6-1d76e1b93300', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f68a80b7250>]}
2022-07-06 05:41:47.100443 (Thread-41): 05:41:47  Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '659b7287-63c6-4870-93d6-1d76e1b93300', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f68a80b7490>]}
2022-07-06 05:41:47.100813 (Thread-41): 05:41:47  Found 16 models, 0 tests, 0 snapshots, 0 analyses, 179 macros, 0 operations, 0 seed files, 15 sources, 0 exposures, 0 metrics
2022-07-06 05:41:47.102217 (Thread-41): 05:41:47  The selection criterion '+models/data_model/temp_folder/preferred_login_device.sql+' does not match any nodes
2022-07-06 05:41:47.102379 (Thread-41): 05:41:47  No nodes selected!
2022-07-06 05:41:47.103783 (Thread-41): sending response (<Response 1967 bytes [200 OK]>) to 10.0.38.61
2022-07-06 05:41:47.938063 (Thread-42): handling status request
2022-07-06 05:41:47.938470 (Thread-42): 05:41:47  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '659b7287-63c6-4870-93d6-1d76e1b93300', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f68a80b6c10>]}
2022-07-06 05:41:47.938955 (Thread-42): sending response (<Response 2039 bytes [200 OK]>) to 10.0.38.61
2022-07-06 05:41:47.978157 (Thread-43): handling list request
2022-07-06 05:41:47.978552 (Thread-43): 05:41:47  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '659b7287-63c6-4870-93d6-1d76e1b93300', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f68a8171490>]}
2022-07-06 05:41:48.013327 (Thread-43): 05:41:48  Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '659b7287-63c6-4870-93d6-1d76e1b93300', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f68a80b6400>]}
2022-07-06 05:41:48.013754 (Thread-43): 05:41:48  Found 16 models, 0 tests, 0 snapshots, 0 analyses, 179 macros, 0 operations, 0 seed files, 15 sources, 0 exposures, 0 metrics
2022-07-06 05:41:48.016803 (Thread-43): sending response (<Response 2051 bytes [200 OK]>) to 10.0.38.61
2022-07-06 05:41:48.870892 (Thread-44): handling status request
2022-07-06 05:41:48.871301 (Thread-44): 05:41:48  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '659b7287-63c6-4870-93d6-1d76e1b93300', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f68a814fd30>]}
2022-07-06 05:41:48.871783 (Thread-44): sending response (<Response 2039 bytes [200 OK]>) to 10.0.38.61
2022-07-06 05:41:48.878029 (Thread-45): handling list request
2022-07-06 05:41:48.878366 (Thread-45): 05:41:48  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '659b7287-63c6-4870-93d6-1d76e1b93300', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f68a814faf0>]}
2022-07-06 05:41:48.909395 (Thread-45): 05:41:48  Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '659b7287-63c6-4870-93d6-1d76e1b93300', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f68a80b60d0>]}
2022-07-06 05:41:48.909784 (Thread-45): 05:41:48  Found 16 models, 0 tests, 0 snapshots, 0 analyses, 179 macros, 0 operations, 0 seed files, 15 sources, 0 exposures, 0 metrics
2022-07-06 05:41:48.912578 (Thread-45): sending response (<Response 2623 bytes [200 OK]>) to 10.0.38.61
2022-07-06 05:41:49.796502 (Thread-46): handling status request
2022-07-06 05:41:49.796924 (Thread-46): 05:41:49  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '659b7287-63c6-4870-93d6-1d76e1b93300', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f68a8084490>]}
2022-07-06 05:41:49.797474 (Thread-46): sending response (<Response 2039 bytes [200 OK]>) to 10.0.38.61
2022-07-06 05:41:49.828623 (Thread-47): handling list request
2022-07-06 05:41:49.829039 (Thread-47): 05:41:49  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '659b7287-63c6-4870-93d6-1d76e1b93300', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f68a8084550>]}
2022-07-06 05:41:49.858489 (Thread-47): 05:41:49  Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '659b7287-63c6-4870-93d6-1d76e1b93300', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f68a80e2c70>]}
2022-07-06 05:41:49.858866 (Thread-47): 05:41:49  Found 16 models, 0 tests, 0 snapshots, 0 analyses, 179 macros, 0 operations, 0 seed files, 15 sources, 0 exposures, 0 metrics
2022-07-06 05:41:49.861711 (Thread-47): sending response (<Response 2151 bytes [200 OK]>) to 10.0.38.61
2022-07-06 05:42:37.756069 (Thread-48): 05:42:37  Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
2022-07-06 05:42:37.757870 (Thread-48): 05:42:37  Partial parsing enabled, no changes found, skipping parsing
2022-07-06 05:42:37.758565 (Thread-48): 05:42:37  [WARNING]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.data-apps-ecommerce-template.data_model

2022-07-06 05:42:37.764350 (Thread-48): 05:42:37  Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '659b7287-63c6-4870-93d6-1d76e1b93300', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f688038bc40>]}
2022-07-06 05:42:38.384295 (Thread-49): handling status request
2022-07-06 05:42:38.384710 (Thread-49): 05:42:38  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '659b7287-63c6-4870-93d6-1d76e1b93300', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f68a805a7f0>]}
2022-07-06 05:42:38.385242 (Thread-49): sending response (<Response 1676 bytes [200 OK]>) to 10.0.38.61
2022-07-06 05:42:38.402681 (Thread-50): handling list request
2022-07-06 05:42:38.403032 (Thread-50): 05:42:38  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '659b7287-63c6-4870-93d6-1d76e1b93300', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f68a805a5b0>]}
2022-07-06 05:42:38.439517 (Thread-50): 05:42:38  Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '659b7287-63c6-4870-93d6-1d76e1b93300', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f68a80e2fd0>]}
2022-07-06 05:42:38.439918 (Thread-50): 05:42:38  Found 16 models, 0 tests, 0 snapshots, 0 analyses, 179 macros, 0 operations, 0 seed files, 15 sources, 0 exposures, 0 metrics
2022-07-06 05:42:38.441363 (Thread-50): 05:42:38  The selection criterion '+macros/get_domain_from_email+' does not match any nodes
2022-07-06 05:42:38.441542 (Thread-50): 05:42:38  No nodes selected!
2022-07-06 05:42:38.442962 (Thread-50): sending response (<Response 1939 bytes [200 OK]>) to 10.0.38.61
2022-07-06 05:42:38.570404 (Thread-51): handling status request
2022-07-06 05:42:38.570803 (Thread-51): 05:42:38  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '659b7287-63c6-4870-93d6-1d76e1b93300', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f68a809df40>]}
2022-07-06 05:42:38.571268 (Thread-51): sending response (<Response 1699 bytes [200 OK]>) to 10.0.38.61
2022-07-06 05:42:38.639075 (Thread-52): handling status request
2022-07-06 05:42:38.639481 (Thread-52): 05:42:38  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '659b7287-63c6-4870-93d6-1d76e1b93300', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f688038bc70>]}
2022-07-06 05:42:38.639957 (Thread-52): sending response (<Response 1699 bytes [200 OK]>) to 10.0.38.61
2022-07-06 05:42:42.759265 (Thread-53): 05:42:42  Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
2022-07-06 05:42:42.759503 (Thread-53): 05:42:42  Partial parsing enabled, no changes found, skipping parsing
2022-07-06 05:42:42.760200 (Thread-53): 05:42:42  [WARNING]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.data-apps-ecommerce-template.data_model

2022-07-06 05:42:42.765964 (Thread-53): 05:42:42  Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '659b7287-63c6-4870-93d6-1d76e1b93300', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f68802c14f0>]}
2022-07-06 05:42:43.516723 (Thread-54): handling status request
2022-07-06 05:42:43.517255 (Thread-54): 05:42:43  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '659b7287-63c6-4870-93d6-1d76e1b93300', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f68a81dc910>]}
2022-07-06 05:42:43.517769 (Thread-54): sending response (<Response 1699 bytes [200 OK]>) to 10.0.38.61
2022-07-06 05:42:43.529678 (Thread-55): handling status request
2022-07-06 05:42:43.530025 (Thread-55): 05:42:43  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '659b7287-63c6-4870-93d6-1d76e1b93300', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f68802be970>]}
2022-07-06 05:42:43.530486 (Thread-55): sending response (<Response 1699 bytes [200 OK]>) to 10.0.38.61
2022-07-06 05:43:55.695596 (Thread-56): 05:43:55  Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
2022-07-06 05:43:55.697128 (Thread-56): 05:43:55  Partial parsing: updated file: ecommerce_data_model_dbt://models/data_model/temp_folder/email_domain.sql
2022-07-06 05:43:55.701150 (Thread-56): 05:43:55  1603: static parser failed on data_model/temp_folder/email_domain.sql
2022-07-06 05:43:55.705342 (Thread-56): 05:43:55  1602: parser fallback to jinja rendering on data_model/temp_folder/email_domain.sql
2022-07-06 05:43:55.743356 (Thread-56): 05:43:55  [WARNING]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.data-apps-ecommerce-template.data_model

2022-07-06 05:43:55.749772 (Thread-56): 05:43:55  Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '659b7287-63c6-4870-93d6-1d76e1b93300', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f68801fda00>]}
2022-07-06 05:43:56.228641 (Thread-57): handling status request
2022-07-06 05:43:56.229117 (Thread-57): 05:43:56  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '659b7287-63c6-4870-93d6-1d76e1b93300', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6880399040>]}
2022-07-06 05:43:56.253485 (Thread-57): sending response (<Response 2355 bytes [200 OK]>) to 10.0.38.61
2022-07-06 05:43:56.293945 (Thread-58): handling list request
2022-07-06 05:43:56.294360 (Thread-58): 05:43:56  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '659b7287-63c6-4870-93d6-1d76e1b93300', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6880399940>]}
2022-07-06 05:43:56.454611 (Thread-59): handling status request
2022-07-06 05:43:56.455447 (Thread-59): 05:43:56  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '659b7287-63c6-4870-93d6-1d76e1b93300', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f68b1edfbb0>]}
2022-07-06 05:43:56.455954 (Thread-59): sending response (<Response 2378 bytes [200 OK]>) to 10.0.38.61
2022-07-06 05:43:56.470281 (Thread-58): 05:43:56  Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '659b7287-63c6-4870-93d6-1d76e1b93300', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f688039afd0>]}
2022-07-06 05:43:56.470662 (Thread-58): 05:43:56  Found 16 models, 0 tests, 0 snapshots, 0 analyses, 179 macros, 0 operations, 0 seed files, 15 sources, 0 exposures, 0 metrics
2022-07-06 05:43:56.474025 (Thread-58): sending response (<Response 3384 bytes [200 OK]>) to 10.0.38.61
2022-07-06 05:43:56.512192 (Thread-60): handling status request
2022-07-06 05:43:56.512631 (Thread-60): 05:43:56  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '659b7287-63c6-4870-93d6-1d76e1b93300', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f68b1ecfe20>]}
2022-07-06 05:43:56.513149 (Thread-60): sending response (<Response 2378 bytes [200 OK]>) to 10.0.38.61
2022-07-06 05:43:57.791599 (Thread-61): handling status request
2022-07-06 05:43:57.792022 (Thread-61): 05:43:57  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '659b7287-63c6-4870-93d6-1d76e1b93300', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f68abc9e760>]}
2022-07-06 05:43:57.792532 (Thread-61): sending response (<Response 2378 bytes [200 OK]>) to 10.0.38.61
2022-07-06 05:43:58.154398 (Thread-62): handling run_sql request
2022-07-06 05:43:58.154807 (Thread-62): 05:43:58  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '659b7287-63c6-4870-93d6-1d76e1b93300', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f68abc9e700>]}
2022-07-06 05:44:00.577517 (Thread-62): sending response (<Response 139 bytes [200 OK]>) to 10.0.38.61
2022-07-06 05:44:00.602582 (MainThread): 05:44:00  Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '6ba9387b-e631-4f24-94da-2fdcf272f96f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f77c959d790>]}
2022-07-06 05:44:00.603145 (MainThread): 05:44:00  Found 16 models, 0 tests, 0 snapshots, 0 analyses, 179 macros, 0 operations, 0 seed files, 15 sources, 0 exposures, 0 metrics
2022-07-06 05:44:00.603749 (Thread-1): 05:44:00  Acquiring new snowflake connection "rpc.ecommerce_data_model_dbt.request"
2022-07-06 05:44:00.603878 (Thread-1): 05:44:00  Began compiling node rpc.ecommerce_data_model_dbt.request
2022-07-06 05:44:00.603972 (Thread-1): 05:44:00  Compiling rpc.ecommerce_data_model_dbt.request
2022-07-06 05:44:00.607166 (Thread-1): 05:44:00  finished collecting timing info
2022-07-06 05:44:00.607326 (Thread-1): Got an exception: Compilation Error in rpc request (from remote system)
  'get_domain_from_email' is undefined. This can happen when calling a macro that does not exist. Check for typos and/or install package dependencies with "dbt deps".
Traceback (most recent call last):
  File "/usr/local/lib/python3.8/dist-packages/dbt/clients/jinja.py", line 516, in catch_jinja
    yield
  File "/usr/local/lib/python3.8/dist-packages/dbt/clients/jinja.py", line 548, in render_template
    return template.render(ctx)
  File "/usr/local/lib/python3.8/dist-packages/jinja2/environment.py", line 1090, in render
    self.environment.handle_exception()
  File "/usr/local/lib/python3.8/dist-packages/jinja2/environment.py", line 832, in handle_exception
    reraise(*rewrite_traceback_stack(source=source))
  File "/usr/local/lib/python3.8/dist-packages/jinja2/_compat.py", line 28, in reraise
    raise value.with_traceback(tb)
  File "<template>", line 2, in top-level template code
  File "/usr/local/lib/python3.8/dist-packages/jinja2/sandbox.py", line 460, in call
    if not __self.is_safe_callable(__obj):
  File "/usr/local/lib/python3.8/dist-packages/jinja2/sandbox.py", line 360, in is_safe_callable
    getattr(obj, "unsafe_callable", False) or getattr(obj, "alters_data", False)
jinja2.exceptions.UndefinedError: 'get_domain_from_email' is undefined

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/usr/local/lib/python3.8/dist-packages/dbt/task/base.py", line 361, in safe_run
    result = self.compile_and_execute(manifest, ctx)
  File "/usr/local/lib/python3.8/dist-packages/dbt/task/base.py", line 301, in compile_and_execute
    ctx.node = self.compile(manifest)
  File "/usr/local/lib/python3.8/dist-packages/dbt_rpc/rpc/node_runners.py", line 45, in compile
    return compiler.compile_node(self.node, manifest, {}, write=False)
  File "/usr/local/lib/python3.8/dist-packages/dbt/compilation.py", line 550, in compile_node
    node = self._compile_node(node, manifest, extra_context)
  File "/usr/local/lib/python3.8/dist-packages/dbt/compilation.py", line 388, in _compile_node
    compiled_node.compiled_sql = jinja.get_rendered(
  File "/usr/local/lib/python3.8/dist-packages/dbt/clients/jinja.py", line 597, in get_rendered
    return render_template(template, ctx, node)
  File "/usr/local/lib/python3.8/dist-packages/dbt/clients/jinja.py", line 548, in render_template
    return template.render(ctx)
  File "/usr/lib/python3.8/contextlib.py", line 131, in __exit__
    self.gen.throw(type, value, traceback)
  File "/usr/local/lib/python3.8/dist-packages/dbt/clients/jinja.py", line 521, in catch_jinja
    raise UndefinedMacroException(str(e), node) from e
dbt.exceptions.UndefinedMacroException: Compilation Error in rpc request (from remote system)
  'get_domain_from_email' is undefined. This can happen when calling a macro that does not exist. Check for typos and/or install package dependencies with "dbt deps".
2022-07-06 05:44:00.608690 (Thread-1): Got exception RPCException(10004, Compilation Error, {'type': 'UndefinedMacroException', 'message': 'Compilation Error in rpc request (from remote system)\n  \'get_domain_from_email\' is undefined. This can happen when calling a macro that does not exist. Check for typos and/or install package dependencies with "dbt deps".', 'raw_sql': "select user_id, email_domain from \r\n(select user_id,{{get_domain_from_email('email')}} as email_domain, row_number() over(partition by user_id order by timestamp desc) as rn from \r\n{{ source('ecommerce', 'identifies') }} where timestamp >= '{{ var('start_date') }}' and timestamp <= '{{ var('end_date') }}'\r\nand properties_email is not null and properties_email != '') where rn = 1\nlimit 500\n/* limit added automatically by dbt cloud */", 'compiled_sql': None, 'tags': None}, None)
Traceback (most recent call last):
  File "/usr/local/lib/python3.8/dist-packages/dbt_rpc/task/sql_commands.py", line 147, in _in_thread
    self.node_results.append(runner.safe_run(self.manifest))
  File "/usr/local/lib/python3.8/dist-packages/dbt/task/base.py", line 377, in safe_run
    result = self.error_result(ctx.node, error, started, [])
  File "/usr/local/lib/python3.8/dist-packages/dbt_rpc/rpc/node_runners.py", line 56, in error_result
    raise error
dbt_rpc.rpc.error.RPCException: RPCException(10004, Compilation Error, {'type': 'UndefinedMacroException', 'message': 'Compilation Error in rpc request (from remote system)\n  \'get_domain_from_email\' is undefined. This can happen when calling a macro that does not exist. Check for typos and/or install package dependencies with "dbt deps".', 'raw_sql': "select user_id, email_domain from \r\n(select user_id,{{get_domain_from_email('email')}} as email_domain, row_number() over(partition by user_id order by timestamp desc) as rn from \r\n{{ source('ecommerce', 'identifies') }} where timestamp >= '{{ var('start_date') }}' and timestamp <= '{{ var('end_date') }}'\r\nand properties_email is not null and properties_email != '') where rn = 1\nlimit 500\n/* limit added automatically by dbt cloud */", 'compiled_sql': None, 'tags': None}, None)
2022-07-06 05:44:00.941817 (Thread-63): handling poll request
2022-07-06 05:44:00.942309 (Thread-63): 05:44:00  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '659b7287-63c6-4870-93d6-1d76e1b93300', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f68b1edffd0>]}
2022-07-06 05:44:00.943104 (Thread-63): sending response (<Response 8883 bytes [200 OK]>) to 10.0.38.61
2022-07-06 05:44:08.968875 (Thread-64): handling status request
2022-07-06 05:44:08.969315 (Thread-64): 05:44:08  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '659b7287-63c6-4870-93d6-1d76e1b93300', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f68abcac3a0>]}
2022-07-06 05:44:08.969847 (Thread-64): sending response (<Response 2378 bytes [200 OK]>) to 10.0.38.61
2022-07-06 05:44:09.333419 (Thread-65): handling compile_sql request
2022-07-06 05:44:09.333876 (Thread-65): 05:44:09  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '659b7287-63c6-4870-93d6-1d76e1b93300', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f68b1ecfa00>]}
2022-07-06 05:44:11.728645 (Thread-65): sending response (<Response 139 bytes [200 OK]>) to 10.0.38.61
2022-07-06 05:44:11.755721 (MainThread): 05:44:11  Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '184ec38c-9105-4e42-931c-9de3d46dd739', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2a72d1d700>]}
2022-07-06 05:44:11.756326 (MainThread): 05:44:11  Found 16 models, 0 tests, 0 snapshots, 0 analyses, 179 macros, 0 operations, 0 seed files, 15 sources, 0 exposures, 0 metrics
2022-07-06 05:44:11.756980 (Thread-1): 05:44:11  Acquiring new snowflake connection "rpc.ecommerce_data_model_dbt.request"
2022-07-06 05:44:11.757118 (Thread-1): 05:44:11  Began compiling node rpc.ecommerce_data_model_dbt.request
2022-07-06 05:44:11.757215 (Thread-1): 05:44:11  Compiling rpc.ecommerce_data_model_dbt.request
2022-07-06 05:44:11.760359 (Thread-1): 05:44:11  finished collecting timing info
2022-07-06 05:44:11.760510 (Thread-1): Got an exception: Compilation Error in rpc request (from remote system)
  'get_domain_from_email' is undefined. This can happen when calling a macro that does not exist. Check for typos and/or install package dependencies with "dbt deps".
Traceback (most recent call last):
  File "/usr/local/lib/python3.8/dist-packages/dbt/clients/jinja.py", line 516, in catch_jinja
    yield
  File "/usr/local/lib/python3.8/dist-packages/dbt/clients/jinja.py", line 548, in render_template
    return template.render(ctx)
  File "/usr/local/lib/python3.8/dist-packages/jinja2/environment.py", line 1090, in render
    self.environment.handle_exception()
  File "/usr/local/lib/python3.8/dist-packages/jinja2/environment.py", line 832, in handle_exception
    reraise(*rewrite_traceback_stack(source=source))
  File "/usr/local/lib/python3.8/dist-packages/jinja2/_compat.py", line 28, in reraise
    raise value.with_traceback(tb)
  File "<template>", line 2, in top-level template code
  File "/usr/local/lib/python3.8/dist-packages/jinja2/sandbox.py", line 460, in call
    if not __self.is_safe_callable(__obj):
  File "/usr/local/lib/python3.8/dist-packages/jinja2/sandbox.py", line 360, in is_safe_callable
    getattr(obj, "unsafe_callable", False) or getattr(obj, "alters_data", False)
jinja2.exceptions.UndefinedError: 'get_domain_from_email' is undefined

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/usr/local/lib/python3.8/dist-packages/dbt/task/base.py", line 361, in safe_run
    result = self.compile_and_execute(manifest, ctx)
  File "/usr/local/lib/python3.8/dist-packages/dbt/task/base.py", line 301, in compile_and_execute
    ctx.node = self.compile(manifest)
  File "/usr/local/lib/python3.8/dist-packages/dbt_rpc/rpc/node_runners.py", line 45, in compile
    return compiler.compile_node(self.node, manifest, {}, write=False)
  File "/usr/local/lib/python3.8/dist-packages/dbt/compilation.py", line 550, in compile_node
    node = self._compile_node(node, manifest, extra_context)
  File "/usr/local/lib/python3.8/dist-packages/dbt/compilation.py", line 388, in _compile_node
    compiled_node.compiled_sql = jinja.get_rendered(
  File "/usr/local/lib/python3.8/dist-packages/dbt/clients/jinja.py", line 597, in get_rendered
    return render_template(template, ctx, node)
  File "/usr/local/lib/python3.8/dist-packages/dbt/clients/jinja.py", line 548, in render_template
    return template.render(ctx)
  File "/usr/lib/python3.8/contextlib.py", line 131, in __exit__
    self.gen.throw(type, value, traceback)
  File "/usr/local/lib/python3.8/dist-packages/dbt/clients/jinja.py", line 521, in catch_jinja
    raise UndefinedMacroException(str(e), node) from e
dbt.exceptions.UndefinedMacroException: Compilation Error in rpc request (from remote system)
  'get_domain_from_email' is undefined. This can happen when calling a macro that does not exist. Check for typos and/or install package dependencies with "dbt deps".
2022-07-06 05:44:11.761886 (Thread-1): Got exception RPCException(10004, Compilation Error, {'type': 'UndefinedMacroException', 'message': 'Compilation Error in rpc request (from remote system)\n  \'get_domain_from_email\' is undefined. This can happen when calling a macro that does not exist. Check for typos and/or install package dependencies with "dbt deps".', 'raw_sql': "select user_id, email_domain from \r\n(select user_id,{{get_domain_from_email('email')}} as email_domain, row_number() over(partition by user_id order by timestamp desc) as rn from \r\n{{ source('ecommerce', 'identifies') }} where timestamp >= '{{ var('start_date') }}' and timestamp <= '{{ var('end_date') }}'\r\nand properties_email is not null and properties_email != '') where rn = 1\nlimit 500\n/* limit added automatically by dbt cloud */", 'compiled_sql': None, 'tags': None}, None)
Traceback (most recent call last):
  File "/usr/local/lib/python3.8/dist-packages/dbt_rpc/task/sql_commands.py", line 147, in _in_thread
    self.node_results.append(runner.safe_run(self.manifest))
  File "/usr/local/lib/python3.8/dist-packages/dbt/task/base.py", line 377, in safe_run
    result = self.error_result(ctx.node, error, started, [])
  File "/usr/local/lib/python3.8/dist-packages/dbt_rpc/rpc/node_runners.py", line 56, in error_result
    raise error
dbt_rpc.rpc.error.RPCException: RPCException(10004, Compilation Error, {'type': 'UndefinedMacroException', 'message': 'Compilation Error in rpc request (from remote system)\n  \'get_domain_from_email\' is undefined. This can happen when calling a macro that does not exist. Check for typos and/or install package dependencies with "dbt deps".', 'raw_sql': "select user_id, email_domain from \r\n(select user_id,{{get_domain_from_email('email')}} as email_domain, row_number() over(partition by user_id order by timestamp desc) as rn from \r\n{{ source('ecommerce', 'identifies') }} where timestamp >= '{{ var('start_date') }}' and timestamp <= '{{ var('end_date') }}'\r\nand properties_email is not null and properties_email != '') where rn = 1\nlimit 500\n/* limit added automatically by dbt cloud */", 'compiled_sql': None, 'tags': None}, None)
2022-07-06 05:44:12.088144 (Thread-66): handling poll request
2022-07-06 05:44:12.088631 (Thread-66): 05:44:12  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '659b7287-63c6-4870-93d6-1d76e1b93300', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f68abca74f0>]}
2022-07-06 05:44:12.089477 (Thread-66): sending response (<Response 8887 bytes [200 OK]>) to 10.0.38.61
2022-07-06 05:44:47.550113 (Thread-67): handling status request
2022-07-06 05:44:47.550533 (Thread-67): 05:44:47  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '659b7287-63c6-4870-93d6-1d76e1b93300', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f68abca7fa0>]}
2022-07-06 05:44:47.551106 (Thread-67): sending response (<Response 2378 bytes [200 OK]>) to 10.0.38.61
2022-07-06 05:44:47.920382 (Thread-68): handling compile_sql request
2022-07-06 05:44:47.920782 (Thread-68): 05:44:47  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '659b7287-63c6-4870-93d6-1d76e1b93300', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f68abca7eb0>]}
2022-07-06 05:44:50.314587 (Thread-68): sending response (<Response 139 bytes [200 OK]>) to 10.0.38.61
2022-07-06 05:44:50.341313 (MainThread): 05:44:50  Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'cf899553-fb38-4e6b-bd9a-fa5fb93c048a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f24f1bdd730>]}
2022-07-06 05:44:50.341919 (MainThread): 05:44:50  Found 16 models, 0 tests, 0 snapshots, 0 analyses, 179 macros, 0 operations, 0 seed files, 15 sources, 0 exposures, 0 metrics
2022-07-06 05:44:50.342542 (Thread-1): 05:44:50  Acquiring new snowflake connection "rpc.ecommerce_data_model_dbt.request"
2022-07-06 05:44:50.342679 (Thread-1): 05:44:50  Began compiling node rpc.ecommerce_data_model_dbt.request
2022-07-06 05:44:50.342777 (Thread-1): 05:44:50  Compiling rpc.ecommerce_data_model_dbt.request
2022-07-06 05:44:50.346107 (Thread-1): 05:44:50  finished collecting timing info
2022-07-06 05:44:50.346266 (Thread-1): Got an exception: Compilation Error in rpc request (from remote system)
  'get_domain_from_email' is undefined. This can happen when calling a macro that does not exist. Check for typos and/or install package dependencies with "dbt deps".
Traceback (most recent call last):
  File "/usr/local/lib/python3.8/dist-packages/dbt/clients/jinja.py", line 516, in catch_jinja
    yield
  File "/usr/local/lib/python3.8/dist-packages/dbt/clients/jinja.py", line 548, in render_template
    return template.render(ctx)
  File "/usr/local/lib/python3.8/dist-packages/jinja2/environment.py", line 1090, in render
    self.environment.handle_exception()
  File "/usr/local/lib/python3.8/dist-packages/jinja2/environment.py", line 832, in handle_exception
    reraise(*rewrite_traceback_stack(source=source))
  File "/usr/local/lib/python3.8/dist-packages/jinja2/_compat.py", line 28, in reraise
    raise value.with_traceback(tb)
  File "<template>", line 2, in top-level template code
  File "/usr/local/lib/python3.8/dist-packages/jinja2/sandbox.py", line 460, in call
    if not __self.is_safe_callable(__obj):
  File "/usr/local/lib/python3.8/dist-packages/jinja2/sandbox.py", line 360, in is_safe_callable
    getattr(obj, "unsafe_callable", False) or getattr(obj, "alters_data", False)
jinja2.exceptions.UndefinedError: 'get_domain_from_email' is undefined

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/usr/local/lib/python3.8/dist-packages/dbt/task/base.py", line 361, in safe_run
    result = self.compile_and_execute(manifest, ctx)
  File "/usr/local/lib/python3.8/dist-packages/dbt/task/base.py", line 301, in compile_and_execute
    ctx.node = self.compile(manifest)
  File "/usr/local/lib/python3.8/dist-packages/dbt_rpc/rpc/node_runners.py", line 45, in compile
    return compiler.compile_node(self.node, manifest, {}, write=False)
  File "/usr/local/lib/python3.8/dist-packages/dbt/compilation.py", line 550, in compile_node
    node = self._compile_node(node, manifest, extra_context)
  File "/usr/local/lib/python3.8/dist-packages/dbt/compilation.py", line 388, in _compile_node
    compiled_node.compiled_sql = jinja.get_rendered(
  File "/usr/local/lib/python3.8/dist-packages/dbt/clients/jinja.py", line 597, in get_rendered
    return render_template(template, ctx, node)
  File "/usr/local/lib/python3.8/dist-packages/dbt/clients/jinja.py", line 548, in render_template
    return template.render(ctx)
  File "/usr/lib/python3.8/contextlib.py", line 131, in __exit__
    self.gen.throw(type, value, traceback)
  File "/usr/local/lib/python3.8/dist-packages/dbt/clients/jinja.py", line 521, in catch_jinja
    raise UndefinedMacroException(str(e), node) from e
dbt.exceptions.UndefinedMacroException: Compilation Error in rpc request (from remote system)
  'get_domain_from_email' is undefined. This can happen when calling a macro that does not exist. Check for typos and/or install package dependencies with "dbt deps".
2022-07-06 05:44:50.347590 (Thread-1): Got exception RPCException(10004, Compilation Error, {'type': 'UndefinedMacroException', 'message': 'Compilation Error in rpc request (from remote system)\n  \'get_domain_from_email\' is undefined. This can happen when calling a macro that does not exist. Check for typos and/or install package dependencies with "dbt deps".', 'raw_sql': "select user_id, email_domain from \r\n(select user_id,{{get_domain_from_email(properties_email)}} as email_domain, row_number() over(partition by user_id order by timestamp desc) as rn from \r\n{{ source('ecommerce', 'identifies') }} where timestamp >= '{{ var('start_date') }}' and timestamp <= '{{ var('end_date') }}'\r\nand properties_email is not null and properties_email != '') where rn = 1\nlimit 500\n/* limit added automatically by dbt cloud */", 'compiled_sql': None, 'tags': None}, None)
Traceback (most recent call last):
  File "/usr/local/lib/python3.8/dist-packages/dbt_rpc/task/sql_commands.py", line 147, in _in_thread
    self.node_results.append(runner.safe_run(self.manifest))
  File "/usr/local/lib/python3.8/dist-packages/dbt/task/base.py", line 377, in safe_run
    result = self.error_result(ctx.node, error, started, [])
  File "/usr/local/lib/python3.8/dist-packages/dbt_rpc/rpc/node_runners.py", line 56, in error_result
    raise error
dbt_rpc.rpc.error.RPCException: RPCException(10004, Compilation Error, {'type': 'UndefinedMacroException', 'message': 'Compilation Error in rpc request (from remote system)\n  \'get_domain_from_email\' is undefined. This can happen when calling a macro that does not exist. Check for typos and/or install package dependencies with "dbt deps".', 'raw_sql': "select user_id, email_domain from \r\n(select user_id,{{get_domain_from_email(properties_email)}} as email_domain, row_number() over(partition by user_id order by timestamp desc) as rn from \r\n{{ source('ecommerce', 'identifies') }} where timestamp >= '{{ var('start_date') }}' and timestamp <= '{{ var('end_date') }}'\r\nand properties_email is not null and properties_email != '') where rn = 1\nlimit 500\n/* limit added automatically by dbt cloud */", 'compiled_sql': None, 'tags': None}, None)
2022-07-06 05:44:50.737979 (Thread-69): handling poll request
2022-07-06 05:44:50.738448 (Thread-69): 05:44:50  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '659b7287-63c6-4870-93d6-1d76e1b93300', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f68abcb0280>]}
2022-07-06 05:44:50.739222 (Thread-69): sending response (<Response 8914 bytes [200 OK]>) to 10.0.38.61
2022-07-06 05:45:00.002491 (Thread-70): 05:45:00  Partial parsing enabled: 0 files deleted, 1 files added, 0 files changed.
2022-07-06 05:45:00.003681 (Thread-70): 05:45:00  Partial parsing: added file: ecommerce_data_model_dbt://macros/get_domain_from_email.sql
2022-07-06 05:45:00.003892 (Thread-70): 05:45:00  Parsing macros/get_domain_from_email.sql
2022-07-06 05:45:00.041724 (Thread-70): 05:45:00  [WARNING]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.data-apps-ecommerce-template.data_model

2022-07-06 05:45:00.047516 (Thread-70): 05:45:00  Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '659b7287-63c6-4870-93d6-1d76e1b93300', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f688026d070>]}
2022-07-06 05:45:00.754751 (Thread-71): handling status request
2022-07-06 05:45:00.755180 (Thread-71): 05:45:00  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '659b7287-63c6-4870-93d6-1d76e1b93300', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f68802be0a0>]}
2022-07-06 05:45:00.755705 (Thread-71): sending response (<Response 2009 bytes [200 OK]>) to 10.0.38.61
2022-07-06 05:45:00.762973 (Thread-72): handling status request
2022-07-06 05:45:00.763293 (Thread-72): 05:45:00  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '659b7287-63c6-4870-93d6-1d76e1b93300', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f68802be4c0>]}
2022-07-06 05:45:00.763740 (Thread-72): sending response (<Response 2009 bytes [200 OK]>) to 10.0.38.61
2022-07-06 05:45:03.525110 (Thread-73): 05:45:03  Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
2022-07-06 05:45:03.525350 (Thread-73): 05:45:03  Partial parsing enabled, no changes found, skipping parsing
2022-07-06 05:45:03.526050 (Thread-73): 05:45:03  [WARNING]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.data-apps-ecommerce-template.data_model

2022-07-06 05:45:03.531827 (Thread-73): 05:45:03  Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '659b7287-63c6-4870-93d6-1d76e1b93300', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f68801b9610>]}
2022-07-06 05:45:04.309730 (Thread-74): handling status request
2022-07-06 05:45:04.310175 (Thread-74): 05:45:04  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '659b7287-63c6-4870-93d6-1d76e1b93300', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f68a9d6f100>]}
2022-07-06 05:45:04.310695 (Thread-74): sending response (<Response 1699 bytes [200 OK]>) to 10.0.38.61
2022-07-06 05:45:04.320663 (Thread-75): handling status request
2022-07-06 05:45:04.321087 (Thread-75): 05:45:04  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '659b7287-63c6-4870-93d6-1d76e1b93300', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f68a9d6f370>]}
2022-07-06 05:45:04.321583 (Thread-75): sending response (<Response 1699 bytes [200 OK]>) to 10.0.38.61
2022-07-06 05:45:05.821890 (Thread-76): 05:45:05  Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
2022-07-06 05:45:05.822581 (Thread-76): 05:45:05  Partial parsing: updated file: ecommerce_data_model_dbt://models/data_model/temp_folder/email_domain.sql
2022-07-06 05:45:05.826750 (Thread-76): 05:45:05  1603: static parser failed on data_model/temp_folder/email_domain.sql
2022-07-06 05:45:05.832408 (Thread-76): 05:45:05  1602: parser fallback to jinja rendering on data_model/temp_folder/email_domain.sql
2022-07-06 05:45:05.867370 (Thread-76): 05:45:05  [WARNING]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.data-apps-ecommerce-template.data_model

2022-07-06 05:45:05.873162 (Thread-76): 05:45:05  Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '659b7287-63c6-4870-93d6-1d76e1b93300', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f688015b700>]}
2022-07-06 05:45:06.529437 (Thread-77): handling status request
2022-07-06 05:45:06.529862 (Thread-77): 05:45:06  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '659b7287-63c6-4870-93d6-1d76e1b93300', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f68801f7a30>]}
2022-07-06 05:45:06.530376 (Thread-77): sending response (<Response 2378 bytes [200 OK]>) to 10.0.38.61
2022-07-06 05:45:06.573849 (Thread-78): handling status request
2022-07-06 05:45:06.574243 (Thread-78): 05:45:06  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '659b7287-63c6-4870-93d6-1d76e1b93300', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f68801f7eb0>]}
2022-07-06 05:45:06.574733 (Thread-78): sending response (<Response 2378 bytes [200 OK]>) to 10.0.38.61
2022-07-06 05:45:08.337400 (Thread-79): handling status request
2022-07-06 05:45:08.337831 (Thread-79): 05:45:08  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '659b7287-63c6-4870-93d6-1d76e1b93300', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f68801f7490>]}
2022-07-06 05:45:08.338359 (Thread-79): sending response (<Response 2378 bytes [200 OK]>) to 10.0.38.61
2022-07-06 05:45:08.717641 (Thread-80): handling compile_sql request
2022-07-06 05:45:08.718058 (Thread-80): 05:45:08  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '659b7287-63c6-4870-93d6-1d76e1b93300', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f68801f7c10>]}
2022-07-06 05:45:11.119759 (Thread-80): sending response (<Response 139 bytes [200 OK]>) to 10.0.38.61
2022-07-06 05:45:11.147575 (MainThread): 05:45:11  Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '2e7d3eed-315c-4385-9aa2-546994265754', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5e96a3ea60>]}
2022-07-06 05:45:11.148182 (MainThread): 05:45:11  Found 16 models, 0 tests, 0 snapshots, 0 analyses, 180 macros, 0 operations, 0 seed files, 15 sources, 0 exposures, 0 metrics
2022-07-06 05:45:11.148814 (Thread-1): 05:45:11  Acquiring new snowflake connection "rpc.ecommerce_data_model_dbt.request"
2022-07-06 05:45:11.148971 (Thread-1): 05:45:11  Began compiling node rpc.ecommerce_data_model_dbt.request
2022-07-06 05:45:11.149076 (Thread-1): 05:45:11  Compiling rpc.ecommerce_data_model_dbt.request
2022-07-06 05:45:11.152450 (Thread-1): 05:45:11  finished collecting timing info
2022-07-06 05:45:11.152615 (Thread-1): Got an exception: Compilation Error in rpc request (from remote system)
  Required var 'generic_domain_patterns' not found in config:
  Vars supplied to request = {
      "end_date": "2022-06-29",
      "start_date": "2021-05-01"
  }
  
  > in macro get_domain_from_email (macros/get_domain_from_email.sql)
  > called by rpc request (from remote system)
  > called by rpc request (from remote system)
Traceback (most recent call last):
  File "/usr/local/lib/python3.8/dist-packages/dbt/task/base.py", line 361, in safe_run
    result = self.compile_and_execute(manifest, ctx)
  File "/usr/local/lib/python3.8/dist-packages/dbt/task/base.py", line 301, in compile_and_execute
    ctx.node = self.compile(manifest)
  File "/usr/local/lib/python3.8/dist-packages/dbt_rpc/rpc/node_runners.py", line 45, in compile
    return compiler.compile_node(self.node, manifest, {}, write=False)
  File "/usr/local/lib/python3.8/dist-packages/dbt/compilation.py", line 550, in compile_node
    node = self._compile_node(node, manifest, extra_context)
  File "/usr/local/lib/python3.8/dist-packages/dbt/compilation.py", line 388, in _compile_node
    compiled_node.compiled_sql = jinja.get_rendered(
  File "/usr/local/lib/python3.8/dist-packages/dbt/clients/jinja.py", line 597, in get_rendered
    return render_template(template, ctx, node)
  File "/usr/local/lib/python3.8/dist-packages/dbt/clients/jinja.py", line 548, in render_template
    return template.render(ctx)
  File "/usr/local/lib/python3.8/dist-packages/jinja2/environment.py", line 1090, in render
    self.environment.handle_exception()
  File "/usr/local/lib/python3.8/dist-packages/jinja2/environment.py", line 832, in handle_exception
    reraise(*rewrite_traceback_stack(source=source))
  File "/usr/local/lib/python3.8/dist-packages/jinja2/_compat.py", line 28, in reraise
    raise value.with_traceback(tb)
  File "<template>", line 2, in top-level template code
  File "/usr/local/lib/python3.8/dist-packages/jinja2/sandbox.py", line 462, in call
    return __context.call(__obj, *args, **kwargs)
  File "/usr/local/lib/python3.8/dist-packages/dbt/clients/jinja.py", line 332, in __call__
    return self.call_macro(*args, **kwargs)
  File "/usr/local/lib/python3.8/dist-packages/dbt/clients/jinja.py", line 259, in call_macro
    return macro(*args, **kwargs)
  File "/usr/local/lib/python3.8/dist-packages/jinja2/runtime.py", line 679, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 4, in template
  File "/usr/local/lib/python3.8/dist-packages/jinja2/sandbox.py", line 462, in call
    return __context.call(__obj, *args, **kwargs)
  File "/usr/local/lib/python3.8/dist-packages/dbt/context/base.py", line 165, in __call__
    return self.get_missing_var(var_name)
  File "/usr/local/lib/python3.8/dist-packages/dbt/context/base.py", line 146, in get_missing_var
    raise_compiler_error(msg, self._node)
  File "/usr/local/lib/python3.8/dist-packages/dbt/exceptions.py", line 441, in raise_compiler_error
    raise CompilationException(msg, node)
dbt.exceptions.CompilationException: Compilation Error in rpc request (from remote system)
  Required var 'generic_domain_patterns' not found in config:
  Vars supplied to request = {
      "end_date": "2022-06-29",
      "start_date": "2021-05-01"
  }
  
  > in macro get_domain_from_email (macros/get_domain_from_email.sql)
  > called by rpc request (from remote system)
  > called by rpc request (from remote system)
2022-07-06 05:45:11.154264 (Thread-1): Got exception RPCException(10004, Compilation Error, {'type': 'CompilationException', 'message': 'Compilation Error in rpc request (from remote system)\n  Required var \'generic_domain_patterns\' not found in config:\n  Vars supplied to request = {\n      "end_date": "2022-06-29",\n      "start_date": "2021-05-01"\n  }\n  \n  > in macro get_domain_from_email (macros/get_domain_from_email.sql)\n  > called by rpc request (from remote system)\n  > called by rpc request (from remote system)', 'raw_sql': "select user_id, email_domain from \r\n(select user_id,{{get_domain_from_email(properties_email)}} as email_domain, row_number() over(partition by user_id order by timestamp desc) as rn from \r\n{{ source('ecommerce', 'identifies') }} where timestamp >= '{{ var('start_date') }}' and timestamp <= '{{ var('end_date') }}'\r\nand properties_email is not null and properties_email != '') where rn = 1\nlimit 500\n/* limit added automatically by dbt cloud */", 'compiled_sql': None, 'tags': None}, None)
Traceback (most recent call last):
  File "/usr/local/lib/python3.8/dist-packages/dbt_rpc/task/sql_commands.py", line 147, in _in_thread
    self.node_results.append(runner.safe_run(self.manifest))
  File "/usr/local/lib/python3.8/dist-packages/dbt/task/base.py", line 377, in safe_run
    result = self.error_result(ctx.node, error, started, [])
  File "/usr/local/lib/python3.8/dist-packages/dbt_rpc/rpc/node_runners.py", line 56, in error_result
    raise error
dbt_rpc.rpc.error.RPCException: RPCException(10004, Compilation Error, {'type': 'CompilationException', 'message': 'Compilation Error in rpc request (from remote system)\n  Required var \'generic_domain_patterns\' not found in config:\n  Vars supplied to request = {\n      "end_date": "2022-06-29",\n      "start_date": "2021-05-01"\n  }\n  \n  > in macro get_domain_from_email (macros/get_domain_from_email.sql)\n  > called by rpc request (from remote system)\n  > called by rpc request (from remote system)', 'raw_sql': "select user_id, email_domain from \r\n(select user_id,{{get_domain_from_email(properties_email)}} as email_domain, row_number() over(partition by user_id order by timestamp desc) as rn from \r\n{{ source('ecommerce', 'identifies') }} where timestamp >= '{{ var('start_date') }}' and timestamp <= '{{ var('end_date') }}'\r\nand properties_email is not null and properties_email != '') where rn = 1\nlimit 500\n/* limit added automatically by dbt cloud */", 'compiled_sql': None, 'tags': None}, None)
2022-07-06 05:45:11.494007 (Thread-81): handling poll request
2022-07-06 05:45:11.494487 (Thread-81): 05:45:11  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '659b7287-63c6-4870-93d6-1d76e1b93300', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f68801f36a0>]}
2022-07-06 05:45:11.495303 (Thread-81): sending response (<Response 9934 bytes [200 OK]>) to 10.0.38.61
2022-07-06 05:45:25.223437 (Thread-82): handling status request
2022-07-06 05:45:25.223857 (Thread-82): 05:45:25  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '659b7287-63c6-4870-93d6-1d76e1b93300', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f68801f16a0>]}
2022-07-06 05:45:25.224423 (Thread-82): sending response (<Response 2378 bytes [200 OK]>) to 10.0.38.61
2022-07-06 05:45:25.590070 (Thread-83): handling compile_sql request
2022-07-06 05:45:25.590498 (Thread-83): 05:45:25  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '659b7287-63c6-4870-93d6-1d76e1b93300', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f68801f1d30>]}
2022-07-06 05:45:28.011355 (Thread-83): sending response (<Response 139 bytes [200 OK]>) to 10.0.38.61
2022-07-06 05:45:28.037345 (MainThread): 05:45:28  Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'f9704c63-956d-450b-a6dc-9b289e9997a6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0b41566ca0>]}
2022-07-06 05:45:28.037957 (MainThread): 05:45:28  Found 16 models, 0 tests, 0 snapshots, 0 analyses, 180 macros, 0 operations, 0 seed files, 15 sources, 0 exposures, 0 metrics
2022-07-06 05:45:28.038594 (Thread-1): 05:45:28  Acquiring new snowflake connection "rpc.ecommerce_data_model_dbt.request"
2022-07-06 05:45:28.038732 (Thread-1): 05:45:28  Began compiling node rpc.ecommerce_data_model_dbt.request
2022-07-06 05:45:28.038837 (Thread-1): 05:45:28  Compiling rpc.ecommerce_data_model_dbt.request
2022-07-06 05:45:28.040058 (Thread-1): 05:45:28  finished collecting timing info
2022-07-06 05:45:28.040195 (Thread-1): 05:45:28  Began executing node rpc.ecommerce_data_model_dbt.request
2022-07-06 05:45:28.040299 (Thread-1): 05:45:28  finished collecting timing info
2022-07-06 05:45:28.382208 (Thread-84): handling poll request
2022-07-06 05:45:28.382698 (Thread-84): 05:45:28  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '659b7287-63c6-4870-93d6-1d76e1b93300', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6880267a60>]}
2022-07-06 05:45:28.383929 (Thread-84): sending response (<Response 5176 bytes [200 OK]>) to 10.0.38.61
2022-07-06 05:47:56.693269 (Thread-85): 05:47:56  Unable to do partial parsing because a project config has changed
2022-07-06 05:47:56.695108 (Thread-85): 05:47:56  Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '659b7287-63c6-4870-93d6-1d76e1b93300', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f68801feca0>]}
2022-07-06 05:47:56.746793 (Thread-85): 05:47:56  Parsing macros/get_domain_from_email.sql
2022-07-06 05:47:56.748109 (Thread-85): 05:47:56  Parsing macros/adapters.sql
2022-07-06 05:47:56.785915 (Thread-85): 05:47:56  Parsing macros/catalog.sql
2022-07-06 05:47:56.787893 (Thread-85): 05:47:56  Parsing macros/materializations/table.sql
2022-07-06 05:47:56.791061 (Thread-85): 05:47:56  Parsing macros/materializations/seed.sql
2022-07-06 05:47:56.796234 (Thread-85): 05:47:56  Parsing macros/materializations/incremental.sql
2022-07-06 05:47:56.804815 (Thread-85): 05:47:56  Parsing macros/materializations/merge.sql
2022-07-06 05:47:56.808686 (Thread-85): 05:47:56  Parsing macros/materializations/snapshot.sql
2022-07-06 05:47:56.809773 (Thread-85): 05:47:56  Parsing macros/materializations/view.sql
2022-07-06 05:47:56.811150 (Thread-85): 05:47:56  Parsing macros/adapters/metadata.sql
2022-07-06 05:47:56.818187 (Thread-85): 05:47:56  Parsing macros/adapters/columns.sql
2022-07-06 05:47:56.827959 (Thread-85): 05:47:56  Parsing macros/adapters/freshness.sql
2022-07-06 05:47:56.830896 (Thread-85): 05:47:56  Parsing macros/adapters/persist_docs.sql
2022-07-06 05:47:56.835270 (Thread-85): 05:47:56  Parsing macros/adapters/relation.sql
2022-07-06 05:47:56.844725 (Thread-85): 05:47:56  Parsing macros/adapters/schema.sql
2022-07-06 05:47:56.846988 (Thread-85): 05:47:56  Parsing macros/adapters/indexes.sql
2022-07-06 05:47:56.849745 (Thread-85): 05:47:56  Parsing macros/get_custom_name/get_custom_schema.sql
2022-07-06 05:47:56.852231 (Thread-85): 05:47:56  Parsing macros/get_custom_name/get_custom_alias.sql
2022-07-06 05:47:56.853782 (Thread-85): 05:47:56  Parsing macros/get_custom_name/get_custom_database.sql
2022-07-06 05:47:56.855360 (Thread-85): 05:47:56  Parsing macros/etc/datetime.sql
2022-07-06 05:47:56.864026 (Thread-85): 05:47:56  Parsing macros/etc/statement.sql
2022-07-06 05:47:56.868476 (Thread-85): 05:47:56  Parsing macros/generic_test_sql/unique.sql
2022-07-06 05:47:56.869274 (Thread-85): 05:47:56  Parsing macros/generic_test_sql/not_null.sql
2022-07-06 05:47:56.869858 (Thread-85): 05:47:56  Parsing macros/generic_test_sql/accepted_values.sql
2022-07-06 05:47:56.871258 (Thread-85): 05:47:56  Parsing macros/generic_test_sql/relationships.sql
2022-07-06 05:47:56.872170 (Thread-85): 05:47:56  Parsing macros/materializations/configs.sql
2022-07-06 05:47:56.874513 (Thread-85): 05:47:56  Parsing macros/materializations/hooks.sql
2022-07-06 05:47:56.878346 (Thread-85): 05:47:56  Parsing macros/materializations/models/table/table.sql
2022-07-06 05:47:56.885881 (Thread-85): 05:47:56  Parsing macros/materializations/models/table/create_table_as.sql
2022-07-06 05:47:56.888737 (Thread-85): 05:47:56  Parsing macros/materializations/models/view/create_or_replace_view.sql
2022-07-06 05:47:56.891389 (Thread-85): 05:47:56  Parsing macros/materializations/models/view/helpers.sql
2022-07-06 05:47:56.892712 (Thread-85): 05:47:56  Parsing macros/materializations/models/view/create_view_as.sql
2022-07-06 05:47:56.895003 (Thread-85): 05:47:56  Parsing macros/materializations/models/view/view.sql
2022-07-06 05:47:56.901952 (Thread-85): 05:47:56  Parsing macros/materializations/models/incremental/incremental.sql
2022-07-06 05:47:56.911716 (Thread-85): 05:47:56  Parsing macros/materializations/models/incremental/on_schema_change.sql
2022-07-06 05:47:56.926924 (Thread-85): 05:47:56  Parsing macros/materializations/models/incremental/is_incremental.sql
2022-07-06 05:47:56.928507 (Thread-85): 05:47:56  Parsing macros/materializations/models/incremental/merge.sql
2022-07-06 05:47:56.939513 (Thread-85): 05:47:56  Parsing macros/materializations/models/incremental/column_helpers.sql
2022-07-06 05:47:56.944068 (Thread-85): 05:47:56  Parsing macros/materializations/seeds/helpers.sql
2022-07-06 05:47:56.960370 (Thread-85): 05:47:56  Parsing macros/materializations/seeds/seed.sql
2022-07-06 05:47:56.966448 (Thread-85): 05:47:56  Parsing macros/materializations/tests/helpers.sql
2022-07-06 05:47:56.968327 (Thread-85): 05:47:56  Parsing macros/materializations/tests/test.sql
2022-07-06 05:47:56.972779 (Thread-85): 05:47:56  Parsing macros/materializations/tests/where_subquery.sql
2022-07-06 05:47:56.974687 (Thread-85): 05:47:56  Parsing macros/materializations/snapshots/helpers.sql
2022-07-06 05:47:56.986023 (Thread-85): 05:47:56  Parsing macros/materializations/snapshots/strategies.sql
2022-07-06 05:47:57.002624 (Thread-85): 05:47:57  Parsing macros/materializations/snapshots/snapshot_merge.sql
2022-07-06 05:47:57.004393 (Thread-85): 05:47:57  Parsing macros/materializations/snapshots/snapshot.sql
2022-07-06 05:47:57.015858 (Thread-85): 05:47:57  Parsing tests/generic/builtin.sql
2022-07-06 05:47:57.204124 (Thread-85): 05:47:57  1603: static parser failed on data_model/stg_user_traits.sql
2022-07-06 05:47:57.214259 (Thread-85): 05:47:57  1602: parser fallback to jinja rendering on data_model/stg_user_traits.sql
2022-07-06 05:47:57.215536 (Thread-85): 05:47:57  1603: static parser failed on data_model/stg_products_viewed.sql
2022-07-06 05:47:57.219280 (Thread-85): 05:47:57  1602: parser fallback to jinja rendering on data_model/stg_products_viewed.sql
2022-07-06 05:47:57.220507 (Thread-85): 05:47:57  1699: static parser successfully parsed data_model/feat_user_features.sql
2022-07-06 05:47:57.222449 (Thread-85): 05:47:57  1699: static parser successfully parsed data_model/stg_user_properties.sql
2022-07-06 05:47:57.224284 (Thread-85): 05:47:57  1699: static parser successfully parsed data_model/stg_tracks.sql
2022-07-06 05:47:57.226092 (Thread-85): 05:47:57  1699: static parser successfully parsed data_model/temp_folder/preferred_login_device.sql
2022-07-06 05:47:57.228356 (Thread-85): 05:47:57  1603: static parser failed on data_model/temp_folder/country.sql
2022-07-06 05:47:57.232180 (Thread-85): 05:47:57  1602: parser fallback to jinja rendering on data_model/temp_folder/country.sql
2022-07-06 05:47:57.234031 (Thread-85): 05:47:57  1699: static parser successfully parsed data_model/temp_folder/utm_url_sequence.sql
2022-07-06 05:47:57.236040 (Thread-85): 05:47:57  1603: static parser failed on data_model/temp_folder/is_member.sql
2022-07-06 05:47:57.239962 (Thread-85): 05:47:57  1602: parser fallback to jinja rendering on data_model/temp_folder/is_member.sql
2022-07-06 05:47:57.241132 (Thread-85): 05:47:57  1603: static parser failed on data_model/temp_folder/has_mobile_app.sql
2022-07-06 05:47:57.244901 (Thread-85): 05:47:57  1602: parser fallback to jinja rendering on data_model/temp_folder/has_mobile_app.sql
2022-07-06 05:47:57.246030 (Thread-85): 05:47:57  1603: static parser failed on data_model/temp_folder/email_domain.sql
2022-07-06 05:47:57.249982 (Thread-85): 05:47:57  1602: parser fallback to jinja rendering on data_model/temp_folder/email_domain.sql
2022-07-06 05:47:57.251113 (Thread-85): 05:47:57  1603: static parser failed on data_model/temp_folder/gender.sql
2022-07-06 05:47:57.254791 (Thread-85): 05:47:57  1602: parser fallback to jinja rendering on data_model/temp_folder/gender.sql
2022-07-06 05:47:57.256090 (Thread-85): 05:47:57  1603: static parser failed on data_model/temp_folder/is_active_on_website.sql
2022-07-06 05:47:57.260098 (Thread-85): 05:47:57  1602: parser fallback to jinja rendering on data_model/temp_folder/is_active_on_website.sql
2022-07-06 05:47:57.261362 (Thread-85): 05:47:57  1603: static parser failed on data_model/temp_folder/age.sql
2022-07-06 05:47:57.265260 (Thread-85): 05:47:57  1602: parser fallback to jinja rendering on data_model/temp_folder/age.sql
2022-07-06 05:47:57.266404 (Thread-85): 05:47:57  1603: static parser failed on data_model/temp_folder/state.sql
2022-07-06 05:47:57.270078 (Thread-85): 05:47:57  1602: parser fallback to jinja rendering on data_model/temp_folder/state.sql
2022-07-06 05:47:57.271088 (Thread-85): 05:47:57  1699: static parser successfully parsed data_model/temp_folder/device_type.sql
2022-07-06 05:47:57.289620 (Thread-85): 05:47:57  [WARNING]: Did not find matching node for patch with name 'my_first_dbt_model' in the 'models' section of file 'models/data_model/schema.yml'
2022-07-06 05:47:57.320410 (Thread-85): 05:47:57  [WARNING]: Test 'test.ecommerce_data_model_dbt.unique_my_first_dbt_model_id.16e066b321' (models/data_model/schema.yml) depends on a node named 'my_first_dbt_model' which was not found
2022-07-06 05:47:57.320784 (Thread-85): 05:47:57  [WARNING]: Test 'test.ecommerce_data_model_dbt.not_null_my_first_dbt_model_id.5fb22c2710' (models/data_model/schema.yml) depends on a node named 'my_first_dbt_model' which was not found
2022-07-06 05:47:57.364670 (Thread-85): 05:47:57  [WARNING]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.data-apps-ecommerce-template.data_model

2022-07-06 05:47:57.370664 (Thread-85): 05:47:57  Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '659b7287-63c6-4870-93d6-1d76e1b93300', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f688031efa0>]}
2022-07-06 05:47:57.474126 (Thread-86): handling status request
2022-07-06 05:47:57.474574 (Thread-86): 05:47:57  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '659b7287-63c6-4870-93d6-1d76e1b93300', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6880173e20>]}
2022-07-06 05:47:57.475739 (Thread-86): sending response (<Response 25166 bytes [200 OK]>) to 10.0.38.61
2022-07-06 05:47:57.494383 (Thread-87): handling status request
2022-07-06 05:47:57.494791 (Thread-87): 05:47:57  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '659b7287-63c6-4870-93d6-1d76e1b93300', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6880173220>]}
2022-07-06 05:47:57.495872 (Thread-87): sending response (<Response 25166 bytes [200 OK]>) to 10.0.38.61
2022-07-06 05:48:05.775604 (Thread-88): handling status request
2022-07-06 05:48:05.776054 (Thread-88): 05:48:05  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '659b7287-63c6-4870-93d6-1d76e1b93300', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f68a812fdc0>]}
2022-07-06 05:48:05.777243 (Thread-88): sending response (<Response 25166 bytes [200 OK]>) to 10.0.38.61
2022-07-06 05:48:06.167585 (Thread-89): handling compile_sql request
2022-07-06 05:48:06.168005 (Thread-89): 05:48:06  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '659b7287-63c6-4870-93d6-1d76e1b93300', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f68801f7130>]}
2022-07-06 05:48:08.602268 (Thread-89): sending response (<Response 139 bytes [200 OK]>) to 10.0.38.61
2022-07-06 05:48:08.630196 (MainThread): 05:48:08  Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '276f00cc-767f-4923-adf3-73e8f227837d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7ca5640ee0>]}
2022-07-06 05:48:08.630838 (MainThread): 05:48:08  Found 16 models, 0 tests, 0 snapshots, 0 analyses, 180 macros, 0 operations, 0 seed files, 15 sources, 0 exposures, 0 metrics
2022-07-06 05:48:08.631506 (Thread-1): 05:48:08  Acquiring new snowflake connection "rpc.ecommerce_data_model_dbt.request"
2022-07-06 05:48:08.631649 (Thread-1): 05:48:08  Began compiling node rpc.ecommerce_data_model_dbt.request
2022-07-06 05:48:08.631748 (Thread-1): 05:48:08  Compiling rpc.ecommerce_data_model_dbt.request
2022-07-06 05:48:08.634945 (Thread-1): 05:48:08  finished collecting timing info
2022-07-06 05:48:08.635094 (Thread-1): 05:48:08  Began executing node rpc.ecommerce_data_model_dbt.request
2022-07-06 05:48:08.635197 (Thread-1): 05:48:08  finished collecting timing info
2022-07-06 05:48:09.001800 (Thread-90): handling poll request
2022-07-06 05:48:09.002271 (Thread-90): 05:48:09  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '659b7287-63c6-4870-93d6-1d76e1b93300', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f68801d3e20>]}
2022-07-06 05:48:09.003501 (Thread-90): sending response (<Response 7161 bytes [200 OK]>) to 10.0.38.61
2022-07-06 05:48:12.064248 (Thread-91): handling status request
2022-07-06 05:48:12.064701 (Thread-91): 05:48:12  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '659b7287-63c6-4870-93d6-1d76e1b93300', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6880309a90>]}
2022-07-06 05:48:12.066187 (Thread-91): sending response (<Response 25166 bytes [200 OK]>) to 10.0.38.61
2022-07-06 05:48:12.464871 (Thread-92): handling run_sql request
2022-07-06 05:48:12.465300 (Thread-92): 05:48:12  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '659b7287-63c6-4870-93d6-1d76e1b93300', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6880309bb0>]}
2022-07-06 05:48:14.882686 (Thread-92): sending response (<Response 139 bytes [200 OK]>) to 10.0.38.61
2022-07-06 05:48:14.909791 (MainThread): 05:48:14  Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '2c9e2577-a846-4011-bba8-48828c5b56c5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd3953b4040>]}
2022-07-06 05:48:14.910362 (MainThread): 05:48:14  Found 16 models, 0 tests, 0 snapshots, 0 analyses, 180 macros, 0 operations, 0 seed files, 15 sources, 0 exposures, 0 metrics
2022-07-06 05:48:14.910977 (Thread-1): 05:48:14  Acquiring new snowflake connection "rpc.ecommerce_data_model_dbt.request"
2022-07-06 05:48:14.911111 (Thread-1): 05:48:14  Began compiling node rpc.ecommerce_data_model_dbt.request
2022-07-06 05:48:14.911203 (Thread-1): 05:48:14  Compiling rpc.ecommerce_data_model_dbt.request
2022-07-06 05:48:14.914137 (Thread-1): 05:48:14  finished collecting timing info
2022-07-06 05:48:14.914273 (Thread-1): 05:48:14  Began executing node rpc.ecommerce_data_model_dbt.request
2022-07-06 05:48:14.915195 (Thread-1): 05:48:14  Using snowflake connection "rpc.ecommerce_data_model_dbt.request"
2022-07-06 05:48:14.915286 (Thread-1): 05:48:14  On rpc.ecommerce_data_model_dbt.request: select user_id, email_domain from 
(select user_id,
  case
         when
            lower() like any ('@gmail.com', '@rudderstack.com') 
         then
            lower()
         else
            lower(split_part(, '@', 2)) 
      end
 as email_domain, row_number() over(partition by user_id order by timestamp desc) as rn from 
analytics_db.data_apps_simulated.identifies where timestamp >= '2021-05-01' and timestamp <= '2022-06-29'
and properties_email is not null and properties_email != '') where rn = 1
limit 500
/* limit added automatically by dbt cloud */
2022-07-06 05:48:14.915368 (Thread-1): 05:48:14  Opening a new connection, currently in state init
2022-07-06 05:48:15.278653 (Thread-93): handling poll request
2022-07-06 05:48:15.279123 (Thread-93): 05:48:15  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '659b7287-63c6-4870-93d6-1d76e1b93300', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f68801b8580>]}
2022-07-06 05:48:15.280034 (Thread-93): sending response (<Response 4313 bytes [200 OK]>) to 10.0.38.61
2022-07-06 05:48:15.561114 (Thread-1): 05:48:15  Snowflake adapter: Snowflake query id: 01a56b3c-0602-333e-0019-82030469860a
2022-07-06 05:48:15.561313 (Thread-1): 05:48:15  Snowflake adapter: Snowflake error: 001003 (42000): SQL compilation error:
syntax error line 9 at position 29 unexpected ','.
syntax error line 9 at position 29 unexpected ','.
syntax error line 9 at position 38 unexpected ')'.
2022-07-06 05:48:15.561475 (Thread-1): 05:48:15  finished collecting timing info
2022-07-06 05:48:15.561635 (Thread-1): 05:48:15  On rpc.ecommerce_data_model_dbt.request: Close
2022-07-06 05:48:15.632475 (Thread-1): Got an exception: Database Error
  001003 (42000): SQL compilation error:
  syntax error line 9 at position 29 unexpected ','.
  syntax error line 9 at position 29 unexpected ','.
  syntax error line 9 at position 38 unexpected ')'.
Traceback (most recent call last):
  File "/usr/local/lib/python3.8/dist-packages/dbt/adapters/snowflake/connections.py", line 206, in exception_handler
    yield
  File "/usr/local/lib/python3.8/dist-packages/dbt/adapters/sql/connections.py", line 74, in add_query
    cursor.execute(sql, bindings)
  File "/usr/local/lib/python3.8/dist-packages/snowflake/connector/cursor.py", line 721, in execute
    Error.errorhandler_wrapper(
  File "/usr/local/lib/python3.8/dist-packages/snowflake/connector/errors.py", line 258, in errorhandler_wrapper
    cursor.errorhandler(connection, cursor, error_class, error_value)
  File "/usr/local/lib/python3.8/dist-packages/snowflake/connector/errors.py", line 188, in default_errorhandler
    raise error_class(
snowflake.connector.errors.ProgrammingError: 001003 (42000): SQL compilation error:
syntax error line 9 at position 29 unexpected ','.
syntax error line 9 at position 29 unexpected ','.
syntax error line 9 at position 38 unexpected ')'.

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/usr/local/lib/python3.8/dist-packages/dbt/task/base.py", line 361, in safe_run
    result = self.compile_and_execute(manifest, ctx)
  File "/usr/local/lib/python3.8/dist-packages/dbt/task/base.py", line 314, in compile_and_execute
    result = self.run(ctx.node, manifest)
  File "/usr/local/lib/python3.8/dist-packages/dbt/task/base.py", line 403, in run
    return self.execute(compiled_node, manifest)
  File "/usr/local/lib/python3.8/dist-packages/dbt_rpc/rpc/node_runners.py", line 90, in execute
    _, execute_result = self.adapter.execute(
  File "/usr/local/lib/python3.8/dist-packages/dbt/adapters/base/impl.py", line 225, in execute
    return self.connections.execute(
  File "/usr/local/lib/python3.8/dist-packages/dbt/adapters/sql/connections.py", line 127, in execute
    _, cursor = self.add_query(sql, auto_begin)
  File "/usr/local/lib/python3.8/dist-packages/dbt/adapters/snowflake/connections.py", line 433, in add_query
    connection, cursor = super().add_query(
  File "/usr/local/lib/python3.8/dist-packages/dbt/adapters/sql/connections.py", line 83, in add_query
    return connection, cursor
  File "/usr/lib/python3.8/contextlib.py", line 131, in __exit__
    self.gen.throw(type, value, traceback)
  File "/usr/local/lib/python3.8/dist-packages/dbt/adapters/snowflake/connections.py", line 223, in exception_handler
    raise DatabaseException(msg)
dbt.exceptions.DatabaseException: Database Error
  001003 (42000): SQL compilation error:
  syntax error line 9 at position 29 unexpected ','.
  syntax error line 9 at position 29 unexpected ','.
  syntax error line 9 at position 38 unexpected ')'.
2022-07-06 05:48:15.633459 (Thread-1): Got exception RPCException(10003, Database Error, {'type': 'DatabaseException', 'message': "Database Error in rpc request (from remote system)\n  001003 (42000): SQL compilation error:\n  syntax error line 9 at position 29 unexpected ','.\n  syntax error line 9 at position 29 unexpected ','.\n  syntax error line 9 at position 38 unexpected ')'.", 'raw_sql': "select user_id, email_domain from \r\n(select user_id,{{get_domain_from_email(properties_email)}} as email_domain, row_number() over(partition by user_id order by timestamp desc) as rn from \r\n{{ source('ecommerce', 'identifies') }} where timestamp >= '{{ var('start_date') }}' and timestamp <= '{{ var('end_date') }}'\r\nand properties_email is not null and properties_email != '') where rn = 1\nlimit 500\n/* limit added automatically by dbt cloud */", 'compiled_sql': "select user_id, email_domain from \n(select user_id,\n  case\n         when\n            lower() like any ('@gmail.com', '@rudderstack.com') \n         then\n            lower()\n         else\n            lower(split_part(, '@', 2)) \n      end\n as email_domain, row_number() over(partition by user_id order by timestamp desc) as rn from \nanalytics_db.data_apps_simulated.identifies where timestamp >= '2021-05-01' and timestamp <= '2022-06-29'\nand properties_email is not null and properties_email != '') where rn = 1\nlimit 500\n/* limit added automatically by dbt cloud */", 'tags': None}, None)
Traceback (most recent call last):
  File "/usr/local/lib/python3.8/dist-packages/dbt_rpc/task/sql_commands.py", line 147, in _in_thread
    self.node_results.append(runner.safe_run(self.manifest))
  File "/usr/local/lib/python3.8/dist-packages/dbt/task/base.py", line 377, in safe_run
    result = self.error_result(ctx.node, error, started, [])
  File "/usr/local/lib/python3.8/dist-packages/dbt_rpc/rpc/node_runners.py", line 56, in error_result
    raise error
dbt_rpc.rpc.error.RPCException: RPCException(10003, Database Error, {'type': 'DatabaseException', 'message': "Database Error in rpc request (from remote system)\n  001003 (42000): SQL compilation error:\n  syntax error line 9 at position 29 unexpected ','.\n  syntax error line 9 at position 29 unexpected ','.\n  syntax error line 9 at position 38 unexpected ')'.", 'raw_sql': "select user_id, email_domain from \r\n(select user_id,{{get_domain_from_email(properties_email)}} as email_domain, row_number() over(partition by user_id order by timestamp desc) as rn from \r\n{{ source('ecommerce', 'identifies') }} where timestamp >= '{{ var('start_date') }}' and timestamp <= '{{ var('end_date') }}'\r\nand properties_email is not null and properties_email != '') where rn = 1\nlimit 500\n/* limit added automatically by dbt cloud */", 'compiled_sql': "select user_id, email_domain from \n(select user_id,\n  case\n         when\n            lower() like any ('@gmail.com', '@rudderstack.com') \n         then\n            lower()\n         else\n            lower(split_part(, '@', 2)) \n      end\n as email_domain, row_number() over(partition by user_id order by timestamp desc) as rn from \nanalytics_db.data_apps_simulated.identifies where timestamp >= '2021-05-01' and timestamp <= '2022-06-29'\nand properties_email is not null and properties_email != '') where rn = 1\nlimit 500\n/* limit added automatically by dbt cloud */", 'tags': None}, None)
2022-07-06 05:48:16.656862 (Thread-94): handling poll request
2022-07-06 05:48:16.657313 (Thread-94): 05:48:16  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '659b7287-63c6-4870-93d6-1d76e1b93300', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f68801b88e0>]}
2022-07-06 05:48:16.657958 (Thread-94): sending response (<Response 13810 bytes [200 OK]>) to 10.0.38.61
2022-07-06 05:48:34.090162 (Thread-95): handling status request
2022-07-06 05:48:34.090583 (Thread-95): 05:48:34  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '659b7287-63c6-4870-93d6-1d76e1b93300', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f68801b86d0>]}
2022-07-06 05:48:34.092632 (Thread-95): sending response (<Response 25166 bytes [200 OK]>) to 10.0.38.61
2022-07-06 05:48:34.464487 (Thread-96): handling compile_sql request
2022-07-06 05:48:34.464901 (Thread-96): 05:48:34  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '659b7287-63c6-4870-93d6-1d76e1b93300', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f68801739d0>]}
2022-07-06 05:48:36.865001 (Thread-96): sending response (<Response 139 bytes [200 OK]>) to 10.0.38.61
2022-07-06 05:48:36.892083 (MainThread): 05:48:36  Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '621e7fd3-c322-45b3-aeff-9fbcd978c7f7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6255b21f40>]}
2022-07-06 05:48:36.892682 (MainThread): 05:48:36  Found 16 models, 0 tests, 0 snapshots, 0 analyses, 180 macros, 0 operations, 0 seed files, 15 sources, 0 exposures, 0 metrics
2022-07-06 05:48:36.893340 (Thread-1): 05:48:36  Acquiring new snowflake connection "rpc.ecommerce_data_model_dbt.request"
2022-07-06 05:48:36.893477 (Thread-1): 05:48:36  Began compiling node rpc.ecommerce_data_model_dbt.request
2022-07-06 05:48:36.893574 (Thread-1): 05:48:36  Compiling rpc.ecommerce_data_model_dbt.request
2022-07-06 05:48:36.896583 (Thread-1): 05:48:36  finished collecting timing info
2022-07-06 05:48:36.896725 (Thread-1): 05:48:36  Began executing node rpc.ecommerce_data_model_dbt.request
2022-07-06 05:48:36.896826 (Thread-1): 05:48:36  finished collecting timing info
2022-07-06 05:48:37.268919 (Thread-97): handling poll request
2022-07-06 05:48:37.269416 (Thread-97): 05:48:37  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '659b7287-63c6-4870-93d6-1d76e1b93300', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6880198d30>]}
2022-07-06 05:48:37.270568 (Thread-97): sending response (<Response 7161 bytes [200 OK]>) to 10.0.38.61
2022-07-06 05:50:01.866998 (Thread-98): handling status request
2022-07-06 05:50:01.867412 (Thread-98): 05:50:01  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '659b7287-63c6-4870-93d6-1d76e1b93300', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6880198670>]}
2022-07-06 05:50:01.868801 (Thread-98): sending response (<Response 25166 bytes [200 OK]>) to 10.0.38.61
2022-07-06 05:50:02.277004 (Thread-99): handling compile_sql request
2022-07-06 05:50:02.277468 (Thread-99): 05:50:02  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '659b7287-63c6-4870-93d6-1d76e1b93300', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6880198400>]}
2022-07-06 05:50:04.706765 (Thread-99): sending response (<Response 139 bytes [200 OK]>) to 10.0.38.61
2022-07-06 05:50:04.733809 (MainThread): 05:50:04  Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'ffc55e53-735f-45a8-8333-7942a221de6f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f887affb0a0>]}
2022-07-06 05:50:04.734409 (MainThread): 05:50:04  Found 16 models, 0 tests, 0 snapshots, 0 analyses, 180 macros, 0 operations, 0 seed files, 15 sources, 0 exposures, 0 metrics
2022-07-06 05:50:04.735044 (Thread-1): 05:50:04  Acquiring new snowflake connection "rpc.ecommerce_data_model_dbt.request"
2022-07-06 05:50:04.735190 (Thread-1): 05:50:04  Began compiling node rpc.ecommerce_data_model_dbt.request
2022-07-06 05:50:04.735289 (Thread-1): 05:50:04  Compiling rpc.ecommerce_data_model_dbt.request
2022-07-06 05:50:04.736539 (Thread-1): 05:50:04  finished collecting timing info
2022-07-06 05:50:04.736677 (Thread-1): 05:50:04  Began executing node rpc.ecommerce_data_model_dbt.request
2022-07-06 05:50:04.736783 (Thread-1): 05:50:04  finished collecting timing info
2022-07-06 05:50:05.090964 (Thread-100): handling poll request
2022-07-06 05:50:05.091438 (Thread-100): 05:50:05  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '659b7287-63c6-4870-93d6-1d76e1b93300', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6880150d00>]}
2022-07-06 05:50:05.092561 (Thread-100): sending response (<Response 5174 bytes [200 OK]>) to 10.0.38.61
2022-07-06 05:50:47.040406 (Thread-101): handling status request
2022-07-06 05:50:47.040824 (Thread-101): 05:50:47  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '659b7287-63c6-4870-93d6-1d76e1b93300', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6880150460>]}
2022-07-06 05:50:47.042175 (Thread-101): sending response (<Response 25143 bytes [200 OK]>) to 10.0.38.61
2022-07-06 05:50:47.051759 (Thread-102): handling list request
2022-07-06 05:50:47.052131 (Thread-102): 05:50:47  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '659b7287-63c6-4870-93d6-1d76e1b93300', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6880150e20>]}
2022-07-06 05:50:47.110125 (Thread-104): sending response (<Response 214 bytes [200 OK]>) to 10.0.38.61
2022-07-06 05:50:48.451959 (Thread-105): handling status request
2022-07-06 05:50:48.452369 (Thread-105): 05:50:48  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '659b7287-63c6-4870-93d6-1d76e1b93300', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6880150970>]}
2022-07-06 05:50:48.453561 (Thread-105): sending response (<Response 25143 bytes [200 OK]>) to 10.0.38.61
2022-07-06 05:50:48.490368 (Thread-106): handling list request
2022-07-06 05:50:48.490789 (Thread-106): 05:50:48  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '659b7287-63c6-4870-93d6-1d76e1b93300', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6880150f40>]}
2022-07-06 05:50:48.519641 (Thread-106): 05:50:48  Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '659b7287-63c6-4870-93d6-1d76e1b93300', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f68801508e0>]}
2022-07-06 05:50:48.520012 (Thread-106): 05:50:48  Found 16 models, 0 tests, 0 snapshots, 0 analyses, 180 macros, 0 operations, 0 seed files, 15 sources, 0 exposures, 0 metrics
2022-07-06 05:50:48.522875 (Thread-106): sending response (<Response 2119 bytes [200 OK]>) to 10.0.38.61
2022-07-06 05:50:52.427550 (Thread-107): handling status request
2022-07-06 05:50:52.427966 (Thread-107): 05:50:52  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '659b7287-63c6-4870-93d6-1d76e1b93300', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f688012b310>]}
2022-07-06 05:50:52.429111 (Thread-107): sending response (<Response 25166 bytes [200 OK]>) to 10.0.38.61
2022-07-06 05:50:52.818400 (Thread-108): handling run_sql request
2022-07-06 05:50:52.818810 (Thread-108): 05:50:52  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '659b7287-63c6-4870-93d6-1d76e1b93300', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f688012b5b0>]}
2022-07-06 05:50:55.257430 (Thread-108): sending response (<Response 139 bytes [200 OK]>) to 10.0.38.61
2022-07-06 05:50:55.284080 (MainThread): 05:50:55  Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '204bdfd5-7975-444f-acdd-c626ef2b97d3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7df64edf40>]}
2022-07-06 05:50:55.284660 (MainThread): 05:50:55  Found 16 models, 0 tests, 0 snapshots, 0 analyses, 180 macros, 0 operations, 0 seed files, 15 sources, 0 exposures, 0 metrics
2022-07-06 05:50:55.285302 (Thread-1): 05:50:55  Acquiring new snowflake connection "rpc.ecommerce_data_model_dbt.request"
2022-07-06 05:50:55.285446 (Thread-1): 05:50:55  Began compiling node rpc.ecommerce_data_model_dbt.request
2022-07-06 05:50:55.285555 (Thread-1): 05:50:55  Compiling rpc.ecommerce_data_model_dbt.request
2022-07-06 05:50:55.288528 (Thread-1): 05:50:55  finished collecting timing info
2022-07-06 05:50:55.288664 (Thread-1): 05:50:55  Began executing node rpc.ecommerce_data_model_dbt.request
2022-07-06 05:50:55.289631 (Thread-1): 05:50:55  Using snowflake connection "rpc.ecommerce_data_model_dbt.request"
2022-07-06 05:50:55.289729 (Thread-1): 05:50:55  On rpc.ecommerce_data_model_dbt.request: select user_id, email_domain from 
(select user_id,
  case
         when
            lower() like any ('@gmail.com', '@rudderstack.com') 
         then
            lower()
         else
            lower(split_part(, '@', 2)) 
      end
 as email_domain, row_number() over(partition by user_id order by timestamp desc) as rn from 
analytics_db.data_apps_simulated.identifies where timestamp >= '2021-05-01' and timestamp <= '2022-06-29'
and properties_email is not null and properties_email != '') where rn = 1
limit 500
/* limit added automatically by dbt cloud */
2022-07-06 05:50:55.289814 (Thread-1): 05:50:55  Opening a new connection, currently in state init
2022-07-06 05:50:55.660587 (Thread-109): handling poll request
2022-07-06 05:50:55.661104 (Thread-109): 05:50:55  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '659b7287-63c6-4870-93d6-1d76e1b93300', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f68800b4f70>]}
2022-07-06 05:50:55.661988 (Thread-109): sending response (<Response 4312 bytes [200 OK]>) to 10.0.38.61
2022-07-06 05:50:56.101514 (Thread-1): 05:50:56  Snowflake adapter: Snowflake query id: 01a56b3e-0602-3316-0019-820304696e3e
2022-07-06 05:50:56.101737 (Thread-1): 05:50:56  Snowflake adapter: Snowflake error: 001003 (42000): SQL compilation error:
syntax error line 9 at position 29 unexpected ','.
syntax error line 9 at position 29 unexpected ','.
syntax error line 9 at position 38 unexpected ')'.
2022-07-06 05:50:56.101910 (Thread-1): 05:50:56  finished collecting timing info
2022-07-06 05:50:56.102080 (Thread-1): 05:50:56  On rpc.ecommerce_data_model_dbt.request: Close
2022-07-06 05:50:56.174906 (Thread-1): Got an exception: Database Error
  001003 (42000): SQL compilation error:
  syntax error line 9 at position 29 unexpected ','.
  syntax error line 9 at position 29 unexpected ','.
  syntax error line 9 at position 38 unexpected ')'.
Traceback (most recent call last):
  File "/usr/local/lib/python3.8/dist-packages/dbt/adapters/snowflake/connections.py", line 206, in exception_handler
    yield
  File "/usr/local/lib/python3.8/dist-packages/dbt/adapters/sql/connections.py", line 74, in add_query
    cursor.execute(sql, bindings)
  File "/usr/local/lib/python3.8/dist-packages/snowflake/connector/cursor.py", line 721, in execute
    Error.errorhandler_wrapper(
  File "/usr/local/lib/python3.8/dist-packages/snowflake/connector/errors.py", line 258, in errorhandler_wrapper
    cursor.errorhandler(connection, cursor, error_class, error_value)
  File "/usr/local/lib/python3.8/dist-packages/snowflake/connector/errors.py", line 188, in default_errorhandler
    raise error_class(
snowflake.connector.errors.ProgrammingError: 001003 (42000): SQL compilation error:
syntax error line 9 at position 29 unexpected ','.
syntax error line 9 at position 29 unexpected ','.
syntax error line 9 at position 38 unexpected ')'.

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/usr/local/lib/python3.8/dist-packages/dbt/task/base.py", line 361, in safe_run
    result = self.compile_and_execute(manifest, ctx)
  File "/usr/local/lib/python3.8/dist-packages/dbt/task/base.py", line 314, in compile_and_execute
    result = self.run(ctx.node, manifest)
  File "/usr/local/lib/python3.8/dist-packages/dbt/task/base.py", line 403, in run
    return self.execute(compiled_node, manifest)
  File "/usr/local/lib/python3.8/dist-packages/dbt_rpc/rpc/node_runners.py", line 90, in execute
    _, execute_result = self.adapter.execute(
  File "/usr/local/lib/python3.8/dist-packages/dbt/adapters/base/impl.py", line 225, in execute
    return self.connections.execute(
  File "/usr/local/lib/python3.8/dist-packages/dbt/adapters/sql/connections.py", line 127, in execute
    _, cursor = self.add_query(sql, auto_begin)
  File "/usr/local/lib/python3.8/dist-packages/dbt/adapters/snowflake/connections.py", line 433, in add_query
    connection, cursor = super().add_query(
  File "/usr/local/lib/python3.8/dist-packages/dbt/adapters/sql/connections.py", line 83, in add_query
    return connection, cursor
  File "/usr/lib/python3.8/contextlib.py", line 131, in __exit__
    self.gen.throw(type, value, traceback)
  File "/usr/local/lib/python3.8/dist-packages/dbt/adapters/snowflake/connections.py", line 223, in exception_handler
    raise DatabaseException(msg)
dbt.exceptions.DatabaseException: Database Error
  001003 (42000): SQL compilation error:
  syntax error line 9 at position 29 unexpected ','.
  syntax error line 9 at position 29 unexpected ','.
  syntax error line 9 at position 38 unexpected ')'.
2022-07-06 05:50:56.175882 (Thread-1): Got exception RPCException(10003, Database Error, {'type': 'DatabaseException', 'message': "Database Error in rpc request (from remote system)\n  001003 (42000): SQL compilation error:\n  syntax error line 9 at position 29 unexpected ','.\n  syntax error line 9 at position 29 unexpected ','.\n  syntax error line 9 at position 38 unexpected ')'.", 'raw_sql': "select user_id, email_domain from \r\n(select user_id,{{get_domain_from_email(properties_email)}} as email_domain, row_number() over(partition by user_id order by timestamp desc) as rn from \r\n{{ source('ecommerce', 'identifies') }} where timestamp >= '{{ var('start_date') }}' and timestamp <= '{{ var('end_date') }}'\r\nand properties_email is not null and properties_email != '') where rn = 1\nlimit 500\n/* limit added automatically by dbt cloud */", 'compiled_sql': "select user_id, email_domain from \n(select user_id,\n  case\n         when\n            lower() like any ('@gmail.com', '@rudderstack.com') \n         then\n            lower()\n         else\n            lower(split_part(, '@', 2)) \n      end\n as email_domain, row_number() over(partition by user_id order by timestamp desc) as rn from \nanalytics_db.data_apps_simulated.identifies where timestamp >= '2021-05-01' and timestamp <= '2022-06-29'\nand properties_email is not null and properties_email != '') where rn = 1\nlimit 500\n/* limit added automatically by dbt cloud */", 'tags': None}, None)
Traceback (most recent call last):
  File "/usr/local/lib/python3.8/dist-packages/dbt_rpc/task/sql_commands.py", line 147, in _in_thread
    self.node_results.append(runner.safe_run(self.manifest))
  File "/usr/local/lib/python3.8/dist-packages/dbt/task/base.py", line 377, in safe_run
    result = self.error_result(ctx.node, error, started, [])
  File "/usr/local/lib/python3.8/dist-packages/dbt_rpc/rpc/node_runners.py", line 56, in error_result
    raise error
dbt_rpc.rpc.error.RPCException: RPCException(10003, Database Error, {'type': 'DatabaseException', 'message': "Database Error in rpc request (from remote system)\n  001003 (42000): SQL compilation error:\n  syntax error line 9 at position 29 unexpected ','.\n  syntax error line 9 at position 29 unexpected ','.\n  syntax error line 9 at position 38 unexpected ')'.", 'raw_sql': "select user_id, email_domain from \r\n(select user_id,{{get_domain_from_email(properties_email)}} as email_domain, row_number() over(partition by user_id order by timestamp desc) as rn from \r\n{{ source('ecommerce', 'identifies') }} where timestamp >= '{{ var('start_date') }}' and timestamp <= '{{ var('end_date') }}'\r\nand properties_email is not null and properties_email != '') where rn = 1\nlimit 500\n/* limit added automatically by dbt cloud */", 'compiled_sql': "select user_id, email_domain from \n(select user_id,\n  case\n         when\n            lower() like any ('@gmail.com', '@rudderstack.com') \n         then\n            lower()\n         else\n            lower(split_part(, '@', 2)) \n      end\n as email_domain, row_number() over(partition by user_id order by timestamp desc) as rn from \nanalytics_db.data_apps_simulated.identifies where timestamp >= '2021-05-01' and timestamp <= '2022-06-29'\nand properties_email is not null and properties_email != '') where rn = 1\nlimit 500\n/* limit added automatically by dbt cloud */", 'tags': None}, None)
2022-07-06 05:50:57.039722 (Thread-110): handling poll request
2022-07-06 05:50:57.040144 (Thread-110): 05:50:57  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '659b7287-63c6-4870-93d6-1d76e1b93300', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f688010da60>]}
2022-07-06 05:50:57.040778 (Thread-110): sending response (<Response 13810 bytes [200 OK]>) to 10.0.38.61
2022-07-06 05:51:07.588802 (Thread-111): handling status request
2022-07-06 05:51:07.589274 (Thread-111): 05:51:07  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '659b7287-63c6-4870-93d6-1d76e1b93300', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f688010d700>]}
2022-07-06 05:51:07.590583 (Thread-111): sending response (<Response 25166 bytes [200 OK]>) to 10.0.38.61
2022-07-06 05:51:08.082801 (Thread-112): handling compile_sql request
2022-07-06 05:51:08.083215 (Thread-112): 05:51:08  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '659b7287-63c6-4870-93d6-1d76e1b93300', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f688010d520>]}
2022-07-06 05:51:10.516840 (Thread-112): sending response (<Response 139 bytes [200 OK]>) to 10.0.38.61
2022-07-06 05:51:10.544946 (MainThread): 05:51:10  Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'be354b09-c593-46ab-a692-ca39c969fba6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff9e3e7bf10>]}
2022-07-06 05:51:10.545579 (MainThread): 05:51:10  Found 16 models, 0 tests, 0 snapshots, 0 analyses, 180 macros, 0 operations, 0 seed files, 15 sources, 0 exposures, 0 metrics
2022-07-06 05:51:10.546197 (Thread-1): 05:51:10  Acquiring new snowflake connection "rpc.ecommerce_data_model_dbt.request"
2022-07-06 05:51:10.546331 (Thread-1): 05:51:10  Began compiling node rpc.ecommerce_data_model_dbt.request
2022-07-06 05:51:10.546423 (Thread-1): 05:51:10  Compiling rpc.ecommerce_data_model_dbt.request
2022-07-06 05:51:10.549446 (Thread-1): 05:51:10  finished collecting timing info
2022-07-06 05:51:10.549580 (Thread-1): 05:51:10  Began executing node rpc.ecommerce_data_model_dbt.request
2022-07-06 05:51:10.549678 (Thread-1): 05:51:10  finished collecting timing info
2022-07-06 05:51:10.879292 (Thread-113): handling poll request
2022-07-06 05:51:10.879771 (Thread-113): 05:51:10  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '659b7287-63c6-4870-93d6-1d76e1b93300', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f688010d9d0>]}
2022-07-06 05:51:10.880935 (Thread-113): sending response (<Response 7159 bytes [200 OK]>) to 10.0.38.61
2022-07-06 05:59:29.159022 (Thread-114): handling status request
2022-07-06 05:59:29.161516 (Thread-114): 05:59:29  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '659b7287-63c6-4870-93d6-1d76e1b93300', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f688010dd90>]}
2022-07-06 05:59:29.162919 (Thread-114): sending response (<Response 25166 bytes [200 OK]>) to 10.0.38.61
2022-07-06 05:59:29.534990 (Thread-115): handling run_sql request
2022-07-06 05:59:29.535412 (Thread-115): 05:59:29  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '659b7287-63c6-4870-93d6-1d76e1b93300', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6880179220>]}
2022-07-06 05:59:31.959907 (Thread-115): sending response (<Response 139 bytes [200 OK]>) to 10.0.38.61
2022-07-06 05:59:31.985667 (MainThread): 05:59:31  Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '627015a0-f152-4185-9232-01b7513a87ff', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb6d3e86af0>]}
2022-07-06 05:59:31.986388 (MainThread): 05:59:31  Found 16 models, 0 tests, 0 snapshots, 0 analyses, 180 macros, 0 operations, 0 seed files, 15 sources, 0 exposures, 0 metrics
2022-07-06 05:59:31.987017 (Thread-1): 05:59:31  Acquiring new snowflake connection "rpc.ecommerce_data_model_dbt.request"
2022-07-06 05:59:31.987157 (Thread-1): 05:59:31  Began compiling node rpc.ecommerce_data_model_dbt.request
2022-07-06 05:59:31.987257 (Thread-1): 05:59:31  Compiling rpc.ecommerce_data_model_dbt.request
2022-07-06 05:59:31.988467 (Thread-1): 05:59:31  finished collecting timing info
2022-07-06 05:59:31.988596 (Thread-1): 05:59:31  Began executing node rpc.ecommerce_data_model_dbt.request
2022-07-06 05:59:31.989422 (Thread-1): 05:59:31  Using snowflake connection "rpc.ecommerce_data_model_dbt.request"
2022-07-06 05:59:31.989523 (Thread-1): 05:59:31  On rpc.ecommerce_data_model_dbt.request: select user_id, first_value(country) 
over(partition by user_id order by case when country is not null and country != '' then 2 else 1 end desc, timestamp desc) as country
limit 500
/* limit added automatically by dbt cloud */
2022-07-06 05:59:31.989608 (Thread-1): 05:59:31  Opening a new connection, currently in state init
2022-07-06 05:59:32.347885 (Thread-116): handling poll request
2022-07-06 05:59:32.348364 (Thread-116): 05:59:32  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '659b7287-63c6-4870-93d6-1d76e1b93300', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f68801326d0>]}
2022-07-06 05:59:32.349324 (Thread-116): sending response (<Response 3960 bytes [200 OK]>) to 10.0.38.61
2022-07-06 05:59:32.708478 (Thread-1): 05:59:32  Snowflake adapter: Snowflake query id: 01a56b47-0602-3316-0019-820304696e66
2022-07-06 05:59:32.708692 (Thread-1): 05:59:32  Snowflake adapter: Snowflake error: 000904 (42000): SQL compilation error: error line 1 at position 7
invalid identifier 'USER_ID'
2022-07-06 05:59:32.708868 (Thread-1): 05:59:32  finished collecting timing info
2022-07-06 05:59:32.709069 (Thread-1): 05:59:32  On rpc.ecommerce_data_model_dbt.request: Close
2022-07-06 05:59:32.787084 (Thread-1): Got an exception: Database Error
  000904 (42000): SQL compilation error: error line 1 at position 7
  invalid identifier 'USER_ID'
Traceback (most recent call last):
  File "/usr/local/lib/python3.8/dist-packages/dbt/adapters/snowflake/connections.py", line 206, in exception_handler
    yield
  File "/usr/local/lib/python3.8/dist-packages/dbt/adapters/sql/connections.py", line 74, in add_query
    cursor.execute(sql, bindings)
  File "/usr/local/lib/python3.8/dist-packages/snowflake/connector/cursor.py", line 721, in execute
    Error.errorhandler_wrapper(
  File "/usr/local/lib/python3.8/dist-packages/snowflake/connector/errors.py", line 258, in errorhandler_wrapper
    cursor.errorhandler(connection, cursor, error_class, error_value)
  File "/usr/local/lib/python3.8/dist-packages/snowflake/connector/errors.py", line 188, in default_errorhandler
    raise error_class(
snowflake.connector.errors.ProgrammingError: 000904 (42000): SQL compilation error: error line 1 at position 7
invalid identifier 'USER_ID'

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/usr/local/lib/python3.8/dist-packages/dbt/task/base.py", line 361, in safe_run
    result = self.compile_and_execute(manifest, ctx)
  File "/usr/local/lib/python3.8/dist-packages/dbt/task/base.py", line 314, in compile_and_execute
    result = self.run(ctx.node, manifest)
  File "/usr/local/lib/python3.8/dist-packages/dbt/task/base.py", line 403, in run
    return self.execute(compiled_node, manifest)
  File "/usr/local/lib/python3.8/dist-packages/dbt_rpc/rpc/node_runners.py", line 90, in execute
    _, execute_result = self.adapter.execute(
  File "/usr/local/lib/python3.8/dist-packages/dbt/adapters/base/impl.py", line 225, in execute
    return self.connections.execute(
  File "/usr/local/lib/python3.8/dist-packages/dbt/adapters/sql/connections.py", line 127, in execute
    _, cursor = self.add_query(sql, auto_begin)
  File "/usr/local/lib/python3.8/dist-packages/dbt/adapters/snowflake/connections.py", line 433, in add_query
    connection, cursor = super().add_query(
  File "/usr/local/lib/python3.8/dist-packages/dbt/adapters/sql/connections.py", line 83, in add_query
    return connection, cursor
  File "/usr/lib/python3.8/contextlib.py", line 131, in __exit__
    self.gen.throw(type, value, traceback)
  File "/usr/local/lib/python3.8/dist-packages/dbt/adapters/snowflake/connections.py", line 223, in exception_handler
    raise DatabaseException(msg)
dbt.exceptions.DatabaseException: Database Error
  000904 (42000): SQL compilation error: error line 1 at position 7
  invalid identifier 'USER_ID'
2022-07-06 05:59:32.788033 (Thread-1): Got exception RPCException(10003, Database Error, {'type': 'DatabaseException', 'message': "Database Error in rpc request (from remote system)\n  000904 (42000): SQL compilation error: error line 1 at position 7\n  invalid identifier 'USER_ID'", 'raw_sql': "select user_id, first_value(country) \r\nover(partition by user_id order by case when country is not null and country != '' then 2 else 1 end desc, timestamp desc) as country\nlimit 500\n/* limit added automatically by dbt cloud */", 'compiled_sql': "select user_id, first_value(country) \r\nover(partition by user_id order by case when country is not null and country != '' then 2 else 1 end desc, timestamp desc) as country\nlimit 500\n/* limit added automatically by dbt cloud */", 'tags': None}, None)
Traceback (most recent call last):
  File "/usr/local/lib/python3.8/dist-packages/dbt_rpc/task/sql_commands.py", line 147, in _in_thread
    self.node_results.append(runner.safe_run(self.manifest))
  File "/usr/local/lib/python3.8/dist-packages/dbt/task/base.py", line 377, in safe_run
    result = self.error_result(ctx.node, error, started, [])
  File "/usr/local/lib/python3.8/dist-packages/dbt_rpc/rpc/node_runners.py", line 56, in error_result
    raise error
dbt_rpc.rpc.error.RPCException: RPCException(10003, Database Error, {'type': 'DatabaseException', 'message': "Database Error in rpc request (from remote system)\n  000904 (42000): SQL compilation error: error line 1 at position 7\n  invalid identifier 'USER_ID'", 'raw_sql': "select user_id, first_value(country) \r\nover(partition by user_id order by case when country is not null and country != '' then 2 else 1 end desc, timestamp desc) as country\nlimit 500\n/* limit added automatically by dbt cloud */", 'compiled_sql': "select user_id, first_value(country) \r\nover(partition by user_id order by case when country is not null and country != '' then 2 else 1 end desc, timestamp desc) as country\nlimit 500\n/* limit added automatically by dbt cloud */", 'tags': None}, None)
2022-07-06 05:59:33.756657 (Thread-117): handling poll request
2022-07-06 05:59:33.757128 (Thread-117): 05:59:33  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '659b7287-63c6-4870-93d6-1d76e1b93300', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6880132820>]}
2022-07-06 05:59:33.757768 (Thread-117): sending response (<Response 11002 bytes [200 OK]>) to 10.0.38.61
2022-07-06 06:02:25.417150 (Thread-118): handling status request
2022-07-06 06:02:25.419694 (Thread-118): 06:02:25  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '659b7287-63c6-4870-93d6-1d76e1b93300', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f68801321f0>]}
2022-07-06 06:02:25.421127 (Thread-118): sending response (<Response 25166 bytes [200 OK]>) to 10.0.38.61
2022-07-06 06:02:25.792882 (Thread-119): handling run_sql request
2022-07-06 06:02:25.793314 (Thread-119): 06:02:25  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '659b7287-63c6-4870-93d6-1d76e1b93300', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f68800f82e0>]}
2022-07-06 06:02:28.219870 (Thread-119): sending response (<Response 139 bytes [200 OK]>) to 10.0.38.61
2022-07-06 06:02:28.246359 (MainThread): 06:02:28  Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'a5683e05-f435-42a0-977e-26a3956f4e7c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbb6fd70f70>]}
2022-07-06 06:02:28.246956 (MainThread): 06:02:28  Found 16 models, 0 tests, 0 snapshots, 0 analyses, 180 macros, 0 operations, 0 seed files, 15 sources, 0 exposures, 0 metrics
2022-07-06 06:02:28.247578 (Thread-1): 06:02:28  Acquiring new snowflake connection "rpc.ecommerce_data_model_dbt.request"
2022-07-06 06:02:28.247710 (Thread-1): 06:02:28  Began compiling node rpc.ecommerce_data_model_dbt.request
2022-07-06 06:02:28.247804 (Thread-1): 06:02:28  Compiling rpc.ecommerce_data_model_dbt.request
2022-07-06 06:02:28.250483 (Thread-1): 06:02:28  finished collecting timing info
2022-07-06 06:02:28.250616 (Thread-1): 06:02:28  Began executing node rpc.ecommerce_data_model_dbt.request
2022-07-06 06:02:28.251457 (Thread-1): 06:02:28  Using snowflake connection "rpc.ecommerce_data_model_dbt.request"
2022-07-06 06:02:28.251551 (Thread-1): 06:02:28  On rpc.ecommerce_data_model_dbt.request: select user_id, first_value(properties_country)
over(partition by user_id order by case when properties_country is not null and properties_country != '' then 2 else 1 end desc, timestamp desc) as country
from analytics_db.data_apps_simulated.identifies where timestamp >= '2021-05-01' and timestamp <= '2022-06-29'
limit 500
/* limit added automatically by dbt cloud */
2022-07-06 06:02:28.251635 (Thread-1): 06:02:28  Opening a new connection, currently in state init
2022-07-06 06:02:28.641570 (Thread-120): handling poll request
2022-07-06 06:02:28.642032 (Thread-120): 06:02:28  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '659b7287-63c6-4870-93d6-1d76e1b93300', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6880145c40>]}
2022-07-06 06:02:28.642874 (Thread-120): sending response (<Response 4102 bytes [200 OK]>) to 10.0.38.61
2022-07-06 06:02:30.042607 (Thread-121): handling poll request
2022-07-06 06:02:30.043007 (Thread-121): 06:02:30  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '659b7287-63c6-4870-93d6-1d76e1b93300', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6880145f10>]}
2022-07-06 06:02:30.043503 (Thread-121): sending response (<Response 403 bytes [200 OK]>) to 10.0.38.61
2022-07-06 06:02:31.437983 (Thread-122): handling poll request
2022-07-06 06:02:31.438382 (Thread-122): 06:02:31  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '659b7287-63c6-4870-93d6-1d76e1b93300', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6880145df0>]}
2022-07-06 06:02:31.439276 (Thread-122): sending response (<Response 403 bytes [200 OK]>) to 10.0.38.61
2022-07-06 06:02:32.839429 (Thread-123): handling poll request
2022-07-06 06:02:32.839850 (Thread-123): 06:02:32  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '659b7287-63c6-4870-93d6-1d76e1b93300', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f688012bb50>]}
2022-07-06 06:02:32.840353 (Thread-123): sending response (<Response 403 bytes [200 OK]>) to 10.0.38.61
2022-07-06 06:02:33.638066 (Thread-1): 06:02:33  SQL status: SUCCESS 8 in 5.39 seconds
2022-07-06 06:02:33.639606 (Thread-1): 06:02:33  finished collecting timing info
2022-07-06 06:02:33.639809 (Thread-1): 06:02:33  On rpc.ecommerce_data_model_dbt.request: Close
2022-07-06 06:02:34.228403 (Thread-124): handling poll request
2022-07-06 06:02:34.228878 (Thread-124): 06:02:34  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '659b7287-63c6-4870-93d6-1d76e1b93300', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6880145af0>]}
2022-07-06 06:02:34.229440 (Thread-124): sending response (<Response 1388 bytes [200 OK]>) to 10.0.38.61
2022-07-06 06:02:35.608531 (Thread-125): handling poll request
2022-07-06 06:02:35.609023 (Thread-125): 06:02:35  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '659b7287-63c6-4870-93d6-1d76e1b93300', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6880145220>]}
2022-07-06 06:02:35.609894 (Thread-125): sending response (<Response 3916 bytes [200 OK]>) to 10.0.38.61
2022-07-06 06:02:49.241178 (Thread-126): handling status request
2022-07-06 06:02:49.241615 (Thread-126): 06:02:49  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '659b7287-63c6-4870-93d6-1d76e1b93300', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f68800f8970>]}
2022-07-06 06:02:49.242957 (Thread-126): sending response (<Response 25166 bytes [200 OK]>) to 10.0.38.61
2022-07-06 06:02:49.626053 (Thread-127): handling run_sql request
2022-07-06 06:02:49.626457 (Thread-127): 06:02:49  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '659b7287-63c6-4870-93d6-1d76e1b93300', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f688016d3d0>]}
2022-07-06 06:02:52.039243 (Thread-127): sending response (<Response 139 bytes [200 OK]>) to 10.0.38.61
2022-07-06 06:02:52.065235 (MainThread): 06:02:52  Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '0caa1d89-b308-48d2-9eb6-7841451d464e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2eb7ef5f40>]}
2022-07-06 06:02:52.065859 (MainThread): 06:02:52  Found 16 models, 0 tests, 0 snapshots, 0 analyses, 180 macros, 0 operations, 0 seed files, 15 sources, 0 exposures, 0 metrics
2022-07-06 06:02:52.066530 (Thread-1): 06:02:52  Acquiring new snowflake connection "rpc.ecommerce_data_model_dbt.request"
2022-07-06 06:02:52.066664 (Thread-1): 06:02:52  Began compiling node rpc.ecommerce_data_model_dbt.request
2022-07-06 06:02:52.066760 (Thread-1): 06:02:52  Compiling rpc.ecommerce_data_model_dbt.request
2022-07-06 06:02:52.069683 (Thread-1): 06:02:52  finished collecting timing info
2022-07-06 06:02:52.069827 (Thread-1): 06:02:52  Began executing node rpc.ecommerce_data_model_dbt.request
2022-07-06 06:02:52.070646 (Thread-1): 06:02:52  Using snowflake connection "rpc.ecommerce_data_model_dbt.request"
2022-07-06 06:02:52.070737 (Thread-1): 06:02:52  On rpc.ecommerce_data_model_dbt.request: select distinct user_id, first_value(properties_country)
over(partition by user_id order by case when properties_country is not null and properties_country != '' then 2 else 1 end desc, timestamp desc) as country
from analytics_db.data_apps_simulated.identifies where timestamp >= '2021-05-01' and timestamp <= '2022-06-29'
limit 500
/* limit added automatically by dbt cloud */
2022-07-06 06:02:52.070820 (Thread-1): 06:02:52  Opening a new connection, currently in state init
2022-07-06 06:02:52.429285 (Thread-128): handling poll request
2022-07-06 06:02:52.429798 (Thread-128): 06:02:52  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '659b7287-63c6-4870-93d6-1d76e1b93300', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f68801742b0>]}
2022-07-06 06:02:52.430689 (Thread-128): sending response (<Response 4111 bytes [200 OK]>) to 10.0.38.61
2022-07-06 06:02:52.970482 (Thread-1): 06:02:52  SQL status: SUCCESS 6 in 0.9 seconds
2022-07-06 06:02:52.971921 (Thread-1): 06:02:52  finished collecting timing info
2022-07-06 06:02:52.972106 (Thread-1): 06:02:52  On rpc.ecommerce_data_model_dbt.request: Close
2022-07-06 06:02:53.804213 (Thread-129): handling poll request
2022-07-06 06:02:53.804615 (Thread-129): 06:02:53  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '659b7287-63c6-4870-93d6-1d76e1b93300', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6880323040>]}
2022-07-06 06:02:53.805512 (Thread-129): sending response (<Response 4897 bytes [200 OK]>) to 10.0.38.61
2022-07-06 06:07:49.961609 (Thread-130): 06:07:49  Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
2022-07-06 06:07:49.963976 (Thread-130): 06:07:49  Partial parsing: updated file: ecommerce_data_model_dbt://models/data_model/temp_folder/country.sql
2022-07-06 06:07:49.968313 (Thread-130): 06:07:49  1603: static parser failed on data_model/temp_folder/country.sql
2022-07-06 06:07:49.972541 (Thread-130): 06:07:49  1602: parser fallback to jinja rendering on data_model/temp_folder/country.sql
2022-07-06 06:07:50.023597 (Thread-130): 06:07:50  [WARNING]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.data-apps-ecommerce-template.data_model

2022-07-06 06:07:50.029602 (Thread-130): 06:07:50  Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '659b7287-63c6-4870-93d6-1d76e1b93300', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f68785b1460>]}
2022-07-06 06:07:50.611238 (Thread-131): handling status request
2022-07-06 06:07:50.611663 (Thread-131): 06:07:50  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '659b7287-63c6-4870-93d6-1d76e1b93300', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f687858ad00>]}
2022-07-06 06:07:50.612194 (Thread-131): sending response (<Response 2369 bytes [200 OK]>) to 10.0.38.61
2022-07-06 06:07:50.657302 (Thread-132): handling status request
2022-07-06 06:07:50.657693 (Thread-132): 06:07:50  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '659b7287-63c6-4870-93d6-1d76e1b93300', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f68802175e0>]}
2022-07-06 06:07:50.658170 (Thread-132): sending response (<Response 2369 bytes [200 OK]>) to 10.0.38.61
2022-07-06 06:07:57.028118 (Thread-133): handling status request
2022-07-06 06:07:57.028529 (Thread-133): 06:07:57  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '659b7287-63c6-4870-93d6-1d76e1b93300', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f687858af40>]}
2022-07-06 06:07:57.029057 (Thread-133): sending response (<Response 2369 bytes [200 OK]>) to 10.0.38.61
2022-07-06 06:07:57.407592 (Thread-134): handling run_sql request
2022-07-06 06:07:57.407997 (Thread-134): 06:07:57  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '659b7287-63c6-4870-93d6-1d76e1b93300', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f687858ad60>]}
2022-07-06 06:07:59.848109 (Thread-134): sending response (<Response 139 bytes [200 OK]>) to 10.0.38.61
2022-07-06 06:07:59.875161 (MainThread): 06:07:59  Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '7ff265c2-020e-4800-a37f-06192d88d68b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3295c81b80>]}
2022-07-06 06:07:59.875792 (MainThread): 06:07:59  Found 16 models, 0 tests, 0 snapshots, 0 analyses, 180 macros, 0 operations, 0 seed files, 15 sources, 0 exposures, 0 metrics
2022-07-06 06:07:59.876444 (Thread-1): 06:07:59  Acquiring new snowflake connection "rpc.ecommerce_data_model_dbt.request"
2022-07-06 06:07:59.876581 (Thread-1): 06:07:59  Began compiling node rpc.ecommerce_data_model_dbt.request
2022-07-06 06:07:59.876683 (Thread-1): 06:07:59  Compiling rpc.ecommerce_data_model_dbt.request
2022-07-06 06:07:59.879647 (Thread-1): 06:07:59  finished collecting timing info
2022-07-06 06:07:59.879800 (Thread-1): 06:07:59  Began executing node rpc.ecommerce_data_model_dbt.request
2022-07-06 06:07:59.880812 (Thread-1): 06:07:59  Using snowflake connection "rpc.ecommerce_data_model_dbt.request"
2022-07-06 06:07:59.880904 (Thread-1): 06:07:59  On rpc.ecommerce_data_model_dbt.request: select distinct user_id, 
first_value(properties_country)
over(partition by user_id order by case when properties_country is not null and properties_country != '' then 2 else 1 end desc, timestamp desc) as country,
first_value(properties_state)
over(partition by user_id order by case when properties_state is not null and properties_state != '' then 2 else 1 end desc, timestamp desc) as state
from analytics_db.data_apps_simulated.identifies where timestamp >= '2021-05-01' and timestamp <= '2022-06-29'
limit 500
/* limit added automatically by dbt cloud */
2022-07-06 06:07:59.881019 (Thread-1): 06:07:59  Opening a new connection, currently in state init
2022-07-06 06:08:00.249856 (Thread-135): handling poll request
2022-07-06 06:08:00.250344 (Thread-135): 06:08:00  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '659b7287-63c6-4870-93d6-1d76e1b93300', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6880154430>]}
2022-07-06 06:08:00.251284 (Thread-135): sending response (<Response 4296 bytes [200 OK]>) to 10.0.38.61
2022-07-06 06:08:01.594654 (Thread-1): 06:08:01  SQL status: SUCCESS 6 in 1.71 seconds
2022-07-06 06:08:01.596115 (Thread-1): 06:08:01  finished collecting timing info
2022-07-06 06:08:01.596304 (Thread-1): 06:08:01  On rpc.ecommerce_data_model_dbt.request: Close
2022-07-06 06:08:01.630578 (Thread-136): handling poll request
2022-07-06 06:08:01.631011 (Thread-136): 06:08:01  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '659b7287-63c6-4870-93d6-1d76e1b93300', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6880323d60>]}
2022-07-06 06:08:01.631567 (Thread-136): sending response (<Response 1388 bytes [200 OK]>) to 10.0.38.61
2022-07-06 06:08:03.034833 (Thread-137): handling poll request
2022-07-06 06:08:03.035265 (Thread-137): 06:08:03  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '659b7287-63c6-4870-93d6-1d76e1b93300', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f68785b1a60>]}
2022-07-06 06:08:03.036169 (Thread-137): sending response (<Response 4740 bytes [200 OK]>) to 10.0.38.61
2022-07-06 06:08:41.819385 (Thread-138): 06:08:41  Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
2022-07-06 06:08:41.820068 (Thread-138): 06:08:41  Partial parsing: updated file: ecommerce_data_model_dbt://models/data_model/temp_folder/country.sql
2022-07-06 06:08:41.824373 (Thread-138): 06:08:41  1603: static parser failed on data_model/temp_folder/country.sql
2022-07-06 06:08:41.828623 (Thread-138): 06:08:41  1602: parser fallback to jinja rendering on data_model/temp_folder/country.sql
2022-07-06 06:08:41.865102 (Thread-138): 06:08:41  [WARNING]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.data-apps-ecommerce-template.data_model

2022-07-06 06:08:41.870950 (Thread-138): 06:08:41  Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '659b7287-63c6-4870-93d6-1d76e1b93300', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f68784f4880>]}
2022-07-06 06:08:42.552055 (Thread-139): handling status request
2022-07-06 06:08:42.552478 (Thread-139): 06:08:42  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '659b7287-63c6-4870-93d6-1d76e1b93300', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f68785a0a60>]}
2022-07-06 06:08:42.553044 (Thread-139): sending response (<Response 2369 bytes [200 OK]>) to 10.0.38.61
2022-07-06 06:08:42.622024 (Thread-140): handling status request
2022-07-06 06:08:42.622431 (Thread-140): 06:08:42  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '659b7287-63c6-4870-93d6-1d76e1b93300', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f68785a0850>]}
2022-07-06 06:08:42.622923 (Thread-140): sending response (<Response 2369 bytes [200 OK]>) to 10.0.38.61
2022-07-06 06:08:43.014793 (Thread-141): handling status request
2022-07-06 06:08:43.015293 (Thread-141): 06:08:43  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '659b7287-63c6-4870-93d6-1d76e1b93300', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6880145e80>]}
2022-07-06 06:08:43.015824 (Thread-141): sending response (<Response 2369 bytes [200 OK]>) to 10.0.38.61
2022-07-06 06:08:43.415565 (Thread-142): handling run_sql request
2022-07-06 06:08:43.415972 (Thread-142): 06:08:43  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '659b7287-63c6-4870-93d6-1d76e1b93300', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f68785a0490>]}
2022-07-06 06:08:45.861162 (Thread-142): sending response (<Response 139 bytes [200 OK]>) to 10.0.38.61
2022-07-06 06:08:45.887993 (MainThread): 06:08:45  Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '83d2082e-d1f9-45fb-8e68-51d864ee7d74', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f70156aea00>]}
2022-07-06 06:08:45.888631 (MainThread): 06:08:45  Found 16 models, 0 tests, 0 snapshots, 0 analyses, 180 macros, 0 operations, 0 seed files, 15 sources, 0 exposures, 0 metrics
2022-07-06 06:08:45.889305 (Thread-1): 06:08:45  Acquiring new snowflake connection "rpc.ecommerce_data_model_dbt.request"
2022-07-06 06:08:45.889444 (Thread-1): 06:08:45  Began compiling node rpc.ecommerce_data_model_dbt.request
2022-07-06 06:08:45.889541 (Thread-1): 06:08:45  Compiling rpc.ecommerce_data_model_dbt.request
2022-07-06 06:08:45.892368 (Thread-1): 06:08:45  finished collecting timing info
2022-07-06 06:08:45.892509 (Thread-1): 06:08:45  Began executing node rpc.ecommerce_data_model_dbt.request
2022-07-06 06:08:45.893578 (Thread-1): 06:08:45  Using snowflake connection "rpc.ecommerce_data_model_dbt.request"
2022-07-06 06:08:45.893675 (Thread-1): 06:08:45  On rpc.ecommerce_data_model_dbt.request: select distinct user_id, 
first_value(properties_country)
over(partition by user_id order by case when properties_country is not null and properties_country != '' then 2 else 1 end desc, timestamp desc) as country,
first_value(properties_state)
over(partition by user_id order by case when properties_state is not null and properties_state != '' then 2 else 1 end desc, timestamp desc) as state
from analytics_db.data_apps_simulated.identifies where timestamp >= '2021-05-01' and timestamp <= '2022-06-29'
where user_id is not null
limit 500
/* limit added automatically by dbt cloud */
2022-07-06 06:08:45.893762 (Thread-1): 06:08:45  Opening a new connection, currently in state init
2022-07-06 06:08:46.262550 (Thread-143): handling poll request
2022-07-06 06:08:46.263042 (Thread-143): 06:08:46  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '659b7287-63c6-4870-93d6-1d76e1b93300', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f68784c5820>]}
2022-07-06 06:08:46.263928 (Thread-143): sending response (<Response 4323 bytes [200 OK]>) to 10.0.38.61
2022-07-06 06:08:46.622125 (Thread-1): 06:08:46  Snowflake adapter: Snowflake query id: 01a56b50-0602-3374-0019-82030469974a
2022-07-06 06:08:46.622323 (Thread-1): 06:08:46  Snowflake adapter: Snowflake error: 001003 (42000): SQL compilation error:
syntax error line 7 at position 0 unexpected 'where'.
2022-07-06 06:08:46.622495 (Thread-1): 06:08:46  finished collecting timing info
2022-07-06 06:08:46.622657 (Thread-1): 06:08:46  On rpc.ecommerce_data_model_dbt.request: Close
2022-07-06 06:08:46.717304 (Thread-1): Got an exception: Database Error
  001003 (42000): SQL compilation error:
  syntax error line 7 at position 0 unexpected 'where'.
Traceback (most recent call last):
  File "/usr/local/lib/python3.8/dist-packages/dbt/adapters/snowflake/connections.py", line 206, in exception_handler
    yield
  File "/usr/local/lib/python3.8/dist-packages/dbt/adapters/sql/connections.py", line 74, in add_query
    cursor.execute(sql, bindings)
  File "/usr/local/lib/python3.8/dist-packages/snowflake/connector/cursor.py", line 721, in execute
    Error.errorhandler_wrapper(
  File "/usr/local/lib/python3.8/dist-packages/snowflake/connector/errors.py", line 258, in errorhandler_wrapper
    cursor.errorhandler(connection, cursor, error_class, error_value)
  File "/usr/local/lib/python3.8/dist-packages/snowflake/connector/errors.py", line 188, in default_errorhandler
    raise error_class(
snowflake.connector.errors.ProgrammingError: 001003 (42000): SQL compilation error:
syntax error line 7 at position 0 unexpected 'where'.

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/usr/local/lib/python3.8/dist-packages/dbt/task/base.py", line 361, in safe_run
    result = self.compile_and_execute(manifest, ctx)
  File "/usr/local/lib/python3.8/dist-packages/dbt/task/base.py", line 314, in compile_and_execute
    result = self.run(ctx.node, manifest)
  File "/usr/local/lib/python3.8/dist-packages/dbt/task/base.py", line 403, in run
    return self.execute(compiled_node, manifest)
  File "/usr/local/lib/python3.8/dist-packages/dbt_rpc/rpc/node_runners.py", line 90, in execute
    _, execute_result = self.adapter.execute(
  File "/usr/local/lib/python3.8/dist-packages/dbt/adapters/base/impl.py", line 225, in execute
    return self.connections.execute(
  File "/usr/local/lib/python3.8/dist-packages/dbt/adapters/sql/connections.py", line 127, in execute
    _, cursor = self.add_query(sql, auto_begin)
  File "/usr/local/lib/python3.8/dist-packages/dbt/adapters/snowflake/connections.py", line 433, in add_query
    connection, cursor = super().add_query(
  File "/usr/local/lib/python3.8/dist-packages/dbt/adapters/sql/connections.py", line 83, in add_query
    return connection, cursor
  File "/usr/lib/python3.8/contextlib.py", line 131, in __exit__
    self.gen.throw(type, value, traceback)
  File "/usr/local/lib/python3.8/dist-packages/dbt/adapters/snowflake/connections.py", line 223, in exception_handler
    raise DatabaseException(msg)
dbt.exceptions.DatabaseException: Database Error
  001003 (42000): SQL compilation error:
  syntax error line 7 at position 0 unexpected 'where'.
2022-07-06 06:08:46.718311 (Thread-1): Got exception RPCException(10003, Database Error, {'type': 'DatabaseException', 'message': "Database Error in rpc request (from remote system)\n  001003 (42000): SQL compilation error:\n  syntax error line 7 at position 0 unexpected 'where'.", 'raw_sql': "select distinct user_id, \r\nfirst_value(properties_country)\r\nover(partition by user_id order by case when properties_country is not null and properties_country != '' then 2 else 1 end desc, timestamp desc) as country,\r\nfirst_value(properties_state)\r\nover(partition by user_id order by case when properties_state is not null and properties_state != '' then 2 else 1 end desc, timestamp desc) as state\r\nfrom {{ source('ecommerce', 'identifies') }} where timestamp >= '{{ var('start_date') }}' and timestamp <= '{{ var('end_date') }}'\r\nwhere user_id is not null\nlimit 500\n/* limit added automatically by dbt cloud */", 'compiled_sql': "select distinct user_id, \nfirst_value(properties_country)\nover(partition by user_id order by case when properties_country is not null and properties_country != '' then 2 else 1 end desc, timestamp desc) as country,\nfirst_value(properties_state)\nover(partition by user_id order by case when properties_state is not null and properties_state != '' then 2 else 1 end desc, timestamp desc) as state\nfrom analytics_db.data_apps_simulated.identifies where timestamp >= '2021-05-01' and timestamp <= '2022-06-29'\nwhere user_id is not null\nlimit 500\n/* limit added automatically by dbt cloud */", 'tags': None}, None)
Traceback (most recent call last):
  File "/usr/local/lib/python3.8/dist-packages/dbt_rpc/task/sql_commands.py", line 147, in _in_thread
    self.node_results.append(runner.safe_run(self.manifest))
  File "/usr/local/lib/python3.8/dist-packages/dbt/task/base.py", line 377, in safe_run
    result = self.error_result(ctx.node, error, started, [])
  File "/usr/local/lib/python3.8/dist-packages/dbt_rpc/rpc/node_runners.py", line 56, in error_result
    raise error
dbt_rpc.rpc.error.RPCException: RPCException(10003, Database Error, {'type': 'DatabaseException', 'message': "Database Error in rpc request (from remote system)\n  001003 (42000): SQL compilation error:\n  syntax error line 7 at position 0 unexpected 'where'.", 'raw_sql': "select distinct user_id, \r\nfirst_value(properties_country)\r\nover(partition by user_id order by case when properties_country is not null and properties_country != '' then 2 else 1 end desc, timestamp desc) as country,\r\nfirst_value(properties_state)\r\nover(partition by user_id order by case when properties_state is not null and properties_state != '' then 2 else 1 end desc, timestamp desc) as state\r\nfrom {{ source('ecommerce', 'identifies') }} where timestamp >= '{{ var('start_date') }}' and timestamp <= '{{ var('end_date') }}'\r\nwhere user_id is not null\nlimit 500\n/* limit added automatically by dbt cloud */", 'compiled_sql': "select distinct user_id, \nfirst_value(properties_country)\nover(partition by user_id order by case when properties_country is not null and properties_country != '' then 2 else 1 end desc, timestamp desc) as country,\nfirst_value(properties_state)\nover(partition by user_id order by case when properties_state is not null and properties_state != '' then 2 else 1 end desc, timestamp desc) as state\nfrom analytics_db.data_apps_simulated.identifies where timestamp >= '2021-05-01' and timestamp <= '2022-06-29'\nwhere user_id is not null\nlimit 500\n/* limit added automatically by dbt cloud */", 'tags': None}, None)
2022-07-06 06:08:47.640512 (Thread-144): handling poll request
2022-07-06 06:08:47.640919 (Thread-144): 06:08:47  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '659b7287-63c6-4870-93d6-1d76e1b93300', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f68784c5430>]}
2022-07-06 06:08:47.641595 (Thread-144): sending response (<Response 13653 bytes [200 OK]>) to 10.0.38.61
2022-07-06 06:09:01.924437 (Thread-145): 06:09:01  Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
2022-07-06 06:09:01.925086 (Thread-145): 06:09:01  Partial parsing: updated file: ecommerce_data_model_dbt://models/data_model/temp_folder/country.sql
2022-07-06 06:09:01.929377 (Thread-145): 06:09:01  1603: static parser failed on data_model/temp_folder/country.sql
2022-07-06 06:09:01.933725 (Thread-145): 06:09:01  1602: parser fallback to jinja rendering on data_model/temp_folder/country.sql
2022-07-06 06:09:01.973267 (Thread-145): 06:09:01  [WARNING]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.data-apps-ecommerce-template.data_model

2022-07-06 06:09:01.979121 (Thread-145): 06:09:01  Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '659b7287-63c6-4870-93d6-1d76e1b93300', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f687842cf10>]}
2022-07-06 06:09:02.672459 (Thread-146): handling status request
2022-07-06 06:09:02.672916 (Thread-146): 06:09:02  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '659b7287-63c6-4870-93d6-1d76e1b93300', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f687844ad60>]}
2022-07-06 06:09:02.673648 (Thread-146): sending response (<Response 2369 bytes [200 OK]>) to 10.0.38.61
2022-07-06 06:09:02.879297 (Thread-147): handling status request
2022-07-06 06:09:02.879701 (Thread-147): 06:09:02  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '659b7287-63c6-4870-93d6-1d76e1b93300', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f687844ab80>]}
2022-07-06 06:09:02.880198 (Thread-147): sending response (<Response 2369 bytes [200 OK]>) to 10.0.38.61
2022-07-06 06:09:03.179649 (Thread-148): handling status request
2022-07-06 06:09:03.180081 (Thread-148): 06:09:03  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '659b7287-63c6-4870-93d6-1d76e1b93300', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f687844a6a0>]}
2022-07-06 06:09:03.180597 (Thread-148): sending response (<Response 2369 bytes [200 OK]>) to 10.0.38.61
2022-07-06 06:09:03.590454 (Thread-149): handling run_sql request
2022-07-06 06:09:03.590882 (Thread-149): 06:09:03  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '659b7287-63c6-4870-93d6-1d76e1b93300', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f687844a4c0>]}
2022-07-06 06:09:06.032708 (Thread-149): sending response (<Response 139 bytes [200 OK]>) to 10.0.38.61
2022-07-06 06:09:06.058612 (MainThread): 06:09:06  Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '8923852c-c52a-4be2-81e8-c74e856285b3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc831a2da00>]}
2022-07-06 06:09:06.059245 (MainThread): 06:09:06  Found 16 models, 0 tests, 0 snapshots, 0 analyses, 180 macros, 0 operations, 0 seed files, 15 sources, 0 exposures, 0 metrics
2022-07-06 06:09:06.059895 (Thread-1): 06:09:06  Acquiring new snowflake connection "rpc.ecommerce_data_model_dbt.request"
2022-07-06 06:09:06.060040 (Thread-1): 06:09:06  Began compiling node rpc.ecommerce_data_model_dbt.request
2022-07-06 06:09:06.060139 (Thread-1): 06:09:06  Compiling rpc.ecommerce_data_model_dbt.request
2022-07-06 06:09:06.063003 (Thread-1): 06:09:06  finished collecting timing info
2022-07-06 06:09:06.063149 (Thread-1): 06:09:06  Began executing node rpc.ecommerce_data_model_dbt.request
2022-07-06 06:09:06.064167 (Thread-1): 06:09:06  Using snowflake connection "rpc.ecommerce_data_model_dbt.request"
2022-07-06 06:09:06.064260 (Thread-1): 06:09:06  On rpc.ecommerce_data_model_dbt.request: select distinct user_id, 
first_value(properties_country)
over(partition by user_id order by case when properties_country is not null and properties_country != '' then 2 else 1 end desc, timestamp desc) as country,
first_value(properties_state)
over(partition by user_id order by case when properties_state is not null and properties_state != '' then 2 else 1 end desc, timestamp desc) as state
from analytics_db.data_apps_simulated.identifies where timestamp >= '2021-05-01' and timestamp <= '2022-06-29'
and user_id is not null
limit 500
/* limit added automatically by dbt cloud */
2022-07-06 06:09:06.064342 (Thread-1): 06:09:06  Opening a new connection, currently in state init
2022-07-06 06:09:06.443612 (Thread-150): handling poll request
2022-07-06 06:09:06.444121 (Thread-150): 06:09:06  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '659b7287-63c6-4870-93d6-1d76e1b93300', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f68784e1f10>]}
2022-07-06 06:09:06.445066 (Thread-150): sending response (<Response 4321 bytes [200 OK]>) to 10.0.38.61
2022-07-06 06:09:07.190421 (Thread-1): 06:09:07  SQL status: SUCCESS 5 in 1.13 seconds
2022-07-06 06:09:07.191882 (Thread-1): 06:09:07  finished collecting timing info
2022-07-06 06:09:07.192067 (Thread-1): 06:09:07  On rpc.ecommerce_data_model_dbt.request: Close
2022-07-06 06:09:07.823476 (Thread-151): handling poll request
2022-07-06 06:09:07.823878 (Thread-151): 06:09:07  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '659b7287-63c6-4870-93d6-1d76e1b93300', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f687843f460>]}
2022-07-06 06:09:07.824804 (Thread-151): sending response (<Response 5809 bytes [200 OK]>) to 10.0.38.61
2022-07-06 06:09:51.228718 (Thread-152): 06:09:51  Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
2022-07-06 06:09:51.229021 (Thread-152): 06:09:51  Partial parsing enabled, no changes found, skipping parsing
2022-07-06 06:09:51.229856 (Thread-152): 06:09:51  [WARNING]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.data-apps-ecommerce-template.data_model

2022-07-06 06:09:51.236592 (Thread-152): 06:09:51  Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '659b7287-63c6-4870-93d6-1d76e1b93300', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6878420b80>]}
2022-07-06 06:09:51.979000 (Thread-153): handling status request
2022-07-06 06:09:51.979452 (Thread-153): 06:09:51  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '659b7287-63c6-4870-93d6-1d76e1b93300', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f68783557c0>]}
2022-07-06 06:09:51.979991 (Thread-153): sending response (<Response 1703 bytes [200 OK]>) to 10.0.38.61
2022-07-06 06:09:52.017123 (Thread-154): handling status request
2022-07-06 06:09:52.017524 (Thread-154): 06:09:52  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '659b7287-63c6-4870-93d6-1d76e1b93300', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f68784f1880>]}
2022-07-06 06:09:52.018007 (Thread-154): sending response (<Response 1703 bytes [200 OK]>) to 10.0.38.61
2022-07-06 06:10:05.305918 (Thread-155): 06:10:05  Partial parsing enabled: 1 files deleted, 1 files added, 0 files changed.
2022-07-06 06:10:05.306436 (Thread-155): 06:10:05  Partial parsing: added file: ecommerce_data_model_dbt://models/data_model/temp_folder/country_and_state.sql
2022-07-06 06:10:05.306588 (Thread-155): 06:10:05  Partial parsing: deleted file: ecommerce_data_model_dbt://models/data_model/temp_folder/country.sql
2022-07-06 06:10:05.311337 (Thread-155): 06:10:05  1603: static parser failed on data_model/temp_folder/country_and_state.sql
2022-07-06 06:10:05.315379 (Thread-155): 06:10:05  1602: parser fallback to jinja rendering on data_model/temp_folder/country_and_state.sql
2022-07-06 06:10:05.354491 (Thread-155): 06:10:05  [WARNING]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.data-apps-ecommerce-template.data_model

2022-07-06 06:10:05.360481 (Thread-155): 06:10:05  Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '659b7287-63c6-4870-93d6-1d76e1b93300', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f68782b4490>]}
2022-07-06 06:10:06.029819 (Thread-156): handling status request
2022-07-06 06:10:06.030254 (Thread-156): 06:10:06  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '659b7287-63c6-4870-93d6-1d76e1b93300', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f68783552b0>]}
2022-07-06 06:10:06.030853 (Thread-156): sending response (<Response 2738 bytes [200 OK]>) to 10.0.38.61
2022-07-06 06:10:06.045456 (Thread-157): handling status request
2022-07-06 06:10:06.045865 (Thread-157): 06:10:06  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '659b7287-63c6-4870-93d6-1d76e1b93300', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f68783550d0>]}
2022-07-06 06:10:06.046375 (Thread-157): sending response (<Response 2738 bytes [200 OK]>) to 10.0.38.61
2022-07-06 06:10:38.200244 (Thread-158): 06:10:38  Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
2022-07-06 06:10:38.200467 (Thread-158): 06:10:38  Partial parsing enabled, no changes found, skipping parsing
2022-07-06 06:10:38.201166 (Thread-158): 06:10:38  [WARNING]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.data-apps-ecommerce-template.data_model

2022-07-06 06:10:38.206818 (Thread-158): 06:10:38  Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '659b7287-63c6-4870-93d6-1d76e1b93300', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6878399a60>]}
2022-07-06 06:10:38.959174 (Thread-159): handling status request
2022-07-06 06:10:38.959593 (Thread-159): 06:10:38  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '659b7287-63c6-4870-93d6-1d76e1b93300', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f68782ad3a0>]}
2022-07-06 06:10:38.960087 (Thread-159): sending response (<Response 1703 bytes [200 OK]>) to 10.0.38.61
2022-07-06 06:10:38.985979 (Thread-160): handling status request
2022-07-06 06:10:38.986376 (Thread-160): 06:10:38  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '659b7287-63c6-4870-93d6-1d76e1b93300', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f68782ad130>]}
2022-07-06 06:10:38.986846 (Thread-160): sending response (<Response 1703 bytes [200 OK]>) to 10.0.38.61
2022-07-06 06:11:04.768654 (Thread-161): 06:11:04  Partial parsing enabled: 0 files deleted, 1 files added, 0 files changed.
2022-07-06 06:11:04.769288 (Thread-161): 06:11:04  Partial parsing: added file: ecommerce_data_model_dbt://macros/get_age_from_dob.sql
2022-07-06 06:11:04.769511 (Thread-161): 06:11:04  Parsing macros/get_age_from_dob.sql
2022-07-06 06:11:04.808876 (Thread-161): 06:11:04  [WARNING]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.data-apps-ecommerce-template.data_model

2022-07-06 06:11:04.815101 (Thread-161): 06:11:04  Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '659b7287-63c6-4870-93d6-1d76e1b93300', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f68781e4700>]}
2022-07-06 06:11:05.457163 (Thread-162): handling status request
2022-07-06 06:11:05.457614 (Thread-162): 06:11:05  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '659b7287-63c6-4870-93d6-1d76e1b93300', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f68782b2eb0>]}
2022-07-06 06:11:05.458144 (Thread-162): sending response (<Response 2004 bytes [200 OK]>) to 10.0.38.61
2022-07-06 06:11:05.483493 (Thread-163): handling status request
2022-07-06 06:11:05.483918 (Thread-163): 06:11:05  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '659b7287-63c6-4870-93d6-1d76e1b93300', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f68782b2ee0>]}
2022-07-06 06:11:05.484417 (Thread-163): sending response (<Response 2004 bytes [200 OK]>) to 10.0.38.61
2022-07-06 06:11:08.819670 (Thread-164): 06:11:08  Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
2022-07-06 06:11:08.820148 (Thread-164): 06:11:08  Partial parsing: updated file: ecommerce_data_model_dbt://macros/get_age_from_dob.sql
2022-07-06 06:11:08.820310 (Thread-164): 06:11:08  Parsing macros/get_age_from_dob.sql
2022-07-06 06:11:09.557542 (Thread-165): handling status request
2022-07-06 06:11:09.557968 (Thread-165): 06:11:09  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '659b7287-63c6-4870-93d6-1d76e1b93300', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f68781f2070>]}
2022-07-06 06:11:09.558460 (Thread-165): sending response (<Response 1379 bytes [200 OK]>) to 10.0.38.61
2022-07-06 06:11:09.575728 (Thread-166): handling status request
2022-07-06 06:11:09.576206 (Thread-166): 06:11:09  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '659b7287-63c6-4870-93d6-1d76e1b93300', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f68781f2460>]}
2022-07-06 06:11:09.576708 (Thread-166): sending response (<Response 1379 bytes [200 OK]>) to 10.0.38.61
2022-07-06 06:11:31.343261 (Thread-167): 06:11:31  Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
2022-07-06 06:11:31.343745 (Thread-167): 06:11:31  Partial parsing: updated file: ecommerce_data_model_dbt://macros/get_age_from_dob.sql
2022-07-06 06:11:31.343906 (Thread-167): 06:11:31  Parsing macros/get_age_from_dob.sql
2022-07-06 06:11:31.388254 (Thread-167): 06:11:31  [WARNING]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.data-apps-ecommerce-template.data_model

2022-07-06 06:11:31.394612 (Thread-167): 06:11:31  Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '659b7287-63c6-4870-93d6-1d76e1b93300', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f68781928e0>]}
2022-07-06 06:11:32.033674 (Thread-168): handling status request
2022-07-06 06:11:32.034129 (Thread-168): 06:11:32  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '659b7287-63c6-4870-93d6-1d76e1b93300', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6878390f70>]}
2022-07-06 06:11:32.034675 (Thread-168): sending response (<Response 2006 bytes [200 OK]>) to 10.0.38.61
2022-07-06 06:11:32.073798 (Thread-169): handling status request
2022-07-06 06:11:32.074241 (Thread-169): 06:11:32  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '659b7287-63c6-4870-93d6-1d76e1b93300', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6878390dc0>]}
2022-07-06 06:11:32.074756 (Thread-169): sending response (<Response 2006 bytes [200 OK]>) to 10.0.38.61
2022-07-06 06:12:32.145121 (Thread-170): 06:12:32  Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
2022-07-06 06:12:32.145704 (Thread-170): 06:12:32  Partial parsing: updated file: ecommerce_data_model_dbt://models/data_model/temp_folder/age.sql
2022-07-06 06:12:32.149530 (Thread-170): 06:12:32  1603: static parser failed on data_model/temp_folder/age.sql
2022-07-06 06:12:32.154543 (Thread-170): 06:12:32  1602: parser fallback to jinja rendering on data_model/temp_folder/age.sql
2022-07-06 06:12:32.193097 (Thread-170): 06:12:32  [WARNING]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.data-apps-ecommerce-template.data_model

2022-07-06 06:12:32.199567 (Thread-170): 06:12:32  Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '659b7287-63c6-4870-93d6-1d76e1b93300', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f687819c340>]}
2022-07-06 06:12:32.872498 (Thread-171): handling status request
2022-07-06 06:12:32.873006 (Thread-171): 06:12:32  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '659b7287-63c6-4870-93d6-1d76e1b93300', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f687817a3d0>]}
2022-07-06 06:12:32.873557 (Thread-171): sending response (<Response 2357 bytes [200 OK]>) to 10.0.38.61
2022-07-06 06:12:33.023675 (Thread-172): handling status request
2022-07-06 06:12:33.024117 (Thread-172): 06:12:33  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '659b7287-63c6-4870-93d6-1d76e1b93300', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f687817a190>]}
2022-07-06 06:12:33.024635 (Thread-172): sending response (<Response 2357 bytes [200 OK]>) to 10.0.38.61
2022-07-06 06:12:37.641639 (Thread-173): handling status request
2022-07-06 06:12:37.642058 (Thread-173): 06:12:37  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '659b7287-63c6-4870-93d6-1d76e1b93300', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f687817a070>]}
2022-07-06 06:12:37.669650 (Thread-173): sending response (<Response 2357 bytes [200 OK]>) to 10.0.38.61
2022-07-06 06:12:38.041787 (Thread-174): handling run_sql request
2022-07-06 06:12:38.042195 (Thread-174): 06:12:38  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '659b7287-63c6-4870-93d6-1d76e1b93300', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f68782159a0>]}
2022-07-06 06:12:40.488714 (Thread-174): sending response (<Response 139 bytes [200 OK]>) to 10.0.38.61
2022-07-06 06:12:40.518832 (MainThread): 06:12:40  Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'b7a97ced-2e0f-4955-a701-a7d1c6f3ecd8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f108d4877c0>]}
2022-07-06 06:12:40.519583 (MainThread): 06:12:40  Found 16 models, 0 tests, 0 snapshots, 0 analyses, 181 macros, 0 operations, 0 seed files, 15 sources, 0 exposures, 0 metrics
2022-07-06 06:12:40.520307 (Thread-1): 06:12:40  Acquiring new snowflake connection "rpc.ecommerce_data_model_dbt.request"
2022-07-06 06:12:40.520437 (Thread-1): 06:12:40  Began compiling node rpc.ecommerce_data_model_dbt.request
2022-07-06 06:12:40.520537 (Thread-1): 06:12:40  Compiling rpc.ecommerce_data_model_dbt.request
2022-07-06 06:12:40.523635 (Thread-1): 06:12:40  finished collecting timing info
2022-07-06 06:12:40.523772 (Thread-1): 06:12:40  Began executing node rpc.ecommerce_data_model_dbt.request
2022-07-06 06:12:40.524730 (Thread-1): 06:12:40  Using snowflake connection "rpc.ecommerce_data_model_dbt.request"
2022-07-06 06:12:40.524823 (Thread-1): 06:12:40  On rpc.ecommerce_data_model_dbt.request: select user_id, age from
(select user_id, 
CASE WHEN dateadd(year, datediff (year, properties_birthday, getdate()), properties_birthday) > getdate()
      THEN datediff(year, properties_birthday, getdate()) - 1
      ELSE datediff(year, properties_birthday, getdate())
 END
 } as age, 
from analytics_db.data_apps_simulated.identifies where timestamp >= '2021-05-01' and timestamp <= '2022-06-29'
and properties_birthday is not null and properties_birthday!='')
limit 500
/* limit added automatically by dbt cloud */
2022-07-06 06:12:40.524914 (Thread-1): 06:12:40  Opening a new connection, currently in state init
2022-07-06 06:12:40.871099 (Thread-175): handling poll request
2022-07-06 06:12:40.871636 (Thread-175): 06:12:40  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '659b7287-63c6-4870-93d6-1d76e1b93300', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f687817a0d0>]}
2022-07-06 06:12:40.872569 (Thread-175): sending response (<Response 4251 bytes [200 OK]>) to 10.0.38.61
2022-07-06 06:12:41.264039 (Thread-1): 06:12:41  Snowflake adapter: Snowflake query id: 01a56b54-0602-2ed5-0019-820304697152
2022-07-06 06:12:41.264238 (Thread-1): 06:12:41  Snowflake adapter: Snowflake error: 001003 (42000): SQL compilation error:
syntax error line 7 at position 1 unexpected '}'.
syntax error line 8 at position 0 unexpected 'from'.
syntax error line 9 at position 63 unexpected ')'.
2022-07-06 06:12:41.264403 (Thread-1): 06:12:41  finished collecting timing info
2022-07-06 06:12:41.264562 (Thread-1): 06:12:41  On rpc.ecommerce_data_model_dbt.request: Close
2022-07-06 06:12:41.315888 (Thread-1): Got an exception: Database Error
  001003 (42000): SQL compilation error:
  syntax error line 7 at position 1 unexpected '}'.
  syntax error line 8 at position 0 unexpected 'from'.
  syntax error line 9 at position 63 unexpected ')'.
Traceback (most recent call last):
  File "/usr/local/lib/python3.8/dist-packages/dbt/adapters/snowflake/connections.py", line 206, in exception_handler
    yield
  File "/usr/local/lib/python3.8/dist-packages/dbt/adapters/sql/connections.py", line 74, in add_query
    cursor.execute(sql, bindings)
  File "/usr/local/lib/python3.8/dist-packages/snowflake/connector/cursor.py", line 721, in execute
    Error.errorhandler_wrapper(
  File "/usr/local/lib/python3.8/dist-packages/snowflake/connector/errors.py", line 258, in errorhandler_wrapper
    cursor.errorhandler(connection, cursor, error_class, error_value)
  File "/usr/local/lib/python3.8/dist-packages/snowflake/connector/errors.py", line 188, in default_errorhandler
    raise error_class(
snowflake.connector.errors.ProgrammingError: 001003 (42000): SQL compilation error:
syntax error line 7 at position 1 unexpected '}'.
syntax error line 8 at position 0 unexpected 'from'.
syntax error line 9 at position 63 unexpected ')'.

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/usr/local/lib/python3.8/dist-packages/dbt/task/base.py", line 361, in safe_run
    result = self.compile_and_execute(manifest, ctx)
  File "/usr/local/lib/python3.8/dist-packages/dbt/task/base.py", line 314, in compile_and_execute
    result = self.run(ctx.node, manifest)
  File "/usr/local/lib/python3.8/dist-packages/dbt/task/base.py", line 403, in run
    return self.execute(compiled_node, manifest)
  File "/usr/local/lib/python3.8/dist-packages/dbt_rpc/rpc/node_runners.py", line 90, in execute
    _, execute_result = self.adapter.execute(
  File "/usr/local/lib/python3.8/dist-packages/dbt/adapters/base/impl.py", line 225, in execute
    return self.connections.execute(
  File "/usr/local/lib/python3.8/dist-packages/dbt/adapters/sql/connections.py", line 127, in execute
    _, cursor = self.add_query(sql, auto_begin)
  File "/usr/local/lib/python3.8/dist-packages/dbt/adapters/snowflake/connections.py", line 433, in add_query
    connection, cursor = super().add_query(
  File "/usr/local/lib/python3.8/dist-packages/dbt/adapters/sql/connections.py", line 83, in add_query
    return connection, cursor
  File "/usr/lib/python3.8/contextlib.py", line 131, in __exit__
    self.gen.throw(type, value, traceback)
  File "/usr/local/lib/python3.8/dist-packages/dbt/adapters/snowflake/connections.py", line 223, in exception_handler
    raise DatabaseException(msg)
dbt.exceptions.DatabaseException: Database Error
  001003 (42000): SQL compilation error:
  syntax error line 7 at position 1 unexpected '}'.
  syntax error line 8 at position 0 unexpected 'from'.
  syntax error line 9 at position 63 unexpected ')'.
2022-07-06 06:12:41.316912 (Thread-1): Got exception RPCException(10003, Database Error, {'type': 'DatabaseException', 'message': "Database Error in rpc request (from remote system)\n  001003 (42000): SQL compilation error:\n  syntax error line 7 at position 1 unexpected '}'.\n  syntax error line 8 at position 0 unexpected 'from'.\n  syntax error line 9 at position 63 unexpected ')'.", 'raw_sql': "select user_id, age from\r\n(select user_id, {{get_age_from_dob(properties_birthday)}}} as age, \r\nfrom {{ source('ecommerce', 'identifies') }} where timestamp >= '{{ var('start_date') }}' and timestamp <= '{{ var('end_date') }}'\r\nand properties_birthday is not null and properties_birthday!='')\nlimit 500\n/* limit added automatically by dbt cloud */", 'compiled_sql': "select user_id, age from\n(select user_id, \nCASE WHEN dateadd(year, datediff (year, properties_birthday, getdate()), properties_birthday) > getdate()\n      THEN datediff(year, properties_birthday, getdate()) - 1\n      ELSE datediff(year, properties_birthday, getdate())\n END\n } as age, \nfrom analytics_db.data_apps_simulated.identifies where timestamp >= '2021-05-01' and timestamp <= '2022-06-29'\nand properties_birthday is not null and properties_birthday!='')\nlimit 500\n/* limit added automatically by dbt cloud */", 'tags': None}, None)
Traceback (most recent call last):
  File "/usr/local/lib/python3.8/dist-packages/dbt_rpc/task/sql_commands.py", line 147, in _in_thread
    self.node_results.append(runner.safe_run(self.manifest))
  File "/usr/local/lib/python3.8/dist-packages/dbt/task/base.py", line 377, in safe_run
    result = self.error_result(ctx.node, error, started, [])
  File "/usr/local/lib/python3.8/dist-packages/dbt_rpc/rpc/node_runners.py", line 56, in error_result
    raise error
dbt_rpc.rpc.error.RPCException: RPCException(10003, Database Error, {'type': 'DatabaseException', 'message': "Database Error in rpc request (from remote system)\n  001003 (42000): SQL compilation error:\n  syntax error line 7 at position 1 unexpected '}'.\n  syntax error line 8 at position 0 unexpected 'from'.\n  syntax error line 9 at position 63 unexpected ')'.", 'raw_sql': "select user_id, age from\r\n(select user_id, {{get_age_from_dob(properties_birthday)}}} as age, \r\nfrom {{ source('ecommerce', 'identifies') }} where timestamp >= '{{ var('start_date') }}' and timestamp <= '{{ var('end_date') }}'\r\nand properties_birthday is not null and properties_birthday!='')\nlimit 500\n/* limit added automatically by dbt cloud */", 'compiled_sql': "select user_id, age from\n(select user_id, \nCASE WHEN dateadd(year, datediff (year, properties_birthday, getdate()), properties_birthday) > getdate()\n      THEN datediff(year, properties_birthday, getdate()) - 1\n      ELSE datediff(year, properties_birthday, getdate())\n END\n } as age, \nfrom analytics_db.data_apps_simulated.identifies where timestamp >= '2021-05-01' and timestamp <= '2022-06-29'\nand properties_birthday is not null and properties_birthday!='')\nlimit 500\n/* limit added automatically by dbt cloud */", 'tags': None}, None)
2022-07-06 06:12:42.261041 (Thread-176): handling poll request
2022-07-06 06:12:42.261464 (Thread-176): 06:12:42  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '659b7287-63c6-4870-93d6-1d76e1b93300', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6878292e50>]}
2022-07-06 06:12:42.262109 (Thread-176): sending response (<Response 13294 bytes [200 OK]>) to 10.0.38.61
2022-07-06 06:12:48.488259 (Thread-177): 06:12:48  Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
2022-07-06 06:12:48.488897 (Thread-177): 06:12:48  Partial parsing: updated file: ecommerce_data_model_dbt://models/data_model/temp_folder/age.sql
2022-07-06 06:12:48.659651 (Thread-177): 06:12:48  1603: static parser failed on data_model/temp_folder/age.sql
2022-07-06 06:12:48.664129 (Thread-177): 06:12:48  1602: parser fallback to jinja rendering on data_model/temp_folder/age.sql
2022-07-06 06:12:48.706197 (Thread-177): 06:12:48  [WARNING]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.data-apps-ecommerce-template.data_model

2022-07-06 06:12:48.712260 (Thread-177): 06:12:48  Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '659b7287-63c6-4870-93d6-1d76e1b93300', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f68782b4a30>]}
2022-07-06 06:12:49.232540 (Thread-178): handling status request
2022-07-06 06:12:49.233040 (Thread-178): 06:12:49  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '659b7287-63c6-4870-93d6-1d76e1b93300', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f68781b3fa0>]}
2022-07-06 06:12:49.233590 (Thread-178): sending response (<Response 2357 bytes [200 OK]>) to 10.0.38.61
2022-07-06 06:12:49.246229 (Thread-179): handling status request
2022-07-06 06:12:49.246552 (Thread-179): 06:12:49  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '659b7287-63c6-4870-93d6-1d76e1b93300', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f68a8cb06d0>]}
2022-07-06 06:12:49.247030 (Thread-179): sending response (<Response 2357 bytes [200 OK]>) to 10.0.38.61
2022-07-06 06:12:50.110183 (Thread-180): handling status request
2022-07-06 06:12:50.110602 (Thread-180): 06:12:50  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '659b7287-63c6-4870-93d6-1d76e1b93300', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f68783f7520>]}
2022-07-06 06:12:50.111124 (Thread-180): sending response (<Response 2357 bytes [200 OK]>) to 10.0.38.61
2022-07-06 06:12:50.492569 (Thread-181): handling compile_sql request
2022-07-06 06:12:50.492995 (Thread-181): 06:12:50  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '659b7287-63c6-4870-93d6-1d76e1b93300', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f68783f7c70>]}
2022-07-06 06:12:52.936192 (Thread-181): sending response (<Response 139 bytes [200 OK]>) to 10.0.38.61
2022-07-06 06:12:52.964191 (MainThread): 06:12:52  Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'a021f15e-a3b8-476a-aa83-25682db318be', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8c305066d0>]}
2022-07-06 06:12:52.964807 (MainThread): 06:12:52  Found 16 models, 0 tests, 0 snapshots, 0 analyses, 181 macros, 0 operations, 0 seed files, 15 sources, 0 exposures, 0 metrics
2022-07-06 06:12:52.965467 (Thread-1): 06:12:52  Acquiring new snowflake connection "rpc.ecommerce_data_model_dbt.request"
2022-07-06 06:12:52.965600 (Thread-1): 06:12:52  Began compiling node rpc.ecommerce_data_model_dbt.request
2022-07-06 06:12:52.965701 (Thread-1): 06:12:52  Compiling rpc.ecommerce_data_model_dbt.request
2022-07-06 06:12:52.968741 (Thread-1): 06:12:52  finished collecting timing info
2022-07-06 06:12:52.968882 (Thread-1): 06:12:52  Began executing node rpc.ecommerce_data_model_dbt.request
2022-07-06 06:12:52.969021 (Thread-1): 06:12:52  finished collecting timing info
2022-07-06 06:12:53.306897 (Thread-182): handling poll request
2022-07-06 06:12:53.307365 (Thread-182): 06:12:53  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '659b7287-63c6-4870-93d6-1d76e1b93300', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6878293ca0>]}
2022-07-06 06:12:53.308583 (Thread-182): sending response (<Response 6737 bytes [200 OK]>) to 10.0.38.61
2022-07-06 06:13:12.649059 (Thread-183): handling status request
2022-07-06 06:13:12.649453 (Thread-183): 06:13:12  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '659b7287-63c6-4870-93d6-1d76e1b93300', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6878293250>]}
2022-07-06 06:13:12.649973 (Thread-183): sending response (<Response 2357 bytes [200 OK]>) to 10.0.38.61
2022-07-06 06:13:13.039922 (Thread-184): handling run_sql request
2022-07-06 06:13:13.040318 (Thread-184): 06:13:13  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '659b7287-63c6-4870-93d6-1d76e1b93300', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f687842a340>]}
2022-07-06 06:13:15.456282 (Thread-184): sending response (<Response 139 bytes [200 OK]>) to 10.0.38.61
2022-07-06 06:13:15.483462 (MainThread): 06:13:15  Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '5aa0c312-eba5-405e-a040-461b1cb49de4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd5a7cdfd00>]}
2022-07-06 06:13:15.484066 (MainThread): 06:13:15  Found 16 models, 0 tests, 0 snapshots, 0 analyses, 181 macros, 0 operations, 0 seed files, 15 sources, 0 exposures, 0 metrics
2022-07-06 06:13:15.484700 (Thread-1): 06:13:15  Acquiring new snowflake connection "rpc.ecommerce_data_model_dbt.request"
2022-07-06 06:13:15.484836 (Thread-1): 06:13:15  Began compiling node rpc.ecommerce_data_model_dbt.request
2022-07-06 06:13:15.484936 (Thread-1): 06:13:15  Compiling rpc.ecommerce_data_model_dbt.request
2022-07-06 06:13:15.487914 (Thread-1): 06:13:15  finished collecting timing info
2022-07-06 06:13:15.488048 (Thread-1): 06:13:15  Began executing node rpc.ecommerce_data_model_dbt.request
2022-07-06 06:13:15.488988 (Thread-1): 06:13:15  Using snowflake connection "rpc.ecommerce_data_model_dbt.request"
2022-07-06 06:13:15.489085 (Thread-1): 06:13:15  On rpc.ecommerce_data_model_dbt.request: select user_id, 
CASE WHEN dateadd(year, datediff (year, properties_birthday, getdate()), properties_birthday) > getdate()
      THEN datediff(year, properties_birthday, getdate()) - 1
      ELSE datediff(year, properties_birthday, getdate())
 END
 } as age, 
from analytics_db.data_apps_simulated.identifies where timestamp >= '2021-05-01' and timestamp <= '2022-06-29'
and properties_birthday is not null and properties_birthday!=''
limit 500
/* limit added automatically by dbt cloud */
2022-07-06 06:13:15.489167 (Thread-1): 06:13:15  Opening a new connection, currently in state init
2022-07-06 06:13:15.846285 (Thread-185): handling poll request
2022-07-06 06:13:15.846775 (Thread-185): 06:13:15  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '659b7287-63c6-4870-93d6-1d76e1b93300', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6878383310>]}
2022-07-06 06:13:15.847676 (Thread-185): sending response (<Response 4233 bytes [200 OK]>) to 10.0.38.61
2022-07-06 06:13:16.272186 (Thread-1): 06:13:16  Snowflake adapter: Snowflake query id: 01a56b55-0602-3316-0019-82030469a09e
2022-07-06 06:13:16.272383 (Thread-1): 06:13:16  Snowflake adapter: Snowflake error: 001003 (42000): SQL compilation error:
syntax error line 6 at position 1 unexpected '}'.
2022-07-06 06:13:16.272545 (Thread-1): 06:13:16  finished collecting timing info
2022-07-06 06:13:16.272707 (Thread-1): 06:13:16  On rpc.ecommerce_data_model_dbt.request: Close
2022-07-06 06:13:16.342030 (Thread-1): Got an exception: Database Error
  001003 (42000): SQL compilation error:
  syntax error line 6 at position 1 unexpected '}'.
Traceback (most recent call last):
  File "/usr/local/lib/python3.8/dist-packages/dbt/adapters/snowflake/connections.py", line 206, in exception_handler
    yield
  File "/usr/local/lib/python3.8/dist-packages/dbt/adapters/sql/connections.py", line 74, in add_query
    cursor.execute(sql, bindings)
  File "/usr/local/lib/python3.8/dist-packages/snowflake/connector/cursor.py", line 721, in execute
    Error.errorhandler_wrapper(
  File "/usr/local/lib/python3.8/dist-packages/snowflake/connector/errors.py", line 258, in errorhandler_wrapper
    cursor.errorhandler(connection, cursor, error_class, error_value)
  File "/usr/local/lib/python3.8/dist-packages/snowflake/connector/errors.py", line 188, in default_errorhandler
    raise error_class(
snowflake.connector.errors.ProgrammingError: 001003 (42000): SQL compilation error:
syntax error line 6 at position 1 unexpected '}'.

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/usr/local/lib/python3.8/dist-packages/dbt/task/base.py", line 361, in safe_run
    result = self.compile_and_execute(manifest, ctx)
  File "/usr/local/lib/python3.8/dist-packages/dbt/task/base.py", line 314, in compile_and_execute
    result = self.run(ctx.node, manifest)
  File "/usr/local/lib/python3.8/dist-packages/dbt/task/base.py", line 403, in run
    return self.execute(compiled_node, manifest)
  File "/usr/local/lib/python3.8/dist-packages/dbt_rpc/rpc/node_runners.py", line 90, in execute
    _, execute_result = self.adapter.execute(
  File "/usr/local/lib/python3.8/dist-packages/dbt/adapters/base/impl.py", line 225, in execute
    return self.connections.execute(
  File "/usr/local/lib/python3.8/dist-packages/dbt/adapters/sql/connections.py", line 127, in execute
    _, cursor = self.add_query(sql, auto_begin)
  File "/usr/local/lib/python3.8/dist-packages/dbt/adapters/snowflake/connections.py", line 433, in add_query
    connection, cursor = super().add_query(
  File "/usr/local/lib/python3.8/dist-packages/dbt/adapters/sql/connections.py", line 83, in add_query
    return connection, cursor
  File "/usr/lib/python3.8/contextlib.py", line 131, in __exit__
    self.gen.throw(type, value, traceback)
  File "/usr/local/lib/python3.8/dist-packages/dbt/adapters/snowflake/connections.py", line 223, in exception_handler
    raise DatabaseException(msg)
dbt.exceptions.DatabaseException: Database Error
  001003 (42000): SQL compilation error:
  syntax error line 6 at position 1 unexpected '}'.
2022-07-06 06:13:16.343211 (Thread-1): Got exception RPCException(10003, Database Error, {'type': 'DatabaseException', 'message': "Database Error in rpc request (from remote system)\n  001003 (42000): SQL compilation error:\n  syntax error line 6 at position 1 unexpected '}'.", 'raw_sql': "select user_id, {{get_age_from_dob(properties_birthday)}}} as age, \r\nfrom {{ source('ecommerce', 'identifies') }} where timestamp >= '{{ var('start_date') }}' and timestamp <= '{{ var('end_date') }}'\r\nand properties_birthday is not null and properties_birthday!=''\nlimit 500\n/* limit added automatically by dbt cloud */", 'compiled_sql': "select user_id, \nCASE WHEN dateadd(year, datediff (year, properties_birthday, getdate()), properties_birthday) > getdate()\n      THEN datediff(year, properties_birthday, getdate()) - 1\n      ELSE datediff(year, properties_birthday, getdate())\n END\n } as age, \nfrom analytics_db.data_apps_simulated.identifies where timestamp >= '2021-05-01' and timestamp <= '2022-06-29'\nand properties_birthday is not null and properties_birthday!=''\nlimit 500\n/* limit added automatically by dbt cloud */", 'tags': None}, None)
Traceback (most recent call last):
  File "/usr/local/lib/python3.8/dist-packages/dbt_rpc/task/sql_commands.py", line 147, in _in_thread
    self.node_results.append(runner.safe_run(self.manifest))
  File "/usr/local/lib/python3.8/dist-packages/dbt/task/base.py", line 377, in safe_run
    result = self.error_result(ctx.node, error, started, [])
  File "/usr/local/lib/python3.8/dist-packages/dbt_rpc/rpc/node_runners.py", line 56, in error_result
    raise error
dbt_rpc.rpc.error.RPCException: RPCException(10003, Database Error, {'type': 'DatabaseException', 'message': "Database Error in rpc request (from remote system)\n  001003 (42000): SQL compilation error:\n  syntax error line 6 at position 1 unexpected '}'.", 'raw_sql': "select user_id, {{get_age_from_dob(properties_birthday)}}} as age, \r\nfrom {{ source('ecommerce', 'identifies') }} where timestamp >= '{{ var('start_date') }}' and timestamp <= '{{ var('end_date') }}'\r\nand properties_birthday is not null and properties_birthday!=''\nlimit 500\n/* limit added automatically by dbt cloud */", 'compiled_sql': "select user_id, \nCASE WHEN dateadd(year, datediff (year, properties_birthday, getdate()), properties_birthday) > getdate()\n      THEN datediff(year, properties_birthday, getdate()) - 1\n      ELSE datediff(year, properties_birthday, getdate())\n END\n } as age, \nfrom analytics_db.data_apps_simulated.identifies where timestamp >= '2021-05-01' and timestamp <= '2022-06-29'\nand properties_birthday is not null and properties_birthday!=''\nlimit 500\n/* limit added automatically by dbt cloud */", 'tags': None}, None)
2022-07-06 06:13:17.267515 (Thread-186): handling poll request
2022-07-06 06:13:17.267935 (Thread-186): 06:13:17  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '659b7287-63c6-4870-93d6-1d76e1b93300', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6878383e20>]}
2022-07-06 06:13:17.268564 (Thread-186): sending response (<Response 12336 bytes [200 OK]>) to 10.0.38.61
2022-07-06 06:13:23.744327 (Thread-187): handling status request
2022-07-06 06:13:23.744765 (Thread-187): 06:13:23  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '659b7287-63c6-4870-93d6-1d76e1b93300', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f68783839d0>]}
2022-07-06 06:13:23.745370 (Thread-187): sending response (<Response 2357 bytes [200 OK]>) to 10.0.38.61
2022-07-06 06:13:24.126382 (Thread-188): handling compile_sql request
2022-07-06 06:13:24.126820 (Thread-188): 06:13:24  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '659b7287-63c6-4870-93d6-1d76e1b93300', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f68783837f0>]}
2022-07-06 06:13:26.513488 (Thread-188): sending response (<Response 139 bytes [200 OK]>) to 10.0.38.61
2022-07-06 06:13:26.540260 (MainThread): 06:13:26  Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '29c343d3-9417-4ed5-8223-b27ca4c585e5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6be6f1fd30>]}
2022-07-06 06:13:26.540826 (MainThread): 06:13:26  Found 16 models, 0 tests, 0 snapshots, 0 analyses, 181 macros, 0 operations, 0 seed files, 15 sources, 0 exposures, 0 metrics
2022-07-06 06:13:26.541484 (Thread-1): 06:13:26  Acquiring new snowflake connection "rpc.ecommerce_data_model_dbt.request"
2022-07-06 06:13:26.541617 (Thread-1): 06:13:26  Began compiling node rpc.ecommerce_data_model_dbt.request
2022-07-06 06:13:26.541716 (Thread-1): 06:13:26  Compiling rpc.ecommerce_data_model_dbt.request
2022-07-06 06:13:26.544544 (Thread-1): 06:13:26  finished collecting timing info
2022-07-06 06:13:26.544676 (Thread-1): 06:13:26  Began executing node rpc.ecommerce_data_model_dbt.request
2022-07-06 06:13:26.544774 (Thread-1): 06:13:26  finished collecting timing info
2022-07-06 06:13:26.900360 (Thread-189): handling poll request
2022-07-06 06:13:26.900890 (Thread-189): 06:13:26  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '659b7287-63c6-4870-93d6-1d76e1b93300', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6878383a00>]}
2022-07-06 06:13:26.902075 (Thread-189): sending response (<Response 6736 bytes [200 OK]>) to 10.0.38.61
2022-07-06 06:13:39.546864 (Thread-190): 06:13:39  Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
2022-07-06 06:13:39.547501 (Thread-190): 06:13:39  Partial parsing: updated file: ecommerce_data_model_dbt://models/data_model/temp_folder/age.sql
2022-07-06 06:13:39.551831 (Thread-190): 06:13:39  1603: static parser failed on data_model/temp_folder/age.sql
2022-07-06 06:13:39.556167 (Thread-190): 06:13:39  1602: parser fallback to jinja rendering on data_model/temp_folder/age.sql
2022-07-06 06:13:39.595544 (Thread-190): 06:13:39  [WARNING]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.data-apps-ecommerce-template.data_model

2022-07-06 06:13:39.601342 (Thread-190): 06:13:39  Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '659b7287-63c6-4870-93d6-1d76e1b93300', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6878283040>]}
2022-07-06 06:13:40.344751 (Thread-191): handling status request
2022-07-06 06:13:40.345198 (Thread-191): 06:13:40  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '659b7287-63c6-4870-93d6-1d76e1b93300', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6880311910>]}
2022-07-06 06:13:40.345749 (Thread-191): sending response (<Response 2357 bytes [200 OK]>) to 10.0.38.61
2022-07-06 06:13:40.587105 (Thread-192): handling status request
2022-07-06 06:13:40.587503 (Thread-192): 06:13:40  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '659b7287-63c6-4870-93d6-1d76e1b93300', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f68802f5a60>]}
2022-07-06 06:13:40.587998 (Thread-192): sending response (<Response 2357 bytes [200 OK]>) to 10.0.38.61
2022-07-06 06:13:41.664347 (Thread-193): handling status request
2022-07-06 06:13:41.664771 (Thread-193): 06:13:41  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '659b7287-63c6-4870-93d6-1d76e1b93300', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f68802f5d60>]}
2022-07-06 06:13:41.665309 (Thread-193): sending response (<Response 2357 bytes [200 OK]>) to 10.0.38.61
2022-07-06 06:13:42.043176 (Thread-194): handling run_sql request
2022-07-06 06:13:42.043573 (Thread-194): 06:13:42  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '659b7287-63c6-4870-93d6-1d76e1b93300', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f68802f55b0>]}
2022-07-06 06:13:44.432493 (Thread-194): sending response (<Response 139 bytes [200 OK]>) to 10.0.38.61
2022-07-06 06:13:44.459724 (MainThread): 06:13:44  Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '3227c21c-394b-4d44-bfe9-aed1f9986d18', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9d8895ed90>]}
2022-07-06 06:13:44.460295 (MainThread): 06:13:44  Found 16 models, 0 tests, 0 snapshots, 0 analyses, 181 macros, 0 operations, 0 seed files, 15 sources, 0 exposures, 0 metrics
2022-07-06 06:13:44.460928 (Thread-1): 06:13:44  Acquiring new snowflake connection "rpc.ecommerce_data_model_dbt.request"
2022-07-06 06:13:44.461091 (Thread-1): 06:13:44  Began compiling node rpc.ecommerce_data_model_dbt.request
2022-07-06 06:13:44.461195 (Thread-1): 06:13:44  Compiling rpc.ecommerce_data_model_dbt.request
2022-07-06 06:13:44.464052 (Thread-1): 06:13:44  finished collecting timing info
2022-07-06 06:13:44.464193 (Thread-1): 06:13:44  Began executing node rpc.ecommerce_data_model_dbt.request
2022-07-06 06:13:44.465133 (Thread-1): 06:13:44  Using snowflake connection "rpc.ecommerce_data_model_dbt.request"
2022-07-06 06:13:44.465230 (Thread-1): 06:13:44  On rpc.ecommerce_data_model_dbt.request: select user_id, 
CASE WHEN dateadd(year, datediff (year, properties_birthday, getdate()), properties_birthday) > getdate()
      THEN datediff(year, properties_birthday, getdate()) - 1
      ELSE datediff(year, properties_birthday, getdate())
 END
  as age, 
from analytics_db.data_apps_simulated.identifies where timestamp >= '2021-05-01' and timestamp <= '2022-06-29'
and properties_birthday is not null and properties_birthday!=''
limit 500
/* limit added automatically by dbt cloud */
2022-07-06 06:13:44.465317 (Thread-1): 06:13:44  Opening a new connection, currently in state init
2022-07-06 06:13:44.802073 (Thread-195): handling poll request
2022-07-06 06:13:44.802525 (Thread-195): 06:13:44  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '659b7287-63c6-4870-93d6-1d76e1b93300', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f68801794c0>]}
2022-07-06 06:13:44.803446 (Thread-195): sending response (<Response 4231 bytes [200 OK]>) to 10.0.38.61
2022-07-06 06:13:45.203019 (Thread-1): 06:13:45  Snowflake adapter: Snowflake query id: 01a56b55-0602-3374-0019-820304699766
2022-07-06 06:13:45.203209 (Thread-1): 06:13:45  Snowflake adapter: Snowflake error: 001003 (42000): SQL compilation error:
syntax error line 7 at position 0 unexpected 'from'.
2022-07-06 06:13:45.203376 (Thread-1): 06:13:45  finished collecting timing info
2022-07-06 06:13:45.203535 (Thread-1): 06:13:45  On rpc.ecommerce_data_model_dbt.request: Close
2022-07-06 06:13:45.281200 (Thread-1): Got an exception: Database Error
  001003 (42000): SQL compilation error:
  syntax error line 7 at position 0 unexpected 'from'.
Traceback (most recent call last):
  File "/usr/local/lib/python3.8/dist-packages/dbt/adapters/snowflake/connections.py", line 206, in exception_handler
    yield
  File "/usr/local/lib/python3.8/dist-packages/dbt/adapters/sql/connections.py", line 74, in add_query
    cursor.execute(sql, bindings)
  File "/usr/local/lib/python3.8/dist-packages/snowflake/connector/cursor.py", line 721, in execute
    Error.errorhandler_wrapper(
  File "/usr/local/lib/python3.8/dist-packages/snowflake/connector/errors.py", line 258, in errorhandler_wrapper
    cursor.errorhandler(connection, cursor, error_class, error_value)
  File "/usr/local/lib/python3.8/dist-packages/snowflake/connector/errors.py", line 188, in default_errorhandler
    raise error_class(
snowflake.connector.errors.ProgrammingError: 001003 (42000): SQL compilation error:
syntax error line 7 at position 0 unexpected 'from'.

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/usr/local/lib/python3.8/dist-packages/dbt/task/base.py", line 361, in safe_run
    result = self.compile_and_execute(manifest, ctx)
  File "/usr/local/lib/python3.8/dist-packages/dbt/task/base.py", line 314, in compile_and_execute
    result = self.run(ctx.node, manifest)
  File "/usr/local/lib/python3.8/dist-packages/dbt/task/base.py", line 403, in run
    return self.execute(compiled_node, manifest)
  File "/usr/local/lib/python3.8/dist-packages/dbt_rpc/rpc/node_runners.py", line 90, in execute
    _, execute_result = self.adapter.execute(
  File "/usr/local/lib/python3.8/dist-packages/dbt/adapters/base/impl.py", line 225, in execute
    return self.connections.execute(
  File "/usr/local/lib/python3.8/dist-packages/dbt/adapters/sql/connections.py", line 127, in execute
    _, cursor = self.add_query(sql, auto_begin)
  File "/usr/local/lib/python3.8/dist-packages/dbt/adapters/snowflake/connections.py", line 433, in add_query
    connection, cursor = super().add_query(
  File "/usr/local/lib/python3.8/dist-packages/dbt/adapters/sql/connections.py", line 83, in add_query
    return connection, cursor
  File "/usr/lib/python3.8/contextlib.py", line 131, in __exit__
    self.gen.throw(type, value, traceback)
  File "/usr/local/lib/python3.8/dist-packages/dbt/adapters/snowflake/connections.py", line 223, in exception_handler
    raise DatabaseException(msg)
dbt.exceptions.DatabaseException: Database Error
  001003 (42000): SQL compilation error:
  syntax error line 7 at position 0 unexpected 'from'.
2022-07-06 06:13:45.282189 (Thread-1): Got exception RPCException(10003, Database Error, {'type': 'DatabaseException', 'message': "Database Error in rpc request (from remote system)\n  001003 (42000): SQL compilation error:\n  syntax error line 7 at position 0 unexpected 'from'.", 'raw_sql': "select user_id, {{get_age_from_dob(properties_birthday)}} as age, \r\nfrom {{ source('ecommerce', 'identifies') }} where timestamp >= '{{ var('start_date') }}' and timestamp <= '{{ var('end_date') }}'\r\nand properties_birthday is not null and properties_birthday!=''\nlimit 500\n/* limit added automatically by dbt cloud */", 'compiled_sql': "select user_id, \nCASE WHEN dateadd(year, datediff (year, properties_birthday, getdate()), properties_birthday) > getdate()\n      THEN datediff(year, properties_birthday, getdate()) - 1\n      ELSE datediff(year, properties_birthday, getdate())\n END\n  as age, \nfrom analytics_db.data_apps_simulated.identifies where timestamp >= '2021-05-01' and timestamp <= '2022-06-29'\nand properties_birthday is not null and properties_birthday!=''\nlimit 500\n/* limit added automatically by dbt cloud */", 'tags': None}, None)
Traceback (most recent call last):
  File "/usr/local/lib/python3.8/dist-packages/dbt_rpc/task/sql_commands.py", line 147, in _in_thread
    self.node_results.append(runner.safe_run(self.manifest))
  File "/usr/local/lib/python3.8/dist-packages/dbt/task/base.py", line 377, in safe_run
    result = self.error_result(ctx.node, error, started, [])
  File "/usr/local/lib/python3.8/dist-packages/dbt_rpc/rpc/node_runners.py", line 56, in error_result
    raise error
dbt_rpc.rpc.error.RPCException: RPCException(10003, Database Error, {'type': 'DatabaseException', 'message': "Database Error in rpc request (from remote system)\n  001003 (42000): SQL compilation error:\n  syntax error line 7 at position 0 unexpected 'from'.", 'raw_sql': "select user_id, {{get_age_from_dob(properties_birthday)}} as age, \r\nfrom {{ source('ecommerce', 'identifies') }} where timestamp >= '{{ var('start_date') }}' and timestamp <= '{{ var('end_date') }}'\r\nand properties_birthday is not null and properties_birthday!=''\nlimit 500\n/* limit added automatically by dbt cloud */", 'compiled_sql': "select user_id, \nCASE WHEN dateadd(year, datediff (year, properties_birthday, getdate()), properties_birthday) > getdate()\n      THEN datediff(year, properties_birthday, getdate()) - 1\n      ELSE datediff(year, properties_birthday, getdate())\n END\n  as age, \nfrom analytics_db.data_apps_simulated.identifies where timestamp >= '2021-05-01' and timestamp <= '2022-06-29'\nand properties_birthday is not null and properties_birthday!=''\nlimit 500\n/* limit added automatically by dbt cloud */", 'tags': None}, None)
2022-07-06 06:13:46.241331 (Thread-196): handling poll request
2022-07-06 06:13:46.241728 (Thread-196): 06:13:46  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '659b7287-63c6-4870-93d6-1d76e1b93300', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f68802fc310>]}
2022-07-06 06:13:46.242437 (Thread-196): sending response (<Response 12350 bytes [200 OK]>) to 10.0.38.61
2022-07-06 06:13:56.792840 (Thread-197): handling status request
2022-07-06 06:13:56.793320 (Thread-197): 06:13:56  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '659b7287-63c6-4870-93d6-1d76e1b93300', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f68802fc790>]}
2022-07-06 06:13:56.793902 (Thread-197): sending response (<Response 2357 bytes [200 OK]>) to 10.0.38.61
2022-07-06 06:13:57.191473 (Thread-198): handling compile_sql request
2022-07-06 06:13:57.191883 (Thread-198): 06:13:57  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '659b7287-63c6-4870-93d6-1d76e1b93300', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f68802fc520>]}
2022-07-06 06:13:59.564937 (Thread-198): sending response (<Response 139 bytes [200 OK]>) to 10.0.38.61
2022-07-06 06:13:59.591797 (MainThread): 06:13:59  Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '3f627686-6ffb-45d8-a13e-e865261ccd41', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f48709065e0>]}
2022-07-06 06:13:59.592373 (MainThread): 06:13:59  Found 16 models, 0 tests, 0 snapshots, 0 analyses, 181 macros, 0 operations, 0 seed files, 15 sources, 0 exposures, 0 metrics
2022-07-06 06:13:59.593019 (Thread-1): 06:13:59  Acquiring new snowflake connection "rpc.ecommerce_data_model_dbt.request"
2022-07-06 06:13:59.593156 (Thread-1): 06:13:59  Began compiling node rpc.ecommerce_data_model_dbt.request
2022-07-06 06:13:59.593256 (Thread-1): 06:13:59  Compiling rpc.ecommerce_data_model_dbt.request
2022-07-06 06:13:59.596100 (Thread-1): 06:13:59  finished collecting timing info
2022-07-06 06:13:59.596235 (Thread-1): 06:13:59  Began executing node rpc.ecommerce_data_model_dbt.request
2022-07-06 06:13:59.596336 (Thread-1): 06:13:59  finished collecting timing info
2022-07-06 06:13:59.944037 (Thread-199): handling poll request
2022-07-06 06:13:59.944517 (Thread-199): 06:13:59  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '659b7287-63c6-4870-93d6-1d76e1b93300', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f688017c4f0>]}
2022-07-06 06:13:59.945737 (Thread-199): sending response (<Response 6733 bytes [200 OK]>) to 10.0.38.61
2022-07-06 06:14:11.667082 (Thread-200): handling status request
2022-07-06 06:14:11.667488 (Thread-200): 06:14:11  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '659b7287-63c6-4870-93d6-1d76e1b93300', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f688017c6a0>]}
2022-07-06 06:14:11.668028 (Thread-200): sending response (<Response 2357 bytes [200 OK]>) to 10.0.38.61
2022-07-06 06:14:12.115814 (Thread-201): handling run_sql request
2022-07-06 06:14:12.116213 (Thread-201): 06:14:12  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '659b7287-63c6-4870-93d6-1d76e1b93300', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f688017c820>]}
2022-07-06 06:14:14.544436 (Thread-201): sending response (<Response 139 bytes [200 OK]>) to 10.0.38.61
2022-07-06 06:14:14.571765 (MainThread): 06:14:14  Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '15d182de-2d0e-483c-ba5d-ffb96eb89104', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9c37c35730>]}
2022-07-06 06:14:14.572353 (MainThread): 06:14:14  Found 16 models, 0 tests, 0 snapshots, 0 analyses, 181 macros, 0 operations, 0 seed files, 15 sources, 0 exposures, 0 metrics
2022-07-06 06:14:14.573000 (Thread-1): 06:14:14  Acquiring new snowflake connection "rpc.ecommerce_data_model_dbt.request"
2022-07-06 06:14:14.573135 (Thread-1): 06:14:14  Began compiling node rpc.ecommerce_data_model_dbt.request
2022-07-06 06:14:14.573234 (Thread-1): 06:14:14  Compiling rpc.ecommerce_data_model_dbt.request
2022-07-06 06:14:14.576167 (Thread-1): 06:14:14  finished collecting timing info
2022-07-06 06:14:14.576301 (Thread-1): 06:14:14  Began executing node rpc.ecommerce_data_model_dbt.request
2022-07-06 06:14:14.577247 (Thread-1): 06:14:14  Using snowflake connection "rpc.ecommerce_data_model_dbt.request"
2022-07-06 06:14:14.577342 (Thread-1): 06:14:14  On rpc.ecommerce_data_model_dbt.request: select user_id, 
CASE WHEN dateadd(year, datediff (year, properties_birthday, getdate()), properties_birthday) > getdate()
      THEN datediff(year, properties_birthday, getdate()) - 1
      ELSE datediff(year, properties_birthday, getdate())
 END
  as age, 
from analytics_db.data_apps_simulated.identifies where timestamp >= '2021-05-01' and timestamp <= '2022-06-29'
and properties_birthday is not null and properties_birthday!=''
limit 500
/* limit added automatically by dbt cloud */
2022-07-06 06:14:14.577431 (Thread-1): 06:14:14  Opening a new connection, currently in state init
2022-07-06 06:14:14.957019 (Thread-202): handling poll request
2022-07-06 06:14:14.957534 (Thread-202): 06:14:14  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '659b7287-63c6-4870-93d6-1d76e1b93300', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f687828afa0>]}
2022-07-06 06:14:14.958464 (Thread-202): sending response (<Response 4232 bytes [200 OK]>) to 10.0.38.61
2022-07-06 06:14:15.248679 (Thread-1): 06:14:15  Snowflake adapter: Snowflake query id: 01a56b56-0602-333e-0019-82030469891e
2022-07-06 06:14:15.248875 (Thread-1): 06:14:15  Snowflake adapter: Snowflake error: 001003 (42000): SQL compilation error:
syntax error line 7 at position 0 unexpected 'from'.
2022-07-06 06:14:15.249060 (Thread-1): 06:14:15  finished collecting timing info
2022-07-06 06:14:15.249220 (Thread-1): 06:14:15  On rpc.ecommerce_data_model_dbt.request: Close
2022-07-06 06:14:15.578789 (Thread-1): Got an exception: Database Error
  001003 (42000): SQL compilation error:
  syntax error line 7 at position 0 unexpected 'from'.
Traceback (most recent call last):
  File "/usr/local/lib/python3.8/dist-packages/dbt/adapters/snowflake/connections.py", line 206, in exception_handler
    yield
  File "/usr/local/lib/python3.8/dist-packages/dbt/adapters/sql/connections.py", line 74, in add_query
    cursor.execute(sql, bindings)
  File "/usr/local/lib/python3.8/dist-packages/snowflake/connector/cursor.py", line 721, in execute
    Error.errorhandler_wrapper(
  File "/usr/local/lib/python3.8/dist-packages/snowflake/connector/errors.py", line 258, in errorhandler_wrapper
    cursor.errorhandler(connection, cursor, error_class, error_value)
  File "/usr/local/lib/python3.8/dist-packages/snowflake/connector/errors.py", line 188, in default_errorhandler
    raise error_class(
snowflake.connector.errors.ProgrammingError: 001003 (42000): SQL compilation error:
syntax error line 7 at position 0 unexpected 'from'.

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/usr/local/lib/python3.8/dist-packages/dbt/task/base.py", line 361, in safe_run
    result = self.compile_and_execute(manifest, ctx)
  File "/usr/local/lib/python3.8/dist-packages/dbt/task/base.py", line 314, in compile_and_execute
    result = self.run(ctx.node, manifest)
  File "/usr/local/lib/python3.8/dist-packages/dbt/task/base.py", line 403, in run
    return self.execute(compiled_node, manifest)
  File "/usr/local/lib/python3.8/dist-packages/dbt_rpc/rpc/node_runners.py", line 90, in execute
    _, execute_result = self.adapter.execute(
  File "/usr/local/lib/python3.8/dist-packages/dbt/adapters/base/impl.py", line 225, in execute
    return self.connections.execute(
  File "/usr/local/lib/python3.8/dist-packages/dbt/adapters/sql/connections.py", line 127, in execute
    _, cursor = self.add_query(sql, auto_begin)
  File "/usr/local/lib/python3.8/dist-packages/dbt/adapters/snowflake/connections.py", line 433, in add_query
    connection, cursor = super().add_query(
  File "/usr/local/lib/python3.8/dist-packages/dbt/adapters/sql/connections.py", line 83, in add_query
    return connection, cursor
  File "/usr/lib/python3.8/contextlib.py", line 131, in __exit__
    self.gen.throw(type, value, traceback)
  File "/usr/local/lib/python3.8/dist-packages/dbt/adapters/snowflake/connections.py", line 223, in exception_handler
    raise DatabaseException(msg)
dbt.exceptions.DatabaseException: Database Error
  001003 (42000): SQL compilation error:
  syntax error line 7 at position 0 unexpected 'from'.
2022-07-06 06:14:15.579903 (Thread-1): Got exception RPCException(10003, Database Error, {'type': 'DatabaseException', 'message': "Database Error in rpc request (from remote system)\n  001003 (42000): SQL compilation error:\n  syntax error line 7 at position 0 unexpected 'from'.", 'raw_sql': "select user_id, {{get_age_from_dob(properties_birthday)}} as age, \r\nfrom {{ source('ecommerce', 'identifies') }} where timestamp >= '{{ var('start_date') }}' and timestamp <= '{{ var('end_date') }}'\r\nand properties_birthday is not null and properties_birthday!=''\nlimit 500\n/* limit added automatically by dbt cloud */", 'compiled_sql': "select user_id, \nCASE WHEN dateadd(year, datediff (year, properties_birthday, getdate()), properties_birthday) > getdate()\n      THEN datediff(year, properties_birthday, getdate()) - 1\n      ELSE datediff(year, properties_birthday, getdate())\n END\n  as age, \nfrom analytics_db.data_apps_simulated.identifies where timestamp >= '2021-05-01' and timestamp <= '2022-06-29'\nand properties_birthday is not null and properties_birthday!=''\nlimit 500\n/* limit added automatically by dbt cloud */", 'tags': None}, None)
Traceback (most recent call last):
  File "/usr/local/lib/python3.8/dist-packages/dbt_rpc/task/sql_commands.py", line 147, in _in_thread
    self.node_results.append(runner.safe_run(self.manifest))
  File "/usr/local/lib/python3.8/dist-packages/dbt/task/base.py", line 377, in safe_run
    result = self.error_result(ctx.node, error, started, [])
  File "/usr/local/lib/python3.8/dist-packages/dbt_rpc/rpc/node_runners.py", line 56, in error_result
    raise error
dbt_rpc.rpc.error.RPCException: RPCException(10003, Database Error, {'type': 'DatabaseException', 'message': "Database Error in rpc request (from remote system)\n  001003 (42000): SQL compilation error:\n  syntax error line 7 at position 0 unexpected 'from'.", 'raw_sql': "select user_id, {{get_age_from_dob(properties_birthday)}} as age, \r\nfrom {{ source('ecommerce', 'identifies') }} where timestamp >= '{{ var('start_date') }}' and timestamp <= '{{ var('end_date') }}'\r\nand properties_birthday is not null and properties_birthday!=''\nlimit 500\n/* limit added automatically by dbt cloud */", 'compiled_sql': "select user_id, \nCASE WHEN dateadd(year, datediff (year, properties_birthday, getdate()), properties_birthday) > getdate()\n      THEN datediff(year, properties_birthday, getdate()) - 1\n      ELSE datediff(year, properties_birthday, getdate())\n END\n  as age, \nfrom analytics_db.data_apps_simulated.identifies where timestamp >= '2021-05-01' and timestamp <= '2022-06-29'\nand properties_birthday is not null and properties_birthday!=''\nlimit 500\n/* limit added automatically by dbt cloud */", 'tags': None}, None)
2022-07-06 06:14:15.774893 (Thread-203): 06:14:15  Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
2022-07-06 06:14:15.775474 (Thread-203): 06:14:15  Partial parsing: updated file: ecommerce_data_model_dbt://models/data_model/temp_folder/age.sql
2022-07-06 06:14:15.780240 (Thread-203): 06:14:15  1603: static parser failed on data_model/temp_folder/age.sql
2022-07-06 06:14:15.784700 (Thread-203): 06:14:15  1602: parser fallback to jinja rendering on data_model/temp_folder/age.sql
2022-07-06 06:14:15.820208 (Thread-203): 06:14:15  [WARNING]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.data-apps-ecommerce-template.data_model

2022-07-06 06:14:15.826496 (Thread-203): 06:14:15  Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '659b7287-63c6-4870-93d6-1d76e1b93300', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f68780e5a30>]}
2022-07-06 06:14:16.443293 (Thread-204): handling poll request
2022-07-06 06:14:16.443708 (Thread-204): 06:14:16  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '659b7287-63c6-4870-93d6-1d76e1b93300', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f687815fd60>]}
2022-07-06 06:14:16.444332 (Thread-204): sending response (<Response 12350 bytes [200 OK]>) to 10.0.38.61
2022-07-06 06:14:16.717360 (Thread-205): handling status request
2022-07-06 06:14:16.717790 (Thread-205): 06:14:16  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '659b7287-63c6-4870-93d6-1d76e1b93300', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f687815f880>]}
2022-07-06 06:14:16.718338 (Thread-205): sending response (<Response 2357 bytes [200 OK]>) to 10.0.38.61
2022-07-06 06:14:16.968290 (Thread-206): handling status request
2022-07-06 06:14:16.968766 (Thread-206): 06:14:16  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '659b7287-63c6-4870-93d6-1d76e1b93300', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6878130be0>]}
2022-07-06 06:14:16.969310 (Thread-206): sending response (<Response 2357 bytes [200 OK]>) to 10.0.38.61
2022-07-06 06:14:18.741455 (Thread-207): handling status request
2022-07-06 06:14:18.741890 (Thread-207): 06:14:18  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '659b7287-63c6-4870-93d6-1d76e1b93300', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f687815f520>]}
2022-07-06 06:14:18.742407 (Thread-207): sending response (<Response 2357 bytes [200 OK]>) to 10.0.38.61
2022-07-06 06:14:19.129807 (Thread-208): handling run_sql request
2022-07-06 06:14:19.130220 (Thread-208): 06:14:19  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '659b7287-63c6-4870-93d6-1d76e1b93300', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f687815f340>]}
2022-07-06 06:14:21.687990 (Thread-208): sending response (<Response 139 bytes [200 OK]>) to 10.0.38.61
2022-07-06 06:14:21.715886 (MainThread): 06:14:21  Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '9e081b8e-8028-4686-8a4f-1c81223aa194', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f54ed79ed00>]}
2022-07-06 06:14:21.716526 (MainThread): 06:14:21  Found 16 models, 0 tests, 0 snapshots, 0 analyses, 181 macros, 0 operations, 0 seed files, 15 sources, 0 exposures, 0 metrics
2022-07-06 06:14:21.717213 (Thread-1): 06:14:21  Acquiring new snowflake connection "rpc.ecommerce_data_model_dbt.request"
2022-07-06 06:14:21.717347 (Thread-1): 06:14:21  Began compiling node rpc.ecommerce_data_model_dbt.request
2022-07-06 06:14:21.717450 (Thread-1): 06:14:21  Compiling rpc.ecommerce_data_model_dbt.request
2022-07-06 06:14:21.720721 (Thread-1): 06:14:21  finished collecting timing info
2022-07-06 06:14:21.720885 (Thread-1): 06:14:21  Began executing node rpc.ecommerce_data_model_dbt.request
2022-07-06 06:14:21.721922 (Thread-1): 06:14:21  Using snowflake connection "rpc.ecommerce_data_model_dbt.request"
2022-07-06 06:14:21.722023 (Thread-1): 06:14:21  On rpc.ecommerce_data_model_dbt.request: select user_id, 
CASE WHEN dateadd(year, datediff (year, properties_birthday, getdate()), properties_birthday) > getdate()
      THEN datediff(year, properties_birthday, getdate()) - 1
      ELSE datediff(year, properties_birthday, getdate())
 END
  as age 
from analytics_db.data_apps_simulated.identifies where timestamp >= '2021-05-01' and timestamp <= '2022-06-29'
and properties_birthday is not null and properties_birthday!=''
limit 500
/* limit added automatically by dbt cloud */
2022-07-06 06:14:21.722286 (Thread-1): 06:14:21  Opening a new connection, currently in state init
2022-07-06 06:14:22.067869 (Thread-209): handling poll request
2022-07-06 06:14:22.068334 (Thread-209): 06:14:22  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '659b7287-63c6-4870-93d6-1d76e1b93300', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f68802270d0>]}
2022-07-06 06:14:22.069297 (Thread-209): sending response (<Response 4231 bytes [200 OK]>) to 10.0.38.61
2022-07-06 06:14:22.924138 (Thread-1): 06:14:22  SQL status: SUCCESS 3 in 1.2 seconds
2022-07-06 06:14:22.925672 (Thread-1): 06:14:22  finished collecting timing info
2022-07-06 06:14:22.925862 (Thread-1): 06:14:22  On rpc.ecommerce_data_model_dbt.request: Close
2022-07-06 06:14:23.519986 (Thread-210): handling poll request
2022-07-06 06:14:23.520408 (Thread-210): 06:14:23  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '659b7287-63c6-4870-93d6-1d76e1b93300', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f68780e5fa0>]}
2022-07-06 06:14:23.521444 (Thread-210): sending response (<Response 4949 bytes [200 OK]>) to 10.0.38.61
2022-07-06 06:14:35.098013 (Thread-211): 06:14:35  Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
2022-07-06 06:14:35.098250 (Thread-211): 06:14:35  Partial parsing enabled, no changes found, skipping parsing
2022-07-06 06:14:35.099023 (Thread-211): 06:14:35  [WARNING]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.data-apps-ecommerce-template.data_model

2022-07-06 06:14:35.105043 (Thread-211): 06:14:35  Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '659b7287-63c6-4870-93d6-1d76e1b93300', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6819fc46d0>]}
2022-07-06 06:14:35.884718 (Thread-212): handling status request
2022-07-06 06:14:35.885178 (Thread-212): 06:14:35  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '659b7287-63c6-4870-93d6-1d76e1b93300', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f68780ae340>]}
2022-07-06 06:14:35.885695 (Thread-212): sending response (<Response 1703 bytes [200 OK]>) to 10.0.38.61
2022-07-06 06:14:35.980402 (Thread-213): handling status request
2022-07-06 06:14:35.980890 (Thread-213): 06:14:35  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '659b7287-63c6-4870-93d6-1d76e1b93300', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f68780e2910>]}
2022-07-06 06:14:35.981426 (Thread-213): sending response (<Response 1703 bytes [200 OK]>) to 10.0.38.61
2022-07-06 06:31:09.155814 (Thread-214): handling status request
2022-07-06 06:31:09.158251 (Thread-214): 06:31:09  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '659b7287-63c6-4870-93d6-1d76e1b93300', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6819fc19a0>]}
2022-07-06 06:31:09.158746 (Thread-214): sending response (<Response 1703 bytes [200 OK]>) to 10.0.38.61
2022-07-06 06:31:09.550613 (Thread-215): handling run_sql request
2022-07-06 06:31:09.551005 (Thread-215): 06:31:09  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '659b7287-63c6-4870-93d6-1d76e1b93300', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6819fc1e80>]}
2022-07-06 06:31:11.927040 (Thread-215): sending response (<Response 139 bytes [200 OK]>) to 10.0.38.61
2022-07-06 06:31:11.956247 (MainThread): 06:31:11  Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '78c62d6d-e634-4fe7-9024-5d686f512012', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8fa2432eb0>]}
2022-07-06 06:31:11.956835 (MainThread): 06:31:11  Found 16 models, 0 tests, 0 snapshots, 0 analyses, 181 macros, 0 operations, 0 seed files, 15 sources, 0 exposures, 0 metrics
2022-07-06 06:31:11.957467 (Thread-1): 06:31:11  Acquiring new snowflake connection "rpc.ecommerce_data_model_dbt.request"
2022-07-06 06:31:11.957602 (Thread-1): 06:31:11  Began compiling node rpc.ecommerce_data_model_dbt.request
2022-07-06 06:31:11.957696 (Thread-1): 06:31:11  Compiling rpc.ecommerce_data_model_dbt.request
2022-07-06 06:31:11.960256 (Thread-1): 06:31:11  finished collecting timing info
2022-07-06 06:31:11.960385 (Thread-1): 06:31:11  Began executing node rpc.ecommerce_data_model_dbt.request
2022-07-06 06:31:11.961420 (Thread-1): 06:31:11  Using snowflake connection "rpc.ecommerce_data_model_dbt.request"
2022-07-06 06:31:11.961516 (Thread-1): 06:31:11  On rpc.ecommerce_data_model_dbt.request: select distinct user_id, 
first_value(properties_country)
over(partition by user_id order by case when properties_country is not null and properties_country != '' then 2 else 1 end desc, timestamp desc) as country,
first_value(properties_state)
over(partition by user_id order by case when properties_state is not null and properties_state != '' then 2 else 1 end desc, timestamp desc) as state
from analytics_db.data_apps_simulated.identifies where timestamp >= '2021-05-01' and timestamp <= '2022-06-29'
and user_id is not null
limit 500
/* limit added automatically by dbt cloud */
2022-07-06 06:31:11.961601 (Thread-1): 06:31:11  Opening a new connection, currently in state init
2022-07-06 06:31:12.330122 (Thread-216): handling poll request
2022-07-06 06:31:12.330601 (Thread-216): 06:31:12  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '659b7287-63c6-4870-93d6-1d76e1b93300', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6819fc4ac0>]}
2022-07-06 06:31:12.331522 (Thread-216): sending response (<Response 4341 bytes [200 OK]>) to 10.0.38.61
2022-07-06 06:31:13.377323 (Thread-1): 06:31:13  SQL status: SUCCESS 5 in 1.42 seconds
2022-07-06 06:31:13.378763 (Thread-1): 06:31:13  finished collecting timing info
2022-07-06 06:31:13.378951 (Thread-1): 06:31:13  On rpc.ecommerce_data_model_dbt.request: Close
2022-07-06 06:31:13.743103 (Thread-217): handling poll request
2022-07-06 06:31:13.743509 (Thread-217): 06:31:13  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '659b7287-63c6-4870-93d6-1d76e1b93300', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6819fc4550>]}
2022-07-06 06:31:13.744464 (Thread-217): sending response (<Response 5821 bytes [200 OK]>) to 10.0.38.61
2022-07-06 06:31:28.694017 (Thread-218): handling status request
2022-07-06 06:31:28.694447 (Thread-218): 06:31:28  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '659b7287-63c6-4870-93d6-1d76e1b93300', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6819fc4eb0>]}
2022-07-06 06:31:28.694961 (Thread-218): sending response (<Response 1703 bytes [200 OK]>) to 10.0.38.61
2022-07-06 06:31:29.059025 (Thread-219): handling run_sql request
2022-07-06 06:31:29.059446 (Thread-219): 06:31:29  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '659b7287-63c6-4870-93d6-1d76e1b93300', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6819fc6790>]}
2022-07-06 06:31:31.502017 (Thread-219): sending response (<Response 139 bytes [200 OK]>) to 10.0.38.61
2022-07-06 06:31:31.483803 (MainThread): 06:31:31  Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'ae96cd1e-8ecb-4861-a718-3a220645dceb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbd57906cd0>]}
2022-07-06 06:31:31.501503 (MainThread): 06:31:31  Found 16 models, 0 tests, 0 snapshots, 0 analyses, 181 macros, 0 operations, 0 seed files, 15 sources, 0 exposures, 0 metrics
2022-07-06 06:31:31.502177 (Thread-1): 06:31:31  Acquiring new snowflake connection "rpc.ecommerce_data_model_dbt.request"
2022-07-06 06:31:31.502317 (Thread-1): 06:31:31  Began compiling node rpc.ecommerce_data_model_dbt.request
2022-07-06 06:31:31.502425 (Thread-1): 06:31:31  Compiling rpc.ecommerce_data_model_dbt.request
2022-07-06 06:31:31.505660 (Thread-1): 06:31:31  finished collecting timing info
2022-07-06 06:31:31.505803 (Thread-1): 06:31:31  Began executing node rpc.ecommerce_data_model_dbt.request
2022-07-06 06:31:31.506894 (Thread-1): 06:31:31  Using snowflake connection "rpc.ecommerce_data_model_dbt.request"
2022-07-06 06:31:31.506995 (Thread-1): 06:31:31  On rpc.ecommerce_data_model_dbt.request: select user_id, email_domain from 
(select user_id,
  case
         when
            lower() like any ('@gmail.com', '@rudderstack.com') 
         then
            lower()
         else
            lower(split_part(, '@', 2)) 
      end
 as email_domain, row_number() over(partition by user_id order by timestamp desc) as rn from 
analytics_db.data_apps_simulated.identifies where timestamp >= '2021-05-01' and timestamp <= '2022-06-29'
and properties_email is not null and properties_email != '') where rn = 1
limit 500
/* limit added automatically by dbt cloud */
2022-07-06 06:31:31.507250 (Thread-1): 06:31:31  Opening a new connection, currently in state init
2022-07-06 06:31:31.895636 (Thread-220): handling poll request
2022-07-06 06:31:31.896150 (Thread-220): 06:31:31  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '659b7287-63c6-4870-93d6-1d76e1b93300', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6878043160>]}
2022-07-06 06:31:31.897119 (Thread-220): sending response (<Response 4323 bytes [200 OK]>) to 10.0.38.61
2022-07-06 06:31:32.258831 (Thread-1): 06:31:32  Snowflake adapter: Snowflake query id: 01a56b67-0602-3316-0019-82030469a0ee
2022-07-06 06:31:32.259111 (Thread-1): 06:31:32  Snowflake adapter: Snowflake error: 001003 (42000): SQL compilation error:
syntax error line 9 at position 29 unexpected ','.
syntax error line 9 at position 29 unexpected ','.
syntax error line 9 at position 38 unexpected ')'.
2022-07-06 06:31:32.259340 (Thread-1): 06:31:32  finished collecting timing info
2022-07-06 06:31:32.259566 (Thread-1): 06:31:32  On rpc.ecommerce_data_model_dbt.request: Close
2022-07-06 06:31:32.478793 (Thread-1): Got an exception: Database Error
  001003 (42000): SQL compilation error:
  syntax error line 9 at position 29 unexpected ','.
  syntax error line 9 at position 29 unexpected ','.
  syntax error line 9 at position 38 unexpected ')'.
Traceback (most recent call last):
  File "/usr/local/lib/python3.8/dist-packages/dbt/adapters/snowflake/connections.py", line 206, in exception_handler
    yield
  File "/usr/local/lib/python3.8/dist-packages/dbt/adapters/sql/connections.py", line 74, in add_query
    cursor.execute(sql, bindings)
  File "/usr/local/lib/python3.8/dist-packages/snowflake/connector/cursor.py", line 721, in execute
    Error.errorhandler_wrapper(
  File "/usr/local/lib/python3.8/dist-packages/snowflake/connector/errors.py", line 258, in errorhandler_wrapper
    cursor.errorhandler(connection, cursor, error_class, error_value)
  File "/usr/local/lib/python3.8/dist-packages/snowflake/connector/errors.py", line 188, in default_errorhandler
    raise error_class(
snowflake.connector.errors.ProgrammingError: 001003 (42000): SQL compilation error:
syntax error line 9 at position 29 unexpected ','.
syntax error line 9 at position 29 unexpected ','.
syntax error line 9 at position 38 unexpected ')'.

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/usr/local/lib/python3.8/dist-packages/dbt/task/base.py", line 361, in safe_run
    result = self.compile_and_execute(manifest, ctx)
  File "/usr/local/lib/python3.8/dist-packages/dbt/task/base.py", line 314, in compile_and_execute
    result = self.run(ctx.node, manifest)
  File "/usr/local/lib/python3.8/dist-packages/dbt/task/base.py", line 403, in run
    return self.execute(compiled_node, manifest)
  File "/usr/local/lib/python3.8/dist-packages/dbt_rpc/rpc/node_runners.py", line 90, in execute
    _, execute_result = self.adapter.execute(
  File "/usr/local/lib/python3.8/dist-packages/dbt/adapters/base/impl.py", line 225, in execute
    return self.connections.execute(
  File "/usr/local/lib/python3.8/dist-packages/dbt/adapters/sql/connections.py", line 127, in execute
    _, cursor = self.add_query(sql, auto_begin)
  File "/usr/local/lib/python3.8/dist-packages/dbt/adapters/snowflake/connections.py", line 433, in add_query
    connection, cursor = super().add_query(
  File "/usr/local/lib/python3.8/dist-packages/dbt/adapters/sql/connections.py", line 83, in add_query
    return connection, cursor
  File "/usr/lib/python3.8/contextlib.py", line 131, in __exit__
    self.gen.throw(type, value, traceback)
  File "/usr/local/lib/python3.8/dist-packages/dbt/adapters/snowflake/connections.py", line 223, in exception_handler
    raise DatabaseException(msg)
dbt.exceptions.DatabaseException: Database Error
  001003 (42000): SQL compilation error:
  syntax error line 9 at position 29 unexpected ','.
  syntax error line 9 at position 29 unexpected ','.
  syntax error line 9 at position 38 unexpected ')'.
2022-07-06 06:31:32.479774 (Thread-1): Got exception RPCException(10003, Database Error, {'type': 'DatabaseException', 'message': "Database Error in rpc request (from remote system)\n  001003 (42000): SQL compilation error:\n  syntax error line 9 at position 29 unexpected ','.\n  syntax error line 9 at position 29 unexpected ','.\n  syntax error line 9 at position 38 unexpected ')'.", 'raw_sql': "select user_id, email_domain from \r\n(select user_id,{{get_domain_from_email(properties_email)}} as email_domain, row_number() over(partition by user_id order by timestamp desc) as rn from \r\n{{ source('ecommerce', 'identifies') }} where timestamp >= '{{ var('start_date') }}' and timestamp <= '{{ var('end_date') }}'\r\nand properties_email is not null and properties_email != '') where rn = 1\nlimit 500\n/* limit added automatically by dbt cloud */", 'compiled_sql': "select user_id, email_domain from \n(select user_id,\n  case\n         when\n            lower() like any ('@gmail.com', '@rudderstack.com') \n         then\n            lower()\n         else\n            lower(split_part(, '@', 2)) \n      end\n as email_domain, row_number() over(partition by user_id order by timestamp desc) as rn from \nanalytics_db.data_apps_simulated.identifies where timestamp >= '2021-05-01' and timestamp <= '2022-06-29'\nand properties_email is not null and properties_email != '') where rn = 1\nlimit 500\n/* limit added automatically by dbt cloud */", 'tags': None}, None)
Traceback (most recent call last):
  File "/usr/local/lib/python3.8/dist-packages/dbt_rpc/task/sql_commands.py", line 147, in _in_thread
    self.node_results.append(runner.safe_run(self.manifest))
  File "/usr/local/lib/python3.8/dist-packages/dbt/task/base.py", line 377, in safe_run
    result = self.error_result(ctx.node, error, started, [])
  File "/usr/local/lib/python3.8/dist-packages/dbt_rpc/rpc/node_runners.py", line 56, in error_result
    raise error
dbt_rpc.rpc.error.RPCException: RPCException(10003, Database Error, {'type': 'DatabaseException', 'message': "Database Error in rpc request (from remote system)\n  001003 (42000): SQL compilation error:\n  syntax error line 9 at position 29 unexpected ','.\n  syntax error line 9 at position 29 unexpected ','.\n  syntax error line 9 at position 38 unexpected ')'.", 'raw_sql': "select user_id, email_domain from \r\n(select user_id,{{get_domain_from_email(properties_email)}} as email_domain, row_number() over(partition by user_id order by timestamp desc) as rn from \r\n{{ source('ecommerce', 'identifies') }} where timestamp >= '{{ var('start_date') }}' and timestamp <= '{{ var('end_date') }}'\r\nand properties_email is not null and properties_email != '') where rn = 1\nlimit 500\n/* limit added automatically by dbt cloud */", 'compiled_sql': "select user_id, email_domain from \n(select user_id,\n  case\n         when\n            lower() like any ('@gmail.com', '@rudderstack.com') \n         then\n            lower()\n         else\n            lower(split_part(, '@', 2)) \n      end\n as email_domain, row_number() over(partition by user_id order by timestamp desc) as rn from \nanalytics_db.data_apps_simulated.identifies where timestamp >= '2021-05-01' and timestamp <= '2022-06-29'\nand properties_email is not null and properties_email != '') where rn = 1\nlimit 500\n/* limit added automatically by dbt cloud */", 'tags': None}, None)
2022-07-06 06:31:33.288925 (Thread-221): handling poll request
2022-07-06 06:31:33.289363 (Thread-221): 06:31:33  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '659b7287-63c6-4870-93d6-1d76e1b93300', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6878043460>]}
2022-07-06 06:31:33.290017 (Thread-221): sending response (<Response 13826 bytes [200 OK]>) to 10.0.38.61
2022-07-06 06:31:35.870856 (Thread-222): handling status request
2022-07-06 06:31:35.871288 (Thread-222): 06:31:35  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '659b7287-63c6-4870-93d6-1d76e1b93300', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f68780438e0>]}
2022-07-06 06:31:35.871827 (Thread-222): sending response (<Response 1703 bytes [200 OK]>) to 10.0.38.61
2022-07-06 06:31:36.244147 (Thread-223): handling run_sql request
2022-07-06 06:31:36.244570 (Thread-223): 06:31:36  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '659b7287-63c6-4870-93d6-1d76e1b93300', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6878043ac0>]}
2022-07-06 06:31:38.617707 (Thread-223): sending response (<Response 139 bytes [200 OK]>) to 10.0.38.61
2022-07-06 06:31:38.644562 (MainThread): 06:31:38  Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '25da1c7e-014c-4c48-97f2-908a8fcb7fd8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff23111ebe0>]}
2022-07-06 06:31:38.645165 (MainThread): 06:31:38  Found 16 models, 0 tests, 0 snapshots, 0 analyses, 181 macros, 0 operations, 0 seed files, 15 sources, 0 exposures, 0 metrics
2022-07-06 06:31:38.645795 (Thread-1): 06:31:38  Acquiring new snowflake connection "rpc.ecommerce_data_model_dbt.request"
2022-07-06 06:31:38.645945 (Thread-1): 06:31:38  Began compiling node rpc.ecommerce_data_model_dbt.request
2022-07-06 06:31:38.646049 (Thread-1): 06:31:38  Compiling rpc.ecommerce_data_model_dbt.request
2022-07-06 06:31:38.648857 (Thread-1): 06:31:38  finished collecting timing info
2022-07-06 06:31:38.649018 (Thread-1): 06:31:38  Began executing node rpc.ecommerce_data_model_dbt.request
2022-07-06 06:31:38.649952 (Thread-1): 06:31:38  Using snowflake connection "rpc.ecommerce_data_model_dbt.request"
2022-07-06 06:31:38.650048 (Thread-1): 06:31:38  On rpc.ecommerce_data_model_dbt.request: select user_id, email_domain from 
(select user_id,
  case
         when
            lower() like any ('@gmail.com', '@rudderstack.com') 
         then
            lower()
         else
            lower(split_part(, '@', 2)) 
      end
 as email_domain, row_number() over(partition by user_id order by timestamp desc) as rn from 
analytics_db.data_apps_simulated.identifies where timestamp >= '2021-05-01' and timestamp <= '2022-06-29'
and properties_email is not null and properties_email != '') where rn = 1
limit 500
/* limit added automatically by dbt cloud */
2022-07-06 06:31:38.650132 (Thread-1): 06:31:38  Opening a new connection, currently in state init
2022-07-06 06:31:38.987040 (Thread-224): handling poll request
2022-07-06 06:31:38.987529 (Thread-224): 06:31:38  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '659b7287-63c6-4870-93d6-1d76e1b93300', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f68801a6eb0>]}
2022-07-06 06:31:38.988455 (Thread-224): sending response (<Response 4323 bytes [200 OK]>) to 10.0.38.61
2022-07-06 06:31:39.106485 (Thread-1): 06:31:39  Snowflake adapter: Snowflake query id: 01a56b67-0602-2ed5-0019-8203046971ba
2022-07-06 06:31:39.106685 (Thread-1): 06:31:39  Snowflake adapter: Snowflake error: 001003 (42000): SQL compilation error:
syntax error line 9 at position 29 unexpected ','.
syntax error line 9 at position 29 unexpected ','.
syntax error line 9 at position 38 unexpected ')'.
2022-07-06 06:31:39.106850 (Thread-1): 06:31:39  finished collecting timing info
2022-07-06 06:31:39.107010 (Thread-1): 06:31:39  On rpc.ecommerce_data_model_dbt.request: Close
2022-07-06 06:31:39.158997 (Thread-1): Got an exception: Database Error
  001003 (42000): SQL compilation error:
  syntax error line 9 at position 29 unexpected ','.
  syntax error line 9 at position 29 unexpected ','.
  syntax error line 9 at position 38 unexpected ')'.
Traceback (most recent call last):
  File "/usr/local/lib/python3.8/dist-packages/dbt/adapters/snowflake/connections.py", line 206, in exception_handler
    yield
  File "/usr/local/lib/python3.8/dist-packages/dbt/adapters/sql/connections.py", line 74, in add_query
    cursor.execute(sql, bindings)
  File "/usr/local/lib/python3.8/dist-packages/snowflake/connector/cursor.py", line 721, in execute
    Error.errorhandler_wrapper(
  File "/usr/local/lib/python3.8/dist-packages/snowflake/connector/errors.py", line 258, in errorhandler_wrapper
    cursor.errorhandler(connection, cursor, error_class, error_value)
  File "/usr/local/lib/python3.8/dist-packages/snowflake/connector/errors.py", line 188, in default_errorhandler
    raise error_class(
snowflake.connector.errors.ProgrammingError: 001003 (42000): SQL compilation error:
syntax error line 9 at position 29 unexpected ','.
syntax error line 9 at position 29 unexpected ','.
syntax error line 9 at position 38 unexpected ')'.

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/usr/local/lib/python3.8/dist-packages/dbt/task/base.py", line 361, in safe_run
    result = self.compile_and_execute(manifest, ctx)
  File "/usr/local/lib/python3.8/dist-packages/dbt/task/base.py", line 314, in compile_and_execute
    result = self.run(ctx.node, manifest)
  File "/usr/local/lib/python3.8/dist-packages/dbt/task/base.py", line 403, in run
    return self.execute(compiled_node, manifest)
  File "/usr/local/lib/python3.8/dist-packages/dbt_rpc/rpc/node_runners.py", line 90, in execute
    _, execute_result = self.adapter.execute(
  File "/usr/local/lib/python3.8/dist-packages/dbt/adapters/base/impl.py", line 225, in execute
    return self.connections.execute(
  File "/usr/local/lib/python3.8/dist-packages/dbt/adapters/sql/connections.py", line 127, in execute
    _, cursor = self.add_query(sql, auto_begin)
  File "/usr/local/lib/python3.8/dist-packages/dbt/adapters/snowflake/connections.py", line 433, in add_query
    connection, cursor = super().add_query(
  File "/usr/local/lib/python3.8/dist-packages/dbt/adapters/sql/connections.py", line 83, in add_query
    return connection, cursor
  File "/usr/lib/python3.8/contextlib.py", line 131, in __exit__
    self.gen.throw(type, value, traceback)
  File "/usr/local/lib/python3.8/dist-packages/dbt/adapters/snowflake/connections.py", line 223, in exception_handler
    raise DatabaseException(msg)
dbt.exceptions.DatabaseException: Database Error
  001003 (42000): SQL compilation error:
  syntax error line 9 at position 29 unexpected ','.
  syntax error line 9 at position 29 unexpected ','.
  syntax error line 9 at position 38 unexpected ')'.
2022-07-06 06:31:39.159945 (Thread-1): Got exception RPCException(10003, Database Error, {'type': 'DatabaseException', 'message': "Database Error in rpc request (from remote system)\n  001003 (42000): SQL compilation error:\n  syntax error line 9 at position 29 unexpected ','.\n  syntax error line 9 at position 29 unexpected ','.\n  syntax error line 9 at position 38 unexpected ')'.", 'raw_sql': "select user_id, email_domain from \r\n(select user_id,{{get_domain_from_email(properties_email)}} as email_domain, row_number() over(partition by user_id order by timestamp desc) as rn from \r\n{{ source('ecommerce', 'identifies') }} where timestamp >= '{{ var('start_date') }}' and timestamp <= '{{ var('end_date') }}'\r\nand properties_email is not null and properties_email != '') where rn = 1\nlimit 500\n/* limit added automatically by dbt cloud */", 'compiled_sql': "select user_id, email_domain from \n(select user_id,\n  case\n         when\n            lower() like any ('@gmail.com', '@rudderstack.com') \n         then\n            lower()\n         else\n            lower(split_part(, '@', 2)) \n      end\n as email_domain, row_number() over(partition by user_id order by timestamp desc) as rn from \nanalytics_db.data_apps_simulated.identifies where timestamp >= '2021-05-01' and timestamp <= '2022-06-29'\nand properties_email is not null and properties_email != '') where rn = 1\nlimit 500\n/* limit added automatically by dbt cloud */", 'tags': None}, None)
Traceback (most recent call last):
  File "/usr/local/lib/python3.8/dist-packages/dbt_rpc/task/sql_commands.py", line 147, in _in_thread
    self.node_results.append(runner.safe_run(self.manifest))
  File "/usr/local/lib/python3.8/dist-packages/dbt/task/base.py", line 377, in safe_run
    result = self.error_result(ctx.node, error, started, [])
  File "/usr/local/lib/python3.8/dist-packages/dbt_rpc/rpc/node_runners.py", line 56, in error_result
    raise error
dbt_rpc.rpc.error.RPCException: RPCException(10003, Database Error, {'type': 'DatabaseException', 'message': "Database Error in rpc request (from remote system)\n  001003 (42000): SQL compilation error:\n  syntax error line 9 at position 29 unexpected ','.\n  syntax error line 9 at position 29 unexpected ','.\n  syntax error line 9 at position 38 unexpected ')'.", 'raw_sql': "select user_id, email_domain from \r\n(select user_id,{{get_domain_from_email(properties_email)}} as email_domain, row_number() over(partition by user_id order by timestamp desc) as rn from \r\n{{ source('ecommerce', 'identifies') }} where timestamp >= '{{ var('start_date') }}' and timestamp <= '{{ var('end_date') }}'\r\nand properties_email is not null and properties_email != '') where rn = 1\nlimit 500\n/* limit added automatically by dbt cloud */", 'compiled_sql': "select user_id, email_domain from \n(select user_id,\n  case\n         when\n            lower() like any ('@gmail.com', '@rudderstack.com') \n         then\n            lower()\n         else\n            lower(split_part(, '@', 2)) \n      end\n as email_domain, row_number() over(partition by user_id order by timestamp desc) as rn from \nanalytics_db.data_apps_simulated.identifies where timestamp >= '2021-05-01' and timestamp <= '2022-06-29'\nand properties_email is not null and properties_email != '') where rn = 1\nlimit 500\n/* limit added automatically by dbt cloud */", 'tags': None}, None)
2022-07-06 06:31:40.414535 (Thread-225): handling poll request
2022-07-06 06:31:40.414959 (Thread-225): 06:31:40  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '659b7287-63c6-4870-93d6-1d76e1b93300', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6819fc4d00>]}
2022-07-06 06:31:40.415683 (Thread-225): sending response (<Response 13826 bytes [200 OK]>) to 10.0.38.61
2022-07-06 06:31:43.032212 (Thread-226): handling status request
2022-07-06 06:31:43.032645 (Thread-226): 06:31:43  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '659b7287-63c6-4870-93d6-1d76e1b93300', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f68780f3520>]}
2022-07-06 06:31:43.033227 (Thread-226): sending response (<Response 1703 bytes [200 OK]>) to 10.0.38.61
2022-07-06 06:31:43.407028 (Thread-227): handling compile_sql request
2022-07-06 06:31:43.407461 (Thread-227): 06:31:43  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '659b7287-63c6-4870-93d6-1d76e1b93300', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f68780f3700>]}
2022-07-06 06:31:45.819223 (Thread-227): sending response (<Response 139 bytes [200 OK]>) to 10.0.38.61
2022-07-06 06:31:45.846846 (MainThread): 06:31:45  Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '4160d42f-fb04-4cf0-bd57-158dcc40967c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0c3f95eb20>]}
2022-07-06 06:31:45.847441 (MainThread): 06:31:45  Found 16 models, 0 tests, 0 snapshots, 0 analyses, 181 macros, 0 operations, 0 seed files, 15 sources, 0 exposures, 0 metrics
2022-07-06 06:31:45.848066 (Thread-1): 06:31:45  Acquiring new snowflake connection "rpc.ecommerce_data_model_dbt.request"
2022-07-06 06:31:45.848203 (Thread-1): 06:31:45  Began compiling node rpc.ecommerce_data_model_dbt.request
2022-07-06 06:31:45.848306 (Thread-1): 06:31:45  Compiling rpc.ecommerce_data_model_dbt.request
2022-07-06 06:31:45.851261 (Thread-1): 06:31:45  finished collecting timing info
2022-07-06 06:31:45.851399 (Thread-1): 06:31:45  Began executing node rpc.ecommerce_data_model_dbt.request
2022-07-06 06:31:45.851501 (Thread-1): 06:31:45  finished collecting timing info
2022-07-06 06:31:46.188133 (Thread-228): handling poll request
2022-07-06 06:31:46.188606 (Thread-228): 06:31:46  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '659b7287-63c6-4870-93d6-1d76e1b93300', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6819ff3880>]}
2022-07-06 06:31:46.189844 (Thread-228): sending response (<Response 7169 bytes [200 OK]>) to 10.0.38.61
2022-07-06 06:32:59.760792 (Thread-229): handling status request
2022-07-06 06:32:59.761257 (Thread-229): 06:32:59  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '659b7287-63c6-4870-93d6-1d76e1b93300', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6819ff3a60>]}
2022-07-06 06:32:59.761770 (Thread-229): sending response (<Response 1703 bytes [200 OK]>) to 10.0.38.61
2022-07-06 06:33:00.140296 (Thread-230): handling compile_sql request
2022-07-06 06:33:00.140726 (Thread-230): 06:33:00  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '659b7287-63c6-4870-93d6-1d76e1b93300', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6819ff3b20>]}
2022-07-06 06:33:02.574049 (Thread-230): sending response (<Response 139 bytes [200 OK]>) to 10.0.38.61
2022-07-06 06:33:02.605351 (MainThread): 06:33:02  Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '3ef19d0f-538a-4c97-bf83-1f1a173f8dab', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc98cb9ebe0>]}
2022-07-06 06:33:02.605974 (MainThread): 06:33:02  Found 16 models, 0 tests, 0 snapshots, 0 analyses, 181 macros, 0 operations, 0 seed files, 15 sources, 0 exposures, 0 metrics
2022-07-06 06:33:02.606605 (Thread-1): 06:33:02  Acquiring new snowflake connection "rpc.ecommerce_data_model_dbt.request"
2022-07-06 06:33:02.606750 (Thread-1): 06:33:02  Began compiling node rpc.ecommerce_data_model_dbt.request
2022-07-06 06:33:02.606846 (Thread-1): 06:33:02  Compiling rpc.ecommerce_data_model_dbt.request
2022-07-06 06:33:02.609958 (Thread-1): 06:33:02  finished collecting timing info
2022-07-06 06:33:02.610102 (Thread-1): 06:33:02  Began executing node rpc.ecommerce_data_model_dbt.request
2022-07-06 06:33:02.610202 (Thread-1): 06:33:02  finished collecting timing info
2022-07-06 06:33:02.984399 (Thread-231): handling poll request
2022-07-06 06:33:02.984899 (Thread-231): 06:33:02  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '659b7287-63c6-4870-93d6-1d76e1b93300', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6819fd0d60>]}
2022-07-06 06:33:02.986106 (Thread-231): sending response (<Response 7169 bytes [200 OK]>) to 10.0.38.61
2022-07-06 06:34:18.664465 (Thread-232): 06:34:18  Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
2022-07-06 06:34:18.665129 (Thread-232): 06:34:18  Partial parsing: updated file: ecommerce_data_model_dbt://models/data_model/temp_folder/email_domain.sql
2022-07-06 06:34:18.669623 (Thread-232): 06:34:18  1603: static parser failed on data_model/temp_folder/email_domain.sql
2022-07-06 06:34:18.674269 (Thread-232): 06:34:18  1602: parser fallback to jinja rendering on data_model/temp_folder/email_domain.sql
2022-07-06 06:34:18.730291 (Thread-232): 06:34:18  [WARNING]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.data-apps-ecommerce-template.data_model

2022-07-06 06:34:18.736009 (Thread-232): 06:34:18  Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '659b7287-63c6-4870-93d6-1d76e1b93300', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6819f7f070>]}
2022-07-06 06:34:19.401654 (Thread-233): handling status request
2022-07-06 06:34:19.402081 (Thread-233): 06:34:19  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '659b7287-63c6-4870-93d6-1d76e1b93300', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6819f2ab20>]}
2022-07-06 06:34:19.423486 (Thread-233): sending response (<Response 2384 bytes [200 OK]>) to 10.0.38.61
2022-07-06 06:34:19.485348 (Thread-234): handling status request
2022-07-06 06:34:19.485810 (Thread-234): 06:34:19  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '659b7287-63c6-4870-93d6-1d76e1b93300', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6819f2aee0>]}
2022-07-06 06:34:19.486303 (Thread-234): sending response (<Response 2384 bytes [200 OK]>) to 10.0.38.61
2022-07-06 06:34:20.053441 (Thread-235): handling status request
2022-07-06 06:34:20.053915 (Thread-235): 06:34:20  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '659b7287-63c6-4870-93d6-1d76e1b93300', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f68780ae610>]}
2022-07-06 06:34:20.054448 (Thread-235): sending response (<Response 2384 bytes [200 OK]>) to 10.0.38.61
2022-07-06 06:34:20.440806 (Thread-236): handling run_sql request
2022-07-06 06:34:20.441250 (Thread-236): 06:34:20  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '659b7287-63c6-4870-93d6-1d76e1b93300', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6819f2adf0>]}
2022-07-06 06:34:22.858179 (Thread-236): sending response (<Response 139 bytes [200 OK]>) to 10.0.38.61
2022-07-06 06:34:22.886064 (MainThread): 06:34:22  Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '9c2f3f7e-9c96-4f6a-abe2-e2e705e720e3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0f8d425d90>]}
2022-07-06 06:34:22.886704 (MainThread): 06:34:22  Found 16 models, 0 tests, 0 snapshots, 0 analyses, 181 macros, 0 operations, 0 seed files, 15 sources, 0 exposures, 0 metrics
2022-07-06 06:34:22.887339 (Thread-1): 06:34:22  Acquiring new snowflake connection "rpc.ecommerce_data_model_dbt.request"
2022-07-06 06:34:22.887477 (Thread-1): 06:34:22  Began compiling node rpc.ecommerce_data_model_dbt.request
2022-07-06 06:34:22.887578 (Thread-1): 06:34:22  Compiling rpc.ecommerce_data_model_dbt.request
2022-07-06 06:34:22.890618 (Thread-1): 06:34:22  finished collecting timing info
2022-07-06 06:34:22.890757 (Thread-1): 06:34:22  Began executing node rpc.ecommerce_data_model_dbt.request
2022-07-06 06:34:22.891840 (Thread-1): 06:34:22  Using snowflake connection "rpc.ecommerce_data_model_dbt.request"
2022-07-06 06:34:22.891943 (Thread-1): 06:34:22  On rpc.ecommerce_data_model_dbt.request: select user_id, email_domain from 
(select user_id,
  case
         when
            lower(properties_email) like any ('@gmail.com', '@rudderstack.com') 
         then
            lower(properties_email)
         else
            lower(split_part(properties_email, '@', 2)) 
      end
 as email_domain, row_number() over(partition by user_id order by timestamp desc) as rn from 
analytics_db.data_apps_simulated.identifies where timestamp >= '2021-05-01' and timestamp <= '2022-06-29'
and properties_email is not null and properties_email != '') where rn = 1
limit 500
/* limit added automatically by dbt cloud */
2022-07-06 06:34:22.892036 (Thread-1): 06:34:22  Opening a new connection, currently in state init
2022-07-06 06:34:23.223069 (Thread-237): handling poll request
2022-07-06 06:34:23.223561 (Thread-237): 06:34:23  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '659b7287-63c6-4870-93d6-1d76e1b93300', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6819fd9b20>]}
2022-07-06 06:34:23.224513 (Thread-237): sending response (<Response 4371 bytes [200 OK]>) to 10.0.38.61
2022-07-06 06:34:24.243189 (Thread-1): 06:34:24  SQL status: SUCCESS 5 in 1.35 seconds
2022-07-06 06:34:24.244635 (Thread-1): 06:34:24  finished collecting timing info
2022-07-06 06:34:24.244828 (Thread-1): 06:34:24  On rpc.ecommerce_data_model_dbt.request: Close
2022-07-06 06:34:24.605248 (Thread-238): handling poll request
2022-07-06 06:34:24.605659 (Thread-238): 06:34:24  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '659b7287-63c6-4870-93d6-1d76e1b93300', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6819f7f1f0>]}
2022-07-06 06:34:24.606617 (Thread-238): sending response (<Response 5578 bytes [200 OK]>) to 10.0.38.61
2022-07-06 06:35:27.623631 (Thread-239): 06:35:27  Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
2022-07-06 06:35:27.624190 (Thread-239): 06:35:27  Partial parsing: updated file: ecommerce_data_model_dbt://macros/get_domain_from_email.sql
2022-07-06 06:35:27.624380 (Thread-239): 06:35:27  Parsing macros/get_domain_from_email.sql
2022-07-06 06:35:27.629738 (Thread-239): 06:35:27  1603: static parser failed on data_model/temp_folder/email_domain.sql
2022-07-06 06:35:27.634955 (Thread-239): 06:35:27  1602: parser fallback to jinja rendering on data_model/temp_folder/email_domain.sql
2022-07-06 06:35:27.670929 (Thread-239): 06:35:27  [WARNING]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.data-apps-ecommerce-template.data_model

2022-07-06 06:35:27.676550 (Thread-239): 06:35:27  Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '659b7287-63c6-4870-93d6-1d76e1b93300', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6819e35e80>]}
2022-07-06 06:35:28.389885 (Thread-240): handling status request
2022-07-06 06:35:28.390321 (Thread-240): 06:35:28  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '659b7287-63c6-4870-93d6-1d76e1b93300', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6819ea2280>]}
2022-07-06 06:35:28.390851 (Thread-240): sending response (<Response 2652 bytes [200 OK]>) to 10.0.38.61
2022-07-06 06:35:28.430044 (Thread-241): handling status request
2022-07-06 06:35:28.430491 (Thread-241): 06:35:28  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '659b7287-63c6-4870-93d6-1d76e1b93300', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6819ea2130>]}
2022-07-06 06:35:28.431002 (Thread-241): sending response (<Response 2652 bytes [200 OK]>) to 10.0.38.61
2022-07-06 06:35:36.909931 (Thread-242): 06:35:36  Unable to do partial parsing because a project config has changed
2022-07-06 06:35:36.910338 (Thread-242): 06:35:36  Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '659b7287-63c6-4870-93d6-1d76e1b93300', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f687815f3d0>]}
2022-07-06 06:35:36.978872 (Thread-242): 06:35:36  Parsing macros/get_age_from_dob.sql
2022-07-06 06:35:36.979744 (Thread-242): 06:35:36  Parsing macros/get_domain_from_email.sql
2022-07-06 06:35:36.980370 (Thread-242): 06:35:36  Parsing macros/adapters.sql
2022-07-06 06:35:37.019140 (Thread-242): 06:35:37  Parsing macros/catalog.sql
2022-07-06 06:35:37.021102 (Thread-242): 06:35:37  Parsing macros/materializations/table.sql
2022-07-06 06:35:37.024190 (Thread-242): 06:35:37  Parsing macros/materializations/seed.sql
2022-07-06 06:35:37.029272 (Thread-242): 06:35:37  Parsing macros/materializations/incremental.sql
2022-07-06 06:35:37.037790 (Thread-242): 06:35:37  Parsing macros/materializations/merge.sql
2022-07-06 06:35:37.041732 (Thread-242): 06:35:37  Parsing macros/materializations/snapshot.sql
2022-07-06 06:35:37.042750 (Thread-242): 06:35:37  Parsing macros/materializations/view.sql
2022-07-06 06:35:37.044097 (Thread-242): 06:35:37  Parsing macros/adapters/metadata.sql
2022-07-06 06:35:37.051209 (Thread-242): 06:35:37  Parsing macros/adapters/columns.sql
2022-07-06 06:35:37.060903 (Thread-242): 06:35:37  Parsing macros/adapters/freshness.sql
2022-07-06 06:35:37.063824 (Thread-242): 06:35:37  Parsing macros/adapters/persist_docs.sql
2022-07-06 06:35:37.068139 (Thread-242): 06:35:37  Parsing macros/adapters/relation.sql
2022-07-06 06:35:37.077509 (Thread-242): 06:35:37  Parsing macros/adapters/schema.sql
2022-07-06 06:35:37.079686 (Thread-242): 06:35:37  Parsing macros/adapters/indexes.sql
2022-07-06 06:35:37.082371 (Thread-242): 06:35:37  Parsing macros/get_custom_name/get_custom_schema.sql
2022-07-06 06:35:37.084802 (Thread-242): 06:35:37  Parsing macros/get_custom_name/get_custom_alias.sql
2022-07-06 06:35:37.086341 (Thread-242): 06:35:37  Parsing macros/get_custom_name/get_custom_database.sql
2022-07-06 06:35:37.087890 (Thread-242): 06:35:37  Parsing macros/etc/datetime.sql
2022-07-06 06:35:37.096076 (Thread-242): 06:35:37  Parsing macros/etc/statement.sql
2022-07-06 06:35:37.100426 (Thread-242): 06:35:37  Parsing macros/generic_test_sql/unique.sql
2022-07-06 06:35:37.101181 (Thread-242): 06:35:37  Parsing macros/generic_test_sql/not_null.sql
2022-07-06 06:35:37.101768 (Thread-242): 06:35:37  Parsing macros/generic_test_sql/accepted_values.sql
2022-07-06 06:35:37.103119 (Thread-242): 06:35:37  Parsing macros/generic_test_sql/relationships.sql
2022-07-06 06:35:37.103984 (Thread-242): 06:35:37  Parsing macros/materializations/configs.sql
2022-07-06 06:35:37.106258 (Thread-242): 06:35:37  Parsing macros/materializations/hooks.sql
2022-07-06 06:35:37.110021 (Thread-242): 06:35:37  Parsing macros/materializations/models/table/table.sql
2022-07-06 06:35:37.117383 (Thread-242): 06:35:37  Parsing macros/materializations/models/table/create_table_as.sql
2022-07-06 06:35:37.120177 (Thread-242): 06:35:37  Parsing macros/materializations/models/view/create_or_replace_view.sql
2022-07-06 06:35:37.122820 (Thread-242): 06:35:37  Parsing macros/materializations/models/view/helpers.sql
2022-07-06 06:35:37.124121 (Thread-242): 06:35:37  Parsing macros/materializations/models/view/create_view_as.sql
2022-07-06 06:35:37.126424 (Thread-242): 06:35:37  Parsing macros/materializations/models/view/view.sql
2022-07-06 06:35:37.133723 (Thread-242): 06:35:37  Parsing macros/materializations/models/incremental/incremental.sql
2022-07-06 06:35:37.143622 (Thread-242): 06:35:37  Parsing macros/materializations/models/incremental/on_schema_change.sql
2022-07-06 06:35:37.159314 (Thread-242): 06:35:37  Parsing macros/materializations/models/incremental/is_incremental.sql
2022-07-06 06:35:37.160992 (Thread-242): 06:35:37  Parsing macros/materializations/models/incremental/merge.sql
2022-07-06 06:35:37.172347 (Thread-242): 06:35:37  Parsing macros/materializations/models/incremental/column_helpers.sql
2022-07-06 06:35:37.176883 (Thread-242): 06:35:37  Parsing macros/materializations/seeds/helpers.sql
2022-07-06 06:35:37.193225 (Thread-242): 06:35:37  Parsing macros/materializations/seeds/seed.sql
2022-07-06 06:35:37.199264 (Thread-242): 06:35:37  Parsing macros/materializations/tests/helpers.sql
2022-07-06 06:35:37.201155 (Thread-242): 06:35:37  Parsing macros/materializations/tests/test.sql
2022-07-06 06:35:37.205578 (Thread-242): 06:35:37  Parsing macros/materializations/tests/where_subquery.sql
2022-07-06 06:35:37.207454 (Thread-242): 06:35:37  Parsing macros/materializations/snapshots/helpers.sql
2022-07-06 06:35:37.218737 (Thread-242): 06:35:37  Parsing macros/materializations/snapshots/strategies.sql
2022-07-06 06:35:37.235423 (Thread-242): 06:35:37  Parsing macros/materializations/snapshots/snapshot_merge.sql
2022-07-06 06:35:37.237220 (Thread-242): 06:35:37  Parsing macros/materializations/snapshots/snapshot.sql
2022-07-06 06:35:37.248719 (Thread-242): 06:35:37  Parsing tests/generic/builtin.sql
2022-07-06 06:35:37.434307 (Thread-242): 06:35:37  1603: static parser failed on data_model/stg_user_traits.sql
2022-07-06 06:35:37.443894 (Thread-242): 06:35:37  1602: parser fallback to jinja rendering on data_model/stg_user_traits.sql
2022-07-06 06:35:37.445203 (Thread-242): 06:35:37  1603: static parser failed on data_model/stg_products_viewed.sql
2022-07-06 06:35:37.448842 (Thread-242): 06:35:37  1602: parser fallback to jinja rendering on data_model/stg_products_viewed.sql
2022-07-06 06:35:37.450127 (Thread-242): 06:35:37  1699: static parser successfully parsed data_model/feat_user_features.sql
2022-07-06 06:35:37.452106 (Thread-242): 06:35:37  1699: static parser successfully parsed data_model/stg_user_properties.sql
2022-07-06 06:35:37.454059 (Thread-242): 06:35:37  1699: static parser successfully parsed data_model/stg_tracks.sql
2022-07-06 06:35:37.456203 (Thread-242): 06:35:37  1603: static parser failed on data_model/temp_folder/country_and_state.sql
2022-07-06 06:35:37.459960 (Thread-242): 06:35:37  1602: parser fallback to jinja rendering on data_model/temp_folder/country_and_state.sql
2022-07-06 06:35:37.460996 (Thread-242): 06:35:37  1699: static parser successfully parsed data_model/temp_folder/preferred_login_device.sql
2022-07-06 06:35:37.463186 (Thread-242): 06:35:37  1699: static parser successfully parsed data_model/temp_folder/utm_url_sequence.sql
2022-07-06 06:35:37.465237 (Thread-242): 06:35:37  1603: static parser failed on data_model/temp_folder/is_member.sql
2022-07-06 06:35:37.469331 (Thread-242): 06:35:37  1602: parser fallback to jinja rendering on data_model/temp_folder/is_member.sql
2022-07-06 06:35:37.470435 (Thread-242): 06:35:37  1603: static parser failed on data_model/temp_folder/has_mobile_app.sql
2022-07-06 06:35:37.475156 (Thread-242): 06:35:37  1602: parser fallback to jinja rendering on data_model/temp_folder/has_mobile_app.sql
2022-07-06 06:35:37.476490 (Thread-242): 06:35:37  1603: static parser failed on data_model/temp_folder/email_domain.sql
2022-07-06 06:35:37.480976 (Thread-242): 06:35:37  1602: parser fallback to jinja rendering on data_model/temp_folder/email_domain.sql
2022-07-06 06:35:37.482625 (Thread-242): 06:35:37  1603: static parser failed on data_model/temp_folder/gender.sql
2022-07-06 06:35:37.487551 (Thread-242): 06:35:37  1602: parser fallback to jinja rendering on data_model/temp_folder/gender.sql
2022-07-06 06:35:37.489021 (Thread-242): 06:35:37  1603: static parser failed on data_model/temp_folder/is_active_on_website.sql
2022-07-06 06:35:37.492749 (Thread-242): 06:35:37  1602: parser fallback to jinja rendering on data_model/temp_folder/is_active_on_website.sql
2022-07-06 06:35:37.493777 (Thread-242): 06:35:37  1603: static parser failed on data_model/temp_folder/age.sql
2022-07-06 06:35:37.497427 (Thread-242): 06:35:37  1602: parser fallback to jinja rendering on data_model/temp_folder/age.sql
2022-07-06 06:35:37.498586 (Thread-242): 06:35:37  1603: static parser failed on data_model/temp_folder/state.sql
2022-07-06 06:35:37.502079 (Thread-242): 06:35:37  1602: parser fallback to jinja rendering on data_model/temp_folder/state.sql
2022-07-06 06:35:37.503092 (Thread-242): 06:35:37  1699: static parser successfully parsed data_model/temp_folder/device_type.sql
2022-07-06 06:35:37.517913 (Thread-242): 06:35:37  [WARNING]: Did not find matching node for patch with name 'my_first_dbt_model' in the 'models' section of file 'models/data_model/schema.yml'
2022-07-06 06:35:37.533830 (Thread-242): 06:35:37  [WARNING]: Test 'test.ecommerce_data_model_dbt.unique_my_first_dbt_model_id.16e066b321' (models/data_model/schema.yml) depends on a node named 'my_first_dbt_model' which was not found
2022-07-06 06:35:37.534161 (Thread-242): 06:35:37  [WARNING]: Test 'test.ecommerce_data_model_dbt.not_null_my_first_dbt_model_id.5fb22c2710' (models/data_model/schema.yml) depends on a node named 'my_first_dbt_model' which was not found
2022-07-06 06:35:37.580609 (Thread-242): 06:35:37  [WARNING]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.data-apps-ecommerce-template.data_model

2022-07-06 06:35:37.586717 (Thread-242): 06:35:37  Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '659b7287-63c6-4870-93d6-1d76e1b93300', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6819df4250>]}
2022-07-06 06:35:37.722747 (Thread-243): handling status request
2022-07-06 06:35:37.723171 (Thread-243): 06:35:37  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '659b7287-63c6-4870-93d6-1d76e1b93300', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6819dacb50>]}
2022-07-06 06:35:37.724333 (Thread-243): sending response (<Response 25544 bytes [200 OK]>) to 10.0.38.61
2022-07-06 06:35:37.766767 (Thread-244): handling status request
2022-07-06 06:35:37.767232 (Thread-244): 06:35:37  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '659b7287-63c6-4870-93d6-1d76e1b93300', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6819db73d0>]}
2022-07-06 06:35:37.768306 (Thread-244): sending response (<Response 25544 bytes [200 OK]>) to 10.0.38.61
2022-07-06 06:35:41.978612 (Thread-245): 06:35:41  Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
2022-07-06 06:35:41.978858 (Thread-245): 06:35:41  Partial parsing enabled, no changes found, skipping parsing
2022-07-06 06:35:41.979542 (Thread-245): 06:35:41  [WARNING]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.data-apps-ecommerce-template.data_model

2022-07-06 06:35:41.985391 (Thread-245): 06:35:41  Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '659b7287-63c6-4870-93d6-1d76e1b93300', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6819cc6f70>]}
2022-07-06 06:35:42.771927 (Thread-246): handling status request
2022-07-06 06:35:42.772358 (Thread-246): 06:35:42  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '659b7287-63c6-4870-93d6-1d76e1b93300', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6819cbda00>]}
2022-07-06 06:35:42.772850 (Thread-246): sending response (<Response 1703 bytes [200 OK]>) to 10.0.38.61
2022-07-06 06:35:42.809615 (Thread-247): handling status request
2022-07-06 06:35:42.810048 (Thread-247): 06:35:42  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '659b7287-63c6-4870-93d6-1d76e1b93300', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6819cbd7c0>]}
2022-07-06 06:35:42.810532 (Thread-247): sending response (<Response 1703 bytes [200 OK]>) to 10.0.38.61
2022-07-06 06:35:43.900929 (Thread-248): handling status request
2022-07-06 06:35:43.901360 (Thread-248): 06:35:43  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '659b7287-63c6-4870-93d6-1d76e1b93300', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6819cbd6d0>]}
2022-07-06 06:35:43.901841 (Thread-248): sending response (<Response 1703 bytes [200 OK]>) to 10.0.38.61
2022-07-06 06:35:44.275982 (Thread-249): handling run_sql request
2022-07-06 06:35:44.276382 (Thread-249): 06:35:44  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '659b7287-63c6-4870-93d6-1d76e1b93300', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6819cbd550>]}
2022-07-06 06:35:46.680357 (Thread-249): sending response (<Response 139 bytes [200 OK]>) to 10.0.38.61
2022-07-06 06:35:46.708585 (MainThread): 06:35:46  Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'b6a8f841-ee7a-492c-8938-f43ac01a5860', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f06fbe5dbe0>]}
2022-07-06 06:35:46.709243 (MainThread): 06:35:46  Found 16 models, 0 tests, 0 snapshots, 0 analyses, 181 macros, 0 operations, 0 seed files, 15 sources, 0 exposures, 0 metrics
2022-07-06 06:35:46.709908 (Thread-1): 06:35:46  Acquiring new snowflake connection "rpc.ecommerce_data_model_dbt.request"
2022-07-06 06:35:46.710045 (Thread-1): 06:35:46  Began compiling node rpc.ecommerce_data_model_dbt.request
2022-07-06 06:35:46.710141 (Thread-1): 06:35:46  Compiling rpc.ecommerce_data_model_dbt.request
2022-07-06 06:35:46.713249 (Thread-1): 06:35:46  finished collecting timing info
2022-07-06 06:35:46.713391 (Thread-1): 06:35:46  Began executing node rpc.ecommerce_data_model_dbt.request
2022-07-06 06:35:46.714287 (Thread-1): 06:35:46  Using snowflake connection "rpc.ecommerce_data_model_dbt.request"
2022-07-06 06:35:46.714387 (Thread-1): 06:35:46  On rpc.ecommerce_data_model_dbt.request: select user_id, email_domain from 
(select user_id,
   lower(split_part(properties_email, '@', 2)) 
 as email_domain, row_number() over(partition by user_id order by timestamp desc) as rn from 
analytics_db.data_apps_simulated.identifies where timestamp >= '2021-05-01' and timestamp <= '2022-06-29'
and properties_email is not null and properties_email != '') where rn = 1
limit 500
/* limit added automatically by dbt cloud */
2022-07-06 06:35:46.714474 (Thread-1): 06:35:46  Opening a new connection, currently in state init
2022-07-06 06:35:47.088149 (Thread-250): handling poll request
2022-07-06 06:35:47.088656 (Thread-250): 06:35:47  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '659b7287-63c6-4870-93d6-1d76e1b93300', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6819df4a60>]}
2022-07-06 06:35:47.089615 (Thread-250): sending response (<Response 4179 bytes [200 OK]>) to 10.0.38.61
2022-07-06 06:35:47.584434 (Thread-1): 06:35:47  SQL status: SUCCESS 5 in 0.87 seconds
2022-07-06 06:35:47.586483 (Thread-1): 06:35:47  finished collecting timing info
2022-07-06 06:35:47.586753 (Thread-1): 06:35:47  On rpc.ecommerce_data_model_dbt.request: Close
2022-07-06 06:35:48.462488 (Thread-251): handling poll request
2022-07-06 06:35:48.462901 (Thread-251): 06:35:48  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '659b7287-63c6-4870-93d6-1d76e1b93300', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6819cc7340>]}
2022-07-06 06:35:48.463824 (Thread-251): sending response (<Response 5194 bytes [200 OK]>) to 10.0.38.61
2022-07-06 06:36:07.358006 (Thread-252): handling status request
2022-07-06 06:36:07.358481 (Thread-252): 06:36:07  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '659b7287-63c6-4870-93d6-1d76e1b93300', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6819cc7af0>]}
2022-07-06 06:36:07.359007 (Thread-252): sending response (<Response 1703 bytes [200 OK]>) to 10.0.38.61
2022-07-06 06:36:07.829919 (Thread-253): handling run_sql request
2022-07-06 06:36:07.830334 (Thread-253): 06:36:07  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '659b7287-63c6-4870-93d6-1d76e1b93300', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6819cc7ac0>]}
2022-07-06 06:36:10.222824 (Thread-253): sending response (<Response 139 bytes [200 OK]>) to 10.0.38.61
2022-07-06 06:36:10.248760 (MainThread): 06:36:10  Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '66d8c0f4-e6a5-4dbc-a3ca-ab20934cfcdb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f26681edca0>]}
2022-07-06 06:36:10.249368 (MainThread): 06:36:10  Found 16 models, 0 tests, 0 snapshots, 0 analyses, 181 macros, 0 operations, 0 seed files, 15 sources, 0 exposures, 0 metrics
2022-07-06 06:36:10.250033 (Thread-1): 06:36:10  Acquiring new snowflake connection "rpc.ecommerce_data_model_dbt.request"
2022-07-06 06:36:10.250171 (Thread-1): 06:36:10  Began compiling node rpc.ecommerce_data_model_dbt.request
2022-07-06 06:36:10.250264 (Thread-1): 06:36:10  Compiling rpc.ecommerce_data_model_dbt.request
2022-07-06 06:36:10.252861 (Thread-1): 06:36:10  finished collecting timing info
2022-07-06 06:36:10.253025 (Thread-1): 06:36:10  Began executing node rpc.ecommerce_data_model_dbt.request
2022-07-06 06:36:10.254028 (Thread-1): 06:36:10  Using snowflake connection "rpc.ecommerce_data_model_dbt.request"
2022-07-06 06:36:10.254122 (Thread-1): 06:36:10  On rpc.ecommerce_data_model_dbt.request: select distinct user_id, 
first_value(properties_country)
over(partition by user_id order by case when properties_country is not null and properties_country != '' then 2 else 1 end desc, timestamp desc) as country,
first_value(properties_state)
over(partition by user_id order by case when properties_state is not null and properties_state != '' then 2 else 1 end desc, timestamp desc) as state
from analytics_db.data_apps_simulated.identifies where timestamp >= '2021-05-01' and timestamp <= '2022-06-29'
and user_id is not null
limit 500
/* limit added automatically by dbt cloud */
2022-07-06 06:36:10.254207 (Thread-1): 06:36:10  Opening a new connection, currently in state init
2022-07-06 06:36:10.746217 (Thread-254): handling poll request
2022-07-06 06:36:10.746698 (Thread-254): 06:36:10  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '659b7287-63c6-4870-93d6-1d76e1b93300', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6819cca790>]}
2022-07-06 06:36:10.747621 (Thread-254): sending response (<Response 4341 bytes [200 OK]>) to 10.0.38.61
2022-07-06 06:36:11.213484 (Thread-1): 06:36:11  SQL status: SUCCESS 5 in 0.96 seconds
2022-07-06 06:36:11.214924 (Thread-1): 06:36:11  finished collecting timing info
2022-07-06 06:36:11.215106 (Thread-1): 06:36:11  On rpc.ecommerce_data_model_dbt.request: Close
2022-07-06 06:36:12.275436 (Thread-255): handling poll request
2022-07-06 06:36:12.275846 (Thread-255): 06:36:12  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '659b7287-63c6-4870-93d6-1d76e1b93300', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6819ccae20>]}
2022-07-06 06:36:12.276763 (Thread-255): sending response (<Response 5822 bytes [200 OK]>) to 10.0.38.61
2022-07-06 06:36:52.695806 (Thread-256): 06:36:52  Partial parsing enabled: 11 files deleted, 11 files added, 0 files changed.
2022-07-06 06:36:52.696361 (Thread-256): 06:36:52  Partial parsing: added file: ecommerce_data_model_dbt://models/data_model/traits/age.sql
2022-07-06 06:36:52.696562 (Thread-256): 06:36:52  Partial parsing: added file: ecommerce_data_model_dbt://models/data_model/traits/state.sql
2022-07-06 06:36:52.696722 (Thread-256): 06:36:52  Partial parsing: added file: ecommerce_data_model_dbt://models/data_model/traits/email_domain.sql
2022-07-06 06:36:52.696877 (Thread-256): 06:36:52  Partial parsing: added file: ecommerce_data_model_dbt://models/data_model/traits/country_and_state.sql
2022-07-06 06:36:52.697065 (Thread-256): 06:36:52  Partial parsing: added file: ecommerce_data_model_dbt://models/data_model/traits/is_active_on_website.sql
2022-07-06 06:36:52.697224 (Thread-256): 06:36:52  Partial parsing: added file: ecommerce_data_model_dbt://models/data_model/traits/preferred_login_device.sql
2022-07-06 06:36:52.697373 (Thread-256): 06:36:52  Partial parsing: added file: ecommerce_data_model_dbt://models/data_model/traits/utm_url_sequence.sql
2022-07-06 06:36:52.697521 (Thread-256): 06:36:52  Partial parsing: added file: ecommerce_data_model_dbt://models/data_model/traits/has_mobile_app.sql
2022-07-06 06:36:52.697678 (Thread-256): 06:36:52  Partial parsing: added file: ecommerce_data_model_dbt://models/data_model/traits/device_type.sql
2022-07-06 06:36:52.697838 (Thread-256): 06:36:52  Partial parsing: added file: ecommerce_data_model_dbt://models/data_model/traits/gender.sql
2022-07-06 06:36:52.697994 (Thread-256): 06:36:52  Partial parsing: added file: ecommerce_data_model_dbt://models/data_model/traits/is_member.sql
2022-07-06 06:36:52.698125 (Thread-256): 06:36:52  Partial parsing: deleted file: ecommerce_data_model_dbt://models/data_model/temp_folder/country_and_state.sql
2022-07-06 06:36:52.698222 (Thread-256): 06:36:52  Partial parsing: deleted file: ecommerce_data_model_dbt://models/data_model/temp_folder/is_member.sql
2022-07-06 06:36:52.698313 (Thread-256): 06:36:52  Partial parsing: deleted file: ecommerce_data_model_dbt://models/data_model/temp_folder/gender.sql
2022-07-06 06:36:52.698403 (Thread-256): 06:36:52  Partial parsing: deleted file: ecommerce_data_model_dbt://models/data_model/temp_folder/email_domain.sql
2022-07-06 06:36:52.698491 (Thread-256): 06:36:52  Partial parsing: deleted file: ecommerce_data_model_dbt://models/data_model/temp_folder/is_active_on_website.sql
2022-07-06 06:36:52.698579 (Thread-256): 06:36:52  Partial parsing: deleted file: ecommerce_data_model_dbt://models/data_model/temp_folder/has_mobile_app.sql
2022-07-06 06:36:52.698671 (Thread-256): 06:36:52  Partial parsing: deleted file: ecommerce_data_model_dbt://models/data_model/temp_folder/state.sql
2022-07-06 06:36:52.698763 (Thread-256): 06:36:52  Partial parsing: deleted file: ecommerce_data_model_dbt://models/data_model/temp_folder/utm_url_sequence.sql
2022-07-06 06:36:52.698850 (Thread-256): 06:36:52  Partial parsing: deleted file: ecommerce_data_model_dbt://models/data_model/temp_folder/age.sql
2022-07-06 06:36:52.698937 (Thread-256): 06:36:52  Partial parsing: deleted file: ecommerce_data_model_dbt://models/data_model/temp_folder/preferred_login_device.sql
2022-07-06 06:36:52.699025 (Thread-256): 06:36:52  Partial parsing: deleted file: ecommerce_data_model_dbt://models/data_model/temp_folder/device_type.sql
2022-07-06 06:36:52.703175 (Thread-256): 06:36:52  1603: static parser failed on data_model/traits/age.sql
2022-07-06 06:36:52.707678 (Thread-256): 06:36:52  1602: parser fallback to jinja rendering on data_model/traits/age.sql
2022-07-06 06:36:52.709014 (Thread-256): 06:36:52  1603: static parser failed on data_model/traits/state.sql
2022-07-06 06:36:52.713104 (Thread-256): 06:36:52  1602: parser fallback to jinja rendering on data_model/traits/state.sql
2022-07-06 06:36:52.714280 (Thread-256): 06:36:52  1603: static parser failed on data_model/traits/email_domain.sql
2022-07-06 06:36:52.717864 (Thread-256): 06:36:52  1602: parser fallback to jinja rendering on data_model/traits/email_domain.sql
2022-07-06 06:36:52.718947 (Thread-256): 06:36:52  1603: static parser failed on data_model/traits/country_and_state.sql
2022-07-06 06:36:52.722231 (Thread-256): 06:36:52  1602: parser fallback to jinja rendering on data_model/traits/country_and_state.sql
2022-07-06 06:36:52.723512 (Thread-256): 06:36:52  1603: static parser failed on data_model/traits/is_active_on_website.sql
2022-07-06 06:36:52.727208 (Thread-256): 06:36:52  1602: parser fallback to jinja rendering on data_model/traits/is_active_on_website.sql
2022-07-06 06:36:52.728178 (Thread-256): 06:36:52  1699: static parser successfully parsed data_model/traits/preferred_login_device.sql
2022-07-06 06:36:52.729968 (Thread-256): 06:36:52  1699: static parser successfully parsed data_model/traits/utm_url_sequence.sql
2022-07-06 06:36:52.731858 (Thread-256): 06:36:52  1603: static parser failed on data_model/traits/has_mobile_app.sql
2022-07-06 06:36:52.735201 (Thread-256): 06:36:52  1602: parser fallback to jinja rendering on data_model/traits/has_mobile_app.sql
2022-07-06 06:36:52.736140 (Thread-256): 06:36:52  1699: static parser successfully parsed data_model/traits/device_type.sql
2022-07-06 06:36:52.738064 (Thread-256): 06:36:52  1603: static parser failed on data_model/traits/gender.sql
2022-07-06 06:36:52.741341 (Thread-256): 06:36:52  1602: parser fallback to jinja rendering on data_model/traits/gender.sql
2022-07-06 06:36:52.742469 (Thread-256): 06:36:52  1603: static parser failed on data_model/traits/is_member.sql
2022-07-06 06:36:52.745667 (Thread-256): 06:36:52  1602: parser fallback to jinja rendering on data_model/traits/is_member.sql
2022-07-06 06:36:52.781253 (Thread-256): 06:36:52  [WARNING]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.data-apps-ecommerce-template.data_model

2022-07-06 06:36:52.786922 (Thread-256): 06:36:52  Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '659b7287-63c6-4870-93d6-1d76e1b93300', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6819bf3070>]}
2022-07-06 06:36:53.441521 (Thread-257): handling status request
2022-07-06 06:36:53.442188 (Thread-257): 06:36:53  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '659b7287-63c6-4870-93d6-1d76e1b93300', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6819c6cb80>]}
2022-07-06 06:36:53.442720 (Thread-258): handling status request
2022-07-06 06:36:53.443647 (Thread-257): sending response (<Response 14894 bytes [200 OK]>) to 10.0.38.61
2022-07-06 06:36:53.444040 (Thread-258): 06:36:53  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '659b7287-63c6-4870-93d6-1d76e1b93300', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6819cc6eb0>]}
2022-07-06 06:36:53.445271 (Thread-258): sending response (<Response 14894 bytes [200 OK]>) to 10.0.38.61
2022-07-06 06:37:04.472392 (Thread-259): 06:37:04  Partial parsing enabled: 11 files deleted, 11 files added, 0 files changed.
2022-07-06 06:37:04.472913 (Thread-259): 06:37:04  Partial parsing: added file: ecommerce_data_model_dbt://models/data_model/stg_traits/country_and_state.sql
2022-07-06 06:37:04.473141 (Thread-259): 06:37:04  Partial parsing: added file: ecommerce_data_model_dbt://models/data_model/stg_traits/is_member.sql
2022-07-06 06:37:04.473302 (Thread-259): 06:37:04  Partial parsing: added file: ecommerce_data_model_dbt://models/data_model/stg_traits/device_type.sql
2022-07-06 06:37:04.473457 (Thread-259): 06:37:04  Partial parsing: added file: ecommerce_data_model_dbt://models/data_model/stg_traits/utm_url_sequence.sql
2022-07-06 06:37:04.473619 (Thread-259): 06:37:04  Partial parsing: added file: ecommerce_data_model_dbt://models/data_model/stg_traits/age.sql
2022-07-06 06:37:04.473776 (Thread-259): 06:37:04  Partial parsing: added file: ecommerce_data_model_dbt://models/data_model/stg_traits/preferred_login_device.sql
2022-07-06 06:37:04.473925 (Thread-259): 06:37:04  Partial parsing: added file: ecommerce_data_model_dbt://models/data_model/stg_traits/has_mobile_app.sql
2022-07-06 06:37:04.474074 (Thread-259): 06:37:04  Partial parsing: added file: ecommerce_data_model_dbt://models/data_model/stg_traits/state.sql
2022-07-06 06:37:04.474223 (Thread-259): 06:37:04  Partial parsing: added file: ecommerce_data_model_dbt://models/data_model/stg_traits/email_domain.sql
2022-07-06 06:37:04.474371 (Thread-259): 06:37:04  Partial parsing: added file: ecommerce_data_model_dbt://models/data_model/stg_traits/is_active_on_website.sql
2022-07-06 06:37:04.474520 (Thread-259): 06:37:04  Partial parsing: added file: ecommerce_data_model_dbt://models/data_model/stg_traits/gender.sql
2022-07-06 06:37:04.474628 (Thread-259): 06:37:04  Partial parsing: deleted file: ecommerce_data_model_dbt://models/data_model/traits/age.sql
2022-07-06 06:37:04.474722 (Thread-259): 06:37:04  Partial parsing: deleted file: ecommerce_data_model_dbt://models/data_model/traits/state.sql
2022-07-06 06:37:04.474813 (Thread-259): 06:37:04  Partial parsing: deleted file: ecommerce_data_model_dbt://models/data_model/traits/email_domain.sql
2022-07-06 06:37:04.474902 (Thread-259): 06:37:04  Partial parsing: deleted file: ecommerce_data_model_dbt://models/data_model/traits/country_and_state.sql
2022-07-06 06:37:04.475000 (Thread-259): 06:37:04  Partial parsing: deleted file: ecommerce_data_model_dbt://models/data_model/traits/is_active_on_website.sql
2022-07-06 06:37:04.475092 (Thread-259): 06:37:04  Partial parsing: deleted file: ecommerce_data_model_dbt://models/data_model/traits/preferred_login_device.sql
2022-07-06 06:37:04.475183 (Thread-259): 06:37:04  Partial parsing: deleted file: ecommerce_data_model_dbt://models/data_model/traits/utm_url_sequence.sql
2022-07-06 06:37:04.475275 (Thread-259): 06:37:04  Partial parsing: deleted file: ecommerce_data_model_dbt://models/data_model/traits/has_mobile_app.sql
2022-07-06 06:37:04.475365 (Thread-259): 06:37:04  Partial parsing: deleted file: ecommerce_data_model_dbt://models/data_model/traits/device_type.sql
2022-07-06 06:37:04.475452 (Thread-259): 06:37:04  Partial parsing: deleted file: ecommerce_data_model_dbt://models/data_model/traits/gender.sql
2022-07-06 06:37:04.475541 (Thread-259): 06:37:04  Partial parsing: deleted file: ecommerce_data_model_dbt://models/data_model/traits/is_member.sql
2022-07-06 06:37:04.479683 (Thread-259): 06:37:04  1603: static parser failed on data_model/stg_traits/country_and_state.sql
2022-07-06 06:37:04.483692 (Thread-259): 06:37:04  1602: parser fallback to jinja rendering on data_model/stg_traits/country_and_state.sql
2022-07-06 06:37:04.484916 (Thread-259): 06:37:04  1603: static parser failed on data_model/stg_traits/is_member.sql
2022-07-06 06:37:04.489195 (Thread-259): 06:37:04  1602: parser fallback to jinja rendering on data_model/stg_traits/is_member.sql
2022-07-06 06:37:04.490205 (Thread-259): 06:37:04  1699: static parser successfully parsed data_model/stg_traits/device_type.sql
2022-07-06 06:37:04.491952 (Thread-259): 06:37:04  1699: static parser successfully parsed data_model/stg_traits/utm_url_sequence.sql
2022-07-06 06:37:04.493978 (Thread-259): 06:37:04  1603: static parser failed on data_model/stg_traits/age.sql
2022-07-06 06:37:04.497554 (Thread-259): 06:37:04  1602: parser fallback to jinja rendering on data_model/stg_traits/age.sql
2022-07-06 06:37:04.498750 (Thread-259): 06:37:04  1699: static parser successfully parsed data_model/stg_traits/preferred_login_device.sql
2022-07-06 06:37:04.500624 (Thread-259): 06:37:04  1603: static parser failed on data_model/stg_traits/has_mobile_app.sql
2022-07-06 06:37:04.504040 (Thread-259): 06:37:04  1602: parser fallback to jinja rendering on data_model/stg_traits/has_mobile_app.sql
2022-07-06 06:37:04.505171 (Thread-259): 06:37:04  1603: static parser failed on data_model/stg_traits/state.sql
2022-07-06 06:37:04.508575 (Thread-259): 06:37:04  1602: parser fallback to jinja rendering on data_model/stg_traits/state.sql
2022-07-06 06:37:04.509750 (Thread-259): 06:37:04  1603: static parser failed on data_model/stg_traits/email_domain.sql
2022-07-06 06:37:04.513393 (Thread-259): 06:37:04  1602: parser fallback to jinja rendering on data_model/stg_traits/email_domain.sql
2022-07-06 06:37:04.514590 (Thread-259): 06:37:04  1603: static parser failed on data_model/stg_traits/is_active_on_website.sql
2022-07-06 06:37:04.518351 (Thread-259): 06:37:04  1602: parser fallback to jinja rendering on data_model/stg_traits/is_active_on_website.sql
2022-07-06 06:37:04.519486 (Thread-259): 06:37:04  1603: static parser failed on data_model/stg_traits/gender.sql
2022-07-06 06:37:04.523042 (Thread-259): 06:37:04  1602: parser fallback to jinja rendering on data_model/stg_traits/gender.sql
2022-07-06 06:37:04.559461 (Thread-259): 06:37:04  [WARNING]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.data-apps-ecommerce-template.data_model

2022-07-06 06:37:04.565239 (Thread-259): 06:37:04  Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '659b7287-63c6-4870-93d6-1d76e1b93300', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6819af5e80>]}
2022-07-06 06:37:05.225420 (Thread-260): handling status request
2022-07-06 06:37:05.225866 (Thread-260): 06:37:05  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '659b7287-63c6-4870-93d6-1d76e1b93300', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6819abed30>]}
2022-07-06 06:37:05.226701 (Thread-260): sending response (<Response 14959 bytes [200 OK]>) to 10.0.38.61
2022-07-06 06:37:05.227542 (Thread-261): handling status request
2022-07-06 06:37:05.228135 (Thread-261): 06:37:05  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '659b7287-63c6-4870-93d6-1d76e1b93300', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6819b23130>]}
2022-07-06 06:37:05.228907 (Thread-261): sending response (<Response 14959 bytes [200 OK]>) to 10.0.38.61
2022-07-06 06:37:28.845751 (Thread-262): handling status request
2022-07-06 06:37:28.846179 (Thread-262): 06:37:28  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '659b7287-63c6-4870-93d6-1d76e1b93300', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6819b0dc10>]}
2022-07-06 06:37:28.870148 (Thread-262): sending response (<Response 14959 bytes [200 OK]>) to 10.0.38.61
2022-07-06 06:37:29.287648 (Thread-263): handling run_sql request
2022-07-06 06:37:29.288074 (Thread-263): 06:37:29  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '659b7287-63c6-4870-93d6-1d76e1b93300', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6819b05730>]}
2022-07-06 06:37:31.685228 (Thread-263): sending response (<Response 139 bytes [200 OK]>) to 10.0.38.61
2022-07-06 06:37:31.711055 (MainThread): 06:37:31  Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '17912aac-bff4-4103-996a-912b01fe7336', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff4557ee400>]}
2022-07-06 06:37:31.711635 (MainThread): 06:37:31  Found 16 models, 0 tests, 0 snapshots, 0 analyses, 181 macros, 0 operations, 0 seed files, 15 sources, 0 exposures, 0 metrics
2022-07-06 06:37:31.712256 (Thread-1): 06:37:31  Acquiring new snowflake connection "rpc.ecommerce_data_model_dbt.request"
2022-07-06 06:37:31.712395 (Thread-1): 06:37:31  Began compiling node rpc.ecommerce_data_model_dbt.request
2022-07-06 06:37:31.712492 (Thread-1): 06:37:31  Compiling rpc.ecommerce_data_model_dbt.request
2022-07-06 06:37:31.715130 (Thread-1): 06:37:31  finished collecting timing info
2022-07-06 06:37:31.715268 (Thread-1): 06:37:31  Began executing node rpc.ecommerce_data_model_dbt.request
2022-07-06 06:37:31.716249 (Thread-1): 06:37:31  Using snowflake connection "rpc.ecommerce_data_model_dbt.request"
2022-07-06 06:37:31.716343 (Thread-1): 06:37:31  On rpc.ecommerce_data_model_dbt.request: select distinct user_id, 
first_value(properties_country)
over(partition by user_id order by case when properties_country is not null and properties_country != '' then 2 else 1 end desc, timestamp desc) as country,
first_value(properties_state)
over(partition by user_id order by case when properties_state is not null and properties_state != '' then 2 else 1 end desc, timestamp desc) as state
from analytics_db.data_apps_simulated.identifies where timestamp >= '2021-05-01' and timestamp <= '2022-06-29'
limit 500
/* limit added automatically by dbt cloud */
2022-07-06 06:37:31.716428 (Thread-1): 06:37:31  Opening a new connection, currently in state init
2022-07-06 06:37:32.087146 (Thread-264): handling poll request
2022-07-06 06:37:32.087631 (Thread-264): 06:37:32  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '659b7287-63c6-4870-93d6-1d76e1b93300', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6819b6adc0>]}
2022-07-06 06:37:32.088566 (Thread-264): sending response (<Response 4315 bytes [200 OK]>) to 10.0.38.61
2022-07-06 06:37:32.731579 (Thread-1): 06:37:32  SQL status: SUCCESS 6 in 1.02 seconds
2022-07-06 06:37:32.733061 (Thread-1): 06:37:32  finished collecting timing info
2022-07-06 06:37:32.733254 (Thread-1): 06:37:32  On rpc.ecommerce_data_model_dbt.request: Close
2022-07-06 06:37:33.478008 (Thread-265): handling poll request
2022-07-06 06:37:33.478441 (Thread-265): 06:37:33  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '659b7287-63c6-4870-93d6-1d76e1b93300', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6819b6abe0>]}
2022-07-06 06:37:33.479381 (Thread-265): sending response (<Response 5737 bytes [200 OK]>) to 10.0.38.61
2022-07-06 06:38:50.133377 (Thread-266): handling status request
2022-07-06 06:38:50.133857 (Thread-266): 06:38:50  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '659b7287-63c6-4870-93d6-1d76e1b93300', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6819f34fd0>]}
2022-07-06 06:38:50.134784 (Thread-266): sending response (<Response 14959 bytes [200 OK]>) to 10.0.38.61
2022-07-06 06:38:50.528393 (Thread-267): handling run_sql request
2022-07-06 06:38:50.528808 (Thread-267): 06:38:50  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '659b7287-63c6-4870-93d6-1d76e1b93300', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6819b6a220>]}
2022-07-06 06:38:52.945535 (Thread-267): sending response (<Response 139 bytes [200 OK]>) to 10.0.38.61
2022-07-06 06:38:52.973186 (MainThread): 06:38:52  Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '3a691225-9afe-4eb3-a6da-092e27445ef5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdfaae4e520>]}
2022-07-06 06:38:52.973806 (MainThread): 06:38:52  Found 16 models, 0 tests, 0 snapshots, 0 analyses, 181 macros, 0 operations, 0 seed files, 15 sources, 0 exposures, 0 metrics
2022-07-06 06:38:52.974457 (Thread-1): 06:38:52  Acquiring new snowflake connection "rpc.ecommerce_data_model_dbt.request"
2022-07-06 06:38:52.974594 (Thread-1): 06:38:52  Began compiling node rpc.ecommerce_data_model_dbt.request
2022-07-06 06:38:52.974691 (Thread-1): 06:38:52  Compiling rpc.ecommerce_data_model_dbt.request
2022-07-06 06:38:52.977437 (Thread-1): 06:38:52  finished collecting timing info
2022-07-06 06:38:52.977585 (Thread-1): 06:38:52  Began executing node rpc.ecommerce_data_model_dbt.request
2022-07-06 06:38:52.978594 (Thread-1): 06:38:52  Using snowflake connection "rpc.ecommerce_data_model_dbt.request"
2022-07-06 06:38:52.978687 (Thread-1): 06:38:52  On rpc.ecommerce_data_model_dbt.request: select distinct user_id, 
first_value(properties_country)
over(partition by user_id order by case when properties_country is not null and properties_country != '' then 2 else 1 end desc, timestamp desc) as country,
first_value(properties_state)
over(partition by user_id order by case when properties_state is not null and properties_state != '' then 2 else 1 end desc, timestamp desc) as state
from analytics_db.data_apps_simulated.identifies where timestamp >= '2021-05-01' and timestamp <= '2022-06-29'
and user_id is not null
limit 500
/* limit added automatically by dbt cloud */
2022-07-06 06:38:52.978771 (Thread-1): 06:38:52  Opening a new connection, currently in state init
2022-07-06 06:38:53.316583 (Thread-268): handling poll request
2022-07-06 06:38:53.317127 (Thread-268): 06:38:53  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '659b7287-63c6-4870-93d6-1d76e1b93300', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6819bfd4c0>]}
2022-07-06 06:38:53.318101 (Thread-268): sending response (<Response 4340 bytes [200 OK]>) to 10.0.38.61
2022-07-06 06:38:54.122994 (Thread-1): 06:38:54  SQL status: SUCCESS 5 in 1.14 seconds
2022-07-06 06:38:54.124470 (Thread-1): 06:38:54  finished collecting timing info
2022-07-06 06:38:54.124657 (Thread-1): 06:38:54  On rpc.ecommerce_data_model_dbt.request: Close
2022-07-06 06:38:54.688158 (Thread-269): handling poll request
2022-07-06 06:38:54.688590 (Thread-269): 06:38:54  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '659b7287-63c6-4870-93d6-1d76e1b93300', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6819cbdc10>]}
2022-07-06 06:38:54.689589 (Thread-269): sending response (<Response 5821 bytes [200 OK]>) to 10.0.38.61
2022-07-06 06:39:03.148291 (Thread-270): handling status request
2022-07-06 06:39:03.148698 (Thread-270): 06:39:03  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '659b7287-63c6-4870-93d6-1d76e1b93300', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6819cbd7c0>]}
2022-07-06 06:39:03.151369 (Thread-270): sending response (<Response 14959 bytes [200 OK]>) to 10.0.38.61
2022-07-06 06:39:03.518829 (Thread-271): handling run_sql request
2022-07-06 06:39:03.519259 (Thread-271): 06:39:03  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '659b7287-63c6-4870-93d6-1d76e1b93300', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6819b64c70>]}
2022-07-06 06:39:05.897227 (Thread-271): sending response (<Response 139 bytes [200 OK]>) to 10.0.38.61
2022-07-06 06:39:05.924354 (MainThread): 06:39:05  Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '7ddf8b0c-f10b-49ac-9b31-7b3ae37a1b9d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc521d18d90>]}
2022-07-06 06:39:05.924946 (MainThread): 06:39:05  Found 16 models, 0 tests, 0 snapshots, 0 analyses, 181 macros, 0 operations, 0 seed files, 15 sources, 0 exposures, 0 metrics
2022-07-06 06:39:05.925605 (Thread-1): 06:39:05  Acquiring new snowflake connection "rpc.ecommerce_data_model_dbt.request"
2022-07-06 06:39:05.925743 (Thread-1): 06:39:05  Began compiling node rpc.ecommerce_data_model_dbt.request
2022-07-06 06:39:05.925845 (Thread-1): 06:39:05  Compiling rpc.ecommerce_data_model_dbt.request
2022-07-06 06:39:05.928799 (Thread-1): 06:39:05  finished collecting timing info
2022-07-06 06:39:05.928929 (Thread-1): 06:39:05  Began executing node rpc.ecommerce_data_model_dbt.request
2022-07-06 06:39:05.929889 (Thread-1): 06:39:05  Using snowflake connection "rpc.ecommerce_data_model_dbt.request"
2022-07-06 06:39:05.929983 (Thread-1): 06:39:05  On rpc.ecommerce_data_model_dbt.request: select user_id, 
CASE WHEN dateadd(year, datediff (year, properties_birthday, getdate()), properties_birthday) > getdate()
      THEN datediff(year, properties_birthday, getdate()) - 1
      ELSE datediff(year, properties_birthday, getdate())
 END
  as age 
from analytics_db.data_apps_simulated.identifies where timestamp >= '2021-05-01' and timestamp <= '2022-06-29'
and properties_birthday is not null and properties_birthday!=''
limit 500
/* limit added automatically by dbt cloud */
2022-07-06 06:39:05.930066 (Thread-1): 06:39:05  Opening a new connection, currently in state init
2022-07-06 06:39:06.267820 (Thread-272): handling poll request
2022-07-06 06:39:06.268305 (Thread-272): 06:39:06  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '659b7287-63c6-4870-93d6-1d76e1b93300', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6819abe7f0>]}
2022-07-06 06:39:06.269278 (Thread-272): sending response (<Response 4230 bytes [200 OK]>) to 10.0.38.61
2022-07-06 06:39:06.764453 (Thread-1): 06:39:06  SQL status: SUCCESS 3 in 0.83 seconds
2022-07-06 06:39:06.765952 (Thread-1): 06:39:06  finished collecting timing info
2022-07-06 06:39:06.766136 (Thread-1): 06:39:06  On rpc.ecommerce_data_model_dbt.request: Close
2022-07-06 06:39:07.661439 (Thread-273): handling poll request
2022-07-06 06:39:07.661869 (Thread-273): 06:39:07  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '659b7287-63c6-4870-93d6-1d76e1b93300', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6819b2e6a0>]}
2022-07-06 06:39:07.662819 (Thread-273): sending response (<Response 4949 bytes [200 OK]>) to 10.0.38.61
2022-07-07 07:57:13.847674 (MainThread): Running with dbt=1.0.8
2022-07-07 07:57:14.106438 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt_rpc.task.server.RPCServerTask'>, debug=None, defer=None, exclude=None, fail_fast=None, host='0.0.0.0', log_cache_events=False, log_format=None, models=None, partial_parse=True, port=8580, printer_width=None, profile='user', profiles_dir='/usr/src/develop/.dbt', project_dir=None, record_timing_info=None, rpc_method=None, send_anonymous_usage_stats=None, single_threaded=False, state=None, static_parser=None, target=None, threads=None, use_colors=None, use_experimental_parser=None, vars='{}', version_check=None, warn_error=None, which='rpc', write_json=None)
2022-07-07 07:57:14.114312 (MainThread): Tracking: tracking
2022-07-07 07:57:14.114660 (MainThread): 07:57:14  Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5252c335e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f52140a4dc0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f52140c2970>]}
2022-07-07 07:57:14.115201 (MainThread): Serving RPC server at 0.0.0.0:8580, pid=22
2022-07-07 07:57:14.119928 (MainThread): Supported methods: ['build', 'cli_args', 'compile', 'compile_sql', 'deps', 'docs.generate', 'gc', 'get-manifest', 'kill', 'list', 'poll', 'ps', 'run', 'run-operation', 'run_sql', 'seed', 'snapshot', 'snapshot-freshness', 'source-freshness', 'status', 'test']
2022-07-07 07:57:14.120127 (MainThread): Send requests to http://localhost:8580/jsonrpc
2022-07-07 07:57:14.230759 (Thread-12): 07:57:14  Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
2022-07-07 07:57:14.234148 (Thread-12): 07:57:14  Partial parsing enabled, no changes found, skipping parsing
2022-07-07 07:57:14.234878 (Thread-12): 07:57:14  [WARNING]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.data-apps-ecommerce-template.data_model

2022-07-07 07:57:14.241281 (Thread-12): 07:57:14  Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '196d9207-3e38-4101-ac43-bc898fbec1a7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f520dfb6ca0>]}
2022-07-07 07:57:27.387892 (Thread-13): handling status request
2022-07-07 07:57:27.388317 (Thread-13): 07:57:27  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '196d9207-3e38-4101-ac43-bc898fbec1a7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f520dfa0f10>]}
2022-07-07 07:57:27.388955 (Thread-13): sending response (<Response 1699 bytes [200 OK]>) to 10.0.41.177
2022-07-07 07:57:27.550964 (Thread-14): handling status request
2022-07-07 07:57:27.551395 (Thread-14): 07:57:27  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '196d9207-3e38-4101-ac43-bc898fbec1a7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f520dfa0e80>]}
2022-07-07 07:57:27.551924 (Thread-14): sending response (<Response 1699 bytes [200 OK]>) to 10.0.41.177
2022-07-07 07:57:27.709089 (Thread-15): handling ps request
2022-07-07 07:57:27.709511 (Thread-15): 07:57:27  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '196d9207-3e38-4101-ac43-bc898fbec1a7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f520dfa0730>]}
2022-07-07 07:57:27.710000 (Thread-15): sending response (<Response 106 bytes [200 OK]>) to 10.0.41.177
2022-07-07 07:57:27.723174 (Thread-16): handling status request
2022-07-07 07:57:27.723478 (Thread-16): 07:57:27  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '196d9207-3e38-4101-ac43-bc898fbec1a7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f52140d23d0>]}
2022-07-07 07:57:27.723968 (Thread-16): sending response (<Response 1699 bytes [200 OK]>) to 10.0.41.177
2022-07-07 07:57:29.896099 (Thread-17): handling status request
2022-07-07 07:57:29.896529 (Thread-17): 07:57:29  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '196d9207-3e38-4101-ac43-bc898fbec1a7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f52140d2ca0>]}
2022-07-07 07:57:29.896991 (Thread-17): sending response (<Response 1676 bytes [200 OK]>) to 10.0.41.177
2022-07-07 07:57:29.905019 (Thread-18): handling list request
2022-07-07 07:57:29.905282 (Thread-18): 07:57:29  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '196d9207-3e38-4101-ac43-bc898fbec1a7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f52140c2640>]}
2022-07-07 07:57:29.942701 (Thread-18): 07:57:29  Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '196d9207-3e38-4101-ac43-bc898fbec1a7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f520dfa0790>]}
2022-07-07 07:57:29.943035 (Thread-18): 07:57:29  Found 16 models, 0 tests, 0 snapshots, 0 analyses, 181 macros, 0 operations, 0 seed files, 15 sources, 0 exposures, 0 metrics
2022-07-07 07:57:29.946052 (Thread-18): sending response (<Response 2084 bytes [200 OK]>) to 10.0.41.177
2022-07-07 07:57:30.097801 (Thread-19): handling status request
2022-07-07 07:57:30.098187 (Thread-19): 07:57:30  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '196d9207-3e38-4101-ac43-bc898fbec1a7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f520df3e7c0>]}
2022-07-07 07:57:30.098660 (Thread-19): sending response (<Response 1699 bytes [200 OK]>) to 10.0.41.177
2022-07-07 08:02:16.587086 (Thread-20): handling status request
2022-07-07 08:02:16.588565 (Thread-20): 08:02:16  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '196d9207-3e38-4101-ac43-bc898fbec1a7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f520df3e790>]}
2022-07-07 08:02:16.589039 (Thread-20): sending response (<Response 1676 bytes [200 OK]>) to 10.0.41.177
2022-07-07 08:02:16.621171 (Thread-21): handling list request
2022-07-07 08:02:16.621469 (Thread-21): 08:02:16  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '196d9207-3e38-4101-ac43-bc898fbec1a7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f520df3ea00>]}
2022-07-07 08:02:16.653388 (Thread-21): 08:02:16  Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '196d9207-3e38-4101-ac43-bc898fbec1a7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5214071070>]}
2022-07-07 08:02:16.653663 (Thread-21): 08:02:16  Found 16 models, 0 tests, 0 snapshots, 0 analyses, 181 macros, 0 operations, 0 seed files, 15 sources, 0 exposures, 0 metrics
2022-07-07 08:02:16.658543 (Thread-21): 08:02:16  The selection criterion '+macros/get_domain_from_email.sql+' does not match any nodes
2022-07-07 08:02:16.658697 (Thread-21): 08:02:16  No nodes selected!
2022-07-07 08:02:16.660112 (Thread-21): sending response (<Response 1947 bytes [200 OK]>) to 10.0.41.177
2022-07-07 08:02:20.500250 (Thread-22): handling status request
2022-07-07 08:02:20.500640 (Thread-22): 08:02:20  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '196d9207-3e38-4101-ac43-bc898fbec1a7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f520d70d1c0>]}
2022-07-07 08:02:20.501109 (Thread-22): sending response (<Response 1676 bytes [200 OK]>) to 10.0.41.177
2022-07-07 08:02:20.522684 (Thread-23): handling list request
2022-07-07 08:02:20.522946 (Thread-23): 08:02:20  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '196d9207-3e38-4101-ac43-bc898fbec1a7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f520d70daf0>]}
2022-07-07 08:02:20.555929 (Thread-23): 08:02:20  Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '196d9207-3e38-4101-ac43-bc898fbec1a7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f520d72a640>]}
2022-07-07 08:02:20.556208 (Thread-23): 08:02:20  Found 16 models, 0 tests, 0 snapshots, 0 analyses, 181 macros, 0 operations, 0 seed files, 15 sources, 0 exposures, 0 metrics
2022-07-07 08:02:20.558394 (Thread-23): 08:02:20  The selection criterion '+macros/get_age_from_dob.sql+' does not match any nodes
2022-07-07 08:02:20.558555 (Thread-23): 08:02:20  No nodes selected!
2022-07-07 08:02:20.559944 (Thread-23): sending response (<Response 1942 bytes [200 OK]>) to 10.0.41.177
2022-07-07 08:03:54.135133 (Thread-24): 08:03:54  Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
2022-07-07 08:03:54.136612 (Thread-24): 08:03:54  Partial parsing: updated file: ecommerce_data_model_dbt://macros/get_domain_from_email.sql
2022-07-07 08:03:54.136799 (Thread-24): 08:03:54  Parsing macros/get_domain_from_email.sql
2022-07-07 08:03:54.148558 (Thread-24): 08:03:54  1603: static parser failed on data_model/stg_traits/email_domain.sql
2022-07-07 08:03:54.163023 (Thread-24): 08:03:54  1602: parser fallback to jinja rendering on data_model/stg_traits/email_domain.sql
2022-07-07 08:03:54.215720 (Thread-24): 08:03:54  [WARNING]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.data-apps-ecommerce-template.data_model

2022-07-07 08:03:54.220495 (Thread-24): 08:03:54  Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '196d9207-3e38-4101-ac43-bc898fbec1a7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f520c1c89a0>]}
2022-07-07 08:03:54.674343 (Thread-25): handling status request
2022-07-07 08:03:54.674751 (Thread-25): 08:03:54  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '196d9207-3e38-4101-ac43-bc898fbec1a7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f520c66a430>]}
2022-07-07 08:03:54.675288 (Thread-25): sending response (<Response 2620 bytes [200 OK]>) to 10.0.41.177
2022-07-07 08:03:54.682956 (Thread-26): handling list request
2022-07-07 08:03:54.683229 (Thread-26): 08:03:54  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '196d9207-3e38-4101-ac43-bc898fbec1a7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f520c66a370>]}
2022-07-07 08:03:54.713182 (Thread-26): 08:03:54  Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '196d9207-3e38-4101-ac43-bc898fbec1a7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f520c66a490>]}
2022-07-07 08:03:54.713501 (Thread-26): 08:03:54  Found 16 models, 0 tests, 0 snapshots, 0 analyses, 181 macros, 0 operations, 0 seed files, 15 sources, 0 exposures, 0 metrics
2022-07-07 08:03:54.714810 (Thread-26): 08:03:54  The selection criterion '+macros/get_domain_from_email.sql+' does not match any nodes
2022-07-07 08:03:54.714976 (Thread-26): 08:03:54  No nodes selected!
2022-07-07 08:03:54.716389 (Thread-26): sending response (<Response 1947 bytes [200 OK]>) to 10.0.41.177
2022-07-07 08:03:54.903936 (Thread-27): handling status request
2022-07-07 08:03:54.904337 (Thread-27): 08:03:54  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '196d9207-3e38-4101-ac43-bc898fbec1a7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f520d72d8b0>]}
2022-07-07 08:03:54.904847 (Thread-27): sending response (<Response 2643 bytes [200 OK]>) to 10.0.41.177
2022-07-07 08:03:54.963760 (Thread-28): handling status request
2022-07-07 08:03:54.964146 (Thread-28): 08:03:54  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '196d9207-3e38-4101-ac43-bc898fbec1a7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f520c6bdac0>]}
2022-07-07 08:03:54.964643 (Thread-28): sending response (<Response 2643 bytes [200 OK]>) to 10.0.41.177
2022-07-07 08:03:56.108600 (Thread-29): handling status request
2022-07-07 08:03:56.109016 (Thread-29): 08:03:56  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '196d9207-3e38-4101-ac43-bc898fbec1a7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f520c6bde20>]}
2022-07-07 08:03:56.109513 (Thread-29): sending response (<Response 2643 bytes [200 OK]>) to 10.0.41.177
2022-07-07 08:03:56.512748 (Thread-30): handling compile_sql request
2022-07-07 08:03:56.513131 (Thread-30): 08:03:56  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '196d9207-3e38-4101-ac43-bc898fbec1a7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f520c1c88b0>]}
2022-07-07 08:03:58.810821 (Thread-30): sending response (<Response 139 bytes [200 OK]>) to 10.0.41.177
2022-07-07 08:03:58.834779 (MainThread): 08:03:58  Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'a2e4fca1-ffdf-463e-845e-79aa64fa1e2b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa437924dc0>]}
2022-07-07 08:03:58.835303 (MainThread): 08:03:58  Found 16 models, 0 tests, 0 snapshots, 0 analyses, 181 macros, 0 operations, 0 seed files, 15 sources, 0 exposures, 0 metrics
2022-07-07 08:03:58.835925 (Thread-1): 08:03:58  Acquiring new snowflake connection "rpc.ecommerce_data_model_dbt.request"
2022-07-07 08:03:58.836059 (Thread-1): 08:03:58  Began compiling node rpc.ecommerce_data_model_dbt.request
2022-07-07 08:03:58.836167 (Thread-1): 08:03:58  Compiling rpc.ecommerce_data_model_dbt.request
2022-07-07 08:03:58.837440 (Thread-1): 08:03:58  finished collecting timing info
2022-07-07 08:03:58.837578 (Thread-1): 08:03:58  Began executing node rpc.ecommerce_data_model_dbt.request
2022-07-07 08:03:58.837678 (Thread-1): 08:03:58  finished collecting timing info
2022-07-07 08:03:59.226995 (Thread-31): handling poll request
2022-07-07 08:03:59.227448 (Thread-31): 08:03:59  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '196d9207-3e38-4101-ac43-bc898fbec1a7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f520c1ecc10>]}
2022-07-07 08:03:59.229100 (Thread-31): sending response (<Response 5176 bytes [200 OK]>) to 10.0.41.177
2022-07-07 08:04:01.611036 (Thread-32): handling status request
2022-07-07 08:04:01.611434 (Thread-32): 08:04:01  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '196d9207-3e38-4101-ac43-bc898fbec1a7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f520c1ecf10>]}
2022-07-07 08:04:01.612011 (Thread-32): sending response (<Response 2643 bytes [200 OK]>) to 10.0.41.177
2022-07-07 08:04:02.011522 (Thread-33): handling run_sql request
2022-07-07 08:04:02.011967 (Thread-33): 08:04:02  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '196d9207-3e38-4101-ac43-bc898fbec1a7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f520c1eceb0>]}
2022-07-07 08:04:04.330313 (Thread-33): sending response (<Response 139 bytes [200 OK]>) to 10.0.41.177
2022-07-07 08:04:04.356199 (MainThread): 08:04:04  Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '5beccbd9-57e2-4b8a-b823-3f26d15fec92', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f00a7cdbdf0>]}
2022-07-07 08:04:04.356709 (MainThread): 08:04:04  Found 16 models, 0 tests, 0 snapshots, 0 analyses, 181 macros, 0 operations, 0 seed files, 15 sources, 0 exposures, 0 metrics
2022-07-07 08:04:04.357311 (Thread-1): 08:04:04  Acquiring new snowflake connection "rpc.ecommerce_data_model_dbt.request"
2022-07-07 08:04:04.357450 (Thread-1): 08:04:04  Began compiling node rpc.ecommerce_data_model_dbt.request
2022-07-07 08:04:04.357550 (Thread-1): 08:04:04  Compiling rpc.ecommerce_data_model_dbt.request
2022-07-07 08:04:04.360294 (Thread-1): 08:04:04  finished collecting timing info
2022-07-07 08:04:04.360428 (Thread-1): 08:04:04  Began executing node rpc.ecommerce_data_model_dbt.request
2022-07-07 08:04:04.361237 (Thread-1): 08:04:04  Using snowflake connection "rpc.ecommerce_data_model_dbt.request"
2022-07-07 08:04:04.361328 (Thread-1): 08:04:04  On rpc.ecommerce_data_model_dbt.request: select user_id, email_domain from 
(select user_id,
lower(split_part(properties_email, '@', 2))
 as email_domain, row_number() over(partition by user_id order by timestamp desc) as rn from 
analytics_db.data_apps_simulated.identifies where timestamp >= '2021-05-01' and timestamp <= '2022-06-29'
and properties_email is not null and properties_email != '') where rn = 1
limit 500
/* limit added automatically by dbt cloud */
2022-07-07 08:04:04.361410 (Thread-1): 08:04:04  Opening a new connection, currently in state init
2022-07-07 08:04:04.749606 (Thread-34): handling poll request
2022-07-07 08:04:04.750068 (Thread-34): 08:04:04  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '196d9207-3e38-4101-ac43-bc898fbec1a7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f520c1cb850>]}
2022-07-07 08:04:04.750901 (Thread-34): sending response (<Response 4164 bytes [200 OK]>) to 10.0.41.177
2022-07-07 08:04:05.657309 (Thread-1): 08:04:05  SQL status: SUCCESS 5 in 1.3 seconds
2022-07-07 08:04:05.658755 (Thread-1): 08:04:05  finished collecting timing info
2022-07-07 08:04:05.658938 (Thread-1): 08:04:05  On rpc.ecommerce_data_model_dbt.request: Close
2022-07-07 08:04:06.150350 (Thread-35): handling poll request
2022-07-07 08:04:06.150743 (Thread-35): 08:04:06  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '196d9207-3e38-4101-ac43-bc898fbec1a7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f520c1cbee0>]}
2022-07-07 08:04:06.151627 (Thread-35): sending response (<Response 5181 bytes [200 OK]>) to 10.0.41.177
2022-07-07 08:08:17.379258 (Thread-36): 08:08:17  Partial parsing enabled: 0 files deleted, 1 files added, 0 files changed.
2022-07-07 08:08:17.380871 (Thread-36): 08:08:17  Partial parsing: added file: ecommerce_data_model_dbt://macros/mindate.sql
2022-07-07 08:08:17.381071 (Thread-36): 08:08:17  Parsing macros/mindate.sql
2022-07-07 08:08:17.416958 (Thread-36): 08:08:17  [WARNING]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.data-apps-ecommerce-template.data_model

2022-07-07 08:08:17.422429 (Thread-36): 08:08:17  Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '196d9207-3e38-4101-ac43-bc898fbec1a7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f520c0ced30>]}
2022-07-07 08:08:18.169231 (Thread-37): handling status request
2022-07-07 08:08:18.169658 (Thread-37): 08:08:18  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '196d9207-3e38-4101-ac43-bc898fbec1a7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f520c1358b0>]}
2022-07-07 08:08:18.170171 (Thread-37): sending response (<Response 1981 bytes [200 OK]>) to 10.0.41.177
2022-07-07 08:08:18.191111 (Thread-38): handling status request
2022-07-07 08:08:18.191422 (Thread-38): 08:08:18  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '196d9207-3e38-4101-ac43-bc898fbec1a7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f520c135d90>]}
2022-07-07 08:08:18.191894 (Thread-38): sending response (<Response 1981 bytes [200 OK]>) to 10.0.41.177
2022-07-07 08:10:10.607000 (Thread-39): 08:10:10  Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
2022-07-07 08:10:10.608637 (Thread-39): 08:10:10  Partial parsing: updated file: ecommerce_data_model_dbt://macros/mindate.sql
2022-07-07 08:10:10.608817 (Thread-39): 08:10:10  Parsing macros/mindate.sql
2022-07-07 08:10:10.644823 (Thread-39): 08:10:10  [WARNING]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.data-apps-ecommerce-template.data_model

2022-07-07 08:10:10.650101 (Thread-39): 08:10:10  Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '196d9207-3e38-4101-ac43-bc898fbec1a7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f520c075eb0>]}
2022-07-07 08:10:11.364787 (Thread-40): handling status request
2022-07-07 08:10:11.365194 (Thread-40): 08:10:11  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '196d9207-3e38-4101-ac43-bc898fbec1a7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f520c1c8c70>]}
2022-07-07 08:10:11.365705 (Thread-40): sending response (<Response 1983 bytes [200 OK]>) to 10.0.41.177
2022-07-07 08:10:11.388408 (Thread-41): handling status request
2022-07-07 08:10:11.388796 (Thread-41): 08:10:11  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '196d9207-3e38-4101-ac43-bc898fbec1a7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f520c0cf8e0>]}
2022-07-07 08:10:11.389280 (Thread-41): sending response (<Response 1983 bytes [200 OK]>) to 10.0.41.177
2022-07-07 08:10:13.797094 (Thread-42): handling status request
2022-07-07 08:10:13.797543 (Thread-42): 08:10:13  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '196d9207-3e38-4101-ac43-bc898fbec1a7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f520c66aca0>]}
2022-07-07 08:10:13.798066 (Thread-42): sending response (<Response 1983 bytes [200 OK]>) to 10.0.41.177
2022-07-07 08:10:14.192105 (Thread-43): handling run_sql request
2022-07-07 08:10:14.192558 (Thread-43): 08:10:14  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '196d9207-3e38-4101-ac43-bc898fbec1a7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f520c1c5640>]}
2022-07-07 08:10:16.545627 (Thread-43): sending response (<Response 139 bytes [200 OK]>) to 10.0.41.177
2022-07-07 08:10:16.569978 (MainThread): 08:10:16  Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'c6956401-de2c-4d8f-aabc-497c6c39c840', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9f78aad250>]}
2022-07-07 08:10:16.570621 (MainThread): 08:10:16  Found 16 models, 0 tests, 0 snapshots, 0 analyses, 182 macros, 0 operations, 0 seed files, 15 sources, 0 exposures, 0 metrics
2022-07-07 08:10:16.571234 (Thread-1): 08:10:16  Acquiring new snowflake connection "rpc.ecommerce_data_model_dbt.request"
2022-07-07 08:10:16.571373 (Thread-1): 08:10:16  Began compiling node rpc.ecommerce_data_model_dbt.request
2022-07-07 08:10:16.571475 (Thread-1): 08:10:16  Compiling rpc.ecommerce_data_model_dbt.request
2022-07-07 08:10:16.572633 (Thread-1): 08:10:16  finished collecting timing info
2022-07-07 08:10:16.572767 (Thread-1): 08:10:16  Began executing node rpc.ecommerce_data_model_dbt.request
2022-07-07 08:10:16.573279 (Thread-1): 08:10:16  Using snowflake connection "rpc.ecommerce_data_model_dbt.request"
2022-07-07 08:10:16.573372 (Thread-1): 08:10:16  On rpc.ecommerce_data_model_dbt.request: limit 500
/* limit added automatically by dbt cloud */
2022-07-07 08:10:16.573452 (Thread-1): 08:10:16  Opening a new connection, currently in state init
2022-07-07 08:10:16.960310 (Thread-44): handling poll request
2022-07-07 08:10:16.960765 (Thread-44): 08:10:16  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '196d9207-3e38-4101-ac43-bc898fbec1a7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f520c0ba8e0>]}
2022-07-07 08:10:16.961687 (Thread-44): sending response (<Response 3761 bytes [200 OK]>) to 10.0.41.177
2022-07-07 08:10:17.312221 (Thread-1): 08:10:17  Snowflake adapter: Snowflake query id: 01a5716a-0602-33c1-0019-8203046b6392
2022-07-07 08:10:17.312416 (Thread-1): 08:10:17  Snowflake adapter: Snowflake error: 001003 (42000): SQL compilation error:
syntax error line 1 at position 0 unexpected 'limit'.
2022-07-07 08:10:17.312578 (Thread-1): 08:10:17  finished collecting timing info
2022-07-07 08:10:17.312734 (Thread-1): 08:10:17  On rpc.ecommerce_data_model_dbt.request: Close
2022-07-07 08:10:17.379894 (Thread-1): Got an exception: Database Error
  001003 (42000): SQL compilation error:
  syntax error line 1 at position 0 unexpected 'limit'.
Traceback (most recent call last):
  File "/usr/local/lib/python3.8/dist-packages/dbt/adapters/snowflake/connections.py", line 206, in exception_handler
    yield
  File "/usr/local/lib/python3.8/dist-packages/dbt/adapters/sql/connections.py", line 74, in add_query
    cursor.execute(sql, bindings)
  File "/usr/local/lib/python3.8/dist-packages/snowflake/connector/cursor.py", line 721, in execute
    Error.errorhandler_wrapper(
  File "/usr/local/lib/python3.8/dist-packages/snowflake/connector/errors.py", line 258, in errorhandler_wrapper
    cursor.errorhandler(connection, cursor, error_class, error_value)
  File "/usr/local/lib/python3.8/dist-packages/snowflake/connector/errors.py", line 188, in default_errorhandler
    raise error_class(
snowflake.connector.errors.ProgrammingError: 001003 (42000): SQL compilation error:
syntax error line 1 at position 0 unexpected 'limit'.

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/usr/local/lib/python3.8/dist-packages/dbt/task/base.py", line 361, in safe_run
    result = self.compile_and_execute(manifest, ctx)
  File "/usr/local/lib/python3.8/dist-packages/dbt/task/base.py", line 314, in compile_and_execute
    result = self.run(ctx.node, manifest)
  File "/usr/local/lib/python3.8/dist-packages/dbt/task/base.py", line 403, in run
    return self.execute(compiled_node, manifest)
  File "/usr/local/lib/python3.8/dist-packages/dbt_rpc/rpc/node_runners.py", line 90, in execute
    _, execute_result = self.adapter.execute(
  File "/usr/local/lib/python3.8/dist-packages/dbt/adapters/base/impl.py", line 225, in execute
    return self.connections.execute(
  File "/usr/local/lib/python3.8/dist-packages/dbt/adapters/sql/connections.py", line 127, in execute
    _, cursor = self.add_query(sql, auto_begin)
  File "/usr/local/lib/python3.8/dist-packages/dbt/adapters/snowflake/connections.py", line 433, in add_query
    connection, cursor = super().add_query(
  File "/usr/local/lib/python3.8/dist-packages/dbt/adapters/sql/connections.py", line 83, in add_query
    return connection, cursor
  File "/usr/lib/python3.8/contextlib.py", line 131, in __exit__
    self.gen.throw(type, value, traceback)
  File "/usr/local/lib/python3.8/dist-packages/dbt/adapters/snowflake/connections.py", line 223, in exception_handler
    raise DatabaseException(msg)
dbt.exceptions.DatabaseException: Database Error
  001003 (42000): SQL compilation error:
  syntax error line 1 at position 0 unexpected 'limit'.
2022-07-07 08:10:17.380898 (Thread-1): Got exception RPCException(10003, Database Error, {'type': 'DatabaseException', 'message': "Database Error in rpc request (from remote system)\n  001003 (42000): SQL compilation error:\n  syntax error line 1 at position 0 unexpected 'limit'.", 'raw_sql': '\nlimit 500\n/* limit added automatically by dbt cloud */', 'compiled_sql': '\nlimit 500\n/* limit added automatically by dbt cloud */', 'tags': None}, None)
Traceback (most recent call last):
  File "/usr/local/lib/python3.8/dist-packages/dbt_rpc/task/sql_commands.py", line 147, in _in_thread
    self.node_results.append(runner.safe_run(self.manifest))
  File "/usr/local/lib/python3.8/dist-packages/dbt/task/base.py", line 377, in safe_run
    result = self.error_result(ctx.node, error, started, [])
  File "/usr/local/lib/python3.8/dist-packages/dbt_rpc/rpc/node_runners.py", line 56, in error_result
    raise error
dbt_rpc.rpc.error.RPCException: RPCException(10003, Database Error, {'type': 'DatabaseException', 'message': "Database Error in rpc request (from remote system)\n  001003 (42000): SQL compilation error:\n  syntax error line 1 at position 0 unexpected 'limit'.", 'raw_sql': '\nlimit 500\n/* limit added automatically by dbt cloud */', 'compiled_sql': '\nlimit 500\n/* limit added automatically by dbt cloud */', 'tags': None}, None)
2022-07-07 08:10:18.393349 (Thread-45): handling poll request
2022-07-07 08:10:18.393789 (Thread-45): 08:10:18  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '196d9207-3e38-4101-ac43-bc898fbec1a7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f520c0ba520>]}
2022-07-07 08:10:18.394374 (Thread-45): sending response (<Response 9729 bytes [200 OK]>) to 10.0.41.177
2022-07-07 08:10:23.421940 (Thread-46): 08:10:23  Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
2022-07-07 08:10:23.422158 (Thread-46): 08:10:23  Partial parsing enabled, no changes found, skipping parsing
2022-07-07 08:10:23.422893 (Thread-46): 08:10:23  [WARNING]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.data-apps-ecommerce-template.data_model

2022-07-07 08:10:23.429232 (Thread-46): 08:10:23  Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '196d9207-3e38-4101-ac43-bc898fbec1a7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f51ed3cb370>]}
2022-07-07 08:10:24.165851 (Thread-47): handling status request
2022-07-07 08:10:24.166288 (Thread-47): 08:10:24  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '196d9207-3e38-4101-ac43-bc898fbec1a7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f520c13c160>]}
2022-07-07 08:10:24.166774 (Thread-47): sending response (<Response 1699 bytes [200 OK]>) to 10.0.41.177
2022-07-07 08:10:24.213512 (Thread-48): handling status request
2022-07-07 08:10:24.213827 (Thread-48): 08:10:24  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '196d9207-3e38-4101-ac43-bc898fbec1a7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f520c13c070>]}
2022-07-07 08:10:24.214260 (Thread-48): sending response (<Response 1699 bytes [200 OK]>) to 10.0.41.177
2022-07-07 08:10:27.460257 (Thread-49): 08:10:27  Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
2022-07-07 08:10:27.460801 (Thread-49): 08:10:27  Partial parsing: updated file: ecommerce_data_model_dbt://macros/get_age_from_dob.sql
2022-07-07 08:10:27.460982 (Thread-49): 08:10:27  Parsing macros/get_age_from_dob.sql
2022-07-07 08:10:27.466280 (Thread-49): 08:10:27  1603: static parser failed on data_model/stg_traits/age.sql
2022-07-07 08:10:27.605343 (Thread-49): 08:10:27  1602: parser fallback to jinja rendering on data_model/stg_traits/age.sql
2022-07-07 08:10:27.645531 (Thread-49): 08:10:27  [WARNING]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.data-apps-ecommerce-template.data_model

2022-07-07 08:10:27.650730 (Thread-49): 08:10:27  Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '196d9207-3e38-4101-ac43-bc898fbec1a7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5214100250>]}
2022-07-07 08:10:28.261554 (Thread-50): handling status request
2022-07-07 08:10:28.261979 (Thread-50): 08:10:28  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '196d9207-3e38-4101-ac43-bc898fbec1a7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f520c073c40>]}
2022-07-07 08:10:28.262509 (Thread-50): sending response (<Response 2615 bytes [200 OK]>) to 10.0.41.177
2022-07-07 08:10:28.280442 (Thread-51): handling status request
2022-07-07 08:10:28.280756 (Thread-51): 08:10:28  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '196d9207-3e38-4101-ac43-bc898fbec1a7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f520c073580>]}
2022-07-07 08:10:28.281236 (Thread-51): sending response (<Response 2615 bytes [200 OK]>) to 10.0.41.177
2022-07-07 08:12:04.751260 (Thread-52): 08:12:04  Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
2022-07-07 08:12:04.752055 (Thread-52): 08:12:04  Partial parsing enabled, no changes found, skipping parsing
2022-07-07 08:12:04.752728 (Thread-52): 08:12:04  [WARNING]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.data-apps-ecommerce-template.data_model

2022-07-07 08:12:04.758790 (Thread-52): 08:12:04  Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '196d9207-3e38-4101-ac43-bc898fbec1a7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f520c6046d0>]}
2022-07-07 08:12:05.579313 (Thread-53): handling status request
2022-07-07 08:12:05.579750 (Thread-53): 08:12:05  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '196d9207-3e38-4101-ac43-bc898fbec1a7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f524d7c5bb0>]}
2022-07-07 08:12:05.580269 (Thread-53): sending response (<Response 1699 bytes [200 OK]>) to 10.0.41.177
2022-07-07 08:12:05.625739 (Thread-54): handling status request
2022-07-07 08:12:05.626145 (Thread-54): 08:12:05  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '196d9207-3e38-4101-ac43-bc898fbec1a7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f520df3ecd0>]}
2022-07-07 08:12:05.626633 (Thread-54): sending response (<Response 1699 bytes [200 OK]>) to 10.0.41.177
2022-07-07 08:12:05.981393 (Thread-55): handling status request
2022-07-07 08:12:05.981819 (Thread-55): 08:12:05  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '196d9207-3e38-4101-ac43-bc898fbec1a7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f52140d38e0>]}
2022-07-07 08:12:05.982328 (Thread-55): sending response (<Response 1699 bytes [200 OK]>) to 10.0.41.177
2022-07-07 08:12:06.427941 (Thread-56): handling run_sql request
2022-07-07 08:12:06.428349 (Thread-56): 08:12:06  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '196d9207-3e38-4101-ac43-bc898fbec1a7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f520d736520>]}
2022-07-07 08:12:08.760542 (Thread-56): sending response (<Response 139 bytes [200 OK]>) to 10.0.41.177
2022-07-07 08:12:08.786127 (MainThread): 08:12:08  Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '14916dd8-2f58-4c50-af95-cc6e68dd40fb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f23d9caceb0>]}
2022-07-07 08:12:08.786664 (MainThread): 08:12:08  Found 16 models, 0 tests, 0 snapshots, 0 analyses, 182 macros, 0 operations, 0 seed files, 15 sources, 0 exposures, 0 metrics
2022-07-07 08:12:08.787253 (Thread-1): 08:12:08  Acquiring new snowflake connection "rpc.ecommerce_data_model_dbt.request"
2022-07-07 08:12:08.787388 (Thread-1): 08:12:08  Began compiling node rpc.ecommerce_data_model_dbt.request
2022-07-07 08:12:08.787485 (Thread-1): 08:12:08  Compiling rpc.ecommerce_data_model_dbt.request
2022-07-07 08:12:08.790276 (Thread-1): 08:12:08  finished collecting timing info
2022-07-07 08:12:08.790405 (Thread-1): 08:12:08  Began executing node rpc.ecommerce_data_model_dbt.request
2022-07-07 08:12:08.791240 (Thread-1): 08:12:08  Using snowflake connection "rpc.ecommerce_data_model_dbt.request"
2022-07-07 08:12:08.791329 (Thread-1): 08:12:08  On rpc.ecommerce_data_model_dbt.request: select user_id, 
CASE WHEN dateadd(year, datediff (year, birthday_col, mindate()), birthday_col) > mindate()
      THEN datediff(year, birthday_col, mindate()) - 1
      ELSE datediff(year, birthday_col, mindate())
 END
  as age 
from analytics_db.data_apps_simulated.identifies where timestamp >= '2021-05-01' and timestamp <= '2022-06-29'
and properties_birthday is not null and properties_birthday!=''
limit 500
/* limit added automatically by dbt cloud */
2022-07-07 08:12:08.791417 (Thread-1): 08:12:08  Opening a new connection, currently in state init
2022-07-07 08:12:09.165289 (Thread-57): handling poll request
2022-07-07 08:12:09.165761 (Thread-57): 08:12:09  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '196d9207-3e38-4101-ac43-bc898fbec1a7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f520c6100d0>]}
2022-07-07 08:12:09.166674 (Thread-57): sending response (<Response 4192 bytes [200 OK]>) to 10.0.41.177
2022-07-07 08:12:09.513829 (Thread-1): 08:12:09  Snowflake adapter: Snowflake query id: 01a5716c-0602-333e-0019-8203046b7382
2022-07-07 08:12:09.514020 (Thread-1): 08:12:09  Snowflake adapter: Snowflake error: 000904 (42000): SQL compilation error: error line 2 at position 40
invalid identifier 'BIRTHDAY_COL'
2022-07-07 08:12:09.514180 (Thread-1): 08:12:09  finished collecting timing info
2022-07-07 08:12:09.514336 (Thread-1): 08:12:09  On rpc.ecommerce_data_model_dbt.request: Close
2022-07-07 08:12:09.573073 (Thread-1): Got an exception: Database Error
  000904 (42000): SQL compilation error: error line 2 at position 40
  invalid identifier 'BIRTHDAY_COL'
Traceback (most recent call last):
  File "/usr/local/lib/python3.8/dist-packages/dbt/adapters/snowflake/connections.py", line 206, in exception_handler
    yield
  File "/usr/local/lib/python3.8/dist-packages/dbt/adapters/sql/connections.py", line 74, in add_query
    cursor.execute(sql, bindings)
  File "/usr/local/lib/python3.8/dist-packages/snowflake/connector/cursor.py", line 721, in execute
    Error.errorhandler_wrapper(
  File "/usr/local/lib/python3.8/dist-packages/snowflake/connector/errors.py", line 258, in errorhandler_wrapper
    cursor.errorhandler(connection, cursor, error_class, error_value)
  File "/usr/local/lib/python3.8/dist-packages/snowflake/connector/errors.py", line 188, in default_errorhandler
    raise error_class(
snowflake.connector.errors.ProgrammingError: 000904 (42000): SQL compilation error: error line 2 at position 40
invalid identifier 'BIRTHDAY_COL'

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/usr/local/lib/python3.8/dist-packages/dbt/task/base.py", line 361, in safe_run
    result = self.compile_and_execute(manifest, ctx)
  File "/usr/local/lib/python3.8/dist-packages/dbt/task/base.py", line 314, in compile_and_execute
    result = self.run(ctx.node, manifest)
  File "/usr/local/lib/python3.8/dist-packages/dbt/task/base.py", line 403, in run
    return self.execute(compiled_node, manifest)
  File "/usr/local/lib/python3.8/dist-packages/dbt_rpc/rpc/node_runners.py", line 90, in execute
    _, execute_result = self.adapter.execute(
  File "/usr/local/lib/python3.8/dist-packages/dbt/adapters/base/impl.py", line 225, in execute
    return self.connections.execute(
  File "/usr/local/lib/python3.8/dist-packages/dbt/adapters/sql/connections.py", line 127, in execute
    _, cursor = self.add_query(sql, auto_begin)
  File "/usr/local/lib/python3.8/dist-packages/dbt/adapters/snowflake/connections.py", line 433, in add_query
    connection, cursor = super().add_query(
  File "/usr/local/lib/python3.8/dist-packages/dbt/adapters/sql/connections.py", line 83, in add_query
    return connection, cursor
  File "/usr/lib/python3.8/contextlib.py", line 131, in __exit__
    self.gen.throw(type, value, traceback)
  File "/usr/local/lib/python3.8/dist-packages/dbt/adapters/snowflake/connections.py", line 223, in exception_handler
    raise DatabaseException(msg)
dbt.exceptions.DatabaseException: Database Error
  000904 (42000): SQL compilation error: error line 2 at position 40
  invalid identifier 'BIRTHDAY_COL'
2022-07-07 08:12:09.574025 (Thread-1): Got exception RPCException(10003, Database Error, {'type': 'DatabaseException', 'message': "Database Error in rpc request (from remote system)\n  000904 (42000): SQL compilation error: error line 2 at position 40\n  invalid identifier 'BIRTHDAY_COL'", 'raw_sql': "select user_id, {{get_age_from_dob(properties_birthday)}} as age \r\nfrom {{ source('ecommerce', 'identifies') }} where timestamp >= '{{ var('start_date') }}' and timestamp <= '{{ var('end_date') }}'\r\nand properties_birthday is not null and properties_birthday!=''\nlimit 500\n/* limit added automatically by dbt cloud */", 'compiled_sql': "select user_id, \nCASE WHEN dateadd(year, datediff (year, birthday_col, mindate()), birthday_col) > mindate()\n      THEN datediff(year, birthday_col, mindate()) - 1\n      ELSE datediff(year, birthday_col, mindate())\n END\n  as age \nfrom analytics_db.data_apps_simulated.identifies where timestamp >= '2021-05-01' and timestamp <= '2022-06-29'\nand properties_birthday is not null and properties_birthday!=''\nlimit 500\n/* limit added automatically by dbt cloud */", 'tags': None}, None)
Traceback (most recent call last):
  File "/usr/local/lib/python3.8/dist-packages/dbt_rpc/task/sql_commands.py", line 147, in _in_thread
    self.node_results.append(runner.safe_run(self.manifest))
  File "/usr/local/lib/python3.8/dist-packages/dbt/task/base.py", line 377, in safe_run
    result = self.error_result(ctx.node, error, started, [])
  File "/usr/local/lib/python3.8/dist-packages/dbt_rpc/rpc/node_runners.py", line 56, in error_result
    raise error
dbt_rpc.rpc.error.RPCException: RPCException(10003, Database Error, {'type': 'DatabaseException', 'message': "Database Error in rpc request (from remote system)\n  000904 (42000): SQL compilation error: error line 2 at position 40\n  invalid identifier 'BIRTHDAY_COL'", 'raw_sql': "select user_id, {{get_age_from_dob(properties_birthday)}} as age \r\nfrom {{ source('ecommerce', 'identifies') }} where timestamp >= '{{ var('start_date') }}' and timestamp <= '{{ var('end_date') }}'\r\nand properties_birthday is not null and properties_birthday!=''\nlimit 500\n/* limit added automatically by dbt cloud */", 'compiled_sql': "select user_id, \nCASE WHEN dateadd(year, datediff (year, birthday_col, mindate()), birthday_col) > mindate()\n      THEN datediff(year, birthday_col, mindate()) - 1\n      ELSE datediff(year, birthday_col, mindate())\n END\n  as age \nfrom analytics_db.data_apps_simulated.identifies where timestamp >= '2021-05-01' and timestamp <= '2022-06-29'\nand properties_birthday is not null and properties_birthday!=''\nlimit 500\n/* limit added automatically by dbt cloud */", 'tags': None}, None)
2022-07-07 08:12:10.585216 (Thread-58): handling poll request
2022-07-07 08:12:10.585614 (Thread-58): 08:12:10  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '196d9207-3e38-4101-ac43-bc898fbec1a7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f520c069d60>]}
2022-07-07 08:12:10.586289 (Thread-58): sending response (<Response 12277 bytes [200 OK]>) to 10.0.41.177
2022-07-07 08:12:42.200844 (Thread-59): handling status request
2022-07-07 08:12:42.201249 (Thread-59): 08:12:42  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '196d9207-3e38-4101-ac43-bc898fbec1a7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f520c069ac0>]}
2022-07-07 08:12:42.201776 (Thread-59): sending response (<Response 1699 bytes [200 OK]>) to 10.0.41.177
2022-07-07 08:12:42.614517 (Thread-60): handling compile_sql request
2022-07-07 08:12:42.614926 (Thread-60): 08:12:42  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '196d9207-3e38-4101-ac43-bc898fbec1a7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f520c069a00>]}
2022-07-07 08:12:44.950953 (Thread-60): sending response (<Response 139 bytes [200 OK]>) to 10.0.41.177
2022-07-07 08:12:44.976734 (MainThread): 08:12:44  Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'f9bf8298-d1bf-46e4-9a8b-23b3169ee501', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f044bb1aeb0>]}
2022-07-07 08:12:44.977267 (MainThread): 08:12:44  Found 16 models, 0 tests, 0 snapshots, 0 analyses, 182 macros, 0 operations, 0 seed files, 15 sources, 0 exposures, 0 metrics
2022-07-07 08:12:44.977856 (Thread-1): 08:12:44  Acquiring new snowflake connection "rpc.ecommerce_data_model_dbt.request"
2022-07-07 08:12:44.977990 (Thread-1): 08:12:44  Began compiling node rpc.ecommerce_data_model_dbt.request
2022-07-07 08:12:44.978087 (Thread-1): 08:12:44  Compiling rpc.ecommerce_data_model_dbt.request
2022-07-07 08:12:44.980864 (Thread-1): 08:12:44  finished collecting timing info
2022-07-07 08:12:44.980996 (Thread-1): 08:12:44  Began executing node rpc.ecommerce_data_model_dbt.request
2022-07-07 08:12:44.981095 (Thread-1): 08:12:44  finished collecting timing info
2022-07-07 08:12:45.360515 (Thread-61): handling poll request
2022-07-07 08:12:45.361052 (Thread-61): 08:12:45  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '196d9207-3e38-4101-ac43-bc898fbec1a7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f520c607d60>]}
2022-07-07 08:12:45.362243 (Thread-61): sending response (<Response 6663 bytes [200 OK]>) to 10.0.41.177
2022-07-07 08:12:55.476773 (Thread-62): 08:12:55  Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
2022-07-07 08:12:55.477300 (Thread-62): 08:12:55  Partial parsing: updated file: ecommerce_data_model_dbt://models/data_model/stg_traits/age.sql
2022-07-07 08:12:55.481211 (Thread-62): 08:12:55  1603: static parser failed on data_model/stg_traits/age.sql
2022-07-07 08:12:55.485117 (Thread-62): 08:12:55  1602: parser fallback to jinja rendering on data_model/stg_traits/age.sql
2022-07-07 08:12:55.523632 (Thread-62): 08:12:55  [WARNING]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.data-apps-ecommerce-template.data_model

2022-07-07 08:12:55.528540 (Thread-62): 08:12:55  Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '196d9207-3e38-4101-ac43-bc898fbec1a7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f51ed2ac3a0>]}
2022-07-07 08:12:56.260865 (Thread-63): handling status request
2022-07-07 08:12:56.261290 (Thread-63): 08:12:56  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '196d9207-3e38-4101-ac43-bc898fbec1a7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f520c6105e0>]}
2022-07-07 08:12:56.261861 (Thread-63): sending response (<Response 2348 bytes [200 OK]>) to 10.0.41.177
2022-07-07 08:12:56.308001 (Thread-64): handling status request
2022-07-07 08:12:56.308313 (Thread-64): 08:12:56  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '196d9207-3e38-4101-ac43-bc898fbec1a7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f51ed2e9550>]}
2022-07-07 08:12:56.308772 (Thread-64): sending response (<Response 2348 bytes [200 OK]>) to 10.0.41.177
2022-07-07 08:12:58.705692 (Thread-65): 08:12:58  Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
2022-07-07 08:12:58.705929 (Thread-65): 08:12:58  Partial parsing enabled, no changes found, skipping parsing
2022-07-07 08:12:58.706593 (Thread-65): 08:12:58  [WARNING]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.data-apps-ecommerce-template.data_model

2022-07-07 08:12:58.712311 (Thread-65): 08:12:58  Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '196d9207-3e38-4101-ac43-bc898fbec1a7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f51ed22aca0>]}
2022-07-07 08:12:59.508784 (Thread-66): handling status request
2022-07-07 08:12:59.509219 (Thread-66): 08:12:59  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '196d9207-3e38-4101-ac43-bc898fbec1a7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f51ed2b9880>]}
2022-07-07 08:12:59.514261 (Thread-67): handling status request
2022-07-07 08:12:59.514660 (Thread-67): 08:12:59  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '196d9207-3e38-4101-ac43-bc898fbec1a7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f520c6063a0>]}
2022-07-07 08:12:59.532549 (Thread-66): sending response (<Response 1699 bytes [200 OK]>) to 10.0.41.177
2022-07-07 08:12:59.533026 (Thread-67): sending response (<Response 1699 bytes [200 OK]>) to 10.0.41.177
2022-07-07 08:13:02.984081 (Thread-68): handling status request
2022-07-07 08:13:02.984517 (Thread-68): 08:13:02  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '196d9207-3e38-4101-ac43-bc898fbec1a7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f51ed2b9be0>]}
2022-07-07 08:13:02.985038 (Thread-68): sending response (<Response 1699 bytes [200 OK]>) to 10.0.41.177
2022-07-07 08:13:03.385959 (Thread-69): handling run_sql request
2022-07-07 08:13:03.386387 (Thread-69): 08:13:03  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '196d9207-3e38-4101-ac43-bc898fbec1a7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f51ed2b9430>]}
2022-07-07 08:13:05.702885 (Thread-69): sending response (<Response 139 bytes [200 OK]>) to 10.0.41.177
2022-07-07 08:13:05.729432 (MainThread): 08:13:05  Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '0b7261d8-a0d7-4b91-b636-561a9180ff8d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdfbc0daf40>]}
2022-07-07 08:13:05.729983 (MainThread): 08:13:05  Found 16 models, 0 tests, 0 snapshots, 0 analyses, 182 macros, 0 operations, 0 seed files, 15 sources, 0 exposures, 0 metrics
2022-07-07 08:13:05.730591 (Thread-1): 08:13:05  Acquiring new snowflake connection "rpc.ecommerce_data_model_dbt.request"
2022-07-07 08:13:05.730736 (Thread-1): 08:13:05  Began compiling node rpc.ecommerce_data_model_dbt.request
2022-07-07 08:13:05.730835 (Thread-1): 08:13:05  Compiling rpc.ecommerce_data_model_dbt.request
2022-07-07 08:13:05.733637 (Thread-1): 08:13:05  finished collecting timing info
2022-07-07 08:13:05.733787 (Thread-1): 08:13:05  Began executing node rpc.ecommerce_data_model_dbt.request
2022-07-07 08:13:05.734625 (Thread-1): 08:13:05  Using snowflake connection "rpc.ecommerce_data_model_dbt.request"
2022-07-07 08:13:05.734716 (Thread-1): 08:13:05  On rpc.ecommerce_data_model_dbt.request: select user_id, 
CASE WHEN dateadd(year, datediff (year, birthday_col, mindate()), birthday_col) > mindate()
      THEN datediff(year, birthday_col, mindate()) - 1
      ELSE datediff(year, birthday_col, mindate())
 END
  as age 
from analytics_db.data_apps_simulated.identifies where timestamp >= '2021-05-01' and timestamp <= '2022-06-29'
and properties_birthday is not null and properties_birthday!=''
limit 500
/* limit added automatically by dbt cloud */
2022-07-07 08:13:05.734797 (Thread-1): 08:13:05  Opening a new connection, currently in state init
2022-07-07 08:13:06.108932 (Thread-70): handling poll request
2022-07-07 08:13:06.109458 (Thread-70): 08:13:06  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '196d9207-3e38-4101-ac43-bc898fbec1a7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f520c606220>]}
2022-07-07 08:13:06.110419 (Thread-70): sending response (<Response 4192 bytes [200 OK]>) to 10.0.41.177
2022-07-07 08:13:06.401594 (Thread-1): 08:13:06  Snowflake adapter: Snowflake query id: 01a5716d-0602-33c1-0019-8203046b63ca
2022-07-07 08:13:06.401850 (Thread-1): 08:13:06  Snowflake adapter: Snowflake error: 000904 (42000): SQL compilation error: error line 2 at position 40
invalid identifier 'BIRTHDAY_COL'
2022-07-07 08:13:06.402066 (Thread-1): 08:13:06  finished collecting timing info
2022-07-07 08:13:06.402283 (Thread-1): 08:13:06  On rpc.ecommerce_data_model_dbt.request: Close
2022-07-07 08:13:06.500250 (Thread-1): Got an exception: Database Error
  000904 (42000): SQL compilation error: error line 2 at position 40
  invalid identifier 'BIRTHDAY_COL'
Traceback (most recent call last):
  File "/usr/local/lib/python3.8/dist-packages/dbt/adapters/snowflake/connections.py", line 206, in exception_handler
    yield
  File "/usr/local/lib/python3.8/dist-packages/dbt/adapters/sql/connections.py", line 74, in add_query
    cursor.execute(sql, bindings)
  File "/usr/local/lib/python3.8/dist-packages/snowflake/connector/cursor.py", line 721, in execute
    Error.errorhandler_wrapper(
  File "/usr/local/lib/python3.8/dist-packages/snowflake/connector/errors.py", line 258, in errorhandler_wrapper
    cursor.errorhandler(connection, cursor, error_class, error_value)
  File "/usr/local/lib/python3.8/dist-packages/snowflake/connector/errors.py", line 188, in default_errorhandler
    raise error_class(
snowflake.connector.errors.ProgrammingError: 000904 (42000): SQL compilation error: error line 2 at position 40
invalid identifier 'BIRTHDAY_COL'

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/usr/local/lib/python3.8/dist-packages/dbt/task/base.py", line 361, in safe_run
    result = self.compile_and_execute(manifest, ctx)
  File "/usr/local/lib/python3.8/dist-packages/dbt/task/base.py", line 314, in compile_and_execute
    result = self.run(ctx.node, manifest)
  File "/usr/local/lib/python3.8/dist-packages/dbt/task/base.py", line 403, in run
    return self.execute(compiled_node, manifest)
  File "/usr/local/lib/python3.8/dist-packages/dbt_rpc/rpc/node_runners.py", line 90, in execute
    _, execute_result = self.adapter.execute(
  File "/usr/local/lib/python3.8/dist-packages/dbt/adapters/base/impl.py", line 225, in execute
    return self.connections.execute(
  File "/usr/local/lib/python3.8/dist-packages/dbt/adapters/sql/connections.py", line 127, in execute
    _, cursor = self.add_query(sql, auto_begin)
  File "/usr/local/lib/python3.8/dist-packages/dbt/adapters/snowflake/connections.py", line 433, in add_query
    connection, cursor = super().add_query(
  File "/usr/local/lib/python3.8/dist-packages/dbt/adapters/sql/connections.py", line 83, in add_query
    return connection, cursor
  File "/usr/lib/python3.8/contextlib.py", line 131, in __exit__
    self.gen.throw(type, value, traceback)
  File "/usr/local/lib/python3.8/dist-packages/dbt/adapters/snowflake/connections.py", line 223, in exception_handler
    raise DatabaseException(msg)
dbt.exceptions.DatabaseException: Database Error
  000904 (42000): SQL compilation error: error line 2 at position 40
  invalid identifier 'BIRTHDAY_COL'
2022-07-07 08:13:06.501157 (Thread-1): Got exception RPCException(10003, Database Error, {'type': 'DatabaseException', 'message': "Database Error in rpc request (from remote system)\n  000904 (42000): SQL compilation error: error line 2 at position 40\n  invalid identifier 'BIRTHDAY_COL'", 'raw_sql': "select user_id, {{get_age_from_dob('properties_birthday')}} as age \r\nfrom {{ source('ecommerce', 'identifies') }} where timestamp >= '{{ var('start_date') }}' and timestamp <= '{{ var('end_date') }}'\r\nand properties_birthday is not null and properties_birthday!=''\nlimit 500\n/* limit added automatically by dbt cloud */", 'compiled_sql': "select user_id, \nCASE WHEN dateadd(year, datediff (year, birthday_col, mindate()), birthday_col) > mindate()\n      THEN datediff(year, birthday_col, mindate()) - 1\n      ELSE datediff(year, birthday_col, mindate())\n END\n  as age \nfrom analytics_db.data_apps_simulated.identifies where timestamp >= '2021-05-01' and timestamp <= '2022-06-29'\nand properties_birthday is not null and properties_birthday!=''\nlimit 500\n/* limit added automatically by dbt cloud */", 'tags': None}, None)
Traceback (most recent call last):
  File "/usr/local/lib/python3.8/dist-packages/dbt_rpc/task/sql_commands.py", line 147, in _in_thread
    self.node_results.append(runner.safe_run(self.manifest))
  File "/usr/local/lib/python3.8/dist-packages/dbt/task/base.py", line 377, in safe_run
    result = self.error_result(ctx.node, error, started, [])
  File "/usr/local/lib/python3.8/dist-packages/dbt_rpc/rpc/node_runners.py", line 56, in error_result
    raise error
dbt_rpc.rpc.error.RPCException: RPCException(10003, Database Error, {'type': 'DatabaseException', 'message': "Database Error in rpc request (from remote system)\n  000904 (42000): SQL compilation error: error line 2 at position 40\n  invalid identifier 'BIRTHDAY_COL'", 'raw_sql': "select user_id, {{get_age_from_dob('properties_birthday')}} as age \r\nfrom {{ source('ecommerce', 'identifies') }} where timestamp >= '{{ var('start_date') }}' and timestamp <= '{{ var('end_date') }}'\r\nand properties_birthday is not null and properties_birthday!=''\nlimit 500\n/* limit added automatically by dbt cloud */", 'compiled_sql': "select user_id, \nCASE WHEN dateadd(year, datediff (year, birthday_col, mindate()), birthday_col) > mindate()\n      THEN datediff(year, birthday_col, mindate()) - 1\n      ELSE datediff(year, birthday_col, mindate())\n END\n  as age \nfrom analytics_db.data_apps_simulated.identifies where timestamp >= '2021-05-01' and timestamp <= '2022-06-29'\nand properties_birthday is not null and properties_birthday!=''\nlimit 500\n/* limit added automatically by dbt cloud */", 'tags': None}, None)
2022-07-07 08:13:07.521026 (Thread-71): handling poll request
2022-07-07 08:13:07.521476 (Thread-71): 08:13:07  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '196d9207-3e38-4101-ac43-bc898fbec1a7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f520c073ee0>]}
2022-07-07 08:13:07.522143 (Thread-71): sending response (<Response 12283 bytes [200 OK]>) to 10.0.41.177
2022-07-07 08:13:21.033322 (Thread-72): handling status request
2022-07-07 08:13:21.033732 (Thread-72): 08:13:21  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '196d9207-3e38-4101-ac43-bc898fbec1a7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f51ed24e880>]}
2022-07-07 08:13:21.034261 (Thread-72): sending response (<Response 1699 bytes [200 OK]>) to 10.0.41.177
2022-07-07 08:13:21.478322 (Thread-73): handling compile_sql request
2022-07-07 08:13:21.478729 (Thread-73): 08:13:21  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '196d9207-3e38-4101-ac43-bc898fbec1a7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f51ed24e7c0>]}
2022-07-07 08:13:23.826156 (Thread-73): sending response (<Response 139 bytes [200 OK]>) to 10.0.41.177
2022-07-07 08:13:23.852407 (MainThread): 08:13:23  Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '0bd68576-4289-448a-83a5-e1f297b994e1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0860235e20>]}
2022-07-07 08:13:23.853005 (MainThread): 08:13:23  Found 16 models, 0 tests, 0 snapshots, 0 analyses, 182 macros, 0 operations, 0 seed files, 15 sources, 0 exposures, 0 metrics
2022-07-07 08:13:23.853639 (Thread-1): 08:13:23  Acquiring new snowflake connection "rpc.ecommerce_data_model_dbt.request"
2022-07-07 08:13:23.853771 (Thread-1): 08:13:23  Began compiling node rpc.ecommerce_data_model_dbt.request
2022-07-07 08:13:23.853866 (Thread-1): 08:13:23  Compiling rpc.ecommerce_data_model_dbt.request
2022-07-07 08:13:23.856727 (Thread-1): 08:13:23  finished collecting timing info
2022-07-07 08:13:23.856863 (Thread-1): 08:13:23  Began executing node rpc.ecommerce_data_model_dbt.request
2022-07-07 08:13:23.856963 (Thread-1): 08:13:23  finished collecting timing info
2022-07-07 08:13:24.303847 (Thread-74): handling poll request
2022-07-07 08:13:24.304351 (Thread-74): 08:13:24  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '196d9207-3e38-4101-ac43-bc898fbec1a7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f51ed2ace80>]}
2022-07-07 08:13:24.305546 (Thread-74): sending response (<Response 6667 bytes [200 OK]>) to 10.0.41.177
2022-07-07 08:13:31.316495 (Thread-75): handling status request
2022-07-07 08:13:31.316911 (Thread-75): 08:13:31  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '196d9207-3e38-4101-ac43-bc898fbec1a7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f52140faca0>]}
2022-07-07 08:13:31.317435 (Thread-75): sending response (<Response 1699 bytes [200 OK]>) to 10.0.41.177
2022-07-07 08:13:31.729114 (Thread-76): handling run_sql request
2022-07-07 08:13:31.729597 (Thread-76): 08:13:31  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '196d9207-3e38-4101-ac43-bc898fbec1a7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f51ed220ee0>]}
2022-07-07 08:13:34.103406 (Thread-76): sending response (<Response 139 bytes [200 OK]>) to 10.0.41.177
2022-07-07 08:13:34.129292 (MainThread): 08:13:34  Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '76dbdf66-f798-4f31-b9d4-9ebf4b4ad755', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7effd3129f40>]}
2022-07-07 08:13:34.129846 (MainThread): 08:13:34  Found 16 models, 0 tests, 0 snapshots, 0 analyses, 182 macros, 0 operations, 0 seed files, 15 sources, 0 exposures, 0 metrics
2022-07-07 08:13:34.130446 (Thread-1): 08:13:34  Acquiring new snowflake connection "rpc.ecommerce_data_model_dbt.request"
2022-07-07 08:13:34.130581 (Thread-1): 08:13:34  Began compiling node rpc.ecommerce_data_model_dbt.request
2022-07-07 08:13:34.130680 (Thread-1): 08:13:34  Compiling rpc.ecommerce_data_model_dbt.request
2022-07-07 08:13:34.133483 (Thread-1): 08:13:34  finished collecting timing info
2022-07-07 08:13:34.133621 (Thread-1): 08:13:34  Began executing node rpc.ecommerce_data_model_dbt.request
2022-07-07 08:13:34.134506 (Thread-1): 08:13:34  Using snowflake connection "rpc.ecommerce_data_model_dbt.request"
2022-07-07 08:13:34.134601 (Thread-1): 08:13:34  On rpc.ecommerce_data_model_dbt.request: select user_id, 
CASE WHEN dateadd(year, datediff (year, birthday_col, mindate()), birthday_col) > mindate()
      THEN datediff(year, birthday_col, mindate()) - 1
      ELSE datediff(year, birthday_col, mindate())
 END
  as age 
from analytics_db.data_apps_simulated.identifies where timestamp >= '2021-05-01' and timestamp <= '2022-06-29'
and properties_birthday is not null and properties_birthday!=''
limit 500
/* limit added automatically by dbt cloud */
2022-07-07 08:13:34.134682 (Thread-1): 08:13:34  Opening a new connection, currently in state init
2022-07-07 08:13:34.519631 (Thread-77): handling poll request
2022-07-07 08:13:34.520098 (Thread-77): 08:13:34  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '196d9207-3e38-4101-ac43-bc898fbec1a7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f51ed220b20>]}
2022-07-07 08:13:34.520994 (Thread-77): sending response (<Response 4191 bytes [200 OK]>) to 10.0.41.177
2022-07-07 08:13:35.075258 (Thread-1): 08:13:35  Snowflake adapter: Snowflake query id: 01a5716d-0602-3441-0019-8203046b460a
2022-07-07 08:13:35.075537 (Thread-1): 08:13:35  Snowflake adapter: Snowflake error: 000904 (42000): SQL compilation error: error line 2 at position 40
invalid identifier 'BIRTHDAY_COL'
2022-07-07 08:13:35.075808 (Thread-1): 08:13:35  finished collecting timing info
2022-07-07 08:13:35.076062 (Thread-1): 08:13:35  On rpc.ecommerce_data_model_dbt.request: Close
2022-07-07 08:13:35.143368 (Thread-1): Got an exception: Database Error
  000904 (42000): SQL compilation error: error line 2 at position 40
  invalid identifier 'BIRTHDAY_COL'
Traceback (most recent call last):
  File "/usr/local/lib/python3.8/dist-packages/dbt/adapters/snowflake/connections.py", line 206, in exception_handler
    yield
  File "/usr/local/lib/python3.8/dist-packages/dbt/adapters/sql/connections.py", line 74, in add_query
    cursor.execute(sql, bindings)
  File "/usr/local/lib/python3.8/dist-packages/snowflake/connector/cursor.py", line 721, in execute
    Error.errorhandler_wrapper(
  File "/usr/local/lib/python3.8/dist-packages/snowflake/connector/errors.py", line 258, in errorhandler_wrapper
    cursor.errorhandler(connection, cursor, error_class, error_value)
  File "/usr/local/lib/python3.8/dist-packages/snowflake/connector/errors.py", line 188, in default_errorhandler
    raise error_class(
snowflake.connector.errors.ProgrammingError: 000904 (42000): SQL compilation error: error line 2 at position 40
invalid identifier 'BIRTHDAY_COL'

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/usr/local/lib/python3.8/dist-packages/dbt/task/base.py", line 361, in safe_run
    result = self.compile_and_execute(manifest, ctx)
  File "/usr/local/lib/python3.8/dist-packages/dbt/task/base.py", line 314, in compile_and_execute
    result = self.run(ctx.node, manifest)
  File "/usr/local/lib/python3.8/dist-packages/dbt/task/base.py", line 403, in run
    return self.execute(compiled_node, manifest)
  File "/usr/local/lib/python3.8/dist-packages/dbt_rpc/rpc/node_runners.py", line 90, in execute
    _, execute_result = self.adapter.execute(
  File "/usr/local/lib/python3.8/dist-packages/dbt/adapters/base/impl.py", line 225, in execute
    return self.connections.execute(
  File "/usr/local/lib/python3.8/dist-packages/dbt/adapters/sql/connections.py", line 127, in execute
    _, cursor = self.add_query(sql, auto_begin)
  File "/usr/local/lib/python3.8/dist-packages/dbt/adapters/snowflake/connections.py", line 433, in add_query
    connection, cursor = super().add_query(
  File "/usr/local/lib/python3.8/dist-packages/dbt/adapters/sql/connections.py", line 83, in add_query
    return connection, cursor
  File "/usr/lib/python3.8/contextlib.py", line 131, in __exit__
    self.gen.throw(type, value, traceback)
  File "/usr/local/lib/python3.8/dist-packages/dbt/adapters/snowflake/connections.py", line 223, in exception_handler
    raise DatabaseException(msg)
dbt.exceptions.DatabaseException: Database Error
  000904 (42000): SQL compilation error: error line 2 at position 40
  invalid identifier 'BIRTHDAY_COL'
2022-07-07 08:13:35.144756 (Thread-1): Got exception RPCException(10003, Database Error, {'type': 'DatabaseException', 'message': "Database Error in rpc request (from remote system)\n  000904 (42000): SQL compilation error: error line 2 at position 40\n  invalid identifier 'BIRTHDAY_COL'", 'raw_sql': "select user_id, {{get_age_from_dob('properties_birthday')}} as age \r\nfrom {{ source('ecommerce', 'identifies') }} where timestamp >= '{{ var('start_date') }}' and timestamp <= '{{ var('end_date') }}'\r\nand properties_birthday is not null and properties_birthday!=''\nlimit 500\n/* limit added automatically by dbt cloud */", 'compiled_sql': "select user_id, \nCASE WHEN dateadd(year, datediff (year, birthday_col, mindate()), birthday_col) > mindate()\n      THEN datediff(year, birthday_col, mindate()) - 1\n      ELSE datediff(year, birthday_col, mindate())\n END\n  as age \nfrom analytics_db.data_apps_simulated.identifies where timestamp >= '2021-05-01' and timestamp <= '2022-06-29'\nand properties_birthday is not null and properties_birthday!=''\nlimit 500\n/* limit added automatically by dbt cloud */", 'tags': None}, None)
Traceback (most recent call last):
  File "/usr/local/lib/python3.8/dist-packages/dbt_rpc/task/sql_commands.py", line 147, in _in_thread
    self.node_results.append(runner.safe_run(self.manifest))
  File "/usr/local/lib/python3.8/dist-packages/dbt/task/base.py", line 377, in safe_run
    result = self.error_result(ctx.node, error, started, [])
  File "/usr/local/lib/python3.8/dist-packages/dbt_rpc/rpc/node_runners.py", line 56, in error_result
    raise error
dbt_rpc.rpc.error.RPCException: RPCException(10003, Database Error, {'type': 'DatabaseException', 'message': "Database Error in rpc request (from remote system)\n  000904 (42000): SQL compilation error: error line 2 at position 40\n  invalid identifier 'BIRTHDAY_COL'", 'raw_sql': "select user_id, {{get_age_from_dob('properties_birthday')}} as age \r\nfrom {{ source('ecommerce', 'identifies') }} where timestamp >= '{{ var('start_date') }}' and timestamp <= '{{ var('end_date') }}'\r\nand properties_birthday is not null and properties_birthday!=''\nlimit 500\n/* limit added automatically by dbt cloud */", 'compiled_sql': "select user_id, \nCASE WHEN dateadd(year, datediff (year, birthday_col, mindate()), birthday_col) > mindate()\n      THEN datediff(year, birthday_col, mindate()) - 1\n      ELSE datediff(year, birthday_col, mindate())\n END\n  as age \nfrom analytics_db.data_apps_simulated.identifies where timestamp >= '2021-05-01' and timestamp <= '2022-06-29'\nand properties_birthday is not null and properties_birthday!=''\nlimit 500\n/* limit added automatically by dbt cloud */", 'tags': None}, None)
2022-07-07 08:13:35.942407 (Thread-78): handling poll request
2022-07-07 08:13:35.942807 (Thread-78): 08:13:35  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '196d9207-3e38-4101-ac43-bc898fbec1a7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f520c606ca0>]}
2022-07-07 08:13:35.943450 (Thread-78): sending response (<Response 12283 bytes [200 OK]>) to 10.0.41.177
2022-07-07 08:13:58.170969 (Thread-79): handling status request
2022-07-07 08:13:58.171403 (Thread-79): 08:13:58  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '196d9207-3e38-4101-ac43-bc898fbec1a7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f520c604400>]}
2022-07-07 08:13:58.171978 (Thread-79): sending response (<Response 1699 bytes [200 OK]>) to 10.0.41.177
2022-07-07 08:13:58.589119 (Thread-80): handling run_sql request
2022-07-07 08:13:58.589517 (Thread-80): 08:13:58  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '196d9207-3e38-4101-ac43-bc898fbec1a7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f51ed2e7f70>]}
2022-07-07 08:14:01.010151 (Thread-80): sending response (<Response 139 bytes [200 OK]>) to 10.0.41.177
2022-07-07 08:14:01.036075 (MainThread): 08:14:01  Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'e62f8e59-629a-4051-8130-6eba78aa3f7e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe624170d00>]}
2022-07-07 08:14:01.036616 (MainThread): 08:14:01  Found 16 models, 0 tests, 0 snapshots, 0 analyses, 182 macros, 0 operations, 0 seed files, 15 sources, 0 exposures, 0 metrics
2022-07-07 08:14:01.037224 (Thread-1): 08:14:01  Acquiring new snowflake connection "rpc.ecommerce_data_model_dbt.request"
2022-07-07 08:14:01.037383 (Thread-1): 08:14:01  Began compiling node rpc.ecommerce_data_model_dbt.request
2022-07-07 08:14:01.037479 (Thread-1): 08:14:01  Compiling rpc.ecommerce_data_model_dbt.request
2022-07-07 08:14:01.040028 (Thread-1): 08:14:01  finished collecting timing info
2022-07-07 08:14:01.040158 (Thread-1): 08:14:01  Began executing node rpc.ecommerce_data_model_dbt.request
2022-07-07 08:14:01.041137 (Thread-1): 08:14:01  Using snowflake connection "rpc.ecommerce_data_model_dbt.request"
2022-07-07 08:14:01.041230 (Thread-1): 08:14:01  On rpc.ecommerce_data_model_dbt.request: select distinct user_id, 
first_value(properties_country)
over(partition by user_id order by case when properties_country is not null and properties_country != '' then 2 else 1 end desc, timestamp desc) as country,
first_value(properties_state)
over(partition by user_id order by case when properties_state is not null and properties_state != '' then 2 else 1 end desc, timestamp desc) as state
from analytics_db.data_apps_simulated.identifies where timestamp >= '2021-05-01' and timestamp <= '2022-06-29'
and user_id is not null
limit 500
/* limit added automatically by dbt cloud */
2022-07-07 08:14:01.041312 (Thread-1): 08:14:01  Opening a new connection, currently in state init
2022-07-07 08:14:01.464572 (Thread-81): handling poll request
2022-07-07 08:14:01.465114 (Thread-81): 08:14:01  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '196d9207-3e38-4101-ac43-bc898fbec1a7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f51ed2e7f40>]}
2022-07-07 08:14:01.466038 (Thread-81): sending response (<Response 4330 bytes [200 OK]>) to 10.0.41.177
2022-07-07 08:14:02.903493 (Thread-82): handling poll request
2022-07-07 08:14:02.903934 (Thread-82): 08:14:02  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '196d9207-3e38-4101-ac43-bc898fbec1a7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f520d72d910>]}
2022-07-07 08:14:02.904468 (Thread-82): sending response (<Response 412 bytes [200 OK]>) to 10.0.41.177
2022-07-07 08:14:03.491931 (Thread-1): 08:14:03  SQL status: SUCCESS 5 in 2.45 seconds
2022-07-07 08:14:03.493352 (Thread-1): 08:14:03  finished collecting timing info
2022-07-07 08:14:03.493538 (Thread-1): 08:14:03  On rpc.ecommerce_data_model_dbt.request: Close
2022-07-07 08:14:04.506862 (Thread-83): handling poll request
2022-07-07 08:14:04.507272 (Thread-83): 08:14:04  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '196d9207-3e38-4101-ac43-bc898fbec1a7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f51ed22ac10>]}
2022-07-07 08:14:04.508202 (Thread-83): sending response (<Response 5818 bytes [200 OK]>) to 10.0.41.177
2022-07-07 08:14:09.854233 (Thread-84): handling status request
2022-07-07 08:14:09.854695 (Thread-84): 08:14:09  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '196d9207-3e38-4101-ac43-bc898fbec1a7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f51ed2e7430>]}
2022-07-07 08:14:09.855285 (Thread-84): sending response (<Response 1699 bytes [200 OK]>) to 10.0.41.177
2022-07-07 08:14:10.262606 (Thread-85): handling run_sql request
2022-07-07 08:14:10.263032 (Thread-85): 08:14:10  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '196d9207-3e38-4101-ac43-bc898fbec1a7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f51ed22aa90>]}
2022-07-07 08:14:12.650328 (Thread-85): sending response (<Response 139 bytes [200 OK]>) to 10.0.41.177
2022-07-07 08:14:12.675951 (MainThread): 08:14:12  Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '3c996b80-b140-4555-8c10-88e2698513fe', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f50e00c0e50>]}
2022-07-07 08:14:12.676507 (MainThread): 08:14:12  Found 16 models, 0 tests, 0 snapshots, 0 analyses, 182 macros, 0 operations, 0 seed files, 15 sources, 0 exposures, 0 metrics
2022-07-07 08:14:12.677187 (Thread-1): 08:14:12  Acquiring new snowflake connection "rpc.ecommerce_data_model_dbt.request"
2022-07-07 08:14:12.677321 (Thread-1): 08:14:12  Began compiling node rpc.ecommerce_data_model_dbt.request
2022-07-07 08:14:12.677417 (Thread-1): 08:14:12  Compiling rpc.ecommerce_data_model_dbt.request
2022-07-07 08:14:12.680150 (Thread-1): 08:14:12  finished collecting timing info
2022-07-07 08:14:12.680282 (Thread-1): 08:14:12  Began executing node rpc.ecommerce_data_model_dbt.request
2022-07-07 08:14:12.681163 (Thread-1): 08:14:12  Using snowflake connection "rpc.ecommerce_data_model_dbt.request"
2022-07-07 08:14:12.681254 (Thread-1): 08:14:12  On rpc.ecommerce_data_model_dbt.request: select user_id, 
CASE WHEN dateadd(year, datediff (year, birthday_col, mindate()), birthday_col) > mindate()
      THEN datediff(year, birthday_col, mindate()) - 1
      ELSE datediff(year, birthday_col, mindate())
 END
  as age 
from analytics_db.data_apps_simulated.identifies where timestamp >= '2021-05-01' and timestamp <= '2022-06-29'
and properties_birthday is not null and properties_birthday!=''
limit 500
/* limit added automatically by dbt cloud */
2022-07-07 08:14:12.681335 (Thread-1): 08:14:12  Opening a new connection, currently in state init
2022-07-07 08:14:13.055366 (Thread-86): handling poll request
2022-07-07 08:14:13.055860 (Thread-86): 08:14:13  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '196d9207-3e38-4101-ac43-bc898fbec1a7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f51ed22c2b0>]}
2022-07-07 08:14:13.056803 (Thread-86): sending response (<Response 4192 bytes [200 OK]>) to 10.0.41.177
2022-07-07 08:14:13.362334 (Thread-1): 08:14:13  Snowflake adapter: Snowflake query id: 01a5716e-0602-33c1-0019-8203046b63de
2022-07-07 08:14:13.362533 (Thread-1): 08:14:13  Snowflake adapter: Snowflake error: 000904 (42000): SQL compilation error: error line 2 at position 40
invalid identifier 'BIRTHDAY_COL'
2022-07-07 08:14:13.362689 (Thread-1): 08:14:13  finished collecting timing info
2022-07-07 08:14:13.362879 (Thread-1): 08:14:13  On rpc.ecommerce_data_model_dbt.request: Close
2022-07-07 08:14:13.425749 (Thread-1): Got an exception: Database Error
  000904 (42000): SQL compilation error: error line 2 at position 40
  invalid identifier 'BIRTHDAY_COL'
Traceback (most recent call last):
  File "/usr/local/lib/python3.8/dist-packages/dbt/adapters/snowflake/connections.py", line 206, in exception_handler
    yield
  File "/usr/local/lib/python3.8/dist-packages/dbt/adapters/sql/connections.py", line 74, in add_query
    cursor.execute(sql, bindings)
  File "/usr/local/lib/python3.8/dist-packages/snowflake/connector/cursor.py", line 721, in execute
    Error.errorhandler_wrapper(
  File "/usr/local/lib/python3.8/dist-packages/snowflake/connector/errors.py", line 258, in errorhandler_wrapper
    cursor.errorhandler(connection, cursor, error_class, error_value)
  File "/usr/local/lib/python3.8/dist-packages/snowflake/connector/errors.py", line 188, in default_errorhandler
    raise error_class(
snowflake.connector.errors.ProgrammingError: 000904 (42000): SQL compilation error: error line 2 at position 40
invalid identifier 'BIRTHDAY_COL'

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/usr/local/lib/python3.8/dist-packages/dbt/task/base.py", line 361, in safe_run
    result = self.compile_and_execute(manifest, ctx)
  File "/usr/local/lib/python3.8/dist-packages/dbt/task/base.py", line 314, in compile_and_execute
    result = self.run(ctx.node, manifest)
  File "/usr/local/lib/python3.8/dist-packages/dbt/task/base.py", line 403, in run
    return self.execute(compiled_node, manifest)
  File "/usr/local/lib/python3.8/dist-packages/dbt_rpc/rpc/node_runners.py", line 90, in execute
    _, execute_result = self.adapter.execute(
  File "/usr/local/lib/python3.8/dist-packages/dbt/adapters/base/impl.py", line 225, in execute
    return self.connections.execute(
  File "/usr/local/lib/python3.8/dist-packages/dbt/adapters/sql/connections.py", line 127, in execute
    _, cursor = self.add_query(sql, auto_begin)
  File "/usr/local/lib/python3.8/dist-packages/dbt/adapters/snowflake/connections.py", line 433, in add_query
    connection, cursor = super().add_query(
  File "/usr/local/lib/python3.8/dist-packages/dbt/adapters/sql/connections.py", line 83, in add_query
    return connection, cursor
  File "/usr/lib/python3.8/contextlib.py", line 131, in __exit__
    self.gen.throw(type, value, traceback)
  File "/usr/local/lib/python3.8/dist-packages/dbt/adapters/snowflake/connections.py", line 223, in exception_handler
    raise DatabaseException(msg)
dbt.exceptions.DatabaseException: Database Error
  000904 (42000): SQL compilation error: error line 2 at position 40
  invalid identifier 'BIRTHDAY_COL'
2022-07-07 08:14:13.426689 (Thread-1): Got exception RPCException(10003, Database Error, {'type': 'DatabaseException', 'message': "Database Error in rpc request (from remote system)\n  000904 (42000): SQL compilation error: error line 2 at position 40\n  invalid identifier 'BIRTHDAY_COL'", 'raw_sql': "select user_id, {{get_age_from_dob('properties_birthday')}} as age \r\nfrom {{ source('ecommerce', 'identifies') }} where timestamp >= '{{ var('start_date') }}' and timestamp <= '{{ var('end_date') }}'\r\nand properties_birthday is not null and properties_birthday!=''\nlimit 500\n/* limit added automatically by dbt cloud */", 'compiled_sql': "select user_id, \nCASE WHEN dateadd(year, datediff (year, birthday_col, mindate()), birthday_col) > mindate()\n      THEN datediff(year, birthday_col, mindate()) - 1\n      ELSE datediff(year, birthday_col, mindate())\n END\n  as age \nfrom analytics_db.data_apps_simulated.identifies where timestamp >= '2021-05-01' and timestamp <= '2022-06-29'\nand properties_birthday is not null and properties_birthday!=''\nlimit 500\n/* limit added automatically by dbt cloud */", 'tags': None}, None)
Traceback (most recent call last):
  File "/usr/local/lib/python3.8/dist-packages/dbt_rpc/task/sql_commands.py", line 147, in _in_thread
    self.node_results.append(runner.safe_run(self.manifest))
  File "/usr/local/lib/python3.8/dist-packages/dbt/task/base.py", line 377, in safe_run
    result = self.error_result(ctx.node, error, started, [])
  File "/usr/local/lib/python3.8/dist-packages/dbt_rpc/rpc/node_runners.py", line 56, in error_result
    raise error
dbt_rpc.rpc.error.RPCException: RPCException(10003, Database Error, {'type': 'DatabaseException', 'message': "Database Error in rpc request (from remote system)\n  000904 (42000): SQL compilation error: error line 2 at position 40\n  invalid identifier 'BIRTHDAY_COL'", 'raw_sql': "select user_id, {{get_age_from_dob('properties_birthday')}} as age \r\nfrom {{ source('ecommerce', 'identifies') }} where timestamp >= '{{ var('start_date') }}' and timestamp <= '{{ var('end_date') }}'\r\nand properties_birthday is not null and properties_birthday!=''\nlimit 500\n/* limit added automatically by dbt cloud */", 'compiled_sql': "select user_id, \nCASE WHEN dateadd(year, datediff (year, birthday_col, mindate()), birthday_col) > mindate()\n      THEN datediff(year, birthday_col, mindate()) - 1\n      ELSE datediff(year, birthday_col, mindate())\n END\n  as age \nfrom analytics_db.data_apps_simulated.identifies where timestamp >= '2021-05-01' and timestamp <= '2022-06-29'\nand properties_birthday is not null and properties_birthday!=''\nlimit 500\n/* limit added automatically by dbt cloud */", 'tags': None}, None)
2022-07-07 08:14:14.480870 (Thread-87): handling poll request
2022-07-07 08:14:14.481287 (Thread-87): 08:14:14  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '196d9207-3e38-4101-ac43-bc898fbec1a7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f51ed2af220>]}
2022-07-07 08:14:14.481930 (Thread-87): sending response (<Response 12283 bytes [200 OK]>) to 10.0.41.177
2022-07-07 08:14:23.708546 (Thread-88): handling status request
2022-07-07 08:14:23.708944 (Thread-88): 08:14:23  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '196d9207-3e38-4101-ac43-bc898fbec1a7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f51ed2af670>]}
2022-07-07 08:14:23.709449 (Thread-88): sending response (<Response 1699 bytes [200 OK]>) to 10.0.41.177
2022-07-07 08:14:24.131910 (Thread-89): handling compile_sql request
2022-07-07 08:14:24.132303 (Thread-89): 08:14:24  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '196d9207-3e38-4101-ac43-bc898fbec1a7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f51ed2af850>]}
2022-07-07 08:14:26.420006 (Thread-89): sending response (<Response 139 bytes [200 OK]>) to 10.0.41.177
2022-07-07 08:14:26.445259 (MainThread): 08:14:26  Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '047e837e-7f62-4b63-a87b-934c1ddb8d0e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6e69926070>]}
2022-07-07 08:14:26.445797 (MainThread): 08:14:26  Found 16 models, 0 tests, 0 snapshots, 0 analyses, 182 macros, 0 operations, 0 seed files, 15 sources, 0 exposures, 0 metrics
2022-07-07 08:14:26.446392 (Thread-1): 08:14:26  Acquiring new snowflake connection "rpc.ecommerce_data_model_dbt.request"
2022-07-07 08:14:26.446526 (Thread-1): 08:14:26  Began compiling node rpc.ecommerce_data_model_dbt.request
2022-07-07 08:14:26.446628 (Thread-1): 08:14:26  Compiling rpc.ecommerce_data_model_dbt.request
2022-07-07 08:14:26.447827 (Thread-1): 08:14:26  finished collecting timing info
2022-07-07 08:14:26.447960 (Thread-1): 08:14:26  Began executing node rpc.ecommerce_data_model_dbt.request
2022-07-07 08:14:26.448058 (Thread-1): 08:14:26  finished collecting timing info
2022-07-07 08:14:26.856586 (Thread-90): handling poll request
2022-07-07 08:14:26.857110 (Thread-90): 08:14:26  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '196d9207-3e38-4101-ac43-bc898fbec1a7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f51ed2afd00>]}
2022-07-07 08:14:26.858226 (Thread-90): sending response (<Response 5162 bytes [200 OK]>) to 10.0.41.177
2022-07-07 08:14:30.545058 (Thread-91): handling status request
2022-07-07 08:14:30.545521 (Thread-91): 08:14:30  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '196d9207-3e38-4101-ac43-bc898fbec1a7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f51ed2932b0>]}
2022-07-07 08:14:30.546071 (Thread-91): sending response (<Response 1699 bytes [200 OK]>) to 10.0.41.177
2022-07-07 08:14:30.948373 (Thread-92): handling run_sql request
2022-07-07 08:14:30.948832 (Thread-92): 08:14:30  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '196d9207-3e38-4101-ac43-bc898fbec1a7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f51ed2af190>]}
2022-07-07 08:14:33.262460 (Thread-92): sending response (<Response 139 bytes [200 OK]>) to 10.0.41.177
2022-07-07 08:14:33.286984 (MainThread): 08:14:33  Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '4ae87e9b-5076-4c1c-8c07-f876caabd31d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbd0d365190>]}
2022-07-07 08:14:33.287574 (MainThread): 08:14:33  Found 16 models, 0 tests, 0 snapshots, 0 analyses, 182 macros, 0 operations, 0 seed files, 15 sources, 0 exposures, 0 metrics
2022-07-07 08:14:33.288234 (Thread-1): 08:14:33  Acquiring new snowflake connection "rpc.ecommerce_data_model_dbt.request"
2022-07-07 08:14:33.288369 (Thread-1): 08:14:33  Began compiling node rpc.ecommerce_data_model_dbt.request
2022-07-07 08:14:33.288483 (Thread-1): 08:14:33  Compiling rpc.ecommerce_data_model_dbt.request
2022-07-07 08:14:33.289611 (Thread-1): 08:14:33  finished collecting timing info
2022-07-07 08:14:33.289746 (Thread-1): 08:14:33  Began executing node rpc.ecommerce_data_model_dbt.request
2022-07-07 08:14:33.290255 (Thread-1): 08:14:33  Using snowflake connection "rpc.ecommerce_data_model_dbt.request"
2022-07-07 08:14:33.290347 (Thread-1): 08:14:33  On rpc.ecommerce_data_model_dbt.request: limit 500
/* limit added automatically by dbt cloud */
2022-07-07 08:14:33.290427 (Thread-1): 08:14:33  Opening a new connection, currently in state init
2022-07-07 08:14:33.673044 (Thread-93): handling poll request
2022-07-07 08:14:33.673520 (Thread-93): 08:14:33  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '196d9207-3e38-4101-ac43-bc898fbec1a7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f51ed282430>]}
2022-07-07 08:14:33.674425 (Thread-93): sending response (<Response 3761 bytes [200 OK]>) to 10.0.41.177
2022-07-07 08:14:34.073910 (Thread-1): 08:14:34  Snowflake adapter: Snowflake query id: 01a5716e-0602-33c1-0019-8203046b63e2
2022-07-07 08:14:34.074110 (Thread-1): 08:14:34  Snowflake adapter: Snowflake error: 001003 (42000): SQL compilation error:
syntax error line 1 at position 0 unexpected 'limit'.
2022-07-07 08:14:34.074272 (Thread-1): 08:14:34  finished collecting timing info
2022-07-07 08:14:34.074429 (Thread-1): 08:14:34  On rpc.ecommerce_data_model_dbt.request: Close
2022-07-07 08:14:34.166453 (Thread-1): Got an exception: Database Error
  001003 (42000): SQL compilation error:
  syntax error line 1 at position 0 unexpected 'limit'.
Traceback (most recent call last):
  File "/usr/local/lib/python3.8/dist-packages/dbt/adapters/snowflake/connections.py", line 206, in exception_handler
    yield
  File "/usr/local/lib/python3.8/dist-packages/dbt/adapters/sql/connections.py", line 74, in add_query
    cursor.execute(sql, bindings)
  File "/usr/local/lib/python3.8/dist-packages/snowflake/connector/cursor.py", line 721, in execute
    Error.errorhandler_wrapper(
  File "/usr/local/lib/python3.8/dist-packages/snowflake/connector/errors.py", line 258, in errorhandler_wrapper
    cursor.errorhandler(connection, cursor, error_class, error_value)
  File "/usr/local/lib/python3.8/dist-packages/snowflake/connector/errors.py", line 188, in default_errorhandler
    raise error_class(
snowflake.connector.errors.ProgrammingError: 001003 (42000): SQL compilation error:
syntax error line 1 at position 0 unexpected 'limit'.

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/usr/local/lib/python3.8/dist-packages/dbt/task/base.py", line 361, in safe_run
    result = self.compile_and_execute(manifest, ctx)
  File "/usr/local/lib/python3.8/dist-packages/dbt/task/base.py", line 314, in compile_and_execute
    result = self.run(ctx.node, manifest)
  File "/usr/local/lib/python3.8/dist-packages/dbt/task/base.py", line 403, in run
    return self.execute(compiled_node, manifest)
  File "/usr/local/lib/python3.8/dist-packages/dbt_rpc/rpc/node_runners.py", line 90, in execute
    _, execute_result = self.adapter.execute(
  File "/usr/local/lib/python3.8/dist-packages/dbt/adapters/base/impl.py", line 225, in execute
    return self.connections.execute(
  File "/usr/local/lib/python3.8/dist-packages/dbt/adapters/sql/connections.py", line 127, in execute
    _, cursor = self.add_query(sql, auto_begin)
  File "/usr/local/lib/python3.8/dist-packages/dbt/adapters/snowflake/connections.py", line 433, in add_query
    connection, cursor = super().add_query(
  File "/usr/local/lib/python3.8/dist-packages/dbt/adapters/sql/connections.py", line 83, in add_query
    return connection, cursor
  File "/usr/lib/python3.8/contextlib.py", line 131, in __exit__
    self.gen.throw(type, value, traceback)
  File "/usr/local/lib/python3.8/dist-packages/dbt/adapters/snowflake/connections.py", line 223, in exception_handler
    raise DatabaseException(msg)
dbt.exceptions.DatabaseException: Database Error
  001003 (42000): SQL compilation error:
  syntax error line 1 at position 0 unexpected 'limit'.
2022-07-07 08:14:34.167448 (Thread-1): Got exception RPCException(10003, Database Error, {'type': 'DatabaseException', 'message': "Database Error in rpc request (from remote system)\n  001003 (42000): SQL compilation error:\n  syntax error line 1 at position 0 unexpected 'limit'.", 'raw_sql': '\nlimit 500\n/* limit added automatically by dbt cloud */', 'compiled_sql': '\nlimit 500\n/* limit added automatically by dbt cloud */', 'tags': None}, None)
Traceback (most recent call last):
  File "/usr/local/lib/python3.8/dist-packages/dbt_rpc/task/sql_commands.py", line 147, in _in_thread
    self.node_results.append(runner.safe_run(self.manifest))
  File "/usr/local/lib/python3.8/dist-packages/dbt/task/base.py", line 377, in safe_run
    result = self.error_result(ctx.node, error, started, [])
  File "/usr/local/lib/python3.8/dist-packages/dbt_rpc/rpc/node_runners.py", line 56, in error_result
    raise error
dbt_rpc.rpc.error.RPCException: RPCException(10003, Database Error, {'type': 'DatabaseException', 'message': "Database Error in rpc request (from remote system)\n  001003 (42000): SQL compilation error:\n  syntax error line 1 at position 0 unexpected 'limit'.", 'raw_sql': '\nlimit 500\n/* limit added automatically by dbt cloud */', 'compiled_sql': '\nlimit 500\n/* limit added automatically by dbt cloud */', 'tags': None}, None)
2022-07-07 08:14:34.894722 (Thread-94): handling kill request
2022-07-07 08:14:34.895171 (Thread-94): 08:14:34  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '196d9207-3e38-4101-ac43-bc898fbec1a7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f51ed2826d0>]}
2022-07-07 08:14:34.895706 (Thread-94): sending response (<Response 115 bytes [200 OK]>) to 10.0.41.177
2022-07-07 08:14:35.072421 (Thread-95): handling poll request
2022-07-07 08:14:35.072860 (Thread-95): 08:14:35  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '196d9207-3e38-4101-ac43-bc898fbec1a7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f51ed2828b0>]}
2022-07-07 08:14:35.073497 (Thread-95): sending response (<Response 9729 bytes [200 OK]>) to 10.0.41.177
2022-07-07 08:14:51.994666 (Thread-96): handling status request
2022-07-07 08:14:51.995104 (Thread-96): 08:14:51  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '196d9207-3e38-4101-ac43-bc898fbec1a7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f51ed282d30>]}
2022-07-07 08:14:52.023113 (Thread-96): sending response (<Response 1699 bytes [200 OK]>) to 10.0.41.177
2022-07-07 08:14:52.444382 (Thread-97): handling compile_sql request
2022-07-07 08:14:52.444769 (Thread-97): 08:14:52  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '196d9207-3e38-4101-ac43-bc898fbec1a7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f51ed2822b0>]}
2022-07-07 08:14:54.786852 (Thread-97): sending response (<Response 139 bytes [200 OK]>) to 10.0.41.177
2022-07-07 08:14:54.812555 (MainThread): 08:14:54  Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'ae93d6dc-b7e4-4783-ad98-caf17fa94918', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3c15903fa0>]}
2022-07-07 08:14:54.813095 (MainThread): 08:14:54  Found 16 models, 0 tests, 0 snapshots, 0 analyses, 182 macros, 0 operations, 0 seed files, 15 sources, 0 exposures, 0 metrics
2022-07-07 08:14:54.813704 (Thread-1): 08:14:54  Acquiring new snowflake connection "rpc.ecommerce_data_model_dbt.request"
2022-07-07 08:14:54.813840 (Thread-1): 08:14:54  Began compiling node rpc.ecommerce_data_model_dbt.request
2022-07-07 08:14:54.813937 (Thread-1): 08:14:54  Compiling rpc.ecommerce_data_model_dbt.request
2022-07-07 08:14:54.816677 (Thread-1): 08:14:54  finished collecting timing info
2022-07-07 08:14:54.816808 (Thread-1): 08:14:54  Began executing node rpc.ecommerce_data_model_dbt.request
2022-07-07 08:14:54.816907 (Thread-1): 08:14:54  finished collecting timing info
2022-07-07 08:14:55.186771 (Thread-98): handling poll request
2022-07-07 08:14:55.187275 (Thread-98): 08:14:55  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '196d9207-3e38-4101-ac43-bc898fbec1a7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f51ed2aff70>]}
2022-07-07 08:14:55.188488 (Thread-98): sending response (<Response 6668 bytes [200 OK]>) to 10.0.41.177
2022-07-07 08:15:52.703215 (Thread-99): 08:15:52  Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
2022-07-07 08:15:52.703820 (Thread-99): 08:15:52  Partial parsing: updated file: ecommerce_data_model_dbt://macros/get_age_from_dob.sql
2022-07-07 08:15:52.704027 (Thread-99): 08:15:52  Parsing macros/get_age_from_dob.sql
2022-07-07 08:15:52.709974 (Thread-99): 08:15:52  1603: static parser failed on data_model/stg_traits/age.sql
2022-07-07 08:15:52.715465 (Thread-99): 08:15:52  1602: parser fallback to jinja rendering on data_model/stg_traits/age.sql
2022-07-07 08:15:52.750879 (Thread-99): 08:15:52  [WARNING]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.data-apps-ecommerce-template.data_model

2022-07-07 08:15:52.756554 (Thread-99): 08:15:52  Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '196d9207-3e38-4101-ac43-bc898fbec1a7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f51ed124430>]}
2022-07-07 08:15:53.555214 (Thread-100): handling status request
2022-07-07 08:15:53.555649 (Thread-100): 08:15:53  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '196d9207-3e38-4101-ac43-bc898fbec1a7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f51ed192a30>]}
2022-07-07 08:15:53.556216 (Thread-100): sending response (<Response 2615 bytes [200 OK]>) to 10.0.41.177
2022-07-07 08:15:53.704243 (Thread-101): handling status request
2022-07-07 08:15:53.704812 (Thread-101): 08:15:53  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '196d9207-3e38-4101-ac43-bc898fbec1a7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f51ed192850>]}
2022-07-07 08:15:53.705374 (Thread-101): sending response (<Response 2615 bytes [200 OK]>) to 10.0.41.177
2022-07-07 08:16:00.842861 (Thread-102): handling status request
2022-07-07 08:16:00.843257 (Thread-102): 08:16:00  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '196d9207-3e38-4101-ac43-bc898fbec1a7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f51ed1926d0>]}
2022-07-07 08:16:00.843837 (Thread-102): sending response (<Response 2615 bytes [200 OK]>) to 10.0.41.177
2022-07-07 08:16:01.278875 (Thread-103): handling run_sql request
2022-07-07 08:16:01.279275 (Thread-103): 08:16:01  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '196d9207-3e38-4101-ac43-bc898fbec1a7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f51ed1924c0>]}
2022-07-07 08:16:03.717012 (Thread-103): sending response (<Response 139 bytes [200 OK]>) to 10.0.41.177
2022-07-07 08:16:03.744920 (MainThread): 08:16:03  Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '2a9de6e2-c3ff-4b94-b941-0c124f7b7380', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe50bf61be0>]}
2022-07-07 08:16:03.745500 (MainThread): 08:16:03  Found 16 models, 0 tests, 0 snapshots, 0 analyses, 182 macros, 0 operations, 0 seed files, 15 sources, 0 exposures, 0 metrics
2022-07-07 08:16:03.746125 (Thread-1): 08:16:03  Acquiring new snowflake connection "rpc.ecommerce_data_model_dbt.request"
2022-07-07 08:16:03.746301 (Thread-1): 08:16:03  Began compiling node rpc.ecommerce_data_model_dbt.request
2022-07-07 08:16:03.746401 (Thread-1): 08:16:03  Compiling rpc.ecommerce_data_model_dbt.request
2022-07-07 08:16:03.749396 (Thread-1): 08:16:03  finished collecting timing info
2022-07-07 08:16:03.749533 (Thread-1): 08:16:03  Began executing node rpc.ecommerce_data_model_dbt.request
2022-07-07 08:16:03.750505 (Thread-1): 08:16:03  Using snowflake connection "rpc.ecommerce_data_model_dbt.request"
2022-07-07 08:16:03.750602 (Thread-1): 08:16:03  On rpc.ecommerce_data_model_dbt.request: select user_id, 
CASE WHEN dateadd(year, datediff (year, properties_birthday, mindate()), properties_birthday) > mindate()
      THEN datediff(year, properties_birthday, mindate()) - 1
      ELSE datediff(year, properties_birthday, mindate())
 END
  as age 
from analytics_db.data_apps_simulated.identifies where timestamp >= '2021-05-01' and timestamp <= '2022-06-29'
and properties_birthday is not null and properties_birthday!=''
limit 500
/* limit added automatically by dbt cloud */
2022-07-07 08:16:03.750687 (Thread-1): 08:16:03  Opening a new connection, currently in state init
2022-07-07 08:16:04.134610 (Thread-104): handling poll request
2022-07-07 08:16:04.135077 (Thread-104): 08:16:04  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '196d9207-3e38-4101-ac43-bc898fbec1a7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f51ed2820d0>]}
2022-07-07 08:16:04.136045 (Thread-104): sending response (<Response 4220 bytes [200 OK]>) to 10.0.41.177
2022-07-07 08:16:04.489756 (Thread-1): 08:16:04  Snowflake adapter: Snowflake query id: 01a57170-0602-3374-0019-8203046b541a
2022-07-07 08:16:04.489958 (Thread-1): 08:16:04  Snowflake adapter: Snowflake error: 002140 (42601): SQL compilation error:
Unknown functions MINDATE, MINDATE, MINDATE, MINDATE
2022-07-07 08:16:04.490120 (Thread-1): 08:16:04  finished collecting timing info
2022-07-07 08:16:04.490300 (Thread-1): 08:16:04  On rpc.ecommerce_data_model_dbt.request: Close
2022-07-07 08:16:04.562997 (Thread-1): Got an exception: Database Error
  002140 (42601): SQL compilation error:
  Unknown functions MINDATE, MINDATE, MINDATE, MINDATE
Traceback (most recent call last):
  File "/usr/local/lib/python3.8/dist-packages/dbt/adapters/snowflake/connections.py", line 206, in exception_handler
    yield
  File "/usr/local/lib/python3.8/dist-packages/dbt/adapters/sql/connections.py", line 74, in add_query
    cursor.execute(sql, bindings)
  File "/usr/local/lib/python3.8/dist-packages/snowflake/connector/cursor.py", line 721, in execute
    Error.errorhandler_wrapper(
  File "/usr/local/lib/python3.8/dist-packages/snowflake/connector/errors.py", line 258, in errorhandler_wrapper
    cursor.errorhandler(connection, cursor, error_class, error_value)
  File "/usr/local/lib/python3.8/dist-packages/snowflake/connector/errors.py", line 188, in default_errorhandler
    raise error_class(
snowflake.connector.errors.ProgrammingError: 002140 (42601): SQL compilation error:
Unknown functions MINDATE, MINDATE, MINDATE, MINDATE

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/usr/local/lib/python3.8/dist-packages/dbt/task/base.py", line 361, in safe_run
    result = self.compile_and_execute(manifest, ctx)
  File "/usr/local/lib/python3.8/dist-packages/dbt/task/base.py", line 314, in compile_and_execute
    result = self.run(ctx.node, manifest)
  File "/usr/local/lib/python3.8/dist-packages/dbt/task/base.py", line 403, in run
    return self.execute(compiled_node, manifest)
  File "/usr/local/lib/python3.8/dist-packages/dbt_rpc/rpc/node_runners.py", line 90, in execute
    _, execute_result = self.adapter.execute(
  File "/usr/local/lib/python3.8/dist-packages/dbt/adapters/base/impl.py", line 225, in execute
    return self.connections.execute(
  File "/usr/local/lib/python3.8/dist-packages/dbt/adapters/sql/connections.py", line 127, in execute
    _, cursor = self.add_query(sql, auto_begin)
  File "/usr/local/lib/python3.8/dist-packages/dbt/adapters/snowflake/connections.py", line 433, in add_query
    connection, cursor = super().add_query(
  File "/usr/local/lib/python3.8/dist-packages/dbt/adapters/sql/connections.py", line 83, in add_query
    return connection, cursor
  File "/usr/lib/python3.8/contextlib.py", line 131, in __exit__
    self.gen.throw(type, value, traceback)
  File "/usr/local/lib/python3.8/dist-packages/dbt/adapters/snowflake/connections.py", line 223, in exception_handler
    raise DatabaseException(msg)
dbt.exceptions.DatabaseException: Database Error
  002140 (42601): SQL compilation error:
  Unknown functions MINDATE, MINDATE, MINDATE, MINDATE
2022-07-07 08:16:04.563998 (Thread-1): Got exception RPCException(10003, Database Error, {'type': 'DatabaseException', 'message': 'Database Error in rpc request (from remote system)\n  002140 (42601): SQL compilation error:\n  Unknown functions MINDATE, MINDATE, MINDATE, MINDATE', 'raw_sql': "select user_id, {{get_age_from_dob('properties_birthday')}} as age \r\nfrom {{ source('ecommerce', 'identifies') }} where timestamp >= '{{ var('start_date') }}' and timestamp <= '{{ var('end_date') }}'\r\nand properties_birthday is not null and properties_birthday!=''\nlimit 500\n/* limit added automatically by dbt cloud */", 'compiled_sql': "select user_id, \nCASE WHEN dateadd(year, datediff (year, properties_birthday, mindate()), properties_birthday) > mindate()\n      THEN datediff(year, properties_birthday, mindate()) - 1\n      ELSE datediff(year, properties_birthday, mindate())\n END\n  as age \nfrom analytics_db.data_apps_simulated.identifies where timestamp >= '2021-05-01' and timestamp <= '2022-06-29'\nand properties_birthday is not null and properties_birthday!=''\nlimit 500\n/* limit added automatically by dbt cloud */", 'tags': None}, None)
Traceback (most recent call last):
  File "/usr/local/lib/python3.8/dist-packages/dbt_rpc/task/sql_commands.py", line 147, in _in_thread
    self.node_results.append(runner.safe_run(self.manifest))
  File "/usr/local/lib/python3.8/dist-packages/dbt/task/base.py", line 377, in safe_run
    result = self.error_result(ctx.node, error, started, [])
  File "/usr/local/lib/python3.8/dist-packages/dbt_rpc/rpc/node_runners.py", line 56, in error_result
    raise error
dbt_rpc.rpc.error.RPCException: RPCException(10003, Database Error, {'type': 'DatabaseException', 'message': 'Database Error in rpc request (from remote system)\n  002140 (42601): SQL compilation error:\n  Unknown functions MINDATE, MINDATE, MINDATE, MINDATE', 'raw_sql': "select user_id, {{get_age_from_dob('properties_birthday')}} as age \r\nfrom {{ source('ecommerce', 'identifies') }} where timestamp >= '{{ var('start_date') }}' and timestamp <= '{{ var('end_date') }}'\r\nand properties_birthday is not null and properties_birthday!=''\nlimit 500\n/* limit added automatically by dbt cloud */", 'compiled_sql': "select user_id, \nCASE WHEN dateadd(year, datediff (year, properties_birthday, mindate()), properties_birthday) > mindate()\n      THEN datediff(year, properties_birthday, mindate()) - 1\n      ELSE datediff(year, properties_birthday, mindate())\n END\n  as age \nfrom analytics_db.data_apps_simulated.identifies where timestamp >= '2021-05-01' and timestamp <= '2022-06-29'\nand properties_birthday is not null and properties_birthday!=''\nlimit 500\n/* limit added automatically by dbt cloud */", 'tags': None}, None)
2022-07-07 08:16:05.548633 (Thread-105): handling poll request
2022-07-07 08:16:05.549028 (Thread-105): 08:16:05  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '196d9207-3e38-4101-ac43-bc898fbec1a7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f51ed2ec3d0>]}
2022-07-07 08:16:05.549672 (Thread-105): sending response (<Response 12328 bytes [200 OK]>) to 10.0.41.177
2022-07-07 08:16:09.813896 (Thread-106): handling status request
2022-07-07 08:16:09.814373 (Thread-106): 08:16:09  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '196d9207-3e38-4101-ac43-bc898fbec1a7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f51ed282700>]}
2022-07-07 08:16:09.814946 (Thread-106): sending response (<Response 2615 bytes [200 OK]>) to 10.0.41.177
2022-07-07 08:16:10.226908 (Thread-107): handling compile_sql request
2022-07-07 08:16:10.227320 (Thread-107): 08:16:10  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '196d9207-3e38-4101-ac43-bc898fbec1a7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f520c10dd30>]}
2022-07-07 08:16:12.555584 (Thread-107): sending response (<Response 139 bytes [200 OK]>) to 10.0.41.177
2022-07-07 08:16:12.583179 (MainThread): 08:16:12  Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '53e91863-4272-4054-bdfb-aa66b0ff88b4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7faf8d72ea30>]}
2022-07-07 08:16:12.583749 (MainThread): 08:16:12  Found 16 models, 0 tests, 0 snapshots, 0 analyses, 182 macros, 0 operations, 0 seed files, 15 sources, 0 exposures, 0 metrics
2022-07-07 08:16:12.584363 (Thread-1): 08:16:12  Acquiring new snowflake connection "rpc.ecommerce_data_model_dbt.request"
2022-07-07 08:16:12.584502 (Thread-1): 08:16:12  Began compiling node rpc.ecommerce_data_model_dbt.request
2022-07-07 08:16:12.584598 (Thread-1): 08:16:12  Compiling rpc.ecommerce_data_model_dbt.request
2022-07-07 08:16:12.587441 (Thread-1): 08:16:12  finished collecting timing info
2022-07-07 08:16:12.587572 (Thread-1): 08:16:12  Began executing node rpc.ecommerce_data_model_dbt.request
2022-07-07 08:16:12.587705 (Thread-1): 08:16:12  finished collecting timing info
2022-07-07 08:16:12.979653 (Thread-108): handling poll request
2022-07-07 08:16:12.980109 (Thread-108): 08:16:12  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '196d9207-3e38-4101-ac43-bc898fbec1a7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f51ed122520>]}
2022-07-07 08:16:12.981276 (Thread-108): sending response (<Response 6724 bytes [200 OK]>) to 10.0.41.177
2022-07-07 08:17:35.282927 (Thread-109): handling status request
2022-07-07 08:17:35.284363 (Thread-109): 08:17:35  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '196d9207-3e38-4101-ac43-bc898fbec1a7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f51ed122790>]}
2022-07-07 08:17:35.284927 (Thread-109): sending response (<Response 2615 bytes [200 OK]>) to 10.0.41.177
2022-07-07 08:17:35.688152 (Thread-110): handling run_sql request
2022-07-07 08:17:35.688567 (Thread-110): 08:17:35  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '196d9207-3e38-4101-ac43-bc898fbec1a7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f51ed1226d0>]}
2022-07-07 08:17:38.075137 (Thread-110): sending response (<Response 139 bytes [200 OK]>) to 10.0.41.177
2022-07-07 08:17:38.103703 (MainThread): 08:17:38  Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '1ed0419d-0a20-425c-bc5b-351a43653652', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f19c5369310>]}
2022-07-07 08:17:38.104327 (MainThread): 08:17:38  Found 16 models, 0 tests, 0 snapshots, 0 analyses, 182 macros, 0 operations, 0 seed files, 15 sources, 0 exposures, 0 metrics
2022-07-07 08:17:38.105007 (Thread-1): 08:17:38  Acquiring new snowflake connection "rpc.ecommerce_data_model_dbt.request"
2022-07-07 08:17:38.105139 (Thread-1): 08:17:38  Began compiling node rpc.ecommerce_data_model_dbt.request
2022-07-07 08:17:38.105240 (Thread-1): 08:17:38  Compiling rpc.ecommerce_data_model_dbt.request
2022-07-07 08:17:38.106453 (Thread-1): 08:17:38  finished collecting timing info
2022-07-07 08:17:38.106586 (Thread-1): 08:17:38  Began executing node rpc.ecommerce_data_model_dbt.request
2022-07-07 08:17:38.107113 (Thread-1): 08:17:38  Using snowflake connection "rpc.ecommerce_data_model_dbt.request"
2022-07-07 08:17:38.107207 (Thread-1): 08:17:38  On rpc.ecommerce_data_model_dbt.request: limit 500
/* limit added automatically by dbt cloud */
2022-07-07 08:17:38.107287 (Thread-1): 08:17:38  Opening a new connection, currently in state init
2022-07-07 08:17:38.513432 (Thread-111): handling poll request
2022-07-07 08:17:38.513984 (Thread-111): 08:17:38  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '196d9207-3e38-4101-ac43-bc898fbec1a7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f51ed122e50>]}
2022-07-07 08:17:38.514906 (Thread-111): sending response (<Response 3770 bytes [200 OK]>) to 10.0.41.177
2022-07-07 08:17:38.829761 (Thread-1): 08:17:38  Snowflake adapter: Snowflake query id: 01a57171-0602-3374-0019-8203046b542e
2022-07-07 08:17:38.829963 (Thread-1): 08:17:38  Snowflake adapter: Snowflake error: 001003 (42000): SQL compilation error:
syntax error line 1 at position 0 unexpected 'limit'.
2022-07-07 08:17:38.830129 (Thread-1): 08:17:38  finished collecting timing info
2022-07-07 08:17:38.830285 (Thread-1): 08:17:38  On rpc.ecommerce_data_model_dbt.request: Close
2022-07-07 08:17:38.914185 (Thread-1): Got an exception: Database Error
  001003 (42000): SQL compilation error:
  syntax error line 1 at position 0 unexpected 'limit'.
Traceback (most recent call last):
  File "/usr/local/lib/python3.8/dist-packages/dbt/adapters/snowflake/connections.py", line 206, in exception_handler
    yield
  File "/usr/local/lib/python3.8/dist-packages/dbt/adapters/sql/connections.py", line 74, in add_query
    cursor.execute(sql, bindings)
  File "/usr/local/lib/python3.8/dist-packages/snowflake/connector/cursor.py", line 721, in execute
    Error.errorhandler_wrapper(
  File "/usr/local/lib/python3.8/dist-packages/snowflake/connector/errors.py", line 258, in errorhandler_wrapper
    cursor.errorhandler(connection, cursor, error_class, error_value)
  File "/usr/local/lib/python3.8/dist-packages/snowflake/connector/errors.py", line 188, in default_errorhandler
    raise error_class(
snowflake.connector.errors.ProgrammingError: 001003 (42000): SQL compilation error:
syntax error line 1 at position 0 unexpected 'limit'.

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/usr/local/lib/python3.8/dist-packages/dbt/task/base.py", line 361, in safe_run
    result = self.compile_and_execute(manifest, ctx)
  File "/usr/local/lib/python3.8/dist-packages/dbt/task/base.py", line 314, in compile_and_execute
    result = self.run(ctx.node, manifest)
  File "/usr/local/lib/python3.8/dist-packages/dbt/task/base.py", line 403, in run
    return self.execute(compiled_node, manifest)
  File "/usr/local/lib/python3.8/dist-packages/dbt_rpc/rpc/node_runners.py", line 90, in execute
    _, execute_result = self.adapter.execute(
  File "/usr/local/lib/python3.8/dist-packages/dbt/adapters/base/impl.py", line 225, in execute
    return self.connections.execute(
  File "/usr/local/lib/python3.8/dist-packages/dbt/adapters/sql/connections.py", line 127, in execute
    _, cursor = self.add_query(sql, auto_begin)
  File "/usr/local/lib/python3.8/dist-packages/dbt/adapters/snowflake/connections.py", line 433, in add_query
    connection, cursor = super().add_query(
  File "/usr/local/lib/python3.8/dist-packages/dbt/adapters/sql/connections.py", line 83, in add_query
    return connection, cursor
  File "/usr/lib/python3.8/contextlib.py", line 131, in __exit__
    self.gen.throw(type, value, traceback)
  File "/usr/local/lib/python3.8/dist-packages/dbt/adapters/snowflake/connections.py", line 223, in exception_handler
    raise DatabaseException(msg)
dbt.exceptions.DatabaseException: Database Error
  001003 (42000): SQL compilation error:
  syntax error line 1 at position 0 unexpected 'limit'.
2022-07-07 08:17:38.915173 (Thread-1): Got exception RPCException(10003, Database Error, {'type': 'DatabaseException', 'message': "Database Error in rpc request (from remote system)\n  001003 (42000): SQL compilation error:\n  syntax error line 1 at position 0 unexpected 'limit'.", 'raw_sql': '\nlimit 500\n/* limit added automatically by dbt cloud */', 'compiled_sql': '\nlimit 500\n/* limit added automatically by dbt cloud */', 'tags': None}, None)
Traceback (most recent call last):
  File "/usr/local/lib/python3.8/dist-packages/dbt_rpc/task/sql_commands.py", line 147, in _in_thread
    self.node_results.append(runner.safe_run(self.manifest))
  File "/usr/local/lib/python3.8/dist-packages/dbt/task/base.py", line 377, in safe_run
    result = self.error_result(ctx.node, error, started, [])
  File "/usr/local/lib/python3.8/dist-packages/dbt_rpc/rpc/node_runners.py", line 56, in error_result
    raise error
dbt_rpc.rpc.error.RPCException: RPCException(10003, Database Error, {'type': 'DatabaseException', 'message': "Database Error in rpc request (from remote system)\n  001003 (42000): SQL compilation error:\n  syntax error line 1 at position 0 unexpected 'limit'.", 'raw_sql': '\nlimit 500\n/* limit added automatically by dbt cloud */', 'compiled_sql': '\nlimit 500\n/* limit added automatically by dbt cloud */', 'tags': None}, None)
2022-07-07 08:17:39.919202 (Thread-112): handling poll request
2022-07-07 08:17:39.919654 (Thread-112): 08:17:39  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '196d9207-3e38-4101-ac43-bc898fbec1a7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f51ed11a190>]}
2022-07-07 08:17:39.920356 (Thread-112): sending response (<Response 9738 bytes [200 OK]>) to 10.0.41.177
2022-07-07 08:17:44.680174 (Thread-113): 08:17:44  Partial parsing enabled: 1 files deleted, 0 files added, 0 files changed.
2022-07-07 08:17:44.680540 (Thread-113): 08:17:44  Partial parsing: deleted file: ecommerce_data_model_dbt://macros/mindate.sql
2022-07-07 08:17:44.722989 (Thread-113): 08:17:44  [WARNING]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.data-apps-ecommerce-template.data_model

2022-07-07 08:17:44.728682 (Thread-113): 08:17:44  Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '196d9207-3e38-4101-ac43-bc898fbec1a7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f51ed0898b0>]}
2022-07-07 08:17:45.473889 (Thread-114): handling status request
2022-07-07 08:17:45.474351 (Thread-114): 08:17:45  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '196d9207-3e38-4101-ac43-bc898fbec1a7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f51ed066370>]}
2022-07-07 08:17:45.474869 (Thread-114): sending response (<Response 1720 bytes [200 OK]>) to 10.0.41.177
2022-07-07 08:17:45.524136 (Thread-115): handling status request
2022-07-07 08:17:45.524529 (Thread-115): 08:17:45  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '196d9207-3e38-4101-ac43-bc898fbec1a7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f51ed066a00>]}
2022-07-07 08:17:45.525006 (Thread-115): sending response (<Response 1720 bytes [200 OK]>) to 10.0.41.177
2022-07-07 08:17:57.860081 (Thread-116): 08:17:57  Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
2022-07-07 08:17:57.860609 (Thread-116): 08:17:57  Partial parsing: updated file: ecommerce_data_model_dbt://macros/get_age_from_dob.sql
2022-07-07 08:17:57.860795 (Thread-116): 08:17:57  Parsing macros/get_age_from_dob.sql
2022-07-07 08:17:57.866660 (Thread-116): 08:17:57  1603: static parser failed on data_model/stg_traits/age.sql
2022-07-07 08:17:57.872417 (Thread-116): 08:17:57  1602: parser fallback to jinja rendering on data_model/stg_traits/age.sql
2022-07-07 08:17:57.906459 (Thread-116): 08:17:57  [WARNING]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.data-apps-ecommerce-template.data_model

2022-07-07 08:17:57.911356 (Thread-116): 08:17:57  Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '196d9207-3e38-4101-ac43-bc898fbec1a7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f51ecfafbb0>]}
2022-07-07 08:17:58.666324 (Thread-117): handling status request
2022-07-07 08:17:58.666734 (Thread-117): 08:17:58  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '196d9207-3e38-4101-ac43-bc898fbec1a7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f51ed0557c0>]}
2022-07-07 08:17:58.667251 (Thread-117): sending response (<Response 2622 bytes [200 OK]>) to 10.0.41.177
2022-07-07 08:17:58.690021 (Thread-118): handling status request
2022-07-07 08:17:58.690323 (Thread-118): 08:17:58  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '196d9207-3e38-4101-ac43-bc898fbec1a7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f51ed293d00>]}
2022-07-07 08:17:58.690743 (Thread-118): sending response (<Response 2622 bytes [200 OK]>) to 10.0.41.177
2022-07-07 08:18:01.443520 (Thread-119): handling status request
2022-07-07 08:18:01.443925 (Thread-119): 08:18:01  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '196d9207-3e38-4101-ac43-bc898fbec1a7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f51ed055460>]}
2022-07-07 08:18:01.444417 (Thread-119): sending response (<Response 2622 bytes [200 OK]>) to 10.0.41.177
2022-07-07 08:18:01.868643 (Thread-120): handling run_sql request
2022-07-07 08:18:01.869019 (Thread-120): 08:18:01  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '196d9207-3e38-4101-ac43-bc898fbec1a7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f51ed055340>]}
2022-07-07 08:18:04.244913 (Thread-120): sending response (<Response 139 bytes [200 OK]>) to 10.0.41.177
2022-07-07 08:18:04.271989 (MainThread): 08:18:04  Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'd5831113-87e5-4410-931c-e73804b31fea', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f80cf99dca0>]}
2022-07-07 08:18:04.272536 (MainThread): 08:18:04  Found 16 models, 0 tests, 0 snapshots, 0 analyses, 181 macros, 0 operations, 0 seed files, 15 sources, 0 exposures, 0 metrics
2022-07-07 08:18:04.273044 (Thread-1): 08:18:04  Acquiring new snowflake connection "rpc.ecommerce_data_model_dbt.request"
2022-07-07 08:18:04.273163 (Thread-1): 08:18:04  Began compiling node rpc.ecommerce_data_model_dbt.request
2022-07-07 08:18:04.273259 (Thread-1): 08:18:04  Compiling rpc.ecommerce_data_model_dbt.request
2022-07-07 08:18:04.276009 (Thread-1): 08:18:04  finished collecting timing info
2022-07-07 08:18:04.276139 (Thread-1): 08:18:04  Began executing node rpc.ecommerce_data_model_dbt.request
2022-07-07 08:18:04.277074 (Thread-1): 08:18:04  Using snowflake connection "rpc.ecommerce_data_model_dbt.request"
2022-07-07 08:18:04.277174 (Thread-1): 08:18:04  On rpc.ecommerce_data_model_dbt.request: select user_id, 
CASE WHEN dateadd(year, datediff (year, properties_birthday, min(getdate(), '2022-06-29')), properties_birthday) > min(getdate(), '2022-06-29')
      THEN datediff(year, properties_birthday, min(getdate(), '2022-06-29')) - 1
      ELSE datediff(year, properties_birthday, min(getdate(), '2022-06-29'))
 END
  as age 
from analytics_db.data_apps_simulated.identifies where timestamp >= '2021-05-01' and timestamp <= '2022-06-29'
and properties_birthday is not null and properties_birthday!=''
limit 500
/* limit added automatically by dbt cloud */
2022-07-07 08:18:04.277255 (Thread-1): 08:18:04  Opening a new connection, currently in state init
2022-07-07 08:18:04.667728 (Thread-121): handling poll request
2022-07-07 08:18:04.668184 (Thread-121): 08:18:04  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '196d9207-3e38-4101-ac43-bc898fbec1a7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f51ed0f5040>]}
2022-07-07 08:18:04.669081 (Thread-121): sending response (<Response 4296 bytes [200 OK]>) to 10.0.41.177
2022-07-07 08:18:04.952006 (Thread-1): 08:18:04  Snowflake adapter: Snowflake query id: 01a57172-0602-33c1-0019-8203046b641a
2022-07-07 08:18:04.952194 (Thread-1): 08:18:04  Snowflake adapter: Snowflake error: 000939 (22023): SQL compilation error: error line 2 at position 61
too many arguments for function [MIN(GETDATE(), '2022-06-29')] expected 1, got 2
2022-07-07 08:18:04.952350 (Thread-1): 08:18:04  finished collecting timing info
2022-07-07 08:18:04.952502 (Thread-1): 08:18:04  On rpc.ecommerce_data_model_dbt.request: Close
2022-07-07 08:18:05.029928 (Thread-1): Got an exception: Database Error
  000939 (22023): SQL compilation error: error line 2 at position 61
  too many arguments for function [MIN(GETDATE(), '2022-06-29')] expected 1, got 2
Traceback (most recent call last):
  File "/usr/local/lib/python3.8/dist-packages/dbt/adapters/snowflake/connections.py", line 206, in exception_handler
    yield
  File "/usr/local/lib/python3.8/dist-packages/dbt/adapters/sql/connections.py", line 74, in add_query
    cursor.execute(sql, bindings)
  File "/usr/local/lib/python3.8/dist-packages/snowflake/connector/cursor.py", line 721, in execute
    Error.errorhandler_wrapper(
  File "/usr/local/lib/python3.8/dist-packages/snowflake/connector/errors.py", line 258, in errorhandler_wrapper
    cursor.errorhandler(connection, cursor, error_class, error_value)
  File "/usr/local/lib/python3.8/dist-packages/snowflake/connector/errors.py", line 188, in default_errorhandler
    raise error_class(
snowflake.connector.errors.ProgrammingError: 000939 (22023): SQL compilation error: error line 2 at position 61
too many arguments for function [MIN(GETDATE(), '2022-06-29')] expected 1, got 2

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/usr/local/lib/python3.8/dist-packages/dbt/task/base.py", line 361, in safe_run
    result = self.compile_and_execute(manifest, ctx)
  File "/usr/local/lib/python3.8/dist-packages/dbt/task/base.py", line 314, in compile_and_execute
    result = self.run(ctx.node, manifest)
  File "/usr/local/lib/python3.8/dist-packages/dbt/task/base.py", line 403, in run
    return self.execute(compiled_node, manifest)
  File "/usr/local/lib/python3.8/dist-packages/dbt_rpc/rpc/node_runners.py", line 90, in execute
    _, execute_result = self.adapter.execute(
  File "/usr/local/lib/python3.8/dist-packages/dbt/adapters/base/impl.py", line 225, in execute
    return self.connections.execute(
  File "/usr/local/lib/python3.8/dist-packages/dbt/adapters/sql/connections.py", line 127, in execute
    _, cursor = self.add_query(sql, auto_begin)
  File "/usr/local/lib/python3.8/dist-packages/dbt/adapters/snowflake/connections.py", line 433, in add_query
    connection, cursor = super().add_query(
  File "/usr/local/lib/python3.8/dist-packages/dbt/adapters/sql/connections.py", line 83, in add_query
    return connection, cursor
  File "/usr/lib/python3.8/contextlib.py", line 131, in __exit__
    self.gen.throw(type, value, traceback)
  File "/usr/local/lib/python3.8/dist-packages/dbt/adapters/snowflake/connections.py", line 223, in exception_handler
    raise DatabaseException(msg)
dbt.exceptions.DatabaseException: Database Error
  000939 (22023): SQL compilation error: error line 2 at position 61
  too many arguments for function [MIN(GETDATE(), '2022-06-29')] expected 1, got 2
2022-07-07 08:18:05.030874 (Thread-1): Got exception RPCException(10003, Database Error, {'type': 'DatabaseException', 'message': "Database Error in rpc request (from remote system)\n  000939 (22023): SQL compilation error: error line 2 at position 61\n  too many arguments for function [MIN(GETDATE(), '2022-06-29')] expected 1, got 2", 'raw_sql': "select user_id, {{get_age_from_dob('properties_birthday')}} as age \r\nfrom {{ source('ecommerce', 'identifies') }} where timestamp >= '{{ var('start_date') }}' and timestamp <= '{{ var('end_date') }}'\r\nand properties_birthday is not null and properties_birthday!=''\nlimit 500\n/* limit added automatically by dbt cloud */", 'compiled_sql': "select user_id, \nCASE WHEN dateadd(year, datediff (year, properties_birthday, min(getdate(), '2022-06-29')), properties_birthday) > min(getdate(), '2022-06-29')\n      THEN datediff(year, properties_birthday, min(getdate(), '2022-06-29')) - 1\n      ELSE datediff(year, properties_birthday, min(getdate(), '2022-06-29'))\n END\n  as age \nfrom analytics_db.data_apps_simulated.identifies where timestamp >= '2021-05-01' and timestamp <= '2022-06-29'\nand properties_birthday is not null and properties_birthday!=''\nlimit 500\n/* limit added automatically by dbt cloud */", 'tags': None}, None)
Traceback (most recent call last):
  File "/usr/local/lib/python3.8/dist-packages/dbt_rpc/task/sql_commands.py", line 147, in _in_thread
    self.node_results.append(runner.safe_run(self.manifest))
  File "/usr/local/lib/python3.8/dist-packages/dbt/task/base.py", line 377, in safe_run
    result = self.error_result(ctx.node, error, started, [])
  File "/usr/local/lib/python3.8/dist-packages/dbt_rpc/rpc/node_runners.py", line 56, in error_result
    raise error
dbt_rpc.rpc.error.RPCException: RPCException(10003, Database Error, {'type': 'DatabaseException', 'message': "Database Error in rpc request (from remote system)\n  000939 (22023): SQL compilation error: error line 2 at position 61\n  too many arguments for function [MIN(GETDATE(), '2022-06-29')] expected 1, got 2", 'raw_sql': "select user_id, {{get_age_from_dob('properties_birthday')}} as age \r\nfrom {{ source('ecommerce', 'identifies') }} where timestamp >= '{{ var('start_date') }}' and timestamp <= '{{ var('end_date') }}'\r\nand properties_birthday is not null and properties_birthday!=''\nlimit 500\n/* limit added automatically by dbt cloud */", 'compiled_sql': "select user_id, \nCASE WHEN dateadd(year, datediff (year, properties_birthday, min(getdate(), '2022-06-29')), properties_birthday) > min(getdate(), '2022-06-29')\n      THEN datediff(year, properties_birthday, min(getdate(), '2022-06-29')) - 1\n      ELSE datediff(year, properties_birthday, min(getdate(), '2022-06-29'))\n END\n  as age \nfrom analytics_db.data_apps_simulated.identifies where timestamp >= '2021-05-01' and timestamp <= '2022-06-29'\nand properties_birthday is not null and properties_birthday!=''\nlimit 500\n/* limit added automatically by dbt cloud */", 'tags': None}, None)
2022-07-07 08:18:06.069753 (Thread-122): handling poll request
2022-07-07 08:18:06.070135 (Thread-122): 08:18:06  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '196d9207-3e38-4101-ac43-bc898fbec1a7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f51ed0f10a0>]}
2022-07-07 08:18:06.070761 (Thread-122): sending response (<Response 13028 bytes [200 OK]>) to 10.0.41.177
2022-07-07 08:18:14.702668 (Thread-123): handling status request
2022-07-07 08:18:14.703099 (Thread-123): 08:18:14  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '196d9207-3e38-4101-ac43-bc898fbec1a7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f51ed0f53a0>]}
2022-07-07 08:18:14.703674 (Thread-123): sending response (<Response 2622 bytes [200 OK]>) to 10.0.41.177
2022-07-07 08:18:15.147312 (Thread-124): handling compile_sql request
2022-07-07 08:18:15.147747 (Thread-124): 08:18:15  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '196d9207-3e38-4101-ac43-bc898fbec1a7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f51ed11a670>]}
2022-07-07 08:18:17.490404 (Thread-124): sending response (<Response 139 bytes [200 OK]>) to 10.0.41.177
2022-07-07 08:18:17.517461 (MainThread): 08:18:17  Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '132dd355-a62b-4f98-9ed3-d7c3314e8e10', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0c9305bb20>]}
2022-07-07 08:18:17.518010 (MainThread): 08:18:17  Found 16 models, 0 tests, 0 snapshots, 0 analyses, 181 macros, 0 operations, 0 seed files, 15 sources, 0 exposures, 0 metrics
2022-07-07 08:18:17.518614 (Thread-1): 08:18:17  Acquiring new snowflake connection "rpc.ecommerce_data_model_dbt.request"
2022-07-07 08:18:17.518753 (Thread-1): 08:18:17  Began compiling node rpc.ecommerce_data_model_dbt.request
2022-07-07 08:18:17.518889 (Thread-1): 08:18:17  Compiling rpc.ecommerce_data_model_dbt.request
2022-07-07 08:18:17.523029 (Thread-1): 08:18:17  finished collecting timing info
2022-07-07 08:18:17.523215 (Thread-1): 08:18:17  Began executing node rpc.ecommerce_data_model_dbt.request
2022-07-07 08:18:17.523359 (Thread-1): 08:18:17  finished collecting timing info
2022-07-07 08:18:17.890216 (Thread-125): handling poll request
2022-07-07 08:18:17.890689 (Thread-125): 08:18:17  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '196d9207-3e38-4101-ac43-bc898fbec1a7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f51ed16c550>]}
2022-07-07 08:18:17.891898 (Thread-125): sending response (<Response 6875 bytes [200 OK]>) to 10.0.41.177
2022-07-07 08:18:52.924979 (Thread-126): handling status request
2022-07-07 08:18:52.925407 (Thread-126): 08:18:52  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '196d9207-3e38-4101-ac43-bc898fbec1a7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f51ed16cf40>]}
2022-07-07 08:18:52.953629 (Thread-126): sending response (<Response 2622 bytes [200 OK]>) to 10.0.41.177
2022-07-07 08:18:53.367803 (Thread-127): handling run_sql request
2022-07-07 08:18:53.368209 (Thread-127): 08:18:53  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '196d9207-3e38-4101-ac43-bc898fbec1a7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f51ed16cd60>]}
2022-07-07 08:18:55.679929 (Thread-127): sending response (<Response 139 bytes [200 OK]>) to 10.0.41.177
2022-07-07 08:18:55.708831 (MainThread): 08:18:55  Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'dd7a648c-5a4a-4e69-915b-b27f70993b5b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb978c4fd30>]}
2022-07-07 08:18:55.709432 (MainThread): 08:18:55  Found 16 models, 0 tests, 0 snapshots, 0 analyses, 181 macros, 0 operations, 0 seed files, 15 sources, 0 exposures, 0 metrics
2022-07-07 08:18:55.710065 (Thread-1): 08:18:55  Acquiring new snowflake connection "rpc.ecommerce_data_model_dbt.request"
2022-07-07 08:18:55.710213 (Thread-1): 08:18:55  Began compiling node rpc.ecommerce_data_model_dbt.request
2022-07-07 08:18:55.710321 (Thread-1): 08:18:55  Compiling rpc.ecommerce_data_model_dbt.request
2022-07-07 08:18:55.713347 (Thread-1): 08:18:55  finished collecting timing info
2022-07-07 08:18:55.713479 (Thread-1): 08:18:55  Began executing node rpc.ecommerce_data_model_dbt.request
2022-07-07 08:18:55.714441 (Thread-1): 08:18:55  Using snowflake connection "rpc.ecommerce_data_model_dbt.request"
2022-07-07 08:18:55.714534 (Thread-1): 08:18:55  On rpc.ecommerce_data_model_dbt.request: select user_id, 
CASE WHEN dateadd(year, datediff (year, properties_birthday, min(getdate(), '2022-06-29')), properties_birthday) > min(getdate(), '2022-06-29')
      THEN datediff(year, properties_birthday, min(getdate(), '2022-06-29')) - 1
      ELSE datediff(year, properties_birthday, min(getdate(), '2022-06-29'))
 END
  as age 
from analytics_db.data_apps_simulated.identifies where timestamp >= '2021-05-01' and timestamp <= '2022-06-29'
and properties_birthday is not null and properties_birthday!=''
limit 500
/* limit added automatically by dbt cloud */
2022-07-07 08:18:55.714615 (Thread-1): 08:18:55  Opening a new connection, currently in state init
2022-07-07 08:18:56.116085 (Thread-128): handling poll request
2022-07-07 08:18:56.116550 (Thread-128): 08:18:56  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '196d9207-3e38-4101-ac43-bc898fbec1a7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f51ed017a00>]}
2022-07-07 08:18:56.117495 (Thread-128): sending response (<Response 4296 bytes [200 OK]>) to 10.0.41.177
2022-07-07 08:18:56.460598 (Thread-1): 08:18:56  Snowflake adapter: Snowflake query id: 01a57172-0602-3441-0019-8203046b4682
2022-07-07 08:18:56.460794 (Thread-1): 08:18:56  Snowflake adapter: Snowflake error: 000939 (22023): SQL compilation error: error line 2 at position 61
too many arguments for function [MIN(GETDATE(), '2022-06-29')] expected 1, got 2
2022-07-07 08:18:56.460955 (Thread-1): 08:18:56  finished collecting timing info
2022-07-07 08:18:56.461115 (Thread-1): 08:18:56  On rpc.ecommerce_data_model_dbt.request: Close
2022-07-07 08:18:56.524035 (Thread-1): Got an exception: Database Error
  000939 (22023): SQL compilation error: error line 2 at position 61
  too many arguments for function [MIN(GETDATE(), '2022-06-29')] expected 1, got 2
Traceback (most recent call last):
  File "/usr/local/lib/python3.8/dist-packages/dbt/adapters/snowflake/connections.py", line 206, in exception_handler
    yield
  File "/usr/local/lib/python3.8/dist-packages/dbt/adapters/sql/connections.py", line 74, in add_query
    cursor.execute(sql, bindings)
  File "/usr/local/lib/python3.8/dist-packages/snowflake/connector/cursor.py", line 721, in execute
    Error.errorhandler_wrapper(
  File "/usr/local/lib/python3.8/dist-packages/snowflake/connector/errors.py", line 258, in errorhandler_wrapper
    cursor.errorhandler(connection, cursor, error_class, error_value)
  File "/usr/local/lib/python3.8/dist-packages/snowflake/connector/errors.py", line 188, in default_errorhandler
    raise error_class(
snowflake.connector.errors.ProgrammingError: 000939 (22023): SQL compilation error: error line 2 at position 61
too many arguments for function [MIN(GETDATE(), '2022-06-29')] expected 1, got 2

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/usr/local/lib/python3.8/dist-packages/dbt/task/base.py", line 361, in safe_run
    result = self.compile_and_execute(manifest, ctx)
  File "/usr/local/lib/python3.8/dist-packages/dbt/task/base.py", line 314, in compile_and_execute
    result = self.run(ctx.node, manifest)
  File "/usr/local/lib/python3.8/dist-packages/dbt/task/base.py", line 403, in run
    return self.execute(compiled_node, manifest)
  File "/usr/local/lib/python3.8/dist-packages/dbt_rpc/rpc/node_runners.py", line 90, in execute
    _, execute_result = self.adapter.execute(
  File "/usr/local/lib/python3.8/dist-packages/dbt/adapters/base/impl.py", line 225, in execute
    return self.connections.execute(
  File "/usr/local/lib/python3.8/dist-packages/dbt/adapters/sql/connections.py", line 127, in execute
    _, cursor = self.add_query(sql, auto_begin)
  File "/usr/local/lib/python3.8/dist-packages/dbt/adapters/snowflake/connections.py", line 433, in add_query
    connection, cursor = super().add_query(
  File "/usr/local/lib/python3.8/dist-packages/dbt/adapters/sql/connections.py", line 83, in add_query
    return connection, cursor
  File "/usr/lib/python3.8/contextlib.py", line 131, in __exit__
    self.gen.throw(type, value, traceback)
  File "/usr/local/lib/python3.8/dist-packages/dbt/adapters/snowflake/connections.py", line 223, in exception_handler
    raise DatabaseException(msg)
dbt.exceptions.DatabaseException: Database Error
  000939 (22023): SQL compilation error: error line 2 at position 61
  too many arguments for function [MIN(GETDATE(), '2022-06-29')] expected 1, got 2
2022-07-07 08:18:56.524979 (Thread-1): Got exception RPCException(10003, Database Error, {'type': 'DatabaseException', 'message': "Database Error in rpc request (from remote system)\n  000939 (22023): SQL compilation error: error line 2 at position 61\n  too many arguments for function [MIN(GETDATE(), '2022-06-29')] expected 1, got 2", 'raw_sql': "select user_id, {{get_age_from_dob('properties_birthday')}} as age \r\nfrom {{ source('ecommerce', 'identifies') }} where timestamp >= '{{ var('start_date') }}' and timestamp <= '{{ var('end_date') }}'\r\nand properties_birthday is not null and properties_birthday!=''\nlimit 500\n/* limit added automatically by dbt cloud */", 'compiled_sql': "select user_id, \nCASE WHEN dateadd(year, datediff (year, properties_birthday, min(getdate(), '2022-06-29')), properties_birthday) > min(getdate(), '2022-06-29')\n      THEN datediff(year, properties_birthday, min(getdate(), '2022-06-29')) - 1\n      ELSE datediff(year, properties_birthday, min(getdate(), '2022-06-29'))\n END\n  as age \nfrom analytics_db.data_apps_simulated.identifies where timestamp >= '2021-05-01' and timestamp <= '2022-06-29'\nand properties_birthday is not null and properties_birthday!=''\nlimit 500\n/* limit added automatically by dbt cloud */", 'tags': None}, None)
Traceback (most recent call last):
  File "/usr/local/lib/python3.8/dist-packages/dbt_rpc/task/sql_commands.py", line 147, in _in_thread
    self.node_results.append(runner.safe_run(self.manifest))
  File "/usr/local/lib/python3.8/dist-packages/dbt/task/base.py", line 377, in safe_run
    result = self.error_result(ctx.node, error, started, [])
  File "/usr/local/lib/python3.8/dist-packages/dbt_rpc/rpc/node_runners.py", line 56, in error_result
    raise error
dbt_rpc.rpc.error.RPCException: RPCException(10003, Database Error, {'type': 'DatabaseException', 'message': "Database Error in rpc request (from remote system)\n  000939 (22023): SQL compilation error: error line 2 at position 61\n  too many arguments for function [MIN(GETDATE(), '2022-06-29')] expected 1, got 2", 'raw_sql': "select user_id, {{get_age_from_dob('properties_birthday')}} as age \r\nfrom {{ source('ecommerce', 'identifies') }} where timestamp >= '{{ var('start_date') }}' and timestamp <= '{{ var('end_date') }}'\r\nand properties_birthday is not null and properties_birthday!=''\nlimit 500\n/* limit added automatically by dbt cloud */", 'compiled_sql': "select user_id, \nCASE WHEN dateadd(year, datediff (year, properties_birthday, min(getdate(), '2022-06-29')), properties_birthday) > min(getdate(), '2022-06-29')\n      THEN datediff(year, properties_birthday, min(getdate(), '2022-06-29')) - 1\n      ELSE datediff(year, properties_birthday, min(getdate(), '2022-06-29'))\n END\n  as age \nfrom analytics_db.data_apps_simulated.identifies where timestamp >= '2021-05-01' and timestamp <= '2022-06-29'\nand properties_birthday is not null and properties_birthday!=''\nlimit 500\n/* limit added automatically by dbt cloud */", 'tags': None}, None)
2022-07-07 08:18:57.537257 (Thread-129): handling poll request
2022-07-07 08:18:57.537658 (Thread-129): 08:18:57  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '196d9207-3e38-4101-ac43-bc898fbec1a7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f51ed017a30>]}
2022-07-07 08:18:57.538286 (Thread-129): sending response (<Response 13028 bytes [200 OK]>) to 10.0.41.177
2022-07-07 08:19:07.900979 (Thread-130): handling status request
2022-07-07 08:19:07.901407 (Thread-130): 08:19:07  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '196d9207-3e38-4101-ac43-bc898fbec1a7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f51ed0170d0>]}
2022-07-07 08:19:07.901976 (Thread-130): sending response (<Response 2622 bytes [200 OK]>) to 10.0.41.177
2022-07-07 08:19:08.301318 (Thread-131): handling compile_sql request
2022-07-07 08:19:08.301729 (Thread-131): 08:19:08  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '196d9207-3e38-4101-ac43-bc898fbec1a7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f51ecf99fa0>]}
2022-07-07 08:19:10.622029 (Thread-131): sending response (<Response 139 bytes [200 OK]>) to 10.0.41.177
2022-07-07 08:19:10.650316 (MainThread): 08:19:10  Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '67b14852-401e-4aa4-9952-e701d5afb54e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd0ac75ce20>]}
2022-07-07 08:19:10.650846 (MainThread): 08:19:10  Found 16 models, 0 tests, 0 snapshots, 0 analyses, 181 macros, 0 operations, 0 seed files, 15 sources, 0 exposures, 0 metrics
2022-07-07 08:19:10.651427 (Thread-1): 08:19:10  Acquiring new snowflake connection "rpc.ecommerce_data_model_dbt.request"
2022-07-07 08:19:10.651561 (Thread-1): 08:19:10  Began compiling node rpc.ecommerce_data_model_dbt.request
2022-07-07 08:19:10.651718 (Thread-1): 08:19:10  Compiling rpc.ecommerce_data_model_dbt.request
2022-07-07 08:19:10.654444 (Thread-1): 08:19:10  finished collecting timing info
2022-07-07 08:19:10.654571 (Thread-1): 08:19:10  Began executing node rpc.ecommerce_data_model_dbt.request
2022-07-07 08:19:10.654669 (Thread-1): 08:19:10  finished collecting timing info
2022-07-07 08:19:11.030341 (Thread-132): handling poll request
2022-07-07 08:19:11.030792 (Thread-132): 08:19:11  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '196d9207-3e38-4101-ac43-bc898fbec1a7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f51ed1175e0>]}
2022-07-07 08:19:11.031975 (Thread-132): sending response (<Response 6875 bytes [200 OK]>) to 10.0.41.177
2022-07-07 08:19:54.633721 (Thread-133): handling status request
2022-07-07 08:19:54.634126 (Thread-133): 08:19:54  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '196d9207-3e38-4101-ac43-bc898fbec1a7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f51ed117b80>]}
2022-07-07 08:19:54.634683 (Thread-133): sending response (<Response 2622 bytes [200 OK]>) to 10.0.41.177
2022-07-07 08:19:55.045573 (Thread-134): handling run_sql request
2022-07-07 08:19:55.045966 (Thread-134): 08:19:55  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '196d9207-3e38-4101-ac43-bc898fbec1a7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f51ed1179d0>]}
2022-07-07 08:19:57.350519 (Thread-134): sending response (<Response 139 bytes [200 OK]>) to 10.0.41.177
2022-07-07 08:19:57.389320 (MainThread): 08:19:57  Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '2ba06b25-eed6-4dd7-9350-70cb423001b7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f778bdc5c10>]}
2022-07-07 08:19:57.390147 (MainThread): 08:19:57  Found 16 models, 0 tests, 0 snapshots, 0 analyses, 181 macros, 0 operations, 0 seed files, 15 sources, 0 exposures, 0 metrics
2022-07-07 08:19:57.391937 (Thread-1): 08:19:57  Acquiring new snowflake connection "rpc.ecommerce_data_model_dbt.request"
2022-07-07 08:19:57.392115 (Thread-1): 08:19:57  Began compiling node rpc.ecommerce_data_model_dbt.request
2022-07-07 08:19:57.392256 (Thread-1): 08:19:57  Compiling rpc.ecommerce_data_model_dbt.request
2022-07-07 08:19:57.396454 (Thread-1): 08:19:57  finished collecting timing info
2022-07-07 08:19:57.396634 (Thread-1): 08:19:57  Began executing node rpc.ecommerce_data_model_dbt.request
2022-07-07 08:19:57.401380 (Thread-1): 08:19:57  Using snowflake connection "rpc.ecommerce_data_model_dbt.request"
2022-07-07 08:19:57.401544 (Thread-1): 08:19:57  On rpc.ecommerce_data_model_dbt.request: select user_id, 
CASE WHEN dateadd(year, datediff (year, properties_birthday, min(getdate(), '2022-06-29')), properties_birthday) > min(getdate(), '2022-06-29')
      THEN datediff(year, properties_birthday, min(getdate(), '2022-06-29')) - 1
      ELSE datediff(year, properties_birthday, min(getdate(), '2022-06-29'))
 END
  as age 
from analytics_db.data_apps_simulated.identifies where timestamp >= '2021-05-01' and timestamp <= '2022-06-29'
and properties_birthday is not null and properties_birthday!=''
limit 500
/* limit added automatically by dbt cloud */
2022-07-07 08:19:57.401672 (Thread-1): 08:19:57  Opening a new connection, currently in state init
2022-07-07 08:19:57.765768 (Thread-135): handling poll request
2022-07-07 08:19:57.766240 (Thread-135): 08:19:57  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '196d9207-3e38-4101-ac43-bc898fbec1a7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f51ed0621c0>]}
2022-07-07 08:19:57.767496 (Thread-135): sending response (<Response 4296 bytes [200 OK]>) to 10.0.41.177
2022-07-07 08:19:58.022316 (Thread-1): 08:19:58  Snowflake adapter: Snowflake query id: 01a57173-0602-3441-0019-8203046b46ae
2022-07-07 08:19:58.022584 (Thread-1): 08:19:58  Snowflake adapter: Snowflake error: 000939 (22023): SQL compilation error: error line 2 at position 61
too many arguments for function [MIN(GETDATE(), '2022-06-29')] expected 1, got 2
2022-07-07 08:19:58.022846 (Thread-1): 08:19:58  finished collecting timing info
2022-07-07 08:19:58.023115 (Thread-1): 08:19:58  On rpc.ecommerce_data_model_dbt.request: Close
2022-07-07 08:19:58.074690 (Thread-1): Got an exception: Database Error
  000939 (22023): SQL compilation error: error line 2 at position 61
  too many arguments for function [MIN(GETDATE(), '2022-06-29')] expected 1, got 2
Traceback (most recent call last):
  File "/usr/local/lib/python3.8/dist-packages/dbt/adapters/snowflake/connections.py", line 206, in exception_handler
    yield
  File "/usr/local/lib/python3.8/dist-packages/dbt/adapters/sql/connections.py", line 74, in add_query
    cursor.execute(sql, bindings)
  File "/usr/local/lib/python3.8/dist-packages/snowflake/connector/cursor.py", line 721, in execute
    Error.errorhandler_wrapper(
  File "/usr/local/lib/python3.8/dist-packages/snowflake/connector/errors.py", line 258, in errorhandler_wrapper
    cursor.errorhandler(connection, cursor, error_class, error_value)
  File "/usr/local/lib/python3.8/dist-packages/snowflake/connector/errors.py", line 188, in default_errorhandler
    raise error_class(
snowflake.connector.errors.ProgrammingError: 000939 (22023): SQL compilation error: error line 2 at position 61
too many arguments for function [MIN(GETDATE(), '2022-06-29')] expected 1, got 2

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/usr/local/lib/python3.8/dist-packages/dbt/task/base.py", line 361, in safe_run
    result = self.compile_and_execute(manifest, ctx)
  File "/usr/local/lib/python3.8/dist-packages/dbt/task/base.py", line 314, in compile_and_execute
    result = self.run(ctx.node, manifest)
  File "/usr/local/lib/python3.8/dist-packages/dbt/task/base.py", line 403, in run
    return self.execute(compiled_node, manifest)
  File "/usr/local/lib/python3.8/dist-packages/dbt_rpc/rpc/node_runners.py", line 90, in execute
    _, execute_result = self.adapter.execute(
  File "/usr/local/lib/python3.8/dist-packages/dbt/adapters/base/impl.py", line 225, in execute
    return self.connections.execute(
  File "/usr/local/lib/python3.8/dist-packages/dbt/adapters/sql/connections.py", line 127, in execute
    _, cursor = self.add_query(sql, auto_begin)
  File "/usr/local/lib/python3.8/dist-packages/dbt/adapters/snowflake/connections.py", line 433, in add_query
    connection, cursor = super().add_query(
  File "/usr/local/lib/python3.8/dist-packages/dbt/adapters/sql/connections.py", line 83, in add_query
    return connection, cursor
  File "/usr/lib/python3.8/contextlib.py", line 131, in __exit__
    self.gen.throw(type, value, traceback)
  File "/usr/local/lib/python3.8/dist-packages/dbt/adapters/snowflake/connections.py", line 223, in exception_handler
    raise DatabaseException(msg)
dbt.exceptions.DatabaseException: Database Error
  000939 (22023): SQL compilation error: error line 2 at position 61
  too many arguments for function [MIN(GETDATE(), '2022-06-29')] expected 1, got 2
2022-07-07 08:19:58.075576 (Thread-1): Got exception RPCException(10003, Database Error, {'type': 'DatabaseException', 'message': "Database Error in rpc request (from remote system)\n  000939 (22023): SQL compilation error: error line 2 at position 61\n  too many arguments for function [MIN(GETDATE(), '2022-06-29')] expected 1, got 2", 'raw_sql': "select user_id, {{get_age_from_dob('properties_birthday')}} as age \r\nfrom {{ source('ecommerce', 'identifies') }} where timestamp >= '{{ var('start_date') }}' and timestamp <= '{{ var('end_date') }}'\r\nand properties_birthday is not null and properties_birthday!=''\nlimit 500\n/* limit added automatically by dbt cloud */", 'compiled_sql': "select user_id, \nCASE WHEN dateadd(year, datediff (year, properties_birthday, min(getdate(), '2022-06-29')), properties_birthday) > min(getdate(), '2022-06-29')\n      THEN datediff(year, properties_birthday, min(getdate(), '2022-06-29')) - 1\n      ELSE datediff(year, properties_birthday, min(getdate(), '2022-06-29'))\n END\n  as age \nfrom analytics_db.data_apps_simulated.identifies where timestamp >= '2021-05-01' and timestamp <= '2022-06-29'\nand properties_birthday is not null and properties_birthday!=''\nlimit 500\n/* limit added automatically by dbt cloud */", 'tags': None}, None)
Traceback (most recent call last):
  File "/usr/local/lib/python3.8/dist-packages/dbt_rpc/task/sql_commands.py", line 147, in _in_thread
    self.node_results.append(runner.safe_run(self.manifest))
  File "/usr/local/lib/python3.8/dist-packages/dbt/task/base.py", line 377, in safe_run
    result = self.error_result(ctx.node, error, started, [])
  File "/usr/local/lib/python3.8/dist-packages/dbt_rpc/rpc/node_runners.py", line 56, in error_result
    raise error
dbt_rpc.rpc.error.RPCException: RPCException(10003, Database Error, {'type': 'DatabaseException', 'message': "Database Error in rpc request (from remote system)\n  000939 (22023): SQL compilation error: error line 2 at position 61\n  too many arguments for function [MIN(GETDATE(), '2022-06-29')] expected 1, got 2", 'raw_sql': "select user_id, {{get_age_from_dob('properties_birthday')}} as age \r\nfrom {{ source('ecommerce', 'identifies') }} where timestamp >= '{{ var('start_date') }}' and timestamp <= '{{ var('end_date') }}'\r\nand properties_birthday is not null and properties_birthday!=''\nlimit 500\n/* limit added automatically by dbt cloud */", 'compiled_sql': "select user_id, \nCASE WHEN dateadd(year, datediff (year, properties_birthday, min(getdate(), '2022-06-29')), properties_birthday) > min(getdate(), '2022-06-29')\n      THEN datediff(year, properties_birthday, min(getdate(), '2022-06-29')) - 1\n      ELSE datediff(year, properties_birthday, min(getdate(), '2022-06-29'))\n END\n  as age \nfrom analytics_db.data_apps_simulated.identifies where timestamp >= '2021-05-01' and timestamp <= '2022-06-29'\nand properties_birthday is not null and properties_birthday!=''\nlimit 500\n/* limit added automatically by dbt cloud */", 'tags': None}, None)
2022-07-07 08:19:59.179646 (Thread-136): handling poll request
2022-07-07 08:19:59.180093 (Thread-136): 08:19:59  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '196d9207-3e38-4101-ac43-bc898fbec1a7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f51ed0625b0>]}
2022-07-07 08:19:59.180740 (Thread-136): sending response (<Response 13028 bytes [200 OK]>) to 10.0.41.177
2022-07-07 08:23:37.204004 (Thread-137): 08:23:37  Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
2022-07-07 08:23:37.205689 (Thread-137): 08:23:37  Partial parsing: updated file: ecommerce_data_model_dbt://macros/get_age_from_dob.sql
2022-07-07 08:23:37.205885 (Thread-137): 08:23:37  Parsing macros/get_age_from_dob.sql
2022-07-07 08:23:37.212812 (Thread-137): 08:23:37  1603: static parser failed on data_model/stg_traits/age.sql
2022-07-07 08:23:37.219159 (Thread-137): 08:23:37  1602: parser fallback to jinja rendering on data_model/stg_traits/age.sql
2022-07-07 08:23:37.255121 (Thread-137): 08:23:37  [WARNING]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.data-apps-ecommerce-template.data_model

2022-07-07 08:23:37.260169 (Thread-137): 08:23:37  Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '196d9207-3e38-4101-ac43-bc898fbec1a7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f51ecf2efa0>]}
2022-07-07 08:23:37.998797 (Thread-138): handling status request
2022-07-07 08:23:37.999277 (Thread-138): 08:23:37  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '196d9207-3e38-4101-ac43-bc898fbec1a7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f51ed0a29d0>]}
2022-07-07 08:23:37.999887 (Thread-138): sending response (<Response 2622 bytes [200 OK]>) to 10.0.41.177
2022-07-07 08:23:38.032563 (Thread-139): handling status request
2022-07-07 08:23:38.032985 (Thread-139): 08:23:38  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '196d9207-3e38-4101-ac43-bc898fbec1a7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f51ed044580>]}
2022-07-07 08:23:38.033525 (Thread-139): sending response (<Response 2622 bytes [200 OK]>) to 10.0.41.177
2022-07-07 08:23:44.796222 (Thread-140): handling status request
2022-07-07 08:23:44.796661 (Thread-140): 08:23:44  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '196d9207-3e38-4101-ac43-bc898fbec1a7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f51ed0a2af0>]}
2022-07-07 08:23:44.797167 (Thread-140): sending response (<Response 2622 bytes [200 OK]>) to 10.0.41.177
2022-07-07 08:23:45.198796 (Thread-141): handling run_sql request
2022-07-07 08:23:45.199215 (Thread-141): 08:23:45  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '196d9207-3e38-4101-ac43-bc898fbec1a7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f51ed044250>]}
2022-07-07 08:23:47.526144 (Thread-141): sending response (<Response 139 bytes [200 OK]>) to 10.0.41.177
2022-07-07 08:23:47.553858 (MainThread): 08:23:47  Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'b89266b0-9421-4ed9-8284-8f431c112470', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0957491df0>]}
2022-07-07 08:23:47.554382 (MainThread): 08:23:47  Found 16 models, 0 tests, 0 snapshots, 0 analyses, 181 macros, 0 operations, 0 seed files, 15 sources, 0 exposures, 0 metrics
2022-07-07 08:23:47.554964 (Thread-1): 08:23:47  Acquiring new snowflake connection "rpc.ecommerce_data_model_dbt.request"
2022-07-07 08:23:47.555109 (Thread-1): 08:23:47  Began compiling node rpc.ecommerce_data_model_dbt.request
2022-07-07 08:23:47.555209 (Thread-1): 08:23:47  Compiling rpc.ecommerce_data_model_dbt.request
2022-07-07 08:23:47.557954 (Thread-1): 08:23:47  finished collecting timing info
2022-07-07 08:23:47.558082 (Thread-1): 08:23:47  Began executing node rpc.ecommerce_data_model_dbt.request
2022-07-07 08:23:47.559192 (Thread-1): 08:23:47  Using snowflake connection "rpc.ecommerce_data_model_dbt.request"
2022-07-07 08:23:47.559284 (Thread-1): 08:23:47  On rpc.ecommerce_data_model_dbt.request: select user_id, 
CASE WHEN getdate() < '2022-06-29'
THEN
(CASE WHEN dateadd(year, datediff (year, properties_birthday, getdate()), properties_birthday) > getdate()
      THEN datediff(year, properties_birthday, getdate()) - 1
      ELSE datediff(year, properties_birthday, getdate())
 END)
 ELSE
(CASE WHEN dateadd(year, datediff (year, properties_birthday, '2022-06-29'), properties_birthday) > '2022-06-29'
      THEN datediff(year, properties_birthday, '2022-06-29') - 1
      ELSE datediff(year, properties_birthday, '2022-06-29')
 END)
  as age 
from analytics_db.data_apps_simulated.identifies where timestamp >= '2021-05-01' and timestamp <= '2022-06-29'
and properties_birthday is not null and properties_birthday!=''
limit 500
/* limit added automatically by dbt cloud */
2022-07-07 08:23:47.559363 (Thread-1): 08:23:47  Opening a new connection, currently in state init
2022-07-07 08:23:47.949559 (Thread-142): handling poll request
2022-07-07 08:23:47.950002 (Thread-142): 08:23:47  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '196d9207-3e38-4101-ac43-bc898fbec1a7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f51ecf9c220>]}
2022-07-07 08:23:47.950907 (Thread-142): sending response (<Response 4520 bytes [200 OK]>) to 10.0.41.177
2022-07-07 08:23:48.220127 (Thread-1): 08:23:48  Snowflake adapter: Snowflake query id: 01a57177-0602-3441-0019-8203046b46f6
2022-07-07 08:23:48.220315 (Thread-1): 08:23:48  Snowflake adapter: Snowflake error: 001003 (42000): SQL compilation error:
syntax error line 13 at position 2 unexpected 'as'.
2022-07-07 08:23:48.220478 (Thread-1): 08:23:48  finished collecting timing info
2022-07-07 08:23:48.220649 (Thread-1): 08:23:48  On rpc.ecommerce_data_model_dbt.request: Close
2022-07-07 08:23:48.302475 (Thread-1): Got an exception: Database Error
  001003 (42000): SQL compilation error:
  syntax error line 13 at position 2 unexpected 'as'.
Traceback (most recent call last):
  File "/usr/local/lib/python3.8/dist-packages/dbt/adapters/snowflake/connections.py", line 206, in exception_handler
    yield
  File "/usr/local/lib/python3.8/dist-packages/dbt/adapters/sql/connections.py", line 74, in add_query
    cursor.execute(sql, bindings)
  File "/usr/local/lib/python3.8/dist-packages/snowflake/connector/cursor.py", line 721, in execute
    Error.errorhandler_wrapper(
  File "/usr/local/lib/python3.8/dist-packages/snowflake/connector/errors.py", line 258, in errorhandler_wrapper
    cursor.errorhandler(connection, cursor, error_class, error_value)
  File "/usr/local/lib/python3.8/dist-packages/snowflake/connector/errors.py", line 188, in default_errorhandler
    raise error_class(
snowflake.connector.errors.ProgrammingError: 001003 (42000): SQL compilation error:
syntax error line 13 at position 2 unexpected 'as'.

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/usr/local/lib/python3.8/dist-packages/dbt/task/base.py", line 361, in safe_run
    result = self.compile_and_execute(manifest, ctx)
  File "/usr/local/lib/python3.8/dist-packages/dbt/task/base.py", line 314, in compile_and_execute
    result = self.run(ctx.node, manifest)
  File "/usr/local/lib/python3.8/dist-packages/dbt/task/base.py", line 403, in run
    return self.execute(compiled_node, manifest)
  File "/usr/local/lib/python3.8/dist-packages/dbt_rpc/rpc/node_runners.py", line 90, in execute
    _, execute_result = self.adapter.execute(
  File "/usr/local/lib/python3.8/dist-packages/dbt/adapters/base/impl.py", line 225, in execute
    return self.connections.execute(
  File "/usr/local/lib/python3.8/dist-packages/dbt/adapters/sql/connections.py", line 127, in execute
    _, cursor = self.add_query(sql, auto_begin)
  File "/usr/local/lib/python3.8/dist-packages/dbt/adapters/snowflake/connections.py", line 433, in add_query
    connection, cursor = super().add_query(
  File "/usr/local/lib/python3.8/dist-packages/dbt/adapters/sql/connections.py", line 83, in add_query
    return connection, cursor
  File "/usr/lib/python3.8/contextlib.py", line 131, in __exit__
    self.gen.throw(type, value, traceback)
  File "/usr/local/lib/python3.8/dist-packages/dbt/adapters/snowflake/connections.py", line 223, in exception_handler
    raise DatabaseException(msg)
dbt.exceptions.DatabaseException: Database Error
  001003 (42000): SQL compilation error:
  syntax error line 13 at position 2 unexpected 'as'.
2022-07-07 08:23:48.303428 (Thread-1): Got exception RPCException(10003, Database Error, {'type': 'DatabaseException', 'message': "Database Error in rpc request (from remote system)\n  001003 (42000): SQL compilation error:\n  syntax error line 13 at position 2 unexpected 'as'.", 'raw_sql': "select user_id, {{get_age_from_dob('properties_birthday')}} as age \r\nfrom {{ source('ecommerce', 'identifies') }} where timestamp >= '{{ var('start_date') }}' and timestamp <= '{{ var('end_date') }}'\r\nand properties_birthday is not null and properties_birthday!=''\nlimit 500\n/* limit added automatically by dbt cloud */", 'compiled_sql': "select user_id, \nCASE WHEN getdate() < '2022-06-29'\nTHEN\n(CASE WHEN dateadd(year, datediff (year, properties_birthday, getdate()), properties_birthday) > getdate()\n      THEN datediff(year, properties_birthday, getdate()) - 1\n      ELSE datediff(year, properties_birthday, getdate())\n END)\n ELSE\n(CASE WHEN dateadd(year, datediff (year, properties_birthday, '2022-06-29'), properties_birthday) > '2022-06-29'\n      THEN datediff(year, properties_birthday, '2022-06-29') - 1\n      ELSE datediff(year, properties_birthday, '2022-06-29')\n END)\n  as age \nfrom analytics_db.data_apps_simulated.identifies where timestamp >= '2021-05-01' and timestamp <= '2022-06-29'\nand properties_birthday is not null and properties_birthday!=''\nlimit 500\n/* limit added automatically by dbt cloud */", 'tags': None}, None)
Traceback (most recent call last):
  File "/usr/local/lib/python3.8/dist-packages/dbt_rpc/task/sql_commands.py", line 147, in _in_thread
    self.node_results.append(runner.safe_run(self.manifest))
  File "/usr/local/lib/python3.8/dist-packages/dbt/task/base.py", line 377, in safe_run
    result = self.error_result(ctx.node, error, started, [])
  File "/usr/local/lib/python3.8/dist-packages/dbt_rpc/rpc/node_runners.py", line 56, in error_result
    raise error
dbt_rpc.rpc.error.RPCException: RPCException(10003, Database Error, {'type': 'DatabaseException', 'message': "Database Error in rpc request (from remote system)\n  001003 (42000): SQL compilation error:\n  syntax error line 13 at position 2 unexpected 'as'.", 'raw_sql': "select user_id, {{get_age_from_dob('properties_birthday')}} as age \r\nfrom {{ source('ecommerce', 'identifies') }} where timestamp >= '{{ var('start_date') }}' and timestamp <= '{{ var('end_date') }}'\r\nand properties_birthday is not null and properties_birthday!=''\nlimit 500\n/* limit added automatically by dbt cloud */", 'compiled_sql': "select user_id, \nCASE WHEN getdate() < '2022-06-29'\nTHEN\n(CASE WHEN dateadd(year, datediff (year, properties_birthday, getdate()), properties_birthday) > getdate()\n      THEN datediff(year, properties_birthday, getdate()) - 1\n      ELSE datediff(year, properties_birthday, getdate())\n END)\n ELSE\n(CASE WHEN dateadd(year, datediff (year, properties_birthday, '2022-06-29'), properties_birthday) > '2022-06-29'\n      THEN datediff(year, properties_birthday, '2022-06-29') - 1\n      ELSE datediff(year, properties_birthday, '2022-06-29')\n END)\n  as age \nfrom analytics_db.data_apps_simulated.identifies where timestamp >= '2021-05-01' and timestamp <= '2022-06-29'\nand properties_birthday is not null and properties_birthday!=''\nlimit 500\n/* limit added automatically by dbt cloud */", 'tags': None}, None)
2022-07-07 08:23:49.352809 (Thread-143): handling poll request
2022-07-07 08:23:49.353224 (Thread-143): 08:23:49  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '196d9207-3e38-4101-ac43-bc898fbec1a7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f51ecf64d30>]}
2022-07-07 08:23:49.353880 (Thread-143): sending response (<Response 13539 bytes [200 OK]>) to 10.0.41.177
2022-07-07 08:23:57.695031 (Thread-144): handling status request
2022-07-07 08:23:57.695429 (Thread-144): 08:23:57  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '196d9207-3e38-4101-ac43-bc898fbec1a7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f51ecf64fa0>]}
2022-07-07 08:23:57.696050 (Thread-144): sending response (<Response 2622 bytes [200 OK]>) to 10.0.41.177
2022-07-07 08:23:58.167679 (Thread-145): handling compile_sql request
2022-07-07 08:23:58.168129 (Thread-145): 08:23:58  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '196d9207-3e38-4101-ac43-bc898fbec1a7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f51ecf64ee0>]}
2022-07-07 08:24:00.570530 (Thread-145): sending response (<Response 139 bytes [200 OK]>) to 10.0.41.177
2022-07-07 08:24:00.598657 (MainThread): 08:24:00  Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '4dfe736f-4bab-491e-8ee1-dc0683c4a570', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc1e1f85c40>]}
2022-07-07 08:24:00.599221 (MainThread): 08:24:00  Found 16 models, 0 tests, 0 snapshots, 0 analyses, 181 macros, 0 operations, 0 seed files, 15 sources, 0 exposures, 0 metrics
2022-07-07 08:24:00.599854 (Thread-1): 08:24:00  Acquiring new snowflake connection "rpc.ecommerce_data_model_dbt.request"
2022-07-07 08:24:00.600097 (Thread-1): 08:24:00  Began compiling node rpc.ecommerce_data_model_dbt.request
2022-07-07 08:24:00.600231 (Thread-1): 08:24:00  Compiling rpc.ecommerce_data_model_dbt.request
2022-07-07 08:24:00.603185 (Thread-1): 08:24:00  finished collecting timing info
2022-07-07 08:24:00.603334 (Thread-1): 08:24:00  Began executing node rpc.ecommerce_data_model_dbt.request
2022-07-07 08:24:00.603436 (Thread-1): 08:24:00  finished collecting timing info
2022-07-07 08:24:00.981084 (Thread-146): handling poll request
2022-07-07 08:24:00.981555 (Thread-146): 08:24:00  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '196d9207-3e38-4101-ac43-bc898fbec1a7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f51ecf291f0>]}
2022-07-07 08:24:00.982777 (Thread-146): sending response (<Response 7324 bytes [200 OK]>) to 10.0.41.177
2022-07-07 08:24:35.340442 (Thread-147): 08:24:35  Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
2022-07-07 08:24:35.340987 (Thread-147): 08:24:35  Partial parsing: updated file: ecommerce_data_model_dbt://macros/get_age_from_dob.sql
2022-07-07 08:24:35.341170 (Thread-147): 08:24:35  Parsing macros/get_age_from_dob.sql
2022-07-07 08:24:35.347837 (Thread-147): 08:24:35  1603: static parser failed on data_model/stg_traits/age.sql
2022-07-07 08:24:35.354165 (Thread-147): 08:24:35  1602: parser fallback to jinja rendering on data_model/stg_traits/age.sql
2022-07-07 08:24:35.388805 (Thread-147): 08:24:35  [WARNING]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.data-apps-ecommerce-template.data_model

2022-07-07 08:24:35.393788 (Thread-147): 08:24:35  Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '196d9207-3e38-4101-ac43-bc898fbec1a7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f51ece662b0>]}
2022-07-07 08:24:36.195580 (Thread-148): handling status request
2022-07-07 08:24:36.196022 (Thread-148): 08:24:36  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '196d9207-3e38-4101-ac43-bc898fbec1a7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f51ece3f2e0>]}
2022-07-07 08:24:36.196565 (Thread-148): sending response (<Response 2622 bytes [200 OK]>) to 10.0.41.177
2022-07-07 08:24:36.221747 (Thread-149): handling status request
2022-07-07 08:24:36.222051 (Thread-149): 08:24:36  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '196d9207-3e38-4101-ac43-bc898fbec1a7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f51ece3f160>]}
2022-07-07 08:24:36.222518 (Thread-149): sending response (<Response 2622 bytes [200 OK]>) to 10.0.41.177
2022-07-07 08:24:38.413042 (Thread-150): handling status request
2022-07-07 08:24:38.413443 (Thread-150): 08:24:38  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '196d9207-3e38-4101-ac43-bc898fbec1a7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f51ecef6580>]}
2022-07-07 08:24:38.413945 (Thread-150): sending response (<Response 2622 bytes [200 OK]>) to 10.0.41.177
2022-07-07 08:24:38.825822 (Thread-151): handling run_sql request
2022-07-07 08:24:38.826224 (Thread-151): 08:24:38  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '196d9207-3e38-4101-ac43-bc898fbec1a7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f51ecee0f40>]}
2022-07-07 08:24:41.181176 (Thread-151): sending response (<Response 139 bytes [200 OK]>) to 10.0.41.177
2022-07-07 08:24:41.209118 (MainThread): 08:24:41  Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '36b4ece5-4cb8-4b9a-ae18-ebdb968f7fd1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4de4e50dc0>]}
2022-07-07 08:24:41.209697 (MainThread): 08:24:41  Found 16 models, 0 tests, 0 snapshots, 0 analyses, 181 macros, 0 operations, 0 seed files, 15 sources, 0 exposures, 0 metrics
2022-07-07 08:24:41.210307 (Thread-1): 08:24:41  Acquiring new snowflake connection "rpc.ecommerce_data_model_dbt.request"
2022-07-07 08:24:41.210461 (Thread-1): 08:24:41  Began compiling node rpc.ecommerce_data_model_dbt.request
2022-07-07 08:24:41.210602 (Thread-1): 08:24:41  Compiling rpc.ecommerce_data_model_dbt.request
2022-07-07 08:24:41.213483 (Thread-1): 08:24:41  finished collecting timing info
2022-07-07 08:24:41.213621 (Thread-1): 08:24:41  Began executing node rpc.ecommerce_data_model_dbt.request
2022-07-07 08:24:41.214769 (Thread-1): 08:24:41  Using snowflake connection "rpc.ecommerce_data_model_dbt.request"
2022-07-07 08:24:41.214861 (Thread-1): 08:24:41  On rpc.ecommerce_data_model_dbt.request: select user_id, 
CASE WHEN getdate() < '2022-06-29'
THEN
(CASE WHEN dateadd(year, datediff (year, properties_birthday, getdate()), properties_birthday) > getdate()
      THEN datediff(year, properties_birthday, getdate()) - 1
      ELSE datediff(year, properties_birthday, getdate())
 END)
 ELSE
(CASE WHEN dateadd(year, datediff (year, properties_birthday, '2022-06-29'), properties_birthday) > '2022-06-29'
      THEN datediff(year, properties_birthday, '2022-06-29') - 1
      ELSE datediff(year, properties_birthday, '2022-06-29')
 END)
 END
  as age 
from analytics_db.data_apps_simulated.identifies where timestamp >= '2021-05-01' and timestamp <= '2022-06-29'
and properties_birthday is not null and properties_birthday!=''
limit 500
/* limit added automatically by dbt cloud */
2022-07-07 08:24:41.214960 (Thread-1): 08:24:41  Opening a new connection, currently in state init
2022-07-07 08:24:41.599997 (Thread-152): handling poll request
2022-07-07 08:24:41.600441 (Thread-152): 08:24:41  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '196d9207-3e38-4101-ac43-bc898fbec1a7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f51ece3e5b0>]}
2022-07-07 08:24:41.601350 (Thread-152): sending response (<Response 4525 bytes [200 OK]>) to 10.0.41.177
2022-07-07 08:24:42.396423 (Thread-1): 08:24:42  SQL status: SUCCESS 3 in 1.18 seconds
2022-07-07 08:24:42.397859 (Thread-1): 08:24:42  finished collecting timing info
2022-07-07 08:24:42.398039 (Thread-1): 08:24:42  On rpc.ecommerce_data_model_dbt.request: Close
2022-07-07 08:24:43.022904 (Thread-153): handling poll request
2022-07-07 08:24:43.023305 (Thread-153): 08:24:43  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '196d9207-3e38-4101-ac43-bc898fbec1a7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f51ece3eb50>]}
2022-07-07 08:24:43.024281 (Thread-153): sending response (<Response 5562 bytes [200 OK]>) to 10.0.41.177
2022-07-07 08:24:50.979524 (Thread-154): 08:24:50  Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
2022-07-07 08:24:50.979816 (Thread-154): 08:24:50  Partial parsing enabled, no changes found, skipping parsing
2022-07-07 08:24:50.980553 (Thread-154): 08:24:50  [WARNING]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.data-apps-ecommerce-template.data_model

2022-07-07 08:24:50.986553 (Thread-154): 08:24:50  Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '196d9207-3e38-4101-ac43-bc898fbec1a7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f51ecdfa9a0>]}
2022-07-07 08:24:51.778643 (Thread-155): handling status request
2022-07-07 08:24:51.779069 (Thread-155): 08:24:51  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '196d9207-3e38-4101-ac43-bc898fbec1a7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f51ece242e0>]}
2022-07-07 08:24:51.779573 (Thread-155): sending response (<Response 1703 bytes [200 OK]>) to 10.0.41.177
2022-07-07 08:24:51.800180 (Thread-156): handling status request
2022-07-07 08:24:51.800530 (Thread-156): 08:24:51  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '196d9207-3e38-4101-ac43-bc898fbec1a7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f51ece24190>]}
2022-07-07 08:24:51.825831 (Thread-156): sending response (<Response 1703 bytes [200 OK]>) to 10.0.41.177
2022-07-07 08:27:05.643366 (Thread-157): handling status request
2022-07-07 08:27:05.644793 (Thread-157): 08:27:05  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '196d9207-3e38-4101-ac43-bc898fbec1a7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f51ed1120d0>]}
2022-07-07 08:27:05.645321 (Thread-157): sending response (<Response 1680 bytes [200 OK]>) to 10.0.41.177
2022-07-07 08:27:05.656626 (Thread-158): handling status request
2022-07-07 08:27:05.656906 (Thread-158): 08:27:05  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '196d9207-3e38-4101-ac43-bc898fbec1a7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f51ecfa9400>]}
2022-07-07 08:27:05.657312 (Thread-158): sending response (<Response 1680 bytes [200 OK]>) to 10.0.41.177
2022-07-07 08:27:05.663797 (Thread-159): handling list request
2022-07-07 08:27:05.664066 (Thread-159): 08:27:05  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '196d9207-3e38-4101-ac43-bc898fbec1a7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f51ecd77be0>]}
2022-07-07 08:27:05.731746 (Thread-160): sending response (<Response 214 bytes [200 OK]>) to 10.0.41.177
2022-07-07 08:27:07.087662 (Thread-161): handling status request
2022-07-07 08:27:07.088057 (Thread-161): 08:27:07  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '196d9207-3e38-4101-ac43-bc898fbec1a7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f51ece244c0>]}
2022-07-07 08:27:07.088537 (Thread-161): sending response (<Response 1680 bytes [200 OK]>) to 10.0.41.177
2022-07-07 08:27:07.100661 (Thread-162): handling list request
2022-07-07 08:27:07.100964 (Thread-162): 08:27:07  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '196d9207-3e38-4101-ac43-bc898fbec1a7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f51ece242b0>]}
2022-07-07 08:27:07.132127 (Thread-162): 08:27:07  Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '196d9207-3e38-4101-ac43-bc898fbec1a7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f51ecdfa910>]}
2022-07-07 08:27:07.132406 (Thread-162): 08:27:07  Found 16 models, 0 tests, 0 snapshots, 0 analyses, 181 macros, 0 operations, 0 seed files, 15 sources, 0 exposures, 0 metrics
2022-07-07 08:27:07.134976 (Thread-162): sending response (<Response 2627 bytes [200 OK]>) to 10.0.41.177
2022-07-07 08:27:11.703637 (Thread-163): handling status request
2022-07-07 08:27:11.704052 (Thread-163): 08:27:11  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '196d9207-3e38-4101-ac43-bc898fbec1a7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f51ecd906a0>]}
2022-07-07 08:27:11.704538 (Thread-163): sending response (<Response 1680 bytes [200 OK]>) to 10.0.41.177
2022-07-07 08:27:11.712135 (Thread-164): handling list request
2022-07-07 08:27:11.712402 (Thread-164): 08:27:11  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '196d9207-3e38-4101-ac43-bc898fbec1a7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f51ecd90760>]}
2022-07-07 08:27:11.766425 (Thread-164): 08:27:11  Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '196d9207-3e38-4101-ac43-bc898fbec1a7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f51ece242b0>]}
2022-07-07 08:27:11.766704 (Thread-164): 08:27:11  Found 16 models, 0 tests, 0 snapshots, 0 analyses, 181 macros, 0 operations, 0 seed files, 15 sources, 0 exposures, 0 metrics
2022-07-07 08:27:11.770268 (Thread-164): sending response (<Response 2079 bytes [200 OK]>) to 10.0.41.177
2022-07-07 08:27:13.544389 (Thread-165): handling status request
2022-07-07 08:27:13.544786 (Thread-165): 08:27:13  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '196d9207-3e38-4101-ac43-bc898fbec1a7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f51ecd999a0>]}
2022-07-07 08:27:13.545299 (Thread-165): sending response (<Response 1680 bytes [200 OK]>) to 10.0.41.177
2022-07-07 08:27:13.561564 (Thread-166): handling list request
2022-07-07 08:27:13.561821 (Thread-166): 08:27:13  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '196d9207-3e38-4101-ac43-bc898fbec1a7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f51ecd99d30>]}
2022-07-07 08:27:13.592987 (Thread-166): 08:27:13  Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '196d9207-3e38-4101-ac43-bc898fbec1a7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f51ecd77ee0>]}
2022-07-07 08:27:13.593252 (Thread-166): 08:27:13  Found 16 models, 0 tests, 0 snapshots, 0 analyses, 181 macros, 0 operations, 0 seed files, 15 sources, 0 exposures, 0 metrics
2022-07-07 08:27:13.596329 (Thread-166): sending response (<Response 2086 bytes [200 OK]>) to 10.0.41.177
2022-07-07 08:27:14.663226 (Thread-167): handling status request
2022-07-07 08:27:14.663680 (Thread-167): 08:27:14  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '196d9207-3e38-4101-ac43-bc898fbec1a7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f51ecd90460>]}
2022-07-07 08:27:14.664157 (Thread-167): sending response (<Response 1680 bytes [200 OK]>) to 10.0.41.177
2022-07-07 08:27:14.671947 (Thread-168): handling list request
2022-07-07 08:27:14.672213 (Thread-168): 08:27:14  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '196d9207-3e38-4101-ac43-bc898fbec1a7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f51ecd99160>]}
2022-07-07 08:27:14.702460 (Thread-168): 08:27:14  Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '196d9207-3e38-4101-ac43-bc898fbec1a7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f51ecda6df0>]}
2022-07-07 08:27:14.702765 (Thread-168): 08:27:14  Found 16 models, 0 tests, 0 snapshots, 0 analyses, 181 macros, 0 operations, 0 seed files, 15 sources, 0 exposures, 0 metrics
2022-07-07 08:27:14.704653 (Thread-168): 08:27:14  The selection criterion '+models/data_model/stg_traits/device_type.sql+' does not match any nodes
2022-07-07 08:27:14.704807 (Thread-168): 08:27:14  No nodes selected!
2022-07-07 08:27:14.706121 (Thread-168): sending response (<Response 1963 bytes [200 OK]>) to 10.0.41.177
2022-07-07 08:27:37.480867 (Thread-169): handling status request
2022-07-07 08:27:37.481244 (Thread-169): 08:27:37  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '196d9207-3e38-4101-ac43-bc898fbec1a7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f51ec534b20>]}
2022-07-07 08:27:37.481724 (Thread-169): sending response (<Response 1703 bytes [200 OK]>) to 10.0.41.177
2022-07-07 08:27:37.893985 (Thread-170): handling run_sql request
2022-07-07 08:27:37.894360 (Thread-170): 08:27:37  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '196d9207-3e38-4101-ac43-bc898fbec1a7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f51ec5346d0>]}
2022-07-07 08:27:40.269968 (Thread-170): sending response (<Response 139 bytes [200 OK]>) to 10.0.41.177
2022-07-07 08:27:40.306757 (MainThread): 08:27:40  Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '29901d60-0b72-49c3-96f6-7d2817495cd2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f21649dc0a0>]}
2022-07-07 08:27:40.307363 (MainThread): 08:27:40  Found 16 models, 0 tests, 0 snapshots, 0 analyses, 181 macros, 0 operations, 0 seed files, 15 sources, 0 exposures, 0 metrics
2022-07-07 08:27:40.308042 (Thread-1): 08:27:40  Acquiring new snowflake connection "rpc.ecommerce_data_model_dbt.request"
2022-07-07 08:27:40.308198 (Thread-1): 08:27:40  Began compiling node rpc.ecommerce_data_model_dbt.request
2022-07-07 08:27:40.308302 (Thread-1): 08:27:40  Compiling rpc.ecommerce_data_model_dbt.request
2022-07-07 08:27:40.318374 (Thread-1): 08:27:40  finished collecting timing info
2022-07-07 08:27:40.318558 (Thread-1): 08:27:40  Began executing node rpc.ecommerce_data_model_dbt.request
2022-07-07 08:27:40.324085 (Thread-1): 08:27:40  Using snowflake connection "rpc.ecommerce_data_model_dbt.request"
2022-07-07 08:27:40.324195 (Thread-1): 08:27:40  On rpc.ecommerce_data_model_dbt.request: with cte_gender as 
(select user_id, gender from 
(select user_id, properties_gender as gender, row_number() over(partition by user_id order by timestamp desc) as rn from 
analytics_db.data_apps_simulated.identifies where timestamp >= '2021-05-01' and timestamp <= '2022-06-29'
and properties_gender is not null and properties_gender != '') where rn = 1),

cte_age as 
(select user_id, age from
(select user_id, 
(CASE WHEN dateadd(year, datediff (year, properties_birthday, getdate()), properties_birthday) > getdate()
      THEN datediff(year, properties_birthday, getdate()) - 1
      ELSE datediff(year, properties_birthday, getdate())
 END) as age, row_number() over(partition by user_id order by timestamp desc) as rn 
from analytics_db.data_apps_simulated.identifies where timestamp >= '2021-05-01' and timestamp <= '2022-06-29'
and properties_birthday is not null and properties_birthday!='') where rn = 1),

cte_country as 
(select user_id, country from 
(select user_id, properties_country as country, row_number() over(partition by user_id order by timestamp desc) as rn from 
analytics_db.data_apps_simulated.identifies where timestamp >= '2021-05-01' and timestamp <= '2022-06-29'
and properties_country is not null and properties_country != '') where rn = 1),

cte_state as 
(select user_id, state from 
(select user_id, properties_state as state, row_number() over(partition by user_id order by timestamp desc) as rn from 
analytics_db.data_apps_simulated.identifies where timestamp >= '2021-05-01' and timestamp <= '2022-06-29'
and properties_state is not null and properties_state != '') where rn = 1),

cte_email_domain as 
(select user_id, email_domain from 
(select user_id, substring(properties_email, charindex( '@', properties_email) + 1, len(properties_email)) as email_domain, row_number() over(partition by user_id order by timestamp desc) as rn from 
analytics_db.data_apps_simulated.identifies where timestamp >= '2021-05-01' and timestamp <= '2022-06-29'
and properties_email is not null and properties_email != '') where rn = 1),

cte_is_member as 
(select user_id, is_member from
(select user_id, 
(CASE WHEN properties_is_member = TRUE
      THEN TRUE
      ELSE FALSE
END) as is_member, row_number() over(partition by user_id order by timestamp desc) as rn from 
analytics_db.data_apps_simulated.identifies where timestamp >= '2021-05-01' and timestamp <= '2022-06-29'
and user_id is not null) where rn = 1),

cte_has_mobile_app as 
(select user_id, has_mobile_app from 
(select user_id, 
(CASE WHEN user_id IN(select user_id from analytics_db.data_apps_simulated.identifies where context_device_type  = 'android' or context_device_type = 'iOS')
      THEN TRUE
      ELSE FALSE
      END) as has_mobile_app, row_number() over(partition by user_id order by timestamp desc) as rn from 
analytics_db.data_apps_simulated.identifies where timestamp >= '2021-05-01' and timestamp <= '2022-06-29'
and context_device_type is not null and context_device_type != '' and user_id is not null) where rn = 1),

cte_is_active_on_website as 
(select user_id, is_active_on_website from 
(select user_id, 
(CASE WHEN user_id IN(select user_id from analytics_db.data_apps_simulated.identifies where context_device_type like '%PC')
      THEN TRUE
      ELSE FALSE
      END)
as is_active_on_website, row_number() over(partition by user_id order by timestamp desc) as rn from 
analytics_db.data_apps_simulated.identifies where timestamp >= '2021-05-01' and timestamp <= '2022-06-29'
and context_device_type is not null and context_device_type != '' and user_id is not null) where rn = 1),

cte_device_type as 
(select user_id, device_type from 
(select user_id, context_device_type as device_type, row_number() over(partition by user_id order by timestamp desc) as rn from 
analytics_db.data_apps_simulated.identifies where timestamp >= '2021-05-01' and timestamp <= '2022-06-29'
and device_type is not null and device_type != '') where rn = 1)

select coalesce(a.user_id, b.user_id, c.user_id, d.user_id, e.user_id, f.user_id, g.user_id, h.user_id, i.user_id) 
as user_id, gender, age, country, state, email_domain, is_member, has_mobile_app, is_active_on_website, device_type
from (((((((cte_gender a full outer join cte_age b on a.user_id = b.user_id) 
full outer join cte_country c on c.user_id = coalesce(a.user_id, b.user_id))
full outer join cte_state d on d.user_id = coalesce(a.user_id, b.user_id, c.user_id))
full outer join cte_email_domain e on e.user_id = coalesce(a.user_id, b.user_id, c.user_id,d.user_id))
full outer join cte_is_member f on f.user_id = coalesce(a.user_id, b.user_id, c.user_id,d.user_id, e.user_id))
full outer join cte_has_mobile_app g on g.user_id = coalesce(a.user_id, b.user_id, c.user_id,d.user_id, e.user_id, f.user_id))
full outer join cte_is_active_on_website as h on h.user_id = coalesce(a.user_id, b.user_id, c.user_id,d.user_id, e.user_id, f.user_id, g.user_id))
full outer join cte_device_type as i on i.user_id = coalesce(a.user_id, b.user_id, c.user_id,d.user_id, e.user_id, f.user_id, g.user_id, h.user_id)
limit 500
/* limit added automatically by dbt cloud */
2022-07-07 08:27:40.324280 (Thread-1): 08:27:40  Opening a new connection, currently in state init
2022-07-07 08:27:40.686020 (Thread-171): handling poll request
2022-07-07 08:27:40.686510 (Thread-171): 08:27:40  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '196d9207-3e38-4101-ac43-bc898fbec1a7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f51ecd8fb20>]}
2022-07-07 08:27:40.687434 (Thread-171): sending response (<Response 8930 bytes [200 OK]>) to 10.0.41.177
2022-07-07 08:27:42.088310 (Thread-172): handling poll request
2022-07-07 08:27:42.088706 (Thread-172): 08:27:42  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '196d9207-3e38-4101-ac43-bc898fbec1a7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f51ecd8fd00>]}
2022-07-07 08:27:42.089188 (Thread-172): sending response (<Response 398 bytes [200 OK]>) to 10.0.41.177
2022-07-07 08:27:42.765466 (Thread-1): 08:27:42  SQL status: SUCCESS 6 in 2.44 seconds
2022-07-07 08:27:42.768022 (Thread-1): 08:27:42  finished collecting timing info
2022-07-07 08:27:42.768283 (Thread-1): 08:27:42  On rpc.ecommerce_data_model_dbt.request: Close
2022-07-07 08:27:43.488194 (Thread-173): handling poll request
2022-07-07 08:27:43.488591 (Thread-173): 08:27:43  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '196d9207-3e38-4101-ac43-bc898fbec1a7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f51ec547430>]}
2022-07-07 08:27:43.489599 (Thread-173): sending response (<Response 25847 bytes [200 OK]>) to 10.0.41.177
2022-07-07 08:28:01.017554 (Thread-174): 08:28:01  Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
2022-07-07 08:28:01.018068 (Thread-174): 08:28:01  Partial parsing: updated file: ecommerce_data_model_dbt://models/data_model/stg_user_traits.sql
2022-07-07 08:28:01.022460 (Thread-174): 08:28:01  1603: static parser failed on data_model/stg_user_traits.sql
2022-07-07 08:28:01.032231 (Thread-174): 08:28:01  1602: parser fallback to jinja rendering on data_model/stg_user_traits.sql
2022-07-07 08:28:01.081475 (Thread-174): 08:28:01  [WARNING]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.data-apps-ecommerce-template.data_model

2022-07-07 08:28:01.086325 (Thread-174): 08:28:01  Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '196d9207-3e38-4101-ac43-bc898fbec1a7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f51ec45b8e0>]}
2022-07-07 08:28:01.812669 (Thread-175): handling status request
2022-07-07 08:28:01.813040 (Thread-175): 08:28:01  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '196d9207-3e38-4101-ac43-bc898fbec1a7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f51ec494d60>]}
2022-07-07 08:28:01.813546 (Thread-175): sending response (<Response 2357 bytes [200 OK]>) to 10.0.41.177
2022-07-07 08:28:01.832501 (Thread-176): handling status request
2022-07-07 08:28:01.832814 (Thread-176): 08:28:01  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '196d9207-3e38-4101-ac43-bc898fbec1a7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f51ec547c10>]}
2022-07-07 08:28:01.833243 (Thread-176): sending response (<Response 2357 bytes [200 OK]>) to 10.0.41.177
2022-07-07 08:28:03.274423 (Thread-177): handling status request
2022-07-07 08:28:03.274801 (Thread-177): 08:28:03  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '196d9207-3e38-4101-ac43-bc898fbec1a7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f51ec547640>]}
2022-07-07 08:28:03.275287 (Thread-177): sending response (<Response 2357 bytes [200 OK]>) to 10.0.41.177
2022-07-07 08:28:03.697243 (Thread-178): handling run_sql request
2022-07-07 08:28:03.697654 (Thread-178): 08:28:03  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '196d9207-3e38-4101-ac43-bc898fbec1a7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f51ec4a3790>]}
2022-07-07 08:28:06.008964 (Thread-178): sending response (<Response 139 bytes [200 OK]>) to 10.0.41.177
2022-07-07 08:28:06.045349 (MainThread): 08:28:06  Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '02a518d4-afe5-4b66-b797-b30d531bfd7b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f481df049d0>]}
2022-07-07 08:28:06.045886 (MainThread): 08:28:06  Found 16 models, 0 tests, 0 snapshots, 0 analyses, 181 macros, 0 operations, 0 seed files, 15 sources, 0 exposures, 0 metrics
2022-07-07 08:28:06.046495 (Thread-1): 08:28:06  Acquiring new snowflake connection "rpc.ecommerce_data_model_dbt.request"
2022-07-07 08:28:06.046634 (Thread-1): 08:28:06  Began compiling node rpc.ecommerce_data_model_dbt.request
2022-07-07 08:28:06.046733 (Thread-1): 08:28:06  Compiling rpc.ecommerce_data_model_dbt.request
2022-07-07 08:28:06.055322 (Thread-1): 08:28:06  finished collecting timing info
2022-07-07 08:28:06.055457 (Thread-1): 08:28:06  Began executing node rpc.ecommerce_data_model_dbt.request
2022-07-07 08:28:06.060843 (Thread-1): 08:28:06  Using snowflake connection "rpc.ecommerce_data_model_dbt.request"
2022-07-07 08:28:06.060943 (Thread-1): 08:28:06  On rpc.ecommerce_data_model_dbt.request: with cte_gender as 
(select user_id, gender from 
(select user_id, properties_gender as gender, row_number() over(partition by user_id order by timestamp desc) as rn from 
analytics_db.data_apps_simulated.identifies where timestamp >= '2021-05-01' and timestamp <= '2022-06-29'
and properties_gender is not null and properties_gender != '') where rn = 1),

cte_age as 
(select user_id, age from
(select user_id, 
(CASE WHEN dateadd(year, datediff (year, properties_birthday, getdate()), properties_birthday) > getdate()
      THEN datediff(year, properties_birthday, getdate()) - 1
      ELSE datediff(year, properties_birthday, getdate())
 END) as age, row_number() over(partition by user_id order by timestamp desc) as rn 
from analytics_db.data_apps_simulated.identifies where timestamp >= '2021-05-01' and timestamp <= '2022-06-29'
and properties_birthday is not null and properties_birthday!='') where rn = 1),

cte_country as 
(select user_id, country from 
(select user_id, properties_country as country, row_number() over(partition by user_id order by timestamp desc) as rn from 
analytics_db.data_apps_simulated.identifies where timestamp >= '2021-05-01' and timestamp <= '2022-06-29'
and properties_country is not null and properties_country != '') where rn = 1),

cte_state as 
(select user_id, state from 
(select user_id, properties_state as state, row_number() over(partition by user_id order by timestamp desc) as rn from 
analytics_db.data_apps_simulated.identifies where timestamp >= '2021-05-01' and timestamp <= '2022-06-29'
and properties_state is not null and properties_state != '') where rn = 1),

cte_email_domain as 
(select user_id, email_domain from 
(select user_id, substring(properties_email, charindex( '@', properties_email) + 1, len(properties_email)) as email_domain, row_number() over(partition by user_id order by timestamp desc) as rn from 
analytics_db.data_apps_simulated.identifies where timestamp >= '2021-05-01' and timestamp <= '2022-06-29'
and properties_email is not null and properties_email != '') where rn = 1),

cte_is_member as 
(select user_id, is_member from
(select user_id, 
(CASE WHEN properties_is_member = TRUE
      THEN TRUE
      ELSE FALSE
END) as is_member, row_number() over(partition by user_id order by timestamp desc) as rn from 
analytics_db.data_apps_simulated.identifies where timestamp >= '2021-05-01' and timestamp <= '2022-06-29'
and user_id is not null) where rn = 1),

cte_has_mobile_app as 
(select user_id, has_mobile_app from 
(select user_id, 
(CASE WHEN user_id IN(select user_id from analytics_db.data_apps_simulated.identifies where context_device_type  = 'android' or context_device_type = 'iOS')
      THEN TRUE
      ELSE FALSE
      END) as has_mobile_app, row_number() over(partition by user_id order by timestamp desc) as rn from 
analytics_db.data_apps_simulated.identifies where timestamp >= '2021-05-01' and timestamp <= '2022-06-29'
and context_device_type is not null and context_device_type != '' and user_id is not null) where rn = 1),

cte_is_active_on_website as 
(select user_id, is_active_on_website from 
(select user_id, 
(CASE WHEN user_id IN(select user_id from analytics_db.data_apps_simulated.identifies where context_device_type like '%PC')
      THEN TRUE
      ELSE FALSE
      END)
as is_active_on_website, row_number() over(partition by user_id order by timestamp desc) as rn from 
analytics_db.data_apps_simulated.identifies where timestamp >= '2021-05-01' and timestamp <= '2022-06-29'
and context_device_type is not null and context_device_type != '' and user_id is not null) where rn = 1),

cte_device_type as 
(select user_id, device_type from 
(select user_id, context_device_type as device_type, row_number() over(partition by user_id order by timestamp desc) as rn from 
analytics_db.data_apps_simulated.identifies where timestamp >= '2021-05-01' and timestamp <= '2022-06-29'
and device_type is not null and device_type != '') where rn = 1)

select coalesce(a.user_id, b.user_id, c.user_id, d.user_id, e.user_id, f.user_id, g.user_id, h.user_id, i.user_id) 
as user_id, gender, age, country, state, email_domain, is_member, has_mobile_app, is_active_on_website, device_type
from (((((((cte_gender a full outer join cte_age b on a.user_id = b.user_id) 
full outer join cte_country c on c.user_id = coalesce(a.user_id, b.user_id))
full outer join cte_state d on d.user_id = coalesce(a.user_id, b.user_id, c.user_id))
full outer join cte_email_domain e on e.user_id = coalesce(a.user_id, b.user_id, c.user_id,d.user_id))
full outer join cte_is_member f on f.user_id = coalesce(a.user_id, b.user_id, c.user_id,d.user_id, e.user_id))
full outer join cte_has_mobile_app g on g.user_id = coalesce(a.user_id, b.user_id, c.user_id,d.user_id, e.user_id, f.user_id))
full outer join cte_is_active_on_website as h on h.user_id = coalesce(a.user_id, b.user_id, c.user_id,d.user_id, e.user_id, f.user_id, g.user_id))
full outer join cte_device_type as i on i.user_id = coalesce(a.user_id, b.user_id, c.user_id,d.user_id, e.user_id, f.user_id, g.user_id, h.user_id)
where user_id is not null
limit 500
/* limit added automatically by dbt cloud */
2022-07-07 08:28:06.061026 (Thread-1): 08:28:06  Opening a new connection, currently in state init
2022-07-07 08:28:06.405808 (Thread-179): handling poll request
2022-07-07 08:28:06.406305 (Thread-179): 08:28:06  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '196d9207-3e38-4101-ac43-bc898fbec1a7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f51ec5499d0>]}
2022-07-07 08:28:06.407281 (Thread-179): sending response (<Response 8956 bytes [200 OK]>) to 10.0.41.177
2022-07-07 08:28:06.680823 (Thread-1): 08:28:06  Snowflake adapter: Snowflake query id: 01a5717c-0602-333e-0019-8203046b763a
2022-07-07 08:28:06.681016 (Thread-1): 08:28:06  Snowflake adapter: Snowflake error: 002028 (42601): SQL compilation error:
ambiguous column name 'USER_ID'
2022-07-07 08:28:06.681183 (Thread-1): 08:28:06  finished collecting timing info
2022-07-07 08:28:06.681346 (Thread-1): 08:28:06  On rpc.ecommerce_data_model_dbt.request: Close
2022-07-07 08:28:06.740879 (Thread-1): Got an exception: Database Error
  002028 (42601): SQL compilation error:
  ambiguous column name 'USER_ID'
Traceback (most recent call last):
  File "/usr/local/lib/python3.8/dist-packages/dbt/adapters/snowflake/connections.py", line 206, in exception_handler
    yield
  File "/usr/local/lib/python3.8/dist-packages/dbt/adapters/sql/connections.py", line 74, in add_query
    cursor.execute(sql, bindings)
  File "/usr/local/lib/python3.8/dist-packages/snowflake/connector/cursor.py", line 721, in execute
    Error.errorhandler_wrapper(
  File "/usr/local/lib/python3.8/dist-packages/snowflake/connector/errors.py", line 258, in errorhandler_wrapper
    cursor.errorhandler(connection, cursor, error_class, error_value)
  File "/usr/local/lib/python3.8/dist-packages/snowflake/connector/errors.py", line 188, in default_errorhandler
    raise error_class(
snowflake.connector.errors.ProgrammingError: 002028 (42601): SQL compilation error:
ambiguous column name 'USER_ID'

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/usr/local/lib/python3.8/dist-packages/dbt/task/base.py", line 361, in safe_run
    result = self.compile_and_execute(manifest, ctx)
  File "/usr/local/lib/python3.8/dist-packages/dbt/task/base.py", line 314, in compile_and_execute
    result = self.run(ctx.node, manifest)
  File "/usr/local/lib/python3.8/dist-packages/dbt/task/base.py", line 403, in run
    return self.execute(compiled_node, manifest)
  File "/usr/local/lib/python3.8/dist-packages/dbt_rpc/rpc/node_runners.py", line 90, in execute
    _, execute_result = self.adapter.execute(
  File "/usr/local/lib/python3.8/dist-packages/dbt/adapters/base/impl.py", line 225, in execute
    return self.connections.execute(
  File "/usr/local/lib/python3.8/dist-packages/dbt/adapters/sql/connections.py", line 127, in execute
    _, cursor = self.add_query(sql, auto_begin)
  File "/usr/local/lib/python3.8/dist-packages/dbt/adapters/snowflake/connections.py", line 433, in add_query
    connection, cursor = super().add_query(
  File "/usr/local/lib/python3.8/dist-packages/dbt/adapters/sql/connections.py", line 83, in add_query
    return connection, cursor
  File "/usr/lib/python3.8/contextlib.py", line 131, in __exit__
    self.gen.throw(type, value, traceback)
  File "/usr/local/lib/python3.8/dist-packages/dbt/adapters/snowflake/connections.py", line 223, in exception_handler
    raise DatabaseException(msg)
dbt.exceptions.DatabaseException: Database Error
  002028 (42601): SQL compilation error:
  ambiguous column name 'USER_ID'
2022-07-07 08:28:06.742167 (Thread-1): Got exception RPCException(10003, Database Error, {'type': 'DatabaseException', 'message': "Database Error in rpc request (from remote system)\n  002028 (42601): SQL compilation error:\n  ambiguous column name 'USER_ID'", 'raw_sql': "with cte_gender as \n(select user_id, gender from \n(select user_id, properties_gender as gender, row_number() over(partition by user_id order by timestamp desc) as rn from \n{{ source('ecommerce', 'identifies') }} where timestamp >= '{{ var('start_date') }}' and timestamp <= '{{ var('end_date') }}'\nand properties_gender is not null and properties_gender != '') where rn = 1),\n\ncte_age as \n(select user_id, age from\n(select user_id, \n(CASE WHEN dateadd(year, datediff (year, properties_birthday, getdate()), properties_birthday) > getdate()\n      THEN datediff(year, properties_birthday, getdate()) - 1\n      ELSE datediff(year, properties_birthday, getdate())\n END) as age, row_number() over(partition by user_id order by timestamp desc) as rn \nfrom {{ source('ecommerce', 'identifies') }} where timestamp >= '{{ var('start_date') }}' and timestamp <= '{{ var('end_date') }}'\nand properties_birthday is not null and properties_birthday!='') where rn = 1),\n\ncte_country as \n(select user_id, country from \n(select user_id, properties_country as country, row_number() over(partition by user_id order by timestamp desc) as rn from \n{{ source('ecommerce', 'identifies') }} where timestamp >= '{{ var('start_date') }}' and timestamp <= '{{ var('end_date') }}'\nand properties_country is not null and properties_country != '') where rn = 1),\n\ncte_state as \n(select user_id, state from \n(select user_id, properties_state as state, row_number() over(partition by user_id order by timestamp desc) as rn from \n{{ source('ecommerce', 'identifies') }} where timestamp >= '{{ var('start_date') }}' and timestamp <= '{{ var('end_date') }}'\nand properties_state is not null and properties_state != '') where rn = 1),\n\ncte_email_domain as \n(select user_id, email_domain from \n(select user_id, substring(properties_email, charindex( '@', properties_email) + 1, len(properties_email)) as email_domain, row_number() over(partition by user_id order by timestamp desc) as rn from \n{{ source('ecommerce', 'identifies') }} where timestamp >= '{{ var('start_date') }}' and timestamp <= '{{ var('end_date') }}'\nand properties_email is not null and properties_email != '') where rn = 1),\n\ncte_is_member as \n(select user_id, is_member from\n(select user_id, \n(CASE WHEN properties_is_member = TRUE\n      THEN TRUE\n      ELSE FALSE\nEND) as is_member, row_number() over(partition by user_id order by timestamp desc) as rn from \n{{ source('ecommerce', 'identifies') }} where timestamp >= '{{ var('start_date') }}' and timestamp <= '{{ var('end_date') }}'\nand user_id is not null) where rn = 1),\n\ncte_has_mobile_app as \n(select user_id, has_mobile_app from \n(select user_id, \n(CASE WHEN user_id IN(select user_id from {{ source('ecommerce', 'identifies') }} where context_device_type  = 'android' or context_device_type = 'iOS')\n      THEN TRUE\n      ELSE FALSE\n      END) as has_mobile_app, row_number() over(partition by user_id order by timestamp desc) as rn from \n{{ source('ecommerce', 'identifies') }} where timestamp >= '{{ var('start_date') }}' and timestamp <= '{{ var('end_date') }}'\nand context_device_type is not null and context_device_type != '' and user_id is not null) where rn = 1),\n\ncte_is_active_on_website as \n(select user_id, is_active_on_website from \n(select user_id, \n(CASE WHEN user_id IN(select user_id from {{ source('ecommerce', 'identifies') }} where context_device_type like '%PC')\n      THEN TRUE\n      ELSE FALSE\n      END)\nas is_active_on_website, row_number() over(partition by user_id order by timestamp desc) as rn from \n{{ source('ecommerce', 'identifies') }} where timestamp >= '{{ var('start_date') }}' and timestamp <= '{{ var('end_date') }}'\nand context_device_type is not null and context_device_type != '' and user_id is not null) where rn = 1),\n\ncte_device_type as \n(select user_id, device_type from \n(select user_id, context_device_type as device_type, row_number() over(partition by user_id order by timestamp desc) as rn from \n{{ source('ecommerce', 'identifies') }} where timestamp >= '{{ var('start_date') }}' and timestamp <= '{{ var('end_date') }}'\nand device_type is not null and device_type != '') where rn = 1)\n\nselect coalesce(a.user_id, b.user_id, c.user_id, d.user_id, e.user_id, f.user_id, g.user_id, h.user_id, i.user_id) \nas user_id, gender, age, country, state, email_domain, is_member, has_mobile_app, is_active_on_website, device_type\nfrom (((((((cte_gender a full outer join cte_age b on a.user_id = b.user_id) \nfull outer join cte_country c on c.user_id = coalesce(a.user_id, b.user_id))\nfull outer join cte_state d on d.user_id = coalesce(a.user_id, b.user_id, c.user_id))\nfull outer join cte_email_domain e on e.user_id = coalesce(a.user_id, b.user_id, c.user_id,d.user_id))\nfull outer join cte_is_member f on f.user_id = coalesce(a.user_id, b.user_id, c.user_id,d.user_id, e.user_id))\nfull outer join cte_has_mobile_app g on g.user_id = coalesce(a.user_id, b.user_id, c.user_id,d.user_id, e.user_id, f.user_id))\nfull outer join cte_is_active_on_website as h on h.user_id = coalesce(a.user_id, b.user_id, c.user_id,d.user_id, e.user_id, f.user_id, g.user_id))\nfull outer join cte_device_type as i on i.user_id = coalesce(a.user_id, b.user_id, c.user_id,d.user_id, e.user_id, f.user_id, g.user_id, h.user_id)\nwhere user_id is not null\nlimit 500\n/* limit added automatically by dbt cloud */", 'compiled_sql': "with cte_gender as \n(select user_id, gender from \n(select user_id, properties_gender as gender, row_number() over(partition by user_id order by timestamp desc) as rn from \nanalytics_db.data_apps_simulated.identifies where timestamp >= '2021-05-01' and timestamp <= '2022-06-29'\nand properties_gender is not null and properties_gender != '') where rn = 1),\n\ncte_age as \n(select user_id, age from\n(select user_id, \n(CASE WHEN dateadd(year, datediff (year, properties_birthday, getdate()), properties_birthday) > getdate()\n      THEN datediff(year, properties_birthday, getdate()) - 1\n      ELSE datediff(year, properties_birthday, getdate())\n END) as age, row_number() over(partition by user_id order by timestamp desc) as rn \nfrom analytics_db.data_apps_simulated.identifies where timestamp >= '2021-05-01' and timestamp <= '2022-06-29'\nand properties_birthday is not null and properties_birthday!='') where rn = 1),\n\ncte_country as \n(select user_id, country from \n(select user_id, properties_country as country, row_number() over(partition by user_id order by timestamp desc) as rn from \nanalytics_db.data_apps_simulated.identifies where timestamp >= '2021-05-01' and timestamp <= '2022-06-29'\nand properties_country is not null and properties_country != '') where rn = 1),\n\ncte_state as \n(select user_id, state from \n(select user_id, properties_state as state, row_number() over(partition by user_id order by timestamp desc) as rn from \nanalytics_db.data_apps_simulated.identifies where timestamp >= '2021-05-01' and timestamp <= '2022-06-29'\nand properties_state is not null and properties_state != '') where rn = 1),\n\ncte_email_domain as \n(select user_id, email_domain from \n(select user_id, substring(properties_email, charindex( '@', properties_email) + 1, len(properties_email)) as email_domain, row_number() over(partition by user_id order by timestamp desc) as rn from \nanalytics_db.data_apps_simulated.identifies where timestamp >= '2021-05-01' and timestamp <= '2022-06-29'\nand properties_email is not null and properties_email != '') where rn = 1),\n\ncte_is_member as \n(select user_id, is_member from\n(select user_id, \n(CASE WHEN properties_is_member = TRUE\n      THEN TRUE\n      ELSE FALSE\nEND) as is_member, row_number() over(partition by user_id order by timestamp desc) as rn from \nanalytics_db.data_apps_simulated.identifies where timestamp >= '2021-05-01' and timestamp <= '2022-06-29'\nand user_id is not null) where rn = 1),\n\ncte_has_mobile_app as \n(select user_id, has_mobile_app from \n(select user_id, \n(CASE WHEN user_id IN(select user_id from analytics_db.data_apps_simulated.identifies where context_device_type  = 'android' or context_device_type = 'iOS')\n      THEN TRUE\n      ELSE FALSE\n      END) as has_mobile_app, row_number() over(partition by user_id order by timestamp desc) as rn from \nanalytics_db.data_apps_simulated.identifies where timestamp >= '2021-05-01' and timestamp <= '2022-06-29'\nand context_device_type is not null and context_device_type != '' and user_id is not null) where rn = 1),\n\ncte_is_active_on_website as \n(select user_id, is_active_on_website from \n(select user_id, \n(CASE WHEN user_id IN(select user_id from analytics_db.data_apps_simulated.identifies where context_device_type like '%PC')\n      THEN TRUE\n      ELSE FALSE\n      END)\nas is_active_on_website, row_number() over(partition by user_id order by timestamp desc) as rn from \nanalytics_db.data_apps_simulated.identifies where timestamp >= '2021-05-01' and timestamp <= '2022-06-29'\nand context_device_type is not null and context_device_type != '' and user_id is not null) where rn = 1),\n\ncte_device_type as \n(select user_id, device_type from \n(select user_id, context_device_type as device_type, row_number() over(partition by user_id order by timestamp desc) as rn from \nanalytics_db.data_apps_simulated.identifies where timestamp >= '2021-05-01' and timestamp <= '2022-06-29'\nand device_type is not null and device_type != '') where rn = 1)\n\nselect coalesce(a.user_id, b.user_id, c.user_id, d.user_id, e.user_id, f.user_id, g.user_id, h.user_id, i.user_id) \nas user_id, gender, age, country, state, email_domain, is_member, has_mobile_app, is_active_on_website, device_type\nfrom (((((((cte_gender a full outer join cte_age b on a.user_id = b.user_id) \nfull outer join cte_country c on c.user_id = coalesce(a.user_id, b.user_id))\nfull outer join cte_state d on d.user_id = coalesce(a.user_id, b.user_id, c.user_id))\nfull outer join cte_email_domain e on e.user_id = coalesce(a.user_id, b.user_id, c.user_id,d.user_id))\nfull outer join cte_is_member f on f.user_id = coalesce(a.user_id, b.user_id, c.user_id,d.user_id, e.user_id))\nfull outer join cte_has_mobile_app g on g.user_id = coalesce(a.user_id, b.user_id, c.user_id,d.user_id, e.user_id, f.user_id))\nfull outer join cte_is_active_on_website as h on h.user_id = coalesce(a.user_id, b.user_id, c.user_id,d.user_id, e.user_id, f.user_id, g.user_id))\nfull outer join cte_device_type as i on i.user_id = coalesce(a.user_id, b.user_id, c.user_id,d.user_id, e.user_id, f.user_id, g.user_id, h.user_id)\nwhere user_id is not null\nlimit 500\n/* limit added automatically by dbt cloud */", 'tags': None}, None)
Traceback (most recent call last):
  File "/usr/local/lib/python3.8/dist-packages/dbt_rpc/task/sql_commands.py", line 147, in _in_thread
    self.node_results.append(runner.safe_run(self.manifest))
  File "/usr/local/lib/python3.8/dist-packages/dbt/task/base.py", line 377, in safe_run
    result = self.error_result(ctx.node, error, started, [])
  File "/usr/local/lib/python3.8/dist-packages/dbt_rpc/rpc/node_runners.py", line 56, in error_result
    raise error
dbt_rpc.rpc.error.RPCException: RPCException(10003, Database Error, {'type': 'DatabaseException', 'message': "Database Error in rpc request (from remote system)\n  002028 (42601): SQL compilation error:\n  ambiguous column name 'USER_ID'", 'raw_sql': "with cte_gender as \n(select user_id, gender from \n(select user_id, properties_gender as gender, row_number() over(partition by user_id order by timestamp desc) as rn from \n{{ source('ecommerce', 'identifies') }} where timestamp >= '{{ var('start_date') }}' and timestamp <= '{{ var('end_date') }}'\nand properties_gender is not null and properties_gender != '') where rn = 1),\n\ncte_age as \n(select user_id, age from\n(select user_id, \n(CASE WHEN dateadd(year, datediff (year, properties_birthday, getdate()), properties_birthday) > getdate()\n      THEN datediff(year, properties_birthday, getdate()) - 1\n      ELSE datediff(year, properties_birthday, getdate())\n END) as age, row_number() over(partition by user_id order by timestamp desc) as rn \nfrom {{ source('ecommerce', 'identifies') }} where timestamp >= '{{ var('start_date') }}' and timestamp <= '{{ var('end_date') }}'\nand properties_birthday is not null and properties_birthday!='') where rn = 1),\n\ncte_country as \n(select user_id, country from \n(select user_id, properties_country as country, row_number() over(partition by user_id order by timestamp desc) as rn from \n{{ source('ecommerce', 'identifies') }} where timestamp >= '{{ var('start_date') }}' and timestamp <= '{{ var('end_date') }}'\nand properties_country is not null and properties_country != '') where rn = 1),\n\ncte_state as \n(select user_id, state from \n(select user_id, properties_state as state, row_number() over(partition by user_id order by timestamp desc) as rn from \n{{ source('ecommerce', 'identifies') }} where timestamp >= '{{ var('start_date') }}' and timestamp <= '{{ var('end_date') }}'\nand properties_state is not null and properties_state != '') where rn = 1),\n\ncte_email_domain as \n(select user_id, email_domain from \n(select user_id, substring(properties_email, charindex( '@', properties_email) + 1, len(properties_email)) as email_domain, row_number() over(partition by user_id order by timestamp desc) as rn from \n{{ source('ecommerce', 'identifies') }} where timestamp >= '{{ var('start_date') }}' and timestamp <= '{{ var('end_date') }}'\nand properties_email is not null and properties_email != '') where rn = 1),\n\ncte_is_member as \n(select user_id, is_member from\n(select user_id, \n(CASE WHEN properties_is_member = TRUE\n      THEN TRUE\n      ELSE FALSE\nEND) as is_member, row_number() over(partition by user_id order by timestamp desc) as rn from \n{{ source('ecommerce', 'identifies') }} where timestamp >= '{{ var('start_date') }}' and timestamp <= '{{ var('end_date') }}'\nand user_id is not null) where rn = 1),\n\ncte_has_mobile_app as \n(select user_id, has_mobile_app from \n(select user_id, \n(CASE WHEN user_id IN(select user_id from {{ source('ecommerce', 'identifies') }} where context_device_type  = 'android' or context_device_type = 'iOS')\n      THEN TRUE\n      ELSE FALSE\n      END) as has_mobile_app, row_number() over(partition by user_id order by timestamp desc) as rn from \n{{ source('ecommerce', 'identifies') }} where timestamp >= '{{ var('start_date') }}' and timestamp <= '{{ var('end_date') }}'\nand context_device_type is not null and context_device_type != '' and user_id is not null) where rn = 1),\n\ncte_is_active_on_website as \n(select user_id, is_active_on_website from \n(select user_id, \n(CASE WHEN user_id IN(select user_id from {{ source('ecommerce', 'identifies') }} where context_device_type like '%PC')\n      THEN TRUE\n      ELSE FALSE\n      END)\nas is_active_on_website, row_number() over(partition by user_id order by timestamp desc) as rn from \n{{ source('ecommerce', 'identifies') }} where timestamp >= '{{ var('start_date') }}' and timestamp <= '{{ var('end_date') }}'\nand context_device_type is not null and context_device_type != '' and user_id is not null) where rn = 1),\n\ncte_device_type as \n(select user_id, device_type from \n(select user_id, context_device_type as device_type, row_number() over(partition by user_id order by timestamp desc) as rn from \n{{ source('ecommerce', 'identifies') }} where timestamp >= '{{ var('start_date') }}' and timestamp <= '{{ var('end_date') }}'\nand device_type is not null and device_type != '') where rn = 1)\n\nselect coalesce(a.user_id, b.user_id, c.user_id, d.user_id, e.user_id, f.user_id, g.user_id, h.user_id, i.user_id) \nas user_id, gender, age, country, state, email_domain, is_member, has_mobile_app, is_active_on_website, device_type\nfrom (((((((cte_gender a full outer join cte_age b on a.user_id = b.user_id) \nfull outer join cte_country c on c.user_id = coalesce(a.user_id, b.user_id))\nfull outer join cte_state d on d.user_id = coalesce(a.user_id, b.user_id, c.user_id))\nfull outer join cte_email_domain e on e.user_id = coalesce(a.user_id, b.user_id, c.user_id,d.user_id))\nfull outer join cte_is_member f on f.user_id = coalesce(a.user_id, b.user_id, c.user_id,d.user_id, e.user_id))\nfull outer join cte_has_mobile_app g on g.user_id = coalesce(a.user_id, b.user_id, c.user_id,d.user_id, e.user_id, f.user_id))\nfull outer join cte_is_active_on_website as h on h.user_id = coalesce(a.user_id, b.user_id, c.user_id,d.user_id, e.user_id, f.user_id, g.user_id))\nfull outer join cte_device_type as i on i.user_id = coalesce(a.user_id, b.user_id, c.user_id,d.user_id, e.user_id, f.user_id, g.user_id, h.user_id)\nwhere user_id is not null\nlimit 500\n/* limit added automatically by dbt cloud */", 'compiled_sql': "with cte_gender as \n(select user_id, gender from \n(select user_id, properties_gender as gender, row_number() over(partition by user_id order by timestamp desc) as rn from \nanalytics_db.data_apps_simulated.identifies where timestamp >= '2021-05-01' and timestamp <= '2022-06-29'\nand properties_gender is not null and properties_gender != '') where rn = 1),\n\ncte_age as \n(select user_id, age from\n(select user_id, \n(CASE WHEN dateadd(year, datediff (year, properties_birthday, getdate()), properties_birthday) > getdate()\n      THEN datediff(year, properties_birthday, getdate()) - 1\n      ELSE datediff(year, properties_birthday, getdate())\n END) as age, row_number() over(partition by user_id order by timestamp desc) as rn \nfrom analytics_db.data_apps_simulated.identifies where timestamp >= '2021-05-01' and timestamp <= '2022-06-29'\nand properties_birthday is not null and properties_birthday!='') where rn = 1),\n\ncte_country as \n(select user_id, country from \n(select user_id, properties_country as country, row_number() over(partition by user_id order by timestamp desc) as rn from \nanalytics_db.data_apps_simulated.identifies where timestamp >= '2021-05-01' and timestamp <= '2022-06-29'\nand properties_country is not null and properties_country != '') where rn = 1),\n\ncte_state as \n(select user_id, state from \n(select user_id, properties_state as state, row_number() over(partition by user_id order by timestamp desc) as rn from \nanalytics_db.data_apps_simulated.identifies where timestamp >= '2021-05-01' and timestamp <= '2022-06-29'\nand properties_state is not null and properties_state != '') where rn = 1),\n\ncte_email_domain as \n(select user_id, email_domain from \n(select user_id, substring(properties_email, charindex( '@', properties_email) + 1, len(properties_email)) as email_domain, row_number() over(partition by user_id order by timestamp desc) as rn from \nanalytics_db.data_apps_simulated.identifies where timestamp >= '2021-05-01' and timestamp <= '2022-06-29'\nand properties_email is not null and properties_email != '') where rn = 1),\n\ncte_is_member as \n(select user_id, is_member from\n(select user_id, \n(CASE WHEN properties_is_member = TRUE\n      THEN TRUE\n      ELSE FALSE\nEND) as is_member, row_number() over(partition by user_id order by timestamp desc) as rn from \nanalytics_db.data_apps_simulated.identifies where timestamp >= '2021-05-01' and timestamp <= '2022-06-29'\nand user_id is not null) where rn = 1),\n\ncte_has_mobile_app as \n(select user_id, has_mobile_app from \n(select user_id, \n(CASE WHEN user_id IN(select user_id from analytics_db.data_apps_simulated.identifies where context_device_type  = 'android' or context_device_type = 'iOS')\n      THEN TRUE\n      ELSE FALSE\n      END) as has_mobile_app, row_number() over(partition by user_id order by timestamp desc) as rn from \nanalytics_db.data_apps_simulated.identifies where timestamp >= '2021-05-01' and timestamp <= '2022-06-29'\nand context_device_type is not null and context_device_type != '' and user_id is not null) where rn = 1),\n\ncte_is_active_on_website as \n(select user_id, is_active_on_website from \n(select user_id, \n(CASE WHEN user_id IN(select user_id from analytics_db.data_apps_simulated.identifies where context_device_type like '%PC')\n      THEN TRUE\n      ELSE FALSE\n      END)\nas is_active_on_website, row_number() over(partition by user_id order by timestamp desc) as rn from \nanalytics_db.data_apps_simulated.identifies where timestamp >= '2021-05-01' and timestamp <= '2022-06-29'\nand context_device_type is not null and context_device_type != '' and user_id is not null) where rn = 1),\n\ncte_device_type as \n(select user_id, device_type from \n(select user_id, context_device_type as device_type, row_number() over(partition by user_id order by timestamp desc) as rn from \nanalytics_db.data_apps_simulated.identifies where timestamp >= '2021-05-01' and timestamp <= '2022-06-29'\nand device_type is not null and device_type != '') where rn = 1)\n\nselect coalesce(a.user_id, b.user_id, c.user_id, d.user_id, e.user_id, f.user_id, g.user_id, h.user_id, i.user_id) \nas user_id, gender, age, country, state, email_domain, is_member, has_mobile_app, is_active_on_website, device_type\nfrom (((((((cte_gender a full outer join cte_age b on a.user_id = b.user_id) \nfull outer join cte_country c on c.user_id = coalesce(a.user_id, b.user_id))\nfull outer join cte_state d on d.user_id = coalesce(a.user_id, b.user_id, c.user_id))\nfull outer join cte_email_domain e on e.user_id = coalesce(a.user_id, b.user_id, c.user_id,d.user_id))\nfull outer join cte_is_member f on f.user_id = coalesce(a.user_id, b.user_id, c.user_id,d.user_id, e.user_id))\nfull outer join cte_has_mobile_app g on g.user_id = coalesce(a.user_id, b.user_id, c.user_id,d.user_id, e.user_id, f.user_id))\nfull outer join cte_is_active_on_website as h on h.user_id = coalesce(a.user_id, b.user_id, c.user_id,d.user_id, e.user_id, f.user_id, g.user_id))\nfull outer join cte_device_type as i on i.user_id = coalesce(a.user_id, b.user_id, c.user_id,d.user_id, e.user_id, f.user_id, g.user_id, h.user_id)\nwhere user_id is not null\nlimit 500\n/* limit added automatically by dbt cloud */", 'tags': None}, None)
2022-07-07 08:28:07.808416 (Thread-180): handling poll request
2022-07-07 08:28:07.808809 (Thread-180): 08:28:07  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '196d9207-3e38-4101-ac43-bc898fbec1a7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f51ec549310>]}
2022-07-07 08:28:07.833026 (Thread-180): sending response (<Response 46669 bytes [200 OK]>) to 10.0.41.177
2022-07-07 08:28:51.431049 (Thread-181): handling status request
2022-07-07 08:28:51.431465 (Thread-181): 08:28:51  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '196d9207-3e38-4101-ac43-bc898fbec1a7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f51ec45bca0>]}
2022-07-07 08:28:51.432075 (Thread-181): sending response (<Response 2357 bytes [200 OK]>) to 10.0.41.177
2022-07-07 08:28:52.276045 (Thread-182): handling run_sql request
2022-07-07 08:28:52.276459 (Thread-182): 08:28:52  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '196d9207-3e38-4101-ac43-bc898fbec1a7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f51ec45b580>]}
2022-07-07 08:28:54.670902 (Thread-182): sending response (<Response 139 bytes [200 OK]>) to 10.0.41.177
2022-07-07 08:28:54.707212 (MainThread): 08:28:54  Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'b7945845-dfb7-4d43-81a9-ed38d769ade9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0484646760>]}
2022-07-07 08:28:54.707803 (MainThread): 08:28:54  Found 16 models, 0 tests, 0 snapshots, 0 analyses, 181 macros, 0 operations, 0 seed files, 15 sources, 0 exposures, 0 metrics
2022-07-07 08:28:54.708419 (Thread-1): 08:28:54  Acquiring new snowflake connection "rpc.ecommerce_data_model_dbt.request"
2022-07-07 08:28:54.708555 (Thread-1): 08:28:54  Began compiling node rpc.ecommerce_data_model_dbt.request
2022-07-07 08:28:54.708649 (Thread-1): 08:28:54  Compiling rpc.ecommerce_data_model_dbt.request
2022-07-07 08:28:54.717166 (Thread-1): 08:28:54  finished collecting timing info
2022-07-07 08:28:54.717302 (Thread-1): 08:28:54  Began executing node rpc.ecommerce_data_model_dbt.request
2022-07-07 08:28:54.722541 (Thread-1): 08:28:54  Using snowflake connection "rpc.ecommerce_data_model_dbt.request"
2022-07-07 08:28:54.722638 (Thread-1): 08:28:54  On rpc.ecommerce_data_model_dbt.request: with cte_gender as 
(select user_id, gender from 
(select user_id, properties_gender as gender, row_number() over(partition by user_id order by timestamp desc) as rn from 
analytics_db.data_apps_simulated.identifies where timestamp >= '2021-05-01' and timestamp <= '2022-06-29'
and properties_gender is not null and properties_gender != '') where rn = 1),

cte_age as 
(select user_id, age from
(select user_id, 
(CASE WHEN dateadd(year, datediff (year, properties_birthday, getdate()), properties_birthday) > getdate()
      THEN datediff(year, properties_birthday, getdate()) - 1
      ELSE datediff(year, properties_birthday, getdate())
 END) as age, row_number() over(partition by user_id order by timestamp desc) as rn 
from analytics_db.data_apps_simulated.identifies where timestamp >= '2021-05-01' and timestamp <= '2022-06-29'
and properties_birthday is not null and properties_birthday!='') where rn = 1),

cte_country as 
(select user_id, country from 
(select user_id, properties_country as country, row_number() over(partition by user_id order by timestamp desc) as rn from 
analytics_db.data_apps_simulated.identifies where timestamp >= '2021-05-01' and timestamp <= '2022-06-29'
and properties_country is not null and properties_country != '') where rn = 1),

cte_state as 
(select user_id, state from 
(select user_id, properties_state as state, row_number() over(partition by user_id order by timestamp desc) as rn from 
analytics_db.data_apps_simulated.identifies where timestamp >= '2021-05-01' and timestamp <= '2022-06-29'
and properties_state is not null and properties_state != '') where rn = 1),

cte_email_domain as 
(select user_id, email_domain from 
(select user_id, substring(properties_email, charindex( '@', properties_email) + 1, len(properties_email)) as email_domain, row_number() over(partition by user_id order by timestamp desc) as rn from 
analytics_db.data_apps_simulated.identifies where timestamp >= '2021-05-01' and timestamp <= '2022-06-29'
and properties_email is not null and properties_email != '') where rn = 1),

cte_is_member as 
(select user_id, is_member from
(select user_id, 
(CASE WHEN properties_is_member = TRUE
      THEN TRUE
      ELSE FALSE
END) as is_member, row_number() over(partition by user_id order by timestamp desc) as rn from 
analytics_db.data_apps_simulated.identifies where timestamp >= '2021-05-01' and timestamp <= '2022-06-29'
and user_id is not null) where rn = 1),

cte_has_mobile_app as 
(select user_id, has_mobile_app from 
(select user_id, 
(CASE WHEN user_id IN(select user_id from analytics_db.data_apps_simulated.identifies where context_device_type  = 'android' or context_device_type = 'iOS')
      THEN TRUE
      ELSE FALSE
      END) as has_mobile_app, row_number() over(partition by user_id order by timestamp desc) as rn from 
analytics_db.data_apps_simulated.identifies where timestamp >= '2021-05-01' and timestamp <= '2022-06-29'
and context_device_type is not null and context_device_type != '' and user_id is not null) where rn = 1),

cte_is_active_on_website as 
(select user_id, is_active_on_website from 
(select user_id, 
(CASE WHEN user_id IN(select user_id from analytics_db.data_apps_simulated.identifies where context_device_type like '%PC')
      THEN TRUE
      ELSE FALSE
      END)
as is_active_on_website, row_number() over(partition by user_id order by timestamp desc) as rn from 
analytics_db.data_apps_simulated.identifies where timestamp >= '2021-05-01' and timestamp <= '2022-06-29'
and context_device_type is not null and context_device_type != '' and user_id is not null) where rn = 1),

cte_device_type as 
(select user_id, device_type from 
(select user_id, context_device_type as device_type, row_number() over(partition by user_id order by timestamp desc) as rn from 
analytics_db.data_apps_simulated.identifies where timestamp >= '2021-05-01' and timestamp <= '2022-06-29'
and device_type is not null and device_type != '') where rn = 1)

select coalesce(a.user_id, b.user_id, c.user_id, d.user_id, e.user_id, f.user_id, g.user_id, h.user_id, i.user_id) 
as user_id, gender, age, country, state, email_domain, is_member, has_mobile_app, is_active_on_website, device_type
from ((((((((cte_gender a full outer join cte_age b on a.user_id = b.user_id) 
full outer join cte_country c on c.user_id = coalesce(a.user_id, b.user_id))
full outer join cte_state d on d.user_id = coalesce(a.user_id, b.user_id, c.user_id))
full outer join cte_email_domain e on e.user_id = coalesce(a.user_id, b.user_id, c.user_id,d.user_id))
full outer join cte_is_member f on f.user_id = coalesce(a.user_id, b.user_id, c.user_id,d.user_id, e.user_id))
full outer join cte_has_mobile_app g on g.user_id = coalesce(a.user_id, b.user_id, c.user_id,d.user_id, e.user_id, f.user_id))
full outer join cte_is_active_on_website as h on h.user_id = coalesce(a.user_id, b.user_id, c.user_id,d.user_id, e.user_id, f.user_id, g.user_id))
full outer join cte_device_type as i on i.user_id = coalesce(a.user_id, b.user_id, c.user_id,d.user_id, e.user_id, f.user_id, g.user_id, h.user_id))
where user_id is not null
limit 500
/* limit added automatically by dbt cloud */
2022-07-07 08:28:54.722723 (Thread-1): 08:28:54  Opening a new connection, currently in state init
2022-07-07 08:28:55.091087 (Thread-183): handling poll request
2022-07-07 08:28:55.091558 (Thread-183): 08:28:55  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '196d9207-3e38-4101-ac43-bc898fbec1a7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f51ec45dfd0>]}
2022-07-07 08:28:55.092495 (Thread-183): sending response (<Response 8958 bytes [200 OK]>) to 10.0.41.177
2022-07-07 08:28:55.416818 (Thread-1): 08:28:55  Snowflake adapter: Snowflake query id: 01a5717c-0602-3441-0019-8203046b47e6
2022-07-07 08:28:55.417006 (Thread-1): 08:28:55  Snowflake adapter: Snowflake error: 002028 (42601): SQL compilation error:
ambiguous column name 'USER_ID'
2022-07-07 08:28:55.417176 (Thread-1): 08:28:55  finished collecting timing info
2022-07-07 08:28:55.417341 (Thread-1): 08:28:55  On rpc.ecommerce_data_model_dbt.request: Close
2022-07-07 08:28:55.494957 (Thread-1): Got an exception: Database Error
  002028 (42601): SQL compilation error:
  ambiguous column name 'USER_ID'
Traceback (most recent call last):
  File "/usr/local/lib/python3.8/dist-packages/dbt/adapters/snowflake/connections.py", line 206, in exception_handler
    yield
  File "/usr/local/lib/python3.8/dist-packages/dbt/adapters/sql/connections.py", line 74, in add_query
    cursor.execute(sql, bindings)
  File "/usr/local/lib/python3.8/dist-packages/snowflake/connector/cursor.py", line 721, in execute
    Error.errorhandler_wrapper(
  File "/usr/local/lib/python3.8/dist-packages/snowflake/connector/errors.py", line 258, in errorhandler_wrapper
    cursor.errorhandler(connection, cursor, error_class, error_value)
  File "/usr/local/lib/python3.8/dist-packages/snowflake/connector/errors.py", line 188, in default_errorhandler
    raise error_class(
snowflake.connector.errors.ProgrammingError: 002028 (42601): SQL compilation error:
ambiguous column name 'USER_ID'

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/usr/local/lib/python3.8/dist-packages/dbt/task/base.py", line 361, in safe_run
    result = self.compile_and_execute(manifest, ctx)
  File "/usr/local/lib/python3.8/dist-packages/dbt/task/base.py", line 314, in compile_and_execute
    result = self.run(ctx.node, manifest)
  File "/usr/local/lib/python3.8/dist-packages/dbt/task/base.py", line 403, in run
    return self.execute(compiled_node, manifest)
  File "/usr/local/lib/python3.8/dist-packages/dbt_rpc/rpc/node_runners.py", line 90, in execute
    _, execute_result = self.adapter.execute(
  File "/usr/local/lib/python3.8/dist-packages/dbt/adapters/base/impl.py", line 225, in execute
    return self.connections.execute(
  File "/usr/local/lib/python3.8/dist-packages/dbt/adapters/sql/connections.py", line 127, in execute
    _, cursor = self.add_query(sql, auto_begin)
  File "/usr/local/lib/python3.8/dist-packages/dbt/adapters/snowflake/connections.py", line 433, in add_query
    connection, cursor = super().add_query(
  File "/usr/local/lib/python3.8/dist-packages/dbt/adapters/sql/connections.py", line 83, in add_query
    return connection, cursor
  File "/usr/lib/python3.8/contextlib.py", line 131, in __exit__
    self.gen.throw(type, value, traceback)
  File "/usr/local/lib/python3.8/dist-packages/dbt/adapters/snowflake/connections.py", line 223, in exception_handler
    raise DatabaseException(msg)
dbt.exceptions.DatabaseException: Database Error
  002028 (42601): SQL compilation error:
  ambiguous column name 'USER_ID'
2022-07-07 08:28:55.495942 (Thread-1): Got exception RPCException(10003, Database Error, {'type': 'DatabaseException', 'message': "Database Error in rpc request (from remote system)\n  002028 (42601): SQL compilation error:\n  ambiguous column name 'USER_ID'", 'raw_sql': "with cte_gender as \n(select user_id, gender from \n(select user_id, properties_gender as gender, row_number() over(partition by user_id order by timestamp desc) as rn from \n{{ source('ecommerce', 'identifies') }} where timestamp >= '{{ var('start_date') }}' and timestamp <= '{{ var('end_date') }}'\nand properties_gender is not null and properties_gender != '') where rn = 1),\n\ncte_age as \n(select user_id, age from\n(select user_id, \n(CASE WHEN dateadd(year, datediff (year, properties_birthday, getdate()), properties_birthday) > getdate()\n      THEN datediff(year, properties_birthday, getdate()) - 1\n      ELSE datediff(year, properties_birthday, getdate())\n END) as age, row_number() over(partition by user_id order by timestamp desc) as rn \nfrom {{ source('ecommerce', 'identifies') }} where timestamp >= '{{ var('start_date') }}' and timestamp <= '{{ var('end_date') }}'\nand properties_birthday is not null and properties_birthday!='') where rn = 1),\n\ncte_country as \n(select user_id, country from \n(select user_id, properties_country as country, row_number() over(partition by user_id order by timestamp desc) as rn from \n{{ source('ecommerce', 'identifies') }} where timestamp >= '{{ var('start_date') }}' and timestamp <= '{{ var('end_date') }}'\nand properties_country is not null and properties_country != '') where rn = 1),\n\ncte_state as \n(select user_id, state from \n(select user_id, properties_state as state, row_number() over(partition by user_id order by timestamp desc) as rn from \n{{ source('ecommerce', 'identifies') }} where timestamp >= '{{ var('start_date') }}' and timestamp <= '{{ var('end_date') }}'\nand properties_state is not null and properties_state != '') where rn = 1),\n\ncte_email_domain as \n(select user_id, email_domain from \n(select user_id, substring(properties_email, charindex( '@', properties_email) + 1, len(properties_email)) as email_domain, row_number() over(partition by user_id order by timestamp desc) as rn from \n{{ source('ecommerce', 'identifies') }} where timestamp >= '{{ var('start_date') }}' and timestamp <= '{{ var('end_date') }}'\nand properties_email is not null and properties_email != '') where rn = 1),\n\ncte_is_member as \n(select user_id, is_member from\n(select user_id, \n(CASE WHEN properties_is_member = TRUE\n      THEN TRUE\n      ELSE FALSE\nEND) as is_member, row_number() over(partition by user_id order by timestamp desc) as rn from \n{{ source('ecommerce', 'identifies') }} where timestamp >= '{{ var('start_date') }}' and timestamp <= '{{ var('end_date') }}'\nand user_id is not null) where rn = 1),\n\ncte_has_mobile_app as \n(select user_id, has_mobile_app from \n(select user_id, \n(CASE WHEN user_id IN(select user_id from {{ source('ecommerce', 'identifies') }} where context_device_type  = 'android' or context_device_type = 'iOS')\n      THEN TRUE\n      ELSE FALSE\n      END) as has_mobile_app, row_number() over(partition by user_id order by timestamp desc) as rn from \n{{ source('ecommerce', 'identifies') }} where timestamp >= '{{ var('start_date') }}' and timestamp <= '{{ var('end_date') }}'\nand context_device_type is not null and context_device_type != '' and user_id is not null) where rn = 1),\n\ncte_is_active_on_website as \n(select user_id, is_active_on_website from \n(select user_id, \n(CASE WHEN user_id IN(select user_id from {{ source('ecommerce', 'identifies') }} where context_device_type like '%PC')\n      THEN TRUE\n      ELSE FALSE\n      END)\nas is_active_on_website, row_number() over(partition by user_id order by timestamp desc) as rn from \n{{ source('ecommerce', 'identifies') }} where timestamp >= '{{ var('start_date') }}' and timestamp <= '{{ var('end_date') }}'\nand context_device_type is not null and context_device_type != '' and user_id is not null) where rn = 1),\n\ncte_device_type as \n(select user_id, device_type from \n(select user_id, context_device_type as device_type, row_number() over(partition by user_id order by timestamp desc) as rn from \n{{ source('ecommerce', 'identifies') }} where timestamp >= '{{ var('start_date') }}' and timestamp <= '{{ var('end_date') }}'\nand device_type is not null and device_type != '') where rn = 1)\n\nselect coalesce(a.user_id, b.user_id, c.user_id, d.user_id, e.user_id, f.user_id, g.user_id, h.user_id, i.user_id) \nas user_id, gender, age, country, state, email_domain, is_member, has_mobile_app, is_active_on_website, device_type\nfrom ((((((((cte_gender a full outer join cte_age b on a.user_id = b.user_id) \nfull outer join cte_country c on c.user_id = coalesce(a.user_id, b.user_id))\nfull outer join cte_state d on d.user_id = coalesce(a.user_id, b.user_id, c.user_id))\nfull outer join cte_email_domain e on e.user_id = coalesce(a.user_id, b.user_id, c.user_id,d.user_id))\nfull outer join cte_is_member f on f.user_id = coalesce(a.user_id, b.user_id, c.user_id,d.user_id, e.user_id))\nfull outer join cte_has_mobile_app g on g.user_id = coalesce(a.user_id, b.user_id, c.user_id,d.user_id, e.user_id, f.user_id))\nfull outer join cte_is_active_on_website as h on h.user_id = coalesce(a.user_id, b.user_id, c.user_id,d.user_id, e.user_id, f.user_id, g.user_id))\nfull outer join cte_device_type as i on i.user_id = coalesce(a.user_id, b.user_id, c.user_id,d.user_id, e.user_id, f.user_id, g.user_id, h.user_id))\nwhere user_id is not null\nlimit 500\n/* limit added automatically by dbt cloud */", 'compiled_sql': "with cte_gender as \n(select user_id, gender from \n(select user_id, properties_gender as gender, row_number() over(partition by user_id order by timestamp desc) as rn from \nanalytics_db.data_apps_simulated.identifies where timestamp >= '2021-05-01' and timestamp <= '2022-06-29'\nand properties_gender is not null and properties_gender != '') where rn = 1),\n\ncte_age as \n(select user_id, age from\n(select user_id, \n(CASE WHEN dateadd(year, datediff (year, properties_birthday, getdate()), properties_birthday) > getdate()\n      THEN datediff(year, properties_birthday, getdate()) - 1\n      ELSE datediff(year, properties_birthday, getdate())\n END) as age, row_number() over(partition by user_id order by timestamp desc) as rn \nfrom analytics_db.data_apps_simulated.identifies where timestamp >= '2021-05-01' and timestamp <= '2022-06-29'\nand properties_birthday is not null and properties_birthday!='') where rn = 1),\n\ncte_country as \n(select user_id, country from \n(select user_id, properties_country as country, row_number() over(partition by user_id order by timestamp desc) as rn from \nanalytics_db.data_apps_simulated.identifies where timestamp >= '2021-05-01' and timestamp <= '2022-06-29'\nand properties_country is not null and properties_country != '') where rn = 1),\n\ncte_state as \n(select user_id, state from \n(select user_id, properties_state as state, row_number() over(partition by user_id order by timestamp desc) as rn from \nanalytics_db.data_apps_simulated.identifies where timestamp >= '2021-05-01' and timestamp <= '2022-06-29'\nand properties_state is not null and properties_state != '') where rn = 1),\n\ncte_email_domain as \n(select user_id, email_domain from \n(select user_id, substring(properties_email, charindex( '@', properties_email) + 1, len(properties_email)) as email_domain, row_number() over(partition by user_id order by timestamp desc) as rn from \nanalytics_db.data_apps_simulated.identifies where timestamp >= '2021-05-01' and timestamp <= '2022-06-29'\nand properties_email is not null and properties_email != '') where rn = 1),\n\ncte_is_member as \n(select user_id, is_member from\n(select user_id, \n(CASE WHEN properties_is_member = TRUE\n      THEN TRUE\n      ELSE FALSE\nEND) as is_member, row_number() over(partition by user_id order by timestamp desc) as rn from \nanalytics_db.data_apps_simulated.identifies where timestamp >= '2021-05-01' and timestamp <= '2022-06-29'\nand user_id is not null) where rn = 1),\n\ncte_has_mobile_app as \n(select user_id, has_mobile_app from \n(select user_id, \n(CASE WHEN user_id IN(select user_id from analytics_db.data_apps_simulated.identifies where context_device_type  = 'android' or context_device_type = 'iOS')\n      THEN TRUE\n      ELSE FALSE\n      END) as has_mobile_app, row_number() over(partition by user_id order by timestamp desc) as rn from \nanalytics_db.data_apps_simulated.identifies where timestamp >= '2021-05-01' and timestamp <= '2022-06-29'\nand context_device_type is not null and context_device_type != '' and user_id is not null) where rn = 1),\n\ncte_is_active_on_website as \n(select user_id, is_active_on_website from \n(select user_id, \n(CASE WHEN user_id IN(select user_id from analytics_db.data_apps_simulated.identifies where context_device_type like '%PC')\n      THEN TRUE\n      ELSE FALSE\n      END)\nas is_active_on_website, row_number() over(partition by user_id order by timestamp desc) as rn from \nanalytics_db.data_apps_simulated.identifies where timestamp >= '2021-05-01' and timestamp <= '2022-06-29'\nand context_device_type is not null and context_device_type != '' and user_id is not null) where rn = 1),\n\ncte_device_type as \n(select user_id, device_type from \n(select user_id, context_device_type as device_type, row_number() over(partition by user_id order by timestamp desc) as rn from \nanalytics_db.data_apps_simulated.identifies where timestamp >= '2021-05-01' and timestamp <= '2022-06-29'\nand device_type is not null and device_type != '') where rn = 1)\n\nselect coalesce(a.user_id, b.user_id, c.user_id, d.user_id, e.user_id, f.user_id, g.user_id, h.user_id, i.user_id) \nas user_id, gender, age, country, state, email_domain, is_member, has_mobile_app, is_active_on_website, device_type\nfrom ((((((((cte_gender a full outer join cte_age b on a.user_id = b.user_id) \nfull outer join cte_country c on c.user_id = coalesce(a.user_id, b.user_id))\nfull outer join cte_state d on d.user_id = coalesce(a.user_id, b.user_id, c.user_id))\nfull outer join cte_email_domain e on e.user_id = coalesce(a.user_id, b.user_id, c.user_id,d.user_id))\nfull outer join cte_is_member f on f.user_id = coalesce(a.user_id, b.user_id, c.user_id,d.user_id, e.user_id))\nfull outer join cte_has_mobile_app g on g.user_id = coalesce(a.user_id, b.user_id, c.user_id,d.user_id, e.user_id, f.user_id))\nfull outer join cte_is_active_on_website as h on h.user_id = coalesce(a.user_id, b.user_id, c.user_id,d.user_id, e.user_id, f.user_id, g.user_id))\nfull outer join cte_device_type as i on i.user_id = coalesce(a.user_id, b.user_id, c.user_id,d.user_id, e.user_id, f.user_id, g.user_id, h.user_id))\nwhere user_id is not null\nlimit 500\n/* limit added automatically by dbt cloud */", 'tags': None}, None)
Traceback (most recent call last):
  File "/usr/local/lib/python3.8/dist-packages/dbt_rpc/task/sql_commands.py", line 147, in _in_thread
    self.node_results.append(runner.safe_run(self.manifest))
  File "/usr/local/lib/python3.8/dist-packages/dbt/task/base.py", line 377, in safe_run
    result = self.error_result(ctx.node, error, started, [])
  File "/usr/local/lib/python3.8/dist-packages/dbt_rpc/rpc/node_runners.py", line 56, in error_result
    raise error
dbt_rpc.rpc.error.RPCException: RPCException(10003, Database Error, {'type': 'DatabaseException', 'message': "Database Error in rpc request (from remote system)\n  002028 (42601): SQL compilation error:\n  ambiguous column name 'USER_ID'", 'raw_sql': "with cte_gender as \n(select user_id, gender from \n(select user_id, properties_gender as gender, row_number() over(partition by user_id order by timestamp desc) as rn from \n{{ source('ecommerce', 'identifies') }} where timestamp >= '{{ var('start_date') }}' and timestamp <= '{{ var('end_date') }}'\nand properties_gender is not null and properties_gender != '') where rn = 1),\n\ncte_age as \n(select user_id, age from\n(select user_id, \n(CASE WHEN dateadd(year, datediff (year, properties_birthday, getdate()), properties_birthday) > getdate()\n      THEN datediff(year, properties_birthday, getdate()) - 1\n      ELSE datediff(year, properties_birthday, getdate())\n END) as age, row_number() over(partition by user_id order by timestamp desc) as rn \nfrom {{ source('ecommerce', 'identifies') }} where timestamp >= '{{ var('start_date') }}' and timestamp <= '{{ var('end_date') }}'\nand properties_birthday is not null and properties_birthday!='') where rn = 1),\n\ncte_country as \n(select user_id, country from \n(select user_id, properties_country as country, row_number() over(partition by user_id order by timestamp desc) as rn from \n{{ source('ecommerce', 'identifies') }} where timestamp >= '{{ var('start_date') }}' and timestamp <= '{{ var('end_date') }}'\nand properties_country is not null and properties_country != '') where rn = 1),\n\ncte_state as \n(select user_id, state from \n(select user_id, properties_state as state, row_number() over(partition by user_id order by timestamp desc) as rn from \n{{ source('ecommerce', 'identifies') }} where timestamp >= '{{ var('start_date') }}' and timestamp <= '{{ var('end_date') }}'\nand properties_state is not null and properties_state != '') where rn = 1),\n\ncte_email_domain as \n(select user_id, email_domain from \n(select user_id, substring(properties_email, charindex( '@', properties_email) + 1, len(properties_email)) as email_domain, row_number() over(partition by user_id order by timestamp desc) as rn from \n{{ source('ecommerce', 'identifies') }} where timestamp >= '{{ var('start_date') }}' and timestamp <= '{{ var('end_date') }}'\nand properties_email is not null and properties_email != '') where rn = 1),\n\ncte_is_member as \n(select user_id, is_member from\n(select user_id, \n(CASE WHEN properties_is_member = TRUE\n      THEN TRUE\n      ELSE FALSE\nEND) as is_member, row_number() over(partition by user_id order by timestamp desc) as rn from \n{{ source('ecommerce', 'identifies') }} where timestamp >= '{{ var('start_date') }}' and timestamp <= '{{ var('end_date') }}'\nand user_id is not null) where rn = 1),\n\ncte_has_mobile_app as \n(select user_id, has_mobile_app from \n(select user_id, \n(CASE WHEN user_id IN(select user_id from {{ source('ecommerce', 'identifies') }} where context_device_type  = 'android' or context_device_type = 'iOS')\n      THEN TRUE\n      ELSE FALSE\n      END) as has_mobile_app, row_number() over(partition by user_id order by timestamp desc) as rn from \n{{ source('ecommerce', 'identifies') }} where timestamp >= '{{ var('start_date') }}' and timestamp <= '{{ var('end_date') }}'\nand context_device_type is not null and context_device_type != '' and user_id is not null) where rn = 1),\n\ncte_is_active_on_website as \n(select user_id, is_active_on_website from \n(select user_id, \n(CASE WHEN user_id IN(select user_id from {{ source('ecommerce', 'identifies') }} where context_device_type like '%PC')\n      THEN TRUE\n      ELSE FALSE\n      END)\nas is_active_on_website, row_number() over(partition by user_id order by timestamp desc) as rn from \n{{ source('ecommerce', 'identifies') }} where timestamp >= '{{ var('start_date') }}' and timestamp <= '{{ var('end_date') }}'\nand context_device_type is not null and context_device_type != '' and user_id is not null) where rn = 1),\n\ncte_device_type as \n(select user_id, device_type from \n(select user_id, context_device_type as device_type, row_number() over(partition by user_id order by timestamp desc) as rn from \n{{ source('ecommerce', 'identifies') }} where timestamp >= '{{ var('start_date') }}' and timestamp <= '{{ var('end_date') }}'\nand device_type is not null and device_type != '') where rn = 1)\n\nselect coalesce(a.user_id, b.user_id, c.user_id, d.user_id, e.user_id, f.user_id, g.user_id, h.user_id, i.user_id) \nas user_id, gender, age, country, state, email_domain, is_member, has_mobile_app, is_active_on_website, device_type\nfrom ((((((((cte_gender a full outer join cte_age b on a.user_id = b.user_id) \nfull outer join cte_country c on c.user_id = coalesce(a.user_id, b.user_id))\nfull outer join cte_state d on d.user_id = coalesce(a.user_id, b.user_id, c.user_id))\nfull outer join cte_email_domain e on e.user_id = coalesce(a.user_id, b.user_id, c.user_id,d.user_id))\nfull outer join cte_is_member f on f.user_id = coalesce(a.user_id, b.user_id, c.user_id,d.user_id, e.user_id))\nfull outer join cte_has_mobile_app g on g.user_id = coalesce(a.user_id, b.user_id, c.user_id,d.user_id, e.user_id, f.user_id))\nfull outer join cte_is_active_on_website as h on h.user_id = coalesce(a.user_id, b.user_id, c.user_id,d.user_id, e.user_id, f.user_id, g.user_id))\nfull outer join cte_device_type as i on i.user_id = coalesce(a.user_id, b.user_id, c.user_id,d.user_id, e.user_id, f.user_id, g.user_id, h.user_id))\nwhere user_id is not null\nlimit 500\n/* limit added automatically by dbt cloud */", 'compiled_sql': "with cte_gender as \n(select user_id, gender from \n(select user_id, properties_gender as gender, row_number() over(partition by user_id order by timestamp desc) as rn from \nanalytics_db.data_apps_simulated.identifies where timestamp >= '2021-05-01' and timestamp <= '2022-06-29'\nand properties_gender is not null and properties_gender != '') where rn = 1),\n\ncte_age as \n(select user_id, age from\n(select user_id, \n(CASE WHEN dateadd(year, datediff (year, properties_birthday, getdate()), properties_birthday) > getdate()\n      THEN datediff(year, properties_birthday, getdate()) - 1\n      ELSE datediff(year, properties_birthday, getdate())\n END) as age, row_number() over(partition by user_id order by timestamp desc) as rn \nfrom analytics_db.data_apps_simulated.identifies where timestamp >= '2021-05-01' and timestamp <= '2022-06-29'\nand properties_birthday is not null and properties_birthday!='') where rn = 1),\n\ncte_country as \n(select user_id, country from \n(select user_id, properties_country as country, row_number() over(partition by user_id order by timestamp desc) as rn from \nanalytics_db.data_apps_simulated.identifies where timestamp >= '2021-05-01' and timestamp <= '2022-06-29'\nand properties_country is not null and properties_country != '') where rn = 1),\n\ncte_state as \n(select user_id, state from \n(select user_id, properties_state as state, row_number() over(partition by user_id order by timestamp desc) as rn from \nanalytics_db.data_apps_simulated.identifies where timestamp >= '2021-05-01' and timestamp <= '2022-06-29'\nand properties_state is not null and properties_state != '') where rn = 1),\n\ncte_email_domain as \n(select user_id, email_domain from \n(select user_id, substring(properties_email, charindex( '@', properties_email) + 1, len(properties_email)) as email_domain, row_number() over(partition by user_id order by timestamp desc) as rn from \nanalytics_db.data_apps_simulated.identifies where timestamp >= '2021-05-01' and timestamp <= '2022-06-29'\nand properties_email is not null and properties_email != '') where rn = 1),\n\ncte_is_member as \n(select user_id, is_member from\n(select user_id, \n(CASE WHEN properties_is_member = TRUE\n      THEN TRUE\n      ELSE FALSE\nEND) as is_member, row_number() over(partition by user_id order by timestamp desc) as rn from \nanalytics_db.data_apps_simulated.identifies where timestamp >= '2021-05-01' and timestamp <= '2022-06-29'\nand user_id is not null) where rn = 1),\n\ncte_has_mobile_app as \n(select user_id, has_mobile_app from \n(select user_id, \n(CASE WHEN user_id IN(select user_id from analytics_db.data_apps_simulated.identifies where context_device_type  = 'android' or context_device_type = 'iOS')\n      THEN TRUE\n      ELSE FALSE\n      END) as has_mobile_app, row_number() over(partition by user_id order by timestamp desc) as rn from \nanalytics_db.data_apps_simulated.identifies where timestamp >= '2021-05-01' and timestamp <= '2022-06-29'\nand context_device_type is not null and context_device_type != '' and user_id is not null) where rn = 1),\n\ncte_is_active_on_website as \n(select user_id, is_active_on_website from \n(select user_id, \n(CASE WHEN user_id IN(select user_id from analytics_db.data_apps_simulated.identifies where context_device_type like '%PC')\n      THEN TRUE\n      ELSE FALSE\n      END)\nas is_active_on_website, row_number() over(partition by user_id order by timestamp desc) as rn from \nanalytics_db.data_apps_simulated.identifies where timestamp >= '2021-05-01' and timestamp <= '2022-06-29'\nand context_device_type is not null and context_device_type != '' and user_id is not null) where rn = 1),\n\ncte_device_type as \n(select user_id, device_type from \n(select user_id, context_device_type as device_type, row_number() over(partition by user_id order by timestamp desc) as rn from \nanalytics_db.data_apps_simulated.identifies where timestamp >= '2021-05-01' and timestamp <= '2022-06-29'\nand device_type is not null and device_type != '') where rn = 1)\n\nselect coalesce(a.user_id, b.user_id, c.user_id, d.user_id, e.user_id, f.user_id, g.user_id, h.user_id, i.user_id) \nas user_id, gender, age, country, state, email_domain, is_member, has_mobile_app, is_active_on_website, device_type\nfrom ((((((((cte_gender a full outer join cte_age b on a.user_id = b.user_id) \nfull outer join cte_country c on c.user_id = coalesce(a.user_id, b.user_id))\nfull outer join cte_state d on d.user_id = coalesce(a.user_id, b.user_id, c.user_id))\nfull outer join cte_email_domain e on e.user_id = coalesce(a.user_id, b.user_id, c.user_id,d.user_id))\nfull outer join cte_is_member f on f.user_id = coalesce(a.user_id, b.user_id, c.user_id,d.user_id, e.user_id))\nfull outer join cte_has_mobile_app g on g.user_id = coalesce(a.user_id, b.user_id, c.user_id,d.user_id, e.user_id, f.user_id))\nfull outer join cte_is_active_on_website as h on h.user_id = coalesce(a.user_id, b.user_id, c.user_id,d.user_id, e.user_id, f.user_id, g.user_id))\nfull outer join cte_device_type as i on i.user_id = coalesce(a.user_id, b.user_id, c.user_id,d.user_id, e.user_id, f.user_id, g.user_id, h.user_id))\nwhere user_id is not null\nlimit 500\n/* limit added automatically by dbt cloud */", 'tags': None}, None)
2022-07-07 08:28:56.531786 (Thread-184): handling poll request
2022-07-07 08:28:56.532179 (Thread-184): 08:28:56  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '196d9207-3e38-4101-ac43-bc898fbec1a7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f51ec5642e0>]}
2022-07-07 08:28:56.532935 (Thread-184): sending response (<Response 46683 bytes [200 OK]>) to 10.0.41.177
2022-07-07 08:29:17.491371 (Thread-185): handling status request
2022-07-07 08:29:17.491824 (Thread-185): 08:29:17  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '196d9207-3e38-4101-ac43-bc898fbec1a7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f51ec45dd00>]}
2022-07-07 08:29:17.492356 (Thread-185): sending response (<Response 2357 bytes [200 OK]>) to 10.0.41.177
2022-07-07 08:29:17.923925 (Thread-186): handling run_sql request
2022-07-07 08:29:17.924319 (Thread-186): 08:29:17  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '196d9207-3e38-4101-ac43-bc898fbec1a7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f51ec564940>]}
2022-07-07 08:29:20.213328 (Thread-186): sending response (<Response 139 bytes [200 OK]>) to 10.0.41.177
2022-07-07 08:29:20.249967 (MainThread): 08:29:20  Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '869d07da-26b5-4624-b55f-c2c23f1af4d8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f07e8cdbdf0>]}
2022-07-07 08:29:20.250598 (MainThread): 08:29:20  Found 16 models, 0 tests, 0 snapshots, 0 analyses, 181 macros, 0 operations, 0 seed files, 15 sources, 0 exposures, 0 metrics
2022-07-07 08:29:20.251198 (Thread-1): 08:29:20  Acquiring new snowflake connection "rpc.ecommerce_data_model_dbt.request"
2022-07-07 08:29:20.251332 (Thread-1): 08:29:20  Began compiling node rpc.ecommerce_data_model_dbt.request
2022-07-07 08:29:20.251429 (Thread-1): 08:29:20  Compiling rpc.ecommerce_data_model_dbt.request
2022-07-07 08:29:20.259893 (Thread-1): 08:29:20  finished collecting timing info
2022-07-07 08:29:20.260027 (Thread-1): 08:29:20  Began executing node rpc.ecommerce_data_model_dbt.request
2022-07-07 08:29:20.265421 (Thread-1): 08:29:20  Using snowflake connection "rpc.ecommerce_data_model_dbt.request"
2022-07-07 08:29:20.265518 (Thread-1): 08:29:20  On rpc.ecommerce_data_model_dbt.request: with cte_gender as 
(select user_id, gender from 
(select user_id, properties_gender as gender, row_number() over(partition by user_id order by timestamp desc) as rn from 
analytics_db.data_apps_simulated.identifies where timestamp >= '2021-05-01' and timestamp <= '2022-06-29'
and properties_gender is not null and properties_gender != '') where rn = 1),

cte_age as 
(select user_id, age from
(select user_id, 
(CASE WHEN dateadd(year, datediff (year, properties_birthday, getdate()), properties_birthday) > getdate()
      THEN datediff(year, properties_birthday, getdate()) - 1
      ELSE datediff(year, properties_birthday, getdate())
 END) as age, row_number() over(partition by user_id order by timestamp desc) as rn 
from analytics_db.data_apps_simulated.identifies where timestamp >= '2021-05-01' and timestamp <= '2022-06-29'
and properties_birthday is not null and properties_birthday!='') where rn = 1),

cte_country as 
(select user_id, country from 
(select user_id, properties_country as country, row_number() over(partition by user_id order by timestamp desc) as rn from 
analytics_db.data_apps_simulated.identifies where timestamp >= '2021-05-01' and timestamp <= '2022-06-29'
and properties_country is not null and properties_country != '') where rn = 1),

cte_state as 
(select user_id, state from 
(select user_id, properties_state as state, row_number() over(partition by user_id order by timestamp desc) as rn from 
analytics_db.data_apps_simulated.identifies where timestamp >= '2021-05-01' and timestamp <= '2022-06-29'
and properties_state is not null and properties_state != '') where rn = 1),

cte_email_domain as 
(select user_id, email_domain from 
(select user_id, substring(properties_email, charindex( '@', properties_email) + 1, len(properties_email)) as email_domain, row_number() over(partition by user_id order by timestamp desc) as rn from 
analytics_db.data_apps_simulated.identifies where timestamp >= '2021-05-01' and timestamp <= '2022-06-29'
and properties_email is not null and properties_email != '') where rn = 1),

cte_is_member as 
(select user_id, is_member from
(select user_id, 
(CASE WHEN properties_is_member = TRUE
      THEN TRUE
      ELSE FALSE
END) as is_member, row_number() over(partition by user_id order by timestamp desc) as rn from 
analytics_db.data_apps_simulated.identifies where timestamp >= '2021-05-01' and timestamp <= '2022-06-29'
and user_id is not null) where rn = 1),

cte_has_mobile_app as 
(select user_id, has_mobile_app from 
(select user_id, 
(CASE WHEN user_id IN(select user_id from analytics_db.data_apps_simulated.identifies where context_device_type  = 'android' or context_device_type = 'iOS')
      THEN TRUE
      ELSE FALSE
      END) as has_mobile_app, row_number() over(partition by user_id order by timestamp desc) as rn from 
analytics_db.data_apps_simulated.identifies where timestamp >= '2021-05-01' and timestamp <= '2022-06-29'
and context_device_type is not null and context_device_type != '' and user_id is not null) where rn = 1),

cte_is_active_on_website as 
(select user_id, is_active_on_website from 
(select user_id, 
(CASE WHEN user_id IN(select user_id from analytics_db.data_apps_simulated.identifies where context_device_type like '%PC')
      THEN TRUE
      ELSE FALSE
      END)
as is_active_on_website, row_number() over(partition by user_id order by timestamp desc) as rn from 
analytics_db.data_apps_simulated.identifies where timestamp >= '2021-05-01' and timestamp <= '2022-06-29'
and context_device_type is not null and context_device_type != '' and user_id is not null) where rn = 1),

cte_device_type as 
(select user_id, device_type from 
(select user_id, context_device_type as device_type, row_number() over(partition by user_id order by timestamp desc) as rn from 
analytics_db.data_apps_simulated.identifies where timestamp >= '2021-05-01' and timestamp <= '2022-06-29'
and device_type is not null and device_type != '') where rn = 1)

select coalesce(a.user_id, b.user_id, c.user_id, d.user_id, e.user_id, f.user_id, g.user_id, h.user_id, i.user_id) 
as user_id, gender, age, country, state, email_domain, is_member, has_mobile_app, is_active_on_website, device_type
from (((((((cte_gender a full outer join cte_age b on a.user_id = b.user_id) 
full outer join cte_country c on c.user_id = coalesce(a.user_id, b.user_id))
full outer join cte_state d on d.user_id = coalesce(a.user_id, b.user_id, c.user_id))
full outer join cte_email_domain e on e.user_id = coalesce(a.user_id, b.user_id, c.user_id,d.user_id))
full outer join cte_is_member f on f.user_id = coalesce(a.user_id, b.user_id, c.user_id,d.user_id, e.user_id))
full outer join cte_has_mobile_app g on g.user_id = coalesce(a.user_id, b.user_id, c.user_id,d.user_id, e.user_id, f.user_id))
full outer join cte_is_active_on_website as h on h.user_id = coalesce(a.user_id, b.user_id, c.user_id,d.user_id, e.user_id, f.user_id, g.user_id))
full outer join cte_device_type as i on i.user_id = coalesce(a.user_id, b.user_id, c.user_id,d.user_id, e.user_id, f.user_id, g.user_id, h.user_id)
limit 500
/* limit added automatically by dbt cloud */
2022-07-07 08:29:20.265600 (Thread-1): 08:29:20  Opening a new connection, currently in state init
2022-07-07 08:29:20.604828 (Thread-187): handling poll request
2022-07-07 08:29:20.605288 (Thread-187): 08:29:20  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '196d9207-3e38-4101-ac43-bc898fbec1a7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f51ec564940>]}
2022-07-07 08:29:20.606187 (Thread-187): sending response (<Response 8930 bytes [200 OK]>) to 10.0.41.177
2022-07-07 08:29:22.088978 (Thread-188): handling poll request
2022-07-07 08:29:22.089371 (Thread-188): 08:29:22  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '196d9207-3e38-4101-ac43-bc898fbec1a7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f51ec564dc0>]}
2022-07-07 08:29:22.089868 (Thread-188): sending response (<Response 398 bytes [200 OK]>) to 10.0.41.177
2022-07-07 08:29:22.328925 (Thread-1): 08:29:22  SQL status: SUCCESS 6 in 2.06 seconds
2022-07-07 08:29:22.330569 (Thread-1): 08:29:22  finished collecting timing info
2022-07-07 08:29:22.330752 (Thread-1): 08:29:22  On rpc.ecommerce_data_model_dbt.request: Close
2022-07-07 08:29:23.484328 (Thread-189): handling poll request
2022-07-07 08:29:23.484737 (Thread-189): 08:29:23  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '196d9207-3e38-4101-ac43-bc898fbec1a7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f51ec451490>]}
2022-07-07 08:29:23.485735 (Thread-189): sending response (<Response 25847 bytes [200 OK]>) to 10.0.41.177
2022-07-07 08:29:42.452791 (Thread-190): 08:29:42  Partial parsing enabled: 0 files deleted, 1 files added, 0 files changed.
2022-07-07 08:29:42.453231 (Thread-190): 08:29:42  Partial parsing: added file: ecommerce_data_model_dbt://models/data_model/stg_user_traits_new.sql
2022-07-07 08:29:42.457595 (Thread-190): 08:29:42  1699: static parser successfully parsed data_model/stg_user_traits_new.sql
2022-07-07 08:29:42.491516 (Thread-190): 08:29:42  [WARNING]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.data-apps-ecommerce-template.data_model

2022-07-07 08:29:42.496843 (Thread-190): 08:29:42  Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '196d9207-3e38-4101-ac43-bc898fbec1a7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f51ec35fd30>]}
2022-07-07 08:29:43.295161 (Thread-191): handling status request
2022-07-07 08:29:43.295579 (Thread-191): 08:29:43  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '196d9207-3e38-4101-ac43-bc898fbec1a7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f51ec3d1970>]}
2022-07-07 08:29:43.296141 (Thread-191): sending response (<Response 2057 bytes [200 OK]>) to 10.0.41.177
2022-07-07 08:29:43.316147 (Thread-192): handling status request
2022-07-07 08:29:43.316421 (Thread-192): 08:29:43  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '196d9207-3e38-4101-ac43-bc898fbec1a7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f51ec3d1790>]}
2022-07-07 08:29:43.316865 (Thread-192): sending response (<Response 2057 bytes [200 OK]>) to 10.0.41.177
2022-07-07 08:32:06.798917 (Thread-193): 08:32:06  Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
2022-07-07 08:32:06.800339 (Thread-193): 08:32:06  Partial parsing: updated file: ecommerce_data_model_dbt://models/data_model/stg_user_traits_new.sql
2022-07-07 08:32:06.804439 (Thread-193): 08:32:06  1603: static parser failed on data_model/stg_user_traits_new.sql
2022-07-07 08:32:06.813481 (Thread-193): 08:32:06  1602: parser fallback to jinja rendering on data_model/stg_user_traits_new.sql
2022-07-07 08:32:07.574204 (Thread-194): handling status request
2022-07-07 08:32:07.574608 (Thread-194): 08:32:07  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '196d9207-3e38-4101-ac43-bc898fbec1a7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f51ec4b54f0>]}
2022-07-07 08:32:07.575119 (Thread-194): sending response (<Response 1733 bytes [200 OK]>) to 10.0.41.177
2022-07-07 08:32:07.601154 (Thread-195): handling status request
2022-07-07 08:32:07.601427 (Thread-195): 08:32:07  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '196d9207-3e38-4101-ac43-bc898fbec1a7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f51ec4b5070>]}
2022-07-07 08:32:07.601835 (Thread-195): sending response (<Response 1733 bytes [200 OK]>) to 10.0.41.177
2022-07-07 08:32:08.688799 (Thread-196): handling status request
2022-07-07 08:32:08.689239 (Thread-196): 08:32:08  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '196d9207-3e38-4101-ac43-bc898fbec1a7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f51ec2e76d0>]}
2022-07-07 08:32:08.689724 (Thread-196): sending response (<Response 1733 bytes [200 OK]>) to 10.0.41.177
2022-07-07 08:32:09.102002 (Thread-197): handling run_sql request
2022-07-07 08:32:09.102403 (Thread-197): 08:32:09  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '196d9207-3e38-4101-ac43-bc898fbec1a7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f51ec367a30>]}
2022-07-07 08:32:09.102828 (Thread-197): sending response (<Response 864 bytes [200 OK]>) to 10.0.41.177
2022-07-07 08:32:18.928165 (Thread-198): 08:32:18  Partial parsing enabled: 0 files deleted, 0 files added, 2 files changed.
2022-07-07 08:32:18.928634 (Thread-198): 08:32:18  Partial parsing: updated file: ecommerce_data_model_dbt://models/data_model/stg_user_traits.sql
2022-07-07 08:32:18.928877 (Thread-198): 08:32:18  Partial parsing: updated file: ecommerce_data_model_dbt://models/data_model/stg_user_traits_new.sql
2022-07-07 08:32:18.933200 (Thread-198): 08:32:18  1603: static parser failed on data_model/stg_user_traits.sql
2022-07-07 08:32:18.942229 (Thread-198): 08:32:18  1602: parser fallback to jinja rendering on data_model/stg_user_traits.sql
2022-07-07 08:32:18.943766 (Thread-198): 08:32:18  1603: static parser failed on data_model/stg_user_traits_new.sql
2022-07-07 08:32:18.952186 (Thread-198): 08:32:18  1602: parser fallback to jinja rendering on data_model/stg_user_traits_new.sql
2022-07-07 08:32:19.732491 (Thread-199): handling status request
2022-07-07 08:32:19.732909 (Thread-199): 08:32:19  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '196d9207-3e38-4101-ac43-bc898fbec1a7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f51ec1bc910>]}
2022-07-07 08:32:19.733425 (Thread-199): sending response (<Response 2688 bytes [200 OK]>) to 10.0.41.177
2022-07-07 08:32:19.739457 (Thread-200): handling status request
2022-07-07 08:32:19.739804 (Thread-200): 08:32:19  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '196d9207-3e38-4101-ac43-bc898fbec1a7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f51ec1d0910>]}
2022-07-07 08:32:19.740226 (Thread-200): sending response (<Response 2688 bytes [200 OK]>) to 10.0.41.177
2022-07-07 08:32:39.250454 (Thread-201): 08:32:39  Partial parsing enabled: 0 files deleted, 0 files added, 2 files changed.
2022-07-07 08:32:39.390835 (Thread-201): 08:32:39  Partial parsing: updated file: ecommerce_data_model_dbt://models/data_model/stg_user_traits.sql
2022-07-07 08:32:39.391175 (Thread-201): 08:32:39  Partial parsing: updated file: ecommerce_data_model_dbt://models/data_model/stg_user_traits_new.sql
2022-07-07 08:32:39.395501 (Thread-201): 08:32:39  1603: static parser failed on data_model/stg_user_traits.sql
2022-07-07 08:32:39.404847 (Thread-201): 08:32:39  1602: parser fallback to jinja rendering on data_model/stg_user_traits.sql
2022-07-07 08:32:39.406289 (Thread-201): 08:32:39  1603: static parser failed on data_model/stg_user_traits_new.sql
2022-07-07 08:32:39.414559 (Thread-201): 08:32:39  1602: parser fallback to jinja rendering on data_model/stg_user_traits_new.sql
2022-07-07 08:32:39.458355 (Thread-201): 08:32:39  [WARNING]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.data-apps-ecommerce-template.data_model

2022-07-07 08:32:39.463293 (Thread-201): 08:32:39  Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '196d9207-3e38-4101-ac43-bc898fbec1a7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f51ec556610>]}
2022-07-07 08:32:40.042192 (Thread-202): handling status request
2022-07-07 08:32:40.042590 (Thread-202): 08:32:40  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '196d9207-3e38-4101-ac43-bc898fbec1a7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f51ec3a65e0>]}
2022-07-07 08:32:40.043139 (Thread-202): sending response (<Response 3324 bytes [200 OK]>) to 10.0.41.177
2022-07-07 08:32:40.082421 (Thread-203): handling status request
2022-07-07 08:32:40.082691 (Thread-203): 08:32:40  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '196d9207-3e38-4101-ac43-bc898fbec1a7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f51ec3a6400>]}
2022-07-07 08:32:40.083121 (Thread-203): sending response (<Response 3324 bytes [200 OK]>) to 10.0.41.177
2022-07-07 08:32:40.823644 (Thread-204): handling status request
2022-07-07 08:32:40.824053 (Thread-204): 08:32:40  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '196d9207-3e38-4101-ac43-bc898fbec1a7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f51ec3a6250>]}
2022-07-07 08:32:40.824565 (Thread-204): sending response (<Response 3324 bytes [200 OK]>) to 10.0.41.177
2022-07-07 08:32:41.227930 (Thread-205): handling run_sql request
2022-07-07 08:32:41.228314 (Thread-205): 08:32:41  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '196d9207-3e38-4101-ac43-bc898fbec1a7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f51ec3a60a0>]}
2022-07-07 08:32:43.528636 (Thread-205): sending response (<Response 139 bytes [200 OK]>) to 10.0.41.177
2022-07-07 08:32:43.563591 (MainThread): 08:32:43  Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '909a6e85-092d-42f7-a9f5-9dbeaf4ad408', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f250f55efa0>]}
2022-07-07 08:32:43.564143 (MainThread): 08:32:43  Found 17 models, 0 tests, 0 snapshots, 0 analyses, 181 macros, 0 operations, 0 seed files, 15 sources, 0 exposures, 0 metrics
2022-07-07 08:32:43.564731 (Thread-1): 08:32:43  Acquiring new snowflake connection "rpc.ecommerce_data_model_dbt.request"
2022-07-07 08:32:43.564867 (Thread-1): 08:32:43  Began compiling node rpc.ecommerce_data_model_dbt.request
2022-07-07 08:32:43.564963 (Thread-1): 08:32:43  Compiling rpc.ecommerce_data_model_dbt.request
2022-07-07 08:32:43.573022 (Thread-1): 08:32:43  finished collecting timing info
2022-07-07 08:32:43.573154 (Thread-1): 08:32:43  Began executing node rpc.ecommerce_data_model_dbt.request
2022-07-07 08:32:43.578277 (Thread-1): 08:32:43  Using snowflake connection "rpc.ecommerce_data_model_dbt.request"
2022-07-07 08:32:43.578377 (Thread-1): 08:32:43  On rpc.ecommerce_data_model_dbt.request: with cte_gender as ANALYTICS_DB.dbt_ecommerce features.gender,

cte_age as 
(select user_id, age from
(select user_id, 
(CASE WHEN dateadd(year, datediff (year, properties_birthday, getdate()), properties_birthday) > getdate()
      THEN datediff(year, properties_birthday, getdate()) - 1
      ELSE datediff(year, properties_birthday, getdate())
 END) as age, row_number() over(partition by user_id order by timestamp desc) as rn 
from analytics_db.data_apps_simulated.identifies where timestamp >= '2021-05-01' and timestamp <= '2022-06-29'
and properties_birthday is not null and properties_birthday!='') where rn = 1),

cte_country as 
(select user_id, country from 
(select user_id, properties_country as country, row_number() over(partition by user_id order by timestamp desc) as rn from 
analytics_db.data_apps_simulated.identifies where timestamp >= '2021-05-01' and timestamp <= '2022-06-29'
and properties_country is not null and properties_country != '') where rn = 1),

cte_state as 
(select user_id, state from 
(select user_id, properties_state as state, row_number() over(partition by user_id order by timestamp desc) as rn from 
analytics_db.data_apps_simulated.identifies where timestamp >= '2021-05-01' and timestamp <= '2022-06-29'
and properties_state is not null and properties_state != '') where rn = 1),

cte_email_domain as 
(select user_id, email_domain from 
(select user_id, substring(properties_email, charindex( '@', properties_email) + 1, len(properties_email)) as email_domain, row_number() over(partition by user_id order by timestamp desc) as rn from 
analytics_db.data_apps_simulated.identifies where timestamp >= '2021-05-01' and timestamp <= '2022-06-29'
and properties_email is not null and properties_email != '') where rn = 1),

cte_is_member as 
(select user_id, is_member from
(select user_id, 
(CASE WHEN properties_is_member = TRUE
      THEN TRUE
      ELSE FALSE
END) as is_member, row_number() over(partition by user_id order by timestamp desc) as rn from 
analytics_db.data_apps_simulated.identifies where timestamp >= '2021-05-01' and timestamp <= '2022-06-29'
and user_id is not null) where rn = 1),

cte_has_mobile_app as 
(select user_id, has_mobile_app from 
(select user_id, 
(CASE WHEN user_id IN(select user_id from analytics_db.data_apps_simulated.identifies where context_device_type  = 'android' or context_device_type = 'iOS')
      THEN TRUE
      ELSE FALSE
      END) as has_mobile_app, row_number() over(partition by user_id order by timestamp desc) as rn from 
analytics_db.data_apps_simulated.identifies where timestamp >= '2021-05-01' and timestamp <= '2022-06-29'
and context_device_type is not null and context_device_type != '' and user_id is not null) where rn = 1),

cte_is_active_on_website as 
(select user_id, is_active_on_website from 
(select user_id, 
(CASE WHEN user_id IN(select user_id from analytics_db.data_apps_simulated.identifies where context_device_type like '%PC')
      THEN TRUE
      ELSE FALSE
      END)
as is_active_on_website, row_number() over(partition by user_id order by timestamp desc) as rn from 
analytics_db.data_apps_simulated.identifies where timestamp >= '2021-05-01' and timestamp <= '2022-06-29'
and context_device_type is not null and context_device_type != '' and user_id is not null) where rn = 1),

cte_device_type as 
(select user_id, device_type from 
(select user_id, context_device_type as device_type, row_number() over(partition by user_id order by timestamp desc) as rn from 
analytics_db.data_apps_simulated.identifies where timestamp >= '2021-05-01' and timestamp <= '2022-06-29'
and device_type is not null and device_type != '') where rn = 1)

select coalesce(a.user_id, b.user_id, c.user_id, d.user_id, e.user_id, f.user_id, g.user_id, h.user_id, i.user_id) 
as user_id, gender, age, country, state, email_domain, is_member, has_mobile_app, is_active_on_website, device_type
from (((((((cte_gender a full outer join cte_age b on a.user_id = b.user_id) 
full outer join cte_country c on c.user_id = coalesce(a.user_id, b.user_id))
full outer join cte_state d on d.user_id = coalesce(a.user_id, b.user_id, c.user_id))
full outer join cte_email_domain e on e.user_id = coalesce(a.user_id, b.user_id, c.user_id,d.user_id))
full outer join cte_is_member f on f.user_id = coalesce(a.user_id, b.user_id, c.user_id,d.user_id, e.user_id))
full outer join cte_has_mobile_app g on g.user_id = coalesce(a.user_id, b.user_id, c.user_id,d.user_id, e.user_id, f.user_id))
full outer join cte_is_active_on_website as h on h.user_id = coalesce(a.user_id, b.user_id, c.user_id,d.user_id, e.user_id, f.user_id, g.user_id))
full outer join cte_device_type as i on i.user_id = coalesce(a.user_id, b.user_id, c.user_id,d.user_id, e.user_id, f.user_id, g.user_id, h.user_id)
limit 500
/* limit added automatically by dbt cloud */
2022-07-07 08:32:43.578460 (Thread-1): 08:32:43  Opening a new connection, currently in state init
2022-07-07 08:32:43.941209 (Thread-206): handling poll request
2022-07-07 08:32:43.941689 (Thread-206): 08:32:43  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '196d9207-3e38-4101-ac43-bc898fbec1a7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f51ec464370>]}
2022-07-07 08:32:43.942626 (Thread-206): sending response (<Response 8647 bytes [200 OK]>) to 10.0.41.177
2022-07-07 08:32:44.286872 (Thread-1): 08:32:44  Snowflake adapter: Snowflake query id: 01a57180-0602-33c1-0019-8203046b676a
2022-07-07 08:32:44.287065 (Thread-1): 08:32:44  Snowflake adapter: Snowflake error: 001003 (42000): SQL compilation error:
syntax error line 1 at position 19 unexpected 'ANALYTICS_DB'.
syntax error line 1 at position 46 unexpected 'features'.
2022-07-07 08:32:44.287222 (Thread-1): 08:32:44  finished collecting timing info
2022-07-07 08:32:44.287382 (Thread-1): 08:32:44  On rpc.ecommerce_data_model_dbt.request: Close
2022-07-07 08:32:44.410231 (Thread-1): Got an exception: Database Error
  001003 (42000): SQL compilation error:
  syntax error line 1 at position 19 unexpected 'ANALYTICS_DB'.
  syntax error line 1 at position 46 unexpected 'features'.
Traceback (most recent call last):
  File "/usr/local/lib/python3.8/dist-packages/dbt/adapters/snowflake/connections.py", line 206, in exception_handler
    yield
  File "/usr/local/lib/python3.8/dist-packages/dbt/adapters/sql/connections.py", line 74, in add_query
    cursor.execute(sql, bindings)
  File "/usr/local/lib/python3.8/dist-packages/snowflake/connector/cursor.py", line 721, in execute
    Error.errorhandler_wrapper(
  File "/usr/local/lib/python3.8/dist-packages/snowflake/connector/errors.py", line 258, in errorhandler_wrapper
    cursor.errorhandler(connection, cursor, error_class, error_value)
  File "/usr/local/lib/python3.8/dist-packages/snowflake/connector/errors.py", line 188, in default_errorhandler
    raise error_class(
snowflake.connector.errors.ProgrammingError: 001003 (42000): SQL compilation error:
syntax error line 1 at position 19 unexpected 'ANALYTICS_DB'.
syntax error line 1 at position 46 unexpected 'features'.

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/usr/local/lib/python3.8/dist-packages/dbt/task/base.py", line 361, in safe_run
    result = self.compile_and_execute(manifest, ctx)
  File "/usr/local/lib/python3.8/dist-packages/dbt/task/base.py", line 314, in compile_and_execute
    result = self.run(ctx.node, manifest)
  File "/usr/local/lib/python3.8/dist-packages/dbt/task/base.py", line 403, in run
    return self.execute(compiled_node, manifest)
  File "/usr/local/lib/python3.8/dist-packages/dbt_rpc/rpc/node_runners.py", line 90, in execute
    _, execute_result = self.adapter.execute(
  File "/usr/local/lib/python3.8/dist-packages/dbt/adapters/base/impl.py", line 225, in execute
    return self.connections.execute(
  File "/usr/local/lib/python3.8/dist-packages/dbt/adapters/sql/connections.py", line 127, in execute
    _, cursor = self.add_query(sql, auto_begin)
  File "/usr/local/lib/python3.8/dist-packages/dbt/adapters/snowflake/connections.py", line 433, in add_query
    connection, cursor = super().add_query(
  File "/usr/local/lib/python3.8/dist-packages/dbt/adapters/sql/connections.py", line 83, in add_query
    return connection, cursor
  File "/usr/lib/python3.8/contextlib.py", line 131, in __exit__
    self.gen.throw(type, value, traceback)
  File "/usr/local/lib/python3.8/dist-packages/dbt/adapters/snowflake/connections.py", line 223, in exception_handler
    raise DatabaseException(msg)
dbt.exceptions.DatabaseException: Database Error
  001003 (42000): SQL compilation error:
  syntax error line 1 at position 19 unexpected 'ANALYTICS_DB'.
  syntax error line 1 at position 46 unexpected 'features'.
2022-07-07 08:32:44.411219 (Thread-1): Got exception RPCException(10003, Database Error, {'type': 'DatabaseException', 'message': "Database Error in rpc request (from remote system)\n  001003 (42000): SQL compilation error:\n  syntax error line 1 at position 19 unexpected 'ANALYTICS_DB'.\n  syntax error line 1 at position 46 unexpected 'features'.", 'raw_sql': "with cte_gender as {{ ref('gender') }},\r\n\r\ncte_age as \r\n(select user_id, age from\r\n(select user_id, \r\n(CASE WHEN dateadd(year, datediff (year, properties_birthday, getdate()), properties_birthday) > getdate()\r\n      THEN datediff(year, properties_birthday, getdate()) - 1\r\n      ELSE datediff(year, properties_birthday, getdate())\r\n END) as age, row_number() over(partition by user_id order by timestamp desc) as rn \r\nfrom {{ source('ecommerce', 'identifies') }} where timestamp >= '{{ var('start_date') }}' and timestamp <= '{{ var('end_date') }}'\r\nand properties_birthday is not null and properties_birthday!='') where rn = 1),\r\n\r\ncte_country as \r\n(select user_id, country from \r\n(select user_id, properties_country as country, row_number() over(partition by user_id order by timestamp desc) as rn from \r\n{{ source('ecommerce', 'identifies') }} where timestamp >= '{{ var('start_date') }}' and timestamp <= '{{ var('end_date') }}'\r\nand properties_country is not null and properties_country != '') where rn = 1),\r\n\r\ncte_state as \r\n(select user_id, state from \r\n(select user_id, properties_state as state, row_number() over(partition by user_id order by timestamp desc) as rn from \r\n{{ source('ecommerce', 'identifies') }} where timestamp >= '{{ var('start_date') }}' and timestamp <= '{{ var('end_date') }}'\r\nand properties_state is not null and properties_state != '') where rn = 1),\r\n\r\ncte_email_domain as \r\n(select user_id, email_domain from \r\n(select user_id, substring(properties_email, charindex( '@', properties_email) + 1, len(properties_email)) as email_domain, row_number() over(partition by user_id order by timestamp desc) as rn from \r\n{{ source('ecommerce', 'identifies') }} where timestamp >= '{{ var('start_date') }}' and timestamp <= '{{ var('end_date') }}'\r\nand properties_email is not null and properties_email != '') where rn = 1),\r\n\r\ncte_is_member as \r\n(select user_id, is_member from\r\n(select user_id, \r\n(CASE WHEN properties_is_member = TRUE\r\n      THEN TRUE\r\n      ELSE FALSE\r\nEND) as is_member, row_number() over(partition by user_id order by timestamp desc) as rn from \r\n{{ source('ecommerce', 'identifies') }} where timestamp >= '{{ var('start_date') }}' and timestamp <= '{{ var('end_date') }}'\r\nand user_id is not null) where rn = 1),\r\n\r\ncte_has_mobile_app as \r\n(select user_id, has_mobile_app from \r\n(select user_id, \r\n(CASE WHEN user_id IN(select user_id from {{ source('ecommerce', 'identifies') }} where context_device_type  = 'android' or context_device_type = 'iOS')\r\n      THEN TRUE\r\n      ELSE FALSE\r\n      END) as has_mobile_app, row_number() over(partition by user_id order by timestamp desc) as rn from \r\n{{ source('ecommerce', 'identifies') }} where timestamp >= '{{ var('start_date') }}' and timestamp <= '{{ var('end_date') }}'\r\nand context_device_type is not null and context_device_type != '' and user_id is not null) where rn = 1),\r\n\r\ncte_is_active_on_website as \r\n(select user_id, is_active_on_website from \r\n(select user_id, \r\n(CASE WHEN user_id IN(select user_id from {{ source('ecommerce', 'identifies') }} where context_device_type like '%PC')\r\n      THEN TRUE\r\n      ELSE FALSE\r\n      END)\r\nas is_active_on_website, row_number() over(partition by user_id order by timestamp desc) as rn from \r\n{{ source('ecommerce', 'identifies') }} where timestamp >= '{{ var('start_date') }}' and timestamp <= '{{ var('end_date') }}'\r\nand context_device_type is not null and context_device_type != '' and user_id is not null) where rn = 1),\r\n\r\ncte_device_type as \r\n(select user_id, device_type from \r\n(select user_id, context_device_type as device_type, row_number() over(partition by user_id order by timestamp desc) as rn from \r\n{{ source('ecommerce', 'identifies') }} where timestamp >= '{{ var('start_date') }}' and timestamp <= '{{ var('end_date') }}'\r\nand device_type is not null and device_type != '') where rn = 1)\r\n\r\nselect coalesce(a.user_id, b.user_id, c.user_id, d.user_id, e.user_id, f.user_id, g.user_id, h.user_id, i.user_id) \r\nas user_id, gender, age, country, state, email_domain, is_member, has_mobile_app, is_active_on_website, device_type\r\nfrom (((((((cte_gender a full outer join cte_age b on a.user_id = b.user_id) \r\nfull outer join cte_country c on c.user_id = coalesce(a.user_id, b.user_id))\r\nfull outer join cte_state d on d.user_id = coalesce(a.user_id, b.user_id, c.user_id))\r\nfull outer join cte_email_domain e on e.user_id = coalesce(a.user_id, b.user_id, c.user_id,d.user_id))\r\nfull outer join cte_is_member f on f.user_id = coalesce(a.user_id, b.user_id, c.user_id,d.user_id, e.user_id))\r\nfull outer join cte_has_mobile_app g on g.user_id = coalesce(a.user_id, b.user_id, c.user_id,d.user_id, e.user_id, f.user_id))\r\nfull outer join cte_is_active_on_website as h on h.user_id = coalesce(a.user_id, b.user_id, c.user_id,d.user_id, e.user_id, f.user_id, g.user_id))\r\nfull outer join cte_device_type as i on i.user_id = coalesce(a.user_id, b.user_id, c.user_id,d.user_id, e.user_id, f.user_id, g.user_id, h.user_id)\nlimit 500\n/* limit added automatically by dbt cloud */", 'compiled_sql': "with cte_gender as ANALYTICS_DB.dbt_ecommerce features.gender,\n\ncte_age as \n(select user_id, age from\n(select user_id, \n(CASE WHEN dateadd(year, datediff (year, properties_birthday, getdate()), properties_birthday) > getdate()\n      THEN datediff(year, properties_birthday, getdate()) - 1\n      ELSE datediff(year, properties_birthday, getdate())\n END) as age, row_number() over(partition by user_id order by timestamp desc) as rn \nfrom analytics_db.data_apps_simulated.identifies where timestamp >= '2021-05-01' and timestamp <= '2022-06-29'\nand properties_birthday is not null and properties_birthday!='') where rn = 1),\n\ncte_country as \n(select user_id, country from \n(select user_id, properties_country as country, row_number() over(partition by user_id order by timestamp desc) as rn from \nanalytics_db.data_apps_simulated.identifies where timestamp >= '2021-05-01' and timestamp <= '2022-06-29'\nand properties_country is not null and properties_country != '') where rn = 1),\n\ncte_state as \n(select user_id, state from \n(select user_id, properties_state as state, row_number() over(partition by user_id order by timestamp desc) as rn from \nanalytics_db.data_apps_simulated.identifies where timestamp >= '2021-05-01' and timestamp <= '2022-06-29'\nand properties_state is not null and properties_state != '') where rn = 1),\n\ncte_email_domain as \n(select user_id, email_domain from \n(select user_id, substring(properties_email, charindex( '@', properties_email) + 1, len(properties_email)) as email_domain, row_number() over(partition by user_id order by timestamp desc) as rn from \nanalytics_db.data_apps_simulated.identifies where timestamp >= '2021-05-01' and timestamp <= '2022-06-29'\nand properties_email is not null and properties_email != '') where rn = 1),\n\ncte_is_member as \n(select user_id, is_member from\n(select user_id, \n(CASE WHEN properties_is_member = TRUE\n      THEN TRUE\n      ELSE FALSE\nEND) as is_member, row_number() over(partition by user_id order by timestamp desc) as rn from \nanalytics_db.data_apps_simulated.identifies where timestamp >= '2021-05-01' and timestamp <= '2022-06-29'\nand user_id is not null) where rn = 1),\n\ncte_has_mobile_app as \n(select user_id, has_mobile_app from \n(select user_id, \n(CASE WHEN user_id IN(select user_id from analytics_db.data_apps_simulated.identifies where context_device_type  = 'android' or context_device_type = 'iOS')\n      THEN TRUE\n      ELSE FALSE\n      END) as has_mobile_app, row_number() over(partition by user_id order by timestamp desc) as rn from \nanalytics_db.data_apps_simulated.identifies where timestamp >= '2021-05-01' and timestamp <= '2022-06-29'\nand context_device_type is not null and context_device_type != '' and user_id is not null) where rn = 1),\n\ncte_is_active_on_website as \n(select user_id, is_active_on_website from \n(select user_id, \n(CASE WHEN user_id IN(select user_id from analytics_db.data_apps_simulated.identifies where context_device_type like '%PC')\n      THEN TRUE\n      ELSE FALSE\n      END)\nas is_active_on_website, row_number() over(partition by user_id order by timestamp desc) as rn from \nanalytics_db.data_apps_simulated.identifies where timestamp >= '2021-05-01' and timestamp <= '2022-06-29'\nand context_device_type is not null and context_device_type != '' and user_id is not null) where rn = 1),\n\ncte_device_type as \n(select user_id, device_type from \n(select user_id, context_device_type as device_type, row_number() over(partition by user_id order by timestamp desc) as rn from \nanalytics_db.data_apps_simulated.identifies where timestamp >= '2021-05-01' and timestamp <= '2022-06-29'\nand device_type is not null and device_type != '') where rn = 1)\n\nselect coalesce(a.user_id, b.user_id, c.user_id, d.user_id, e.user_id, f.user_id, g.user_id, h.user_id, i.user_id) \nas user_id, gender, age, country, state, email_domain, is_member, has_mobile_app, is_active_on_website, device_type\nfrom (((((((cte_gender a full outer join cte_age b on a.user_id = b.user_id) \nfull outer join cte_country c on c.user_id = coalesce(a.user_id, b.user_id))\nfull outer join cte_state d on d.user_id = coalesce(a.user_id, b.user_id, c.user_id))\nfull outer join cte_email_domain e on e.user_id = coalesce(a.user_id, b.user_id, c.user_id,d.user_id))\nfull outer join cte_is_member f on f.user_id = coalesce(a.user_id, b.user_id, c.user_id,d.user_id, e.user_id))\nfull outer join cte_has_mobile_app g on g.user_id = coalesce(a.user_id, b.user_id, c.user_id,d.user_id, e.user_id, f.user_id))\nfull outer join cte_is_active_on_website as h on h.user_id = coalesce(a.user_id, b.user_id, c.user_id,d.user_id, e.user_id, f.user_id, g.user_id))\nfull outer join cte_device_type as i on i.user_id = coalesce(a.user_id, b.user_id, c.user_id,d.user_id, e.user_id, f.user_id, g.user_id, h.user_id)\nlimit 500\n/* limit added automatically by dbt cloud */", 'tags': None}, None)
Traceback (most recent call last):
  File "/usr/local/lib/python3.8/dist-packages/dbt_rpc/task/sql_commands.py", line 147, in _in_thread
    self.node_results.append(runner.safe_run(self.manifest))
  File "/usr/local/lib/python3.8/dist-packages/dbt/task/base.py", line 377, in safe_run
    result = self.error_result(ctx.node, error, started, [])
  File "/usr/local/lib/python3.8/dist-packages/dbt_rpc/rpc/node_runners.py", line 56, in error_result
    raise error
dbt_rpc.rpc.error.RPCException: RPCException(10003, Database Error, {'type': 'DatabaseException', 'message': "Database Error in rpc request (from remote system)\n  001003 (42000): SQL compilation error:\n  syntax error line 1 at position 19 unexpected 'ANALYTICS_DB'.\n  syntax error line 1 at position 46 unexpected 'features'.", 'raw_sql': "with cte_gender as {{ ref('gender') }},\r\n\r\ncte_age as \r\n(select user_id, age from\r\n(select user_id, \r\n(CASE WHEN dateadd(year, datediff (year, properties_birthday, getdate()), properties_birthday) > getdate()\r\n      THEN datediff(year, properties_birthday, getdate()) - 1\r\n      ELSE datediff(year, properties_birthday, getdate())\r\n END) as age, row_number() over(partition by user_id order by timestamp desc) as rn \r\nfrom {{ source('ecommerce', 'identifies') }} where timestamp >= '{{ var('start_date') }}' and timestamp <= '{{ var('end_date') }}'\r\nand properties_birthday is not null and properties_birthday!='') where rn = 1),\r\n\r\ncte_country as \r\n(select user_id, country from \r\n(select user_id, properties_country as country, row_number() over(partition by user_id order by timestamp desc) as rn from \r\n{{ source('ecommerce', 'identifies') }} where timestamp >= '{{ var('start_date') }}' and timestamp <= '{{ var('end_date') }}'\r\nand properties_country is not null and properties_country != '') where rn = 1),\r\n\r\ncte_state as \r\n(select user_id, state from \r\n(select user_id, properties_state as state, row_number() over(partition by user_id order by timestamp desc) as rn from \r\n{{ source('ecommerce', 'identifies') }} where timestamp >= '{{ var('start_date') }}' and timestamp <= '{{ var('end_date') }}'\r\nand properties_state is not null and properties_state != '') where rn = 1),\r\n\r\ncte_email_domain as \r\n(select user_id, email_domain from \r\n(select user_id, substring(properties_email, charindex( '@', properties_email) + 1, len(properties_email)) as email_domain, row_number() over(partition by user_id order by timestamp desc) as rn from \r\n{{ source('ecommerce', 'identifies') }} where timestamp >= '{{ var('start_date') }}' and timestamp <= '{{ var('end_date') }}'\r\nand properties_email is not null and properties_email != '') where rn = 1),\r\n\r\ncte_is_member as \r\n(select user_id, is_member from\r\n(select user_id, \r\n(CASE WHEN properties_is_member = TRUE\r\n      THEN TRUE\r\n      ELSE FALSE\r\nEND) as is_member, row_number() over(partition by user_id order by timestamp desc) as rn from \r\n{{ source('ecommerce', 'identifies') }} where timestamp >= '{{ var('start_date') }}' and timestamp <= '{{ var('end_date') }}'\r\nand user_id is not null) where rn = 1),\r\n\r\ncte_has_mobile_app as \r\n(select user_id, has_mobile_app from \r\n(select user_id, \r\n(CASE WHEN user_id IN(select user_id from {{ source('ecommerce', 'identifies') }} where context_device_type  = 'android' or context_device_type = 'iOS')\r\n      THEN TRUE\r\n      ELSE FALSE\r\n      END) as has_mobile_app, row_number() over(partition by user_id order by timestamp desc) as rn from \r\n{{ source('ecommerce', 'identifies') }} where timestamp >= '{{ var('start_date') }}' and timestamp <= '{{ var('end_date') }}'\r\nand context_device_type is not null and context_device_type != '' and user_id is not null) where rn = 1),\r\n\r\ncte_is_active_on_website as \r\n(select user_id, is_active_on_website from \r\n(select user_id, \r\n(CASE WHEN user_id IN(select user_id from {{ source('ecommerce', 'identifies') }} where context_device_type like '%PC')\r\n      THEN TRUE\r\n      ELSE FALSE\r\n      END)\r\nas is_active_on_website, row_number() over(partition by user_id order by timestamp desc) as rn from \r\n{{ source('ecommerce', 'identifies') }} where timestamp >= '{{ var('start_date') }}' and timestamp <= '{{ var('end_date') }}'\r\nand context_device_type is not null and context_device_type != '' and user_id is not null) where rn = 1),\r\n\r\ncte_device_type as \r\n(select user_id, device_type from \r\n(select user_id, context_device_type as device_type, row_number() over(partition by user_id order by timestamp desc) as rn from \r\n{{ source('ecommerce', 'identifies') }} where timestamp >= '{{ var('start_date') }}' and timestamp <= '{{ var('end_date') }}'\r\nand device_type is not null and device_type != '') where rn = 1)\r\n\r\nselect coalesce(a.user_id, b.user_id, c.user_id, d.user_id, e.user_id, f.user_id, g.user_id, h.user_id, i.user_id) \r\nas user_id, gender, age, country, state, email_domain, is_member, has_mobile_app, is_active_on_website, device_type\r\nfrom (((((((cte_gender a full outer join cte_age b on a.user_id = b.user_id) \r\nfull outer join cte_country c on c.user_id = coalesce(a.user_id, b.user_id))\r\nfull outer join cte_state d on d.user_id = coalesce(a.user_id, b.user_id, c.user_id))\r\nfull outer join cte_email_domain e on e.user_id = coalesce(a.user_id, b.user_id, c.user_id,d.user_id))\r\nfull outer join cte_is_member f on f.user_id = coalesce(a.user_id, b.user_id, c.user_id,d.user_id, e.user_id))\r\nfull outer join cte_has_mobile_app g on g.user_id = coalesce(a.user_id, b.user_id, c.user_id,d.user_id, e.user_id, f.user_id))\r\nfull outer join cte_is_active_on_website as h on h.user_id = coalesce(a.user_id, b.user_id, c.user_id,d.user_id, e.user_id, f.user_id, g.user_id))\r\nfull outer join cte_device_type as i on i.user_id = coalesce(a.user_id, b.user_id, c.user_id,d.user_id, e.user_id, f.user_id, g.user_id, h.user_id)\nlimit 500\n/* limit added automatically by dbt cloud */", 'compiled_sql': "with cte_gender as ANALYTICS_DB.dbt_ecommerce features.gender,\n\ncte_age as \n(select user_id, age from\n(select user_id, \n(CASE WHEN dateadd(year, datediff (year, properties_birthday, getdate()), properties_birthday) > getdate()\n      THEN datediff(year, properties_birthday, getdate()) - 1\n      ELSE datediff(year, properties_birthday, getdate())\n END) as age, row_number() over(partition by user_id order by timestamp desc) as rn \nfrom analytics_db.data_apps_simulated.identifies where timestamp >= '2021-05-01' and timestamp <= '2022-06-29'\nand properties_birthday is not null and properties_birthday!='') where rn = 1),\n\ncte_country as \n(select user_id, country from \n(select user_id, properties_country as country, row_number() over(partition by user_id order by timestamp desc) as rn from \nanalytics_db.data_apps_simulated.identifies where timestamp >= '2021-05-01' and timestamp <= '2022-06-29'\nand properties_country is not null and properties_country != '') where rn = 1),\n\ncte_state as \n(select user_id, state from \n(select user_id, properties_state as state, row_number() over(partition by user_id order by timestamp desc) as rn from \nanalytics_db.data_apps_simulated.identifies where timestamp >= '2021-05-01' and timestamp <= '2022-06-29'\nand properties_state is not null and properties_state != '') where rn = 1),\n\ncte_email_domain as \n(select user_id, email_domain from \n(select user_id, substring(properties_email, charindex( '@', properties_email) + 1, len(properties_email)) as email_domain, row_number() over(partition by user_id order by timestamp desc) as rn from \nanalytics_db.data_apps_simulated.identifies where timestamp >= '2021-05-01' and timestamp <= '2022-06-29'\nand properties_email is not null and properties_email != '') where rn = 1),\n\ncte_is_member as \n(select user_id, is_member from\n(select user_id, \n(CASE WHEN properties_is_member = TRUE\n      THEN TRUE\n      ELSE FALSE\nEND) as is_member, row_number() over(partition by user_id order by timestamp desc) as rn from \nanalytics_db.data_apps_simulated.identifies where timestamp >= '2021-05-01' and timestamp <= '2022-06-29'\nand user_id is not null) where rn = 1),\n\ncte_has_mobile_app as \n(select user_id, has_mobile_app from \n(select user_id, \n(CASE WHEN user_id IN(select user_id from analytics_db.data_apps_simulated.identifies where context_device_type  = 'android' or context_device_type = 'iOS')\n      THEN TRUE\n      ELSE FALSE\n      END) as has_mobile_app, row_number() over(partition by user_id order by timestamp desc) as rn from \nanalytics_db.data_apps_simulated.identifies where timestamp >= '2021-05-01' and timestamp <= '2022-06-29'\nand context_device_type is not null and context_device_type != '' and user_id is not null) where rn = 1),\n\ncte_is_active_on_website as \n(select user_id, is_active_on_website from \n(select user_id, \n(CASE WHEN user_id IN(select user_id from analytics_db.data_apps_simulated.identifies where context_device_type like '%PC')\n      THEN TRUE\n      ELSE FALSE\n      END)\nas is_active_on_website, row_number() over(partition by user_id order by timestamp desc) as rn from \nanalytics_db.data_apps_simulated.identifies where timestamp >= '2021-05-01' and timestamp <= '2022-06-29'\nand context_device_type is not null and context_device_type != '' and user_id is not null) where rn = 1),\n\ncte_device_type as \n(select user_id, device_type from \n(select user_id, context_device_type as device_type, row_number() over(partition by user_id order by timestamp desc) as rn from \nanalytics_db.data_apps_simulated.identifies where timestamp >= '2021-05-01' and timestamp <= '2022-06-29'\nand device_type is not null and device_type != '') where rn = 1)\n\nselect coalesce(a.user_id, b.user_id, c.user_id, d.user_id, e.user_id, f.user_id, g.user_id, h.user_id, i.user_id) \nas user_id, gender, age, country, state, email_domain, is_member, has_mobile_app, is_active_on_website, device_type\nfrom (((((((cte_gender a full outer join cte_age b on a.user_id = b.user_id) \nfull outer join cte_country c on c.user_id = coalesce(a.user_id, b.user_id))\nfull outer join cte_state d on d.user_id = coalesce(a.user_id, b.user_id, c.user_id))\nfull outer join cte_email_domain e on e.user_id = coalesce(a.user_id, b.user_id, c.user_id,d.user_id))\nfull outer join cte_is_member f on f.user_id = coalesce(a.user_id, b.user_id, c.user_id,d.user_id, e.user_id))\nfull outer join cte_has_mobile_app g on g.user_id = coalesce(a.user_id, b.user_id, c.user_id,d.user_id, e.user_id, f.user_id))\nfull outer join cte_is_active_on_website as h on h.user_id = coalesce(a.user_id, b.user_id, c.user_id,d.user_id, e.user_id, f.user_id, g.user_id))\nfull outer join cte_device_type as i on i.user_id = coalesce(a.user_id, b.user_id, c.user_id,d.user_id, e.user_id, f.user_id, g.user_id, h.user_id)\nlimit 500\n/* limit added automatically by dbt cloud */", 'tags': None}, None)
2022-07-07 08:32:45.446954 (Thread-207): handling poll request
2022-07-07 08:32:45.447358 (Thread-207): 08:32:45  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '196d9207-3e38-4101-ac43-bc898fbec1a7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f51ec44b5e0>]}
2022-07-07 08:32:45.448202 (Thread-207): sending response (<Response 45515 bytes [200 OK]>) to 10.0.41.177
2022-07-07 08:32:57.680004 (Thread-208): handling status request
2022-07-07 08:32:57.680414 (Thread-208): 08:32:57  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '196d9207-3e38-4101-ac43-bc898fbec1a7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f51ec44b910>]}
2022-07-07 08:32:57.681064 (Thread-208): sending response (<Response 3324 bytes [200 OK]>) to 10.0.41.177
2022-07-07 08:32:58.137387 (Thread-209): handling compile_sql request
2022-07-07 08:32:58.137801 (Thread-209): 08:32:58  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '196d9207-3e38-4101-ac43-bc898fbec1a7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f51ec44b460>]}
2022-07-07 08:33:00.442924 (Thread-209): sending response (<Response 139 bytes [200 OK]>) to 10.0.41.177
2022-07-07 08:33:00.478662 (MainThread): 08:33:00  Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '80faf4fc-04a2-4801-9c21-a7f45d7a11e9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f96c3fdd520>]}
2022-07-07 08:33:00.479216 (MainThread): 08:33:00  Found 17 models, 0 tests, 0 snapshots, 0 analyses, 181 macros, 0 operations, 0 seed files, 15 sources, 0 exposures, 0 metrics
2022-07-07 08:33:00.479844 (Thread-1): 08:33:00  Acquiring new snowflake connection "rpc.ecommerce_data_model_dbt.request"
2022-07-07 08:33:00.479978 (Thread-1): 08:33:00  Began compiling node rpc.ecommerce_data_model_dbt.request
2022-07-07 08:33:00.480069 (Thread-1): 08:33:00  Compiling rpc.ecommerce_data_model_dbt.request
2022-07-07 08:33:00.488613 (Thread-1): 08:33:00  finished collecting timing info
2022-07-07 08:33:00.488756 (Thread-1): 08:33:00  Began executing node rpc.ecommerce_data_model_dbt.request
2022-07-07 08:33:00.488858 (Thread-1): 08:33:00  finished collecting timing info
2022-07-07 08:33:00.844773 (Thread-210): handling poll request
2022-07-07 08:33:00.845250 (Thread-210): 08:33:00  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '196d9207-3e38-4101-ac43-bc898fbec1a7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f51ec2ae790>]}
2022-07-07 08:33:00.846537 (Thread-210): sending response (<Response 26055 bytes [200 OK]>) to 10.0.41.177
2022-07-07 08:33:52.052283 (Thread-211): handling status request
2022-07-07 08:33:52.052680 (Thread-211): 08:33:52  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '196d9207-3e38-4101-ac43-bc898fbec1a7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f51ec2aeb80>]}
2022-07-07 08:33:52.053829 (Thread-211): sending response (<Response 3324 bytes [200 OK]>) to 10.0.41.177
2022-07-07 08:33:52.460447 (Thread-212): handling run_sql request
2022-07-07 08:33:52.460839 (Thread-212): 08:33:52  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '196d9207-3e38-4101-ac43-bc898fbec1a7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f51ec4374c0>]}
2022-07-07 08:33:54.820952 (Thread-212): sending response (<Response 139 bytes [200 OK]>) to 10.0.41.177
2022-07-07 08:33:54.846705 (MainThread): 08:33:54  Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'c231a57b-5ece-4949-a8bc-96c52c41c687', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa722f1d430>]}
2022-07-07 08:33:54.847208 (MainThread): 08:33:54  Found 17 models, 0 tests, 0 snapshots, 0 analyses, 181 macros, 0 operations, 0 seed files, 15 sources, 0 exposures, 0 metrics
2022-07-07 08:33:54.847809 (Thread-1): 08:33:54  Acquiring new snowflake connection "rpc.ecommerce_data_model_dbt.request"
2022-07-07 08:33:54.847942 (Thread-1): 08:33:54  Began compiling node rpc.ecommerce_data_model_dbt.request
2022-07-07 08:33:54.848040 (Thread-1): 08:33:54  Compiling rpc.ecommerce_data_model_dbt.request
2022-07-07 08:33:54.850180 (Thread-1): 08:33:54  finished collecting timing info
2022-07-07 08:33:54.850312 (Thread-1): 08:33:54  Began executing node rpc.ecommerce_data_model_dbt.request
2022-07-07 08:33:54.850845 (Thread-1): 08:33:54  Using snowflake connection "rpc.ecommerce_data_model_dbt.request"
2022-07-07 08:33:54.850932 (Thread-1): 08:33:54  On rpc.ecommerce_data_model_dbt.request: -- unique_key=['TIMESTAMP', 'user_id']
-- ToDo: unique key should be user_id, timestamp
select * from ANALYTICS_DB.dbt_ecommerce features.stg_products_viewed
limit 500
/* limit added automatically by dbt cloud */
2022-07-07 08:33:54.851010 (Thread-1): 08:33:54  Opening a new connection, currently in state init
2022-07-07 08:33:55.213251 (Thread-213): handling poll request
2022-07-07 08:33:55.213759 (Thread-213): 08:33:55  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '196d9207-3e38-4101-ac43-bc898fbec1a7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f51ec263760>]}
2022-07-07 08:33:55.214669 (Thread-213): sending response (<Response 3954 bytes [200 OK]>) to 10.0.41.177
2022-07-07 08:33:55.497826 (Thread-1): 08:33:55  Snowflake adapter: Snowflake query id: 01a57181-0602-3441-0019-8203046b4ace
2022-07-07 08:33:55.498016 (Thread-1): 08:33:55  Snowflake adapter: Snowflake error: 001003 (42000): SQL compilation error:
syntax error line 1 at position 49 unexpected '.'.
2022-07-07 08:33:55.498184 (Thread-1): 08:33:55  finished collecting timing info
2022-07-07 08:33:55.498351 (Thread-1): 08:33:55  On rpc.ecommerce_data_model_dbt.request: Close
2022-07-07 08:33:55.548184 (Thread-1): Got an exception: Database Error
  001003 (42000): SQL compilation error:
  syntax error line 1 at position 49 unexpected '.'.
Traceback (most recent call last):
  File "/usr/local/lib/python3.8/dist-packages/dbt/adapters/snowflake/connections.py", line 206, in exception_handler
    yield
  File "/usr/local/lib/python3.8/dist-packages/dbt/adapters/sql/connections.py", line 74, in add_query
    cursor.execute(sql, bindings)
  File "/usr/local/lib/python3.8/dist-packages/snowflake/connector/cursor.py", line 721, in execute
    Error.errorhandler_wrapper(
  File "/usr/local/lib/python3.8/dist-packages/snowflake/connector/errors.py", line 258, in errorhandler_wrapper
    cursor.errorhandler(connection, cursor, error_class, error_value)
  File "/usr/local/lib/python3.8/dist-packages/snowflake/connector/errors.py", line 188, in default_errorhandler
    raise error_class(
snowflake.connector.errors.ProgrammingError: 001003 (42000): SQL compilation error:
syntax error line 1 at position 49 unexpected '.'.

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/usr/local/lib/python3.8/dist-packages/dbt/task/base.py", line 361, in safe_run
    result = self.compile_and_execute(manifest, ctx)
  File "/usr/local/lib/python3.8/dist-packages/dbt/task/base.py", line 314, in compile_and_execute
    result = self.run(ctx.node, manifest)
  File "/usr/local/lib/python3.8/dist-packages/dbt/task/base.py", line 403, in run
    return self.execute(compiled_node, manifest)
  File "/usr/local/lib/python3.8/dist-packages/dbt_rpc/rpc/node_runners.py", line 90, in execute
    _, execute_result = self.adapter.execute(
  File "/usr/local/lib/python3.8/dist-packages/dbt/adapters/base/impl.py", line 225, in execute
    return self.connections.execute(
  File "/usr/local/lib/python3.8/dist-packages/dbt/adapters/sql/connections.py", line 127, in execute
    _, cursor = self.add_query(sql, auto_begin)
  File "/usr/local/lib/python3.8/dist-packages/dbt/adapters/snowflake/connections.py", line 433, in add_query
    connection, cursor = super().add_query(
  File "/usr/local/lib/python3.8/dist-packages/dbt/adapters/sql/connections.py", line 83, in add_query
    return connection, cursor
  File "/usr/lib/python3.8/contextlib.py", line 131, in __exit__
    self.gen.throw(type, value, traceback)
  File "/usr/local/lib/python3.8/dist-packages/dbt/adapters/snowflake/connections.py", line 223, in exception_handler
    raise DatabaseException(msg)
dbt.exceptions.DatabaseException: Database Error
  001003 (42000): SQL compilation error:
  syntax error line 1 at position 49 unexpected '.'.
2022-07-07 08:33:55.549027 (Thread-1): Got exception RPCException(10003, Database Error, {'type': 'DatabaseException', 'message': "Database Error in rpc request (from remote system)\n  001003 (42000): SQL compilation error:\n  syntax error line 1 at position 49 unexpected '.'.", 'raw_sql': "{{\n    config(\n        materialized='incremental'\n    )\n}}\n\n-- unique_key=['TIMESTAMP', 'user_id']\n-- ToDo: unique key should be user_id, timestamp\nselect * from {{ ref('stg_products_viewed') }}\nlimit 500\n/* limit added automatically by dbt cloud */", 'compiled_sql': "\n\n-- unique_key=['TIMESTAMP', 'user_id']\n-- ToDo: unique key should be user_id, timestamp\nselect * from ANALYTICS_DB.dbt_ecommerce features.stg_products_viewed\nlimit 500\n/* limit added automatically by dbt cloud */", 'tags': None}, None)
Traceback (most recent call last):
  File "/usr/local/lib/python3.8/dist-packages/dbt_rpc/task/sql_commands.py", line 147, in _in_thread
    self.node_results.append(runner.safe_run(self.manifest))
  File "/usr/local/lib/python3.8/dist-packages/dbt/task/base.py", line 377, in safe_run
    result = self.error_result(ctx.node, error, started, [])
  File "/usr/local/lib/python3.8/dist-packages/dbt_rpc/rpc/node_runners.py", line 56, in error_result
    raise error
dbt_rpc.rpc.error.RPCException: RPCException(10003, Database Error, {'type': 'DatabaseException', 'message': "Database Error in rpc request (from remote system)\n  001003 (42000): SQL compilation error:\n  syntax error line 1 at position 49 unexpected '.'.", 'raw_sql': "{{\n    config(\n        materialized='incremental'\n    )\n}}\n\n-- unique_key=['TIMESTAMP', 'user_id']\n-- ToDo: unique key should be user_id, timestamp\nselect * from {{ ref('stg_products_viewed') }}\nlimit 500\n/* limit added automatically by dbt cloud */", 'compiled_sql': "\n\n-- unique_key=['TIMESTAMP', 'user_id']\n-- ToDo: unique key should be user_id, timestamp\nselect * from ANALYTICS_DB.dbt_ecommerce features.stg_products_viewed\nlimit 500\n/* limit added automatically by dbt cloud */", 'tags': None}, None)
2022-07-07 08:33:56.655367 (Thread-214): handling poll request
2022-07-07 08:33:56.655808 (Thread-214): 08:33:56  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '196d9207-3e38-4101-ac43-bc898fbec1a7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f51ec1d38e0>]}
2022-07-07 08:33:56.656441 (Thread-214): sending response (<Response 11034 bytes [200 OK]>) to 10.0.41.177
2022-07-07 08:36:30.277206 (Thread-215): handling ps request
2022-07-07 08:36:30.277612 (Thread-215): 08:36:30  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '196d9207-3e38-4101-ac43-bc898fbec1a7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f51ec556bb0>]}
2022-07-07 08:36:30.279513 (Thread-215): sending response (<Response 18897 bytes [200 OK]>) to 10.0.41.177
2022-07-07 08:36:30.317910 (Thread-216): handling status request
2022-07-07 08:36:30.318284 (Thread-216): 08:36:30  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '196d9207-3e38-4101-ac43-bc898fbec1a7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f51ec45b940>]}
2022-07-07 08:36:30.318858 (Thread-216): sending response (<Response 3324 bytes [200 OK]>) to 10.0.41.177
2022-07-07 08:36:30.324008 (Thread-217): handling status request
2022-07-07 08:36:30.324272 (Thread-217): 08:36:30  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '196d9207-3e38-4101-ac43-bc898fbec1a7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f51ec45b130>]}
2022-07-07 08:36:30.324740 (Thread-217): sending response (<Response 3324 bytes [200 OK]>) to 10.0.41.177
2022-07-07 08:36:30.451202 (Thread-218): handling status request
2022-07-07 08:36:30.451672 (Thread-218): 08:36:30  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '196d9207-3e38-4101-ac43-bc898fbec1a7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f51ec45b400>]}
2022-07-07 08:36:30.452252 (Thread-218): sending response (<Response 3324 bytes [200 OK]>) to 10.0.41.177
2022-07-07 08:36:31.719260 (Thread-219): handling status request
2022-07-07 08:36:31.719740 (Thread-219): 08:36:31  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '196d9207-3e38-4101-ac43-bc898fbec1a7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f51ec45b310>]}
2022-07-07 08:36:31.720321 (Thread-219): sending response (<Response 3324 bytes [200 OK]>) to 10.0.41.177
2022-07-07 08:36:48.805318 (Thread-220): handling status request
2022-07-07 08:36:48.805712 (Thread-220): 08:36:48  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '196d9207-3e38-4101-ac43-bc898fbec1a7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f51ec556160>]}
2022-07-07 08:36:48.806241 (Thread-220): sending response (<Response 3301 bytes [200 OK]>) to 10.0.41.177
2022-07-07 08:36:48.812553 (Thread-221): handling list request
2022-07-07 08:36:48.812830 (Thread-221): 08:36:48  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '196d9207-3e38-4101-ac43-bc898fbec1a7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f51ec556760>]}
2022-07-07 08:36:48.853987 (Thread-221): 08:36:48  Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '196d9207-3e38-4101-ac43-bc898fbec1a7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f51ec4a9b80>]}
2022-07-07 08:36:48.854293 (Thread-221): 08:36:48  Found 17 models, 0 tests, 0 snapshots, 0 analyses, 181 macros, 0 operations, 0 seed files, 15 sources, 0 exposures, 0 metrics
2022-07-07 08:36:48.855942 (Thread-221): 08:36:48  The selection criterion '+macros/get_domain_from_email.sql+' does not match any nodes
2022-07-07 08:36:48.856107 (Thread-221): 08:36:48  No nodes selected!
2022-07-07 08:36:48.857529 (Thread-221): sending response (<Response 1951 bytes [200 OK]>) to 10.0.41.177
2022-07-07 08:36:49.267939 (Thread-222): handling status request
2022-07-07 08:36:49.268326 (Thread-222): 08:36:49  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '196d9207-3e38-4101-ac43-bc898fbec1a7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f51ec4a9220>]}
2022-07-07 08:36:49.268861 (Thread-222): sending response (<Response 3301 bytes [200 OK]>) to 10.0.41.177
2022-07-07 08:36:49.275315 (Thread-223): handling list request
2022-07-07 08:36:49.275587 (Thread-223): 08:36:49  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '196d9207-3e38-4101-ac43-bc898fbec1a7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f51ec4a9640>]}
2022-07-07 08:36:49.308378 (Thread-223): 08:36:49  Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '196d9207-3e38-4101-ac43-bc898fbec1a7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f51ec44ba60>]}
2022-07-07 08:36:49.308686 (Thread-223): 08:36:49  Found 17 models, 0 tests, 0 snapshots, 0 analyses, 181 macros, 0 operations, 0 seed files, 15 sources, 0 exposures, 0 metrics
2022-07-07 08:36:49.309972 (Thread-223): 08:36:49  The selection criterion '+macros/get_age_from_dob.sql+' does not match any nodes
2022-07-07 08:36:49.310134 (Thread-223): 08:36:49  No nodes selected!
2022-07-07 08:36:49.311543 (Thread-223): sending response (<Response 1946 bytes [200 OK]>) to 10.0.41.177
2022-07-07 08:37:43.171156 (Thread-224): handling status request
2022-07-07 08:37:43.171676 (Thread-224): 08:37:43  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '196d9207-3e38-4101-ac43-bc898fbec1a7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f51ec451a90>]}
2022-07-07 08:37:43.172220 (Thread-224): sending response (<Response 3301 bytes [200 OK]>) to 10.0.41.177
2022-07-07 08:37:43.200583 (Thread-225): handling list request
2022-07-07 08:37:43.200865 (Thread-225): 08:37:43  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '196d9207-3e38-4101-ac43-bc898fbec1a7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f51ec4b5d60>]}
2022-07-07 08:37:43.235117 (Thread-225): 08:37:43  Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '196d9207-3e38-4101-ac43-bc898fbec1a7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f51ec451280>]}
2022-07-07 08:37:43.235420 (Thread-225): 08:37:43  Found 17 models, 0 tests, 0 snapshots, 0 analyses, 181 macros, 0 operations, 0 seed files, 15 sources, 0 exposures, 0 metrics
2022-07-07 08:37:43.242781 (Thread-225): sending response (<Response 3231 bytes [200 OK]>) to 10.0.41.177
2022-07-07 08:37:45.866072 (Thread-226): handling status request
2022-07-07 08:37:45.866487 (Thread-226): 08:37:45  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '196d9207-3e38-4101-ac43-bc898fbec1a7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f51ec3325e0>]}
2022-07-07 08:37:45.867012 (Thread-226): sending response (<Response 3301 bytes [200 OK]>) to 10.0.41.177
2022-07-07 08:37:45.898069 (Thread-227): handling list request
2022-07-07 08:37:45.898391 (Thread-227): 08:37:45  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '196d9207-3e38-4101-ac43-bc898fbec1a7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f51ec332f40>]}
2022-07-07 08:37:45.930690 (Thread-227): 08:37:45  Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '196d9207-3e38-4101-ac43-bc898fbec1a7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f51ec4ad370>]}
2022-07-07 08:37:45.930973 (Thread-227): 08:37:45  Found 17 models, 0 tests, 0 snapshots, 0 analyses, 181 macros, 0 operations, 0 seed files, 15 sources, 0 exposures, 0 metrics
2022-07-07 08:37:45.934415 (Thread-227): sending response (<Response 2627 bytes [200 OK]>) to 10.0.41.177
2022-07-07 08:37:55.610948 (Thread-228): handling status request
2022-07-07 08:37:55.611346 (Thread-228): 08:37:55  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '196d9207-3e38-4101-ac43-bc898fbec1a7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f51ec3325e0>]}
2022-07-07 08:37:55.611933 (Thread-228): sending response (<Response 3324 bytes [200 OK]>) to 10.0.41.177
2022-07-07 08:37:56.006279 (Thread-229): handling compile_sql request
2022-07-07 08:37:56.006686 (Thread-229): 08:37:56  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '196d9207-3e38-4101-ac43-bc898fbec1a7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f51ec332610>]}
2022-07-07 08:37:58.298980 (Thread-229): sending response (<Response 139 bytes [200 OK]>) to 10.0.41.177
2022-07-07 08:37:58.333887 (MainThread): 08:37:58  Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '1369c441-ec61-4120-8f23-60f7a57b34b3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7faea9fdd550>]}
2022-07-07 08:37:58.334412 (MainThread): 08:37:58  Found 17 models, 0 tests, 0 snapshots, 0 analyses, 181 macros, 0 operations, 0 seed files, 15 sources, 0 exposures, 0 metrics
2022-07-07 08:37:58.334989 (Thread-1): 08:37:58  Acquiring new snowflake connection "rpc.ecommerce_data_model_dbt.request"
2022-07-07 08:37:58.335120 (Thread-1): 08:37:58  Began compiling node rpc.ecommerce_data_model_dbt.request
2022-07-07 08:37:58.335212 (Thread-1): 08:37:58  Compiling rpc.ecommerce_data_model_dbt.request
2022-07-07 08:37:58.343349 (Thread-1): 08:37:58  finished collecting timing info
2022-07-07 08:37:58.343481 (Thread-1): 08:37:58  Began executing node rpc.ecommerce_data_model_dbt.request
2022-07-07 08:37:58.343579 (Thread-1): 08:37:58  finished collecting timing info
2022-07-07 08:37:58.703866 (Thread-230): handling poll request
2022-07-07 08:37:58.704320 (Thread-230): 08:37:58  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '196d9207-3e38-4101-ac43-bc898fbec1a7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f51ec35f280>]}
2022-07-07 08:37:58.705595 (Thread-230): sending response (<Response 26055 bytes [200 OK]>) to 10.0.41.177
2022-07-07 08:41:46.568200 (Thread-231): handling status request
2022-07-07 08:41:46.569642 (Thread-231): 08:41:46  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '196d9207-3e38-4101-ac43-bc898fbec1a7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f51ec35fd90>]}
2022-07-07 08:41:46.570226 (Thread-231): sending response (<Response 3324 bytes [200 OK]>) to 10.0.41.177
2022-07-07 08:41:46.976872 (Thread-232): handling run_sql request
2022-07-07 08:41:46.977293 (Thread-232): 08:41:46  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '196d9207-3e38-4101-ac43-bc898fbec1a7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f51ec35f6a0>]}
2022-07-07 08:41:49.285707 (Thread-232): sending response (<Response 139 bytes [200 OK]>) to 10.0.41.177
2022-07-07 08:41:49.311690 (MainThread): 08:41:49  Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'fe368ddd-a2c5-451d-9e27-38ee791ba1f1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbf972843d0>]}
2022-07-07 08:41:49.312233 (MainThread): 08:41:49  Found 17 models, 0 tests, 0 snapshots, 0 analyses, 181 macros, 0 operations, 0 seed files, 15 sources, 0 exposures, 0 metrics
2022-07-07 08:41:49.312818 (Thread-1): 08:41:49  Acquiring new snowflake connection "rpc.ecommerce_data_model_dbt.request"
2022-07-07 08:41:49.312956 (Thread-1): 08:41:49  Began compiling node rpc.ecommerce_data_model_dbt.request
2022-07-07 08:41:49.313050 (Thread-1): 08:41:49  Compiling rpc.ecommerce_data_model_dbt.request
2022-07-07 08:41:49.315530 (Thread-1): 08:41:49  finished collecting timing info
2022-07-07 08:41:49.315693 (Thread-1): 08:41:49  Began executing node rpc.ecommerce_data_model_dbt.request
2022-07-07 08:41:49.316660 (Thread-1): 08:41:49  Using snowflake connection "rpc.ecommerce_data_model_dbt.request"
2022-07-07 08:41:49.316751 (Thread-1): 08:41:49  On rpc.ecommerce_data_model_dbt.request: select distinct user_id, 
first_value(properties_country)
over(partition by user_id order by case when properties_country is not null and properties_country != '' then 2 else 1 end desc, timestamp desc) as country,
first_value(properties_state)
over(partition by user_id order by case when properties_state is not null and properties_state != '' then 2 else 1 end desc, timestamp desc) as state
from analytics_db.data_apps_simulated.identifies where timestamp >= '2021-05-01' and timestamp <= '2022-06-29'
and user_id is not null
limit 500
/* limit added automatically by dbt cloud */
2022-07-07 08:41:49.316830 (Thread-1): 08:41:49  Opening a new connection, currently in state init
2022-07-07 08:41:49.698518 (Thread-233): handling poll request
2022-07-07 08:41:49.698967 (Thread-233): 08:41:49  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '196d9207-3e38-4101-ac43-bc898fbec1a7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f51ec459f70>]}
2022-07-07 08:41:49.699865 (Thread-233): sending response (<Response 4340 bytes [200 OK]>) to 10.0.41.177
2022-07-07 08:41:50.689296 (Thread-1): 08:41:50  SQL status: SUCCESS 5 in 1.37 seconds
2022-07-07 08:41:50.690769 (Thread-1): 08:41:50  finished collecting timing info
2022-07-07 08:41:50.690956 (Thread-1): 08:41:50  On rpc.ecommerce_data_model_dbt.request: Close
2022-07-07 08:41:51.116345 (Thread-234): handling poll request
2022-07-07 08:41:51.116801 (Thread-234): 08:41:51  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '196d9207-3e38-4101-ac43-bc898fbec1a7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f51ec4596d0>]}
2022-07-07 08:41:51.117669 (Thread-234): sending response (<Response 5821 bytes [200 OK]>) to 10.0.41.177
2022-07-07 08:43:16.239500 (Thread-235): handling status request
2022-07-07 08:43:16.239965 (Thread-235): 08:43:16  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '196d9207-3e38-4101-ac43-bc898fbec1a7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f51ec356b20>]}
2022-07-07 08:43:16.240565 (Thread-235): sending response (<Response 3301 bytes [200 OK]>) to 10.0.41.177
2022-07-07 08:43:16.241639 (Thread-236): handling status request
2022-07-07 08:43:16.241992 (Thread-236): 08:43:16  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '196d9207-3e38-4101-ac43-bc898fbec1a7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f51ec459910>]}
2022-07-07 08:43:16.242450 (Thread-236): sending response (<Response 3301 bytes [200 OK]>) to 10.0.41.177
2022-07-07 08:43:16.252380 (Thread-237): handling list request
2022-07-07 08:43:16.252627 (Thread-237): 08:43:16  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '196d9207-3e38-4101-ac43-bc898fbec1a7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f51ec356190>]}
2022-07-07 08:43:16.322688 (Thread-238): sending response (<Response 214 bytes [200 OK]>) to 10.0.41.177
2022-07-07 08:43:17.683513 (Thread-239): handling status request
2022-07-07 08:43:17.683950 (Thread-239): 08:43:17  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '196d9207-3e38-4101-ac43-bc898fbec1a7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f51ec3330a0>]}
2022-07-07 08:43:17.684487 (Thread-239): sending response (<Response 3301 bytes [200 OK]>) to 10.0.41.177
2022-07-07 08:43:17.690803 (Thread-240): handling list request
2022-07-07 08:43:17.691061 (Thread-240): 08:43:17  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '196d9207-3e38-4101-ac43-bc898fbec1a7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f51ec3330d0>]}
2022-07-07 08:43:17.721135 (Thread-240): 08:43:17  Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '196d9207-3e38-4101-ac43-bc898fbec1a7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f51ec3d1310>]}
2022-07-07 08:43:17.721477 (Thread-240): 08:43:17  Found 17 models, 0 tests, 0 snapshots, 0 analyses, 181 macros, 0 operations, 0 seed files, 15 sources, 0 exposures, 0 metrics
2022-07-07 08:43:17.725463 (Thread-240): sending response (<Response 3231 bytes [200 OK]>) to 10.0.41.177
2022-07-07 08:43:19.653060 (Thread-241): handling status request
2022-07-07 08:43:19.654695 (Thread-241): 08:43:19  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '196d9207-3e38-4101-ac43-bc898fbec1a7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f51ec316df0>]}
2022-07-07 08:43:19.655264 (Thread-241): sending response (<Response 3324 bytes [200 OK]>) to 10.0.41.177
2022-07-07 08:43:20.055462 (Thread-242): handling compile_sql request
2022-07-07 08:43:20.055911 (Thread-242): 08:43:20  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '196d9207-3e38-4101-ac43-bc898fbec1a7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f51ec3a6d00>]}
2022-07-07 08:43:22.462702 (Thread-242): sending response (<Response 139 bytes [200 OK]>) to 10.0.41.177
2022-07-07 08:43:22.494754 (MainThread): 08:43:22  Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'de2f0de9-ddc3-4199-b856-780e608f8fdf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2ec5cca520>]}
2022-07-07 08:43:22.495304 (MainThread): 08:43:22  Found 17 models, 0 tests, 0 snapshots, 0 analyses, 181 macros, 0 operations, 0 seed files, 15 sources, 0 exposures, 0 metrics
2022-07-07 08:43:22.495958 (Thread-1): 08:43:22  Acquiring new snowflake connection "rpc.ecommerce_data_model_dbt.request"
2022-07-07 08:43:22.496095 (Thread-1): 08:43:22  Began compiling node rpc.ecommerce_data_model_dbt.request
2022-07-07 08:43:22.496190 (Thread-1): 08:43:22  Compiling rpc.ecommerce_data_model_dbt.request
2022-07-07 08:43:22.502795 (Thread-1): 08:43:22  finished collecting timing info
2022-07-07 08:43:22.502937 (Thread-1): 08:43:22  Began executing node rpc.ecommerce_data_model_dbt.request
2022-07-07 08:43:22.503057 (Thread-1): 08:43:22  finished collecting timing info
2022-07-07 08:43:22.885319 (Thread-243): handling poll request
2022-07-07 08:43:22.885779 (Thread-243): 08:43:22  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '196d9207-3e38-4101-ac43-bc898fbec1a7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f51ec3bca90>]}
2022-07-07 08:43:22.886993 (Thread-243): sending response (<Response 20674 bytes [200 OK]>) to 10.0.41.177
2022-07-07 08:43:24.143755 (Thread-244): 08:43:24  Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
2022-07-07 08:43:24.144294 (Thread-244): 08:43:24  Partial parsing: updated file: ecommerce_data_model_dbt://models/data_model/stg_user_traits_new.sql
2022-07-07 08:43:24.148784 (Thread-244): 08:43:24  1603: static parser failed on data_model/stg_user_traits_new.sql
2022-07-07 08:43:24.156273 (Thread-244): 08:43:24  1602: parser fallback to jinja rendering on data_model/stg_user_traits_new.sql
2022-07-07 08:43:24.206694 (Thread-244): 08:43:24  [WARNING]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.data-apps-ecommerce-template.data_model

2022-07-07 08:43:24.211654 (Thread-244): 08:43:24  Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '196d9207-3e38-4101-ac43-bc898fbec1a7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5216115f40>]}
2022-07-07 08:43:24.926796 (Thread-245): handling status request
2022-07-07 08:43:24.927195 (Thread-245): 08:43:24  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '196d9207-3e38-4101-ac43-bc898fbec1a7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f51ed248ac0>]}
2022-07-07 08:43:24.927753 (Thread-245): sending response (<Response 2369 bytes [200 OK]>) to 10.0.41.177
2022-07-07 08:43:24.966163 (Thread-246): handling status request
2022-07-07 08:43:24.966466 (Thread-246): 08:43:24  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '196d9207-3e38-4101-ac43-bc898fbec1a7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f51ed248880>]}
2022-07-07 08:43:24.966923 (Thread-246): sending response (<Response 2369 bytes [200 OK]>) to 10.0.41.177
2022-07-07 08:43:26.678961 (Thread-247): handling status request
2022-07-07 08:43:26.679367 (Thread-247): 08:43:26  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '196d9207-3e38-4101-ac43-bc898fbec1a7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f51ed0f44f0>]}
2022-07-07 08:43:26.679926 (Thread-247): sending response (<Response 2369 bytes [200 OK]>) to 10.0.41.177
2022-07-07 08:43:27.082363 (Thread-248): handling compile_sql request
2022-07-07 08:43:27.082766 (Thread-248): 08:43:27  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '196d9207-3e38-4101-ac43-bc898fbec1a7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f51ed0f4520>]}
2022-07-07 08:43:29.423908 (Thread-248): sending response (<Response 139 bytes [200 OK]>) to 10.0.41.177
2022-07-07 08:43:29.455830 (MainThread): 08:43:29  Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'f32a90da-9c72-425d-a381-6debe5dd9612', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2488fdf310>]}
2022-07-07 08:43:29.456364 (MainThread): 08:43:29  Found 17 models, 0 tests, 0 snapshots, 0 analyses, 181 macros, 0 operations, 0 seed files, 15 sources, 0 exposures, 0 metrics
2022-07-07 08:43:29.456969 (Thread-1): 08:43:29  Acquiring new snowflake connection "rpc.ecommerce_data_model_dbt.request"
2022-07-07 08:43:29.457107 (Thread-1): 08:43:29  Began compiling node rpc.ecommerce_data_model_dbt.request
2022-07-07 08:43:29.457201 (Thread-1): 08:43:29  Compiling rpc.ecommerce_data_model_dbt.request
2022-07-07 08:43:29.463692 (Thread-1): 08:43:29  finished collecting timing info
2022-07-07 08:43:29.463832 (Thread-1): 08:43:29  Began executing node rpc.ecommerce_data_model_dbt.request
2022-07-07 08:43:29.463945 (Thread-1): 08:43:29  finished collecting timing info
2022-07-07 08:43:29.853204 (Thread-249): handling poll request
2022-07-07 08:43:29.853657 (Thread-249): 08:43:29  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '196d9207-3e38-4101-ac43-bc898fbec1a7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f51ed16a820>]}
2022-07-07 08:43:29.854893 (Thread-249): sending response (<Response 20675 bytes [200 OK]>) to 10.0.41.177
2022-07-07 08:43:31.223824 (Thread-250): handling status request
2022-07-07 08:43:31.224236 (Thread-250): 08:43:31  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '196d9207-3e38-4101-ac43-bc898fbec1a7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f51ed16a670>]}
2022-07-07 08:43:31.224790 (Thread-250): sending response (<Response 2346 bytes [200 OK]>) to 10.0.41.177
2022-07-07 08:43:31.231742 (Thread-251): handling list request
2022-07-07 08:43:31.232012 (Thread-251): 08:43:31  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '196d9207-3e38-4101-ac43-bc898fbec1a7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f51ed16a1c0>]}
2022-07-07 08:43:31.264291 (Thread-251): 08:43:31  Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '196d9207-3e38-4101-ac43-bc898fbec1a7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f51ed16acd0>]}
2022-07-07 08:43:31.264590 (Thread-251): 08:43:31  Found 17 models, 0 tests, 0 snapshots, 0 analyses, 181 macros, 0 operations, 0 seed files, 15 sources, 0 exposures, 0 metrics
2022-07-07 08:43:31.268068 (Thread-251): sending response (<Response 2263 bytes [200 OK]>) to 10.0.41.177
2022-07-07 08:43:36.735194 (Thread-252): handling status request
2022-07-07 08:43:36.735665 (Thread-252): 08:43:36  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '196d9207-3e38-4101-ac43-bc898fbec1a7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f51ed0f4c40>]}
2022-07-07 08:43:36.736237 (Thread-252): sending response (<Response 2369 bytes [200 OK]>) to 10.0.41.177
2022-07-07 08:43:37.132129 (Thread-253): handling run_sql request
2022-07-07 08:43:37.132519 (Thread-253): 08:43:37  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '196d9207-3e38-4101-ac43-bc898fbec1a7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f51ecf2e9d0>]}
2022-07-07 08:43:39.467313 (Thread-253): sending response (<Response 139 bytes [200 OK]>) to 10.0.41.177
2022-07-07 08:43:39.498587 (MainThread): 08:43:39  Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'b2fd4d09-a37c-486f-9891-af6d6e6706a4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2d61d1f2b0>]}
2022-07-07 08:43:39.499104 (MainThread): 08:43:39  Found 17 models, 0 tests, 0 snapshots, 0 analyses, 181 macros, 0 operations, 0 seed files, 15 sources, 0 exposures, 0 metrics
2022-07-07 08:43:39.499713 (Thread-1): 08:43:39  Acquiring new snowflake connection "rpc.ecommerce_data_model_dbt.request"
2022-07-07 08:43:39.499868 (Thread-1): 08:43:39  Began compiling node rpc.ecommerce_data_model_dbt.request
2022-07-07 08:43:39.499966 (Thread-1): 08:43:39  Compiling rpc.ecommerce_data_model_dbt.request
2022-07-07 08:43:39.506640 (Thread-1): 08:43:39  finished collecting timing info
2022-07-07 08:43:39.506778 (Thread-1): 08:43:39  Began executing node rpc.ecommerce_data_model_dbt.request
2022-07-07 08:43:39.510781 (Thread-1): 08:43:39  Using snowflake connection "rpc.ecommerce_data_model_dbt.request"
2022-07-07 08:43:39.510887 (Thread-1): 08:43:39  On rpc.ecommerce_data_model_dbt.request: with cte_gender as ANALYTICS_DB.dbt_ecommerce features.gender,

cte_age as ANALYTICS_DB.dbt_ecommerce features.age,

cte_location as ANALYTICS_DB.dbt_ecommerce features.country_and_state,

cte_email_domain as 
(select user_id, email_domain from 
(select user_id, substring(properties_email, charindex( '@', properties_email) + 1, len(properties_email)) as email_domain, row_number() over(partition by user_id order by timestamp desc) as rn from 
analytics_db.data_apps_simulated.identifies where timestamp >= '2021-05-01' and timestamp <= '2022-06-29'
and properties_email is not null and properties_email != '') where rn = 1),

cte_is_member as 
(select user_id, is_member from
(select user_id, 
(CASE WHEN properties_is_member = TRUE
      THEN TRUE
      ELSE FALSE
END) as is_member, row_number() over(partition by user_id order by timestamp desc) as rn from 
analytics_db.data_apps_simulated.identifies where timestamp >= '2021-05-01' and timestamp <= '2022-06-29'
and user_id is not null) where rn = 1),

cte_has_mobile_app as 
(select user_id, has_mobile_app from 
(select user_id, 
(CASE WHEN user_id IN(select user_id from analytics_db.data_apps_simulated.identifies where context_device_type  = 'android' or context_device_type = 'iOS')
      THEN TRUE
      ELSE FALSE
      END) as has_mobile_app, row_number() over(partition by user_id order by timestamp desc) as rn from 
analytics_db.data_apps_simulated.identifies where timestamp >= '2021-05-01' and timestamp <= '2022-06-29'
and context_device_type is not null and context_device_type != '' and user_id is not null) where rn = 1),

cte_is_active_on_website as 
(select user_id, is_active_on_website from 
(select user_id, 
(CASE WHEN user_id IN(select user_id from analytics_db.data_apps_simulated.identifies where context_device_type like '%PC')
      THEN TRUE
      ELSE FALSE
      END)
as is_active_on_website, row_number() over(partition by user_id order by timestamp desc) as rn from 
analytics_db.data_apps_simulated.identifies where timestamp >= '2021-05-01' and timestamp <= '2022-06-29'
and context_device_type is not null and context_device_type != '' and user_id is not null) where rn = 1),

cte_device_type as 
(select user_id, device_type from 
(select user_id, context_device_type as device_type, row_number() over(partition by user_id order by timestamp desc) as rn from 
analytics_db.data_apps_simulated.identifies where timestamp >= '2021-05-01' and timestamp <= '2022-06-29'
and device_type is not null and device_type != '') where rn = 1)

select coalesce(a.user_id, b.user_id, c.user_id, d.user_id, e.user_id, f.user_id, g.user_id, h.user_id) 
as user_id, gender, (select country from cte_location) as country, (select state from cte_location) as state, email_domain, is_member, has_mobile_app, is_active_on_website, device_type
from ((((((cte_gender a full outer join cte_age b on a.user_id = b.user_id) 
full outer join cte_location c on c.user_id = coalesce(a.user_id, b.user_id))
full outer join cte_email_domain d on d.user_id = coalesce(a.user_id, b.user_id, c.user_id))
full outer join cte_is_member e on e.user_id = coalesce(a.user_id, b.user_id, c.user_id,d.user_id))
full outer join cte_has_mobile_app f on f.user_id = coalesce(a.user_id, b.user_id, c.user_id,d.user_id, e.user_id))
full outer join cte_is_active_on_website as g on g.user_id = coalesce(a.user_id, b.user_id, c.user_id,d.user_id, e.user_id, f.user_id))
full outer join cte_device_type as h on h.user_id = coalesce(a.user_id, b.user_id, c.user_id,d.user_id, e.user_id, f.user_id, g.user_id)
limit 500
/* limit added automatically by dbt cloud */
2022-07-07 08:43:39.510972 (Thread-1): 08:43:39  Opening a new connection, currently in state init
2022-07-07 08:43:39.887383 (Thread-254): handling poll request
2022-07-07 08:43:39.887868 (Thread-254): 08:43:39  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '196d9207-3e38-4101-ac43-bc898fbec1a7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5216108d60>]}
2022-07-07 08:43:39.888718 (Thread-254): sending response (<Response 7407 bytes [200 OK]>) to 10.0.41.177
2022-07-07 08:43:40.183896 (Thread-1): 08:43:40  Snowflake adapter: Snowflake query id: 01a5718b-0602-33c1-0019-8203046b6982
2022-07-07 08:43:40.184112 (Thread-1): 08:43:40  Snowflake adapter: Snowflake error: 001003 (42000): SQL compilation error:
syntax error line 1 at position 19 unexpected 'ANALYTICS_DB'.
syntax error line 1 at position 46 unexpected 'features'.
syntax error line 3 at position 11 unexpected 'ANALYTICS_DB'.
syntax error line 3 at position 38 unexpected 'features'.
syntax error line 5 at position 16 unexpected 'ANALYTICS_DB'.
syntax error line 5 at position 43 unexpected 'features'.
2022-07-07 08:43:40.184279 (Thread-1): 08:43:40  finished collecting timing info
2022-07-07 08:43:40.184438 (Thread-1): 08:43:40  On rpc.ecommerce_data_model_dbt.request: Close
2022-07-07 08:43:40.246354 (Thread-1): Got an exception: Database Error
  001003 (42000): SQL compilation error:
  syntax error line 1 at position 19 unexpected 'ANALYTICS_DB'.
  syntax error line 1 at position 46 unexpected 'features'.
  syntax error line 3 at position 11 unexpected 'ANALYTICS_DB'.
  syntax error line 3 at position 38 unexpected 'features'.
  syntax error line 5 at position 16 unexpected 'ANALYTICS_DB'.
  syntax error line 5 at position 43 unexpected 'features'.
Traceback (most recent call last):
  File "/usr/local/lib/python3.8/dist-packages/dbt/adapters/snowflake/connections.py", line 206, in exception_handler
    yield
  File "/usr/local/lib/python3.8/dist-packages/dbt/adapters/sql/connections.py", line 74, in add_query
    cursor.execute(sql, bindings)
  File "/usr/local/lib/python3.8/dist-packages/snowflake/connector/cursor.py", line 721, in execute
    Error.errorhandler_wrapper(
  File "/usr/local/lib/python3.8/dist-packages/snowflake/connector/errors.py", line 258, in errorhandler_wrapper
    cursor.errorhandler(connection, cursor, error_class, error_value)
  File "/usr/local/lib/python3.8/dist-packages/snowflake/connector/errors.py", line 188, in default_errorhandler
    raise error_class(
snowflake.connector.errors.ProgrammingError: 001003 (42000): SQL compilation error:
syntax error line 1 at position 19 unexpected 'ANALYTICS_DB'.
syntax error line 1 at position 46 unexpected 'features'.
syntax error line 3 at position 11 unexpected 'ANALYTICS_DB'.
syntax error line 3 at position 38 unexpected 'features'.
syntax error line 5 at position 16 unexpected 'ANALYTICS_DB'.
syntax error line 5 at position 43 unexpected 'features'.

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/usr/local/lib/python3.8/dist-packages/dbt/task/base.py", line 361, in safe_run
    result = self.compile_and_execute(manifest, ctx)
  File "/usr/local/lib/python3.8/dist-packages/dbt/task/base.py", line 314, in compile_and_execute
    result = self.run(ctx.node, manifest)
  File "/usr/local/lib/python3.8/dist-packages/dbt/task/base.py", line 403, in run
    return self.execute(compiled_node, manifest)
  File "/usr/local/lib/python3.8/dist-packages/dbt_rpc/rpc/node_runners.py", line 90, in execute
    _, execute_result = self.adapter.execute(
  File "/usr/local/lib/python3.8/dist-packages/dbt/adapters/base/impl.py", line 225, in execute
    return self.connections.execute(
  File "/usr/local/lib/python3.8/dist-packages/dbt/adapters/sql/connections.py", line 127, in execute
    _, cursor = self.add_query(sql, auto_begin)
  File "/usr/local/lib/python3.8/dist-packages/dbt/adapters/snowflake/connections.py", line 433, in add_query
    connection, cursor = super().add_query(
  File "/usr/local/lib/python3.8/dist-packages/dbt/adapters/sql/connections.py", line 83, in add_query
    return connection, cursor
  File "/usr/lib/python3.8/contextlib.py", line 131, in __exit__
    self.gen.throw(type, value, traceback)
  File "/usr/local/lib/python3.8/dist-packages/dbt/adapters/snowflake/connections.py", line 223, in exception_handler
    raise DatabaseException(msg)
dbt.exceptions.DatabaseException: Database Error
  001003 (42000): SQL compilation error:
  syntax error line 1 at position 19 unexpected 'ANALYTICS_DB'.
  syntax error line 1 at position 46 unexpected 'features'.
  syntax error line 3 at position 11 unexpected 'ANALYTICS_DB'.
  syntax error line 3 at position 38 unexpected 'features'.
  syntax error line 5 at position 16 unexpected 'ANALYTICS_DB'.
  syntax error line 5 at position 43 unexpected 'features'.
2022-07-07 08:43:40.247373 (Thread-1): Got exception RPCException(10003, Database Error, {'type': 'DatabaseException', 'message': "Database Error in rpc request (from remote system)\n  001003 (42000): SQL compilation error:\n  syntax error line 1 at position 19 unexpected 'ANALYTICS_DB'.\n  syntax error line 1 at position 46 unexpected 'features'.\n  syntax error line 3 at position 11 unexpected 'ANALYTICS_DB'.\n  syntax error line 3 at position 38 unexpected 'features'.\n  syntax error line 5 at position 16 unexpected 'ANALYTICS_DB'.\n  syntax error line 5 at position 43 unexpected 'features'.", 'raw_sql': "with cte_gender as {{ ref('gender') }},\r\n\r\ncte_age as {{ ref('age') }},\r\n\r\ncte_location as {{ ref('country_and_state') }},\r\n\r\ncte_email_domain as \r\n(select user_id, email_domain from \r\n(select user_id, substring(properties_email, charindex( '@', properties_email) + 1, len(properties_email)) as email_domain, row_number() over(partition by user_id order by timestamp desc) as rn from \r\n{{ source('ecommerce', 'identifies') }} where timestamp >= '{{ var('start_date') }}' and timestamp <= '{{ var('end_date') }}'\r\nand properties_email is not null and properties_email != '') where rn = 1),\r\n\r\ncte_is_member as \r\n(select user_id, is_member from\r\n(select user_id, \r\n(CASE WHEN properties_is_member = TRUE\r\n      THEN TRUE\r\n      ELSE FALSE\r\nEND) as is_member, row_number() over(partition by user_id order by timestamp desc) as rn from \r\n{{ source('ecommerce', 'identifies') }} where timestamp >= '{{ var('start_date') }}' and timestamp <= '{{ var('end_date') }}'\r\nand user_id is not null) where rn = 1),\r\n\r\ncte_has_mobile_app as \r\n(select user_id, has_mobile_app from \r\n(select user_id, \r\n(CASE WHEN user_id IN(select user_id from {{ source('ecommerce', 'identifies') }} where context_device_type  = 'android' or context_device_type = 'iOS')\r\n      THEN TRUE\r\n      ELSE FALSE\r\n      END) as has_mobile_app, row_number() over(partition by user_id order by timestamp desc) as rn from \r\n{{ source('ecommerce', 'identifies') }} where timestamp >= '{{ var('start_date') }}' and timestamp <= '{{ var('end_date') }}'\r\nand context_device_type is not null and context_device_type != '' and user_id is not null) where rn = 1),\r\n\r\ncte_is_active_on_website as \r\n(select user_id, is_active_on_website from \r\n(select user_id, \r\n(CASE WHEN user_id IN(select user_id from {{ source('ecommerce', 'identifies') }} where context_device_type like '%PC')\r\n      THEN TRUE\r\n      ELSE FALSE\r\n      END)\r\nas is_active_on_website, row_number() over(partition by user_id order by timestamp desc) as rn from \r\n{{ source('ecommerce', 'identifies') }} where timestamp >= '{{ var('start_date') }}' and timestamp <= '{{ var('end_date') }}'\r\nand context_device_type is not null and context_device_type != '' and user_id is not null) where rn = 1),\r\n\r\ncte_device_type as \r\n(select user_id, device_type from \r\n(select user_id, context_device_type as device_type, row_number() over(partition by user_id order by timestamp desc) as rn from \r\n{{ source('ecommerce', 'identifies') }} where timestamp >= '{{ var('start_date') }}' and timestamp <= '{{ var('end_date') }}'\r\nand device_type is not null and device_type != '') where rn = 1)\r\n\r\nselect coalesce(a.user_id, b.user_id, c.user_id, d.user_id, e.user_id, f.user_id, g.user_id, h.user_id) \r\nas user_id, gender, (select country from cte_location) as country, (select state from cte_location) as state, email_domain, is_member, has_mobile_app, is_active_on_website, device_type\r\nfrom ((((((cte_gender a full outer join cte_age b on a.user_id = b.user_id) \r\nfull outer join cte_location c on c.user_id = coalesce(a.user_id, b.user_id))\r\nfull outer join cte_email_domain d on d.user_id = coalesce(a.user_id, b.user_id, c.user_id))\r\nfull outer join cte_is_member e on e.user_id = coalesce(a.user_id, b.user_id, c.user_id,d.user_id))\r\nfull outer join cte_has_mobile_app f on f.user_id = coalesce(a.user_id, b.user_id, c.user_id,d.user_id, e.user_id))\r\nfull outer join cte_is_active_on_website as g on g.user_id = coalesce(a.user_id, b.user_id, c.user_id,d.user_id, e.user_id, f.user_id))\r\nfull outer join cte_device_type as h on h.user_id = coalesce(a.user_id, b.user_id, c.user_id,d.user_id, e.user_id, f.user_id, g.user_id)\nlimit 500\n/* limit added automatically by dbt cloud */", 'compiled_sql': "with cte_gender as ANALYTICS_DB.dbt_ecommerce features.gender,\n\ncte_age as ANALYTICS_DB.dbt_ecommerce features.age,\n\ncte_location as ANALYTICS_DB.dbt_ecommerce features.country_and_state,\n\ncte_email_domain as \n(select user_id, email_domain from \n(select user_id, substring(properties_email, charindex( '@', properties_email) + 1, len(properties_email)) as email_domain, row_number() over(partition by user_id order by timestamp desc) as rn from \nanalytics_db.data_apps_simulated.identifies where timestamp >= '2021-05-01' and timestamp <= '2022-06-29'\nand properties_email is not null and properties_email != '') where rn = 1),\n\ncte_is_member as \n(select user_id, is_member from\n(select user_id, \n(CASE WHEN properties_is_member = TRUE\n      THEN TRUE\n      ELSE FALSE\nEND) as is_member, row_number() over(partition by user_id order by timestamp desc) as rn from \nanalytics_db.data_apps_simulated.identifies where timestamp >= '2021-05-01' and timestamp <= '2022-06-29'\nand user_id is not null) where rn = 1),\n\ncte_has_mobile_app as \n(select user_id, has_mobile_app from \n(select user_id, \n(CASE WHEN user_id IN(select user_id from analytics_db.data_apps_simulated.identifies where context_device_type  = 'android' or context_device_type = 'iOS')\n      THEN TRUE\n      ELSE FALSE\n      END) as has_mobile_app, row_number() over(partition by user_id order by timestamp desc) as rn from \nanalytics_db.data_apps_simulated.identifies where timestamp >= '2021-05-01' and timestamp <= '2022-06-29'\nand context_device_type is not null and context_device_type != '' and user_id is not null) where rn = 1),\n\ncte_is_active_on_website as \n(select user_id, is_active_on_website from \n(select user_id, \n(CASE WHEN user_id IN(select user_id from analytics_db.data_apps_simulated.identifies where context_device_type like '%PC')\n      THEN TRUE\n      ELSE FALSE\n      END)\nas is_active_on_website, row_number() over(partition by user_id order by timestamp desc) as rn from \nanalytics_db.data_apps_simulated.identifies where timestamp >= '2021-05-01' and timestamp <= '2022-06-29'\nand context_device_type is not null and context_device_type != '' and user_id is not null) where rn = 1),\n\ncte_device_type as \n(select user_id, device_type from \n(select user_id, context_device_type as device_type, row_number() over(partition by user_id order by timestamp desc) as rn from \nanalytics_db.data_apps_simulated.identifies where timestamp >= '2021-05-01' and timestamp <= '2022-06-29'\nand device_type is not null and device_type != '') where rn = 1)\n\nselect coalesce(a.user_id, b.user_id, c.user_id, d.user_id, e.user_id, f.user_id, g.user_id, h.user_id) \nas user_id, gender, (select country from cte_location) as country, (select state from cte_location) as state, email_domain, is_member, has_mobile_app, is_active_on_website, device_type\nfrom ((((((cte_gender a full outer join cte_age b on a.user_id = b.user_id) \nfull outer join cte_location c on c.user_id = coalesce(a.user_id, b.user_id))\nfull outer join cte_email_domain d on d.user_id = coalesce(a.user_id, b.user_id, c.user_id))\nfull outer join cte_is_member e on e.user_id = coalesce(a.user_id, b.user_id, c.user_id,d.user_id))\nfull outer join cte_has_mobile_app f on f.user_id = coalesce(a.user_id, b.user_id, c.user_id,d.user_id, e.user_id))\nfull outer join cte_is_active_on_website as g on g.user_id = coalesce(a.user_id, b.user_id, c.user_id,d.user_id, e.user_id, f.user_id))\nfull outer join cte_device_type as h on h.user_id = coalesce(a.user_id, b.user_id, c.user_id,d.user_id, e.user_id, f.user_id, g.user_id)\nlimit 500\n/* limit added automatically by dbt cloud */", 'tags': None}, None)
Traceback (most recent call last):
  File "/usr/local/lib/python3.8/dist-packages/dbt_rpc/task/sql_commands.py", line 147, in _in_thread
    self.node_results.append(runner.safe_run(self.manifest))
  File "/usr/local/lib/python3.8/dist-packages/dbt/task/base.py", line 377, in safe_run
    result = self.error_result(ctx.node, error, started, [])
  File "/usr/local/lib/python3.8/dist-packages/dbt_rpc/rpc/node_runners.py", line 56, in error_result
    raise error
dbt_rpc.rpc.error.RPCException: RPCException(10003, Database Error, {'type': 'DatabaseException', 'message': "Database Error in rpc request (from remote system)\n  001003 (42000): SQL compilation error:\n  syntax error line 1 at position 19 unexpected 'ANALYTICS_DB'.\n  syntax error line 1 at position 46 unexpected 'features'.\n  syntax error line 3 at position 11 unexpected 'ANALYTICS_DB'.\n  syntax error line 3 at position 38 unexpected 'features'.\n  syntax error line 5 at position 16 unexpected 'ANALYTICS_DB'.\n  syntax error line 5 at position 43 unexpected 'features'.", 'raw_sql': "with cte_gender as {{ ref('gender') }},\r\n\r\ncte_age as {{ ref('age') }},\r\n\r\ncte_location as {{ ref('country_and_state') }},\r\n\r\ncte_email_domain as \r\n(select user_id, email_domain from \r\n(select user_id, substring(properties_email, charindex( '@', properties_email) + 1, len(properties_email)) as email_domain, row_number() over(partition by user_id order by timestamp desc) as rn from \r\n{{ source('ecommerce', 'identifies') }} where timestamp >= '{{ var('start_date') }}' and timestamp <= '{{ var('end_date') }}'\r\nand properties_email is not null and properties_email != '') where rn = 1),\r\n\r\ncte_is_member as \r\n(select user_id, is_member from\r\n(select user_id, \r\n(CASE WHEN properties_is_member = TRUE\r\n      THEN TRUE\r\n      ELSE FALSE\r\nEND) as is_member, row_number() over(partition by user_id order by timestamp desc) as rn from \r\n{{ source('ecommerce', 'identifies') }} where timestamp >= '{{ var('start_date') }}' and timestamp <= '{{ var('end_date') }}'\r\nand user_id is not null) where rn = 1),\r\n\r\ncte_has_mobile_app as \r\n(select user_id, has_mobile_app from \r\n(select user_id, \r\n(CASE WHEN user_id IN(select user_id from {{ source('ecommerce', 'identifies') }} where context_device_type  = 'android' or context_device_type = 'iOS')\r\n      THEN TRUE\r\n      ELSE FALSE\r\n      END) as has_mobile_app, row_number() over(partition by user_id order by timestamp desc) as rn from \r\n{{ source('ecommerce', 'identifies') }} where timestamp >= '{{ var('start_date') }}' and timestamp <= '{{ var('end_date') }}'\r\nand context_device_type is not null and context_device_type != '' and user_id is not null) where rn = 1),\r\n\r\ncte_is_active_on_website as \r\n(select user_id, is_active_on_website from \r\n(select user_id, \r\n(CASE WHEN user_id IN(select user_id from {{ source('ecommerce', 'identifies') }} where context_device_type like '%PC')\r\n      THEN TRUE\r\n      ELSE FALSE\r\n      END)\r\nas is_active_on_website, row_number() over(partition by user_id order by timestamp desc) as rn from \r\n{{ source('ecommerce', 'identifies') }} where timestamp >= '{{ var('start_date') }}' and timestamp <= '{{ var('end_date') }}'\r\nand context_device_type is not null and context_device_type != '' and user_id is not null) where rn = 1),\r\n\r\ncte_device_type as \r\n(select user_id, device_type from \r\n(select user_id, context_device_type as device_type, row_number() over(partition by user_id order by timestamp desc) as rn from \r\n{{ source('ecommerce', 'identifies') }} where timestamp >= '{{ var('start_date') }}' and timestamp <= '{{ var('end_date') }}'\r\nand device_type is not null and device_type != '') where rn = 1)\r\n\r\nselect coalesce(a.user_id, b.user_id, c.user_id, d.user_id, e.user_id, f.user_id, g.user_id, h.user_id) \r\nas user_id, gender, (select country from cte_location) as country, (select state from cte_location) as state, email_domain, is_member, has_mobile_app, is_active_on_website, device_type\r\nfrom ((((((cte_gender a full outer join cte_age b on a.user_id = b.user_id) \r\nfull outer join cte_location c on c.user_id = coalesce(a.user_id, b.user_id))\r\nfull outer join cte_email_domain d on d.user_id = coalesce(a.user_id, b.user_id, c.user_id))\r\nfull outer join cte_is_member e on e.user_id = coalesce(a.user_id, b.user_id, c.user_id,d.user_id))\r\nfull outer join cte_has_mobile_app f on f.user_id = coalesce(a.user_id, b.user_id, c.user_id,d.user_id, e.user_id))\r\nfull outer join cte_is_active_on_website as g on g.user_id = coalesce(a.user_id, b.user_id, c.user_id,d.user_id, e.user_id, f.user_id))\r\nfull outer join cte_device_type as h on h.user_id = coalesce(a.user_id, b.user_id, c.user_id,d.user_id, e.user_id, f.user_id, g.user_id)\nlimit 500\n/* limit added automatically by dbt cloud */", 'compiled_sql': "with cte_gender as ANALYTICS_DB.dbt_ecommerce features.gender,\n\ncte_age as ANALYTICS_DB.dbt_ecommerce features.age,\n\ncte_location as ANALYTICS_DB.dbt_ecommerce features.country_and_state,\n\ncte_email_domain as \n(select user_id, email_domain from \n(select user_id, substring(properties_email, charindex( '@', properties_email) + 1, len(properties_email)) as email_domain, row_number() over(partition by user_id order by timestamp desc) as rn from \nanalytics_db.data_apps_simulated.identifies where timestamp >= '2021-05-01' and timestamp <= '2022-06-29'\nand properties_email is not null and properties_email != '') where rn = 1),\n\ncte_is_member as \n(select user_id, is_member from\n(select user_id, \n(CASE WHEN properties_is_member = TRUE\n      THEN TRUE\n      ELSE FALSE\nEND) as is_member, row_number() over(partition by user_id order by timestamp desc) as rn from \nanalytics_db.data_apps_simulated.identifies where timestamp >= '2021-05-01' and timestamp <= '2022-06-29'\nand user_id is not null) where rn = 1),\n\ncte_has_mobile_app as \n(select user_id, has_mobile_app from \n(select user_id, \n(CASE WHEN user_id IN(select user_id from analytics_db.data_apps_simulated.identifies where context_device_type  = 'android' or context_device_type = 'iOS')\n      THEN TRUE\n      ELSE FALSE\n      END) as has_mobile_app, row_number() over(partition by user_id order by timestamp desc) as rn from \nanalytics_db.data_apps_simulated.identifies where timestamp >= '2021-05-01' and timestamp <= '2022-06-29'\nand context_device_type is not null and context_device_type != '' and user_id is not null) where rn = 1),\n\ncte_is_active_on_website as \n(select user_id, is_active_on_website from \n(select user_id, \n(CASE WHEN user_id IN(select user_id from analytics_db.data_apps_simulated.identifies where context_device_type like '%PC')\n      THEN TRUE\n      ELSE FALSE\n      END)\nas is_active_on_website, row_number() over(partition by user_id order by timestamp desc) as rn from \nanalytics_db.data_apps_simulated.identifies where timestamp >= '2021-05-01' and timestamp <= '2022-06-29'\nand context_device_type is not null and context_device_type != '' and user_id is not null) where rn = 1),\n\ncte_device_type as \n(select user_id, device_type from \n(select user_id, context_device_type as device_type, row_number() over(partition by user_id order by timestamp desc) as rn from \nanalytics_db.data_apps_simulated.identifies where timestamp >= '2021-05-01' and timestamp <= '2022-06-29'\nand device_type is not null and device_type != '') where rn = 1)\n\nselect coalesce(a.user_id, b.user_id, c.user_id, d.user_id, e.user_id, f.user_id, g.user_id, h.user_id) \nas user_id, gender, (select country from cte_location) as country, (select state from cte_location) as state, email_domain, is_member, has_mobile_app, is_active_on_website, device_type\nfrom ((((((cte_gender a full outer join cte_age b on a.user_id = b.user_id) \nfull outer join cte_location c on c.user_id = coalesce(a.user_id, b.user_id))\nfull outer join cte_email_domain d on d.user_id = coalesce(a.user_id, b.user_id, c.user_id))\nfull outer join cte_is_member e on e.user_id = coalesce(a.user_id, b.user_id, c.user_id,d.user_id))\nfull outer join cte_has_mobile_app f on f.user_id = coalesce(a.user_id, b.user_id, c.user_id,d.user_id, e.user_id))\nfull outer join cte_is_active_on_website as g on g.user_id = coalesce(a.user_id, b.user_id, c.user_id,d.user_id, e.user_id, f.user_id))\nfull outer join cte_device_type as h on h.user_id = coalesce(a.user_id, b.user_id, c.user_id,d.user_id, e.user_id, f.user_id, g.user_id)\nlimit 500\n/* limit added automatically by dbt cloud */", 'tags': None}, None)
2022-07-07 08:43:41.287368 (Thread-255): handling poll request
2022-07-07 08:43:41.287800 (Thread-255): 08:43:41  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '196d9207-3e38-4101-ac43-bc898fbec1a7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f51ed16ad90>]}
2022-07-07 08:43:41.288570 (Thread-255): sending response (<Response 38045 bytes [200 OK]>) to 10.0.41.177
2022-07-07 08:45:40.165631 (Thread-256): 08:45:40  Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
2022-07-07 08:45:40.167118 (Thread-256): 08:45:40  Partial parsing: updated file: ecommerce_data_model_dbt://models/data_model/stg_user_traits_new.sql
2022-07-07 08:45:40.171683 (Thread-256): 08:45:40  1699: static parser successfully parsed data_model/stg_user_traits_new.sql
2022-07-07 08:45:40.206269 (Thread-256): 08:45:40  [WARNING]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.data-apps-ecommerce-template.data_model

2022-07-07 08:45:40.212360 (Thread-256): 08:45:40  Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '196d9207-3e38-4101-ac43-bc898fbec1a7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f51ed385820>]}
2022-07-07 08:45:40.755807 (Thread-257): handling status request
2022-07-07 08:45:40.756224 (Thread-257): 08:45:40  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '196d9207-3e38-4101-ac43-bc898fbec1a7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f51ed3cb7c0>]}
2022-07-07 08:45:40.756772 (Thread-257): sending response (<Response 2036 bytes [200 OK]>) to 10.0.41.177
2022-07-07 08:45:40.780547 (Thread-258): handling list request
2022-07-07 08:45:40.780836 (Thread-258): 08:45:40  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '196d9207-3e38-4101-ac43-bc898fbec1a7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f520c13c1f0>]}
2022-07-07 08:45:40.813178 (Thread-258): 08:45:40  Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '196d9207-3e38-4101-ac43-bc898fbec1a7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f51ec494fa0>]}
2022-07-07 08:45:40.813499 (Thread-258): 08:45:40  Found 17 models, 0 tests, 0 snapshots, 0 analyses, 181 macros, 0 operations, 0 seed files, 15 sources, 0 exposures, 0 metrics
2022-07-07 08:45:40.818107 (Thread-258): sending response (<Response 6935 bytes [200 OK]>) to 10.0.41.177
2022-07-07 08:45:40.982977 (Thread-259): handling status request
2022-07-07 08:45:40.983375 (Thread-259): 08:45:40  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '196d9207-3e38-4101-ac43-bc898fbec1a7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f51ed0f1d90>]}
2022-07-07 08:45:40.983928 (Thread-259): sending response (<Response 2059 bytes [200 OK]>) to 10.0.41.177
2022-07-07 08:45:41.035828 (Thread-260): handling status request
2022-07-07 08:45:41.040586 (Thread-260): 08:45:41  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '196d9207-3e38-4101-ac43-bc898fbec1a7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f51ed0f1b50>]}
2022-07-07 08:45:41.041121 (Thread-260): sending response (<Response 2059 bytes [200 OK]>) to 10.0.41.177
2022-07-07 08:45:59.195926 (Thread-261): handling status request
2022-07-07 08:45:59.196322 (Thread-261): 08:45:59  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '196d9207-3e38-4101-ac43-bc898fbec1a7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f51ed0f1be0>]}
2022-07-07 08:45:59.196800 (Thread-261): sending response (<Response 2059 bytes [200 OK]>) to 10.0.41.177
2022-07-07 08:45:59.703833 (Thread-262): handling run_sql request
2022-07-07 08:45:59.704216 (Thread-262): 08:45:59  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '196d9207-3e38-4101-ac43-bc898fbec1a7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f51ed0f1310>]}
2022-07-07 08:46:02.039195 (Thread-262): sending response (<Response 139 bytes [200 OK]>) to 10.0.41.177
2022-07-07 08:46:02.066078 (MainThread): 08:46:02  Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'd77f816f-fada-44df-831e-31cd76682b88', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2fa41b0e80>]}
2022-07-07 08:46:02.066629 (MainThread): 08:46:02  Found 17 models, 0 tests, 0 snapshots, 0 analyses, 181 macros, 0 operations, 0 seed files, 15 sources, 0 exposures, 0 metrics
2022-07-07 08:46:02.067256 (Thread-1): 08:46:02  Acquiring new snowflake connection "rpc.ecommerce_data_model_dbt.request"
2022-07-07 08:46:02.067410 (Thread-1): 08:46:02  Began compiling node rpc.ecommerce_data_model_dbt.request
2022-07-07 08:46:02.067523 (Thread-1): 08:46:02  Compiling rpc.ecommerce_data_model_dbt.request
2022-07-07 08:46:02.071079 (Thread-1): 08:46:02  finished collecting timing info
2022-07-07 08:46:02.071208 (Thread-1): 08:46:02  Began executing node rpc.ecommerce_data_model_dbt.request
2022-07-07 08:46:02.073453 (Thread-1): 08:46:02  Using snowflake connection "rpc.ecommerce_data_model_dbt.request"
2022-07-07 08:46:02.073552 (Thread-1): 08:46:02  On rpc.ecommerce_data_model_dbt.request: with cte_gender as ANALYTICS_DB.dbt_ecommerce features.gender,

cte_age as ANALYTICS_DB.dbt_ecommerce features.age,

cte_location as ANALYTICS_DB.dbt_ecommerce features.country_and_state,

cte_email_domain as ANALYTICS_DB.dbt_ecommerce features.email_domain,

cte_is_member as ANALYTICS_DB.dbt_ecommerce features.is_member,

cte_has_mobile_app as ANALYTICS_DB.dbt_ecommerce features.has_mobile_app,

cte_is_active_on_website as ANALYTICS_DB.dbt_ecommerce features.is_active_on_website,

cte_device_type as ANALYTICS_DB.dbt_ecommerce features.device_type,

select coalesce(a.user_id, b.user_id, c.user_id, d.user_id, e.user_id, f.user_id, g.user_id, h.user_id) 
as user_id, gender, (select country from cte_location) as country, (select state from cte_location) as state, email_domain, is_member, has_mobile_app, is_active_on_website, device_type
from ((((((cte_gender a full outer join cte_age b on a.user_id = b.user_id) 
full outer join cte_location c on c.user_id = coalesce(a.user_id, b.user_id))
full outer join cte_email_domain d on d.user_id = coalesce(a.user_id, b.user_id, c.user_id))
full outer join cte_is_member e on e.user_id = coalesce(a.user_id, b.user_id, c.user_id,d.user_id))
full outer join cte_has_mobile_app f on f.user_id = coalesce(a.user_id, b.user_id, c.user_id,d.user_id, e.user_id))
full outer join cte_is_active_on_website as g on g.user_id = coalesce(a.user_id, b.user_id, c.user_id,d.user_id, e.user_id, f.user_id))
full outer join cte_device_type as h on h.user_id = coalesce(a.user_id, b.user_id, c.user_id,d.user_id, e.user_id, f.user_id, g.user_id)
limit 500
/* limit added automatically by dbt cloud */
2022-07-07 08:46:02.073634 (Thread-1): 08:46:02  Opening a new connection, currently in state init
2022-07-07 08:46:02.469707 (Thread-263): handling poll request
2022-07-07 08:46:02.470156 (Thread-263): 08:46:02  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '196d9207-3e38-4101-ac43-bc898fbec1a7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f52140fa2e0>]}
2022-07-07 08:46:02.499182 (Thread-263): sending response (<Response 5402 bytes [200 OK]>) to 10.0.41.177
2022-07-07 08:46:02.703099 (Thread-1): 08:46:02  Snowflake adapter: Snowflake query id: 01a5718e-0602-333e-0019-8203046b79de
2022-07-07 08:46:02.703384 (Thread-1): 08:46:02  Snowflake adapter: Snowflake error: 001003 (42000): SQL compilation error:
syntax error line 1 at position 19 unexpected 'ANALYTICS_DB'.
syntax error line 1 at position 46 unexpected 'features'.
syntax error line 3 at position 11 unexpected 'ANALYTICS_DB'.
syntax error line 3 at position 38 unexpected 'features'.
syntax error line 5 at position 16 unexpected 'ANALYTICS_DB'.
syntax error line 5 at position 43 unexpected 'features'.
syntax error line 7 at position 20 unexpected 'ANALYTICS_DB'.
syntax error line 7 at position 47 unexpected 'features'.
syntax error line 9 at position 17 unexpected 'ANALYTICS_DB'.
syntax error line 9 at position 44 unexpected 'features'.
syntax error line 11 at position 22 unexpected 'ANALYTICS_DB'.
syntax error line 11 at position 49 unexpected 'features'.
syntax error line 13 at position 28 unexpected 'ANALYTICS_DB'.
syntax error line 13 at position 55 unexpected 'features'.
syntax error line 15 at position 19 unexpected 'ANALYTICS_DB'.
syntax error line 15 at position 46 unexpected 'features'.
syntax error line 17 at position 0 unexpected 'select'.
syntax error line 17 at position 16 unexpected 'a'.
syntax error line 18 at position 0 unexpected 'as'.
2022-07-07 08:46:02.703584 (Thread-1): 08:46:02  finished collecting timing info
2022-07-07 08:46:02.703845 (Thread-1): 08:46:02  On rpc.ecommerce_data_model_dbt.request: Close
2022-07-07 08:46:02.768432 (Thread-1): Got an exception: Database Error
  001003 (42000): SQL compilation error:
  syntax error line 1 at position 19 unexpected 'ANALYTICS_DB'.
  syntax error line 1 at position 46 unexpected 'features'.
  syntax error line 3 at position 11 unexpected 'ANALYTICS_DB'.
  syntax error line 3 at position 38 unexpected 'features'.
  syntax error line 5 at position 16 unexpected 'ANALYTICS_DB'.
  syntax error line 5 at position 43 unexpected 'features'.
  syntax error line 7 at position 20 unexpected 'ANALYTICS_DB'.
  syntax error line 7 at position 47 unexpected 'features'.
  syntax error line 9 at position 17 unexpected 'ANALYTICS_DB'.
  syntax error line 9 at position 44 unexpected 'features'.
  syntax error line 11 at position 22 unexpected 'ANALYTICS_DB'.
  syntax error line 11 at position 49 unexpected 'features'.
  syntax error line 13 at position 28 unexpected 'ANALYTICS_DB'.
  syntax error line 13 at position 55 unexpected 'features'.
  syntax error line 15 at position 19 unexpected 'ANALYTICS_DB'.
  syntax error line 15 at position 46 unexpected 'features'.
  syntax error line 17 at position 0 unexpected 'select'.
  syntax error line 17 at position 16 unexpected 'a'.
  syntax error line 18 at position 0 unexpected 'as'.
Traceback (most recent call last):
  File "/usr/local/lib/python3.8/dist-packages/dbt/adapters/snowflake/connections.py", line 206, in exception_handler
    yield
  File "/usr/local/lib/python3.8/dist-packages/dbt/adapters/sql/connections.py", line 74, in add_query
    cursor.execute(sql, bindings)
  File "/usr/local/lib/python3.8/dist-packages/snowflake/connector/cursor.py", line 721, in execute
    Error.errorhandler_wrapper(
  File "/usr/local/lib/python3.8/dist-packages/snowflake/connector/errors.py", line 258, in errorhandler_wrapper
    cursor.errorhandler(connection, cursor, error_class, error_value)
  File "/usr/local/lib/python3.8/dist-packages/snowflake/connector/errors.py", line 188, in default_errorhandler
    raise error_class(
snowflake.connector.errors.ProgrammingError: 001003 (42000): SQL compilation error:
syntax error line 1 at position 19 unexpected 'ANALYTICS_DB'.
syntax error line 1 at position 46 unexpected 'features'.
syntax error line 3 at position 11 unexpected 'ANALYTICS_DB'.
syntax error line 3 at position 38 unexpected 'features'.
syntax error line 5 at position 16 unexpected 'ANALYTICS_DB'.
syntax error line 5 at position 43 unexpected 'features'.
syntax error line 7 at position 20 unexpected 'ANALYTICS_DB'.
syntax error line 7 at position 47 unexpected 'features'.
syntax error line 9 at position 17 unexpected 'ANALYTICS_DB'.
syntax error line 9 at position 44 unexpected 'features'.
syntax error line 11 at position 22 unexpected 'ANALYTICS_DB'.
syntax error line 11 at position 49 unexpected 'features'.
syntax error line 13 at position 28 unexpected 'ANALYTICS_DB'.
syntax error line 13 at position 55 unexpected 'features'.
syntax error line 15 at position 19 unexpected 'ANALYTICS_DB'.
syntax error line 15 at position 46 unexpected 'features'.
syntax error line 17 at position 0 unexpected 'select'.
syntax error line 17 at position 16 unexpected 'a'.
syntax error line 18 at position 0 unexpected 'as'.

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/usr/local/lib/python3.8/dist-packages/dbt/task/base.py", line 361, in safe_run
    result = self.compile_and_execute(manifest, ctx)
  File "/usr/local/lib/python3.8/dist-packages/dbt/task/base.py", line 314, in compile_and_execute
    result = self.run(ctx.node, manifest)
  File "/usr/local/lib/python3.8/dist-packages/dbt/task/base.py", line 403, in run
    return self.execute(compiled_node, manifest)
  File "/usr/local/lib/python3.8/dist-packages/dbt_rpc/rpc/node_runners.py", line 90, in execute
    _, execute_result = self.adapter.execute(
  File "/usr/local/lib/python3.8/dist-packages/dbt/adapters/base/impl.py", line 225, in execute
    return self.connections.execute(
  File "/usr/local/lib/python3.8/dist-packages/dbt/adapters/sql/connections.py", line 127, in execute
    _, cursor = self.add_query(sql, auto_begin)
  File "/usr/local/lib/python3.8/dist-packages/dbt/adapters/snowflake/connections.py", line 433, in add_query
    connection, cursor = super().add_query(
  File "/usr/local/lib/python3.8/dist-packages/dbt/adapters/sql/connections.py", line 83, in add_query
    return connection, cursor
  File "/usr/lib/python3.8/contextlib.py", line 131, in __exit__
    self.gen.throw(type, value, traceback)
  File "/usr/local/lib/python3.8/dist-packages/dbt/adapters/snowflake/connections.py", line 223, in exception_handler
    raise DatabaseException(msg)
dbt.exceptions.DatabaseException: Database Error
  001003 (42000): SQL compilation error:
  syntax error line 1 at position 19 unexpected 'ANALYTICS_DB'.
  syntax error line 1 at position 46 unexpected 'features'.
  syntax error line 3 at position 11 unexpected 'ANALYTICS_DB'.
  syntax error line 3 at position 38 unexpected 'features'.
  syntax error line 5 at position 16 unexpected 'ANALYTICS_DB'.
  syntax error line 5 at position 43 unexpected 'features'.
  syntax error line 7 at position 20 unexpected 'ANALYTICS_DB'.
  syntax error line 7 at position 47 unexpected 'features'.
  syntax error line 9 at position 17 unexpected 'ANALYTICS_DB'.
  syntax error line 9 at position 44 unexpected 'features'.
  syntax error line 11 at position 22 unexpected 'ANALYTICS_DB'.
  syntax error line 11 at position 49 unexpected 'features'.
  syntax error line 13 at position 28 unexpected 'ANALYTICS_DB'.
  syntax error line 13 at position 55 unexpected 'features'.
  syntax error line 15 at position 19 unexpected 'ANALYTICS_DB'.
  syntax error line 15 at position 46 unexpected 'features'.
  syntax error line 17 at position 0 unexpected 'select'.
  syntax error line 17 at position 16 unexpected 'a'.
  syntax error line 18 at position 0 unexpected 'as'.
2022-07-07 08:46:02.769186 (Thread-1): Got exception RPCException(10003, Database Error, {'type': 'DatabaseException', 'message': "Database Error in rpc request (from remote system)\n  001003 (42000): SQL compilation error:\n  syntax error line 1 at position 19 unexpected 'ANALYTICS_DB'.\n  syntax error line 1 at position 46 unexpected 'features'.\n  syntax error line 3 at position 11 unexpected 'ANALYTICS_DB'.\n  syntax error line 3 at position 38 unexpected 'features'.\n  syntax error line 5 at position 16 unexpected 'ANALYTICS_DB'.\n  syntax error line 5 at position 43 unexpected 'features'.\n  syntax error line 7 at position 20 unexpected 'ANALYTICS_DB'.\n  syntax error line 7 at position 47 unexpected 'features'.\n  syntax error line 9 at position 17 unexpected 'ANALYTICS_DB'.\n  syntax error line 9 at position 44 unexpected 'features'.\n  syntax error line 11 at position 22 unexpected 'ANALYTICS_DB'.\n  syntax error line 11 at position 49 unexpected 'features'.\n  syntax error line 13 at position 28 unexpected 'ANALYTICS_DB'.\n  syntax error line 13 at position 55 unexpected 'features'.\n  syntax error line 15 at position 19 unexpected 'ANALYTICS_DB'.\n  syntax error line 15 at position 46 unexpected 'features'.\n  syntax error line 17 at position 0 unexpected 'select'.\n  syntax error line 17 at position 16 unexpected 'a'.\n  syntax error line 18 at position 0 unexpected 'as'.", 'raw_sql': "with cte_gender as {{ ref('gender') }},\r\n\r\ncte_age as {{ ref('age') }},\r\n\r\ncte_location as {{ ref('country_and_state') }},\r\n\r\ncte_email_domain as {{ ref('email_domain') }},\r\n\r\ncte_is_member as {{ ref('is_member') }},\r\n\r\ncte_has_mobile_app as {{ ref('has_mobile_app') }},\r\n\r\ncte_is_active_on_website as {{ ref('is_active_on_website') }},\r\n\r\ncte_device_type as {{ ref('device_type') }},\r\n\r\nselect coalesce(a.user_id, b.user_id, c.user_id, d.user_id, e.user_id, f.user_id, g.user_id, h.user_id) \r\nas user_id, gender, (select country from cte_location) as country, (select state from cte_location) as state, email_domain, is_member, has_mobile_app, is_active_on_website, device_type\r\nfrom ((((((cte_gender a full outer join cte_age b on a.user_id = b.user_id) \r\nfull outer join cte_location c on c.user_id = coalesce(a.user_id, b.user_id))\r\nfull outer join cte_email_domain d on d.user_id = coalesce(a.user_id, b.user_id, c.user_id))\r\nfull outer join cte_is_member e on e.user_id = coalesce(a.user_id, b.user_id, c.user_id,d.user_id))\r\nfull outer join cte_has_mobile_app f on f.user_id = coalesce(a.user_id, b.user_id, c.user_id,d.user_id, e.user_id))\r\nfull outer join cte_is_active_on_website as g on g.user_id = coalesce(a.user_id, b.user_id, c.user_id,d.user_id, e.user_id, f.user_id))\r\nfull outer join cte_device_type as h on h.user_id = coalesce(a.user_id, b.user_id, c.user_id,d.user_id, e.user_id, f.user_id, g.user_id)\nlimit 500\n/* limit added automatically by dbt cloud */", 'compiled_sql': 'with cte_gender as ANALYTICS_DB.dbt_ecommerce features.gender,\n\ncte_age as ANALYTICS_DB.dbt_ecommerce features.age,\n\ncte_location as ANALYTICS_DB.dbt_ecommerce features.country_and_state,\n\ncte_email_domain as ANALYTICS_DB.dbt_ecommerce features.email_domain,\n\ncte_is_member as ANALYTICS_DB.dbt_ecommerce features.is_member,\n\ncte_has_mobile_app as ANALYTICS_DB.dbt_ecommerce features.has_mobile_app,\n\ncte_is_active_on_website as ANALYTICS_DB.dbt_ecommerce features.is_active_on_website,\n\ncte_device_type as ANALYTICS_DB.dbt_ecommerce features.device_type,\n\nselect coalesce(a.user_id, b.user_id, c.user_id, d.user_id, e.user_id, f.user_id, g.user_id, h.user_id) \nas user_id, gender, (select country from cte_location) as country, (select state from cte_location) as state, email_domain, is_member, has_mobile_app, is_active_on_website, device_type\nfrom ((((((cte_gender a full outer join cte_age b on a.user_id = b.user_id) \nfull outer join cte_location c on c.user_id = coalesce(a.user_id, b.user_id))\nfull outer join cte_email_domain d on d.user_id = coalesce(a.user_id, b.user_id, c.user_id))\nfull outer join cte_is_member e on e.user_id = coalesce(a.user_id, b.user_id, c.user_id,d.user_id))\nfull outer join cte_has_mobile_app f on f.user_id = coalesce(a.user_id, b.user_id, c.user_id,d.user_id, e.user_id))\nfull outer join cte_is_active_on_website as g on g.user_id = coalesce(a.user_id, b.user_id, c.user_id,d.user_id, e.user_id, f.user_id))\nfull outer join cte_device_type as h on h.user_id = coalesce(a.user_id, b.user_id, c.user_id,d.user_id, e.user_id, f.user_id, g.user_id)\nlimit 500\n/* limit added automatically by dbt cloud */', 'tags': None}, None)
Traceback (most recent call last):
  File "/usr/local/lib/python3.8/dist-packages/dbt_rpc/task/sql_commands.py", line 147, in _in_thread
    self.node_results.append(runner.safe_run(self.manifest))
  File "/usr/local/lib/python3.8/dist-packages/dbt/task/base.py", line 377, in safe_run
    result = self.error_result(ctx.node, error, started, [])
  File "/usr/local/lib/python3.8/dist-packages/dbt_rpc/rpc/node_runners.py", line 56, in error_result
    raise error
dbt_rpc.rpc.error.RPCException: RPCException(10003, Database Error, {'type': 'DatabaseException', 'message': "Database Error in rpc request (from remote system)\n  001003 (42000): SQL compilation error:\n  syntax error line 1 at position 19 unexpected 'ANALYTICS_DB'.\n  syntax error line 1 at position 46 unexpected 'features'.\n  syntax error line 3 at position 11 unexpected 'ANALYTICS_DB'.\n  syntax error line 3 at position 38 unexpected 'features'.\n  syntax error line 5 at position 16 unexpected 'ANALYTICS_DB'.\n  syntax error line 5 at position 43 unexpected 'features'.\n  syntax error line 7 at position 20 unexpected 'ANALYTICS_DB'.\n  syntax error line 7 at position 47 unexpected 'features'.\n  syntax error line 9 at position 17 unexpected 'ANALYTICS_DB'.\n  syntax error line 9 at position 44 unexpected 'features'.\n  syntax error line 11 at position 22 unexpected 'ANALYTICS_DB'.\n  syntax error line 11 at position 49 unexpected 'features'.\n  syntax error line 13 at position 28 unexpected 'ANALYTICS_DB'.\n  syntax error line 13 at position 55 unexpected 'features'.\n  syntax error line 15 at position 19 unexpected 'ANALYTICS_DB'.\n  syntax error line 15 at position 46 unexpected 'features'.\n  syntax error line 17 at position 0 unexpected 'select'.\n  syntax error line 17 at position 16 unexpected 'a'.\n  syntax error line 18 at position 0 unexpected 'as'.", 'raw_sql': "with cte_gender as {{ ref('gender') }},\r\n\r\ncte_age as {{ ref('age') }},\r\n\r\ncte_location as {{ ref('country_and_state') }},\r\n\r\ncte_email_domain as {{ ref('email_domain') }},\r\n\r\ncte_is_member as {{ ref('is_member') }},\r\n\r\ncte_has_mobile_app as {{ ref('has_mobile_app') }},\r\n\r\ncte_is_active_on_website as {{ ref('is_active_on_website') }},\r\n\r\ncte_device_type as {{ ref('device_type') }},\r\n\r\nselect coalesce(a.user_id, b.user_id, c.user_id, d.user_id, e.user_id, f.user_id, g.user_id, h.user_id) \r\nas user_id, gender, (select country from cte_location) as country, (select state from cte_location) as state, email_domain, is_member, has_mobile_app, is_active_on_website, device_type\r\nfrom ((((((cte_gender a full outer join cte_age b on a.user_id = b.user_id) \r\nfull outer join cte_location c on c.user_id = coalesce(a.user_id, b.user_id))\r\nfull outer join cte_email_domain d on d.user_id = coalesce(a.user_id, b.user_id, c.user_id))\r\nfull outer join cte_is_member e on e.user_id = coalesce(a.user_id, b.user_id, c.user_id,d.user_id))\r\nfull outer join cte_has_mobile_app f on f.user_id = coalesce(a.user_id, b.user_id, c.user_id,d.user_id, e.user_id))\r\nfull outer join cte_is_active_on_website as g on g.user_id = coalesce(a.user_id, b.user_id, c.user_id,d.user_id, e.user_id, f.user_id))\r\nfull outer join cte_device_type as h on h.user_id = coalesce(a.user_id, b.user_id, c.user_id,d.user_id, e.user_id, f.user_id, g.user_id)\nlimit 500\n/* limit added automatically by dbt cloud */", 'compiled_sql': 'with cte_gender as ANALYTICS_DB.dbt_ecommerce features.gender,\n\ncte_age as ANALYTICS_DB.dbt_ecommerce features.age,\n\ncte_location as ANALYTICS_DB.dbt_ecommerce features.country_and_state,\n\ncte_email_domain as ANALYTICS_DB.dbt_ecommerce features.email_domain,\n\ncte_is_member as ANALYTICS_DB.dbt_ecommerce features.is_member,\n\ncte_has_mobile_app as ANALYTICS_DB.dbt_ecommerce features.has_mobile_app,\n\ncte_is_active_on_website as ANALYTICS_DB.dbt_ecommerce features.is_active_on_website,\n\ncte_device_type as ANALYTICS_DB.dbt_ecommerce features.device_type,\n\nselect coalesce(a.user_id, b.user_id, c.user_id, d.user_id, e.user_id, f.user_id, g.user_id, h.user_id) \nas user_id, gender, (select country from cte_location) as country, (select state from cte_location) as state, email_domain, is_member, has_mobile_app, is_active_on_website, device_type\nfrom ((((((cte_gender a full outer join cte_age b on a.user_id = b.user_id) \nfull outer join cte_location c on c.user_id = coalesce(a.user_id, b.user_id))\nfull outer join cte_email_domain d on d.user_id = coalesce(a.user_id, b.user_id, c.user_id))\nfull outer join cte_is_member e on e.user_id = coalesce(a.user_id, b.user_id, c.user_id,d.user_id))\nfull outer join cte_has_mobile_app f on f.user_id = coalesce(a.user_id, b.user_id, c.user_id,d.user_id, e.user_id))\nfull outer join cte_is_active_on_website as g on g.user_id = coalesce(a.user_id, b.user_id, c.user_id,d.user_id, e.user_id, f.user_id))\nfull outer join cte_device_type as h on h.user_id = coalesce(a.user_id, b.user_id, c.user_id,d.user_id, e.user_id, f.user_id, g.user_id)\nlimit 500\n/* limit added automatically by dbt cloud */', 'tags': None}, None)
2022-07-07 08:46:03.898661 (Thread-264): handling poll request
2022-07-07 08:46:03.899094 (Thread-264): 08:46:03  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '196d9207-3e38-4101-ac43-bc898fbec1a7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f51ed3448b0>]}
2022-07-07 08:46:03.899910 (Thread-264): sending response (<Response 28598 bytes [200 OK]>) to 10.0.41.177
2022-07-07 08:47:12.241332 (Thread-265): handling status request
2022-07-07 08:47:12.244876 (Thread-265): 08:47:12  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '196d9207-3e38-4101-ac43-bc898fbec1a7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f51ed344c10>]}
2022-07-07 08:47:12.245424 (Thread-265): sending response (<Response 2059 bytes [200 OK]>) to 10.0.41.177
2022-07-07 08:47:12.645674 (Thread-266): handling compile_sql request
2022-07-07 08:47:12.646066 (Thread-266): 08:47:12  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '196d9207-3e38-4101-ac43-bc898fbec1a7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f51ed344c70>]}
2022-07-07 08:47:14.961759 (Thread-266): sending response (<Response 139 bytes [200 OK]>) to 10.0.41.177
2022-07-07 08:47:14.989393 (MainThread): 08:47:14  Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '6ba6bf11-1637-4b94-abb5-82f4901316c1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f62db835130>]}
2022-07-07 08:47:14.989929 (MainThread): 08:47:14  Found 17 models, 0 tests, 0 snapshots, 0 analyses, 181 macros, 0 operations, 0 seed files, 15 sources, 0 exposures, 0 metrics
2022-07-07 08:47:14.990520 (Thread-1): 08:47:14  Acquiring new snowflake connection "rpc.ecommerce_data_model_dbt.request"
2022-07-07 08:47:14.990656 (Thread-1): 08:47:14  Began compiling node rpc.ecommerce_data_model_dbt.request
2022-07-07 08:47:14.990752 (Thread-1): 08:47:14  Compiling rpc.ecommerce_data_model_dbt.request
2022-07-07 08:47:14.994297 (Thread-1): 08:47:14  finished collecting timing info
2022-07-07 08:47:14.994426 (Thread-1): 08:47:14  Began executing node rpc.ecommerce_data_model_dbt.request
2022-07-07 08:47:14.994523 (Thread-1): 08:47:14  finished collecting timing info
2022-07-07 08:47:15.374366 (Thread-267): handling poll request
2022-07-07 08:47:15.374827 (Thread-267): 08:47:15  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '196d9207-3e38-4101-ac43-bc898fbec1a7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f51ed341f70>]}
2022-07-07 08:47:15.376117 (Thread-267): sending response (<Response 11853 bytes [200 OK]>) to 10.0.41.177
2022-07-07 08:48:34.311253 (Thread-268): 08:48:34  Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
2022-07-07 08:48:34.312832 (Thread-268): 08:48:34  Partial parsing: updated file: ecommerce_data_model_dbt://models/data_model/stg_user_traits_new.sql
2022-07-07 08:48:34.317886 (Thread-268): 08:48:34  1699: static parser successfully parsed data_model/stg_user_traits_new.sql
2022-07-07 08:48:34.352863 (Thread-268): 08:48:34  [WARNING]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.data-apps-ecommerce-template.data_model

2022-07-07 08:48:34.359287 (Thread-268): 08:48:34  Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '196d9207-3e38-4101-ac43-bc898fbec1a7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f51ec402e80>]}
2022-07-07 08:48:35.106011 (Thread-269): handling status request
2022-07-07 08:48:35.106419 (Thread-269): 08:48:35  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '196d9207-3e38-4101-ac43-bc898fbec1a7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5214071880>]}
2022-07-07 08:48:35.106941 (Thread-269): sending response (<Response 2059 bytes [200 OK]>) to 10.0.41.177
2022-07-07 08:48:35.172035 (Thread-270): handling status request
2022-07-07 08:48:35.172383 (Thread-270): 08:48:35  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '196d9207-3e38-4101-ac43-bc898fbec1a7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5214071fd0>]}
2022-07-07 08:48:35.172855 (Thread-270): sending response (<Response 2059 bytes [200 OK]>) to 10.0.41.177
2022-07-07 08:48:39.321088 (Thread-271): handling status request
2022-07-07 08:48:39.321490 (Thread-271): 08:48:39  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '196d9207-3e38-4101-ac43-bc898fbec1a7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f51ec125130>]}
2022-07-07 08:48:39.321976 (Thread-271): sending response (<Response 2059 bytes [200 OK]>) to 10.0.41.177
2022-07-07 08:48:39.721586 (Thread-272): handling run_sql request
2022-07-07 08:48:39.721972 (Thread-272): 08:48:39  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '196d9207-3e38-4101-ac43-bc898fbec1a7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f51ec35edc0>]}
2022-07-07 08:48:42.031912 (Thread-272): sending response (<Response 139 bytes [200 OK]>) to 10.0.41.177
2022-07-07 08:48:42.058211 (MainThread): 08:48:42  Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '9347f271-12e6-404f-bb4c-8acb7d6b418a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcdf4bf0610>]}
2022-07-07 08:48:42.058741 (MainThread): 08:48:42  Found 17 models, 0 tests, 0 snapshots, 0 analyses, 181 macros, 0 operations, 0 seed files, 15 sources, 0 exposures, 0 metrics
2022-07-07 08:48:42.059360 (Thread-1): 08:48:42  Acquiring new snowflake connection "rpc.ecommerce_data_model_dbt.request"
2022-07-07 08:48:42.059495 (Thread-1): 08:48:42  Began compiling node rpc.ecommerce_data_model_dbt.request
2022-07-07 08:48:42.059625 (Thread-1): 08:48:42  Compiling rpc.ecommerce_data_model_dbt.request
2022-07-07 08:48:42.063142 (Thread-1): 08:48:42  finished collecting timing info
2022-07-07 08:48:42.063268 (Thread-1): 08:48:42  Began executing node rpc.ecommerce_data_model_dbt.request
2022-07-07 08:48:42.065442 (Thread-1): 08:48:42  Using snowflake connection "rpc.ecommerce_data_model_dbt.request"
2022-07-07 08:48:42.065543 (Thread-1): 08:48:42  On rpc.ecommerce_data_model_dbt.request: with cte_gender as ANALYTICS_DB.dbt_ecommerce features.gender,

cte_age as ANALYTICS_DB.dbt_ecommerce features.age,

cte_location as ANALYTICS_DB.dbt_ecommerce features.country_and_state,

cte_email_domain as ANALYTICS_DB.dbt_ecommerce features.email_domain,

cte_is_member as ANALYTICS_DB.dbt_ecommerce features.is_member,

cte_has_mobile_app as ANALYTICS_DB.dbt_ecommerce features.has_mobile_app,

cte_is_active_on_website as ANALYTICS_DB.dbt_ecommerce features.is_active_on_website,

cte_device_type as ANALYTICS_DB.dbt_ecommerce features.device_type,

select coalesce(a.user_id, b.user_id, c.user_id, d.user_id, e.user_id, f.user_id, g.user_id, h.user_id) 
as user_id, gender, c.country as country, c.state as state, email_domain, is_member, has_mobile_app, is_active_on_website, device_type
from ((((((cte_gender a full outer join cte_age b on a.user_id = b.user_id) 
full outer join cte_location c on c.user_id = coalesce(a.user_id, b.user_id))
full outer join cte_email_domain d on d.user_id = coalesce(a.user_id, b.user_id, c.user_id))
full outer join cte_is_member e on e.user_id = coalesce(a.user_id, b.user_id, c.user_id,d.user_id))
full outer join cte_has_mobile_app f on f.user_id = coalesce(a.user_id, b.user_id, c.user_id,d.user_id, e.user_id))
full outer join cte_is_active_on_website as g on g.user_id = coalesce(a.user_id, b.user_id, c.user_id,d.user_id, e.user_id, f.user_id))
full outer join cte_device_type as h on h.user_id = coalesce(a.user_id, b.user_id, c.user_id,d.user_id, e.user_id, f.user_id, g.user_id)
limit 500
/* limit added automatically by dbt cloud */
2022-07-07 08:48:42.065626 (Thread-1): 08:48:42  Opening a new connection, currently in state init
2022-07-07 08:48:42.422800 (Thread-273): handling poll request
2022-07-07 08:48:42.423272 (Thread-273): 08:48:42  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '196d9207-3e38-4101-ac43-bc898fbec1a7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f51ec407970>]}
2022-07-07 08:48:42.424234 (Thread-273): sending response (<Response 5352 bytes [200 OK]>) to 10.0.41.177
2022-07-07 08:48:42.732835 (Thread-1): 08:48:42  Snowflake adapter: Snowflake query id: 01a57190-0602-3374-0019-8203046b590e
2022-07-07 08:48:42.733031 (Thread-1): 08:48:42  Snowflake adapter: Snowflake error: 001003 (42000): SQL compilation error:
syntax error line 1 at position 19 unexpected 'ANALYTICS_DB'.
syntax error line 1 at position 46 unexpected 'features'.
syntax error line 3 at position 11 unexpected 'ANALYTICS_DB'.
syntax error line 3 at position 38 unexpected 'features'.
syntax error line 5 at position 16 unexpected 'ANALYTICS_DB'.
syntax error line 5 at position 43 unexpected 'features'.
syntax error line 7 at position 20 unexpected 'ANALYTICS_DB'.
syntax error line 7 at position 47 unexpected 'features'.
syntax error line 9 at position 17 unexpected 'ANALYTICS_DB'.
syntax error line 9 at position 44 unexpected 'features'.
syntax error line 11 at position 22 unexpected 'ANALYTICS_DB'.
syntax error line 11 at position 49 unexpected 'features'.
syntax error line 13 at position 28 unexpected 'ANALYTICS_DB'.
syntax error line 13 at position 55 unexpected 'features'.
syntax error line 15 at position 19 unexpected 'ANALYTICS_DB'.
syntax error line 15 at position 46 unexpected 'features'.
syntax error line 17 at position 0 unexpected 'select'.
syntax error line 17 at position 16 unexpected 'a'.
syntax error line 18 at position 0 unexpected 'as'.
2022-07-07 08:48:42.733191 (Thread-1): 08:48:42  finished collecting timing info
2022-07-07 08:48:42.733347 (Thread-1): 08:48:42  On rpc.ecommerce_data_model_dbt.request: Close
2022-07-07 08:48:42.800704 (Thread-1): Got an exception: Database Error
  001003 (42000): SQL compilation error:
  syntax error line 1 at position 19 unexpected 'ANALYTICS_DB'.
  syntax error line 1 at position 46 unexpected 'features'.
  syntax error line 3 at position 11 unexpected 'ANALYTICS_DB'.
  syntax error line 3 at position 38 unexpected 'features'.
  syntax error line 5 at position 16 unexpected 'ANALYTICS_DB'.
  syntax error line 5 at position 43 unexpected 'features'.
  syntax error line 7 at position 20 unexpected 'ANALYTICS_DB'.
  syntax error line 7 at position 47 unexpected 'features'.
  syntax error line 9 at position 17 unexpected 'ANALYTICS_DB'.
  syntax error line 9 at position 44 unexpected 'features'.
  syntax error line 11 at position 22 unexpected 'ANALYTICS_DB'.
  syntax error line 11 at position 49 unexpected 'features'.
  syntax error line 13 at position 28 unexpected 'ANALYTICS_DB'.
  syntax error line 13 at position 55 unexpected 'features'.
  syntax error line 15 at position 19 unexpected 'ANALYTICS_DB'.
  syntax error line 15 at position 46 unexpected 'features'.
  syntax error line 17 at position 0 unexpected 'select'.
  syntax error line 17 at position 16 unexpected 'a'.
  syntax error line 18 at position 0 unexpected 'as'.
Traceback (most recent call last):
  File "/usr/local/lib/python3.8/dist-packages/dbt/adapters/snowflake/connections.py", line 206, in exception_handler
    yield
  File "/usr/local/lib/python3.8/dist-packages/dbt/adapters/sql/connections.py", line 74, in add_query
    cursor.execute(sql, bindings)
  File "/usr/local/lib/python3.8/dist-packages/snowflake/connector/cursor.py", line 721, in execute
    Error.errorhandler_wrapper(
  File "/usr/local/lib/python3.8/dist-packages/snowflake/connector/errors.py", line 258, in errorhandler_wrapper
    cursor.errorhandler(connection, cursor, error_class, error_value)
  File "/usr/local/lib/python3.8/dist-packages/snowflake/connector/errors.py", line 188, in default_errorhandler
    raise error_class(
snowflake.connector.errors.ProgrammingError: 001003 (42000): SQL compilation error:
syntax error line 1 at position 19 unexpected 'ANALYTICS_DB'.
syntax error line 1 at position 46 unexpected 'features'.
syntax error line 3 at position 11 unexpected 'ANALYTICS_DB'.
syntax error line 3 at position 38 unexpected 'features'.
syntax error line 5 at position 16 unexpected 'ANALYTICS_DB'.
syntax error line 5 at position 43 unexpected 'features'.
syntax error line 7 at position 20 unexpected 'ANALYTICS_DB'.
syntax error line 7 at position 47 unexpected 'features'.
syntax error line 9 at position 17 unexpected 'ANALYTICS_DB'.
syntax error line 9 at position 44 unexpected 'features'.
syntax error line 11 at position 22 unexpected 'ANALYTICS_DB'.
syntax error line 11 at position 49 unexpected 'features'.
syntax error line 13 at position 28 unexpected 'ANALYTICS_DB'.
syntax error line 13 at position 55 unexpected 'features'.
syntax error line 15 at position 19 unexpected 'ANALYTICS_DB'.
syntax error line 15 at position 46 unexpected 'features'.
syntax error line 17 at position 0 unexpected 'select'.
syntax error line 17 at position 16 unexpected 'a'.
syntax error line 18 at position 0 unexpected 'as'.

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/usr/local/lib/python3.8/dist-packages/dbt/task/base.py", line 361, in safe_run
    result = self.compile_and_execute(manifest, ctx)
  File "/usr/local/lib/python3.8/dist-packages/dbt/task/base.py", line 314, in compile_and_execute
    result = self.run(ctx.node, manifest)
  File "/usr/local/lib/python3.8/dist-packages/dbt/task/base.py", line 403, in run
    return self.execute(compiled_node, manifest)
  File "/usr/local/lib/python3.8/dist-packages/dbt_rpc/rpc/node_runners.py", line 90, in execute
    _, execute_result = self.adapter.execute(
  File "/usr/local/lib/python3.8/dist-packages/dbt/adapters/base/impl.py", line 225, in execute
    return self.connections.execute(
  File "/usr/local/lib/python3.8/dist-packages/dbt/adapters/sql/connections.py", line 127, in execute
    _, cursor = self.add_query(sql, auto_begin)
  File "/usr/local/lib/python3.8/dist-packages/dbt/adapters/snowflake/connections.py", line 433, in add_query
    connection, cursor = super().add_query(
  File "/usr/local/lib/python3.8/dist-packages/dbt/adapters/sql/connections.py", line 83, in add_query
    return connection, cursor
  File "/usr/lib/python3.8/contextlib.py", line 131, in __exit__
    self.gen.throw(type, value, traceback)
  File "/usr/local/lib/python3.8/dist-packages/dbt/adapters/snowflake/connections.py", line 223, in exception_handler
    raise DatabaseException(msg)
dbt.exceptions.DatabaseException: Database Error
  001003 (42000): SQL compilation error:
  syntax error line 1 at position 19 unexpected 'ANALYTICS_DB'.
  syntax error line 1 at position 46 unexpected 'features'.
  syntax error line 3 at position 11 unexpected 'ANALYTICS_DB'.
  syntax error line 3 at position 38 unexpected 'features'.
  syntax error line 5 at position 16 unexpected 'ANALYTICS_DB'.
  syntax error line 5 at position 43 unexpected 'features'.
  syntax error line 7 at position 20 unexpected 'ANALYTICS_DB'.
  syntax error line 7 at position 47 unexpected 'features'.
  syntax error line 9 at position 17 unexpected 'ANALYTICS_DB'.
  syntax error line 9 at position 44 unexpected 'features'.
  syntax error line 11 at position 22 unexpected 'ANALYTICS_DB'.
  syntax error line 11 at position 49 unexpected 'features'.
  syntax error line 13 at position 28 unexpected 'ANALYTICS_DB'.
  syntax error line 13 at position 55 unexpected 'features'.
  syntax error line 15 at position 19 unexpected 'ANALYTICS_DB'.
  syntax error line 15 at position 46 unexpected 'features'.
  syntax error line 17 at position 0 unexpected 'select'.
  syntax error line 17 at position 16 unexpected 'a'.
  syntax error line 18 at position 0 unexpected 'as'.
2022-07-07 08:48:42.801407 (Thread-1): Got exception RPCException(10003, Database Error, {'type': 'DatabaseException', 'message': "Database Error in rpc request (from remote system)\n  001003 (42000): SQL compilation error:\n  syntax error line 1 at position 19 unexpected 'ANALYTICS_DB'.\n  syntax error line 1 at position 46 unexpected 'features'.\n  syntax error line 3 at position 11 unexpected 'ANALYTICS_DB'.\n  syntax error line 3 at position 38 unexpected 'features'.\n  syntax error line 5 at position 16 unexpected 'ANALYTICS_DB'.\n  syntax error line 5 at position 43 unexpected 'features'.\n  syntax error line 7 at position 20 unexpected 'ANALYTICS_DB'.\n  syntax error line 7 at position 47 unexpected 'features'.\n  syntax error line 9 at position 17 unexpected 'ANALYTICS_DB'.\n  syntax error line 9 at position 44 unexpected 'features'.\n  syntax error line 11 at position 22 unexpected 'ANALYTICS_DB'.\n  syntax error line 11 at position 49 unexpected 'features'.\n  syntax error line 13 at position 28 unexpected 'ANALYTICS_DB'.\n  syntax error line 13 at position 55 unexpected 'features'.\n  syntax error line 15 at position 19 unexpected 'ANALYTICS_DB'.\n  syntax error line 15 at position 46 unexpected 'features'.\n  syntax error line 17 at position 0 unexpected 'select'.\n  syntax error line 17 at position 16 unexpected 'a'.\n  syntax error line 18 at position 0 unexpected 'as'.", 'raw_sql': "with cte_gender as {{ ref('gender') }},\r\n\r\ncte_age as {{ ref('age') }},\r\n\r\ncte_location as {{ ref('country_and_state') }},\r\n\r\ncte_email_domain as {{ ref('email_domain') }},\r\n\r\ncte_is_member as {{ ref('is_member') }},\r\n\r\ncte_has_mobile_app as {{ ref('has_mobile_app') }},\r\n\r\ncte_is_active_on_website as {{ ref('is_active_on_website') }},\r\n\r\ncte_device_type as {{ ref('device_type') }},\r\n\r\nselect coalesce(a.user_id, b.user_id, c.user_id, d.user_id, e.user_id, f.user_id, g.user_id, h.user_id) \r\nas user_id, gender, c.country as country, c.state as state, email_domain, is_member, has_mobile_app, is_active_on_website, device_type\r\nfrom ((((((cte_gender a full outer join cte_age b on a.user_id = b.user_id) \r\nfull outer join cte_location c on c.user_id = coalesce(a.user_id, b.user_id))\r\nfull outer join cte_email_domain d on d.user_id = coalesce(a.user_id, b.user_id, c.user_id))\r\nfull outer join cte_is_member e on e.user_id = coalesce(a.user_id, b.user_id, c.user_id,d.user_id))\r\nfull outer join cte_has_mobile_app f on f.user_id = coalesce(a.user_id, b.user_id, c.user_id,d.user_id, e.user_id))\r\nfull outer join cte_is_active_on_website as g on g.user_id = coalesce(a.user_id, b.user_id, c.user_id,d.user_id, e.user_id, f.user_id))\r\nfull outer join cte_device_type as h on h.user_id = coalesce(a.user_id, b.user_id, c.user_id,d.user_id, e.user_id, f.user_id, g.user_id)\nlimit 500\n/* limit added automatically by dbt cloud */", 'compiled_sql': 'with cte_gender as ANALYTICS_DB.dbt_ecommerce features.gender,\n\ncte_age as ANALYTICS_DB.dbt_ecommerce features.age,\n\ncte_location as ANALYTICS_DB.dbt_ecommerce features.country_and_state,\n\ncte_email_domain as ANALYTICS_DB.dbt_ecommerce features.email_domain,\n\ncte_is_member as ANALYTICS_DB.dbt_ecommerce features.is_member,\n\ncte_has_mobile_app as ANALYTICS_DB.dbt_ecommerce features.has_mobile_app,\n\ncte_is_active_on_website as ANALYTICS_DB.dbt_ecommerce features.is_active_on_website,\n\ncte_device_type as ANALYTICS_DB.dbt_ecommerce features.device_type,\n\nselect coalesce(a.user_id, b.user_id, c.user_id, d.user_id, e.user_id, f.user_id, g.user_id, h.user_id) \nas user_id, gender, c.country as country, c.state as state, email_domain, is_member, has_mobile_app, is_active_on_website, device_type\nfrom ((((((cte_gender a full outer join cte_age b on a.user_id = b.user_id) \nfull outer join cte_location c on c.user_id = coalesce(a.user_id, b.user_id))\nfull outer join cte_email_domain d on d.user_id = coalesce(a.user_id, b.user_id, c.user_id))\nfull outer join cte_is_member e on e.user_id = coalesce(a.user_id, b.user_id, c.user_id,d.user_id))\nfull outer join cte_has_mobile_app f on f.user_id = coalesce(a.user_id, b.user_id, c.user_id,d.user_id, e.user_id))\nfull outer join cte_is_active_on_website as g on g.user_id = coalesce(a.user_id, b.user_id, c.user_id,d.user_id, e.user_id, f.user_id))\nfull outer join cte_device_type as h on h.user_id = coalesce(a.user_id, b.user_id, c.user_id,d.user_id, e.user_id, f.user_id, g.user_id)\nlimit 500\n/* limit added automatically by dbt cloud */', 'tags': None}, None)
Traceback (most recent call last):
  File "/usr/local/lib/python3.8/dist-packages/dbt_rpc/task/sql_commands.py", line 147, in _in_thread
    self.node_results.append(runner.safe_run(self.manifest))
  File "/usr/local/lib/python3.8/dist-packages/dbt/task/base.py", line 377, in safe_run
    result = self.error_result(ctx.node, error, started, [])
  File "/usr/local/lib/python3.8/dist-packages/dbt_rpc/rpc/node_runners.py", line 56, in error_result
    raise error
dbt_rpc.rpc.error.RPCException: RPCException(10003, Database Error, {'type': 'DatabaseException', 'message': "Database Error in rpc request (from remote system)\n  001003 (42000): SQL compilation error:\n  syntax error line 1 at position 19 unexpected 'ANALYTICS_DB'.\n  syntax error line 1 at position 46 unexpected 'features'.\n  syntax error line 3 at position 11 unexpected 'ANALYTICS_DB'.\n  syntax error line 3 at position 38 unexpected 'features'.\n  syntax error line 5 at position 16 unexpected 'ANALYTICS_DB'.\n  syntax error line 5 at position 43 unexpected 'features'.\n  syntax error line 7 at position 20 unexpected 'ANALYTICS_DB'.\n  syntax error line 7 at position 47 unexpected 'features'.\n  syntax error line 9 at position 17 unexpected 'ANALYTICS_DB'.\n  syntax error line 9 at position 44 unexpected 'features'.\n  syntax error line 11 at position 22 unexpected 'ANALYTICS_DB'.\n  syntax error line 11 at position 49 unexpected 'features'.\n  syntax error line 13 at position 28 unexpected 'ANALYTICS_DB'.\n  syntax error line 13 at position 55 unexpected 'features'.\n  syntax error line 15 at position 19 unexpected 'ANALYTICS_DB'.\n  syntax error line 15 at position 46 unexpected 'features'.\n  syntax error line 17 at position 0 unexpected 'select'.\n  syntax error line 17 at position 16 unexpected 'a'.\n  syntax error line 18 at position 0 unexpected 'as'.", 'raw_sql': "with cte_gender as {{ ref('gender') }},\r\n\r\ncte_age as {{ ref('age') }},\r\n\r\ncte_location as {{ ref('country_and_state') }},\r\n\r\ncte_email_domain as {{ ref('email_domain') }},\r\n\r\ncte_is_member as {{ ref('is_member') }},\r\n\r\ncte_has_mobile_app as {{ ref('has_mobile_app') }},\r\n\r\ncte_is_active_on_website as {{ ref('is_active_on_website') }},\r\n\r\ncte_device_type as {{ ref('device_type') }},\r\n\r\nselect coalesce(a.user_id, b.user_id, c.user_id, d.user_id, e.user_id, f.user_id, g.user_id, h.user_id) \r\nas user_id, gender, c.country as country, c.state as state, email_domain, is_member, has_mobile_app, is_active_on_website, device_type\r\nfrom ((((((cte_gender a full outer join cte_age b on a.user_id = b.user_id) \r\nfull outer join cte_location c on c.user_id = coalesce(a.user_id, b.user_id))\r\nfull outer join cte_email_domain d on d.user_id = coalesce(a.user_id, b.user_id, c.user_id))\r\nfull outer join cte_is_member e on e.user_id = coalesce(a.user_id, b.user_id, c.user_id,d.user_id))\r\nfull outer join cte_has_mobile_app f on f.user_id = coalesce(a.user_id, b.user_id, c.user_id,d.user_id, e.user_id))\r\nfull outer join cte_is_active_on_website as g on g.user_id = coalesce(a.user_id, b.user_id, c.user_id,d.user_id, e.user_id, f.user_id))\r\nfull outer join cte_device_type as h on h.user_id = coalesce(a.user_id, b.user_id, c.user_id,d.user_id, e.user_id, f.user_id, g.user_id)\nlimit 500\n/* limit added automatically by dbt cloud */", 'compiled_sql': 'with cte_gender as ANALYTICS_DB.dbt_ecommerce features.gender,\n\ncte_age as ANALYTICS_DB.dbt_ecommerce features.age,\n\ncte_location as ANALYTICS_DB.dbt_ecommerce features.country_and_state,\n\ncte_email_domain as ANALYTICS_DB.dbt_ecommerce features.email_domain,\n\ncte_is_member as ANALYTICS_DB.dbt_ecommerce features.is_member,\n\ncte_has_mobile_app as ANALYTICS_DB.dbt_ecommerce features.has_mobile_app,\n\ncte_is_active_on_website as ANALYTICS_DB.dbt_ecommerce features.is_active_on_website,\n\ncte_device_type as ANALYTICS_DB.dbt_ecommerce features.device_type,\n\nselect coalesce(a.user_id, b.user_id, c.user_id, d.user_id, e.user_id, f.user_id, g.user_id, h.user_id) \nas user_id, gender, c.country as country, c.state as state, email_domain, is_member, has_mobile_app, is_active_on_website, device_type\nfrom ((((((cte_gender a full outer join cte_age b on a.user_id = b.user_id) \nfull outer join cte_location c on c.user_id = coalesce(a.user_id, b.user_id))\nfull outer join cte_email_domain d on d.user_id = coalesce(a.user_id, b.user_id, c.user_id))\nfull outer join cte_is_member e on e.user_id = coalesce(a.user_id, b.user_id, c.user_id,d.user_id))\nfull outer join cte_has_mobile_app f on f.user_id = coalesce(a.user_id, b.user_id, c.user_id,d.user_id, e.user_id))\nfull outer join cte_is_active_on_website as g on g.user_id = coalesce(a.user_id, b.user_id, c.user_id,d.user_id, e.user_id, f.user_id))\nfull outer join cte_device_type as h on h.user_id = coalesce(a.user_id, b.user_id, c.user_id,d.user_id, e.user_id, f.user_id, g.user_id)\nlimit 500\n/* limit added automatically by dbt cloud */', 'tags': None}, None)
2022-07-07 08:48:43.826196 (Thread-274): handling poll request
2022-07-07 08:48:43.826629 (Thread-274): 08:48:43  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '196d9207-3e38-4101-ac43-bc898fbec1a7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f51ec407df0>]}
2022-07-07 08:48:43.827343 (Thread-274): sending response (<Response 28248 bytes [200 OK]>) to 10.0.41.177
2022-07-07 08:48:56.967149 (Thread-275): 08:48:56  Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
2022-07-07 08:48:56.967713 (Thread-275): 08:48:56  Partial parsing: updated file: ecommerce_data_model_dbt://models/data_model/stg_user_traits_new.sql
2022-07-07 08:48:56.972149 (Thread-275): 08:48:56  1699: static parser successfully parsed data_model/stg_user_traits_new.sql
2022-07-07 08:48:57.007703 (Thread-275): 08:48:57  [WARNING]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.data-apps-ecommerce-template.data_model

2022-07-07 08:48:57.012905 (Thread-275): 08:48:57  Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '196d9207-3e38-4101-ac43-bc898fbec1a7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f51ec1f8850>]}
2022-07-07 08:48:57.940183 (Thread-276): handling status request
2022-07-07 08:48:57.940585 (Thread-276): 08:48:57  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '196d9207-3e38-4101-ac43-bc898fbec1a7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f51ec2205e0>]}
2022-07-07 08:48:57.941096 (Thread-276): sending response (<Response 2059 bytes [200 OK]>) to 10.0.41.177
2022-07-07 08:48:57.954451 (Thread-277): handling status request
2022-07-07 08:48:57.954727 (Thread-277): 08:48:57  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '196d9207-3e38-4101-ac43-bc898fbec1a7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f51ec220850>]}
2022-07-07 08:48:57.955135 (Thread-277): sending response (<Response 2059 bytes [200 OK]>) to 10.0.41.177
2022-07-07 08:48:58.390978 (Thread-278): handling status request
2022-07-07 08:48:58.391428 (Thread-278): 08:48:58  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '196d9207-3e38-4101-ac43-bc898fbec1a7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f51ec2200a0>]}
2022-07-07 08:48:58.391963 (Thread-278): sending response (<Response 2059 bytes [200 OK]>) to 10.0.41.177
2022-07-07 08:48:58.798276 (Thread-279): handling run_sql request
2022-07-07 08:48:58.798647 (Thread-279): 08:48:58  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '196d9207-3e38-4101-ac43-bc898fbec1a7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f51ec220ee0>]}
2022-07-07 08:49:01.158307 (Thread-279): sending response (<Response 139 bytes [200 OK]>) to 10.0.41.177
2022-07-07 08:49:01.184989 (MainThread): 08:49:01  Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '9b126fd5-97cf-4725-ba62-e424fb7812b0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f80afb74e50>]}
2022-07-07 08:49:01.185537 (MainThread): 08:49:01  Found 17 models, 0 tests, 0 snapshots, 0 analyses, 181 macros, 0 operations, 0 seed files, 15 sources, 0 exposures, 0 metrics
2022-07-07 08:49:01.186123 (Thread-1): 08:49:01  Acquiring new snowflake connection "rpc.ecommerce_data_model_dbt.request"
2022-07-07 08:49:01.186249 (Thread-1): 08:49:01  Began compiling node rpc.ecommerce_data_model_dbt.request
2022-07-07 08:49:01.186343 (Thread-1): 08:49:01  Compiling rpc.ecommerce_data_model_dbt.request
2022-07-07 08:49:01.190027 (Thread-1): 08:49:01  finished collecting timing info
2022-07-07 08:49:01.190176 (Thread-1): 08:49:01  Began executing node rpc.ecommerce_data_model_dbt.request
2022-07-07 08:49:01.192354 (Thread-1): 08:49:01  Using snowflake connection "rpc.ecommerce_data_model_dbt.request"
2022-07-07 08:49:01.192454 (Thread-1): 08:49:01  On rpc.ecommerce_data_model_dbt.request: with cte_gender as ANALYTICS_DB.dbt_ecommerce features.gender,

cte_age as ANALYTICS_DB.dbt_ecommerce features.age,

cte_location as ANALYTICS_DB.dbt_ecommerce features.country_and_state,

cte_email_domain as ANALYTICS_DB.dbt_ecommerce features.email_domain,

cte_is_member as ANALYTICS_DB.dbt_ecommerce features.is_member,

cte_has_mobile_app as ANALYTICS_DB.dbt_ecommerce features.has_mobile_app,

cte_is_active_on_website as ANALYTICS_DB.dbt_ecommerce features.is_active_on_website,

cte_device_type as ANALYTICS_DB.dbt_ecommerce features.device_type

select coalesce(a.user_id, b.user_id, c.user_id, d.user_id, e.user_id, f.user_id, g.user_id, h.user_id) 
as user_id, gender, c.country as country, c.state as state, email_domain, is_member, has_mobile_app, is_active_on_website, device_type
from ((((((cte_gender a full outer join cte_age b on a.user_id = b.user_id) 
full outer join cte_location c on c.user_id = coalesce(a.user_id, b.user_id))
full outer join cte_email_domain d on d.user_id = coalesce(a.user_id, b.user_id, c.user_id))
full outer join cte_is_member e on e.user_id = coalesce(a.user_id, b.user_id, c.user_id,d.user_id))
full outer join cte_has_mobile_app f on f.user_id = coalesce(a.user_id, b.user_id, c.user_id,d.user_id, e.user_id))
full outer join cte_is_active_on_website as g on g.user_id = coalesce(a.user_id, b.user_id, c.user_id,d.user_id, e.user_id, f.user_id))
full outer join cte_device_type as h on h.user_id = coalesce(a.user_id, b.user_id, c.user_id,d.user_id, e.user_id, f.user_id, g.user_id)
limit 500
/* limit added automatically by dbt cloud */
2022-07-07 08:49:01.192535 (Thread-1): 08:49:01  Opening a new connection, currently in state init
2022-07-07 08:49:01.579300 (Thread-280): handling poll request
2022-07-07 08:49:01.579796 (Thread-280): 08:49:01  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '196d9207-3e38-4101-ac43-bc898fbec1a7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f51ec4189d0>]}
2022-07-07 08:49:01.580693 (Thread-280): sending response (<Response 5351 bytes [200 OK]>) to 10.0.41.177
2022-07-07 08:49:01.821801 (Thread-1): 08:49:01  Snowflake adapter: Snowflake query id: 01a57191-0602-3441-0019-8203046b4c76
2022-07-07 08:49:01.821995 (Thread-1): 08:49:01  Snowflake adapter: Snowflake error: 001003 (42000): SQL compilation error:
syntax error line 1 at position 19 unexpected 'ANALYTICS_DB'.
syntax error line 1 at position 46 unexpected 'features'.
syntax error line 3 at position 11 unexpected 'ANALYTICS_DB'.
syntax error line 3 at position 38 unexpected 'features'.
syntax error line 5 at position 16 unexpected 'ANALYTICS_DB'.
syntax error line 5 at position 43 unexpected 'features'.
syntax error line 7 at position 20 unexpected 'ANALYTICS_DB'.
syntax error line 7 at position 47 unexpected 'features'.
syntax error line 9 at position 17 unexpected 'ANALYTICS_DB'.
syntax error line 9 at position 44 unexpected 'features'.
syntax error line 11 at position 22 unexpected 'ANALYTICS_DB'.
syntax error line 11 at position 49 unexpected 'features'.
syntax error line 13 at position 28 unexpected 'ANALYTICS_DB'.
syntax error line 13 at position 55 unexpected 'features'.
syntax error line 15 at position 19 unexpected 'ANALYTICS_DB'.
syntax error line 15 at position 46 unexpected 'features'.
2022-07-07 08:49:01.822154 (Thread-1): 08:49:01  finished collecting timing info
2022-07-07 08:49:01.822311 (Thread-1): 08:49:01  On rpc.ecommerce_data_model_dbt.request: Close
2022-07-07 08:49:01.879633 (Thread-1): Got an exception: Database Error
  001003 (42000): SQL compilation error:
  syntax error line 1 at position 19 unexpected 'ANALYTICS_DB'.
  syntax error line 1 at position 46 unexpected 'features'.
  syntax error line 3 at position 11 unexpected 'ANALYTICS_DB'.
  syntax error line 3 at position 38 unexpected 'features'.
  syntax error line 5 at position 16 unexpected 'ANALYTICS_DB'.
  syntax error line 5 at position 43 unexpected 'features'.
  syntax error line 7 at position 20 unexpected 'ANALYTICS_DB'.
  syntax error line 7 at position 47 unexpected 'features'.
  syntax error line 9 at position 17 unexpected 'ANALYTICS_DB'.
  syntax error line 9 at position 44 unexpected 'features'.
  syntax error line 11 at position 22 unexpected 'ANALYTICS_DB'.
  syntax error line 11 at position 49 unexpected 'features'.
  syntax error line 13 at position 28 unexpected 'ANALYTICS_DB'.
  syntax error line 13 at position 55 unexpected 'features'.
  syntax error line 15 at position 19 unexpected 'ANALYTICS_DB'.
  syntax error line 15 at position 46 unexpected 'features'.
Traceback (most recent call last):
  File "/usr/local/lib/python3.8/dist-packages/dbt/adapters/snowflake/connections.py", line 206, in exception_handler
    yield
  File "/usr/local/lib/python3.8/dist-packages/dbt/adapters/sql/connections.py", line 74, in add_query
    cursor.execute(sql, bindings)
  File "/usr/local/lib/python3.8/dist-packages/snowflake/connector/cursor.py", line 721, in execute
    Error.errorhandler_wrapper(
  File "/usr/local/lib/python3.8/dist-packages/snowflake/connector/errors.py", line 258, in errorhandler_wrapper
    cursor.errorhandler(connection, cursor, error_class, error_value)
  File "/usr/local/lib/python3.8/dist-packages/snowflake/connector/errors.py", line 188, in default_errorhandler
    raise error_class(
snowflake.connector.errors.ProgrammingError: 001003 (42000): SQL compilation error:
syntax error line 1 at position 19 unexpected 'ANALYTICS_DB'.
syntax error line 1 at position 46 unexpected 'features'.
syntax error line 3 at position 11 unexpected 'ANALYTICS_DB'.
syntax error line 3 at position 38 unexpected 'features'.
syntax error line 5 at position 16 unexpected 'ANALYTICS_DB'.
syntax error line 5 at position 43 unexpected 'features'.
syntax error line 7 at position 20 unexpected 'ANALYTICS_DB'.
syntax error line 7 at position 47 unexpected 'features'.
syntax error line 9 at position 17 unexpected 'ANALYTICS_DB'.
syntax error line 9 at position 44 unexpected 'features'.
syntax error line 11 at position 22 unexpected 'ANALYTICS_DB'.
syntax error line 11 at position 49 unexpected 'features'.
syntax error line 13 at position 28 unexpected 'ANALYTICS_DB'.
syntax error line 13 at position 55 unexpected 'features'.
syntax error line 15 at position 19 unexpected 'ANALYTICS_DB'.
syntax error line 15 at position 46 unexpected 'features'.

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/usr/local/lib/python3.8/dist-packages/dbt/task/base.py", line 361, in safe_run
    result = self.compile_and_execute(manifest, ctx)
  File "/usr/local/lib/python3.8/dist-packages/dbt/task/base.py", line 314, in compile_and_execute
    result = self.run(ctx.node, manifest)
  File "/usr/local/lib/python3.8/dist-packages/dbt/task/base.py", line 403, in run
    return self.execute(compiled_node, manifest)
  File "/usr/local/lib/python3.8/dist-packages/dbt_rpc/rpc/node_runners.py", line 90, in execute
    _, execute_result = self.adapter.execute(
  File "/usr/local/lib/python3.8/dist-packages/dbt/adapters/base/impl.py", line 225, in execute
    return self.connections.execute(
  File "/usr/local/lib/python3.8/dist-packages/dbt/adapters/sql/connections.py", line 127, in execute
    _, cursor = self.add_query(sql, auto_begin)
  File "/usr/local/lib/python3.8/dist-packages/dbt/adapters/snowflake/connections.py", line 433, in add_query
    connection, cursor = super().add_query(
  File "/usr/local/lib/python3.8/dist-packages/dbt/adapters/sql/connections.py", line 83, in add_query
    return connection, cursor
  File "/usr/lib/python3.8/contextlib.py", line 131, in __exit__
    self.gen.throw(type, value, traceback)
  File "/usr/local/lib/python3.8/dist-packages/dbt/adapters/snowflake/connections.py", line 223, in exception_handler
    raise DatabaseException(msg)
dbt.exceptions.DatabaseException: Database Error
  001003 (42000): SQL compilation error:
  syntax error line 1 at position 19 unexpected 'ANALYTICS_DB'.
  syntax error line 1 at position 46 unexpected 'features'.
  syntax error line 3 at position 11 unexpected 'ANALYTICS_DB'.
  syntax error line 3 at position 38 unexpected 'features'.
  syntax error line 5 at position 16 unexpected 'ANALYTICS_DB'.
  syntax error line 5 at position 43 unexpected 'features'.
  syntax error line 7 at position 20 unexpected 'ANALYTICS_DB'.
  syntax error line 7 at position 47 unexpected 'features'.
  syntax error line 9 at position 17 unexpected 'ANALYTICS_DB'.
  syntax error line 9 at position 44 unexpected 'features'.
  syntax error line 11 at position 22 unexpected 'ANALYTICS_DB'.
  syntax error line 11 at position 49 unexpected 'features'.
  syntax error line 13 at position 28 unexpected 'ANALYTICS_DB'.
  syntax error line 13 at position 55 unexpected 'features'.
  syntax error line 15 at position 19 unexpected 'ANALYTICS_DB'.
  syntax error line 15 at position 46 unexpected 'features'.
2022-07-07 08:49:01.880345 (Thread-1): Got exception RPCException(10003, Database Error, {'type': 'DatabaseException', 'message': "Database Error in rpc request (from remote system)\n  001003 (42000): SQL compilation error:\n  syntax error line 1 at position 19 unexpected 'ANALYTICS_DB'.\n  syntax error line 1 at position 46 unexpected 'features'.\n  syntax error line 3 at position 11 unexpected 'ANALYTICS_DB'.\n  syntax error line 3 at position 38 unexpected 'features'.\n  syntax error line 5 at position 16 unexpected 'ANALYTICS_DB'.\n  syntax error line 5 at position 43 unexpected 'features'.\n  syntax error line 7 at position 20 unexpected 'ANALYTICS_DB'.\n  syntax error line 7 at position 47 unexpected 'features'.\n  syntax error line 9 at position 17 unexpected 'ANALYTICS_DB'.\n  syntax error line 9 at position 44 unexpected 'features'.\n  syntax error line 11 at position 22 unexpected 'ANALYTICS_DB'.\n  syntax error line 11 at position 49 unexpected 'features'.\n  syntax error line 13 at position 28 unexpected 'ANALYTICS_DB'.\n  syntax error line 13 at position 55 unexpected 'features'.\n  syntax error line 15 at position 19 unexpected 'ANALYTICS_DB'.\n  syntax error line 15 at position 46 unexpected 'features'.", 'raw_sql': "with cte_gender as {{ ref('gender') }},\r\n\r\ncte_age as {{ ref('age') }},\r\n\r\ncte_location as {{ ref('country_and_state') }},\r\n\r\ncte_email_domain as {{ ref('email_domain') }},\r\n\r\ncte_is_member as {{ ref('is_member') }},\r\n\r\ncte_has_mobile_app as {{ ref('has_mobile_app') }},\r\n\r\ncte_is_active_on_website as {{ ref('is_active_on_website') }},\r\n\r\ncte_device_type as {{ ref('device_type') }}\r\n\r\nselect coalesce(a.user_id, b.user_id, c.user_id, d.user_id, e.user_id, f.user_id, g.user_id, h.user_id) \r\nas user_id, gender, c.country as country, c.state as state, email_domain, is_member, has_mobile_app, is_active_on_website, device_type\r\nfrom ((((((cte_gender a full outer join cte_age b on a.user_id = b.user_id) \r\nfull outer join cte_location c on c.user_id = coalesce(a.user_id, b.user_id))\r\nfull outer join cte_email_domain d on d.user_id = coalesce(a.user_id, b.user_id, c.user_id))\r\nfull outer join cte_is_member e on e.user_id = coalesce(a.user_id, b.user_id, c.user_id,d.user_id))\r\nfull outer join cte_has_mobile_app f on f.user_id = coalesce(a.user_id, b.user_id, c.user_id,d.user_id, e.user_id))\r\nfull outer join cte_is_active_on_website as g on g.user_id = coalesce(a.user_id, b.user_id, c.user_id,d.user_id, e.user_id, f.user_id))\r\nfull outer join cte_device_type as h on h.user_id = coalesce(a.user_id, b.user_id, c.user_id,d.user_id, e.user_id, f.user_id, g.user_id)\nlimit 500\n/* limit added automatically by dbt cloud */", 'compiled_sql': 'with cte_gender as ANALYTICS_DB.dbt_ecommerce features.gender,\n\ncte_age as ANALYTICS_DB.dbt_ecommerce features.age,\n\ncte_location as ANALYTICS_DB.dbt_ecommerce features.country_and_state,\n\ncte_email_domain as ANALYTICS_DB.dbt_ecommerce features.email_domain,\n\ncte_is_member as ANALYTICS_DB.dbt_ecommerce features.is_member,\n\ncte_has_mobile_app as ANALYTICS_DB.dbt_ecommerce features.has_mobile_app,\n\ncte_is_active_on_website as ANALYTICS_DB.dbt_ecommerce features.is_active_on_website,\n\ncte_device_type as ANALYTICS_DB.dbt_ecommerce features.device_type\n\nselect coalesce(a.user_id, b.user_id, c.user_id, d.user_id, e.user_id, f.user_id, g.user_id, h.user_id) \nas user_id, gender, c.country as country, c.state as state, email_domain, is_member, has_mobile_app, is_active_on_website, device_type\nfrom ((((((cte_gender a full outer join cte_age b on a.user_id = b.user_id) \nfull outer join cte_location c on c.user_id = coalesce(a.user_id, b.user_id))\nfull outer join cte_email_domain d on d.user_id = coalesce(a.user_id, b.user_id, c.user_id))\nfull outer join cte_is_member e on e.user_id = coalesce(a.user_id, b.user_id, c.user_id,d.user_id))\nfull outer join cte_has_mobile_app f on f.user_id = coalesce(a.user_id, b.user_id, c.user_id,d.user_id, e.user_id))\nfull outer join cte_is_active_on_website as g on g.user_id = coalesce(a.user_id, b.user_id, c.user_id,d.user_id, e.user_id, f.user_id))\nfull outer join cte_device_type as h on h.user_id = coalesce(a.user_id, b.user_id, c.user_id,d.user_id, e.user_id, f.user_id, g.user_id)\nlimit 500\n/* limit added automatically by dbt cloud */', 'tags': None}, None)
Traceback (most recent call last):
  File "/usr/local/lib/python3.8/dist-packages/dbt_rpc/task/sql_commands.py", line 147, in _in_thread
    self.node_results.append(runner.safe_run(self.manifest))
  File "/usr/local/lib/python3.8/dist-packages/dbt/task/base.py", line 377, in safe_run
    result = self.error_result(ctx.node, error, started, [])
  File "/usr/local/lib/python3.8/dist-packages/dbt_rpc/rpc/node_runners.py", line 56, in error_result
    raise error
dbt_rpc.rpc.error.RPCException: RPCException(10003, Database Error, {'type': 'DatabaseException', 'message': "Database Error in rpc request (from remote system)\n  001003 (42000): SQL compilation error:\n  syntax error line 1 at position 19 unexpected 'ANALYTICS_DB'.\n  syntax error line 1 at position 46 unexpected 'features'.\n  syntax error line 3 at position 11 unexpected 'ANALYTICS_DB'.\n  syntax error line 3 at position 38 unexpected 'features'.\n  syntax error line 5 at position 16 unexpected 'ANALYTICS_DB'.\n  syntax error line 5 at position 43 unexpected 'features'.\n  syntax error line 7 at position 20 unexpected 'ANALYTICS_DB'.\n  syntax error line 7 at position 47 unexpected 'features'.\n  syntax error line 9 at position 17 unexpected 'ANALYTICS_DB'.\n  syntax error line 9 at position 44 unexpected 'features'.\n  syntax error line 11 at position 22 unexpected 'ANALYTICS_DB'.\n  syntax error line 11 at position 49 unexpected 'features'.\n  syntax error line 13 at position 28 unexpected 'ANALYTICS_DB'.\n  syntax error line 13 at position 55 unexpected 'features'.\n  syntax error line 15 at position 19 unexpected 'ANALYTICS_DB'.\n  syntax error line 15 at position 46 unexpected 'features'.", 'raw_sql': "with cte_gender as {{ ref('gender') }},\r\n\r\ncte_age as {{ ref('age') }},\r\n\r\ncte_location as {{ ref('country_and_state') }},\r\n\r\ncte_email_domain as {{ ref('email_domain') }},\r\n\r\ncte_is_member as {{ ref('is_member') }},\r\n\r\ncte_has_mobile_app as {{ ref('has_mobile_app') }},\r\n\r\ncte_is_active_on_website as {{ ref('is_active_on_website') }},\r\n\r\ncte_device_type as {{ ref('device_type') }}\r\n\r\nselect coalesce(a.user_id, b.user_id, c.user_id, d.user_id, e.user_id, f.user_id, g.user_id, h.user_id) \r\nas user_id, gender, c.country as country, c.state as state, email_domain, is_member, has_mobile_app, is_active_on_website, device_type\r\nfrom ((((((cte_gender a full outer join cte_age b on a.user_id = b.user_id) \r\nfull outer join cte_location c on c.user_id = coalesce(a.user_id, b.user_id))\r\nfull outer join cte_email_domain d on d.user_id = coalesce(a.user_id, b.user_id, c.user_id))\r\nfull outer join cte_is_member e on e.user_id = coalesce(a.user_id, b.user_id, c.user_id,d.user_id))\r\nfull outer join cte_has_mobile_app f on f.user_id = coalesce(a.user_id, b.user_id, c.user_id,d.user_id, e.user_id))\r\nfull outer join cte_is_active_on_website as g on g.user_id = coalesce(a.user_id, b.user_id, c.user_id,d.user_id, e.user_id, f.user_id))\r\nfull outer join cte_device_type as h on h.user_id = coalesce(a.user_id, b.user_id, c.user_id,d.user_id, e.user_id, f.user_id, g.user_id)\nlimit 500\n/* limit added automatically by dbt cloud */", 'compiled_sql': 'with cte_gender as ANALYTICS_DB.dbt_ecommerce features.gender,\n\ncte_age as ANALYTICS_DB.dbt_ecommerce features.age,\n\ncte_location as ANALYTICS_DB.dbt_ecommerce features.country_and_state,\n\ncte_email_domain as ANALYTICS_DB.dbt_ecommerce features.email_domain,\n\ncte_is_member as ANALYTICS_DB.dbt_ecommerce features.is_member,\n\ncte_has_mobile_app as ANALYTICS_DB.dbt_ecommerce features.has_mobile_app,\n\ncte_is_active_on_website as ANALYTICS_DB.dbt_ecommerce features.is_active_on_website,\n\ncte_device_type as ANALYTICS_DB.dbt_ecommerce features.device_type\n\nselect coalesce(a.user_id, b.user_id, c.user_id, d.user_id, e.user_id, f.user_id, g.user_id, h.user_id) \nas user_id, gender, c.country as country, c.state as state, email_domain, is_member, has_mobile_app, is_active_on_website, device_type\nfrom ((((((cte_gender a full outer join cte_age b on a.user_id = b.user_id) \nfull outer join cte_location c on c.user_id = coalesce(a.user_id, b.user_id))\nfull outer join cte_email_domain d on d.user_id = coalesce(a.user_id, b.user_id, c.user_id))\nfull outer join cte_is_member e on e.user_id = coalesce(a.user_id, b.user_id, c.user_id,d.user_id))\nfull outer join cte_has_mobile_app f on f.user_id = coalesce(a.user_id, b.user_id, c.user_id,d.user_id, e.user_id))\nfull outer join cte_is_active_on_website as g on g.user_id = coalesce(a.user_id, b.user_id, c.user_id,d.user_id, e.user_id, f.user_id))\nfull outer join cte_device_type as h on h.user_id = coalesce(a.user_id, b.user_id, c.user_id,d.user_id, e.user_id, f.user_id, g.user_id)\nlimit 500\n/* limit added automatically by dbt cloud */', 'tags': None}, None)
2022-07-07 08:49:02.988097 (Thread-281): handling poll request
2022-07-07 08:49:02.988514 (Thread-281): 08:49:02  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '196d9207-3e38-4101-ac43-bc898fbec1a7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f51ec406df0>]}
2022-07-07 08:49:02.989225 (Thread-281): sending response (<Response 27064 bytes [200 OK]>) to 10.0.41.177
2022-07-07 08:49:23.724540 (Thread-282): handling status request
2022-07-07 08:49:23.724953 (Thread-282): 08:49:23  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '196d9207-3e38-4101-ac43-bc898fbec1a7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f51ec1f8cd0>]}
2022-07-07 08:49:23.725508 (Thread-282): sending response (<Response 2036 bytes [200 OK]>) to 10.0.41.177
2022-07-07 08:49:23.746972 (Thread-283): handling list request
2022-07-07 08:49:23.747263 (Thread-283): 08:49:23  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '196d9207-3e38-4101-ac43-bc898fbec1a7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f51ec1f8a00>]}
2022-07-07 08:49:23.777874 (Thread-283): 08:49:23  Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '196d9207-3e38-4101-ac43-bc898fbec1a7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f51ec38b070>]}
2022-07-07 08:49:23.778175 (Thread-283): 08:49:23  Found 17 models, 0 tests, 0 snapshots, 0 analyses, 181 macros, 0 operations, 0 seed files, 15 sources, 0 exposures, 0 metrics
2022-07-07 08:49:23.781527 (Thread-283): sending response (<Response 2112 bytes [200 OK]>) to 10.0.41.177
2022-07-07 08:49:26.105037 (Thread-284): handling status request
2022-07-07 08:49:26.105445 (Thread-284): 08:49:26  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '196d9207-3e38-4101-ac43-bc898fbec1a7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f51ec1f9820>]}
2022-07-07 08:49:26.105946 (Thread-284): sending response (<Response 2059 bytes [200 OK]>) to 10.0.41.177
2022-07-07 08:49:26.534596 (Thread-285): handling run_sql request
2022-07-07 08:49:26.534996 (Thread-285): 08:49:26  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '196d9207-3e38-4101-ac43-bc898fbec1a7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f51ec1f97c0>]}
2022-07-07 08:49:28.891861 (Thread-285): sending response (<Response 139 bytes [200 OK]>) to 10.0.41.177
2022-07-07 08:49:28.918400 (MainThread): 08:49:28  Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '6f4f39ea-f8cc-4cd2-86fb-c1c59d15e939', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f91aea86730>]}
2022-07-07 08:49:28.918973 (MainThread): 08:49:28  Found 17 models, 0 tests, 0 snapshots, 0 analyses, 181 macros, 0 operations, 0 seed files, 15 sources, 0 exposures, 0 metrics
2022-07-07 08:49:28.919562 (Thread-1): 08:49:28  Acquiring new snowflake connection "rpc.ecommerce_data_model_dbt.request"
2022-07-07 08:49:28.919716 (Thread-1): 08:49:28  Began compiling node rpc.ecommerce_data_model_dbt.request
2022-07-07 08:49:28.919810 (Thread-1): 08:49:28  Compiling rpc.ecommerce_data_model_dbt.request
2022-07-07 08:49:28.923354 (Thread-1): 08:49:28  finished collecting timing info
2022-07-07 08:49:28.923482 (Thread-1): 08:49:28  Began executing node rpc.ecommerce_data_model_dbt.request
2022-07-07 08:49:28.925683 (Thread-1): 08:49:28  Using snowflake connection "rpc.ecommerce_data_model_dbt.request"
2022-07-07 08:49:28.925790 (Thread-1): 08:49:28  On rpc.ecommerce_data_model_dbt.request: with cte_gender as ANALYTICS_DB.dbt_ecommerce features.gender,

cte_age as ANALYTICS_DB.dbt_ecommerce features.age,

cte_location as ANALYTICS_DB.dbt_ecommerce features.country_and_state,

cte_email_domain as ANALYTICS_DB.dbt_ecommerce features.email_domain,

cte_is_member as ANALYTICS_DB.dbt_ecommerce features.is_member,

cte_has_mobile_app as ANALYTICS_DB.dbt_ecommerce features.has_mobile_app,

cte_is_active_on_website as ANALYTICS_DB.dbt_ecommerce features.is_active_on_website,

cte_device_type as ANALYTICS_DB.dbt_ecommerce features.device_type

select coalesce(a.user_id, b.user_id, c.user_id, d.user_id, e.user_id, f.user_id, g.user_id, h.user_id) 
as user_id, gender, c.country as country, c.state as state, email_domain, is_member, has_mobile_app, is_active_on_website, device_type
from ((((((cte_gender a full outer join cte_age b on a.user_id = b.user_id) 
full outer join cte_location c on c.user_id = coalesce(a.user_id, b.user_id))
full outer join cte_email_domain d on d.user_id = coalesce(a.user_id, b.user_id, c.user_id))
full outer join cte_is_member e on e.user_id = coalesce(a.user_id, b.user_id, c.user_id,d.user_id))
full outer join cte_has_mobile_app f on f.user_id = coalesce(a.user_id, b.user_id, c.user_id,d.user_id, e.user_id))
full outer join cte_is_active_on_website as g on g.user_id = coalesce(a.user_id, b.user_id, c.user_id,d.user_id, e.user_id, f.user_id))
full outer join cte_device_type as h on h.user_id = coalesce(a.user_id, b.user_id, c.user_id,d.user_id, e.user_id, f.user_id, g.user_id)
limit 500
/* limit added automatically by dbt cloud */
2022-07-07 08:49:28.925874 (Thread-1): 08:49:28  Opening a new connection, currently in state init
2022-07-07 08:49:29.293249 (Thread-286): handling poll request
2022-07-07 08:49:29.293732 (Thread-286): 08:49:29  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '196d9207-3e38-4101-ac43-bc898fbec1a7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f51ec20e400>]}
2022-07-07 08:49:29.294651 (Thread-286): sending response (<Response 5351 bytes [200 OK]>) to 10.0.41.177
2022-07-07 08:49:29.601869 (Thread-1): 08:49:29  Snowflake adapter: Snowflake query id: 01a57191-0602-3374-0019-8203046b5912
2022-07-07 08:49:29.602064 (Thread-1): 08:49:29  Snowflake adapter: Snowflake error: 001003 (42000): SQL compilation error:
syntax error line 1 at position 19 unexpected 'ANALYTICS_DB'.
syntax error line 1 at position 46 unexpected 'features'.
syntax error line 3 at position 11 unexpected 'ANALYTICS_DB'.
syntax error line 3 at position 38 unexpected 'features'.
syntax error line 5 at position 16 unexpected 'ANALYTICS_DB'.
syntax error line 5 at position 43 unexpected 'features'.
syntax error line 7 at position 20 unexpected 'ANALYTICS_DB'.
syntax error line 7 at position 47 unexpected 'features'.
syntax error line 9 at position 17 unexpected 'ANALYTICS_DB'.
syntax error line 9 at position 44 unexpected 'features'.
syntax error line 11 at position 22 unexpected 'ANALYTICS_DB'.
syntax error line 11 at position 49 unexpected 'features'.
syntax error line 13 at position 28 unexpected 'ANALYTICS_DB'.
syntax error line 13 at position 55 unexpected 'features'.
syntax error line 15 at position 19 unexpected 'ANALYTICS_DB'.
syntax error line 15 at position 46 unexpected 'features'.
2022-07-07 08:49:29.602223 (Thread-1): 08:49:29  finished collecting timing info
2022-07-07 08:49:29.602382 (Thread-1): 08:49:29  On rpc.ecommerce_data_model_dbt.request: Close
2022-07-07 08:49:29.650209 (Thread-1): Got an exception: Database Error
  001003 (42000): SQL compilation error:
  syntax error line 1 at position 19 unexpected 'ANALYTICS_DB'.
  syntax error line 1 at position 46 unexpected 'features'.
  syntax error line 3 at position 11 unexpected 'ANALYTICS_DB'.
  syntax error line 3 at position 38 unexpected 'features'.
  syntax error line 5 at position 16 unexpected 'ANALYTICS_DB'.
  syntax error line 5 at position 43 unexpected 'features'.
  syntax error line 7 at position 20 unexpected 'ANALYTICS_DB'.
  syntax error line 7 at position 47 unexpected 'features'.
  syntax error line 9 at position 17 unexpected 'ANALYTICS_DB'.
  syntax error line 9 at position 44 unexpected 'features'.
  syntax error line 11 at position 22 unexpected 'ANALYTICS_DB'.
  syntax error line 11 at position 49 unexpected 'features'.
  syntax error line 13 at position 28 unexpected 'ANALYTICS_DB'.
  syntax error line 13 at position 55 unexpected 'features'.
  syntax error line 15 at position 19 unexpected 'ANALYTICS_DB'.
  syntax error line 15 at position 46 unexpected 'features'.
Traceback (most recent call last):
  File "/usr/local/lib/python3.8/dist-packages/dbt/adapters/snowflake/connections.py", line 206, in exception_handler
    yield
  File "/usr/local/lib/python3.8/dist-packages/dbt/adapters/sql/connections.py", line 74, in add_query
    cursor.execute(sql, bindings)
  File "/usr/local/lib/python3.8/dist-packages/snowflake/connector/cursor.py", line 721, in execute
    Error.errorhandler_wrapper(
  File "/usr/local/lib/python3.8/dist-packages/snowflake/connector/errors.py", line 258, in errorhandler_wrapper
    cursor.errorhandler(connection, cursor, error_class, error_value)
  File "/usr/local/lib/python3.8/dist-packages/snowflake/connector/errors.py", line 188, in default_errorhandler
    raise error_class(
snowflake.connector.errors.ProgrammingError: 001003 (42000): SQL compilation error:
syntax error line 1 at position 19 unexpected 'ANALYTICS_DB'.
syntax error line 1 at position 46 unexpected 'features'.
syntax error line 3 at position 11 unexpected 'ANALYTICS_DB'.
syntax error line 3 at position 38 unexpected 'features'.
syntax error line 5 at position 16 unexpected 'ANALYTICS_DB'.
syntax error line 5 at position 43 unexpected 'features'.
syntax error line 7 at position 20 unexpected 'ANALYTICS_DB'.
syntax error line 7 at position 47 unexpected 'features'.
syntax error line 9 at position 17 unexpected 'ANALYTICS_DB'.
syntax error line 9 at position 44 unexpected 'features'.
syntax error line 11 at position 22 unexpected 'ANALYTICS_DB'.
syntax error line 11 at position 49 unexpected 'features'.
syntax error line 13 at position 28 unexpected 'ANALYTICS_DB'.
syntax error line 13 at position 55 unexpected 'features'.
syntax error line 15 at position 19 unexpected 'ANALYTICS_DB'.
syntax error line 15 at position 46 unexpected 'features'.

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/usr/local/lib/python3.8/dist-packages/dbt/task/base.py", line 361, in safe_run
    result = self.compile_and_execute(manifest, ctx)
  File "/usr/local/lib/python3.8/dist-packages/dbt/task/base.py", line 314, in compile_and_execute
    result = self.run(ctx.node, manifest)
  File "/usr/local/lib/python3.8/dist-packages/dbt/task/base.py", line 403, in run
    return self.execute(compiled_node, manifest)
  File "/usr/local/lib/python3.8/dist-packages/dbt_rpc/rpc/node_runners.py", line 90, in execute
    _, execute_result = self.adapter.execute(
  File "/usr/local/lib/python3.8/dist-packages/dbt/adapters/base/impl.py", line 225, in execute
    return self.connections.execute(
  File "/usr/local/lib/python3.8/dist-packages/dbt/adapters/sql/connections.py", line 127, in execute
    _, cursor = self.add_query(sql, auto_begin)
  File "/usr/local/lib/python3.8/dist-packages/dbt/adapters/snowflake/connections.py", line 433, in add_query
    connection, cursor = super().add_query(
  File "/usr/local/lib/python3.8/dist-packages/dbt/adapters/sql/connections.py", line 83, in add_query
    return connection, cursor
  File "/usr/lib/python3.8/contextlib.py", line 131, in __exit__
    self.gen.throw(type, value, traceback)
  File "/usr/local/lib/python3.8/dist-packages/dbt/adapters/snowflake/connections.py", line 223, in exception_handler
    raise DatabaseException(msg)
dbt.exceptions.DatabaseException: Database Error
  001003 (42000): SQL compilation error:
  syntax error line 1 at position 19 unexpected 'ANALYTICS_DB'.
  syntax error line 1 at position 46 unexpected 'features'.
  syntax error line 3 at position 11 unexpected 'ANALYTICS_DB'.
  syntax error line 3 at position 38 unexpected 'features'.
  syntax error line 5 at position 16 unexpected 'ANALYTICS_DB'.
  syntax error line 5 at position 43 unexpected 'features'.
  syntax error line 7 at position 20 unexpected 'ANALYTICS_DB'.
  syntax error line 7 at position 47 unexpected 'features'.
  syntax error line 9 at position 17 unexpected 'ANALYTICS_DB'.
  syntax error line 9 at position 44 unexpected 'features'.
  syntax error line 11 at position 22 unexpected 'ANALYTICS_DB'.
  syntax error line 11 at position 49 unexpected 'features'.
  syntax error line 13 at position 28 unexpected 'ANALYTICS_DB'.
  syntax error line 13 at position 55 unexpected 'features'.
  syntax error line 15 at position 19 unexpected 'ANALYTICS_DB'.
  syntax error line 15 at position 46 unexpected 'features'.
2022-07-07 08:49:29.650877 (Thread-1): Got exception RPCException(10003, Database Error, {'type': 'DatabaseException', 'message': "Database Error in rpc request (from remote system)\n  001003 (42000): SQL compilation error:\n  syntax error line 1 at position 19 unexpected 'ANALYTICS_DB'.\n  syntax error line 1 at position 46 unexpected 'features'.\n  syntax error line 3 at position 11 unexpected 'ANALYTICS_DB'.\n  syntax error line 3 at position 38 unexpected 'features'.\n  syntax error line 5 at position 16 unexpected 'ANALYTICS_DB'.\n  syntax error line 5 at position 43 unexpected 'features'.\n  syntax error line 7 at position 20 unexpected 'ANALYTICS_DB'.\n  syntax error line 7 at position 47 unexpected 'features'.\n  syntax error line 9 at position 17 unexpected 'ANALYTICS_DB'.\n  syntax error line 9 at position 44 unexpected 'features'.\n  syntax error line 11 at position 22 unexpected 'ANALYTICS_DB'.\n  syntax error line 11 at position 49 unexpected 'features'.\n  syntax error line 13 at position 28 unexpected 'ANALYTICS_DB'.\n  syntax error line 13 at position 55 unexpected 'features'.\n  syntax error line 15 at position 19 unexpected 'ANALYTICS_DB'.\n  syntax error line 15 at position 46 unexpected 'features'.", 'raw_sql': "with cte_gender as {{ ref('gender') }},\r\n\r\ncte_age as {{ ref('age') }},\r\n\r\ncte_location as {{ ref('country_and_state') }},\r\n\r\ncte_email_domain as {{ ref('email_domain') }},\r\n\r\ncte_is_member as {{ ref('is_member') }},\r\n\r\ncte_has_mobile_app as {{ ref('has_mobile_app') }},\r\n\r\ncte_is_active_on_website as {{ ref('is_active_on_website') }},\r\n\r\ncte_device_type as {{ ref('device_type') }}\r\n\r\nselect coalesce(a.user_id, b.user_id, c.user_id, d.user_id, e.user_id, f.user_id, g.user_id, h.user_id) \r\nas user_id, gender, c.country as country, c.state as state, email_domain, is_member, has_mobile_app, is_active_on_website, device_type\r\nfrom ((((((cte_gender a full outer join cte_age b on a.user_id = b.user_id) \r\nfull outer join cte_location c on c.user_id = coalesce(a.user_id, b.user_id))\r\nfull outer join cte_email_domain d on d.user_id = coalesce(a.user_id, b.user_id, c.user_id))\r\nfull outer join cte_is_member e on e.user_id = coalesce(a.user_id, b.user_id, c.user_id,d.user_id))\r\nfull outer join cte_has_mobile_app f on f.user_id = coalesce(a.user_id, b.user_id, c.user_id,d.user_id, e.user_id))\r\nfull outer join cte_is_active_on_website as g on g.user_id = coalesce(a.user_id, b.user_id, c.user_id,d.user_id, e.user_id, f.user_id))\r\nfull outer join cte_device_type as h on h.user_id = coalesce(a.user_id, b.user_id, c.user_id,d.user_id, e.user_id, f.user_id, g.user_id)\nlimit 500\n/* limit added automatically by dbt cloud */", 'compiled_sql': 'with cte_gender as ANALYTICS_DB.dbt_ecommerce features.gender,\n\ncte_age as ANALYTICS_DB.dbt_ecommerce features.age,\n\ncte_location as ANALYTICS_DB.dbt_ecommerce features.country_and_state,\n\ncte_email_domain as ANALYTICS_DB.dbt_ecommerce features.email_domain,\n\ncte_is_member as ANALYTICS_DB.dbt_ecommerce features.is_member,\n\ncte_has_mobile_app as ANALYTICS_DB.dbt_ecommerce features.has_mobile_app,\n\ncte_is_active_on_website as ANALYTICS_DB.dbt_ecommerce features.is_active_on_website,\n\ncte_device_type as ANALYTICS_DB.dbt_ecommerce features.device_type\n\nselect coalesce(a.user_id, b.user_id, c.user_id, d.user_id, e.user_id, f.user_id, g.user_id, h.user_id) \nas user_id, gender, c.country as country, c.state as state, email_domain, is_member, has_mobile_app, is_active_on_website, device_type\nfrom ((((((cte_gender a full outer join cte_age b on a.user_id = b.user_id) \nfull outer join cte_location c on c.user_id = coalesce(a.user_id, b.user_id))\nfull outer join cte_email_domain d on d.user_id = coalesce(a.user_id, b.user_id, c.user_id))\nfull outer join cte_is_member e on e.user_id = coalesce(a.user_id, b.user_id, c.user_id,d.user_id))\nfull outer join cte_has_mobile_app f on f.user_id = coalesce(a.user_id, b.user_id, c.user_id,d.user_id, e.user_id))\nfull outer join cte_is_active_on_website as g on g.user_id = coalesce(a.user_id, b.user_id, c.user_id,d.user_id, e.user_id, f.user_id))\nfull outer join cte_device_type as h on h.user_id = coalesce(a.user_id, b.user_id, c.user_id,d.user_id, e.user_id, f.user_id, g.user_id)\nlimit 500\n/* limit added automatically by dbt cloud */', 'tags': None}, None)
Traceback (most recent call last):
  File "/usr/local/lib/python3.8/dist-packages/dbt_rpc/task/sql_commands.py", line 147, in _in_thread
    self.node_results.append(runner.safe_run(self.manifest))
  File "/usr/local/lib/python3.8/dist-packages/dbt/task/base.py", line 377, in safe_run
    result = self.error_result(ctx.node, error, started, [])
  File "/usr/local/lib/python3.8/dist-packages/dbt_rpc/rpc/node_runners.py", line 56, in error_result
    raise error
dbt_rpc.rpc.error.RPCException: RPCException(10003, Database Error, {'type': 'DatabaseException', 'message': "Database Error in rpc request (from remote system)\n  001003 (42000): SQL compilation error:\n  syntax error line 1 at position 19 unexpected 'ANALYTICS_DB'.\n  syntax error line 1 at position 46 unexpected 'features'.\n  syntax error line 3 at position 11 unexpected 'ANALYTICS_DB'.\n  syntax error line 3 at position 38 unexpected 'features'.\n  syntax error line 5 at position 16 unexpected 'ANALYTICS_DB'.\n  syntax error line 5 at position 43 unexpected 'features'.\n  syntax error line 7 at position 20 unexpected 'ANALYTICS_DB'.\n  syntax error line 7 at position 47 unexpected 'features'.\n  syntax error line 9 at position 17 unexpected 'ANALYTICS_DB'.\n  syntax error line 9 at position 44 unexpected 'features'.\n  syntax error line 11 at position 22 unexpected 'ANALYTICS_DB'.\n  syntax error line 11 at position 49 unexpected 'features'.\n  syntax error line 13 at position 28 unexpected 'ANALYTICS_DB'.\n  syntax error line 13 at position 55 unexpected 'features'.\n  syntax error line 15 at position 19 unexpected 'ANALYTICS_DB'.\n  syntax error line 15 at position 46 unexpected 'features'.", 'raw_sql': "with cte_gender as {{ ref('gender') }},\r\n\r\ncte_age as {{ ref('age') }},\r\n\r\ncte_location as {{ ref('country_and_state') }},\r\n\r\ncte_email_domain as {{ ref('email_domain') }},\r\n\r\ncte_is_member as {{ ref('is_member') }},\r\n\r\ncte_has_mobile_app as {{ ref('has_mobile_app') }},\r\n\r\ncte_is_active_on_website as {{ ref('is_active_on_website') }},\r\n\r\ncte_device_type as {{ ref('device_type') }}\r\n\r\nselect coalesce(a.user_id, b.user_id, c.user_id, d.user_id, e.user_id, f.user_id, g.user_id, h.user_id) \r\nas user_id, gender, c.country as country, c.state as state, email_domain, is_member, has_mobile_app, is_active_on_website, device_type\r\nfrom ((((((cte_gender a full outer join cte_age b on a.user_id = b.user_id) \r\nfull outer join cte_location c on c.user_id = coalesce(a.user_id, b.user_id))\r\nfull outer join cte_email_domain d on d.user_id = coalesce(a.user_id, b.user_id, c.user_id))\r\nfull outer join cte_is_member e on e.user_id = coalesce(a.user_id, b.user_id, c.user_id,d.user_id))\r\nfull outer join cte_has_mobile_app f on f.user_id = coalesce(a.user_id, b.user_id, c.user_id,d.user_id, e.user_id))\r\nfull outer join cte_is_active_on_website as g on g.user_id = coalesce(a.user_id, b.user_id, c.user_id,d.user_id, e.user_id, f.user_id))\r\nfull outer join cte_device_type as h on h.user_id = coalesce(a.user_id, b.user_id, c.user_id,d.user_id, e.user_id, f.user_id, g.user_id)\nlimit 500\n/* limit added automatically by dbt cloud */", 'compiled_sql': 'with cte_gender as ANALYTICS_DB.dbt_ecommerce features.gender,\n\ncte_age as ANALYTICS_DB.dbt_ecommerce features.age,\n\ncte_location as ANALYTICS_DB.dbt_ecommerce features.country_and_state,\n\ncte_email_domain as ANALYTICS_DB.dbt_ecommerce features.email_domain,\n\ncte_is_member as ANALYTICS_DB.dbt_ecommerce features.is_member,\n\ncte_has_mobile_app as ANALYTICS_DB.dbt_ecommerce features.has_mobile_app,\n\ncte_is_active_on_website as ANALYTICS_DB.dbt_ecommerce features.is_active_on_website,\n\ncte_device_type as ANALYTICS_DB.dbt_ecommerce features.device_type\n\nselect coalesce(a.user_id, b.user_id, c.user_id, d.user_id, e.user_id, f.user_id, g.user_id, h.user_id) \nas user_id, gender, c.country as country, c.state as state, email_domain, is_member, has_mobile_app, is_active_on_website, device_type\nfrom ((((((cte_gender a full outer join cte_age b on a.user_id = b.user_id) \nfull outer join cte_location c on c.user_id = coalesce(a.user_id, b.user_id))\nfull outer join cte_email_domain d on d.user_id = coalesce(a.user_id, b.user_id, c.user_id))\nfull outer join cte_is_member e on e.user_id = coalesce(a.user_id, b.user_id, c.user_id,d.user_id))\nfull outer join cte_has_mobile_app f on f.user_id = coalesce(a.user_id, b.user_id, c.user_id,d.user_id, e.user_id))\nfull outer join cte_is_active_on_website as g on g.user_id = coalesce(a.user_id, b.user_id, c.user_id,d.user_id, e.user_id, f.user_id))\nfull outer join cte_device_type as h on h.user_id = coalesce(a.user_id, b.user_id, c.user_id,d.user_id, e.user_id, f.user_id, g.user_id)\nlimit 500\n/* limit added automatically by dbt cloud */', 'tags': None}, None)
2022-07-07 08:49:30.732922 (Thread-287): handling poll request
2022-07-07 08:49:30.733333 (Thread-287): 08:49:30  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '196d9207-3e38-4101-ac43-bc898fbec1a7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f51ec20e700>]}
2022-07-07 08:49:30.734043 (Thread-287): sending response (<Response 27064 bytes [200 OK]>) to 10.0.41.177
2022-07-07 08:49:34.032425 (Thread-288): handling status request
2022-07-07 08:49:34.032830 (Thread-288): 08:49:34  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '196d9207-3e38-4101-ac43-bc898fbec1a7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f51ec20eb80>]}
2022-07-07 08:49:34.033365 (Thread-288): sending response (<Response 2059 bytes [200 OK]>) to 10.0.41.177
2022-07-07 08:49:34.426217 (Thread-289): handling compile_sql request
2022-07-07 08:49:34.426595 (Thread-289): 08:49:34  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '196d9207-3e38-4101-ac43-bc898fbec1a7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f51ec20ed60>]}
2022-07-07 08:49:36.743068 (Thread-289): sending response (<Response 139 bytes [200 OK]>) to 10.0.41.177
2022-07-07 08:49:36.769527 (MainThread): 08:49:36  Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'b8d18e2d-66d9-4a9c-8864-99e2a0b1bd77', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdb048f1790>]}
2022-07-07 08:49:36.770057 (MainThread): 08:49:36  Found 17 models, 0 tests, 0 snapshots, 0 analyses, 181 macros, 0 operations, 0 seed files, 15 sources, 0 exposures, 0 metrics
2022-07-07 08:49:36.770651 (Thread-1): 08:49:36  Acquiring new snowflake connection "rpc.ecommerce_data_model_dbt.request"
2022-07-07 08:49:36.770786 (Thread-1): 08:49:36  Began compiling node rpc.ecommerce_data_model_dbt.request
2022-07-07 08:49:36.770883 (Thread-1): 08:49:36  Compiling rpc.ecommerce_data_model_dbt.request
2022-07-07 08:49:36.774384 (Thread-1): 08:49:36  finished collecting timing info
2022-07-07 08:49:36.774512 (Thread-1): 08:49:36  Began executing node rpc.ecommerce_data_model_dbt.request
2022-07-07 08:49:36.774610 (Thread-1): 08:49:36  finished collecting timing info
2022-07-07 08:49:37.150034 (Thread-290): handling poll request
2022-07-07 08:49:37.150525 (Thread-290): 08:49:37  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '196d9207-3e38-4101-ac43-bc898fbec1a7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f51ec08dee0>]}
2022-07-07 08:49:37.151740 (Thread-290): sending response (<Response 11649 bytes [200 OK]>) to 10.0.41.177
2022-07-07 08:50:32.891335 (Thread-291): handling ps request
2022-07-07 08:50:32.891761 (Thread-291): 08:50:32  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '196d9207-3e38-4101-ac43-bc898fbec1a7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f51ec07f1c0>]}
2022-07-07 08:50:32.895685 (Thread-291): sending response (<Response 27507 bytes [200 OK]>) to 10.0.41.177
2022-07-07 08:50:32.988414 (Thread-292): handling status request
2022-07-07 08:50:32.988824 (Thread-292): 08:50:32  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '196d9207-3e38-4101-ac43-bc898fbec1a7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f51ec07f820>]}
2022-07-07 08:50:33.013418 (Thread-292): sending response (<Response 2059 bytes [200 OK]>) to 10.0.41.177
2022-07-07 08:50:33.018970 (Thread-293): handling status request
2022-07-07 08:50:33.021796 (Thread-293): 08:50:33  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '196d9207-3e38-4101-ac43-bc898fbec1a7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f51ec07f9d0>]}
2022-07-07 08:50:33.022191 (Thread-293): sending response (<Response 2059 bytes [200 OK]>) to 10.0.41.177
2022-07-07 08:50:33.109450 (Thread-294): handling status request
2022-07-07 08:50:33.109839 (Thread-294): 08:50:33  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '196d9207-3e38-4101-ac43-bc898fbec1a7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f51ec07ff40>]}
2022-07-07 08:50:33.110318 (Thread-294): sending response (<Response 2059 bytes [200 OK]>) to 10.0.41.177
2022-07-07 08:50:34.658028 (Thread-295): handling status request
2022-07-07 08:50:34.658467 (Thread-295): 08:50:34  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '196d9207-3e38-4101-ac43-bc898fbec1a7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f51ec07fe20>]}
2022-07-07 08:50:34.659002 (Thread-295): sending response (<Response 2036 bytes [200 OK]>) to 10.0.41.177
2022-07-07 08:50:34.666611 (Thread-296): handling list request
2022-07-07 08:50:34.666941 (Thread-296): 08:50:34  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '196d9207-3e38-4101-ac43-bc898fbec1a7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f51ec4119d0>]}
2022-07-07 08:50:34.698452 (Thread-296): 08:50:34  Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '196d9207-3e38-4101-ac43-bc898fbec1a7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f51ec08dd60>]}
2022-07-07 08:50:34.698740 (Thread-296): 08:50:34  Found 17 models, 0 tests, 0 snapshots, 0 analyses, 181 macros, 0 operations, 0 seed files, 15 sources, 0 exposures, 0 metrics
2022-07-07 08:50:34.699320 (Thread-296): 08:50:34  The selection criterion '+README.md+' does not match any nodes
2022-07-07 08:50:34.699453 (Thread-296): 08:50:34  No nodes selected!
2022-07-07 08:50:34.701021 (Thread-296): sending response (<Response 1928 bytes [200 OK]>) to 10.0.41.177
2022-07-07 08:50:34.897314 (Thread-297): handling status request
2022-07-07 08:50:34.897704 (Thread-297): 08:50:34  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '196d9207-3e38-4101-ac43-bc898fbec1a7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f51ec2263a0>]}
2022-07-07 08:50:34.898189 (Thread-297): sending response (<Response 2059 bytes [200 OK]>) to 10.0.41.177
2022-07-07 08:51:51.179039 (Thread-298): handling status request
2022-07-07 08:51:51.179438 (Thread-298): 08:51:51  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '196d9207-3e38-4101-ac43-bc898fbec1a7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f51ec226670>]}
2022-07-07 08:51:51.179946 (Thread-298): sending response (<Response 2036 bytes [200 OK]>) to 10.0.41.177
2022-07-07 08:51:51.212499 (Thread-299): handling list request
2022-07-07 08:51:51.212835 (Thread-299): 08:51:51  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '196d9207-3e38-4101-ac43-bc898fbec1a7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f51ec1f0fa0>]}
2022-07-07 08:51:51.244599 (Thread-299): 08:51:51  Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '196d9207-3e38-4101-ac43-bc898fbec1a7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f51ec07fd90>]}
2022-07-07 08:51:51.244882 (Thread-299): 08:51:51  Found 17 models, 0 tests, 0 snapshots, 0 analyses, 181 macros, 0 operations, 0 seed files, 15 sources, 0 exposures, 0 metrics
2022-07-07 08:51:51.245285 (Thread-299): 08:51:51  The selection criterion '+README.md+' does not match any nodes
2022-07-07 08:51:51.245565 (Thread-299): 08:51:51  No nodes selected!
2022-07-07 08:51:51.247064 (Thread-299): sending response (<Response 1928 bytes [200 OK]>) to 10.0.41.177
2022-07-07 08:52:00.797209 (MainThread): Running with dbt=1.0.8
2022-07-07 08:52:01.075178 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt_rpc.task.server.RPCServerTask'>, debug=None, defer=None, exclude=None, fail_fast=None, host='0.0.0.0', log_cache_events=False, log_format=None, models=None, partial_parse=True, port=8580, printer_width=None, profile='user', profiles_dir='/usr/src/develop/.dbt', project_dir=None, record_timing_info=None, rpc_method=None, send_anonymous_usage_stats=None, single_threaded=False, state=None, static_parser=None, target=None, threads=None, use_colors=None, use_experimental_parser=None, vars='{}', version_check=None, warn_error=None, which='rpc', write_json=None)
2022-07-07 08:52:01.084386 (MainThread): Tracking: tracking
2022-07-07 08:52:01.084787 (MainThread): 08:52:01  Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9a6268d610>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9a62ad56d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9a287a7c40>]}
2022-07-07 08:52:01.085211 (MainThread): Serving RPC server at 0.0.0.0:8580, pid=22
2022-07-07 08:52:01.090850 (MainThread): Supported methods: ['build', 'cli_args', 'compile', 'compile_sql', 'deps', 'docs.generate', 'gc', 'get-manifest', 'kill', 'list', 'poll', 'ps', 'run', 'run-operation', 'run_sql', 'seed', 'snapshot', 'snapshot-freshness', 'source-freshness', 'status', 'test']
2022-07-07 08:52:01.091252 (MainThread): Send requests to http://localhost:8580/jsonrpc
2022-07-07 08:52:01.109416 (Thread-12): 08:52:01  Unable to do partial parsing because profile has changed
2022-07-07 08:52:01.109803 (Thread-12): 08:52:01  Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '8901092b-4e3c-4560-9d28-48dc5c91cc33', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9a287b7190>]}
2022-07-07 08:52:01.204582 (Thread-12): 08:52:01  Parsing macros/get_age_from_dob.sql
2022-07-07 08:52:01.207270 (Thread-12): 08:52:01  Parsing macros/get_domain_from_email.sql
2022-07-07 08:52:01.207862 (Thread-12): 08:52:01  Parsing macros/adapters.sql
2022-07-07 08:52:01.245731 (Thread-12): 08:52:01  Parsing macros/catalog.sql
2022-07-07 08:52:01.247671 (Thread-12): 08:52:01  Parsing macros/materializations/table.sql
2022-07-07 08:52:01.250828 (Thread-12): 08:52:01  Parsing macros/materializations/seed.sql
2022-07-07 08:52:01.256059 (Thread-12): 08:52:01  Parsing macros/materializations/incremental.sql
2022-07-07 08:52:01.264322 (Thread-12): 08:52:01  Parsing macros/materializations/merge.sql
2022-07-07 08:52:01.268083 (Thread-12): 08:52:01  Parsing macros/materializations/snapshot.sql
2022-07-07 08:52:01.269070 (Thread-12): 08:52:01  Parsing macros/materializations/view.sql
2022-07-07 08:52:01.270396 (Thread-12): 08:52:01  Parsing macros/adapters/metadata.sql
2022-07-07 08:52:01.277318 (Thread-12): 08:52:01  Parsing macros/adapters/columns.sql
2022-07-07 08:52:01.286964 (Thread-12): 08:52:01  Parsing macros/adapters/freshness.sql
2022-07-07 08:52:01.289848 (Thread-12): 08:52:01  Parsing macros/adapters/persist_docs.sql
2022-07-07 08:52:01.294174 (Thread-12): 08:52:01  Parsing macros/adapters/relation.sql
2022-07-07 08:52:01.303423 (Thread-12): 08:52:01  Parsing macros/adapters/schema.sql
2022-07-07 08:52:01.305592 (Thread-12): 08:52:01  Parsing macros/adapters/indexes.sql
2022-07-07 08:52:01.308208 (Thread-12): 08:52:01  Parsing macros/get_custom_name/get_custom_schema.sql
2022-07-07 08:52:01.310628 (Thread-12): 08:52:01  Parsing macros/get_custom_name/get_custom_alias.sql
2022-07-07 08:52:01.312098 (Thread-12): 08:52:01  Parsing macros/get_custom_name/get_custom_database.sql
2022-07-07 08:52:01.313699 (Thread-12): 08:52:01  Parsing macros/etc/datetime.sql
2022-07-07 08:52:01.321964 (Thread-12): 08:52:01  Parsing macros/etc/statement.sql
2022-07-07 08:52:01.326415 (Thread-12): 08:52:01  Parsing macros/generic_test_sql/unique.sql
2022-07-07 08:52:01.327178 (Thread-12): 08:52:01  Parsing macros/generic_test_sql/not_null.sql
2022-07-07 08:52:01.327760 (Thread-12): 08:52:01  Parsing macros/generic_test_sql/accepted_values.sql
2022-07-07 08:52:01.329149 (Thread-12): 08:52:01  Parsing macros/generic_test_sql/relationships.sql
2022-07-07 08:52:01.330028 (Thread-12): 08:52:01  Parsing macros/materializations/configs.sql
2022-07-07 08:52:01.332354 (Thread-12): 08:52:01  Parsing macros/materializations/hooks.sql
2022-07-07 08:52:01.336120 (Thread-12): 08:52:01  Parsing macros/materializations/models/table/table.sql
2022-07-07 08:52:01.343427 (Thread-12): 08:52:01  Parsing macros/materializations/models/table/create_table_as.sql
2022-07-07 08:52:01.346270 (Thread-12): 08:52:01  Parsing macros/materializations/models/view/create_or_replace_view.sql
2022-07-07 08:52:01.348924 (Thread-12): 08:52:01  Parsing macros/materializations/models/view/helpers.sql
2022-07-07 08:52:01.350226 (Thread-12): 08:52:01  Parsing macros/materializations/models/view/create_view_as.sql
2022-07-07 08:52:01.352489 (Thread-12): 08:52:01  Parsing macros/materializations/models/view/view.sql
2022-07-07 08:52:01.359463 (Thread-12): 08:52:01  Parsing macros/materializations/models/incremental/incremental.sql
2022-07-07 08:52:01.369264 (Thread-12): 08:52:01  Parsing macros/materializations/models/incremental/on_schema_change.sql
2022-07-07 08:52:01.384509 (Thread-12): 08:52:01  Parsing macros/materializations/models/incremental/is_incremental.sql
2022-07-07 08:52:01.386116 (Thread-12): 08:52:01  Parsing macros/materializations/models/incremental/merge.sql
2022-07-07 08:52:01.397189 (Thread-12): 08:52:01  Parsing macros/materializations/models/incremental/column_helpers.sql
2022-07-07 08:52:01.401591 (Thread-12): 08:52:01  Parsing macros/materializations/seeds/helpers.sql
2022-07-07 08:52:01.417484 (Thread-12): 08:52:01  Parsing macros/materializations/seeds/seed.sql
2022-07-07 08:52:01.423375 (Thread-12): 08:52:01  Parsing macros/materializations/tests/helpers.sql
2022-07-07 08:52:01.425205 (Thread-12): 08:52:01  Parsing macros/materializations/tests/test.sql
2022-07-07 08:52:01.429545 (Thread-12): 08:52:01  Parsing macros/materializations/tests/where_subquery.sql
2022-07-07 08:52:01.431348 (Thread-12): 08:52:01  Parsing macros/materializations/snapshots/helpers.sql
2022-07-07 08:52:01.442785 (Thread-12): 08:52:01  Parsing macros/materializations/snapshots/strategies.sql
2022-07-07 08:52:01.459160 (Thread-12): 08:52:01  Parsing macros/materializations/snapshots/snapshot_merge.sql
2022-07-07 08:52:01.460836 (Thread-12): 08:52:01  Parsing macros/materializations/snapshots/snapshot.sql
2022-07-07 08:52:01.471958 (Thread-12): 08:52:01  Parsing tests/generic/builtin.sql
2022-07-07 08:52:01.664398 (Thread-12): 08:52:01  1603: static parser failed on data_model/stg_user_traits.sql
2022-07-07 08:52:01.683545 (Thread-12): 08:52:01  1602: parser fallback to jinja rendering on data_model/stg_user_traits.sql
2022-07-07 08:52:01.684771 (Thread-12): 08:52:01  1603: static parser failed on data_model/stg_products_viewed.sql
2022-07-07 08:52:01.687918 (Thread-12): 08:52:01  1602: parser fallback to jinja rendering on data_model/stg_products_viewed.sql
2022-07-07 08:52:01.689079 (Thread-12): 08:52:01  1699: static parser successfully parsed data_model/feat_user_features.sql
2022-07-07 08:52:01.691071 (Thread-12): 08:52:01  1699: static parser successfully parsed data_model/stg_user_properties.sql
2022-07-07 08:52:01.693739 (Thread-12): 08:52:01  1699: static parser successfully parsed data_model/stg_user_traits_new.sql
2022-07-07 08:52:01.695566 (Thread-12): 08:52:01  1699: static parser successfully parsed data_model/stg_tracks.sql
2022-07-07 08:52:01.697542 (Thread-12): 08:52:01  1603: static parser failed on data_model/stg_traits/country_and_state.sql
2022-07-07 08:52:01.700958 (Thread-12): 08:52:01  1602: parser fallback to jinja rendering on data_model/stg_traits/country_and_state.sql
2022-07-07 08:52:01.701905 (Thread-12): 08:52:01  1699: static parser successfully parsed data_model/stg_traits/preferred_login_device.sql
2022-07-07 08:52:01.703600 (Thread-12): 08:52:01  1699: static parser successfully parsed data_model/stg_traits/utm_url_sequence.sql
2022-07-07 08:52:01.705723 (Thread-12): 08:52:01  1603: static parser failed on data_model/stg_traits/is_member.sql
2022-07-07 08:52:01.708883 (Thread-12): 08:52:01  1602: parser fallback to jinja rendering on data_model/stg_traits/is_member.sql
2022-07-07 08:52:01.710096 (Thread-12): 08:52:01  1603: static parser failed on data_model/stg_traits/has_mobile_app.sql
2022-07-07 08:52:01.713239 (Thread-12): 08:52:01  1602: parser fallback to jinja rendering on data_model/stg_traits/has_mobile_app.sql
2022-07-07 08:52:01.714545 (Thread-12): 08:52:01  1603: static parser failed on data_model/stg_traits/email_domain.sql
2022-07-07 08:52:01.718714 (Thread-12): 08:52:01  1602: parser fallback to jinja rendering on data_model/stg_traits/email_domain.sql
2022-07-07 08:52:01.720617 (Thread-12): 08:52:01  1603: static parser failed on data_model/stg_traits/gender.sql
2022-07-07 08:52:01.723641 (Thread-12): 08:52:01  1602: parser fallback to jinja rendering on data_model/stg_traits/gender.sql
2022-07-07 08:52:01.724990 (Thread-12): 08:52:01  1603: static parser failed on data_model/stg_traits/is_active_on_website.sql
2022-07-07 08:52:01.728308 (Thread-12): 08:52:01  1602: parser fallback to jinja rendering on data_model/stg_traits/is_active_on_website.sql
2022-07-07 08:52:01.729616 (Thread-12): 08:52:01  1603: static parser failed on data_model/stg_traits/age.sql
2022-07-07 08:52:01.735390 (Thread-12): 08:52:01  1602: parser fallback to jinja rendering on data_model/stg_traits/age.sql
2022-07-07 08:52:01.736490 (Thread-12): 08:52:01  1603: static parser failed on data_model/stg_traits/state.sql
2022-07-07 08:52:01.739683 (Thread-12): 08:52:01  1602: parser fallback to jinja rendering on data_model/stg_traits/state.sql
2022-07-07 08:52:01.740637 (Thread-12): 08:52:01  1699: static parser successfully parsed data_model/stg_traits/device_type.sql
2022-07-07 08:52:01.757636 (Thread-12): 08:52:01  [WARNING]: Did not find matching node for patch with name 'my_first_dbt_model' in the 'models' section of file 'models/data_model/schema.yml'
2022-07-07 08:52:01.786564 (Thread-12): 08:52:01  [WARNING]: Test 'test.ecommerce_data_model_dbt.unique_my_first_dbt_model_id.16e066b321' (models/data_model/schema.yml) depends on a node named 'my_first_dbt_model' which was not found
2022-07-07 08:52:01.786865 (Thread-12): 08:52:01  [WARNING]: Test 'test.ecommerce_data_model_dbt.not_null_my_first_dbt_model_id.5fb22c2710' (models/data_model/schema.yml) depends on a node named 'my_first_dbt_model' which was not found
2022-07-07 08:52:01.828633 (Thread-12): 08:52:01  [WARNING]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.data-apps-ecommerce-template.data_model

2022-07-07 08:52:01.833895 (Thread-12): 08:52:01  Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '8901092b-4e3c-4560-9d28-48dc5c91cc33', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9a215e7bb0>]}
2022-07-07 08:52:05.224237 (Thread-13): handling status request
2022-07-07 08:52:05.224707 (Thread-13): 08:52:05  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '8901092b-4e3c-4560-9d28-48dc5c91cc33', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9a28702460>]}
2022-07-07 08:52:05.225961 (Thread-13): sending response (<Response 25749 bytes [200 OK]>) to 10.0.19.15
2022-07-07 08:52:05.397325 (Thread-14): handling status request
2022-07-07 08:52:05.397721 (Thread-14): 08:52:05  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '8901092b-4e3c-4560-9d28-48dc5c91cc33', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9a28040b20>]}
2022-07-07 08:52:05.398818 (Thread-14): sending response (<Response 25749 bytes [200 OK]>) to 10.0.19.15
2022-07-07 08:52:05.473597 (Thread-15): handling status request
2022-07-07 08:52:05.474016 (Thread-15): 08:52:05  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '8901092b-4e3c-4560-9d28-48dc5c91cc33', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9a2804a100>]}
2022-07-07 08:52:05.475123 (Thread-15): sending response (<Response 25749 bytes [200 OK]>) to 10.0.19.15
2022-07-07 08:52:05.518857 (Thread-16): handling ps request
2022-07-07 08:52:05.519274 (Thread-16): 08:52:05  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '8901092b-4e3c-4560-9d28-48dc5c91cc33', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9a287b7700>]}
2022-07-07 08:52:05.519722 (Thread-16): sending response (<Response 106 bytes [200 OK]>) to 10.0.19.15
2022-07-07 08:52:06.742534 (Thread-17): handling status request
2022-07-07 08:52:06.742967 (Thread-17): 08:52:06  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '8901092b-4e3c-4560-9d28-48dc5c91cc33', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9a215ea2b0>]}
2022-07-07 08:52:06.744167 (Thread-17): sending response (<Response 25726 bytes [200 OK]>) to 10.0.19.15
2022-07-07 08:52:06.753469 (Thread-18): handling list request
2022-07-07 08:52:06.753919 (Thread-18): 08:52:06  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '8901092b-4e3c-4560-9d28-48dc5c91cc33', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9a28709400>]}
2022-07-07 08:52:06.789262 (Thread-18): 08:52:06  Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '8901092b-4e3c-4560-9d28-48dc5c91cc33', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9a215b9040>]}
2022-07-07 08:52:06.789715 (Thread-18): 08:52:06  Found 17 models, 0 tests, 0 snapshots, 0 analyses, 181 macros, 0 operations, 0 seed files, 15 sources, 0 exposures, 0 metrics
2022-07-07 08:52:06.790359 (Thread-18): 08:52:06  The selection criterion '+README.md+' does not match any nodes
2022-07-07 08:52:06.790493 (Thread-18): 08:52:06  No nodes selected!
2022-07-07 08:52:06.792404 (Thread-18): sending response (<Response 1920 bytes [200 OK]>) to 10.0.19.15
2022-07-07 08:52:07.476904 (Thread-19): handling status request
2022-07-07 08:52:07.477312 (Thread-19): 08:52:07  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '8901092b-4e3c-4560-9d28-48dc5c91cc33', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9a215e75e0>]}
2022-07-07 08:52:07.478439 (Thread-19): sending response (<Response 25726 bytes [200 OK]>) to 10.0.19.15
2022-07-07 08:52:07.499503 (Thread-20): handling list request
2022-07-07 08:52:07.499847 (Thread-20): 08:52:07  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '8901092b-4e3c-4560-9d28-48dc5c91cc33', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9a215e8be0>]}
2022-07-07 08:52:07.530366 (Thread-20): 08:52:07  Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '8901092b-4e3c-4560-9d28-48dc5c91cc33', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9a28709400>]}
2022-07-07 08:52:07.530705 (Thread-20): 08:52:07  Found 17 models, 0 tests, 0 snapshots, 0 analyses, 181 macros, 0 operations, 0 seed files, 15 sources, 0 exposures, 0 metrics
2022-07-07 08:52:07.534163 (Thread-20): sending response (<Response 2712 bytes [200 OK]>) to 10.0.19.15
2022-07-07 08:52:07.613931 (Thread-21): handling status request
2022-07-07 08:52:07.614309 (Thread-21): 08:52:07  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '8901092b-4e3c-4560-9d28-48dc5c91cc33', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9a215e82e0>]}
2022-07-07 08:52:07.615392 (Thread-21): sending response (<Response 25726 bytes [200 OK]>) to 10.0.19.15
2022-07-07 08:52:07.619404 (Thread-22): handling status request
2022-07-07 08:52:07.619667 (Thread-22): 08:52:07  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '8901092b-4e3c-4560-9d28-48dc5c91cc33', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9a2870d670>]}
2022-07-07 08:52:07.620665 (Thread-22): sending response (<Response 25726 bytes [200 OK]>) to 10.0.19.15
2022-07-07 08:52:07.622037 (Thread-23): handling list request
2022-07-07 08:52:07.622293 (Thread-23): 08:52:07  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '8901092b-4e3c-4560-9d28-48dc5c91cc33', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9a2870d610>]}
2022-07-07 08:52:07.657596 (Thread-24): sending response (<Response 214 bytes [200 OK]>) to 10.0.19.15
2022-07-07 08:52:07.658925 (Thread-25): handling status request
2022-07-07 08:52:07.659183 (Thread-25): 08:52:07  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '8901092b-4e3c-4560-9d28-48dc5c91cc33', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9a215d1b20>]}
2022-07-07 08:52:07.660075 (Thread-25): sending response (<Response 25726 bytes [200 OK]>) to 10.0.19.15
2022-07-07 08:52:07.667770 (Thread-26): handling list request
2022-07-07 08:52:07.668089 (Thread-26): 08:52:07  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '8901092b-4e3c-4560-9d28-48dc5c91cc33', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9a215d1940>]}
2022-07-07 08:52:07.701549 (Thread-26): 08:52:07  Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '8901092b-4e3c-4560-9d28-48dc5c91cc33', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9a28702400>]}
2022-07-07 08:52:07.701851 (Thread-26): 08:52:07  Found 17 models, 0 tests, 0 snapshots, 0 analyses, 181 macros, 0 operations, 0 seed files, 15 sources, 0 exposures, 0 metrics
2022-07-07 08:52:07.704718 (Thread-26): sending response (<Response 3042 bytes [200 OK]>) to 10.0.19.15
2022-07-07 08:52:07.811012 (Thread-27): handling status request
2022-07-07 08:52:07.811508 (Thread-27): 08:52:07  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '8901092b-4e3c-4560-9d28-48dc5c91cc33', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9a28709940>]}
2022-07-07 08:52:07.812778 (Thread-27): sending response (<Response 25726 bytes [200 OK]>) to 10.0.19.15
2022-07-07 08:52:07.814106 (Thread-28): handling status request
2022-07-07 08:52:07.814460 (Thread-28): 08:52:07  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '8901092b-4e3c-4560-9d28-48dc5c91cc33', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9a2804a100>]}
2022-07-07 08:52:07.815451 (Thread-28): sending response (<Response 25726 bytes [200 OK]>) to 10.0.19.15
2022-07-07 08:52:07.819864 (Thread-29): handling list request
2022-07-07 08:52:07.829269 (Thread-29): 08:52:07  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '8901092b-4e3c-4560-9d28-48dc5c91cc33', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9a215e8d90>]}
2022-07-07 08:52:07.875145 (Thread-30): sending response (<Response 214 bytes [200 OK]>) to 10.0.19.15
2022-07-07 08:52:16.438809 (Thread-32): handling status request
2022-07-07 08:52:16.440609 (Thread-32): 08:52:16  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '8901092b-4e3c-4560-9d28-48dc5c91cc33', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9a2051e2b0>]}
2022-07-07 08:52:16.465888 (Thread-32): sending response (<Response 25726 bytes [200 OK]>) to 10.0.19.15
2022-07-07 08:52:16.504568 (Thread-33): handling list request
2022-07-07 08:52:16.504943 (Thread-33): 08:52:16  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '8901092b-4e3c-4560-9d28-48dc5c91cc33', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9a2051e2b0>]}
2022-07-07 08:52:16.535606 (Thread-33): 08:52:16  Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '8901092b-4e3c-4560-9d28-48dc5c91cc33', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9a204b7df0>]}
2022-07-07 08:52:16.535954 (Thread-33): 08:52:16  Found 17 models, 0 tests, 0 snapshots, 0 analyses, 181 macros, 0 operations, 0 seed files, 15 sources, 0 exposures, 0 metrics
2022-07-07 08:52:16.540962 (Thread-33): sending response (<Response 6931 bytes [200 OK]>) to 10.0.19.15
2022-07-07 08:52:17.827065 (Thread-34): handling status request
2022-07-07 08:52:17.827499 (Thread-34): 08:52:17  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '8901092b-4e3c-4560-9d28-48dc5c91cc33', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9a215ca1c0>]}
2022-07-07 08:52:17.828573 (Thread-34): sending response (<Response 25749 bytes [200 OK]>) to 10.0.19.15
2022-07-07 08:52:18.191419 (Thread-35): handling run_sql request
2022-07-07 08:52:18.191825 (Thread-35): 08:52:18  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '8901092b-4e3c-4560-9d28-48dc5c91cc33', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9a204b7f10>]}
2022-07-07 08:52:20.554186 (Thread-35): sending response (<Response 139 bytes [200 OK]>) to 10.0.19.15
2022-07-07 08:52:20.580937 (MainThread): 08:52:20  Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'd60fa877-b0e0-4132-9717-bdefb7b8ecd5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f90744733a0>]}
2022-07-07 08:52:20.581488 (MainThread): 08:52:20  Found 17 models, 0 tests, 0 snapshots, 0 analyses, 181 macros, 0 operations, 0 seed files, 15 sources, 0 exposures, 0 metrics
2022-07-07 08:52:20.582083 (Thread-1): 08:52:20  Acquiring new snowflake connection "rpc.ecommerce_data_model_dbt.request"
2022-07-07 08:52:20.582220 (Thread-1): 08:52:20  Began compiling node rpc.ecommerce_data_model_dbt.request
2022-07-07 08:52:20.582337 (Thread-1): 08:52:20  Compiling rpc.ecommerce_data_model_dbt.request
2022-07-07 08:52:20.585919 (Thread-1): 08:52:20  finished collecting timing info
2022-07-07 08:52:20.586052 (Thread-1): 08:52:20  Began executing node rpc.ecommerce_data_model_dbt.request
2022-07-07 08:52:20.588300 (Thread-1): 08:52:20  Using snowflake connection "rpc.ecommerce_data_model_dbt.request"
2022-07-07 08:52:20.588402 (Thread-1): 08:52:20  On rpc.ecommerce_data_model_dbt.request: with cte_gender as ANALYTICS_DB.dbt_ecommerce_features.gender,

cte_age as ANALYTICS_DB.dbt_ecommerce_features.age,

cte_location as ANALYTICS_DB.dbt_ecommerce_features.country_and_state,

cte_email_domain as ANALYTICS_DB.dbt_ecommerce_features.email_domain,

cte_is_member as ANALYTICS_DB.dbt_ecommerce_features.is_member,

cte_has_mobile_app as ANALYTICS_DB.dbt_ecommerce_features.has_mobile_app,

cte_is_active_on_website as ANALYTICS_DB.dbt_ecommerce_features.is_active_on_website,

cte_device_type as ANALYTICS_DB.dbt_ecommerce_features.device_type

select coalesce(a.user_id, b.user_id, c.user_id, d.user_id, e.user_id, f.user_id, g.user_id, h.user_id) 
as user_id, gender, c.country as country, c.state as state, email_domain, is_member, has_mobile_app, is_active_on_website, device_type
from ((((((cte_gender a full outer join cte_age b on a.user_id = b.user_id) 
full outer join cte_location c on c.user_id = coalesce(a.user_id, b.user_id))
full outer join cte_email_domain d on d.user_id = coalesce(a.user_id, b.user_id, c.user_id))
full outer join cte_is_member e on e.user_id = coalesce(a.user_id, b.user_id, c.user_id,d.user_id))
full outer join cte_has_mobile_app f on f.user_id = coalesce(a.user_id, b.user_id, c.user_id,d.user_id, e.user_id))
full outer join cte_is_active_on_website as g on g.user_id = coalesce(a.user_id, b.user_id, c.user_id,d.user_id, e.user_id, f.user_id))
full outer join cte_device_type as h on h.user_id = coalesce(a.user_id, b.user_id, c.user_id,d.user_id, e.user_id, f.user_id, g.user_id)
limit 500
/* limit added automatically by dbt cloud */
2022-07-07 08:52:20.588494 (Thread-1): 08:52:20  Opening a new connection, currently in state init
2022-07-07 08:52:20.930034 (Thread-36): handling poll request
2022-07-07 08:52:20.930501 (Thread-36): 08:52:20  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '8901092b-4e3c-4560-9d28-48dc5c91cc33', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9a215ca3a0>]}
2022-07-07 08:52:20.931390 (Thread-36): sending response (<Response 5341 bytes [200 OK]>) to 10.0.19.15
2022-07-07 08:52:21.268700 (Thread-1): 08:52:21  Snowflake adapter: Snowflake query id: 01a57194-0602-3441-0019-8203046b4c9e
2022-07-07 08:52:21.268928 (Thread-1): 08:52:21  Snowflake adapter: Snowflake error: 001003 (42000): SQL compilation error:
syntax error line 1 at position 19 unexpected 'ANALYTICS_DB'.
syntax error line 1 at position 61 unexpected ','.
syntax error line 3 at position 11 unexpected 'ANALYTICS_DB'.
syntax error line 3 at position 50 unexpected ','.
syntax error line 5 at position 16 unexpected 'ANALYTICS_DB'.
syntax error line 5 at position 69 unexpected ','.
syntax error line 7 at position 20 unexpected 'ANALYTICS_DB'.
syntax error line 7 at position 68 unexpected ','.
syntax error line 9 at position 17 unexpected 'ANALYTICS_DB'.
syntax error line 9 at position 62 unexpected ','.
syntax error line 11 at position 22 unexpected 'ANALYTICS_DB'.
syntax error line 11 at position 72 unexpected ','.
syntax error line 13 at position 28 unexpected 'ANALYTICS_DB'.
syntax error line 13 at position 84 unexpected ','.
syntax error line 15 at position 19 unexpected 'ANALYTICS_DB'.
syntax error line 17 at position 16 unexpected 'a'.
syntax error line 18 at position 0 unexpected 'as'.
2022-07-07 08:52:21.269090 (Thread-1): 08:52:21  finished collecting timing info
2022-07-07 08:52:21.269246 (Thread-1): 08:52:21  On rpc.ecommerce_data_model_dbt.request: Close
2022-07-07 08:52:21.325019 (Thread-1): Got an exception: Database Error
  001003 (42000): SQL compilation error:
  syntax error line 1 at position 19 unexpected 'ANALYTICS_DB'.
  syntax error line 1 at position 61 unexpected ','.
  syntax error line 3 at position 11 unexpected 'ANALYTICS_DB'.
  syntax error line 3 at position 50 unexpected ','.
  syntax error line 5 at position 16 unexpected 'ANALYTICS_DB'.
  syntax error line 5 at position 69 unexpected ','.
  syntax error line 7 at position 20 unexpected 'ANALYTICS_DB'.
  syntax error line 7 at position 68 unexpected ','.
  syntax error line 9 at position 17 unexpected 'ANALYTICS_DB'.
  syntax error line 9 at position 62 unexpected ','.
  syntax error line 11 at position 22 unexpected 'ANALYTICS_DB'.
  syntax error line 11 at position 72 unexpected ','.
  syntax error line 13 at position 28 unexpected 'ANALYTICS_DB'.
  syntax error line 13 at position 84 unexpected ','.
  syntax error line 15 at position 19 unexpected 'ANALYTICS_DB'.
  syntax error line 17 at position 16 unexpected 'a'.
  syntax error line 18 at position 0 unexpected 'as'.
Traceback (most recent call last):
  File "/usr/local/lib/python3.8/dist-packages/dbt/adapters/snowflake/connections.py", line 206, in exception_handler
    yield
  File "/usr/local/lib/python3.8/dist-packages/dbt/adapters/sql/connections.py", line 74, in add_query
    cursor.execute(sql, bindings)
  File "/usr/local/lib/python3.8/dist-packages/snowflake/connector/cursor.py", line 721, in execute
    Error.errorhandler_wrapper(
  File "/usr/local/lib/python3.8/dist-packages/snowflake/connector/errors.py", line 258, in errorhandler_wrapper
    cursor.errorhandler(connection, cursor, error_class, error_value)
  File "/usr/local/lib/python3.8/dist-packages/snowflake/connector/errors.py", line 188, in default_errorhandler
    raise error_class(
snowflake.connector.errors.ProgrammingError: 001003 (42000): SQL compilation error:
syntax error line 1 at position 19 unexpected 'ANALYTICS_DB'.
syntax error line 1 at position 61 unexpected ','.
syntax error line 3 at position 11 unexpected 'ANALYTICS_DB'.
syntax error line 3 at position 50 unexpected ','.
syntax error line 5 at position 16 unexpected 'ANALYTICS_DB'.
syntax error line 5 at position 69 unexpected ','.
syntax error line 7 at position 20 unexpected 'ANALYTICS_DB'.
syntax error line 7 at position 68 unexpected ','.
syntax error line 9 at position 17 unexpected 'ANALYTICS_DB'.
syntax error line 9 at position 62 unexpected ','.
syntax error line 11 at position 22 unexpected 'ANALYTICS_DB'.
syntax error line 11 at position 72 unexpected ','.
syntax error line 13 at position 28 unexpected 'ANALYTICS_DB'.
syntax error line 13 at position 84 unexpected ','.
syntax error line 15 at position 19 unexpected 'ANALYTICS_DB'.
syntax error line 17 at position 16 unexpected 'a'.
syntax error line 18 at position 0 unexpected 'as'.

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/usr/local/lib/python3.8/dist-packages/dbt/task/base.py", line 361, in safe_run
    result = self.compile_and_execute(manifest, ctx)
  File "/usr/local/lib/python3.8/dist-packages/dbt/task/base.py", line 314, in compile_and_execute
    result = self.run(ctx.node, manifest)
  File "/usr/local/lib/python3.8/dist-packages/dbt/task/base.py", line 403, in run
    return self.execute(compiled_node, manifest)
  File "/usr/local/lib/python3.8/dist-packages/dbt_rpc/rpc/node_runners.py", line 90, in execute
    _, execute_result = self.adapter.execute(
  File "/usr/local/lib/python3.8/dist-packages/dbt/adapters/base/impl.py", line 225, in execute
    return self.connections.execute(
  File "/usr/local/lib/python3.8/dist-packages/dbt/adapters/sql/connections.py", line 127, in execute
    _, cursor = self.add_query(sql, auto_begin)
  File "/usr/local/lib/python3.8/dist-packages/dbt/adapters/snowflake/connections.py", line 433, in add_query
    connection, cursor = super().add_query(
  File "/usr/local/lib/python3.8/dist-packages/dbt/adapters/sql/connections.py", line 83, in add_query
    return connection, cursor
  File "/usr/lib/python3.8/contextlib.py", line 131, in __exit__
    self.gen.throw(type, value, traceback)
  File "/usr/local/lib/python3.8/dist-packages/dbt/adapters/snowflake/connections.py", line 223, in exception_handler
    raise DatabaseException(msg)
dbt.exceptions.DatabaseException: Database Error
  001003 (42000): SQL compilation error:
  syntax error line 1 at position 19 unexpected 'ANALYTICS_DB'.
  syntax error line 1 at position 61 unexpected ','.
  syntax error line 3 at position 11 unexpected 'ANALYTICS_DB'.
  syntax error line 3 at position 50 unexpected ','.
  syntax error line 5 at position 16 unexpected 'ANALYTICS_DB'.
  syntax error line 5 at position 69 unexpected ','.
  syntax error line 7 at position 20 unexpected 'ANALYTICS_DB'.
  syntax error line 7 at position 68 unexpected ','.
  syntax error line 9 at position 17 unexpected 'ANALYTICS_DB'.
  syntax error line 9 at position 62 unexpected ','.
  syntax error line 11 at position 22 unexpected 'ANALYTICS_DB'.
  syntax error line 11 at position 72 unexpected ','.
  syntax error line 13 at position 28 unexpected 'ANALYTICS_DB'.
  syntax error line 13 at position 84 unexpected ','.
  syntax error line 15 at position 19 unexpected 'ANALYTICS_DB'.
  syntax error line 17 at position 16 unexpected 'a'.
  syntax error line 18 at position 0 unexpected 'as'.
2022-07-07 08:52:21.325748 (Thread-1): Got exception RPCException(10003, Database Error, {'type': 'DatabaseException', 'message': "Database Error in rpc request (from remote system)\n  001003 (42000): SQL compilation error:\n  syntax error line 1 at position 19 unexpected 'ANALYTICS_DB'.\n  syntax error line 1 at position 61 unexpected ','.\n  syntax error line 3 at position 11 unexpected 'ANALYTICS_DB'.\n  syntax error line 3 at position 50 unexpected ','.\n  syntax error line 5 at position 16 unexpected 'ANALYTICS_DB'.\n  syntax error line 5 at position 69 unexpected ','.\n  syntax error line 7 at position 20 unexpected 'ANALYTICS_DB'.\n  syntax error line 7 at position 68 unexpected ','.\n  syntax error line 9 at position 17 unexpected 'ANALYTICS_DB'.\n  syntax error line 9 at position 62 unexpected ','.\n  syntax error line 11 at position 22 unexpected 'ANALYTICS_DB'.\n  syntax error line 11 at position 72 unexpected ','.\n  syntax error line 13 at position 28 unexpected 'ANALYTICS_DB'.\n  syntax error line 13 at position 84 unexpected ','.\n  syntax error line 15 at position 19 unexpected 'ANALYTICS_DB'.\n  syntax error line 17 at position 16 unexpected 'a'.\n  syntax error line 18 at position 0 unexpected 'as'.", 'raw_sql': "with cte_gender as {{ ref('gender') }},\r\n\r\ncte_age as {{ ref('age') }},\r\n\r\ncte_location as {{ ref('country_and_state') }},\r\n\r\ncte_email_domain as {{ ref('email_domain') }},\r\n\r\ncte_is_member as {{ ref('is_member') }},\r\n\r\ncte_has_mobile_app as {{ ref('has_mobile_app') }},\r\n\r\ncte_is_active_on_website as {{ ref('is_active_on_website') }},\r\n\r\ncte_device_type as {{ ref('device_type') }}\r\n\r\nselect coalesce(a.user_id, b.user_id, c.user_id, d.user_id, e.user_id, f.user_id, g.user_id, h.user_id) \r\nas user_id, gender, c.country as country, c.state as state, email_domain, is_member, has_mobile_app, is_active_on_website, device_type\r\nfrom ((((((cte_gender a full outer join cte_age b on a.user_id = b.user_id) \r\nfull outer join cte_location c on c.user_id = coalesce(a.user_id, b.user_id))\r\nfull outer join cte_email_domain d on d.user_id = coalesce(a.user_id, b.user_id, c.user_id))\r\nfull outer join cte_is_member e on e.user_id = coalesce(a.user_id, b.user_id, c.user_id,d.user_id))\r\nfull outer join cte_has_mobile_app f on f.user_id = coalesce(a.user_id, b.user_id, c.user_id,d.user_id, e.user_id))\r\nfull outer join cte_is_active_on_website as g on g.user_id = coalesce(a.user_id, b.user_id, c.user_id,d.user_id, e.user_id, f.user_id))\r\nfull outer join cte_device_type as h on h.user_id = coalesce(a.user_id, b.user_id, c.user_id,d.user_id, e.user_id, f.user_id, g.user_id)\nlimit 500\n/* limit added automatically by dbt cloud */", 'compiled_sql': 'with cte_gender as ANALYTICS_DB.dbt_ecommerce_features.gender,\n\ncte_age as ANALYTICS_DB.dbt_ecommerce_features.age,\n\ncte_location as ANALYTICS_DB.dbt_ecommerce_features.country_and_state,\n\ncte_email_domain as ANALYTICS_DB.dbt_ecommerce_features.email_domain,\n\ncte_is_member as ANALYTICS_DB.dbt_ecommerce_features.is_member,\n\ncte_has_mobile_app as ANALYTICS_DB.dbt_ecommerce_features.has_mobile_app,\n\ncte_is_active_on_website as ANALYTICS_DB.dbt_ecommerce_features.is_active_on_website,\n\ncte_device_type as ANALYTICS_DB.dbt_ecommerce_features.device_type\n\nselect coalesce(a.user_id, b.user_id, c.user_id, d.user_id, e.user_id, f.user_id, g.user_id, h.user_id) \nas user_id, gender, c.country as country, c.state as state, email_domain, is_member, has_mobile_app, is_active_on_website, device_type\nfrom ((((((cte_gender a full outer join cte_age b on a.user_id = b.user_id) \nfull outer join cte_location c on c.user_id = coalesce(a.user_id, b.user_id))\nfull outer join cte_email_domain d on d.user_id = coalesce(a.user_id, b.user_id, c.user_id))\nfull outer join cte_is_member e on e.user_id = coalesce(a.user_id, b.user_id, c.user_id,d.user_id))\nfull outer join cte_has_mobile_app f on f.user_id = coalesce(a.user_id, b.user_id, c.user_id,d.user_id, e.user_id))\nfull outer join cte_is_active_on_website as g on g.user_id = coalesce(a.user_id, b.user_id, c.user_id,d.user_id, e.user_id, f.user_id))\nfull outer join cte_device_type as h on h.user_id = coalesce(a.user_id, b.user_id, c.user_id,d.user_id, e.user_id, f.user_id, g.user_id)\nlimit 500\n/* limit added automatically by dbt cloud */', 'tags': None}, None)
Traceback (most recent call last):
  File "/usr/local/lib/python3.8/dist-packages/dbt_rpc/task/sql_commands.py", line 147, in _in_thread
    self.node_results.append(runner.safe_run(self.manifest))
  File "/usr/local/lib/python3.8/dist-packages/dbt/task/base.py", line 377, in safe_run
    result = self.error_result(ctx.node, error, started, [])
  File "/usr/local/lib/python3.8/dist-packages/dbt_rpc/rpc/node_runners.py", line 56, in error_result
    raise error
dbt_rpc.rpc.error.RPCException: RPCException(10003, Database Error, {'type': 'DatabaseException', 'message': "Database Error in rpc request (from remote system)\n  001003 (42000): SQL compilation error:\n  syntax error line 1 at position 19 unexpected 'ANALYTICS_DB'.\n  syntax error line 1 at position 61 unexpected ','.\n  syntax error line 3 at position 11 unexpected 'ANALYTICS_DB'.\n  syntax error line 3 at position 50 unexpected ','.\n  syntax error line 5 at position 16 unexpected 'ANALYTICS_DB'.\n  syntax error line 5 at position 69 unexpected ','.\n  syntax error line 7 at position 20 unexpected 'ANALYTICS_DB'.\n  syntax error line 7 at position 68 unexpected ','.\n  syntax error line 9 at position 17 unexpected 'ANALYTICS_DB'.\n  syntax error line 9 at position 62 unexpected ','.\n  syntax error line 11 at position 22 unexpected 'ANALYTICS_DB'.\n  syntax error line 11 at position 72 unexpected ','.\n  syntax error line 13 at position 28 unexpected 'ANALYTICS_DB'.\n  syntax error line 13 at position 84 unexpected ','.\n  syntax error line 15 at position 19 unexpected 'ANALYTICS_DB'.\n  syntax error line 17 at position 16 unexpected 'a'.\n  syntax error line 18 at position 0 unexpected 'as'.", 'raw_sql': "with cte_gender as {{ ref('gender') }},\r\n\r\ncte_age as {{ ref('age') }},\r\n\r\ncte_location as {{ ref('country_and_state') }},\r\n\r\ncte_email_domain as {{ ref('email_domain') }},\r\n\r\ncte_is_member as {{ ref('is_member') }},\r\n\r\ncte_has_mobile_app as {{ ref('has_mobile_app') }},\r\n\r\ncte_is_active_on_website as {{ ref('is_active_on_website') }},\r\n\r\ncte_device_type as {{ ref('device_type') }}\r\n\r\nselect coalesce(a.user_id, b.user_id, c.user_id, d.user_id, e.user_id, f.user_id, g.user_id, h.user_id) \r\nas user_id, gender, c.country as country, c.state as state, email_domain, is_member, has_mobile_app, is_active_on_website, device_type\r\nfrom ((((((cte_gender a full outer join cte_age b on a.user_id = b.user_id) \r\nfull outer join cte_location c on c.user_id = coalesce(a.user_id, b.user_id))\r\nfull outer join cte_email_domain d on d.user_id = coalesce(a.user_id, b.user_id, c.user_id))\r\nfull outer join cte_is_member e on e.user_id = coalesce(a.user_id, b.user_id, c.user_id,d.user_id))\r\nfull outer join cte_has_mobile_app f on f.user_id = coalesce(a.user_id, b.user_id, c.user_id,d.user_id, e.user_id))\r\nfull outer join cte_is_active_on_website as g on g.user_id = coalesce(a.user_id, b.user_id, c.user_id,d.user_id, e.user_id, f.user_id))\r\nfull outer join cte_device_type as h on h.user_id = coalesce(a.user_id, b.user_id, c.user_id,d.user_id, e.user_id, f.user_id, g.user_id)\nlimit 500\n/* limit added automatically by dbt cloud */", 'compiled_sql': 'with cte_gender as ANALYTICS_DB.dbt_ecommerce_features.gender,\n\ncte_age as ANALYTICS_DB.dbt_ecommerce_features.age,\n\ncte_location as ANALYTICS_DB.dbt_ecommerce_features.country_and_state,\n\ncte_email_domain as ANALYTICS_DB.dbt_ecommerce_features.email_domain,\n\ncte_is_member as ANALYTICS_DB.dbt_ecommerce_features.is_member,\n\ncte_has_mobile_app as ANALYTICS_DB.dbt_ecommerce_features.has_mobile_app,\n\ncte_is_active_on_website as ANALYTICS_DB.dbt_ecommerce_features.is_active_on_website,\n\ncte_device_type as ANALYTICS_DB.dbt_ecommerce_features.device_type\n\nselect coalesce(a.user_id, b.user_id, c.user_id, d.user_id, e.user_id, f.user_id, g.user_id, h.user_id) \nas user_id, gender, c.country as country, c.state as state, email_domain, is_member, has_mobile_app, is_active_on_website, device_type\nfrom ((((((cte_gender a full outer join cte_age b on a.user_id = b.user_id) \nfull outer join cte_location c on c.user_id = coalesce(a.user_id, b.user_id))\nfull outer join cte_email_domain d on d.user_id = coalesce(a.user_id, b.user_id, c.user_id))\nfull outer join cte_is_member e on e.user_id = coalesce(a.user_id, b.user_id, c.user_id,d.user_id))\nfull outer join cte_has_mobile_app f on f.user_id = coalesce(a.user_id, b.user_id, c.user_id,d.user_id, e.user_id))\nfull outer join cte_is_active_on_website as g on g.user_id = coalesce(a.user_id, b.user_id, c.user_id,d.user_id, e.user_id, f.user_id))\nfull outer join cte_device_type as h on h.user_id = coalesce(a.user_id, b.user_id, c.user_id,d.user_id, e.user_id, f.user_id, g.user_id)\nlimit 500\n/* limit added automatically by dbt cloud */', 'tags': None}, None)
2022-07-07 08:52:22.293804 (Thread-37): handling poll request
2022-07-07 08:52:22.294256 (Thread-37): 08:52:22  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '8901092b-4e3c-4560-9d28-48dc5c91cc33', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9a2052a850>]}
2022-07-07 08:52:22.294958 (Thread-37): sending response (<Response 27039 bytes [200 OK]>) to 10.0.19.15
2022-07-07 08:52:29.373734 (Thread-38): handling status request
2022-07-07 08:52:29.374160 (Thread-38): 08:52:29  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '8901092b-4e3c-4560-9d28-48dc5c91cc33', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9a2052acd0>]}
2022-07-07 08:52:29.375364 (Thread-38): sending response (<Response 25726 bytes [200 OK]>) to 10.0.19.15
2022-07-07 08:52:29.376529 (Thread-39): handling status request
2022-07-07 08:52:29.376910 (Thread-39): 08:52:29  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '8901092b-4e3c-4560-9d28-48dc5c91cc33', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9a204b79d0>]}
2022-07-07 08:52:29.377946 (Thread-39): sending response (<Response 25726 bytes [200 OK]>) to 10.0.19.15
2022-07-07 08:52:29.381929 (Thread-40): handling list request
2022-07-07 08:52:29.382221 (Thread-40): 08:52:29  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '8901092b-4e3c-4560-9d28-48dc5c91cc33', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9a2052acd0>]}
2022-07-07 08:52:29.384080 (Thread-41): handling list request
2022-07-07 08:52:29.384471 (Thread-41): 08:52:29  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '8901092b-4e3c-4560-9d28-48dc5c91cc33', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9a204c2dc0>]}
2022-07-07 08:52:29.415215 (Thread-40): 08:52:29  Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '8901092b-4e3c-4560-9d28-48dc5c91cc33', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9a204b2a90>]}
2022-07-07 08:52:29.415543 (Thread-40): 08:52:29  Found 17 models, 0 tests, 0 snapshots, 0 analyses, 181 macros, 0 operations, 0 seed files, 15 sources, 0 exposures, 0 metrics
2022-07-07 08:52:29.422833 (Thread-40): sending response (<Response 5913 bytes [200 OK]>) to 10.0.19.15
2022-07-07 08:52:29.416294 (Thread-41): 08:52:29  Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '8901092b-4e3c-4560-9d28-48dc5c91cc33', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9a204b2df0>]}
2022-07-07 08:52:29.416563 (Thread-41): 08:52:29  Found 17 models, 0 tests, 0 snapshots, 0 analyses, 181 macros, 0 operations, 0 seed files, 15 sources, 0 exposures, 0 metrics
2022-07-07 08:52:29.424280 (Thread-41): sending response (<Response 3128 bytes [200 OK]>) to 10.0.19.15
2022-07-07 08:52:31.975287 (Thread-42): handling status request
2022-07-07 08:52:31.975689 (Thread-42): 08:52:31  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '8901092b-4e3c-4560-9d28-48dc5c91cc33', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9a205123d0>]}
2022-07-07 08:52:31.976883 (Thread-42): sending response (<Response 25749 bytes [200 OK]>) to 10.0.19.15
2022-07-07 08:52:32.358212 (Thread-43): handling compile_sql request
2022-07-07 08:52:32.358624 (Thread-43): 08:52:32  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '8901092b-4e3c-4560-9d28-48dc5c91cc33', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9a204b7a00>]}
2022-07-07 08:52:34.743055 (Thread-43): sending response (<Response 139 bytes [200 OK]>) to 10.0.19.15
2022-07-07 08:52:34.770006 (MainThread): 08:52:34  Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '6d791df0-b0a7-437b-a06b-2491f489e79a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5c805b2550>]}
2022-07-07 08:52:34.770592 (MainThread): 08:52:34  Found 17 models, 0 tests, 0 snapshots, 0 analyses, 181 macros, 0 operations, 0 seed files, 15 sources, 0 exposures, 0 metrics
2022-07-07 08:52:34.771209 (Thread-1): 08:52:34  Acquiring new snowflake connection "rpc.ecommerce_data_model_dbt.request"
2022-07-07 08:52:34.771345 (Thread-1): 08:52:34  Began compiling node rpc.ecommerce_data_model_dbt.request
2022-07-07 08:52:34.771438 (Thread-1): 08:52:34  Compiling rpc.ecommerce_data_model_dbt.request
2022-07-07 08:52:34.775119 (Thread-1): 08:52:34  finished collecting timing info
2022-07-07 08:52:34.775257 (Thread-1): 08:52:34  Began executing node rpc.ecommerce_data_model_dbt.request
2022-07-07 08:52:34.775359 (Thread-1): 08:52:34  finished collecting timing info
2022-07-07 08:52:35.105645 (Thread-44): handling poll request
2022-07-07 08:52:35.106104 (Thread-44): 08:52:35  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '8901092b-4e3c-4560-9d28-48dc5c91cc33', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9a20492880>]}
2022-07-07 08:52:35.107902 (Thread-44): sending response (<Response 11640 bytes [200 OK]>) to 10.0.19.15
2022-07-07 08:53:05.679134 (Thread-45): handling status request
2022-07-07 08:53:05.681242 (Thread-45): 08:53:05  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '8901092b-4e3c-4560-9d28-48dc5c91cc33', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9a204b2310>]}
2022-07-07 08:53:05.682503 (Thread-45): sending response (<Response 25749 bytes [200 OK]>) to 10.0.19.15
2022-07-07 08:53:06.052417 (Thread-46): handling run_sql request
2022-07-07 08:53:06.052858 (Thread-46): 08:53:06  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '8901092b-4e3c-4560-9d28-48dc5c91cc33', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9a204b2f10>]}
2022-07-07 08:53:08.560602 (Thread-46): sending response (<Response 139 bytes [200 OK]>) to 10.0.19.15
2022-07-07 08:53:08.589193 (MainThread): 08:53:08  Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '0b8e07aa-9d53-4b3b-9c5d-8ec1039436fe', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa0117b24f0>]}
2022-07-07 08:53:08.589799 (MainThread): 08:53:08  Found 17 models, 0 tests, 0 snapshots, 0 analyses, 181 macros, 0 operations, 0 seed files, 15 sources, 0 exposures, 0 metrics
2022-07-07 08:53:08.590435 (Thread-1): 08:53:08  Acquiring new snowflake connection "rpc.ecommerce_data_model_dbt.request"
2022-07-07 08:53:08.590564 (Thread-1): 08:53:08  Began compiling node rpc.ecommerce_data_model_dbt.request
2022-07-07 08:53:08.590658 (Thread-1): 08:53:08  Compiling rpc.ecommerce_data_model_dbt.request
2022-07-07 08:53:08.594405 (Thread-1): 08:53:08  finished collecting timing info
2022-07-07 08:53:08.594540 (Thread-1): 08:53:08  Began executing node rpc.ecommerce_data_model_dbt.request
2022-07-07 08:53:08.596828 (Thread-1): 08:53:08  Using snowflake connection "rpc.ecommerce_data_model_dbt.request"
2022-07-07 08:53:08.596934 (Thread-1): 08:53:08  On rpc.ecommerce_data_model_dbt.request: with cte_gender as ANALYTICS_DB.dbt_ecommerce_features.gender,

cte_age as ANALYTICS_DB.dbt_ecommerce_features.age,

cte_location as ANALYTICS_DB.dbt_ecommerce_features.country_and_state,

cte_email_domain as ANALYTICS_DB.dbt_ecommerce_features.email_domain,

cte_is_member as ANALYTICS_DB.dbt_ecommerce_features.is_member,

cte_has_mobile_app as ANALYTICS_DB.dbt_ecommerce_features.has_mobile_app,

cte_is_active_on_website as ANALYTICS_DB.dbt_ecommerce_features.is_active_on_website,

cte_device_type as ANALYTICS_DB.dbt_ecommerce_features.device_type

select coalesce(a.user_id, b.user_id, c.user_id, d.user_id, e.user_id, f.user_id, g.user_id, h.user_id) 
as user_id, gender, c.country as country, c.state as state, email_domain, is_member, has_mobile_app, is_active_on_website, device_type
from ((((((cte_gender a full outer join cte_age b on a.user_id = b.user_id) 
full outer join cte_location c on c.user_id = coalesce(a.user_id, b.user_id))
full outer join cte_email_domain d on d.user_id = coalesce(a.user_id, b.user_id, c.user_id))
full outer join cte_is_member e on e.user_id = coalesce(a.user_id, b.user_id, c.user_id,d.user_id))
full outer join cte_has_mobile_app f on f.user_id = coalesce(a.user_id, b.user_id, c.user_id,d.user_id, e.user_id))
full outer join cte_is_active_on_website as g on g.user_id = coalesce(a.user_id, b.user_id, c.user_id,d.user_id, e.user_id, f.user_id))
full outer join cte_device_type as h on h.user_id = coalesce(a.user_id, b.user_id, c.user_id,d.user_id, e.user_id, f.user_id, g.user_id)
limit 500
/* limit added automatically by dbt cloud */
2022-07-07 08:53:08.597020 (Thread-1): 08:53:08  Opening a new connection, currently in state init
2022-07-07 08:53:08.935830 (Thread-47): handling poll request
2022-07-07 08:53:08.936315 (Thread-47): 08:53:08  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '8901092b-4e3c-4560-9d28-48dc5c91cc33', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9a204dd070>]}
2022-07-07 08:53:08.937207 (Thread-47): sending response (<Response 5341 bytes [200 OK]>) to 10.0.19.15
2022-07-07 08:53:09.332132 (Thread-1): 08:53:09  Snowflake adapter: Snowflake query id: 01a57195-0602-3441-0019-8203046b4ca6
2022-07-07 08:53:09.332337 (Thread-1): 08:53:09  Snowflake adapter: Snowflake error: 001003 (42000): SQL compilation error:
syntax error line 1 at position 19 unexpected 'ANALYTICS_DB'.
syntax error line 1 at position 61 unexpected ','.
syntax error line 3 at position 11 unexpected 'ANALYTICS_DB'.
syntax error line 3 at position 50 unexpected ','.
syntax error line 5 at position 16 unexpected 'ANALYTICS_DB'.
syntax error line 5 at position 69 unexpected ','.
syntax error line 7 at position 20 unexpected 'ANALYTICS_DB'.
syntax error line 7 at position 68 unexpected ','.
syntax error line 9 at position 17 unexpected 'ANALYTICS_DB'.
syntax error line 9 at position 62 unexpected ','.
syntax error line 11 at position 22 unexpected 'ANALYTICS_DB'.
syntax error line 11 at position 72 unexpected ','.
syntax error line 13 at position 28 unexpected 'ANALYTICS_DB'.
syntax error line 13 at position 84 unexpected ','.
syntax error line 15 at position 19 unexpected 'ANALYTICS_DB'.
syntax error line 17 at position 16 unexpected 'a'.
syntax error line 18 at position 0 unexpected 'as'.
2022-07-07 08:53:09.332501 (Thread-1): 08:53:09  finished collecting timing info
2022-07-07 08:53:09.332668 (Thread-1): 08:53:09  On rpc.ecommerce_data_model_dbt.request: Close
2022-07-07 08:53:09.380933 (Thread-1): Got an exception: Database Error
  001003 (42000): SQL compilation error:
  syntax error line 1 at position 19 unexpected 'ANALYTICS_DB'.
  syntax error line 1 at position 61 unexpected ','.
  syntax error line 3 at position 11 unexpected 'ANALYTICS_DB'.
  syntax error line 3 at position 50 unexpected ','.
  syntax error line 5 at position 16 unexpected 'ANALYTICS_DB'.
  syntax error line 5 at position 69 unexpected ','.
  syntax error line 7 at position 20 unexpected 'ANALYTICS_DB'.
  syntax error line 7 at position 68 unexpected ','.
  syntax error line 9 at position 17 unexpected 'ANALYTICS_DB'.
  syntax error line 9 at position 62 unexpected ','.
  syntax error line 11 at position 22 unexpected 'ANALYTICS_DB'.
  syntax error line 11 at position 72 unexpected ','.
  syntax error line 13 at position 28 unexpected 'ANALYTICS_DB'.
  syntax error line 13 at position 84 unexpected ','.
  syntax error line 15 at position 19 unexpected 'ANALYTICS_DB'.
  syntax error line 17 at position 16 unexpected 'a'.
  syntax error line 18 at position 0 unexpected 'as'.
Traceback (most recent call last):
  File "/usr/local/lib/python3.8/dist-packages/dbt/adapters/snowflake/connections.py", line 206, in exception_handler
    yield
  File "/usr/local/lib/python3.8/dist-packages/dbt/adapters/sql/connections.py", line 74, in add_query
    cursor.execute(sql, bindings)
  File "/usr/local/lib/python3.8/dist-packages/snowflake/connector/cursor.py", line 721, in execute
    Error.errorhandler_wrapper(
  File "/usr/local/lib/python3.8/dist-packages/snowflake/connector/errors.py", line 258, in errorhandler_wrapper
    cursor.errorhandler(connection, cursor, error_class, error_value)
  File "/usr/local/lib/python3.8/dist-packages/snowflake/connector/errors.py", line 188, in default_errorhandler
    raise error_class(
snowflake.connector.errors.ProgrammingError: 001003 (42000): SQL compilation error:
syntax error line 1 at position 19 unexpected 'ANALYTICS_DB'.
syntax error line 1 at position 61 unexpected ','.
syntax error line 3 at position 11 unexpected 'ANALYTICS_DB'.
syntax error line 3 at position 50 unexpected ','.
syntax error line 5 at position 16 unexpected 'ANALYTICS_DB'.
syntax error line 5 at position 69 unexpected ','.
syntax error line 7 at position 20 unexpected 'ANALYTICS_DB'.
syntax error line 7 at position 68 unexpected ','.
syntax error line 9 at position 17 unexpected 'ANALYTICS_DB'.
syntax error line 9 at position 62 unexpected ','.
syntax error line 11 at position 22 unexpected 'ANALYTICS_DB'.
syntax error line 11 at position 72 unexpected ','.
syntax error line 13 at position 28 unexpected 'ANALYTICS_DB'.
syntax error line 13 at position 84 unexpected ','.
syntax error line 15 at position 19 unexpected 'ANALYTICS_DB'.
syntax error line 17 at position 16 unexpected 'a'.
syntax error line 18 at position 0 unexpected 'as'.

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/usr/local/lib/python3.8/dist-packages/dbt/task/base.py", line 361, in safe_run
    result = self.compile_and_execute(manifest, ctx)
  File "/usr/local/lib/python3.8/dist-packages/dbt/task/base.py", line 314, in compile_and_execute
    result = self.run(ctx.node, manifest)
  File "/usr/local/lib/python3.8/dist-packages/dbt/task/base.py", line 403, in run
    return self.execute(compiled_node, manifest)
  File "/usr/local/lib/python3.8/dist-packages/dbt_rpc/rpc/node_runners.py", line 90, in execute
    _, execute_result = self.adapter.execute(
  File "/usr/local/lib/python3.8/dist-packages/dbt/adapters/base/impl.py", line 225, in execute
    return self.connections.execute(
  File "/usr/local/lib/python3.8/dist-packages/dbt/adapters/sql/connections.py", line 127, in execute
    _, cursor = self.add_query(sql, auto_begin)
  File "/usr/local/lib/python3.8/dist-packages/dbt/adapters/snowflake/connections.py", line 433, in add_query
    connection, cursor = super().add_query(
  File "/usr/local/lib/python3.8/dist-packages/dbt/adapters/sql/connections.py", line 83, in add_query
    return connection, cursor
  File "/usr/lib/python3.8/contextlib.py", line 131, in __exit__
    self.gen.throw(type, value, traceback)
  File "/usr/local/lib/python3.8/dist-packages/dbt/adapters/snowflake/connections.py", line 223, in exception_handler
    raise DatabaseException(msg)
dbt.exceptions.DatabaseException: Database Error
  001003 (42000): SQL compilation error:
  syntax error line 1 at position 19 unexpected 'ANALYTICS_DB'.
  syntax error line 1 at position 61 unexpected ','.
  syntax error line 3 at position 11 unexpected 'ANALYTICS_DB'.
  syntax error line 3 at position 50 unexpected ','.
  syntax error line 5 at position 16 unexpected 'ANALYTICS_DB'.
  syntax error line 5 at position 69 unexpected ','.
  syntax error line 7 at position 20 unexpected 'ANALYTICS_DB'.
  syntax error line 7 at position 68 unexpected ','.
  syntax error line 9 at position 17 unexpected 'ANALYTICS_DB'.
  syntax error line 9 at position 62 unexpected ','.
  syntax error line 11 at position 22 unexpected 'ANALYTICS_DB'.
  syntax error line 11 at position 72 unexpected ','.
  syntax error line 13 at position 28 unexpected 'ANALYTICS_DB'.
  syntax error line 13 at position 84 unexpected ','.
  syntax error line 15 at position 19 unexpected 'ANALYTICS_DB'.
  syntax error line 17 at position 16 unexpected 'a'.
  syntax error line 18 at position 0 unexpected 'as'.
2022-07-07 08:53:09.381704 (Thread-1): Got exception RPCException(10003, Database Error, {'type': 'DatabaseException', 'message': "Database Error in rpc request (from remote system)\n  001003 (42000): SQL compilation error:\n  syntax error line 1 at position 19 unexpected 'ANALYTICS_DB'.\n  syntax error line 1 at position 61 unexpected ','.\n  syntax error line 3 at position 11 unexpected 'ANALYTICS_DB'.\n  syntax error line 3 at position 50 unexpected ','.\n  syntax error line 5 at position 16 unexpected 'ANALYTICS_DB'.\n  syntax error line 5 at position 69 unexpected ','.\n  syntax error line 7 at position 20 unexpected 'ANALYTICS_DB'.\n  syntax error line 7 at position 68 unexpected ','.\n  syntax error line 9 at position 17 unexpected 'ANALYTICS_DB'.\n  syntax error line 9 at position 62 unexpected ','.\n  syntax error line 11 at position 22 unexpected 'ANALYTICS_DB'.\n  syntax error line 11 at position 72 unexpected ','.\n  syntax error line 13 at position 28 unexpected 'ANALYTICS_DB'.\n  syntax error line 13 at position 84 unexpected ','.\n  syntax error line 15 at position 19 unexpected 'ANALYTICS_DB'.\n  syntax error line 17 at position 16 unexpected 'a'.\n  syntax error line 18 at position 0 unexpected 'as'.", 'raw_sql': "with cte_gender as {{ ref('gender') }},\r\n\r\ncte_age as {{ ref('age') }},\r\n\r\ncte_location as {{ ref('country_and_state') }},\r\n\r\ncte_email_domain as {{ ref('email_domain') }},\r\n\r\ncte_is_member as {{ ref('is_member') }},\r\n\r\ncte_has_mobile_app as {{ ref('has_mobile_app') }},\r\n\r\ncte_is_active_on_website as {{ ref('is_active_on_website') }},\r\n\r\ncte_device_type as {{ ref('device_type') }}\r\n\r\nselect coalesce(a.user_id, b.user_id, c.user_id, d.user_id, e.user_id, f.user_id, g.user_id, h.user_id) \r\nas user_id, gender, c.country as country, c.state as state, email_domain, is_member, has_mobile_app, is_active_on_website, device_type\r\nfrom ((((((cte_gender a full outer join cte_age b on a.user_id = b.user_id) \r\nfull outer join cte_location c on c.user_id = coalesce(a.user_id, b.user_id))\r\nfull outer join cte_email_domain d on d.user_id = coalesce(a.user_id, b.user_id, c.user_id))\r\nfull outer join cte_is_member e on e.user_id = coalesce(a.user_id, b.user_id, c.user_id,d.user_id))\r\nfull outer join cte_has_mobile_app f on f.user_id = coalesce(a.user_id, b.user_id, c.user_id,d.user_id, e.user_id))\r\nfull outer join cte_is_active_on_website as g on g.user_id = coalesce(a.user_id, b.user_id, c.user_id,d.user_id, e.user_id, f.user_id))\r\nfull outer join cte_device_type as h on h.user_id = coalesce(a.user_id, b.user_id, c.user_id,d.user_id, e.user_id, f.user_id, g.user_id)\nlimit 500\n/* limit added automatically by dbt cloud */", 'compiled_sql': 'with cte_gender as ANALYTICS_DB.dbt_ecommerce_features.gender,\n\ncte_age as ANALYTICS_DB.dbt_ecommerce_features.age,\n\ncte_location as ANALYTICS_DB.dbt_ecommerce_features.country_and_state,\n\ncte_email_domain as ANALYTICS_DB.dbt_ecommerce_features.email_domain,\n\ncte_is_member as ANALYTICS_DB.dbt_ecommerce_features.is_member,\n\ncte_has_mobile_app as ANALYTICS_DB.dbt_ecommerce_features.has_mobile_app,\n\ncte_is_active_on_website as ANALYTICS_DB.dbt_ecommerce_features.is_active_on_website,\n\ncte_device_type as ANALYTICS_DB.dbt_ecommerce_features.device_type\n\nselect coalesce(a.user_id, b.user_id, c.user_id, d.user_id, e.user_id, f.user_id, g.user_id, h.user_id) \nas user_id, gender, c.country as country, c.state as state, email_domain, is_member, has_mobile_app, is_active_on_website, device_type\nfrom ((((((cte_gender a full outer join cte_age b on a.user_id = b.user_id) \nfull outer join cte_location c on c.user_id = coalesce(a.user_id, b.user_id))\nfull outer join cte_email_domain d on d.user_id = coalesce(a.user_id, b.user_id, c.user_id))\nfull outer join cte_is_member e on e.user_id = coalesce(a.user_id, b.user_id, c.user_id,d.user_id))\nfull outer join cte_has_mobile_app f on f.user_id = coalesce(a.user_id, b.user_id, c.user_id,d.user_id, e.user_id))\nfull outer join cte_is_active_on_website as g on g.user_id = coalesce(a.user_id, b.user_id, c.user_id,d.user_id, e.user_id, f.user_id))\nfull outer join cte_device_type as h on h.user_id = coalesce(a.user_id, b.user_id, c.user_id,d.user_id, e.user_id, f.user_id, g.user_id)\nlimit 500\n/* limit added automatically by dbt cloud */', 'tags': None}, None)
Traceback (most recent call last):
  File "/usr/local/lib/python3.8/dist-packages/dbt_rpc/task/sql_commands.py", line 147, in _in_thread
    self.node_results.append(runner.safe_run(self.manifest))
  File "/usr/local/lib/python3.8/dist-packages/dbt/task/base.py", line 377, in safe_run
    result = self.error_result(ctx.node, error, started, [])
  File "/usr/local/lib/python3.8/dist-packages/dbt_rpc/rpc/node_runners.py", line 56, in error_result
    raise error
dbt_rpc.rpc.error.RPCException: RPCException(10003, Database Error, {'type': 'DatabaseException', 'message': "Database Error in rpc request (from remote system)\n  001003 (42000): SQL compilation error:\n  syntax error line 1 at position 19 unexpected 'ANALYTICS_DB'.\n  syntax error line 1 at position 61 unexpected ','.\n  syntax error line 3 at position 11 unexpected 'ANALYTICS_DB'.\n  syntax error line 3 at position 50 unexpected ','.\n  syntax error line 5 at position 16 unexpected 'ANALYTICS_DB'.\n  syntax error line 5 at position 69 unexpected ','.\n  syntax error line 7 at position 20 unexpected 'ANALYTICS_DB'.\n  syntax error line 7 at position 68 unexpected ','.\n  syntax error line 9 at position 17 unexpected 'ANALYTICS_DB'.\n  syntax error line 9 at position 62 unexpected ','.\n  syntax error line 11 at position 22 unexpected 'ANALYTICS_DB'.\n  syntax error line 11 at position 72 unexpected ','.\n  syntax error line 13 at position 28 unexpected 'ANALYTICS_DB'.\n  syntax error line 13 at position 84 unexpected ','.\n  syntax error line 15 at position 19 unexpected 'ANALYTICS_DB'.\n  syntax error line 17 at position 16 unexpected 'a'.\n  syntax error line 18 at position 0 unexpected 'as'.", 'raw_sql': "with cte_gender as {{ ref('gender') }},\r\n\r\ncte_age as {{ ref('age') }},\r\n\r\ncte_location as {{ ref('country_and_state') }},\r\n\r\ncte_email_domain as {{ ref('email_domain') }},\r\n\r\ncte_is_member as {{ ref('is_member') }},\r\n\r\ncte_has_mobile_app as {{ ref('has_mobile_app') }},\r\n\r\ncte_is_active_on_website as {{ ref('is_active_on_website') }},\r\n\r\ncte_device_type as {{ ref('device_type') }}\r\n\r\nselect coalesce(a.user_id, b.user_id, c.user_id, d.user_id, e.user_id, f.user_id, g.user_id, h.user_id) \r\nas user_id, gender, c.country as country, c.state as state, email_domain, is_member, has_mobile_app, is_active_on_website, device_type\r\nfrom ((((((cte_gender a full outer join cte_age b on a.user_id = b.user_id) \r\nfull outer join cte_location c on c.user_id = coalesce(a.user_id, b.user_id))\r\nfull outer join cte_email_domain d on d.user_id = coalesce(a.user_id, b.user_id, c.user_id))\r\nfull outer join cte_is_member e on e.user_id = coalesce(a.user_id, b.user_id, c.user_id,d.user_id))\r\nfull outer join cte_has_mobile_app f on f.user_id = coalesce(a.user_id, b.user_id, c.user_id,d.user_id, e.user_id))\r\nfull outer join cte_is_active_on_website as g on g.user_id = coalesce(a.user_id, b.user_id, c.user_id,d.user_id, e.user_id, f.user_id))\r\nfull outer join cte_device_type as h on h.user_id = coalesce(a.user_id, b.user_id, c.user_id,d.user_id, e.user_id, f.user_id, g.user_id)\nlimit 500\n/* limit added automatically by dbt cloud */", 'compiled_sql': 'with cte_gender as ANALYTICS_DB.dbt_ecommerce_features.gender,\n\ncte_age as ANALYTICS_DB.dbt_ecommerce_features.age,\n\ncte_location as ANALYTICS_DB.dbt_ecommerce_features.country_and_state,\n\ncte_email_domain as ANALYTICS_DB.dbt_ecommerce_features.email_domain,\n\ncte_is_member as ANALYTICS_DB.dbt_ecommerce_features.is_member,\n\ncte_has_mobile_app as ANALYTICS_DB.dbt_ecommerce_features.has_mobile_app,\n\ncte_is_active_on_website as ANALYTICS_DB.dbt_ecommerce_features.is_active_on_website,\n\ncte_device_type as ANALYTICS_DB.dbt_ecommerce_features.device_type\n\nselect coalesce(a.user_id, b.user_id, c.user_id, d.user_id, e.user_id, f.user_id, g.user_id, h.user_id) \nas user_id, gender, c.country as country, c.state as state, email_domain, is_member, has_mobile_app, is_active_on_website, device_type\nfrom ((((((cte_gender a full outer join cte_age b on a.user_id = b.user_id) \nfull outer join cte_location c on c.user_id = coalesce(a.user_id, b.user_id))\nfull outer join cte_email_domain d on d.user_id = coalesce(a.user_id, b.user_id, c.user_id))\nfull outer join cte_is_member e on e.user_id = coalesce(a.user_id, b.user_id, c.user_id,d.user_id))\nfull outer join cte_has_mobile_app f on f.user_id = coalesce(a.user_id, b.user_id, c.user_id,d.user_id, e.user_id))\nfull outer join cte_is_active_on_website as g on g.user_id = coalesce(a.user_id, b.user_id, c.user_id,d.user_id, e.user_id, f.user_id))\nfull outer join cte_device_type as h on h.user_id = coalesce(a.user_id, b.user_id, c.user_id,d.user_id, e.user_id, f.user_id, g.user_id)\nlimit 500\n/* limit added automatically by dbt cloud */', 'tags': None}, None)
2022-07-07 08:53:10.302544 (Thread-48): handling poll request
2022-07-07 08:53:10.302981 (Thread-48): 08:53:10  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '8901092b-4e3c-4560-9d28-48dc5c91cc33', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9a204dd370>]}
2022-07-07 08:53:10.303659 (Thread-48): sending response (<Response 27039 bytes [200 OK]>) to 10.0.19.15
2022-07-07 08:53:30.007821 (Thread-49): handling status request
2022-07-07 08:53:30.008246 (Thread-49): 08:53:30  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '8901092b-4e3c-4560-9d28-48dc5c91cc33', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9a204dd7f0>]}
2022-07-07 08:53:30.009488 (Thread-49): sending response (<Response 25749 bytes [200 OK]>) to 10.0.19.15
2022-07-07 08:53:30.372932 (Thread-50): handling compile_sql request
2022-07-07 08:53:30.373333 (Thread-50): 08:53:30  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '8901092b-4e3c-4560-9d28-48dc5c91cc33', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9a204dd9d0>]}
2022-07-07 08:53:32.729575 (Thread-50): sending response (<Response 139 bytes [200 OK]>) to 10.0.19.15
2022-07-07 08:53:32.756334 (MainThread): 08:53:32  Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '7b5fe005-f19a-463b-a49f-e3d6db203408', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f44f7f325b0>]}
2022-07-07 08:53:32.756927 (MainThread): 08:53:32  Found 17 models, 0 tests, 0 snapshots, 0 analyses, 181 macros, 0 operations, 0 seed files, 15 sources, 0 exposures, 0 metrics
2022-07-07 08:53:32.757535 (Thread-1): 08:53:32  Acquiring new snowflake connection "rpc.ecommerce_data_model_dbt.request"
2022-07-07 08:53:32.757671 (Thread-1): 08:53:32  Began compiling node rpc.ecommerce_data_model_dbt.request
2022-07-07 08:53:32.757765 (Thread-1): 08:53:32  Compiling rpc.ecommerce_data_model_dbt.request
2022-07-07 08:53:32.761460 (Thread-1): 08:53:32  finished collecting timing info
2022-07-07 08:53:32.761597 (Thread-1): 08:53:32  Began executing node rpc.ecommerce_data_model_dbt.request
2022-07-07 08:53:32.761696 (Thread-1): 08:53:32  finished collecting timing info
2022-07-07 08:53:33.087869 (Thread-51): handling poll request
2022-07-07 08:53:33.088331 (Thread-51): 08:53:33  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '8901092b-4e3c-4560-9d28-48dc5c91cc33', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9a204e4b20>]}
2022-07-07 08:53:33.089469 (Thread-51): sending response (<Response 11641 bytes [200 OK]>) to 10.0.19.15
2022-07-07 08:54:09.882622 (Thread-52): handling status request
2022-07-07 08:54:09.884163 (Thread-52): 08:54:09  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '8901092b-4e3c-4560-9d28-48dc5c91cc33', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9a204e4d00>]}
2022-07-07 08:54:09.885723 (Thread-52): sending response (<Response 25749 bytes [200 OK]>) to 10.0.19.15
2022-07-07 08:54:10.278461 (Thread-53): handling run_sql request
2022-07-07 08:54:10.278861 (Thread-53): 08:54:10  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '8901092b-4e3c-4560-9d28-48dc5c91cc33', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9a204e4e80>]}
2022-07-07 08:54:12.658811 (Thread-53): sending response (<Response 139 bytes [200 OK]>) to 10.0.19.15
2022-07-07 08:54:12.687372 (MainThread): 08:54:12  Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'fdf20345-09ec-43c6-8c41-b441082b9049', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7f4571a4f0>]}
2022-07-07 08:54:12.688018 (MainThread): 08:54:12  Found 17 models, 0 tests, 0 snapshots, 0 analyses, 181 macros, 0 operations, 0 seed files, 15 sources, 0 exposures, 0 metrics
2022-07-07 08:54:12.688672 (Thread-1): 08:54:12  Acquiring new snowflake connection "rpc.ecommerce_data_model_dbt.request"
2022-07-07 08:54:12.688844 (Thread-1): 08:54:12  Began compiling node rpc.ecommerce_data_model_dbt.request
2022-07-07 08:54:12.688948 (Thread-1): 08:54:12  Compiling rpc.ecommerce_data_model_dbt.request
2022-07-07 08:54:12.692983 (Thread-1): 08:54:12  finished collecting timing info
2022-07-07 08:54:12.693133 (Thread-1): 08:54:12  Began executing node rpc.ecommerce_data_model_dbt.request
2022-07-07 08:54:12.695343 (Thread-1): 08:54:12  Using snowflake connection "rpc.ecommerce_data_model_dbt.request"
2022-07-07 08:54:12.695447 (Thread-1): 08:54:12  On rpc.ecommerce_data_model_dbt.request: with cte_gender as ANALYTICS_DB.dbt_ecommerce_features.gender,

cte_age as ANALYTICS_DB.dbt_ecommerce_features.age,

cte_location as ANALYTICS_DB.dbt_ecommerce_features.country_and_state,

cte_email_domain as ANALYTICS_DB.dbt_ecommerce_features.email_domain,

cte_is_member as ANALYTICS_DB.dbt_ecommerce_features.is_member,

cte_has_mobile_app as ANALYTICS_DB.dbt_ecommerce_features.has_mobile_app,

cte_is_active_on_website as ANALYTICS_DB.dbt_ecommerce_features.is_active_on_website,

cte_device_type as ANALYTICS_DB.dbt_ecommerce_features.device_type

select coalesce(a.user_id, b.user_id, c.user_id, d.user_id, e.user_id, f.user_id, g.user_id, h.user_id) 
as user_id, gender, c.country as country, c.state as state, email_domain, is_member, has_mobile_app, is_active_on_website, device_type
from ((((((cte_gender a full outer join cte_age b on a.user_id = b.user_id) 
full outer join cte_location c on c.user_id = coalesce(a.user_id, b.user_id))
full outer join cte_email_domain d on d.user_id = coalesce(a.user_id, b.user_id, c.user_id))
full outer join cte_is_member e on e.user_id = coalesce(a.user_id, b.user_id, c.user_id,d.user_id))
full outer join cte_has_mobile_app f on f.user_id = coalesce(a.user_id, b.user_id, c.user_id,d.user_id, e.user_id))
full outer join cte_is_active_on_website as g on g.user_id = coalesce(a.user_id, b.user_id, c.user_id,d.user_id, e.user_id, f.user_id))
full outer join cte_device_type as h on h.user_id = coalesce(a.user_id, b.user_id, c.user_id,d.user_id, e.user_id, f.user_id, g.user_id)
limit 500
/* limit added automatically by dbt cloud */
2022-07-07 08:54:12.695536 (Thread-1): 08:54:12  Opening a new connection, currently in state init
2022-07-07 08:54:13.055506 (Thread-54): handling poll request
2022-07-07 08:54:13.056091 (Thread-54): 08:54:13  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '8901092b-4e3c-4560-9d28-48dc5c91cc33', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9a204ec970>]}
2022-07-07 08:54:13.057079 (Thread-54): sending response (<Response 5341 bytes [200 OK]>) to 10.0.19.15
2022-07-07 08:54:13.404508 (Thread-1): 08:54:13  Snowflake adapter: Snowflake query id: 01a57196-0602-3441-0019-8203046b4caa
2022-07-07 08:54:13.404712 (Thread-1): 08:54:13  Snowflake adapter: Snowflake error: 001003 (42000): SQL compilation error:
syntax error line 1 at position 19 unexpected 'ANALYTICS_DB'.
syntax error line 1 at position 61 unexpected ','.
syntax error line 3 at position 11 unexpected 'ANALYTICS_DB'.
syntax error line 3 at position 50 unexpected ','.
syntax error line 5 at position 16 unexpected 'ANALYTICS_DB'.
syntax error line 5 at position 69 unexpected ','.
syntax error line 7 at position 20 unexpected 'ANALYTICS_DB'.
syntax error line 7 at position 68 unexpected ','.
syntax error line 9 at position 17 unexpected 'ANALYTICS_DB'.
syntax error line 9 at position 62 unexpected ','.
syntax error line 11 at position 22 unexpected 'ANALYTICS_DB'.
syntax error line 11 at position 72 unexpected ','.
syntax error line 13 at position 28 unexpected 'ANALYTICS_DB'.
syntax error line 13 at position 84 unexpected ','.
syntax error line 15 at position 19 unexpected 'ANALYTICS_DB'.
syntax error line 17 at position 16 unexpected 'a'.
syntax error line 18 at position 0 unexpected 'as'.
2022-07-07 08:54:13.404904 (Thread-1): 08:54:13  finished collecting timing info
2022-07-07 08:54:13.405072 (Thread-1): 08:54:13  On rpc.ecommerce_data_model_dbt.request: Close
2022-07-07 08:54:13.458672 (Thread-1): Got an exception: Database Error
  001003 (42000): SQL compilation error:
  syntax error line 1 at position 19 unexpected 'ANALYTICS_DB'.
  syntax error line 1 at position 61 unexpected ','.
  syntax error line 3 at position 11 unexpected 'ANALYTICS_DB'.
  syntax error line 3 at position 50 unexpected ','.
  syntax error line 5 at position 16 unexpected 'ANALYTICS_DB'.
  syntax error line 5 at position 69 unexpected ','.
  syntax error line 7 at position 20 unexpected 'ANALYTICS_DB'.
  syntax error line 7 at position 68 unexpected ','.
  syntax error line 9 at position 17 unexpected 'ANALYTICS_DB'.
  syntax error line 9 at position 62 unexpected ','.
  syntax error line 11 at position 22 unexpected 'ANALYTICS_DB'.
  syntax error line 11 at position 72 unexpected ','.
  syntax error line 13 at position 28 unexpected 'ANALYTICS_DB'.
  syntax error line 13 at position 84 unexpected ','.
  syntax error line 15 at position 19 unexpected 'ANALYTICS_DB'.
  syntax error line 17 at position 16 unexpected 'a'.
  syntax error line 18 at position 0 unexpected 'as'.
Traceback (most recent call last):
  File "/usr/local/lib/python3.8/dist-packages/dbt/adapters/snowflake/connections.py", line 206, in exception_handler
    yield
  File "/usr/local/lib/python3.8/dist-packages/dbt/adapters/sql/connections.py", line 74, in add_query
    cursor.execute(sql, bindings)
  File "/usr/local/lib/python3.8/dist-packages/snowflake/connector/cursor.py", line 721, in execute
    Error.errorhandler_wrapper(
  File "/usr/local/lib/python3.8/dist-packages/snowflake/connector/errors.py", line 258, in errorhandler_wrapper
    cursor.errorhandler(connection, cursor, error_class, error_value)
  File "/usr/local/lib/python3.8/dist-packages/snowflake/connector/errors.py", line 188, in default_errorhandler
    raise error_class(
snowflake.connector.errors.ProgrammingError: 001003 (42000): SQL compilation error:
syntax error line 1 at position 19 unexpected 'ANALYTICS_DB'.
syntax error line 1 at position 61 unexpected ','.
syntax error line 3 at position 11 unexpected 'ANALYTICS_DB'.
syntax error line 3 at position 50 unexpected ','.
syntax error line 5 at position 16 unexpected 'ANALYTICS_DB'.
syntax error line 5 at position 69 unexpected ','.
syntax error line 7 at position 20 unexpected 'ANALYTICS_DB'.
syntax error line 7 at position 68 unexpected ','.
syntax error line 9 at position 17 unexpected 'ANALYTICS_DB'.
syntax error line 9 at position 62 unexpected ','.
syntax error line 11 at position 22 unexpected 'ANALYTICS_DB'.
syntax error line 11 at position 72 unexpected ','.
syntax error line 13 at position 28 unexpected 'ANALYTICS_DB'.
syntax error line 13 at position 84 unexpected ','.
syntax error line 15 at position 19 unexpected 'ANALYTICS_DB'.
syntax error line 17 at position 16 unexpected 'a'.
syntax error line 18 at position 0 unexpected 'as'.

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/usr/local/lib/python3.8/dist-packages/dbt/task/base.py", line 361, in safe_run
    result = self.compile_and_execute(manifest, ctx)
  File "/usr/local/lib/python3.8/dist-packages/dbt/task/base.py", line 314, in compile_and_execute
    result = self.run(ctx.node, manifest)
  File "/usr/local/lib/python3.8/dist-packages/dbt/task/base.py", line 403, in run
    return self.execute(compiled_node, manifest)
  File "/usr/local/lib/python3.8/dist-packages/dbt_rpc/rpc/node_runners.py", line 90, in execute
    _, execute_result = self.adapter.execute(
  File "/usr/local/lib/python3.8/dist-packages/dbt/adapters/base/impl.py", line 225, in execute
    return self.connections.execute(
  File "/usr/local/lib/python3.8/dist-packages/dbt/adapters/sql/connections.py", line 127, in execute
    _, cursor = self.add_query(sql, auto_begin)
  File "/usr/local/lib/python3.8/dist-packages/dbt/adapters/snowflake/connections.py", line 433, in add_query
    connection, cursor = super().add_query(
  File "/usr/local/lib/python3.8/dist-packages/dbt/adapters/sql/connections.py", line 83, in add_query
    return connection, cursor
  File "/usr/lib/python3.8/contextlib.py", line 131, in __exit__
    self.gen.throw(type, value, traceback)
  File "/usr/local/lib/python3.8/dist-packages/dbt/adapters/snowflake/connections.py", line 223, in exception_handler
    raise DatabaseException(msg)
dbt.exceptions.DatabaseException: Database Error
  001003 (42000): SQL compilation error:
  syntax error line 1 at position 19 unexpected 'ANALYTICS_DB'.
  syntax error line 1 at position 61 unexpected ','.
  syntax error line 3 at position 11 unexpected 'ANALYTICS_DB'.
  syntax error line 3 at position 50 unexpected ','.
  syntax error line 5 at position 16 unexpected 'ANALYTICS_DB'.
  syntax error line 5 at position 69 unexpected ','.
  syntax error line 7 at position 20 unexpected 'ANALYTICS_DB'.
  syntax error line 7 at position 68 unexpected ','.
  syntax error line 9 at position 17 unexpected 'ANALYTICS_DB'.
  syntax error line 9 at position 62 unexpected ','.
  syntax error line 11 at position 22 unexpected 'ANALYTICS_DB'.
  syntax error line 11 at position 72 unexpected ','.
  syntax error line 13 at position 28 unexpected 'ANALYTICS_DB'.
  syntax error line 13 at position 84 unexpected ','.
  syntax error line 15 at position 19 unexpected 'ANALYTICS_DB'.
  syntax error line 17 at position 16 unexpected 'a'.
  syntax error line 18 at position 0 unexpected 'as'.
2022-07-07 08:54:13.459454 (Thread-1): Got exception RPCException(10003, Database Error, {'type': 'DatabaseException', 'message': "Database Error in rpc request (from remote system)\n  001003 (42000): SQL compilation error:\n  syntax error line 1 at position 19 unexpected 'ANALYTICS_DB'.\n  syntax error line 1 at position 61 unexpected ','.\n  syntax error line 3 at position 11 unexpected 'ANALYTICS_DB'.\n  syntax error line 3 at position 50 unexpected ','.\n  syntax error line 5 at position 16 unexpected 'ANALYTICS_DB'.\n  syntax error line 5 at position 69 unexpected ','.\n  syntax error line 7 at position 20 unexpected 'ANALYTICS_DB'.\n  syntax error line 7 at position 68 unexpected ','.\n  syntax error line 9 at position 17 unexpected 'ANALYTICS_DB'.\n  syntax error line 9 at position 62 unexpected ','.\n  syntax error line 11 at position 22 unexpected 'ANALYTICS_DB'.\n  syntax error line 11 at position 72 unexpected ','.\n  syntax error line 13 at position 28 unexpected 'ANALYTICS_DB'.\n  syntax error line 13 at position 84 unexpected ','.\n  syntax error line 15 at position 19 unexpected 'ANALYTICS_DB'.\n  syntax error line 17 at position 16 unexpected 'a'.\n  syntax error line 18 at position 0 unexpected 'as'.", 'raw_sql': "with cte_gender as {{ ref('gender') }},\r\n\r\ncte_age as {{ ref('age') }},\r\n\r\ncte_location as {{ ref('country_and_state') }},\r\n\r\ncte_email_domain as {{ ref('email_domain') }},\r\n\r\ncte_is_member as {{ ref('is_member') }},\r\n\r\ncte_has_mobile_app as {{ ref('has_mobile_app') }},\r\n\r\ncte_is_active_on_website as {{ ref('is_active_on_website') }},\r\n\r\ncte_device_type as {{ ref('device_type') }}\r\n\r\nselect coalesce(a.user_id, b.user_id, c.user_id, d.user_id, e.user_id, f.user_id, g.user_id, h.user_id) \r\nas user_id, gender, c.country as country, c.state as state, email_domain, is_member, has_mobile_app, is_active_on_website, device_type\r\nfrom ((((((cte_gender a full outer join cte_age b on a.user_id = b.user_id) \r\nfull outer join cte_location c on c.user_id = coalesce(a.user_id, b.user_id))\r\nfull outer join cte_email_domain d on d.user_id = coalesce(a.user_id, b.user_id, c.user_id))\r\nfull outer join cte_is_member e on e.user_id = coalesce(a.user_id, b.user_id, c.user_id,d.user_id))\r\nfull outer join cte_has_mobile_app f on f.user_id = coalesce(a.user_id, b.user_id, c.user_id,d.user_id, e.user_id))\r\nfull outer join cte_is_active_on_website as g on g.user_id = coalesce(a.user_id, b.user_id, c.user_id,d.user_id, e.user_id, f.user_id))\r\nfull outer join cte_device_type as h on h.user_id = coalesce(a.user_id, b.user_id, c.user_id,d.user_id, e.user_id, f.user_id, g.user_id)\nlimit 500\n/* limit added automatically by dbt cloud */", 'compiled_sql': 'with cte_gender as ANALYTICS_DB.dbt_ecommerce_features.gender,\n\ncte_age as ANALYTICS_DB.dbt_ecommerce_features.age,\n\ncte_location as ANALYTICS_DB.dbt_ecommerce_features.country_and_state,\n\ncte_email_domain as ANALYTICS_DB.dbt_ecommerce_features.email_domain,\n\ncte_is_member as ANALYTICS_DB.dbt_ecommerce_features.is_member,\n\ncte_has_mobile_app as ANALYTICS_DB.dbt_ecommerce_features.has_mobile_app,\n\ncte_is_active_on_website as ANALYTICS_DB.dbt_ecommerce_features.is_active_on_website,\n\ncte_device_type as ANALYTICS_DB.dbt_ecommerce_features.device_type\n\nselect coalesce(a.user_id, b.user_id, c.user_id, d.user_id, e.user_id, f.user_id, g.user_id, h.user_id) \nas user_id, gender, c.country as country, c.state as state, email_domain, is_member, has_mobile_app, is_active_on_website, device_type\nfrom ((((((cte_gender a full outer join cte_age b on a.user_id = b.user_id) \nfull outer join cte_location c on c.user_id = coalesce(a.user_id, b.user_id))\nfull outer join cte_email_domain d on d.user_id = coalesce(a.user_id, b.user_id, c.user_id))\nfull outer join cte_is_member e on e.user_id = coalesce(a.user_id, b.user_id, c.user_id,d.user_id))\nfull outer join cte_has_mobile_app f on f.user_id = coalesce(a.user_id, b.user_id, c.user_id,d.user_id, e.user_id))\nfull outer join cte_is_active_on_website as g on g.user_id = coalesce(a.user_id, b.user_id, c.user_id,d.user_id, e.user_id, f.user_id))\nfull outer join cte_device_type as h on h.user_id = coalesce(a.user_id, b.user_id, c.user_id,d.user_id, e.user_id, f.user_id, g.user_id)\nlimit 500\n/* limit added automatically by dbt cloud */', 'tags': None}, None)
Traceback (most recent call last):
  File "/usr/local/lib/python3.8/dist-packages/dbt_rpc/task/sql_commands.py", line 147, in _in_thread
    self.node_results.append(runner.safe_run(self.manifest))
  File "/usr/local/lib/python3.8/dist-packages/dbt/task/base.py", line 377, in safe_run
    result = self.error_result(ctx.node, error, started, [])
  File "/usr/local/lib/python3.8/dist-packages/dbt_rpc/rpc/node_runners.py", line 56, in error_result
    raise error
dbt_rpc.rpc.error.RPCException: RPCException(10003, Database Error, {'type': 'DatabaseException', 'message': "Database Error in rpc request (from remote system)\n  001003 (42000): SQL compilation error:\n  syntax error line 1 at position 19 unexpected 'ANALYTICS_DB'.\n  syntax error line 1 at position 61 unexpected ','.\n  syntax error line 3 at position 11 unexpected 'ANALYTICS_DB'.\n  syntax error line 3 at position 50 unexpected ','.\n  syntax error line 5 at position 16 unexpected 'ANALYTICS_DB'.\n  syntax error line 5 at position 69 unexpected ','.\n  syntax error line 7 at position 20 unexpected 'ANALYTICS_DB'.\n  syntax error line 7 at position 68 unexpected ','.\n  syntax error line 9 at position 17 unexpected 'ANALYTICS_DB'.\n  syntax error line 9 at position 62 unexpected ','.\n  syntax error line 11 at position 22 unexpected 'ANALYTICS_DB'.\n  syntax error line 11 at position 72 unexpected ','.\n  syntax error line 13 at position 28 unexpected 'ANALYTICS_DB'.\n  syntax error line 13 at position 84 unexpected ','.\n  syntax error line 15 at position 19 unexpected 'ANALYTICS_DB'.\n  syntax error line 17 at position 16 unexpected 'a'.\n  syntax error line 18 at position 0 unexpected 'as'.", 'raw_sql': "with cte_gender as {{ ref('gender') }},\r\n\r\ncte_age as {{ ref('age') }},\r\n\r\ncte_location as {{ ref('country_and_state') }},\r\n\r\ncte_email_domain as {{ ref('email_domain') }},\r\n\r\ncte_is_member as {{ ref('is_member') }},\r\n\r\ncte_has_mobile_app as {{ ref('has_mobile_app') }},\r\n\r\ncte_is_active_on_website as {{ ref('is_active_on_website') }},\r\n\r\ncte_device_type as {{ ref('device_type') }}\r\n\r\nselect coalesce(a.user_id, b.user_id, c.user_id, d.user_id, e.user_id, f.user_id, g.user_id, h.user_id) \r\nas user_id, gender, c.country as country, c.state as state, email_domain, is_member, has_mobile_app, is_active_on_website, device_type\r\nfrom ((((((cte_gender a full outer join cte_age b on a.user_id = b.user_id) \r\nfull outer join cte_location c on c.user_id = coalesce(a.user_id, b.user_id))\r\nfull outer join cte_email_domain d on d.user_id = coalesce(a.user_id, b.user_id, c.user_id))\r\nfull outer join cte_is_member e on e.user_id = coalesce(a.user_id, b.user_id, c.user_id,d.user_id))\r\nfull outer join cte_has_mobile_app f on f.user_id = coalesce(a.user_id, b.user_id, c.user_id,d.user_id, e.user_id))\r\nfull outer join cte_is_active_on_website as g on g.user_id = coalesce(a.user_id, b.user_id, c.user_id,d.user_id, e.user_id, f.user_id))\r\nfull outer join cte_device_type as h on h.user_id = coalesce(a.user_id, b.user_id, c.user_id,d.user_id, e.user_id, f.user_id, g.user_id)\nlimit 500\n/* limit added automatically by dbt cloud */", 'compiled_sql': 'with cte_gender as ANALYTICS_DB.dbt_ecommerce_features.gender,\n\ncte_age as ANALYTICS_DB.dbt_ecommerce_features.age,\n\ncte_location as ANALYTICS_DB.dbt_ecommerce_features.country_and_state,\n\ncte_email_domain as ANALYTICS_DB.dbt_ecommerce_features.email_domain,\n\ncte_is_member as ANALYTICS_DB.dbt_ecommerce_features.is_member,\n\ncte_has_mobile_app as ANALYTICS_DB.dbt_ecommerce_features.has_mobile_app,\n\ncte_is_active_on_website as ANALYTICS_DB.dbt_ecommerce_features.is_active_on_website,\n\ncte_device_type as ANALYTICS_DB.dbt_ecommerce_features.device_type\n\nselect coalesce(a.user_id, b.user_id, c.user_id, d.user_id, e.user_id, f.user_id, g.user_id, h.user_id) \nas user_id, gender, c.country as country, c.state as state, email_domain, is_member, has_mobile_app, is_active_on_website, device_type\nfrom ((((((cte_gender a full outer join cte_age b on a.user_id = b.user_id) \nfull outer join cte_location c on c.user_id = coalesce(a.user_id, b.user_id))\nfull outer join cte_email_domain d on d.user_id = coalesce(a.user_id, b.user_id, c.user_id))\nfull outer join cte_is_member e on e.user_id = coalesce(a.user_id, b.user_id, c.user_id,d.user_id))\nfull outer join cte_has_mobile_app f on f.user_id = coalesce(a.user_id, b.user_id, c.user_id,d.user_id, e.user_id))\nfull outer join cte_is_active_on_website as g on g.user_id = coalesce(a.user_id, b.user_id, c.user_id,d.user_id, e.user_id, f.user_id))\nfull outer join cte_device_type as h on h.user_id = coalesce(a.user_id, b.user_id, c.user_id,d.user_id, e.user_id, f.user_id, g.user_id)\nlimit 500\n/* limit added automatically by dbt cloud */', 'tags': None}, None)
2022-07-07 08:54:14.415561 (Thread-55): handling poll request
2022-07-07 08:54:14.415996 (Thread-55): 08:54:14  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '8901092b-4e3c-4560-9d28-48dc5c91cc33', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9a204ecc70>]}
2022-07-07 08:54:14.416708 (Thread-55): sending response (<Response 27039 bytes [200 OK]>) to 10.0.19.15
2022-07-07 08:54:23.297719 (Thread-56): handling status request
2022-07-07 08:54:23.298165 (Thread-56): 08:54:23  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '8901092b-4e3c-4560-9d28-48dc5c91cc33', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9a204e6130>]}
2022-07-07 08:54:23.299430 (Thread-56): sending response (<Response 25749 bytes [200 OK]>) to 10.0.19.15
2022-07-07 08:54:23.667840 (Thread-57): handling compile_sql request
2022-07-07 08:54:23.668242 (Thread-57): 08:54:23  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '8901092b-4e3c-4560-9d28-48dc5c91cc33', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9a204e6310>]}
2022-07-07 08:54:26.094347 (Thread-57): sending response (<Response 139 bytes [200 OK]>) to 10.0.19.15
2022-07-07 08:54:26.121156 (MainThread): 08:54:26  Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'f8257298-42b4-4462-b0bc-97236444ae16', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f410bf72520>]}
2022-07-07 08:54:26.121719 (MainThread): 08:54:26  Found 17 models, 0 tests, 0 snapshots, 0 analyses, 181 macros, 0 operations, 0 seed files, 15 sources, 0 exposures, 0 metrics
2022-07-07 08:54:26.122341 (Thread-1): 08:54:26  Acquiring new snowflake connection "rpc.ecommerce_data_model_dbt.request"
2022-07-07 08:54:26.122481 (Thread-1): 08:54:26  Began compiling node rpc.ecommerce_data_model_dbt.request
2022-07-07 08:54:26.122577 (Thread-1): 08:54:26  Compiling rpc.ecommerce_data_model_dbt.request
2022-07-07 08:54:26.126207 (Thread-1): 08:54:26  finished collecting timing info
2022-07-07 08:54:26.126344 (Thread-1): 08:54:26  Began executing node rpc.ecommerce_data_model_dbt.request
2022-07-07 08:54:26.126445 (Thread-1): 08:54:26  finished collecting timing info
2022-07-07 08:54:26.453214 (Thread-58): handling poll request
2022-07-07 08:54:26.453682 (Thread-58): 08:54:26  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '8901092b-4e3c-4560-9d28-48dc5c91cc33', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9a2047e460>]}
2022-07-07 08:54:26.454787 (Thread-58): sending response (<Response 11641 bytes [200 OK]>) to 10.0.19.15
2022-07-07 08:54:52.115908 (Thread-59): handling status request
2022-07-07 08:54:52.116322 (Thread-59): 08:54:52  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '8901092b-4e3c-4560-9d28-48dc5c91cc33', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9a2047e640>]}
2022-07-07 08:54:52.137886 (Thread-59): sending response (<Response 25749 bytes [200 OK]>) to 10.0.19.15
2022-07-07 08:54:52.501584 (Thread-60): handling run_sql request
2022-07-07 08:54:52.501986 (Thread-60): 08:54:52  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '8901092b-4e3c-4560-9d28-48dc5c91cc33', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9a2047e1c0>]}
2022-07-07 08:54:54.889718 (Thread-60): sending response (<Response 139 bytes [200 OK]>) to 10.0.19.15
2022-07-07 08:54:54.917271 (MainThread): 08:54:54  Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '4f426ff3-6b9d-4456-90f8-fd4ac84215a4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f042ca4fe50>]}
2022-07-07 08:54:54.917850 (MainThread): 08:54:54  Found 17 models, 0 tests, 0 snapshots, 0 analyses, 181 macros, 0 operations, 0 seed files, 15 sources, 0 exposures, 0 metrics
2022-07-07 08:54:54.918479 (Thread-1): 08:54:54  Acquiring new snowflake connection "rpc.ecommerce_data_model_dbt.request"
2022-07-07 08:54:54.918617 (Thread-1): 08:54:54  Began compiling node rpc.ecommerce_data_model_dbt.request
2022-07-07 08:54:54.918715 (Thread-1): 08:54:54  Compiling rpc.ecommerce_data_model_dbt.request
2022-07-07 08:54:54.922432 (Thread-1): 08:54:54  finished collecting timing info
2022-07-07 08:54:54.922567 (Thread-1): 08:54:54  Began executing node rpc.ecommerce_data_model_dbt.request
2022-07-07 08:54:54.924886 (Thread-1): 08:54:54  Using snowflake connection "rpc.ecommerce_data_model_dbt.request"
2022-07-07 08:54:54.924990 (Thread-1): 08:54:54  On rpc.ecommerce_data_model_dbt.request: with cte_gender as ANALYTICS_DB.dbt_ecommerce_features.gender,

cte_age as ANALYTICS_DB.dbt_ecommerce_features.age,

cte_location as ANALYTICS_DB.dbt_ecommerce_features.country_and_state,

cte_email_domain as ANALYTICS_DB.dbt_ecommerce_features.email_domain,

cte_is_member as ANALYTICS_DB.dbt_ecommerce_features.is_member,

cte_has_mobile_app as ANALYTICS_DB.dbt_ecommerce_features.has_mobile_app,

cte_is_active_on_website as ANALYTICS_DB.dbt_ecommerce_features.is_active_on_website,

cte_device_type as ANALYTICS_DB.dbt_ecommerce_features.device_type

select coalesce(a.user_id, b.user_id, c.user_id, d.user_id, e.user_id, f.user_id, g.user_id, h.user_id) 
as user_id, gender, c.country as country, c.state as state, email_domain, is_member, has_mobile_app, is_active_on_website, device_type
from ((((((cte_gender a full outer join cte_age b on a.user_id = b.user_id) 
full outer join cte_location c on c.user_id = coalesce(a.user_id, b.user_id))
full outer join cte_email_domain d on d.user_id = coalesce(a.user_id, b.user_id, c.user_id))
full outer join cte_is_member e on e.user_id = coalesce(a.user_id, b.user_id, c.user_id,d.user_id))
full outer join cte_has_mobile_app f on f.user_id = coalesce(a.user_id, b.user_id, c.user_id,d.user_id, e.user_id))
full outer join cte_is_active_on_website as g on g.user_id = coalesce(a.user_id, b.user_id, c.user_id,d.user_id, e.user_id, f.user_id))
full outer join cte_device_type as h on h.user_id = coalesce(a.user_id, b.user_id, c.user_id,d.user_id, e.user_id, f.user_id, g.user_id)
limit 500
/* limit added automatically by dbt cloud */
2022-07-07 08:54:54.925076 (Thread-1): 08:54:54  Opening a new connection, currently in state init
2022-07-07 08:54:55.276471 (Thread-61): handling poll request
2022-07-07 08:54:55.276950 (Thread-61): 08:54:55  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '8901092b-4e3c-4560-9d28-48dc5c91cc33', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9a204a29d0>]}
2022-07-07 08:54:55.277817 (Thread-61): sending response (<Response 5338 bytes [200 OK]>) to 10.0.19.15
2022-07-07 08:54:55.627419 (Thread-1): 08:54:55  Snowflake adapter: Snowflake query id: 01a57196-0602-3374-0019-8203046b593a
2022-07-07 08:54:55.627630 (Thread-1): 08:54:55  Snowflake adapter: Snowflake error: 001003 (42000): SQL compilation error:
syntax error line 1 at position 19 unexpected 'ANALYTICS_DB'.
syntax error line 1 at position 61 unexpected ','.
syntax error line 3 at position 11 unexpected 'ANALYTICS_DB'.
syntax error line 3 at position 50 unexpected ','.
syntax error line 5 at position 16 unexpected 'ANALYTICS_DB'.
syntax error line 5 at position 69 unexpected ','.
syntax error line 7 at position 20 unexpected 'ANALYTICS_DB'.
syntax error line 7 at position 68 unexpected ','.
syntax error line 9 at position 17 unexpected 'ANALYTICS_DB'.
syntax error line 9 at position 62 unexpected ','.
syntax error line 11 at position 22 unexpected 'ANALYTICS_DB'.
syntax error line 11 at position 72 unexpected ','.
syntax error line 13 at position 28 unexpected 'ANALYTICS_DB'.
syntax error line 13 at position 84 unexpected ','.
syntax error line 15 at position 19 unexpected 'ANALYTICS_DB'.
syntax error line 17 at position 16 unexpected 'a'.
syntax error line 18 at position 0 unexpected 'as'.
2022-07-07 08:54:55.627832 (Thread-1): 08:54:55  finished collecting timing info
2022-07-07 08:54:55.628011 (Thread-1): 08:54:55  On rpc.ecommerce_data_model_dbt.request: Close
2022-07-07 08:54:55.677804 (Thread-1): Got an exception: Database Error
  001003 (42000): SQL compilation error:
  syntax error line 1 at position 19 unexpected 'ANALYTICS_DB'.
  syntax error line 1 at position 61 unexpected ','.
  syntax error line 3 at position 11 unexpected 'ANALYTICS_DB'.
  syntax error line 3 at position 50 unexpected ','.
  syntax error line 5 at position 16 unexpected 'ANALYTICS_DB'.
  syntax error line 5 at position 69 unexpected ','.
  syntax error line 7 at position 20 unexpected 'ANALYTICS_DB'.
  syntax error line 7 at position 68 unexpected ','.
  syntax error line 9 at position 17 unexpected 'ANALYTICS_DB'.
  syntax error line 9 at position 62 unexpected ','.
  syntax error line 11 at position 22 unexpected 'ANALYTICS_DB'.
  syntax error line 11 at position 72 unexpected ','.
  syntax error line 13 at position 28 unexpected 'ANALYTICS_DB'.
  syntax error line 13 at position 84 unexpected ','.
  syntax error line 15 at position 19 unexpected 'ANALYTICS_DB'.
  syntax error line 17 at position 16 unexpected 'a'.
  syntax error line 18 at position 0 unexpected 'as'.
Traceback (most recent call last):
  File "/usr/local/lib/python3.8/dist-packages/dbt/adapters/snowflake/connections.py", line 206, in exception_handler
    yield
  File "/usr/local/lib/python3.8/dist-packages/dbt/adapters/sql/connections.py", line 74, in add_query
    cursor.execute(sql, bindings)
  File "/usr/local/lib/python3.8/dist-packages/snowflake/connector/cursor.py", line 721, in execute
    Error.errorhandler_wrapper(
  File "/usr/local/lib/python3.8/dist-packages/snowflake/connector/errors.py", line 258, in errorhandler_wrapper
    cursor.errorhandler(connection, cursor, error_class, error_value)
  File "/usr/local/lib/python3.8/dist-packages/snowflake/connector/errors.py", line 188, in default_errorhandler
    raise error_class(
snowflake.connector.errors.ProgrammingError: 001003 (42000): SQL compilation error:
syntax error line 1 at position 19 unexpected 'ANALYTICS_DB'.
syntax error line 1 at position 61 unexpected ','.
syntax error line 3 at position 11 unexpected 'ANALYTICS_DB'.
syntax error line 3 at position 50 unexpected ','.
syntax error line 5 at position 16 unexpected 'ANALYTICS_DB'.
syntax error line 5 at position 69 unexpected ','.
syntax error line 7 at position 20 unexpected 'ANALYTICS_DB'.
syntax error line 7 at position 68 unexpected ','.
syntax error line 9 at position 17 unexpected 'ANALYTICS_DB'.
syntax error line 9 at position 62 unexpected ','.
syntax error line 11 at position 22 unexpected 'ANALYTICS_DB'.
syntax error line 11 at position 72 unexpected ','.
syntax error line 13 at position 28 unexpected 'ANALYTICS_DB'.
syntax error line 13 at position 84 unexpected ','.
syntax error line 15 at position 19 unexpected 'ANALYTICS_DB'.
syntax error line 17 at position 16 unexpected 'a'.
syntax error line 18 at position 0 unexpected 'as'.

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/usr/local/lib/python3.8/dist-packages/dbt/task/base.py", line 361, in safe_run
    result = self.compile_and_execute(manifest, ctx)
  File "/usr/local/lib/python3.8/dist-packages/dbt/task/base.py", line 314, in compile_and_execute
    result = self.run(ctx.node, manifest)
  File "/usr/local/lib/python3.8/dist-packages/dbt/task/base.py", line 403, in run
    return self.execute(compiled_node, manifest)
  File "/usr/local/lib/python3.8/dist-packages/dbt_rpc/rpc/node_runners.py", line 90, in execute
    _, execute_result = self.adapter.execute(
  File "/usr/local/lib/python3.8/dist-packages/dbt/adapters/base/impl.py", line 225, in execute
    return self.connections.execute(
  File "/usr/local/lib/python3.8/dist-packages/dbt/adapters/sql/connections.py", line 127, in execute
    _, cursor = self.add_query(sql, auto_begin)
  File "/usr/local/lib/python3.8/dist-packages/dbt/adapters/snowflake/connections.py", line 433, in add_query
    connection, cursor = super().add_query(
  File "/usr/local/lib/python3.8/dist-packages/dbt/adapters/sql/connections.py", line 83, in add_query
    return connection, cursor
  File "/usr/lib/python3.8/contextlib.py", line 131, in __exit__
    self.gen.throw(type, value, traceback)
  File "/usr/local/lib/python3.8/dist-packages/dbt/adapters/snowflake/connections.py", line 223, in exception_handler
    raise DatabaseException(msg)
dbt.exceptions.DatabaseException: Database Error
  001003 (42000): SQL compilation error:
  syntax error line 1 at position 19 unexpected 'ANALYTICS_DB'.
  syntax error line 1 at position 61 unexpected ','.
  syntax error line 3 at position 11 unexpected 'ANALYTICS_DB'.
  syntax error line 3 at position 50 unexpected ','.
  syntax error line 5 at position 16 unexpected 'ANALYTICS_DB'.
  syntax error line 5 at position 69 unexpected ','.
  syntax error line 7 at position 20 unexpected 'ANALYTICS_DB'.
  syntax error line 7 at position 68 unexpected ','.
  syntax error line 9 at position 17 unexpected 'ANALYTICS_DB'.
  syntax error line 9 at position 62 unexpected ','.
  syntax error line 11 at position 22 unexpected 'ANALYTICS_DB'.
  syntax error line 11 at position 72 unexpected ','.
  syntax error line 13 at position 28 unexpected 'ANALYTICS_DB'.
  syntax error line 13 at position 84 unexpected ','.
  syntax error line 15 at position 19 unexpected 'ANALYTICS_DB'.
  syntax error line 17 at position 16 unexpected 'a'.
  syntax error line 18 at position 0 unexpected 'as'.
2022-07-07 08:54:55.678595 (Thread-1): Got exception RPCException(10003, Database Error, {'type': 'DatabaseException', 'message': "Database Error in rpc request (from remote system)\n  001003 (42000): SQL compilation error:\n  syntax error line 1 at position 19 unexpected 'ANALYTICS_DB'.\n  syntax error line 1 at position 61 unexpected ','.\n  syntax error line 3 at position 11 unexpected 'ANALYTICS_DB'.\n  syntax error line 3 at position 50 unexpected ','.\n  syntax error line 5 at position 16 unexpected 'ANALYTICS_DB'.\n  syntax error line 5 at position 69 unexpected ','.\n  syntax error line 7 at position 20 unexpected 'ANALYTICS_DB'.\n  syntax error line 7 at position 68 unexpected ','.\n  syntax error line 9 at position 17 unexpected 'ANALYTICS_DB'.\n  syntax error line 9 at position 62 unexpected ','.\n  syntax error line 11 at position 22 unexpected 'ANALYTICS_DB'.\n  syntax error line 11 at position 72 unexpected ','.\n  syntax error line 13 at position 28 unexpected 'ANALYTICS_DB'.\n  syntax error line 13 at position 84 unexpected ','.\n  syntax error line 15 at position 19 unexpected 'ANALYTICS_DB'.\n  syntax error line 17 at position 16 unexpected 'a'.\n  syntax error line 18 at position 0 unexpected 'as'.", 'raw_sql': "with cte_gender as {{ ref('gender') }},\r\n\r\ncte_age as {{ ref('age') }},\r\n\r\ncte_location as {{ ref('country_and_state') }},\r\n\r\ncte_email_domain as {{ ref('email_domain') }},\r\n\r\ncte_is_member as {{ ref('is_member') }},\r\n\r\ncte_has_mobile_app as {{ ref('has_mobile_app') }},\r\n\r\ncte_is_active_on_website as {{ ref('is_active_on_website') }},\r\n\r\ncte_device_type as {{ ref('device_type') }}\r\n\r\nselect coalesce(a.user_id, b.user_id, c.user_id, d.user_id, e.user_id, f.user_id, g.user_id, h.user_id) \r\nas user_id, gender, c.country as country, c.state as state, email_domain, is_member, has_mobile_app, is_active_on_website, device_type\r\nfrom ((((((cte_gender a full outer join cte_age b on a.user_id = b.user_id) \r\nfull outer join cte_location c on c.user_id = coalesce(a.user_id, b.user_id))\r\nfull outer join cte_email_domain d on d.user_id = coalesce(a.user_id, b.user_id, c.user_id))\r\nfull outer join cte_is_member e on e.user_id = coalesce(a.user_id, b.user_id, c.user_id,d.user_id))\r\nfull outer join cte_has_mobile_app f on f.user_id = coalesce(a.user_id, b.user_id, c.user_id,d.user_id, e.user_id))\r\nfull outer join cte_is_active_on_website as g on g.user_id = coalesce(a.user_id, b.user_id, c.user_id,d.user_id, e.user_id, f.user_id))\r\nfull outer join cte_device_type as h on h.user_id = coalesce(a.user_id, b.user_id, c.user_id,d.user_id, e.user_id, f.user_id, g.user_id)\nlimit 500\n/* limit added automatically by dbt cloud */", 'compiled_sql': 'with cte_gender as ANALYTICS_DB.dbt_ecommerce_features.gender,\n\ncte_age as ANALYTICS_DB.dbt_ecommerce_features.age,\n\ncte_location as ANALYTICS_DB.dbt_ecommerce_features.country_and_state,\n\ncte_email_domain as ANALYTICS_DB.dbt_ecommerce_features.email_domain,\n\ncte_is_member as ANALYTICS_DB.dbt_ecommerce_features.is_member,\n\ncte_has_mobile_app as ANALYTICS_DB.dbt_ecommerce_features.has_mobile_app,\n\ncte_is_active_on_website as ANALYTICS_DB.dbt_ecommerce_features.is_active_on_website,\n\ncte_device_type as ANALYTICS_DB.dbt_ecommerce_features.device_type\n\nselect coalesce(a.user_id, b.user_id, c.user_id, d.user_id, e.user_id, f.user_id, g.user_id, h.user_id) \nas user_id, gender, c.country as country, c.state as state, email_domain, is_member, has_mobile_app, is_active_on_website, device_type\nfrom ((((((cte_gender a full outer join cte_age b on a.user_id = b.user_id) \nfull outer join cte_location c on c.user_id = coalesce(a.user_id, b.user_id))\nfull outer join cte_email_domain d on d.user_id = coalesce(a.user_id, b.user_id, c.user_id))\nfull outer join cte_is_member e on e.user_id = coalesce(a.user_id, b.user_id, c.user_id,d.user_id))\nfull outer join cte_has_mobile_app f on f.user_id = coalesce(a.user_id, b.user_id, c.user_id,d.user_id, e.user_id))\nfull outer join cte_is_active_on_website as g on g.user_id = coalesce(a.user_id, b.user_id, c.user_id,d.user_id, e.user_id, f.user_id))\nfull outer join cte_device_type as h on h.user_id = coalesce(a.user_id, b.user_id, c.user_id,d.user_id, e.user_id, f.user_id, g.user_id)\nlimit 500\n/* limit added automatically by dbt cloud */', 'tags': None}, None)
Traceback (most recent call last):
  File "/usr/local/lib/python3.8/dist-packages/dbt_rpc/task/sql_commands.py", line 147, in _in_thread
    self.node_results.append(runner.safe_run(self.manifest))
  File "/usr/local/lib/python3.8/dist-packages/dbt/task/base.py", line 377, in safe_run
    result = self.error_result(ctx.node, error, started, [])
  File "/usr/local/lib/python3.8/dist-packages/dbt_rpc/rpc/node_runners.py", line 56, in error_result
    raise error
dbt_rpc.rpc.error.RPCException: RPCException(10003, Database Error, {'type': 'DatabaseException', 'message': "Database Error in rpc request (from remote system)\n  001003 (42000): SQL compilation error:\n  syntax error line 1 at position 19 unexpected 'ANALYTICS_DB'.\n  syntax error line 1 at position 61 unexpected ','.\n  syntax error line 3 at position 11 unexpected 'ANALYTICS_DB'.\n  syntax error line 3 at position 50 unexpected ','.\n  syntax error line 5 at position 16 unexpected 'ANALYTICS_DB'.\n  syntax error line 5 at position 69 unexpected ','.\n  syntax error line 7 at position 20 unexpected 'ANALYTICS_DB'.\n  syntax error line 7 at position 68 unexpected ','.\n  syntax error line 9 at position 17 unexpected 'ANALYTICS_DB'.\n  syntax error line 9 at position 62 unexpected ','.\n  syntax error line 11 at position 22 unexpected 'ANALYTICS_DB'.\n  syntax error line 11 at position 72 unexpected ','.\n  syntax error line 13 at position 28 unexpected 'ANALYTICS_DB'.\n  syntax error line 13 at position 84 unexpected ','.\n  syntax error line 15 at position 19 unexpected 'ANALYTICS_DB'.\n  syntax error line 17 at position 16 unexpected 'a'.\n  syntax error line 18 at position 0 unexpected 'as'.", 'raw_sql': "with cte_gender as {{ ref('gender') }},\r\n\r\ncte_age as {{ ref('age') }},\r\n\r\ncte_location as {{ ref('country_and_state') }},\r\n\r\ncte_email_domain as {{ ref('email_domain') }},\r\n\r\ncte_is_member as {{ ref('is_member') }},\r\n\r\ncte_has_mobile_app as {{ ref('has_mobile_app') }},\r\n\r\ncte_is_active_on_website as {{ ref('is_active_on_website') }},\r\n\r\ncte_device_type as {{ ref('device_type') }}\r\n\r\nselect coalesce(a.user_id, b.user_id, c.user_id, d.user_id, e.user_id, f.user_id, g.user_id, h.user_id) \r\nas user_id, gender, c.country as country, c.state as state, email_domain, is_member, has_mobile_app, is_active_on_website, device_type\r\nfrom ((((((cte_gender a full outer join cte_age b on a.user_id = b.user_id) \r\nfull outer join cte_location c on c.user_id = coalesce(a.user_id, b.user_id))\r\nfull outer join cte_email_domain d on d.user_id = coalesce(a.user_id, b.user_id, c.user_id))\r\nfull outer join cte_is_member e on e.user_id = coalesce(a.user_id, b.user_id, c.user_id,d.user_id))\r\nfull outer join cte_has_mobile_app f on f.user_id = coalesce(a.user_id, b.user_id, c.user_id,d.user_id, e.user_id))\r\nfull outer join cte_is_active_on_website as g on g.user_id = coalesce(a.user_id, b.user_id, c.user_id,d.user_id, e.user_id, f.user_id))\r\nfull outer join cte_device_type as h on h.user_id = coalesce(a.user_id, b.user_id, c.user_id,d.user_id, e.user_id, f.user_id, g.user_id)\nlimit 500\n/* limit added automatically by dbt cloud */", 'compiled_sql': 'with cte_gender as ANALYTICS_DB.dbt_ecommerce_features.gender,\n\ncte_age as ANALYTICS_DB.dbt_ecommerce_features.age,\n\ncte_location as ANALYTICS_DB.dbt_ecommerce_features.country_and_state,\n\ncte_email_domain as ANALYTICS_DB.dbt_ecommerce_features.email_domain,\n\ncte_is_member as ANALYTICS_DB.dbt_ecommerce_features.is_member,\n\ncte_has_mobile_app as ANALYTICS_DB.dbt_ecommerce_features.has_mobile_app,\n\ncte_is_active_on_website as ANALYTICS_DB.dbt_ecommerce_features.is_active_on_website,\n\ncte_device_type as ANALYTICS_DB.dbt_ecommerce_features.device_type\n\nselect coalesce(a.user_id, b.user_id, c.user_id, d.user_id, e.user_id, f.user_id, g.user_id, h.user_id) \nas user_id, gender, c.country as country, c.state as state, email_domain, is_member, has_mobile_app, is_active_on_website, device_type\nfrom ((((((cte_gender a full outer join cte_age b on a.user_id = b.user_id) \nfull outer join cte_location c on c.user_id = coalesce(a.user_id, b.user_id))\nfull outer join cte_email_domain d on d.user_id = coalesce(a.user_id, b.user_id, c.user_id))\nfull outer join cte_is_member e on e.user_id = coalesce(a.user_id, b.user_id, c.user_id,d.user_id))\nfull outer join cte_has_mobile_app f on f.user_id = coalesce(a.user_id, b.user_id, c.user_id,d.user_id, e.user_id))\nfull outer join cte_is_active_on_website as g on g.user_id = coalesce(a.user_id, b.user_id, c.user_id,d.user_id, e.user_id, f.user_id))\nfull outer join cte_device_type as h on h.user_id = coalesce(a.user_id, b.user_id, c.user_id,d.user_id, e.user_id, f.user_id, g.user_id)\nlimit 500\n/* limit added automatically by dbt cloud */', 'tags': None}, None)
2022-07-07 08:54:56.643399 (Thread-62): handling poll request
2022-07-07 08:54:56.643815 (Thread-62): 08:54:56  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '8901092b-4e3c-4560-9d28-48dc5c91cc33', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9a204a2b80>]}
2022-07-07 08:54:56.644508 (Thread-62): sending response (<Response 27039 bytes [200 OK]>) to 10.0.19.15
2022-07-07 08:55:02.768685 (Thread-63): handling status request
2022-07-07 08:55:02.769142 (Thread-63): 08:55:02  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '8901092b-4e3c-4560-9d28-48dc5c91cc33', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9a204a2e20>]}
2022-07-07 08:55:02.770381 (Thread-63): sending response (<Response 25749 bytes [200 OK]>) to 10.0.19.15
2022-07-07 08:55:03.126658 (Thread-64): handling compile_sql request
2022-07-07 08:55:03.127065 (Thread-64): 08:55:03  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '8901092b-4e3c-4560-9d28-48dc5c91cc33', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9a204a1190>]}
2022-07-07 08:55:05.544315 (Thread-64): sending response (<Response 139 bytes [200 OK]>) to 10.0.19.15
2022-07-07 08:55:05.572671 (MainThread): 08:55:05  Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'a29821a8-bb97-47c4-a395-026b9894e329', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9fcc67e520>]}
2022-07-07 08:55:05.573355 (MainThread): 08:55:05  Found 17 models, 0 tests, 0 snapshots, 0 analyses, 181 macros, 0 operations, 0 seed files, 15 sources, 0 exposures, 0 metrics
2022-07-07 08:55:05.574015 (Thread-1): 08:55:05  Acquiring new snowflake connection "rpc.ecommerce_data_model_dbt.request"
2022-07-07 08:55:05.574150 (Thread-1): 08:55:05  Began compiling node rpc.ecommerce_data_model_dbt.request
2022-07-07 08:55:05.574244 (Thread-1): 08:55:05  Compiling rpc.ecommerce_data_model_dbt.request
2022-07-07 08:55:05.578229 (Thread-1): 08:55:05  finished collecting timing info
2022-07-07 08:55:05.578382 (Thread-1): 08:55:05  Began executing node rpc.ecommerce_data_model_dbt.request
2022-07-07 08:55:05.578489 (Thread-1): 08:55:05  finished collecting timing info
2022-07-07 08:55:05.912573 (Thread-65): handling poll request
2022-07-07 08:55:05.913094 (Thread-65): 08:55:05  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '8901092b-4e3c-4560-9d28-48dc5c91cc33', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9a204ad2e0>]}
2022-07-07 08:55:05.914254 (Thread-65): sending response (<Response 11640 bytes [200 OK]>) to 10.0.19.15
2022-07-07 08:55:47.280046 (Thread-66): handling status request
2022-07-07 08:55:47.280452 (Thread-66): 08:55:47  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '8901092b-4e3c-4560-9d28-48dc5c91cc33', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9a204ad4c0>]}
2022-07-07 08:55:47.281818 (Thread-66): sending response (<Response 25749 bytes [200 OK]>) to 10.0.19.15
2022-07-07 08:55:47.666925 (Thread-67): handling run_sql request
2022-07-07 08:55:47.667339 (Thread-67): 08:55:47  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '8901092b-4e3c-4560-9d28-48dc5c91cc33', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9a204ad580>]}
2022-07-07 08:55:50.024018 (Thread-67): sending response (<Response 139 bytes [200 OK]>) to 10.0.19.15
2022-07-07 08:55:50.051741 (MainThread): 08:55:50  Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '34c84ed7-6284-4d59-bb38-c9c5bcee5f73', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f008bf1dd90>]}
2022-07-07 08:55:50.052319 (MainThread): 08:55:50  Found 17 models, 0 tests, 0 snapshots, 0 analyses, 181 macros, 0 operations, 0 seed files, 15 sources, 0 exposures, 0 metrics
2022-07-07 08:55:50.052953 (Thread-1): 08:55:50  Acquiring new snowflake connection "rpc.ecommerce_data_model_dbt.request"
2022-07-07 08:55:50.053085 (Thread-1): 08:55:50  Began compiling node rpc.ecommerce_data_model_dbt.request
2022-07-07 08:55:50.053182 (Thread-1): 08:55:50  Compiling rpc.ecommerce_data_model_dbt.request
2022-07-07 08:55:50.056739 (Thread-1): 08:55:50  finished collecting timing info
2022-07-07 08:55:50.056906 (Thread-1): 08:55:50  Began executing node rpc.ecommerce_data_model_dbt.request
2022-07-07 08:55:50.059299 (Thread-1): 08:55:50  Using snowflake connection "rpc.ecommerce_data_model_dbt.request"
2022-07-07 08:55:50.059399 (Thread-1): 08:55:50  On rpc.ecommerce_data_model_dbt.request: with cte_gender as ANALYTICS_DB.dbt_ecommerce_features.gender,

cte_age as ANALYTICS_DB.dbt_ecommerce_features.age,

cte_location as ANALYTICS_DB.dbt_ecommerce_features.country_and_state,

cte_email_domain as ANALYTICS_DB.dbt_ecommerce_features.email_domain,

cte_is_member as ANALYTICS_DB.dbt_ecommerce_features.is_member,

cte_has_mobile_app as ANALYTICS_DB.dbt_ecommerce_features.has_mobile_app,

cte_is_active_on_website as ANALYTICS_DB.dbt_ecommerce_features.is_active_on_website,

cte_device_type as ANALYTICS_DB.dbt_ecommerce_features.device_type

select coalesce(a.user_id, b.user_id, c.user_id, d.user_id, e.user_id, f.user_id, g.user_id, h.user_id) 
as user_id, gender, c.country as country, c.state as state, email_domain, is_member, has_mobile_app, is_active_on_website, device_type
from ((((((cte_gender a full outer join cte_age b on a.user_id = b.user_id) 
full outer join cte_location c on c.user_id = coalesce(a.user_id, b.user_id))
full outer join cte_email_domain d on d.user_id = coalesce(a.user_id, b.user_id, c.user_id))
full outer join cte_is_member e on e.user_id = coalesce(a.user_id, b.user_id, c.user_id,d.user_id))
full outer join cte_has_mobile_app f on f.user_id = coalesce(a.user_id, b.user_id, c.user_id,d.user_id, e.user_id))
full outer join cte_is_active_on_website as g on g.user_id = coalesce(a.user_id, b.user_id, c.user_id,d.user_id, e.user_id, f.user_id))
full outer join cte_device_type as h on h.user_id = coalesce(a.user_id, b.user_id, c.user_id,d.user_id, e.user_id, f.user_id, g.user_id)
limit 500
/* limit added automatically by dbt cloud */
2022-07-07 08:55:50.059484 (Thread-1): 08:55:50  Opening a new connection, currently in state init
2022-07-07 08:55:50.405241 (Thread-68): handling poll request
2022-07-07 08:55:50.405699 (Thread-68): 08:55:50  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '8901092b-4e3c-4560-9d28-48dc5c91cc33', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9a204a20d0>]}
2022-07-07 08:55:50.406541 (Thread-68): sending response (<Response 5341 bytes [200 OK]>) to 10.0.19.15
2022-07-07 08:55:50.779982 (Thread-1): 08:55:50  Snowflake adapter: Snowflake query id: 01a57197-0602-33c1-0019-8203046b69c6
2022-07-07 08:55:50.780196 (Thread-1): 08:55:50  Snowflake adapter: Snowflake error: 001003 (42000): SQL compilation error:
syntax error line 1 at position 19 unexpected 'ANALYTICS_DB'.
syntax error line 1 at position 61 unexpected ','.
syntax error line 3 at position 11 unexpected 'ANALYTICS_DB'.
syntax error line 3 at position 50 unexpected ','.
syntax error line 5 at position 16 unexpected 'ANALYTICS_DB'.
syntax error line 5 at position 69 unexpected ','.
syntax error line 7 at position 20 unexpected 'ANALYTICS_DB'.
syntax error line 7 at position 68 unexpected ','.
syntax error line 9 at position 17 unexpected 'ANALYTICS_DB'.
syntax error line 9 at position 62 unexpected ','.
syntax error line 11 at position 22 unexpected 'ANALYTICS_DB'.
syntax error line 11 at position 72 unexpected ','.
syntax error line 13 at position 28 unexpected 'ANALYTICS_DB'.
syntax error line 13 at position 84 unexpected ','.
syntax error line 15 at position 19 unexpected 'ANALYTICS_DB'.
syntax error line 17 at position 16 unexpected 'a'.
syntax error line 18 at position 0 unexpected 'as'.
2022-07-07 08:55:50.780365 (Thread-1): 08:55:50  finished collecting timing info
2022-07-07 08:55:50.780526 (Thread-1): 08:55:50  On rpc.ecommerce_data_model_dbt.request: Close
2022-07-07 08:55:50.879404 (Thread-1): Got an exception: Database Error
  001003 (42000): SQL compilation error:
  syntax error line 1 at position 19 unexpected 'ANALYTICS_DB'.
  syntax error line 1 at position 61 unexpected ','.
  syntax error line 3 at position 11 unexpected 'ANALYTICS_DB'.
  syntax error line 3 at position 50 unexpected ','.
  syntax error line 5 at position 16 unexpected 'ANALYTICS_DB'.
  syntax error line 5 at position 69 unexpected ','.
  syntax error line 7 at position 20 unexpected 'ANALYTICS_DB'.
  syntax error line 7 at position 68 unexpected ','.
  syntax error line 9 at position 17 unexpected 'ANALYTICS_DB'.
  syntax error line 9 at position 62 unexpected ','.
  syntax error line 11 at position 22 unexpected 'ANALYTICS_DB'.
  syntax error line 11 at position 72 unexpected ','.
  syntax error line 13 at position 28 unexpected 'ANALYTICS_DB'.
  syntax error line 13 at position 84 unexpected ','.
  syntax error line 15 at position 19 unexpected 'ANALYTICS_DB'.
  syntax error line 17 at position 16 unexpected 'a'.
  syntax error line 18 at position 0 unexpected 'as'.
Traceback (most recent call last):
  File "/usr/local/lib/python3.8/dist-packages/dbt/adapters/snowflake/connections.py", line 206, in exception_handler
    yield
  File "/usr/local/lib/python3.8/dist-packages/dbt/adapters/sql/connections.py", line 74, in add_query
    cursor.execute(sql, bindings)
  File "/usr/local/lib/python3.8/dist-packages/snowflake/connector/cursor.py", line 721, in execute
    Error.errorhandler_wrapper(
  File "/usr/local/lib/python3.8/dist-packages/snowflake/connector/errors.py", line 258, in errorhandler_wrapper
    cursor.errorhandler(connection, cursor, error_class, error_value)
  File "/usr/local/lib/python3.8/dist-packages/snowflake/connector/errors.py", line 188, in default_errorhandler
    raise error_class(
snowflake.connector.errors.ProgrammingError: 001003 (42000): SQL compilation error:
syntax error line 1 at position 19 unexpected 'ANALYTICS_DB'.
syntax error line 1 at position 61 unexpected ','.
syntax error line 3 at position 11 unexpected 'ANALYTICS_DB'.
syntax error line 3 at position 50 unexpected ','.
syntax error line 5 at position 16 unexpected 'ANALYTICS_DB'.
syntax error line 5 at position 69 unexpected ','.
syntax error line 7 at position 20 unexpected 'ANALYTICS_DB'.
syntax error line 7 at position 68 unexpected ','.
syntax error line 9 at position 17 unexpected 'ANALYTICS_DB'.
syntax error line 9 at position 62 unexpected ','.
syntax error line 11 at position 22 unexpected 'ANALYTICS_DB'.
syntax error line 11 at position 72 unexpected ','.
syntax error line 13 at position 28 unexpected 'ANALYTICS_DB'.
syntax error line 13 at position 84 unexpected ','.
syntax error line 15 at position 19 unexpected 'ANALYTICS_DB'.
syntax error line 17 at position 16 unexpected 'a'.
syntax error line 18 at position 0 unexpected 'as'.

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/usr/local/lib/python3.8/dist-packages/dbt/task/base.py", line 361, in safe_run
    result = self.compile_and_execute(manifest, ctx)
  File "/usr/local/lib/python3.8/dist-packages/dbt/task/base.py", line 314, in compile_and_execute
    result = self.run(ctx.node, manifest)
  File "/usr/local/lib/python3.8/dist-packages/dbt/task/base.py", line 403, in run
    return self.execute(compiled_node, manifest)
  File "/usr/local/lib/python3.8/dist-packages/dbt_rpc/rpc/node_runners.py", line 90, in execute
    _, execute_result = self.adapter.execute(
  File "/usr/local/lib/python3.8/dist-packages/dbt/adapters/base/impl.py", line 225, in execute
    return self.connections.execute(
  File "/usr/local/lib/python3.8/dist-packages/dbt/adapters/sql/connections.py", line 127, in execute
    _, cursor = self.add_query(sql, auto_begin)
  File "/usr/local/lib/python3.8/dist-packages/dbt/adapters/snowflake/connections.py", line 433, in add_query
    connection, cursor = super().add_query(
  File "/usr/local/lib/python3.8/dist-packages/dbt/adapters/sql/connections.py", line 83, in add_query
    return connection, cursor
  File "/usr/lib/python3.8/contextlib.py", line 131, in __exit__
    self.gen.throw(type, value, traceback)
  File "/usr/local/lib/python3.8/dist-packages/dbt/adapters/snowflake/connections.py", line 223, in exception_handler
    raise DatabaseException(msg)
dbt.exceptions.DatabaseException: Database Error
  001003 (42000): SQL compilation error:
  syntax error line 1 at position 19 unexpected 'ANALYTICS_DB'.
  syntax error line 1 at position 61 unexpected ','.
  syntax error line 3 at position 11 unexpected 'ANALYTICS_DB'.
  syntax error line 3 at position 50 unexpected ','.
  syntax error line 5 at position 16 unexpected 'ANALYTICS_DB'.
  syntax error line 5 at position 69 unexpected ','.
  syntax error line 7 at position 20 unexpected 'ANALYTICS_DB'.
  syntax error line 7 at position 68 unexpected ','.
  syntax error line 9 at position 17 unexpected 'ANALYTICS_DB'.
  syntax error line 9 at position 62 unexpected ','.
  syntax error line 11 at position 22 unexpected 'ANALYTICS_DB'.
  syntax error line 11 at position 72 unexpected ','.
  syntax error line 13 at position 28 unexpected 'ANALYTICS_DB'.
  syntax error line 13 at position 84 unexpected ','.
  syntax error line 15 at position 19 unexpected 'ANALYTICS_DB'.
  syntax error line 17 at position 16 unexpected 'a'.
  syntax error line 18 at position 0 unexpected 'as'.
2022-07-07 08:55:50.880206 (Thread-1): Got exception RPCException(10003, Database Error, {'type': 'DatabaseException', 'message': "Database Error in rpc request (from remote system)\n  001003 (42000): SQL compilation error:\n  syntax error line 1 at position 19 unexpected 'ANALYTICS_DB'.\n  syntax error line 1 at position 61 unexpected ','.\n  syntax error line 3 at position 11 unexpected 'ANALYTICS_DB'.\n  syntax error line 3 at position 50 unexpected ','.\n  syntax error line 5 at position 16 unexpected 'ANALYTICS_DB'.\n  syntax error line 5 at position 69 unexpected ','.\n  syntax error line 7 at position 20 unexpected 'ANALYTICS_DB'.\n  syntax error line 7 at position 68 unexpected ','.\n  syntax error line 9 at position 17 unexpected 'ANALYTICS_DB'.\n  syntax error line 9 at position 62 unexpected ','.\n  syntax error line 11 at position 22 unexpected 'ANALYTICS_DB'.\n  syntax error line 11 at position 72 unexpected ','.\n  syntax error line 13 at position 28 unexpected 'ANALYTICS_DB'.\n  syntax error line 13 at position 84 unexpected ','.\n  syntax error line 15 at position 19 unexpected 'ANALYTICS_DB'.\n  syntax error line 17 at position 16 unexpected 'a'.\n  syntax error line 18 at position 0 unexpected 'as'.", 'raw_sql': "with cte_gender as {{ ref('gender') }},\r\n\r\ncte_age as {{ ref('age') }},\r\n\r\ncte_location as {{ ref('country_and_state') }},\r\n\r\ncte_email_domain as {{ ref('email_domain') }},\r\n\r\ncte_is_member as {{ ref('is_member') }},\r\n\r\ncte_has_mobile_app as {{ ref('has_mobile_app') }},\r\n\r\ncte_is_active_on_website as {{ ref('is_active_on_website') }},\r\n\r\ncte_device_type as {{ ref('device_type') }}\r\n\r\nselect coalesce(a.user_id, b.user_id, c.user_id, d.user_id, e.user_id, f.user_id, g.user_id, h.user_id) \r\nas user_id, gender, c.country as country, c.state as state, email_domain, is_member, has_mobile_app, is_active_on_website, device_type\r\nfrom ((((((cte_gender a full outer join cte_age b on a.user_id = b.user_id) \r\nfull outer join cte_location c on c.user_id = coalesce(a.user_id, b.user_id))\r\nfull outer join cte_email_domain d on d.user_id = coalesce(a.user_id, b.user_id, c.user_id))\r\nfull outer join cte_is_member e on e.user_id = coalesce(a.user_id, b.user_id, c.user_id,d.user_id))\r\nfull outer join cte_has_mobile_app f on f.user_id = coalesce(a.user_id, b.user_id, c.user_id,d.user_id, e.user_id))\r\nfull outer join cte_is_active_on_website as g on g.user_id = coalesce(a.user_id, b.user_id, c.user_id,d.user_id, e.user_id, f.user_id))\r\nfull outer join cte_device_type as h on h.user_id = coalesce(a.user_id, b.user_id, c.user_id,d.user_id, e.user_id, f.user_id, g.user_id)\nlimit 500\n/* limit added automatically by dbt cloud */", 'compiled_sql': 'with cte_gender as ANALYTICS_DB.dbt_ecommerce_features.gender,\n\ncte_age as ANALYTICS_DB.dbt_ecommerce_features.age,\n\ncte_location as ANALYTICS_DB.dbt_ecommerce_features.country_and_state,\n\ncte_email_domain as ANALYTICS_DB.dbt_ecommerce_features.email_domain,\n\ncte_is_member as ANALYTICS_DB.dbt_ecommerce_features.is_member,\n\ncte_has_mobile_app as ANALYTICS_DB.dbt_ecommerce_features.has_mobile_app,\n\ncte_is_active_on_website as ANALYTICS_DB.dbt_ecommerce_features.is_active_on_website,\n\ncte_device_type as ANALYTICS_DB.dbt_ecommerce_features.device_type\n\nselect coalesce(a.user_id, b.user_id, c.user_id, d.user_id, e.user_id, f.user_id, g.user_id, h.user_id) \nas user_id, gender, c.country as country, c.state as state, email_domain, is_member, has_mobile_app, is_active_on_website, device_type\nfrom ((((((cte_gender a full outer join cte_age b on a.user_id = b.user_id) \nfull outer join cte_location c on c.user_id = coalesce(a.user_id, b.user_id))\nfull outer join cte_email_domain d on d.user_id = coalesce(a.user_id, b.user_id, c.user_id))\nfull outer join cte_is_member e on e.user_id = coalesce(a.user_id, b.user_id, c.user_id,d.user_id))\nfull outer join cte_has_mobile_app f on f.user_id = coalesce(a.user_id, b.user_id, c.user_id,d.user_id, e.user_id))\nfull outer join cte_is_active_on_website as g on g.user_id = coalesce(a.user_id, b.user_id, c.user_id,d.user_id, e.user_id, f.user_id))\nfull outer join cte_device_type as h on h.user_id = coalesce(a.user_id, b.user_id, c.user_id,d.user_id, e.user_id, f.user_id, g.user_id)\nlimit 500\n/* limit added automatically by dbt cloud */', 'tags': None}, None)
Traceback (most recent call last):
  File "/usr/local/lib/python3.8/dist-packages/dbt_rpc/task/sql_commands.py", line 147, in _in_thread
    self.node_results.append(runner.safe_run(self.manifest))
  File "/usr/local/lib/python3.8/dist-packages/dbt/task/base.py", line 377, in safe_run
    result = self.error_result(ctx.node, error, started, [])
  File "/usr/local/lib/python3.8/dist-packages/dbt_rpc/rpc/node_runners.py", line 56, in error_result
    raise error
dbt_rpc.rpc.error.RPCException: RPCException(10003, Database Error, {'type': 'DatabaseException', 'message': "Database Error in rpc request (from remote system)\n  001003 (42000): SQL compilation error:\n  syntax error line 1 at position 19 unexpected 'ANALYTICS_DB'.\n  syntax error line 1 at position 61 unexpected ','.\n  syntax error line 3 at position 11 unexpected 'ANALYTICS_DB'.\n  syntax error line 3 at position 50 unexpected ','.\n  syntax error line 5 at position 16 unexpected 'ANALYTICS_DB'.\n  syntax error line 5 at position 69 unexpected ','.\n  syntax error line 7 at position 20 unexpected 'ANALYTICS_DB'.\n  syntax error line 7 at position 68 unexpected ','.\n  syntax error line 9 at position 17 unexpected 'ANALYTICS_DB'.\n  syntax error line 9 at position 62 unexpected ','.\n  syntax error line 11 at position 22 unexpected 'ANALYTICS_DB'.\n  syntax error line 11 at position 72 unexpected ','.\n  syntax error line 13 at position 28 unexpected 'ANALYTICS_DB'.\n  syntax error line 13 at position 84 unexpected ','.\n  syntax error line 15 at position 19 unexpected 'ANALYTICS_DB'.\n  syntax error line 17 at position 16 unexpected 'a'.\n  syntax error line 18 at position 0 unexpected 'as'.", 'raw_sql': "with cte_gender as {{ ref('gender') }},\r\n\r\ncte_age as {{ ref('age') }},\r\n\r\ncte_location as {{ ref('country_and_state') }},\r\n\r\ncte_email_domain as {{ ref('email_domain') }},\r\n\r\ncte_is_member as {{ ref('is_member') }},\r\n\r\ncte_has_mobile_app as {{ ref('has_mobile_app') }},\r\n\r\ncte_is_active_on_website as {{ ref('is_active_on_website') }},\r\n\r\ncte_device_type as {{ ref('device_type') }}\r\n\r\nselect coalesce(a.user_id, b.user_id, c.user_id, d.user_id, e.user_id, f.user_id, g.user_id, h.user_id) \r\nas user_id, gender, c.country as country, c.state as state, email_domain, is_member, has_mobile_app, is_active_on_website, device_type\r\nfrom ((((((cte_gender a full outer join cte_age b on a.user_id = b.user_id) \r\nfull outer join cte_location c on c.user_id = coalesce(a.user_id, b.user_id))\r\nfull outer join cte_email_domain d on d.user_id = coalesce(a.user_id, b.user_id, c.user_id))\r\nfull outer join cte_is_member e on e.user_id = coalesce(a.user_id, b.user_id, c.user_id,d.user_id))\r\nfull outer join cte_has_mobile_app f on f.user_id = coalesce(a.user_id, b.user_id, c.user_id,d.user_id, e.user_id))\r\nfull outer join cte_is_active_on_website as g on g.user_id = coalesce(a.user_id, b.user_id, c.user_id,d.user_id, e.user_id, f.user_id))\r\nfull outer join cte_device_type as h on h.user_id = coalesce(a.user_id, b.user_id, c.user_id,d.user_id, e.user_id, f.user_id, g.user_id)\nlimit 500\n/* limit added automatically by dbt cloud */", 'compiled_sql': 'with cte_gender as ANALYTICS_DB.dbt_ecommerce_features.gender,\n\ncte_age as ANALYTICS_DB.dbt_ecommerce_features.age,\n\ncte_location as ANALYTICS_DB.dbt_ecommerce_features.country_and_state,\n\ncte_email_domain as ANALYTICS_DB.dbt_ecommerce_features.email_domain,\n\ncte_is_member as ANALYTICS_DB.dbt_ecommerce_features.is_member,\n\ncte_has_mobile_app as ANALYTICS_DB.dbt_ecommerce_features.has_mobile_app,\n\ncte_is_active_on_website as ANALYTICS_DB.dbt_ecommerce_features.is_active_on_website,\n\ncte_device_type as ANALYTICS_DB.dbt_ecommerce_features.device_type\n\nselect coalesce(a.user_id, b.user_id, c.user_id, d.user_id, e.user_id, f.user_id, g.user_id, h.user_id) \nas user_id, gender, c.country as country, c.state as state, email_domain, is_member, has_mobile_app, is_active_on_website, device_type\nfrom ((((((cte_gender a full outer join cte_age b on a.user_id = b.user_id) \nfull outer join cte_location c on c.user_id = coalesce(a.user_id, b.user_id))\nfull outer join cte_email_domain d on d.user_id = coalesce(a.user_id, b.user_id, c.user_id))\nfull outer join cte_is_member e on e.user_id = coalesce(a.user_id, b.user_id, c.user_id,d.user_id))\nfull outer join cte_has_mobile_app f on f.user_id = coalesce(a.user_id, b.user_id, c.user_id,d.user_id, e.user_id))\nfull outer join cte_is_active_on_website as g on g.user_id = coalesce(a.user_id, b.user_id, c.user_id,d.user_id, e.user_id, f.user_id))\nfull outer join cte_device_type as h on h.user_id = coalesce(a.user_id, b.user_id, c.user_id,d.user_id, e.user_id, f.user_id, g.user_id)\nlimit 500\n/* limit added automatically by dbt cloud */', 'tags': None}, None)
2022-07-07 08:55:51.760101 (Thread-69): handling poll request
2022-07-07 08:55:51.760533 (Thread-69): 08:55:51  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '8901092b-4e3c-4560-9d28-48dc5c91cc33', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9a204a2d90>]}
2022-07-07 08:55:51.761228 (Thread-69): sending response (<Response 27039 bytes [200 OK]>) to 10.0.19.15
2022-07-07 08:56:44.354973 (Thread-70): handling status request
2022-07-07 08:56:44.356730 (Thread-70): 08:56:44  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '8901092b-4e3c-4560-9d28-48dc5c91cc33', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9a2042f820>]}
2022-07-07 08:56:44.357993 (Thread-70): sending response (<Response 25749 bytes [200 OK]>) to 10.0.19.15
2022-07-07 08:56:44.741791 (Thread-71): handling compile_sql request
2022-07-07 08:56:44.742199 (Thread-71): 08:56:44  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '8901092b-4e3c-4560-9d28-48dc5c91cc33', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9a2042fa00>]}
2022-07-07 08:56:47.107532 (Thread-71): sending response (<Response 139 bytes [200 OK]>) to 10.0.19.15
2022-07-07 08:56:47.134315 (MainThread): 08:56:47  Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '523eac4c-d9e5-461a-9cb4-2ef90cfc45f6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7f1a2ef4c0>]}
2022-07-07 08:56:47.134866 (MainThread): 08:56:47  Found 17 models, 0 tests, 0 snapshots, 0 analyses, 181 macros, 0 operations, 0 seed files, 15 sources, 0 exposures, 0 metrics
2022-07-07 08:56:47.135461 (Thread-1): 08:56:47  Acquiring new snowflake connection "rpc.ecommerce_data_model_dbt.request"
2022-07-07 08:56:47.135595 (Thread-1): 08:56:47  Began compiling node rpc.ecommerce_data_model_dbt.request
2022-07-07 08:56:47.135687 (Thread-1): 08:56:47  Compiling rpc.ecommerce_data_model_dbt.request
2022-07-07 08:56:47.139323 (Thread-1): 08:56:47  finished collecting timing info
2022-07-07 08:56:47.139454 (Thread-1): 08:56:47  Began executing node rpc.ecommerce_data_model_dbt.request
2022-07-07 08:56:47.139553 (Thread-1): 08:56:47  finished collecting timing info
2022-07-07 08:56:47.470114 (Thread-72): handling poll request
2022-07-07 08:56:47.470584 (Thread-72): 08:56:47  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '8901092b-4e3c-4560-9d28-48dc5c91cc33', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9a20437b50>]}
2022-07-07 08:56:47.471717 (Thread-72): sending response (<Response 11641 bytes [200 OK]>) to 10.0.19.15
2022-07-07 08:57:06.646507 (Thread-73): handling status request
2022-07-07 08:57:06.646960 (Thread-73): 08:57:06  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '8901092b-4e3c-4560-9d28-48dc5c91cc33', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9a20437c70>]}
2022-07-07 08:57:06.648277 (Thread-73): sending response (<Response 25749 bytes [200 OK]>) to 10.0.19.15
2022-07-07 08:57:07.009392 (Thread-74): handling compile_sql request
2022-07-07 08:57:07.009799 (Thread-74): 08:57:07  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '8901092b-4e3c-4560-9d28-48dc5c91cc33', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9a20437df0>]}
2022-07-07 08:57:09.347618 (Thread-74): sending response (<Response 139 bytes [200 OK]>) to 10.0.19.15
2022-07-07 08:57:09.372927 (MainThread): 08:57:09  Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'dbfb3ca1-8d1e-466b-a5a3-f5fc39d993e9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdb48d9d0a0>]}
2022-07-07 08:57:09.373480 (MainThread): 08:57:09  Found 17 models, 0 tests, 0 snapshots, 0 analyses, 181 macros, 0 operations, 0 seed files, 15 sources, 0 exposures, 0 metrics
2022-07-07 08:57:09.374075 (Thread-1): 08:57:09  Acquiring new snowflake connection "rpc.ecommerce_data_model_dbt.request"
2022-07-07 08:57:09.374207 (Thread-1): 08:57:09  Began compiling node rpc.ecommerce_data_model_dbt.request
2022-07-07 08:57:09.374307 (Thread-1): 08:57:09  Compiling rpc.ecommerce_data_model_dbt.request
2022-07-07 08:57:09.376563 (Thread-1): 08:57:09  finished collecting timing info
2022-07-07 08:57:09.376696 (Thread-1): 08:57:09  Began executing node rpc.ecommerce_data_model_dbt.request
2022-07-07 08:57:09.376794 (Thread-1): 08:57:09  finished collecting timing info
2022-07-07 08:57:09.710312 (Thread-75): handling poll request
2022-07-07 08:57:09.710837 (Thread-75): 08:57:09  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '8901092b-4e3c-4560-9d28-48dc5c91cc33', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9a20445970>]}
2022-07-07 08:57:09.711912 (Thread-75): sending response (<Response 6025 bytes [200 OK]>) to 10.0.19.15
2022-07-07 08:57:24.626678 (Thread-76): handling status request
2022-07-07 08:57:24.627075 (Thread-76): 08:57:24  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '8901092b-4e3c-4560-9d28-48dc5c91cc33', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9a20452220>]}
2022-07-07 08:57:24.628607 (Thread-76): sending response (<Response 25749 bytes [200 OK]>) to 10.0.19.15
2022-07-07 08:57:24.986723 (Thread-77): handling run_sql request
2022-07-07 08:57:24.987112 (Thread-77): 08:57:24  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '8901092b-4e3c-4560-9d28-48dc5c91cc33', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9a20437970>]}
2022-07-07 08:57:27.337888 (Thread-77): sending response (<Response 139 bytes [200 OK]>) to 10.0.19.15
2022-07-07 08:57:27.362618 (MainThread): 08:57:27  Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'c02c1d58-b693-4e2f-9299-1e3431d5ece5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa383de00a0>]}
2022-07-07 08:57:27.363195 (MainThread): 08:57:27  Found 17 models, 0 tests, 0 snapshots, 0 analyses, 181 macros, 0 operations, 0 seed files, 15 sources, 0 exposures, 0 metrics
2022-07-07 08:57:27.363793 (Thread-1): 08:57:27  Acquiring new snowflake connection "rpc.ecommerce_data_model_dbt.request"
2022-07-07 08:57:27.363927 (Thread-1): 08:57:27  Began compiling node rpc.ecommerce_data_model_dbt.request
2022-07-07 08:57:27.364038 (Thread-1): 08:57:27  Compiling rpc.ecommerce_data_model_dbt.request
2022-07-07 08:57:27.366500 (Thread-1): 08:57:27  finished collecting timing info
2022-07-07 08:57:27.366692 (Thread-1): 08:57:27  Began executing node rpc.ecommerce_data_model_dbt.request
2022-07-07 08:57:27.367282 (Thread-1): 08:57:27  Using snowflake connection "rpc.ecommerce_data_model_dbt.request"
2022-07-07 08:57:27.367374 (Thread-1): 08:57:27  On rpc.ecommerce_data_model_dbt.request: -- unique_key=['TIMESTAMP', 'user_id']
-- ToDo: unique key should be user_id, timestamp
select * from ANALYTICS_DB.dbt_ecommerce_features.stg_products_viewed
limit 500
/* limit added automatically by dbt cloud */
2022-07-07 08:57:27.367467 (Thread-1): 08:57:27  Opening a new connection, currently in state init
2022-07-07 08:57:27.728545 (Thread-78): handling poll request
2022-07-07 08:57:27.729047 (Thread-78): 08:57:27  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '8901092b-4e3c-4560-9d28-48dc5c91cc33', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9a20452d60>]}
2022-07-07 08:57:27.729895 (Thread-78): sending response (<Response 3944 bytes [200 OK]>) to 10.0.19.15
2022-07-07 08:57:28.111819 (Thread-1): 08:57:28  Snowflake adapter: Snowflake query id: 01a57199-0602-3374-0019-8203046b593e
2022-07-07 08:57:28.112026 (Thread-1): 08:57:28  Snowflake adapter: Snowflake error: 002003 (02000): SQL compilation error:
Schema 'ANALYTICS_DB.DBT_ECOMMERCE_FEATURES' does not exist or not authorized.
2022-07-07 08:57:28.112188 (Thread-1): 08:57:28  finished collecting timing info
2022-07-07 08:57:28.112357 (Thread-1): 08:57:28  On rpc.ecommerce_data_model_dbt.request: Close
2022-07-07 08:57:28.181446 (Thread-1): Got an exception: Database Error
  002003 (02000): SQL compilation error:
  Schema 'ANALYTICS_DB.DBT_ECOMMERCE_FEATURES' does not exist or not authorized.
Traceback (most recent call last):
  File "/usr/local/lib/python3.8/dist-packages/dbt/adapters/snowflake/connections.py", line 206, in exception_handler
    yield
  File "/usr/local/lib/python3.8/dist-packages/dbt/adapters/sql/connections.py", line 74, in add_query
    cursor.execute(sql, bindings)
  File "/usr/local/lib/python3.8/dist-packages/snowflake/connector/cursor.py", line 721, in execute
    Error.errorhandler_wrapper(
  File "/usr/local/lib/python3.8/dist-packages/snowflake/connector/errors.py", line 258, in errorhandler_wrapper
    cursor.errorhandler(connection, cursor, error_class, error_value)
  File "/usr/local/lib/python3.8/dist-packages/snowflake/connector/errors.py", line 188, in default_errorhandler
    raise error_class(
snowflake.connector.errors.ProgrammingError: 002003 (02000): SQL compilation error:
Schema 'ANALYTICS_DB.DBT_ECOMMERCE_FEATURES' does not exist or not authorized.

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/usr/local/lib/python3.8/dist-packages/dbt/task/base.py", line 361, in safe_run
    result = self.compile_and_execute(manifest, ctx)
  File "/usr/local/lib/python3.8/dist-packages/dbt/task/base.py", line 314, in compile_and_execute
    result = self.run(ctx.node, manifest)
  File "/usr/local/lib/python3.8/dist-packages/dbt/task/base.py", line 403, in run
    return self.execute(compiled_node, manifest)
  File "/usr/local/lib/python3.8/dist-packages/dbt_rpc/rpc/node_runners.py", line 90, in execute
    _, execute_result = self.adapter.execute(
  File "/usr/local/lib/python3.8/dist-packages/dbt/adapters/base/impl.py", line 225, in execute
    return self.connections.execute(
  File "/usr/local/lib/python3.8/dist-packages/dbt/adapters/sql/connections.py", line 127, in execute
    _, cursor = self.add_query(sql, auto_begin)
  File "/usr/local/lib/python3.8/dist-packages/dbt/adapters/snowflake/connections.py", line 433, in add_query
    connection, cursor = super().add_query(
  File "/usr/local/lib/python3.8/dist-packages/dbt/adapters/sql/connections.py", line 83, in add_query
    return connection, cursor
  File "/usr/lib/python3.8/contextlib.py", line 131, in __exit__
    self.gen.throw(type, value, traceback)
  File "/usr/local/lib/python3.8/dist-packages/dbt/adapters/snowflake/connections.py", line 223, in exception_handler
    raise DatabaseException(msg)
dbt.exceptions.DatabaseException: Database Error
  002003 (02000): SQL compilation error:
  Schema 'ANALYTICS_DB.DBT_ECOMMERCE_FEATURES' does not exist or not authorized.
2022-07-07 08:57:28.182426 (Thread-1): Got exception RPCException(10003, Database Error, {'type': 'DatabaseException', 'message': "Database Error in rpc request (from remote system)\n  002003 (02000): SQL compilation error:\n  Schema 'ANALYTICS_DB.DBT_ECOMMERCE_FEATURES' does not exist or not authorized.", 'raw_sql': "{{\n    config(\n        materialized='incremental'\n    )\n}}\n\n-- unique_key=['TIMESTAMP', 'user_id']\n-- ToDo: unique key should be user_id, timestamp\nselect * from {{ ref('stg_products_viewed') }}\nlimit 500\n/* limit added automatically by dbt cloud */", 'compiled_sql': "\n\n-- unique_key=['TIMESTAMP', 'user_id']\n-- ToDo: unique key should be user_id, timestamp\nselect * from ANALYTICS_DB.dbt_ecommerce_features.stg_products_viewed\nlimit 500\n/* limit added automatically by dbt cloud */", 'tags': None}, None)
Traceback (most recent call last):
  File "/usr/local/lib/python3.8/dist-packages/dbt_rpc/task/sql_commands.py", line 147, in _in_thread
    self.node_results.append(runner.safe_run(self.manifest))
  File "/usr/local/lib/python3.8/dist-packages/dbt/task/base.py", line 377, in safe_run
    result = self.error_result(ctx.node, error, started, [])
  File "/usr/local/lib/python3.8/dist-packages/dbt_rpc/rpc/node_runners.py", line 56, in error_result
    raise error
dbt_rpc.rpc.error.RPCException: RPCException(10003, Database Error, {'type': 'DatabaseException', 'message': "Database Error in rpc request (from remote system)\n  002003 (02000): SQL compilation error:\n  Schema 'ANALYTICS_DB.DBT_ECOMMERCE_FEATURES' does not exist or not authorized.", 'raw_sql': "{{\n    config(\n        materialized='incremental'\n    )\n}}\n\n-- unique_key=['TIMESTAMP', 'user_id']\n-- ToDo: unique key should be user_id, timestamp\nselect * from {{ ref('stg_products_viewed') }}\nlimit 500\n/* limit added automatically by dbt cloud */", 'compiled_sql': "\n\n-- unique_key=['TIMESTAMP', 'user_id']\n-- ToDo: unique key should be user_id, timestamp\nselect * from ANALYTICS_DB.dbt_ecommerce_features.stg_products_viewed\nlimit 500\n/* limit added automatically by dbt cloud */", 'tags': None}, None)
2022-07-07 08:57:29.093107 (Thread-79): handling poll request
2022-07-07 08:57:29.093516 (Thread-79): 08:57:29  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '8901092b-4e3c-4560-9d28-48dc5c91cc33', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9a204580d0>]}
2022-07-07 08:57:29.094115 (Thread-79): sending response (<Response 11214 bytes [200 OK]>) to 10.0.19.15
2022-07-07 08:58:52.728552 (Thread-80): handling status request
2022-07-07 08:58:52.730378 (Thread-80): 08:58:52  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '8901092b-4e3c-4560-9d28-48dc5c91cc33', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9a20458520>]}
2022-07-07 08:58:52.731746 (Thread-80): sending response (<Response 25749 bytes [200 OK]>) to 10.0.19.15
2022-07-07 08:58:53.088053 (Thread-81): handling run_sql request
2022-07-07 08:58:53.088456 (Thread-81): 08:58:53  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '8901092b-4e3c-4560-9d28-48dc5c91cc33', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9a20458700>]}
2022-07-07 08:58:55.471970 (Thread-81): sending response (<Response 139 bytes [200 OK]>) to 10.0.19.15
2022-07-07 08:58:55.499843 (MainThread): 08:58:55  Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'c6c974ba-8e51-44f7-8617-b1dbc377cc01', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f785baba5b0>]}
2022-07-07 08:58:55.500417 (MainThread): 08:58:55  Found 17 models, 0 tests, 0 snapshots, 0 analyses, 181 macros, 0 operations, 0 seed files, 15 sources, 0 exposures, 0 metrics
2022-07-07 08:58:55.501052 (Thread-1): 08:58:55  Acquiring new snowflake connection "rpc.ecommerce_data_model_dbt.request"
2022-07-07 08:58:55.501187 (Thread-1): 08:58:55  Began compiling node rpc.ecommerce_data_model_dbt.request
2022-07-07 08:58:55.501276 (Thread-1): 08:58:55  Compiling rpc.ecommerce_data_model_dbt.request
2022-07-07 08:58:55.504886 (Thread-1): 08:58:55  finished collecting timing info
2022-07-07 08:58:55.505020 (Thread-1): 08:58:55  Began executing node rpc.ecommerce_data_model_dbt.request
2022-07-07 08:58:55.507173 (Thread-1): 08:58:55  Using snowflake connection "rpc.ecommerce_data_model_dbt.request"
2022-07-07 08:58:55.507269 (Thread-1): 08:58:55  On rpc.ecommerce_data_model_dbt.request: with cte_gender as ANALYTICS_DB.dbt_ecommerce_features.gender,

cte_age as ANALYTICS_DB.dbt_ecommerce_features.age,

cte_location as ANALYTICS_DB.dbt_ecommerce_features.country_and_state,

cte_email_domain as ANALYTICS_DB.dbt_ecommerce_features.email_domain,

cte_is_member as ANALYTICS_DB.dbt_ecommerce_features.is_member,

cte_has_mobile_app as ANALYTICS_DB.dbt_ecommerce_features.has_mobile_app,

cte_is_active_on_website as ANALYTICS_DB.dbt_ecommerce_features.is_active_on_website,

cte_device_type as ANALYTICS_DB.dbt_ecommerce_features.device_type

select coalesce(a.user_id, b.user_id, c.user_id, d.user_id, e.user_id, f.user_id, g.user_id, h.user_id) 
as user_id, gender, c.country as country, c.state as state, email_domain, is_member, has_mobile_app, is_active_on_website, device_type
from ((((((cte_gender a full outer join cte_age b on a.user_id = b.user_id) 
full outer join cte_location c on c.user_id = coalesce(a.user_id, b.user_id))
full outer join cte_email_domain d on d.user_id = coalesce(a.user_id, b.user_id, c.user_id))
full outer join cte_is_member e on e.user_id = coalesce(a.user_id, b.user_id, c.user_id,d.user_id))
full outer join cte_has_mobile_app f on f.user_id = coalesce(a.user_id, b.user_id, c.user_id,d.user_id, e.user_id))
full outer join cte_is_active_on_website as g on g.user_id = coalesce(a.user_id, b.user_id, c.user_id,d.user_id, e.user_id, f.user_id))
full outer join cte_device_type as h on h.user_id = coalesce(a.user_id, b.user_id, c.user_id,d.user_id, e.user_id, f.user_id, g.user_id)
limit 500
/* limit added automatically by dbt cloud */
2022-07-07 08:58:55.507352 (Thread-1): 08:58:55  Opening a new connection, currently in state init
2022-07-07 08:58:55.834801 (Thread-82): handling poll request
2022-07-07 08:58:55.835287 (Thread-82): 08:58:55  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '8901092b-4e3c-4560-9d28-48dc5c91cc33', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9a2045c6d0>]}
2022-07-07 08:58:55.836177 (Thread-82): sending response (<Response 5341 bytes [200 OK]>) to 10.0.19.15
2022-07-07 08:58:56.139473 (Thread-1): 08:58:56  Snowflake adapter: Snowflake query id: 01a5719a-0602-33c1-0019-8203046b69ce
2022-07-07 08:58:56.139674 (Thread-1): 08:58:56  Snowflake adapter: Snowflake error: 001003 (42000): SQL compilation error:
syntax error line 1 at position 19 unexpected 'ANALYTICS_DB'.
syntax error line 1 at position 61 unexpected ','.
syntax error line 3 at position 11 unexpected 'ANALYTICS_DB'.
syntax error line 3 at position 50 unexpected ','.
syntax error line 5 at position 16 unexpected 'ANALYTICS_DB'.
syntax error line 5 at position 69 unexpected ','.
syntax error line 7 at position 20 unexpected 'ANALYTICS_DB'.
syntax error line 7 at position 68 unexpected ','.
syntax error line 9 at position 17 unexpected 'ANALYTICS_DB'.
syntax error line 9 at position 62 unexpected ','.
syntax error line 11 at position 22 unexpected 'ANALYTICS_DB'.
syntax error line 11 at position 72 unexpected ','.
syntax error line 13 at position 28 unexpected 'ANALYTICS_DB'.
syntax error line 13 at position 84 unexpected ','.
syntax error line 15 at position 19 unexpected 'ANALYTICS_DB'.
syntax error line 17 at position 16 unexpected 'a'.
syntax error line 18 at position 0 unexpected 'as'.
2022-07-07 08:58:56.139842 (Thread-1): 08:58:56  finished collecting timing info
2022-07-07 08:58:56.140019 (Thread-1): 08:58:56  On rpc.ecommerce_data_model_dbt.request: Close
2022-07-07 08:58:56.282015 (Thread-1): Got an exception: Database Error
  001003 (42000): SQL compilation error:
  syntax error line 1 at position 19 unexpected 'ANALYTICS_DB'.
  syntax error line 1 at position 61 unexpected ','.
  syntax error line 3 at position 11 unexpected 'ANALYTICS_DB'.
  syntax error line 3 at position 50 unexpected ','.
  syntax error line 5 at position 16 unexpected 'ANALYTICS_DB'.
  syntax error line 5 at position 69 unexpected ','.
  syntax error line 7 at position 20 unexpected 'ANALYTICS_DB'.
  syntax error line 7 at position 68 unexpected ','.
  syntax error line 9 at position 17 unexpected 'ANALYTICS_DB'.
  syntax error line 9 at position 62 unexpected ','.
  syntax error line 11 at position 22 unexpected 'ANALYTICS_DB'.
  syntax error line 11 at position 72 unexpected ','.
  syntax error line 13 at position 28 unexpected 'ANALYTICS_DB'.
  syntax error line 13 at position 84 unexpected ','.
  syntax error line 15 at position 19 unexpected 'ANALYTICS_DB'.
  syntax error line 17 at position 16 unexpected 'a'.
  syntax error line 18 at position 0 unexpected 'as'.
Traceback (most recent call last):
  File "/usr/local/lib/python3.8/dist-packages/dbt/adapters/snowflake/connections.py", line 206, in exception_handler
    yield
  File "/usr/local/lib/python3.8/dist-packages/dbt/adapters/sql/connections.py", line 74, in add_query
    cursor.execute(sql, bindings)
  File "/usr/local/lib/python3.8/dist-packages/snowflake/connector/cursor.py", line 721, in execute
    Error.errorhandler_wrapper(
  File "/usr/local/lib/python3.8/dist-packages/snowflake/connector/errors.py", line 258, in errorhandler_wrapper
    cursor.errorhandler(connection, cursor, error_class, error_value)
  File "/usr/local/lib/python3.8/dist-packages/snowflake/connector/errors.py", line 188, in default_errorhandler
    raise error_class(
snowflake.connector.errors.ProgrammingError: 001003 (42000): SQL compilation error:
syntax error line 1 at position 19 unexpected 'ANALYTICS_DB'.
syntax error line 1 at position 61 unexpected ','.
syntax error line 3 at position 11 unexpected 'ANALYTICS_DB'.
syntax error line 3 at position 50 unexpected ','.
syntax error line 5 at position 16 unexpected 'ANALYTICS_DB'.
syntax error line 5 at position 69 unexpected ','.
syntax error line 7 at position 20 unexpected 'ANALYTICS_DB'.
syntax error line 7 at position 68 unexpected ','.
syntax error line 9 at position 17 unexpected 'ANALYTICS_DB'.
syntax error line 9 at position 62 unexpected ','.
syntax error line 11 at position 22 unexpected 'ANALYTICS_DB'.
syntax error line 11 at position 72 unexpected ','.
syntax error line 13 at position 28 unexpected 'ANALYTICS_DB'.
syntax error line 13 at position 84 unexpected ','.
syntax error line 15 at position 19 unexpected 'ANALYTICS_DB'.
syntax error line 17 at position 16 unexpected 'a'.
syntax error line 18 at position 0 unexpected 'as'.

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/usr/local/lib/python3.8/dist-packages/dbt/task/base.py", line 361, in safe_run
    result = self.compile_and_execute(manifest, ctx)
  File "/usr/local/lib/python3.8/dist-packages/dbt/task/base.py", line 314, in compile_and_execute
    result = self.run(ctx.node, manifest)
  File "/usr/local/lib/python3.8/dist-packages/dbt/task/base.py", line 403, in run
    return self.execute(compiled_node, manifest)
  File "/usr/local/lib/python3.8/dist-packages/dbt_rpc/rpc/node_runners.py", line 90, in execute
    _, execute_result = self.adapter.execute(
  File "/usr/local/lib/python3.8/dist-packages/dbt/adapters/base/impl.py", line 225, in execute
    return self.connections.execute(
  File "/usr/local/lib/python3.8/dist-packages/dbt/adapters/sql/connections.py", line 127, in execute
    _, cursor = self.add_query(sql, auto_begin)
  File "/usr/local/lib/python3.8/dist-packages/dbt/adapters/snowflake/connections.py", line 433, in add_query
    connection, cursor = super().add_query(
  File "/usr/local/lib/python3.8/dist-packages/dbt/adapters/sql/connections.py", line 83, in add_query
    return connection, cursor
  File "/usr/lib/python3.8/contextlib.py", line 131, in __exit__
    self.gen.throw(type, value, traceback)
  File "/usr/local/lib/python3.8/dist-packages/dbt/adapters/snowflake/connections.py", line 223, in exception_handler
    raise DatabaseException(msg)
dbt.exceptions.DatabaseException: Database Error
  001003 (42000): SQL compilation error:
  syntax error line 1 at position 19 unexpected 'ANALYTICS_DB'.
  syntax error line 1 at position 61 unexpected ','.
  syntax error line 3 at position 11 unexpected 'ANALYTICS_DB'.
  syntax error line 3 at position 50 unexpected ','.
  syntax error line 5 at position 16 unexpected 'ANALYTICS_DB'.
  syntax error line 5 at position 69 unexpected ','.
  syntax error line 7 at position 20 unexpected 'ANALYTICS_DB'.
  syntax error line 7 at position 68 unexpected ','.
  syntax error line 9 at position 17 unexpected 'ANALYTICS_DB'.
  syntax error line 9 at position 62 unexpected ','.
  syntax error line 11 at position 22 unexpected 'ANALYTICS_DB'.
  syntax error line 11 at position 72 unexpected ','.
  syntax error line 13 at position 28 unexpected 'ANALYTICS_DB'.
  syntax error line 13 at position 84 unexpected ','.
  syntax error line 15 at position 19 unexpected 'ANALYTICS_DB'.
  syntax error line 17 at position 16 unexpected 'a'.
  syntax error line 18 at position 0 unexpected 'as'.
2022-07-07 08:58:56.282817 (Thread-1): Got exception RPCException(10003, Database Error, {'type': 'DatabaseException', 'message': "Database Error in rpc request (from remote system)\n  001003 (42000): SQL compilation error:\n  syntax error line 1 at position 19 unexpected 'ANALYTICS_DB'.\n  syntax error line 1 at position 61 unexpected ','.\n  syntax error line 3 at position 11 unexpected 'ANALYTICS_DB'.\n  syntax error line 3 at position 50 unexpected ','.\n  syntax error line 5 at position 16 unexpected 'ANALYTICS_DB'.\n  syntax error line 5 at position 69 unexpected ','.\n  syntax error line 7 at position 20 unexpected 'ANALYTICS_DB'.\n  syntax error line 7 at position 68 unexpected ','.\n  syntax error line 9 at position 17 unexpected 'ANALYTICS_DB'.\n  syntax error line 9 at position 62 unexpected ','.\n  syntax error line 11 at position 22 unexpected 'ANALYTICS_DB'.\n  syntax error line 11 at position 72 unexpected ','.\n  syntax error line 13 at position 28 unexpected 'ANALYTICS_DB'.\n  syntax error line 13 at position 84 unexpected ','.\n  syntax error line 15 at position 19 unexpected 'ANALYTICS_DB'.\n  syntax error line 17 at position 16 unexpected 'a'.\n  syntax error line 18 at position 0 unexpected 'as'.", 'raw_sql': "with cte_gender as {{ ref('gender') }},\r\n\r\ncte_age as {{ ref('age') }},\r\n\r\ncte_location as {{ ref('country_and_state') }},\r\n\r\ncte_email_domain as {{ ref('email_domain') }},\r\n\r\ncte_is_member as {{ ref('is_member') }},\r\n\r\ncte_has_mobile_app as {{ ref('has_mobile_app') }},\r\n\r\ncte_is_active_on_website as {{ ref('is_active_on_website') }},\r\n\r\ncte_device_type as {{ ref('device_type') }}\r\n\r\nselect coalesce(a.user_id, b.user_id, c.user_id, d.user_id, e.user_id, f.user_id, g.user_id, h.user_id) \r\nas user_id, gender, c.country as country, c.state as state, email_domain, is_member, has_mobile_app, is_active_on_website, device_type\r\nfrom ((((((cte_gender a full outer join cte_age b on a.user_id = b.user_id) \r\nfull outer join cte_location c on c.user_id = coalesce(a.user_id, b.user_id))\r\nfull outer join cte_email_domain d on d.user_id = coalesce(a.user_id, b.user_id, c.user_id))\r\nfull outer join cte_is_member e on e.user_id = coalesce(a.user_id, b.user_id, c.user_id,d.user_id))\r\nfull outer join cte_has_mobile_app f on f.user_id = coalesce(a.user_id, b.user_id, c.user_id,d.user_id, e.user_id))\r\nfull outer join cte_is_active_on_website as g on g.user_id = coalesce(a.user_id, b.user_id, c.user_id,d.user_id, e.user_id, f.user_id))\r\nfull outer join cte_device_type as h on h.user_id = coalesce(a.user_id, b.user_id, c.user_id,d.user_id, e.user_id, f.user_id, g.user_id)\nlimit 500\n/* limit added automatically by dbt cloud */", 'compiled_sql': 'with cte_gender as ANALYTICS_DB.dbt_ecommerce_features.gender,\n\ncte_age as ANALYTICS_DB.dbt_ecommerce_features.age,\n\ncte_location as ANALYTICS_DB.dbt_ecommerce_features.country_and_state,\n\ncte_email_domain as ANALYTICS_DB.dbt_ecommerce_features.email_domain,\n\ncte_is_member as ANALYTICS_DB.dbt_ecommerce_features.is_member,\n\ncte_has_mobile_app as ANALYTICS_DB.dbt_ecommerce_features.has_mobile_app,\n\ncte_is_active_on_website as ANALYTICS_DB.dbt_ecommerce_features.is_active_on_website,\n\ncte_device_type as ANALYTICS_DB.dbt_ecommerce_features.device_type\n\nselect coalesce(a.user_id, b.user_id, c.user_id, d.user_id, e.user_id, f.user_id, g.user_id, h.user_id) \nas user_id, gender, c.country as country, c.state as state, email_domain, is_member, has_mobile_app, is_active_on_website, device_type\nfrom ((((((cte_gender a full outer join cte_age b on a.user_id = b.user_id) \nfull outer join cte_location c on c.user_id = coalesce(a.user_id, b.user_id))\nfull outer join cte_email_domain d on d.user_id = coalesce(a.user_id, b.user_id, c.user_id))\nfull outer join cte_is_member e on e.user_id = coalesce(a.user_id, b.user_id, c.user_id,d.user_id))\nfull outer join cte_has_mobile_app f on f.user_id = coalesce(a.user_id, b.user_id, c.user_id,d.user_id, e.user_id))\nfull outer join cte_is_active_on_website as g on g.user_id = coalesce(a.user_id, b.user_id, c.user_id,d.user_id, e.user_id, f.user_id))\nfull outer join cte_device_type as h on h.user_id = coalesce(a.user_id, b.user_id, c.user_id,d.user_id, e.user_id, f.user_id, g.user_id)\nlimit 500\n/* limit added automatically by dbt cloud */', 'tags': None}, None)
Traceback (most recent call last):
  File "/usr/local/lib/python3.8/dist-packages/dbt_rpc/task/sql_commands.py", line 147, in _in_thread
    self.node_results.append(runner.safe_run(self.manifest))
  File "/usr/local/lib/python3.8/dist-packages/dbt/task/base.py", line 377, in safe_run
    result = self.error_result(ctx.node, error, started, [])
  File "/usr/local/lib/python3.8/dist-packages/dbt_rpc/rpc/node_runners.py", line 56, in error_result
    raise error
dbt_rpc.rpc.error.RPCException: RPCException(10003, Database Error, {'type': 'DatabaseException', 'message': "Database Error in rpc request (from remote system)\n  001003 (42000): SQL compilation error:\n  syntax error line 1 at position 19 unexpected 'ANALYTICS_DB'.\n  syntax error line 1 at position 61 unexpected ','.\n  syntax error line 3 at position 11 unexpected 'ANALYTICS_DB'.\n  syntax error line 3 at position 50 unexpected ','.\n  syntax error line 5 at position 16 unexpected 'ANALYTICS_DB'.\n  syntax error line 5 at position 69 unexpected ','.\n  syntax error line 7 at position 20 unexpected 'ANALYTICS_DB'.\n  syntax error line 7 at position 68 unexpected ','.\n  syntax error line 9 at position 17 unexpected 'ANALYTICS_DB'.\n  syntax error line 9 at position 62 unexpected ','.\n  syntax error line 11 at position 22 unexpected 'ANALYTICS_DB'.\n  syntax error line 11 at position 72 unexpected ','.\n  syntax error line 13 at position 28 unexpected 'ANALYTICS_DB'.\n  syntax error line 13 at position 84 unexpected ','.\n  syntax error line 15 at position 19 unexpected 'ANALYTICS_DB'.\n  syntax error line 17 at position 16 unexpected 'a'.\n  syntax error line 18 at position 0 unexpected 'as'.", 'raw_sql': "with cte_gender as {{ ref('gender') }},\r\n\r\ncte_age as {{ ref('age') }},\r\n\r\ncte_location as {{ ref('country_and_state') }},\r\n\r\ncte_email_domain as {{ ref('email_domain') }},\r\n\r\ncte_is_member as {{ ref('is_member') }},\r\n\r\ncte_has_mobile_app as {{ ref('has_mobile_app') }},\r\n\r\ncte_is_active_on_website as {{ ref('is_active_on_website') }},\r\n\r\ncte_device_type as {{ ref('device_type') }}\r\n\r\nselect coalesce(a.user_id, b.user_id, c.user_id, d.user_id, e.user_id, f.user_id, g.user_id, h.user_id) \r\nas user_id, gender, c.country as country, c.state as state, email_domain, is_member, has_mobile_app, is_active_on_website, device_type\r\nfrom ((((((cte_gender a full outer join cte_age b on a.user_id = b.user_id) \r\nfull outer join cte_location c on c.user_id = coalesce(a.user_id, b.user_id))\r\nfull outer join cte_email_domain d on d.user_id = coalesce(a.user_id, b.user_id, c.user_id))\r\nfull outer join cte_is_member e on e.user_id = coalesce(a.user_id, b.user_id, c.user_id,d.user_id))\r\nfull outer join cte_has_mobile_app f on f.user_id = coalesce(a.user_id, b.user_id, c.user_id,d.user_id, e.user_id))\r\nfull outer join cte_is_active_on_website as g on g.user_id = coalesce(a.user_id, b.user_id, c.user_id,d.user_id, e.user_id, f.user_id))\r\nfull outer join cte_device_type as h on h.user_id = coalesce(a.user_id, b.user_id, c.user_id,d.user_id, e.user_id, f.user_id, g.user_id)\nlimit 500\n/* limit added automatically by dbt cloud */", 'compiled_sql': 'with cte_gender as ANALYTICS_DB.dbt_ecommerce_features.gender,\n\ncte_age as ANALYTICS_DB.dbt_ecommerce_features.age,\n\ncte_location as ANALYTICS_DB.dbt_ecommerce_features.country_and_state,\n\ncte_email_domain as ANALYTICS_DB.dbt_ecommerce_features.email_domain,\n\ncte_is_member as ANALYTICS_DB.dbt_ecommerce_features.is_member,\n\ncte_has_mobile_app as ANALYTICS_DB.dbt_ecommerce_features.has_mobile_app,\n\ncte_is_active_on_website as ANALYTICS_DB.dbt_ecommerce_features.is_active_on_website,\n\ncte_device_type as ANALYTICS_DB.dbt_ecommerce_features.device_type\n\nselect coalesce(a.user_id, b.user_id, c.user_id, d.user_id, e.user_id, f.user_id, g.user_id, h.user_id) \nas user_id, gender, c.country as country, c.state as state, email_domain, is_member, has_mobile_app, is_active_on_website, device_type\nfrom ((((((cte_gender a full outer join cte_age b on a.user_id = b.user_id) \nfull outer join cte_location c on c.user_id = coalesce(a.user_id, b.user_id))\nfull outer join cte_email_domain d on d.user_id = coalesce(a.user_id, b.user_id, c.user_id))\nfull outer join cte_is_member e on e.user_id = coalesce(a.user_id, b.user_id, c.user_id,d.user_id))\nfull outer join cte_has_mobile_app f on f.user_id = coalesce(a.user_id, b.user_id, c.user_id,d.user_id, e.user_id))\nfull outer join cte_is_active_on_website as g on g.user_id = coalesce(a.user_id, b.user_id, c.user_id,d.user_id, e.user_id, f.user_id))\nfull outer join cte_device_type as h on h.user_id = coalesce(a.user_id, b.user_id, c.user_id,d.user_id, e.user_id, f.user_id, g.user_id)\nlimit 500\n/* limit added automatically by dbt cloud */', 'tags': None}, None)
2022-07-07 08:58:57.229612 (Thread-83): handling poll request
2022-07-07 08:58:57.230025 (Thread-83): 08:58:57  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '8901092b-4e3c-4560-9d28-48dc5c91cc33', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9a2045c9d0>]}
2022-07-07 08:58:57.230685 (Thread-83): sending response (<Response 27039 bytes [200 OK]>) to 10.0.19.15
2022-07-07 08:59:58.361181 (Thread-84): handling status request
2022-07-07 08:59:58.363029 (Thread-84): 08:59:58  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '8901092b-4e3c-4560-9d28-48dc5c91cc33', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9a2045ce50>]}
2022-07-07 08:59:58.364671 (Thread-84): sending response (<Response 25749 bytes [200 OK]>) to 10.0.19.15
2022-07-07 08:59:58.739935 (Thread-85): handling run_sql request
2022-07-07 08:59:58.740349 (Thread-85): 08:59:58  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '8901092b-4e3c-4560-9d28-48dc5c91cc33', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9a2045cfa0>]}
2022-07-07 08:59:59.139133 (Thread-86): 08:59:59  Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
2022-07-07 08:59:59.139772 (Thread-86): 08:59:59  Partial parsing: updated file: ecommerce_data_model_dbt://models/data_model/stg_user_traits_new.sql
2022-07-07 08:59:59.144596 (Thread-86): 08:59:59  1699: static parser successfully parsed data_model/stg_user_traits_new.sql
2022-07-07 09:00:00.179413 (Thread-87): handling status request
2022-07-07 09:00:00.179997 (Thread-87): 09:00:00  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '8901092b-4e3c-4560-9d28-48dc5c91cc33', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9a204e6d60>]}
2022-07-07 09:00:00.180692 (Thread-87): sending response (<Response 1420 bytes [200 OK]>) to 10.0.19.15
2022-07-07 09:00:00.214884 (Thread-88): handling status request
2022-07-07 09:00:00.215216 (Thread-88): 09:00:00  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '8901092b-4e3c-4560-9d28-48dc5c91cc33', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9a2034aa00>]}
2022-07-07 09:00:00.215651 (Thread-88): sending response (<Response 1420 bytes [200 OK]>) to 10.0.19.15
2022-07-07 09:00:01.151348 (Thread-85): sending response (<Response 139 bytes [200 OK]>) to 10.0.19.15
2022-07-07 09:00:01.178141 (MainThread): dbt runtime exception
Traceback (most recent call last):
  File "/usr/local/lib/python3.8/dist-packages/dbt_rpc/rpc/task_handler.py", line 102, in task_exec
    result = self.task.handle_request()
  File "/usr/local/lib/python3.8/dist-packages/dbt_rpc/task/sql_commands.py", line 164, in handle_request
    node = self._get_exec_node()
  File "/usr/local/lib/python3.8/dist-packages/dbt_rpc/task/sql_commands.py", line 125, in _get_exec_node
    add_new_refs(
  File "/usr/local/lib/python3.8/dist-packages/dbt_rpc/task/sql_commands.py", line 50, in add_new_refs
    process_node(config, manifest, node)
  File "/usr/local/lib/python3.8/dist-packages/dbt/parser/manifest.py", line 1278, in process_node
    _process_refs_for_node(manifest, config.project_name, node)
  File "/usr/local/lib/python3.8/dist-packages/dbt/parser/manifest.py", line 1163, in _process_refs_for_node
    invalid_ref_fail_unless_test(
  File "/usr/local/lib/python3.8/dist-packages/dbt/parser/manifest.py", line 901, in invalid_ref_fail_unless_test
    ref_target_not_found(
  File "/usr/local/lib/python3.8/dist-packages/dbt/exceptions.py", line 621, in ref_target_not_found
    raise_compiler_error(msg, model)
  File "/usr/local/lib/python3.8/dist-packages/dbt/exceptions.py", line 441, in raise_compiler_error
    raise CompilationException(msg, node)
dbt.exceptions.CompilationException: Compilation Error in rpc request (from remote system)
  Rpc 'rpc.ecommerce_data_model_dbt.request' (from remote system) depends on a node named 'stg_traits.gender' which was not found
2022-07-07 09:00:01.606591 (Thread-89): handling poll request
2022-07-07 09:00:01.607005 (Thread-89): 09:00:01  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '8901092b-4e3c-4560-9d28-48dc5c91cc33', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9a215d1bb0>]}
2022-07-07 09:00:01.607548 (Thread-89): sending response (<Response 3938 bytes [200 OK]>) to 10.0.19.15
2022-07-07 09:00:03.990854 (Thread-90): handling status request
2022-07-07 09:00:03.991262 (Thread-90): 09:00:03  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '8901092b-4e3c-4560-9d28-48dc5c91cc33', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9a2034aa60>]}
2022-07-07 09:00:04.044245 (Thread-90): sending response (<Response 1420 bytes [200 OK]>) to 10.0.19.15
2022-07-07 09:00:04.408992 (Thread-91): handling run_sql request
2022-07-07 09:00:04.409410 (Thread-91): 09:00:04  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '8901092b-4e3c-4560-9d28-48dc5c91cc33', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9a2034ad60>]}
2022-07-07 09:00:04.409842 (Thread-91): sending response (<Response 864 bytes [200 OK]>) to 10.0.19.15
2022-07-07 09:00:11.697959 (Thread-92): 09:00:11  Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
2022-07-07 09:00:11.698192 (Thread-92): 09:00:11  Partial parsing enabled, no changes found, skipping parsing
2022-07-07 09:00:11.698940 (Thread-92): 09:00:11  [WARNING]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.data-apps-ecommerce-template.data_model

2022-07-07 09:00:11.704660 (Thread-92): 09:00:11  Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '8901092b-4e3c-4560-9d28-48dc5c91cc33', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9a20331cd0>]}
2022-07-07 09:00:12.612496 (Thread-93): handling status request
2022-07-07 09:00:12.612951 (Thread-93): 09:00:12  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '8901092b-4e3c-4560-9d28-48dc5c91cc33', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9a203cf820>]}
2022-07-07 09:00:12.613509 (Thread-93): sending response (<Response 1699 bytes [200 OK]>) to 10.0.19.15
2022-07-07 09:00:12.655199 (Thread-94): handling status request
2022-07-07 09:00:12.655635 (Thread-94): 09:00:12  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '8901092b-4e3c-4560-9d28-48dc5c91cc33', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9a203b5190>]}
2022-07-07 09:00:12.656135 (Thread-94): sending response (<Response 1699 bytes [200 OK]>) to 10.0.19.15
2022-07-07 09:00:13.420085 (Thread-95): handling status request
2022-07-07 09:00:13.420486 (Thread-95): 09:00:13  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '8901092b-4e3c-4560-9d28-48dc5c91cc33', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9a203cf4f0>]}
2022-07-07 09:00:13.420989 (Thread-95): sending response (<Response 1699 bytes [200 OK]>) to 10.0.19.15
2022-07-07 09:00:13.790418 (Thread-96): handling run_sql request
2022-07-07 09:00:13.790824 (Thread-96): 09:00:13  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '8901092b-4e3c-4560-9d28-48dc5c91cc33', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9a203cf400>]}
2022-07-07 09:00:16.152424 (Thread-96): sending response (<Response 139 bytes [200 OK]>) to 10.0.19.15
2022-07-07 09:00:16.179450 (MainThread): 09:00:16  Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '2c648492-b4de-4057-a3d9-b5e483c1db11', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f378a55ee80>]}
2022-07-07 09:00:16.180015 (MainThread): 09:00:16  Found 17 models, 0 tests, 0 snapshots, 0 analyses, 181 macros, 0 operations, 0 seed files, 15 sources, 0 exposures, 0 metrics
2022-07-07 09:00:16.180617 (Thread-1): 09:00:16  Acquiring new snowflake connection "rpc.ecommerce_data_model_dbt.request"
2022-07-07 09:00:16.180755 (Thread-1): 09:00:16  Began compiling node rpc.ecommerce_data_model_dbt.request
2022-07-07 09:00:16.180878 (Thread-1): 09:00:16  Compiling rpc.ecommerce_data_model_dbt.request
2022-07-07 09:00:16.184434 (Thread-1): 09:00:16  finished collecting timing info
2022-07-07 09:00:16.184564 (Thread-1): 09:00:16  Began executing node rpc.ecommerce_data_model_dbt.request
2022-07-07 09:00:16.186726 (Thread-1): 09:00:16  Using snowflake connection "rpc.ecommerce_data_model_dbt.request"
2022-07-07 09:00:16.186826 (Thread-1): 09:00:16  On rpc.ecommerce_data_model_dbt.request: with cte_gender as ANALYTICS_DB.dbt_ecommerce_features.gender,

cte_age as ANALYTICS_DB.dbt_ecommerce_features.age,

cte_location as ANALYTICS_DB.dbt_ecommerce_features.country_and_state,

cte_email_domain as ANALYTICS_DB.dbt_ecommerce_features.email_domain,

cte_is_member as ANALYTICS_DB.dbt_ecommerce_features.is_member,

cte_has_mobile_app as ANALYTICS_DB.dbt_ecommerce_features.has_mobile_app,

cte_is_active_on_website as ANALYTICS_DB.dbt_ecommerce_features.is_active_on_website,

cte_device_type as ANALYTICS_DB.dbt_ecommerce_features.device_type

select coalesce(a.user_id, b.user_id, c.user_id, d.user_id, e.user_id, f.user_id, g.user_id, h.user_id) 
as user_id, gender, c.country as country, c.state as state, email_domain, is_member, has_mobile_app, is_active_on_website, device_type
from ((((((cte_gender a full outer join cte_age b on a.user_id = b.user_id) 
full outer join cte_location c on c.user_id = coalesce(a.user_id, b.user_id))
full outer join cte_email_domain d on d.user_id = coalesce(a.user_id, b.user_id, c.user_id))
full outer join cte_is_member e on e.user_id = coalesce(a.user_id, b.user_id, c.user_id,d.user_id))
full outer join cte_has_mobile_app f on f.user_id = coalesce(a.user_id, b.user_id, c.user_id,d.user_id, e.user_id))
full outer join cte_is_active_on_website as g on g.user_id = coalesce(a.user_id, b.user_id, c.user_id,d.user_id, e.user_id, f.user_id))
full outer join cte_device_type as h on h.user_id = coalesce(a.user_id, b.user_id, c.user_id,d.user_id, e.user_id, f.user_id, g.user_id)
limit 500
/* limit added automatically by dbt cloud */
2022-07-07 09:00:16.186909 (Thread-1): 09:00:16  Opening a new connection, currently in state init
2022-07-07 09:00:16.514880 (Thread-97): handling poll request
2022-07-07 09:00:16.515543 (Thread-97): 09:00:16  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '8901092b-4e3c-4560-9d28-48dc5c91cc33', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9a2035d3d0>]}
2022-07-07 09:00:16.516612 (Thread-97): sending response (<Response 5341 bytes [200 OK]>) to 10.0.19.15
2022-07-07 09:00:17.046023 (Thread-1): 09:00:17  Snowflake adapter: Snowflake query id: 01a5719c-0602-3374-0019-8203046b5972
2022-07-07 09:00:17.046233 (Thread-1): 09:00:17  Snowflake adapter: Snowflake error: 001003 (42000): SQL compilation error:
syntax error line 1 at position 19 unexpected 'ANALYTICS_DB'.
syntax error line 1 at position 61 unexpected ','.
syntax error line 3 at position 11 unexpected 'ANALYTICS_DB'.
syntax error line 3 at position 50 unexpected ','.
syntax error line 5 at position 16 unexpected 'ANALYTICS_DB'.
syntax error line 5 at position 69 unexpected ','.
syntax error line 7 at position 20 unexpected 'ANALYTICS_DB'.
syntax error line 7 at position 68 unexpected ','.
syntax error line 9 at position 17 unexpected 'ANALYTICS_DB'.
syntax error line 9 at position 62 unexpected ','.
syntax error line 11 at position 22 unexpected 'ANALYTICS_DB'.
syntax error line 11 at position 72 unexpected ','.
syntax error line 13 at position 28 unexpected 'ANALYTICS_DB'.
syntax error line 13 at position 84 unexpected ','.
syntax error line 15 at position 19 unexpected 'ANALYTICS_DB'.
syntax error line 17 at position 16 unexpected 'a'.
syntax error line 18 at position 0 unexpected 'as'.
2022-07-07 09:00:17.046396 (Thread-1): 09:00:17  finished collecting timing info
2022-07-07 09:00:17.046580 (Thread-1): 09:00:17  On rpc.ecommerce_data_model_dbt.request: Close
2022-07-07 09:00:17.107281 (Thread-1): Got an exception: Database Error
  001003 (42000): SQL compilation error:
  syntax error line 1 at position 19 unexpected 'ANALYTICS_DB'.
  syntax error line 1 at position 61 unexpected ','.
  syntax error line 3 at position 11 unexpected 'ANALYTICS_DB'.
  syntax error line 3 at position 50 unexpected ','.
  syntax error line 5 at position 16 unexpected 'ANALYTICS_DB'.
  syntax error line 5 at position 69 unexpected ','.
  syntax error line 7 at position 20 unexpected 'ANALYTICS_DB'.
  syntax error line 7 at position 68 unexpected ','.
  syntax error line 9 at position 17 unexpected 'ANALYTICS_DB'.
  syntax error line 9 at position 62 unexpected ','.
  syntax error line 11 at position 22 unexpected 'ANALYTICS_DB'.
  syntax error line 11 at position 72 unexpected ','.
  syntax error line 13 at position 28 unexpected 'ANALYTICS_DB'.
  syntax error line 13 at position 84 unexpected ','.
  syntax error line 15 at position 19 unexpected 'ANALYTICS_DB'.
  syntax error line 17 at position 16 unexpected 'a'.
  syntax error line 18 at position 0 unexpected 'as'.
Traceback (most recent call last):
  File "/usr/local/lib/python3.8/dist-packages/dbt/adapters/snowflake/connections.py", line 206, in exception_handler
    yield
  File "/usr/local/lib/python3.8/dist-packages/dbt/adapters/sql/connections.py", line 74, in add_query
    cursor.execute(sql, bindings)
  File "/usr/local/lib/python3.8/dist-packages/snowflake/connector/cursor.py", line 721, in execute
    Error.errorhandler_wrapper(
  File "/usr/local/lib/python3.8/dist-packages/snowflake/connector/errors.py", line 258, in errorhandler_wrapper
    cursor.errorhandler(connection, cursor, error_class, error_value)
  File "/usr/local/lib/python3.8/dist-packages/snowflake/connector/errors.py", line 188, in default_errorhandler
    raise error_class(
snowflake.connector.errors.ProgrammingError: 001003 (42000): SQL compilation error:
syntax error line 1 at position 19 unexpected 'ANALYTICS_DB'.
syntax error line 1 at position 61 unexpected ','.
syntax error line 3 at position 11 unexpected 'ANALYTICS_DB'.
syntax error line 3 at position 50 unexpected ','.
syntax error line 5 at position 16 unexpected 'ANALYTICS_DB'.
syntax error line 5 at position 69 unexpected ','.
syntax error line 7 at position 20 unexpected 'ANALYTICS_DB'.
syntax error line 7 at position 68 unexpected ','.
syntax error line 9 at position 17 unexpected 'ANALYTICS_DB'.
syntax error line 9 at position 62 unexpected ','.
syntax error line 11 at position 22 unexpected 'ANALYTICS_DB'.
syntax error line 11 at position 72 unexpected ','.
syntax error line 13 at position 28 unexpected 'ANALYTICS_DB'.
syntax error line 13 at position 84 unexpected ','.
syntax error line 15 at position 19 unexpected 'ANALYTICS_DB'.
syntax error line 17 at position 16 unexpected 'a'.
syntax error line 18 at position 0 unexpected 'as'.

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/usr/local/lib/python3.8/dist-packages/dbt/task/base.py", line 361, in safe_run
    result = self.compile_and_execute(manifest, ctx)
  File "/usr/local/lib/python3.8/dist-packages/dbt/task/base.py", line 314, in compile_and_execute
    result = self.run(ctx.node, manifest)
  File "/usr/local/lib/python3.8/dist-packages/dbt/task/base.py", line 403, in run
    return self.execute(compiled_node, manifest)
  File "/usr/local/lib/python3.8/dist-packages/dbt_rpc/rpc/node_runners.py", line 90, in execute
    _, execute_result = self.adapter.execute(
  File "/usr/local/lib/python3.8/dist-packages/dbt/adapters/base/impl.py", line 225, in execute
    return self.connections.execute(
  File "/usr/local/lib/python3.8/dist-packages/dbt/adapters/sql/connections.py", line 127, in execute
    _, cursor = self.add_query(sql, auto_begin)
  File "/usr/local/lib/python3.8/dist-packages/dbt/adapters/snowflake/connections.py", line 433, in add_query
    connection, cursor = super().add_query(
  File "/usr/local/lib/python3.8/dist-packages/dbt/adapters/sql/connections.py", line 83, in add_query
    return connection, cursor
  File "/usr/lib/python3.8/contextlib.py", line 131, in __exit__
    self.gen.throw(type, value, traceback)
  File "/usr/local/lib/python3.8/dist-packages/dbt/adapters/snowflake/connections.py", line 223, in exception_handler
    raise DatabaseException(msg)
dbt.exceptions.DatabaseException: Database Error
  001003 (42000): SQL compilation error:
  syntax error line 1 at position 19 unexpected 'ANALYTICS_DB'.
  syntax error line 1 at position 61 unexpected ','.
  syntax error line 3 at position 11 unexpected 'ANALYTICS_DB'.
  syntax error line 3 at position 50 unexpected ','.
  syntax error line 5 at position 16 unexpected 'ANALYTICS_DB'.
  syntax error line 5 at position 69 unexpected ','.
  syntax error line 7 at position 20 unexpected 'ANALYTICS_DB'.
  syntax error line 7 at position 68 unexpected ','.
  syntax error line 9 at position 17 unexpected 'ANALYTICS_DB'.
  syntax error line 9 at position 62 unexpected ','.
  syntax error line 11 at position 22 unexpected 'ANALYTICS_DB'.
  syntax error line 11 at position 72 unexpected ','.
  syntax error line 13 at position 28 unexpected 'ANALYTICS_DB'.
  syntax error line 13 at position 84 unexpected ','.
  syntax error line 15 at position 19 unexpected 'ANALYTICS_DB'.
  syntax error line 17 at position 16 unexpected 'a'.
  syntax error line 18 at position 0 unexpected 'as'.
2022-07-07 09:00:17.108090 (Thread-1): Got exception RPCException(10003, Database Error, {'type': 'DatabaseException', 'message': "Database Error in rpc request (from remote system)\n  001003 (42000): SQL compilation error:\n  syntax error line 1 at position 19 unexpected 'ANALYTICS_DB'.\n  syntax error line 1 at position 61 unexpected ','.\n  syntax error line 3 at position 11 unexpected 'ANALYTICS_DB'.\n  syntax error line 3 at position 50 unexpected ','.\n  syntax error line 5 at position 16 unexpected 'ANALYTICS_DB'.\n  syntax error line 5 at position 69 unexpected ','.\n  syntax error line 7 at position 20 unexpected 'ANALYTICS_DB'.\n  syntax error line 7 at position 68 unexpected ','.\n  syntax error line 9 at position 17 unexpected 'ANALYTICS_DB'.\n  syntax error line 9 at position 62 unexpected ','.\n  syntax error line 11 at position 22 unexpected 'ANALYTICS_DB'.\n  syntax error line 11 at position 72 unexpected ','.\n  syntax error line 13 at position 28 unexpected 'ANALYTICS_DB'.\n  syntax error line 13 at position 84 unexpected ','.\n  syntax error line 15 at position 19 unexpected 'ANALYTICS_DB'.\n  syntax error line 17 at position 16 unexpected 'a'.\n  syntax error line 18 at position 0 unexpected 'as'.", 'raw_sql': "with cte_gender as {{ ref('gender') }},\r\n\r\ncte_age as {{ ref('age') }},\r\n\r\ncte_location as {{ ref('country_and_state') }},\r\n\r\ncte_email_domain as {{ ref('email_domain') }},\r\n\r\ncte_is_member as {{ ref('is_member') }},\r\n\r\ncte_has_mobile_app as {{ ref('has_mobile_app') }},\r\n\r\ncte_is_active_on_website as {{ ref('is_active_on_website') }},\r\n\r\ncte_device_type as {{ ref('device_type') }}\r\n\r\nselect coalesce(a.user_id, b.user_id, c.user_id, d.user_id, e.user_id, f.user_id, g.user_id, h.user_id) \r\nas user_id, gender, c.country as country, c.state as state, email_domain, is_member, has_mobile_app, is_active_on_website, device_type\r\nfrom ((((((cte_gender a full outer join cte_age b on a.user_id = b.user_id) \r\nfull outer join cte_location c on c.user_id = coalesce(a.user_id, b.user_id))\r\nfull outer join cte_email_domain d on d.user_id = coalesce(a.user_id, b.user_id, c.user_id))\r\nfull outer join cte_is_member e on e.user_id = coalesce(a.user_id, b.user_id, c.user_id,d.user_id))\r\nfull outer join cte_has_mobile_app f on f.user_id = coalesce(a.user_id, b.user_id, c.user_id,d.user_id, e.user_id))\r\nfull outer join cte_is_active_on_website as g on g.user_id = coalesce(a.user_id, b.user_id, c.user_id,d.user_id, e.user_id, f.user_id))\r\nfull outer join cte_device_type as h on h.user_id = coalesce(a.user_id, b.user_id, c.user_id,d.user_id, e.user_id, f.user_id, g.user_id)\nlimit 500\n/* limit added automatically by dbt cloud */", 'compiled_sql': 'with cte_gender as ANALYTICS_DB.dbt_ecommerce_features.gender,\n\ncte_age as ANALYTICS_DB.dbt_ecommerce_features.age,\n\ncte_location as ANALYTICS_DB.dbt_ecommerce_features.country_and_state,\n\ncte_email_domain as ANALYTICS_DB.dbt_ecommerce_features.email_domain,\n\ncte_is_member as ANALYTICS_DB.dbt_ecommerce_features.is_member,\n\ncte_has_mobile_app as ANALYTICS_DB.dbt_ecommerce_features.has_mobile_app,\n\ncte_is_active_on_website as ANALYTICS_DB.dbt_ecommerce_features.is_active_on_website,\n\ncte_device_type as ANALYTICS_DB.dbt_ecommerce_features.device_type\n\nselect coalesce(a.user_id, b.user_id, c.user_id, d.user_id, e.user_id, f.user_id, g.user_id, h.user_id) \nas user_id, gender, c.country as country, c.state as state, email_domain, is_member, has_mobile_app, is_active_on_website, device_type\nfrom ((((((cte_gender a full outer join cte_age b on a.user_id = b.user_id) \nfull outer join cte_location c on c.user_id = coalesce(a.user_id, b.user_id))\nfull outer join cte_email_domain d on d.user_id = coalesce(a.user_id, b.user_id, c.user_id))\nfull outer join cte_is_member e on e.user_id = coalesce(a.user_id, b.user_id, c.user_id,d.user_id))\nfull outer join cte_has_mobile_app f on f.user_id = coalesce(a.user_id, b.user_id, c.user_id,d.user_id, e.user_id))\nfull outer join cte_is_active_on_website as g on g.user_id = coalesce(a.user_id, b.user_id, c.user_id,d.user_id, e.user_id, f.user_id))\nfull outer join cte_device_type as h on h.user_id = coalesce(a.user_id, b.user_id, c.user_id,d.user_id, e.user_id, f.user_id, g.user_id)\nlimit 500\n/* limit added automatically by dbt cloud */', 'tags': None}, None)
Traceback (most recent call last):
  File "/usr/local/lib/python3.8/dist-packages/dbt_rpc/task/sql_commands.py", line 147, in _in_thread
    self.node_results.append(runner.safe_run(self.manifest))
  File "/usr/local/lib/python3.8/dist-packages/dbt/task/base.py", line 377, in safe_run
    result = self.error_result(ctx.node, error, started, [])
  File "/usr/local/lib/python3.8/dist-packages/dbt_rpc/rpc/node_runners.py", line 56, in error_result
    raise error
dbt_rpc.rpc.error.RPCException: RPCException(10003, Database Error, {'type': 'DatabaseException', 'message': "Database Error in rpc request (from remote system)\n  001003 (42000): SQL compilation error:\n  syntax error line 1 at position 19 unexpected 'ANALYTICS_DB'.\n  syntax error line 1 at position 61 unexpected ','.\n  syntax error line 3 at position 11 unexpected 'ANALYTICS_DB'.\n  syntax error line 3 at position 50 unexpected ','.\n  syntax error line 5 at position 16 unexpected 'ANALYTICS_DB'.\n  syntax error line 5 at position 69 unexpected ','.\n  syntax error line 7 at position 20 unexpected 'ANALYTICS_DB'.\n  syntax error line 7 at position 68 unexpected ','.\n  syntax error line 9 at position 17 unexpected 'ANALYTICS_DB'.\n  syntax error line 9 at position 62 unexpected ','.\n  syntax error line 11 at position 22 unexpected 'ANALYTICS_DB'.\n  syntax error line 11 at position 72 unexpected ','.\n  syntax error line 13 at position 28 unexpected 'ANALYTICS_DB'.\n  syntax error line 13 at position 84 unexpected ','.\n  syntax error line 15 at position 19 unexpected 'ANALYTICS_DB'.\n  syntax error line 17 at position 16 unexpected 'a'.\n  syntax error line 18 at position 0 unexpected 'as'.", 'raw_sql': "with cte_gender as {{ ref('gender') }},\r\n\r\ncte_age as {{ ref('age') }},\r\n\r\ncte_location as {{ ref('country_and_state') }},\r\n\r\ncte_email_domain as {{ ref('email_domain') }},\r\n\r\ncte_is_member as {{ ref('is_member') }},\r\n\r\ncte_has_mobile_app as {{ ref('has_mobile_app') }},\r\n\r\ncte_is_active_on_website as {{ ref('is_active_on_website') }},\r\n\r\ncte_device_type as {{ ref('device_type') }}\r\n\r\nselect coalesce(a.user_id, b.user_id, c.user_id, d.user_id, e.user_id, f.user_id, g.user_id, h.user_id) \r\nas user_id, gender, c.country as country, c.state as state, email_domain, is_member, has_mobile_app, is_active_on_website, device_type\r\nfrom ((((((cte_gender a full outer join cte_age b on a.user_id = b.user_id) \r\nfull outer join cte_location c on c.user_id = coalesce(a.user_id, b.user_id))\r\nfull outer join cte_email_domain d on d.user_id = coalesce(a.user_id, b.user_id, c.user_id))\r\nfull outer join cte_is_member e on e.user_id = coalesce(a.user_id, b.user_id, c.user_id,d.user_id))\r\nfull outer join cte_has_mobile_app f on f.user_id = coalesce(a.user_id, b.user_id, c.user_id,d.user_id, e.user_id))\r\nfull outer join cte_is_active_on_website as g on g.user_id = coalesce(a.user_id, b.user_id, c.user_id,d.user_id, e.user_id, f.user_id))\r\nfull outer join cte_device_type as h on h.user_id = coalesce(a.user_id, b.user_id, c.user_id,d.user_id, e.user_id, f.user_id, g.user_id)\nlimit 500\n/* limit added automatically by dbt cloud */", 'compiled_sql': 'with cte_gender as ANALYTICS_DB.dbt_ecommerce_features.gender,\n\ncte_age as ANALYTICS_DB.dbt_ecommerce_features.age,\n\ncte_location as ANALYTICS_DB.dbt_ecommerce_features.country_and_state,\n\ncte_email_domain as ANALYTICS_DB.dbt_ecommerce_features.email_domain,\n\ncte_is_member as ANALYTICS_DB.dbt_ecommerce_features.is_member,\n\ncte_has_mobile_app as ANALYTICS_DB.dbt_ecommerce_features.has_mobile_app,\n\ncte_is_active_on_website as ANALYTICS_DB.dbt_ecommerce_features.is_active_on_website,\n\ncte_device_type as ANALYTICS_DB.dbt_ecommerce_features.device_type\n\nselect coalesce(a.user_id, b.user_id, c.user_id, d.user_id, e.user_id, f.user_id, g.user_id, h.user_id) \nas user_id, gender, c.country as country, c.state as state, email_domain, is_member, has_mobile_app, is_active_on_website, device_type\nfrom ((((((cte_gender a full outer join cte_age b on a.user_id = b.user_id) \nfull outer join cte_location c on c.user_id = coalesce(a.user_id, b.user_id))\nfull outer join cte_email_domain d on d.user_id = coalesce(a.user_id, b.user_id, c.user_id))\nfull outer join cte_is_member e on e.user_id = coalesce(a.user_id, b.user_id, c.user_id,d.user_id))\nfull outer join cte_has_mobile_app f on f.user_id = coalesce(a.user_id, b.user_id, c.user_id,d.user_id, e.user_id))\nfull outer join cte_is_active_on_website as g on g.user_id = coalesce(a.user_id, b.user_id, c.user_id,d.user_id, e.user_id, f.user_id))\nfull outer join cte_device_type as h on h.user_id = coalesce(a.user_id, b.user_id, c.user_id,d.user_id, e.user_id, f.user_id, g.user_id)\nlimit 500\n/* limit added automatically by dbt cloud */', 'tags': None}, None)
2022-07-07 09:00:17.883773 (Thread-98): handling poll request
2022-07-07 09:00:17.884265 (Thread-98): 09:00:17  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '8901092b-4e3c-4560-9d28-48dc5c91cc33', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9a2035af70>]}
2022-07-07 09:00:17.885036 (Thread-98): sending response (<Response 27039 bytes [200 OK]>) to 10.0.19.15
2022-07-07 09:02:07.723234 (Thread-99): handling status request
2022-07-07 09:02:07.725070 (Thread-99): 09:02:07  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '8901092b-4e3c-4560-9d28-48dc5c91cc33', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9a2032f190>]}
2022-07-07 09:02:07.725626 (Thread-99): sending response (<Response 1699 bytes [200 OK]>) to 10.0.19.15
2022-07-07 09:02:08.108763 (Thread-100): handling run_sql request
2022-07-07 09:02:08.109205 (Thread-100): 09:02:08  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '8901092b-4e3c-4560-9d28-48dc5c91cc33', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9a2032f3a0>]}
2022-07-07 09:02:10.465275 (Thread-100): sending response (<Response 139 bytes [200 OK]>) to 10.0.19.15
2022-07-07 09:02:10.493285 (MainThread): 09:02:10  Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'cbd586db-a765-4d72-9569-e8cbd59de437', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1b80d9ef10>]}
2022-07-07 09:02:10.493865 (MainThread): 09:02:10  Found 17 models, 0 tests, 0 snapshots, 0 analyses, 181 macros, 0 operations, 0 seed files, 15 sources, 0 exposures, 0 metrics
2022-07-07 09:02:10.494494 (Thread-1): 09:02:10  Acquiring new snowflake connection "rpc.ecommerce_data_model_dbt.request"
2022-07-07 09:02:10.494629 (Thread-1): 09:02:10  Began compiling node rpc.ecommerce_data_model_dbt.request
2022-07-07 09:02:10.494726 (Thread-1): 09:02:10  Compiling rpc.ecommerce_data_model_dbt.request
2022-07-07 09:02:10.498323 (Thread-1): 09:02:10  finished collecting timing info
2022-07-07 09:02:10.498457 (Thread-1): 09:02:10  Began executing node rpc.ecommerce_data_model_dbt.request
2022-07-07 09:02:10.500649 (Thread-1): 09:02:10  Using snowflake connection "rpc.ecommerce_data_model_dbt.request"
2022-07-07 09:02:10.500752 (Thread-1): 09:02:10  On rpc.ecommerce_data_model_dbt.request: with cte_gender as ANALYTICS_DB.dbt_ecommerce_features.gender,

cte_age as ANALYTICS_DB.dbt_ecommerce_features.age,

cte_location as ANALYTICS_DB.dbt_ecommerce_features.country_and_state,

cte_email_domain as ANALYTICS_DB.dbt_ecommerce_features.email_domain,

cte_is_member as ANALYTICS_DB.dbt_ecommerce_features.is_member,

cte_has_mobile_app as ANALYTICS_DB.dbt_ecommerce_features.has_mobile_app,

cte_is_active_on_website as ANALYTICS_DB.dbt_ecommerce_features.is_active_on_website,

cte_device_type as ANALYTICS_DB.dbt_ecommerce_features.device_type

select coalesce(a.user_id, b.user_id, c.user_id, d.user_id, e.user_id, f.user_id, g.user_id, h.user_id) 
as user_id, gender, c.country as country, c.state as state, email_domain, is_member, has_mobile_app, is_active_on_website, device_type
from ((((((cte_gender a full outer join cte_age b on a.user_id = b.user_id) 
full outer join cte_location c on c.user_id = coalesce(a.user_id, b.user_id))
full outer join cte_email_domain d on d.user_id = coalesce(a.user_id, b.user_id, c.user_id))
full outer join cte_is_member e on e.user_id = coalesce(a.user_id, b.user_id, c.user_id,d.user_id))
full outer join cte_has_mobile_app f on f.user_id = coalesce(a.user_id, b.user_id, c.user_id,d.user_id, e.user_id))
full outer join cte_is_active_on_website as g on g.user_id = coalesce(a.user_id, b.user_id, c.user_id,d.user_id, e.user_id, f.user_id))
full outer join cte_device_type as h on h.user_id = coalesce(a.user_id, b.user_id, c.user_id,d.user_id, e.user_id, f.user_id, g.user_id)
limit 500
/* limit added automatically by dbt cloud */
2022-07-07 09:02:10.500865 (Thread-1): 09:02:10  Opening a new connection, currently in state init
2022-07-07 09:02:10.825872 (Thread-101): handling poll request
2022-07-07 09:02:10.826380 (Thread-101): 09:02:10  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '8901092b-4e3c-4560-9d28-48dc5c91cc33', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9a203bb370>]}
2022-07-07 09:02:10.827299 (Thread-101): sending response (<Response 5341 bytes [200 OK]>) to 10.0.19.15
2022-07-07 09:02:12.205404 (Thread-102): handling poll request
2022-07-07 09:02:12.205820 (Thread-102): 09:02:12  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '8901092b-4e3c-4560-9d28-48dc5c91cc33', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9a203bb550>]}
2022-07-07 09:02:12.206341 (Thread-102): sending response (<Response 403 bytes [200 OK]>) to 10.0.19.15
2022-07-07 09:02:12.237127 (Thread-1): 09:02:12  Snowflake adapter: Snowflake query id: 01a5719e-0602-3441-0019-8203046b4dee
2022-07-07 09:02:12.237361 (Thread-1): 09:02:12  Snowflake adapter: Snowflake error: 001003 (42000): SQL compilation error:
syntax error line 1 at position 19 unexpected 'ANALYTICS_DB'.
syntax error line 1 at position 61 unexpected ','.
syntax error line 3 at position 11 unexpected 'ANALYTICS_DB'.
syntax error line 3 at position 50 unexpected ','.
syntax error line 5 at position 16 unexpected 'ANALYTICS_DB'.
syntax error line 5 at position 69 unexpected ','.
syntax error line 7 at position 20 unexpected 'ANALYTICS_DB'.
syntax error line 7 at position 68 unexpected ','.
syntax error line 9 at position 17 unexpected 'ANALYTICS_DB'.
syntax error line 9 at position 62 unexpected ','.
syntax error line 11 at position 22 unexpected 'ANALYTICS_DB'.
syntax error line 11 at position 72 unexpected ','.
syntax error line 13 at position 28 unexpected 'ANALYTICS_DB'.
syntax error line 13 at position 84 unexpected ','.
syntax error line 15 at position 19 unexpected 'ANALYTICS_DB'.
syntax error line 17 at position 16 unexpected 'a'.
syntax error line 18 at position 0 unexpected 'as'.
2022-07-07 09:02:12.237562 (Thread-1): 09:02:12  finished collecting timing info
2022-07-07 09:02:12.237742 (Thread-1): 09:02:12  On rpc.ecommerce_data_model_dbt.request: Close
2022-07-07 09:02:12.682700 (Thread-1): Got an exception: Database Error
  001003 (42000): SQL compilation error:
  syntax error line 1 at position 19 unexpected 'ANALYTICS_DB'.
  syntax error line 1 at position 61 unexpected ','.
  syntax error line 3 at position 11 unexpected 'ANALYTICS_DB'.
  syntax error line 3 at position 50 unexpected ','.
  syntax error line 5 at position 16 unexpected 'ANALYTICS_DB'.
  syntax error line 5 at position 69 unexpected ','.
  syntax error line 7 at position 20 unexpected 'ANALYTICS_DB'.
  syntax error line 7 at position 68 unexpected ','.
  syntax error line 9 at position 17 unexpected 'ANALYTICS_DB'.
  syntax error line 9 at position 62 unexpected ','.
  syntax error line 11 at position 22 unexpected 'ANALYTICS_DB'.
  syntax error line 11 at position 72 unexpected ','.
  syntax error line 13 at position 28 unexpected 'ANALYTICS_DB'.
  syntax error line 13 at position 84 unexpected ','.
  syntax error line 15 at position 19 unexpected 'ANALYTICS_DB'.
  syntax error line 17 at position 16 unexpected 'a'.
  syntax error line 18 at position 0 unexpected 'as'.
Traceback (most recent call last):
  File "/usr/local/lib/python3.8/dist-packages/dbt/adapters/snowflake/connections.py", line 206, in exception_handler
    yield
  File "/usr/local/lib/python3.8/dist-packages/dbt/adapters/sql/connections.py", line 74, in add_query
    cursor.execute(sql, bindings)
  File "/usr/local/lib/python3.8/dist-packages/snowflake/connector/cursor.py", line 721, in execute
    Error.errorhandler_wrapper(
  File "/usr/local/lib/python3.8/dist-packages/snowflake/connector/errors.py", line 258, in errorhandler_wrapper
    cursor.errorhandler(connection, cursor, error_class, error_value)
  File "/usr/local/lib/python3.8/dist-packages/snowflake/connector/errors.py", line 188, in default_errorhandler
    raise error_class(
snowflake.connector.errors.ProgrammingError: 001003 (42000): SQL compilation error:
syntax error line 1 at position 19 unexpected 'ANALYTICS_DB'.
syntax error line 1 at position 61 unexpected ','.
syntax error line 3 at position 11 unexpected 'ANALYTICS_DB'.
syntax error line 3 at position 50 unexpected ','.
syntax error line 5 at position 16 unexpected 'ANALYTICS_DB'.
syntax error line 5 at position 69 unexpected ','.
syntax error line 7 at position 20 unexpected 'ANALYTICS_DB'.
syntax error line 7 at position 68 unexpected ','.
syntax error line 9 at position 17 unexpected 'ANALYTICS_DB'.
syntax error line 9 at position 62 unexpected ','.
syntax error line 11 at position 22 unexpected 'ANALYTICS_DB'.
syntax error line 11 at position 72 unexpected ','.
syntax error line 13 at position 28 unexpected 'ANALYTICS_DB'.
syntax error line 13 at position 84 unexpected ','.
syntax error line 15 at position 19 unexpected 'ANALYTICS_DB'.
syntax error line 17 at position 16 unexpected 'a'.
syntax error line 18 at position 0 unexpected 'as'.

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/usr/local/lib/python3.8/dist-packages/dbt/task/base.py", line 361, in safe_run
    result = self.compile_and_execute(manifest, ctx)
  File "/usr/local/lib/python3.8/dist-packages/dbt/task/base.py", line 314, in compile_and_execute
    result = self.run(ctx.node, manifest)
  File "/usr/local/lib/python3.8/dist-packages/dbt/task/base.py", line 403, in run
    return self.execute(compiled_node, manifest)
  File "/usr/local/lib/python3.8/dist-packages/dbt_rpc/rpc/node_runners.py", line 90, in execute
    _, execute_result = self.adapter.execute(
  File "/usr/local/lib/python3.8/dist-packages/dbt/adapters/base/impl.py", line 225, in execute
    return self.connections.execute(
  File "/usr/local/lib/python3.8/dist-packages/dbt/adapters/sql/connections.py", line 127, in execute
    _, cursor = self.add_query(sql, auto_begin)
  File "/usr/local/lib/python3.8/dist-packages/dbt/adapters/snowflake/connections.py", line 433, in add_query
    connection, cursor = super().add_query(
  File "/usr/local/lib/python3.8/dist-packages/dbt/adapters/sql/connections.py", line 83, in add_query
    return connection, cursor
  File "/usr/lib/python3.8/contextlib.py", line 131, in __exit__
    self.gen.throw(type, value, traceback)
  File "/usr/local/lib/python3.8/dist-packages/dbt/adapters/snowflake/connections.py", line 223, in exception_handler
    raise DatabaseException(msg)
dbt.exceptions.DatabaseException: Database Error
  001003 (42000): SQL compilation error:
  syntax error line 1 at position 19 unexpected 'ANALYTICS_DB'.
  syntax error line 1 at position 61 unexpected ','.
  syntax error line 3 at position 11 unexpected 'ANALYTICS_DB'.
  syntax error line 3 at position 50 unexpected ','.
  syntax error line 5 at position 16 unexpected 'ANALYTICS_DB'.
  syntax error line 5 at position 69 unexpected ','.
  syntax error line 7 at position 20 unexpected 'ANALYTICS_DB'.
  syntax error line 7 at position 68 unexpected ','.
  syntax error line 9 at position 17 unexpected 'ANALYTICS_DB'.
  syntax error line 9 at position 62 unexpected ','.
  syntax error line 11 at position 22 unexpected 'ANALYTICS_DB'.
  syntax error line 11 at position 72 unexpected ','.
  syntax error line 13 at position 28 unexpected 'ANALYTICS_DB'.
  syntax error line 13 at position 84 unexpected ','.
  syntax error line 15 at position 19 unexpected 'ANALYTICS_DB'.
  syntax error line 17 at position 16 unexpected 'a'.
  syntax error line 18 at position 0 unexpected 'as'.
2022-07-07 09:02:12.683503 (Thread-1): Got exception RPCException(10003, Database Error, {'type': 'DatabaseException', 'message': "Database Error in rpc request (from remote system)\n  001003 (42000): SQL compilation error:\n  syntax error line 1 at position 19 unexpected 'ANALYTICS_DB'.\n  syntax error line 1 at position 61 unexpected ','.\n  syntax error line 3 at position 11 unexpected 'ANALYTICS_DB'.\n  syntax error line 3 at position 50 unexpected ','.\n  syntax error line 5 at position 16 unexpected 'ANALYTICS_DB'.\n  syntax error line 5 at position 69 unexpected ','.\n  syntax error line 7 at position 20 unexpected 'ANALYTICS_DB'.\n  syntax error line 7 at position 68 unexpected ','.\n  syntax error line 9 at position 17 unexpected 'ANALYTICS_DB'.\n  syntax error line 9 at position 62 unexpected ','.\n  syntax error line 11 at position 22 unexpected 'ANALYTICS_DB'.\n  syntax error line 11 at position 72 unexpected ','.\n  syntax error line 13 at position 28 unexpected 'ANALYTICS_DB'.\n  syntax error line 13 at position 84 unexpected ','.\n  syntax error line 15 at position 19 unexpected 'ANALYTICS_DB'.\n  syntax error line 17 at position 16 unexpected 'a'.\n  syntax error line 18 at position 0 unexpected 'as'.", 'raw_sql': "with cte_gender as {{ ref('gender') }},\r\n\r\ncte_age as {{ ref('age') }},\r\n\r\ncte_location as {{ ref('country_and_state') }},\r\n\r\ncte_email_domain as {{ ref('email_domain') }},\r\n\r\ncte_is_member as {{ ref('is_member') }},\r\n\r\ncte_has_mobile_app as {{ ref('has_mobile_app') }},\r\n\r\ncte_is_active_on_website as {{ ref('is_active_on_website') }},\r\n\r\ncte_device_type as {{ ref('device_type') }}\r\n\r\nselect coalesce(a.user_id, b.user_id, c.user_id, d.user_id, e.user_id, f.user_id, g.user_id, h.user_id) \r\nas user_id, gender, c.country as country, c.state as state, email_domain, is_member, has_mobile_app, is_active_on_website, device_type\r\nfrom ((((((cte_gender a full outer join cte_age b on a.user_id = b.user_id) \r\nfull outer join cte_location c on c.user_id = coalesce(a.user_id, b.user_id))\r\nfull outer join cte_email_domain d on d.user_id = coalesce(a.user_id, b.user_id, c.user_id))\r\nfull outer join cte_is_member e on e.user_id = coalesce(a.user_id, b.user_id, c.user_id,d.user_id))\r\nfull outer join cte_has_mobile_app f on f.user_id = coalesce(a.user_id, b.user_id, c.user_id,d.user_id, e.user_id))\r\nfull outer join cte_is_active_on_website as g on g.user_id = coalesce(a.user_id, b.user_id, c.user_id,d.user_id, e.user_id, f.user_id))\r\nfull outer join cte_device_type as h on h.user_id = coalesce(a.user_id, b.user_id, c.user_id,d.user_id, e.user_id, f.user_id, g.user_id)\nlimit 500\n/* limit added automatically by dbt cloud */", 'compiled_sql': 'with cte_gender as ANALYTICS_DB.dbt_ecommerce_features.gender,\n\ncte_age as ANALYTICS_DB.dbt_ecommerce_features.age,\n\ncte_location as ANALYTICS_DB.dbt_ecommerce_features.country_and_state,\n\ncte_email_domain as ANALYTICS_DB.dbt_ecommerce_features.email_domain,\n\ncte_is_member as ANALYTICS_DB.dbt_ecommerce_features.is_member,\n\ncte_has_mobile_app as ANALYTICS_DB.dbt_ecommerce_features.has_mobile_app,\n\ncte_is_active_on_website as ANALYTICS_DB.dbt_ecommerce_features.is_active_on_website,\n\ncte_device_type as ANALYTICS_DB.dbt_ecommerce_features.device_type\n\nselect coalesce(a.user_id, b.user_id, c.user_id, d.user_id, e.user_id, f.user_id, g.user_id, h.user_id) \nas user_id, gender, c.country as country, c.state as state, email_domain, is_member, has_mobile_app, is_active_on_website, device_type\nfrom ((((((cte_gender a full outer join cte_age b on a.user_id = b.user_id) \nfull outer join cte_location c on c.user_id = coalesce(a.user_id, b.user_id))\nfull outer join cte_email_domain d on d.user_id = coalesce(a.user_id, b.user_id, c.user_id))\nfull outer join cte_is_member e on e.user_id = coalesce(a.user_id, b.user_id, c.user_id,d.user_id))\nfull outer join cte_has_mobile_app f on f.user_id = coalesce(a.user_id, b.user_id, c.user_id,d.user_id, e.user_id))\nfull outer join cte_is_active_on_website as g on g.user_id = coalesce(a.user_id, b.user_id, c.user_id,d.user_id, e.user_id, f.user_id))\nfull outer join cte_device_type as h on h.user_id = coalesce(a.user_id, b.user_id, c.user_id,d.user_id, e.user_id, f.user_id, g.user_id)\nlimit 500\n/* limit added automatically by dbt cloud */', 'tags': None}, None)
Traceback (most recent call last):
  File "/usr/local/lib/python3.8/dist-packages/dbt_rpc/task/sql_commands.py", line 147, in _in_thread
    self.node_results.append(runner.safe_run(self.manifest))
  File "/usr/local/lib/python3.8/dist-packages/dbt/task/base.py", line 377, in safe_run
    result = self.error_result(ctx.node, error, started, [])
  File "/usr/local/lib/python3.8/dist-packages/dbt_rpc/rpc/node_runners.py", line 56, in error_result
    raise error
dbt_rpc.rpc.error.RPCException: RPCException(10003, Database Error, {'type': 'DatabaseException', 'message': "Database Error in rpc request (from remote system)\n  001003 (42000): SQL compilation error:\n  syntax error line 1 at position 19 unexpected 'ANALYTICS_DB'.\n  syntax error line 1 at position 61 unexpected ','.\n  syntax error line 3 at position 11 unexpected 'ANALYTICS_DB'.\n  syntax error line 3 at position 50 unexpected ','.\n  syntax error line 5 at position 16 unexpected 'ANALYTICS_DB'.\n  syntax error line 5 at position 69 unexpected ','.\n  syntax error line 7 at position 20 unexpected 'ANALYTICS_DB'.\n  syntax error line 7 at position 68 unexpected ','.\n  syntax error line 9 at position 17 unexpected 'ANALYTICS_DB'.\n  syntax error line 9 at position 62 unexpected ','.\n  syntax error line 11 at position 22 unexpected 'ANALYTICS_DB'.\n  syntax error line 11 at position 72 unexpected ','.\n  syntax error line 13 at position 28 unexpected 'ANALYTICS_DB'.\n  syntax error line 13 at position 84 unexpected ','.\n  syntax error line 15 at position 19 unexpected 'ANALYTICS_DB'.\n  syntax error line 17 at position 16 unexpected 'a'.\n  syntax error line 18 at position 0 unexpected 'as'.", 'raw_sql': "with cte_gender as {{ ref('gender') }},\r\n\r\ncte_age as {{ ref('age') }},\r\n\r\ncte_location as {{ ref('country_and_state') }},\r\n\r\ncte_email_domain as {{ ref('email_domain') }},\r\n\r\ncte_is_member as {{ ref('is_member') }},\r\n\r\ncte_has_mobile_app as {{ ref('has_mobile_app') }},\r\n\r\ncte_is_active_on_website as {{ ref('is_active_on_website') }},\r\n\r\ncte_device_type as {{ ref('device_type') }}\r\n\r\nselect coalesce(a.user_id, b.user_id, c.user_id, d.user_id, e.user_id, f.user_id, g.user_id, h.user_id) \r\nas user_id, gender, c.country as country, c.state as state, email_domain, is_member, has_mobile_app, is_active_on_website, device_type\r\nfrom ((((((cte_gender a full outer join cte_age b on a.user_id = b.user_id) \r\nfull outer join cte_location c on c.user_id = coalesce(a.user_id, b.user_id))\r\nfull outer join cte_email_domain d on d.user_id = coalesce(a.user_id, b.user_id, c.user_id))\r\nfull outer join cte_is_member e on e.user_id = coalesce(a.user_id, b.user_id, c.user_id,d.user_id))\r\nfull outer join cte_has_mobile_app f on f.user_id = coalesce(a.user_id, b.user_id, c.user_id,d.user_id, e.user_id))\r\nfull outer join cte_is_active_on_website as g on g.user_id = coalesce(a.user_id, b.user_id, c.user_id,d.user_id, e.user_id, f.user_id))\r\nfull outer join cte_device_type as h on h.user_id = coalesce(a.user_id, b.user_id, c.user_id,d.user_id, e.user_id, f.user_id, g.user_id)\nlimit 500\n/* limit added automatically by dbt cloud */", 'compiled_sql': 'with cte_gender as ANALYTICS_DB.dbt_ecommerce_features.gender,\n\ncte_age as ANALYTICS_DB.dbt_ecommerce_features.age,\n\ncte_location as ANALYTICS_DB.dbt_ecommerce_features.country_and_state,\n\ncte_email_domain as ANALYTICS_DB.dbt_ecommerce_features.email_domain,\n\ncte_is_member as ANALYTICS_DB.dbt_ecommerce_features.is_member,\n\ncte_has_mobile_app as ANALYTICS_DB.dbt_ecommerce_features.has_mobile_app,\n\ncte_is_active_on_website as ANALYTICS_DB.dbt_ecommerce_features.is_active_on_website,\n\ncte_device_type as ANALYTICS_DB.dbt_ecommerce_features.device_type\n\nselect coalesce(a.user_id, b.user_id, c.user_id, d.user_id, e.user_id, f.user_id, g.user_id, h.user_id) \nas user_id, gender, c.country as country, c.state as state, email_domain, is_member, has_mobile_app, is_active_on_website, device_type\nfrom ((((((cte_gender a full outer join cte_age b on a.user_id = b.user_id) \nfull outer join cte_location c on c.user_id = coalesce(a.user_id, b.user_id))\nfull outer join cte_email_domain d on d.user_id = coalesce(a.user_id, b.user_id, c.user_id))\nfull outer join cte_is_member e on e.user_id = coalesce(a.user_id, b.user_id, c.user_id,d.user_id))\nfull outer join cte_has_mobile_app f on f.user_id = coalesce(a.user_id, b.user_id, c.user_id,d.user_id, e.user_id))\nfull outer join cte_is_active_on_website as g on g.user_id = coalesce(a.user_id, b.user_id, c.user_id,d.user_id, e.user_id, f.user_id))\nfull outer join cte_device_type as h on h.user_id = coalesce(a.user_id, b.user_id, c.user_id,d.user_id, e.user_id, f.user_id, g.user_id)\nlimit 500\n/* limit added automatically by dbt cloud */', 'tags': None}, None)
2022-07-07 09:02:13.713521 (Thread-103): handling poll request
2022-07-07 09:02:13.713949 (Thread-103): 09:02:13  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '8901092b-4e3c-4560-9d28-48dc5c91cc33', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9a203bb7f0>]}
2022-07-07 09:02:13.714654 (Thread-103): sending response (<Response 27039 bytes [200 OK]>) to 10.0.19.15
2022-07-07 09:10:57.320625 (Thread-104): 09:10:57  Partial parsing enabled: 1 files deleted, 1 files added, 0 files changed.
2022-07-07 09:10:57.322646 (Thread-104): 09:10:57  Partial parsing: added file: ecommerce_data_model_dbt://models/data_model/stg_traits/country_and_state_new.sql
2022-07-07 09:10:57.322815 (Thread-104): 09:10:57  Partial parsing: deleted file: ecommerce_data_model_dbt://models/data_model/stg_traits/state.sql
2022-07-07 09:10:57.327549 (Thread-104): 09:10:57  1603: static parser failed on data_model/stg_traits/country_and_state_new.sql
2022-07-07 09:10:57.331786 (Thread-104): 09:10:57  1602: parser fallback to jinja rendering on data_model/stg_traits/country_and_state_new.sql
2022-07-07 09:10:57.382833 (Thread-104): 09:10:57  [WARNING]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.data-apps-ecommerce-template.data_model

2022-07-07 09:10:57.388207 (Thread-104): 09:10:57  Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '8901092b-4e3c-4560-9d28-48dc5c91cc33', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9a2026ba90>]}
2022-07-07 09:10:58.136568 (Thread-105): handling status request
2022-07-07 09:10:58.137103 (Thread-105): 09:10:58  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '8901092b-4e3c-4560-9d28-48dc5c91cc33', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9a2036c700>]}
2022-07-07 09:10:58.137690 (Thread-105): sending response (<Response 2744 bytes [200 OK]>) to 10.0.19.15
2022-07-07 09:10:58.186088 (Thread-106): handling status request
2022-07-07 09:10:58.186443 (Thread-106): 09:10:58  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '8901092b-4e3c-4560-9d28-48dc5c91cc33', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9a20324df0>]}
2022-07-07 09:10:58.186928 (Thread-106): sending response (<Response 2744 bytes [200 OK]>) to 10.0.19.15
2022-07-07 09:11:04.658794 (Thread-107): handling status request
2022-07-07 09:11:04.659195 (Thread-107): 09:11:04  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '8901092b-4e3c-4560-9d28-48dc5c91cc33', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9a20324dc0>]}
2022-07-07 09:11:04.659692 (Thread-107): sending response (<Response 2744 bytes [200 OK]>) to 10.0.19.15
2022-07-07 09:11:05.081968 (Thread-108): handling run_sql request
2022-07-07 09:11:05.082401 (Thread-108): 09:11:05  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '8901092b-4e3c-4560-9d28-48dc5c91cc33', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9a20324b50>]}
2022-07-07 09:11:07.449657 (Thread-108): sending response (<Response 139 bytes [200 OK]>) to 10.0.19.15
2022-07-07 09:11:07.474991 (MainThread): 09:11:07  Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'b696015f-913c-44c7-9f04-c9521a6e83cb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f513cee5040>]}
2022-07-07 09:11:07.475523 (MainThread): 09:11:07  Found 17 models, 0 tests, 0 snapshots, 0 analyses, 181 macros, 0 operations, 0 seed files, 15 sources, 0 exposures, 0 metrics
2022-07-07 09:11:07.476121 (Thread-1): 09:11:07  Acquiring new snowflake connection "rpc.ecommerce_data_model_dbt.request"
2022-07-07 09:11:07.476259 (Thread-1): 09:11:07  Began compiling node rpc.ecommerce_data_model_dbt.request
2022-07-07 09:11:07.476356 (Thread-1): 09:11:07  Compiling rpc.ecommerce_data_model_dbt.request
2022-07-07 09:11:07.478956 (Thread-1): 09:11:07  finished collecting timing info
2022-07-07 09:11:07.479110 (Thread-1): 09:11:07  Began executing node rpc.ecommerce_data_model_dbt.request
2022-07-07 09:11:07.480461 (Thread-1): 09:11:07  Using snowflake connection "rpc.ecommerce_data_model_dbt.request"
2022-07-07 09:11:07.480555 (Thread-1): 09:11:07  On rpc.ecommerce_data_model_dbt.request: with cte_id_stitched_identifies as 
(select distinct b.main_id as main_id, properties_country, properties_state, timestamp from analytics_db.data_apps_simulated.identifies a left join 
ANALYTICS_DB.DATA_APPS_SIMULATED.MATERIAL_DOMAIN_PROFILE__IDSTITCHER_DC3F9DA0_12 b 
on (a.user_id = b.other_id and b.other_id_type = 'user_id') or (a.properties_email = b.other_id and b.other_id_type = 'email'))
select distinct main_id, 
first_value(properties_country)
over(partition by main_id order by case when properties_country is not null and properties_country != '' then 2 else 1 end desc, timestamp desc) as country,
first_value(properties_state)
over(partition by main_id order by case when properties_state is not null and properties_state != '' then 2 else 1 end desc, timestamp desc) as state
from cte_id_stitched_identifies where timestamp >= '2021-05-01' and timestamp <= '2022-06-29' where main_id is not null
limit 500
/* limit added automatically by dbt cloud */
2022-07-07 09:11:07.480637 (Thread-1): 09:11:07  Opening a new connection, currently in state init
2022-07-07 09:11:07.834742 (Thread-109): handling poll request
2022-07-07 09:11:07.835220 (Thread-109): 09:11:07  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '8901092b-4e3c-4560-9d28-48dc5c91cc33', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9a2022feb0>]}
2022-07-07 09:11:07.836130 (Thread-109): sending response (<Response 4719 bytes [200 OK]>) to 10.0.19.15
2022-07-07 09:11:08.161824 (Thread-1): 09:11:08  Snowflake adapter: Snowflake query id: 01a571a7-0602-33c1-0019-8203046b6b86
2022-07-07 09:11:08.162028 (Thread-1): 09:11:08  Snowflake adapter: Snowflake error: 001003 (42000): SQL compilation error:
syntax error line 10 at position 94 unexpected 'where'.
2022-07-07 09:11:08.162196 (Thread-1): 09:11:08  finished collecting timing info
2022-07-07 09:11:08.162364 (Thread-1): 09:11:08  On rpc.ecommerce_data_model_dbt.request: Close
2022-07-07 09:11:08.237702 (Thread-1): Got an exception: Database Error
  001003 (42000): SQL compilation error:
  syntax error line 10 at position 94 unexpected 'where'.
Traceback (most recent call last):
  File "/usr/local/lib/python3.8/dist-packages/dbt/adapters/snowflake/connections.py", line 206, in exception_handler
    yield
  File "/usr/local/lib/python3.8/dist-packages/dbt/adapters/sql/connections.py", line 74, in add_query
    cursor.execute(sql, bindings)
  File "/usr/local/lib/python3.8/dist-packages/snowflake/connector/cursor.py", line 721, in execute
    Error.errorhandler_wrapper(
  File "/usr/local/lib/python3.8/dist-packages/snowflake/connector/errors.py", line 258, in errorhandler_wrapper
    cursor.errorhandler(connection, cursor, error_class, error_value)
  File "/usr/local/lib/python3.8/dist-packages/snowflake/connector/errors.py", line 188, in default_errorhandler
    raise error_class(
snowflake.connector.errors.ProgrammingError: 001003 (42000): SQL compilation error:
syntax error line 10 at position 94 unexpected 'where'.

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/usr/local/lib/python3.8/dist-packages/dbt/task/base.py", line 361, in safe_run
    result = self.compile_and_execute(manifest, ctx)
  File "/usr/local/lib/python3.8/dist-packages/dbt/task/base.py", line 314, in compile_and_execute
    result = self.run(ctx.node, manifest)
  File "/usr/local/lib/python3.8/dist-packages/dbt/task/base.py", line 403, in run
    return self.execute(compiled_node, manifest)
  File "/usr/local/lib/python3.8/dist-packages/dbt_rpc/rpc/node_runners.py", line 90, in execute
    _, execute_result = self.adapter.execute(
  File "/usr/local/lib/python3.8/dist-packages/dbt/adapters/base/impl.py", line 225, in execute
    return self.connections.execute(
  File "/usr/local/lib/python3.8/dist-packages/dbt/adapters/sql/connections.py", line 127, in execute
    _, cursor = self.add_query(sql, auto_begin)
  File "/usr/local/lib/python3.8/dist-packages/dbt/adapters/snowflake/connections.py", line 433, in add_query
    connection, cursor = super().add_query(
  File "/usr/local/lib/python3.8/dist-packages/dbt/adapters/sql/connections.py", line 83, in add_query
    return connection, cursor
  File "/usr/lib/python3.8/contextlib.py", line 131, in __exit__
    self.gen.throw(type, value, traceback)
  File "/usr/local/lib/python3.8/dist-packages/dbt/adapters/snowflake/connections.py", line 223, in exception_handler
    raise DatabaseException(msg)
dbt.exceptions.DatabaseException: Database Error
  001003 (42000): SQL compilation error:
  syntax error line 10 at position 94 unexpected 'where'.
2022-07-07 09:11:08.238605 (Thread-1): Got exception RPCException(10003, Database Error, {'type': 'DatabaseException', 'message': "Database Error in rpc request (from remote system)\n  001003 (42000): SQL compilation error:\n  syntax error line 10 at position 94 unexpected 'where'.", 'raw_sql': "with cte_id_stitched_identifies as \r\n(select distinct b.main_id as main_id, properties_country, properties_state, timestamp from {{ source('ecommerce', 'identifies') }} a left join \r\nANALYTICS_DB.DATA_APPS_SIMULATED.MATERIAL_DOMAIN_PROFILE__IDSTITCHER_DC3F9DA0_12 b \r\non (a.user_id = b.other_id and b.other_id_type = 'user_id') or (a.properties_email = b.other_id and b.other_id_type = 'email'))\r\nselect distinct main_id, \r\nfirst_value(properties_country)\r\nover(partition by main_id order by case when properties_country is not null and properties_country != '' then 2 else 1 end desc, timestamp desc) as country,\r\nfirst_value(properties_state)\r\nover(partition by main_id order by case when properties_state is not null and properties_state != '' then 2 else 1 end desc, timestamp desc) as state\r\nfrom cte_id_stitched_identifies where timestamp >= '{{ var('start_date') }}' and timestamp <= '{{ var('end_date') }}' where main_id is not null\nlimit 500\n/* limit added automatically by dbt cloud */", 'compiled_sql': "with cte_id_stitched_identifies as \n(select distinct b.main_id as main_id, properties_country, properties_state, timestamp from analytics_db.data_apps_simulated.identifies a left join \nANALYTICS_DB.DATA_APPS_SIMULATED.MATERIAL_DOMAIN_PROFILE__IDSTITCHER_DC3F9DA0_12 b \non (a.user_id = b.other_id and b.other_id_type = 'user_id') or (a.properties_email = b.other_id and b.other_id_type = 'email'))\nselect distinct main_id, \nfirst_value(properties_country)\nover(partition by main_id order by case when properties_country is not null and properties_country != '' then 2 else 1 end desc, timestamp desc) as country,\nfirst_value(properties_state)\nover(partition by main_id order by case when properties_state is not null and properties_state != '' then 2 else 1 end desc, timestamp desc) as state\nfrom cte_id_stitched_identifies where timestamp >= '2021-05-01' and timestamp <= '2022-06-29' where main_id is not null\nlimit 500\n/* limit added automatically by dbt cloud */", 'tags': None}, None)
Traceback (most recent call last):
  File "/usr/local/lib/python3.8/dist-packages/dbt_rpc/task/sql_commands.py", line 147, in _in_thread
    self.node_results.append(runner.safe_run(self.manifest))
  File "/usr/local/lib/python3.8/dist-packages/dbt/task/base.py", line 377, in safe_run
    result = self.error_result(ctx.node, error, started, [])
  File "/usr/local/lib/python3.8/dist-packages/dbt_rpc/rpc/node_runners.py", line 56, in error_result
    raise error
dbt_rpc.rpc.error.RPCException: RPCException(10003, Database Error, {'type': 'DatabaseException', 'message': "Database Error in rpc request (from remote system)\n  001003 (42000): SQL compilation error:\n  syntax error line 10 at position 94 unexpected 'where'.", 'raw_sql': "with cte_id_stitched_identifies as \r\n(select distinct b.main_id as main_id, properties_country, properties_state, timestamp from {{ source('ecommerce', 'identifies') }} a left join \r\nANALYTICS_DB.DATA_APPS_SIMULATED.MATERIAL_DOMAIN_PROFILE__IDSTITCHER_DC3F9DA0_12 b \r\non (a.user_id = b.other_id and b.other_id_type = 'user_id') or (a.properties_email = b.other_id and b.other_id_type = 'email'))\r\nselect distinct main_id, \r\nfirst_value(properties_country)\r\nover(partition by main_id order by case when properties_country is not null and properties_country != '' then 2 else 1 end desc, timestamp desc) as country,\r\nfirst_value(properties_state)\r\nover(partition by main_id order by case when properties_state is not null and properties_state != '' then 2 else 1 end desc, timestamp desc) as state\r\nfrom cte_id_stitched_identifies where timestamp >= '{{ var('start_date') }}' and timestamp <= '{{ var('end_date') }}' where main_id is not null\nlimit 500\n/* limit added automatically by dbt cloud */", 'compiled_sql': "with cte_id_stitched_identifies as \n(select distinct b.main_id as main_id, properties_country, properties_state, timestamp from analytics_db.data_apps_simulated.identifies a left join \nANALYTICS_DB.DATA_APPS_SIMULATED.MATERIAL_DOMAIN_PROFILE__IDSTITCHER_DC3F9DA0_12 b \non (a.user_id = b.other_id and b.other_id_type = 'user_id') or (a.properties_email = b.other_id and b.other_id_type = 'email'))\nselect distinct main_id, \nfirst_value(properties_country)\nover(partition by main_id order by case when properties_country is not null and properties_country != '' then 2 else 1 end desc, timestamp desc) as country,\nfirst_value(properties_state)\nover(partition by main_id order by case when properties_state is not null and properties_state != '' then 2 else 1 end desc, timestamp desc) as state\nfrom cte_id_stitched_identifies where timestamp >= '2021-05-01' and timestamp <= '2022-06-29' where main_id is not null\nlimit 500\n/* limit added automatically by dbt cloud */", 'tags': None}, None)
2022-07-07 09:11:09.254207 (Thread-110): handling poll request
2022-07-07 09:11:09.254617 (Thread-110): 09:11:09  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '8901092b-4e3c-4560-9d28-48dc5c91cc33', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9a2022fcd0>]}
2022-07-07 09:11:09.255273 (Thread-110): sending response (<Response 16397 bytes [200 OK]>) to 10.0.19.15
2022-07-07 09:11:25.595191 (Thread-111): 09:11:25  Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
2022-07-07 09:11:25.595763 (Thread-111): 09:11:25  Partial parsing: updated file: ecommerce_data_model_dbt://models/data_model/stg_traits/country_and_state_new.sql
2022-07-07 09:11:25.599783 (Thread-111): 09:11:25  1603: static parser failed on data_model/stg_traits/country_and_state_new.sql
2022-07-07 09:11:25.603780 (Thread-111): 09:11:25  1602: parser fallback to jinja rendering on data_model/stg_traits/country_and_state_new.sql
2022-07-07 09:11:25.643463 (Thread-111): 09:11:25  [WARNING]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.data-apps-ecommerce-template.data_model

2022-07-07 09:11:25.649251 (Thread-111): 09:11:25  Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '8901092b-4e3c-4560-9d28-48dc5c91cc33', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9a286a2520>]}
2022-07-07 09:11:26.345876 (Thread-112): handling status request
2022-07-07 09:11:26.346328 (Thread-112): 09:11:26  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '8901092b-4e3c-4560-9d28-48dc5c91cc33', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9a2025c0a0>]}
2022-07-07 09:11:26.346846 (Thread-112): sending response (<Response 2408 bytes [200 OK]>) to 10.0.19.15
2022-07-07 09:11:26.377418 (Thread-113): handling status request
2022-07-07 09:11:26.377842 (Thread-113): 09:11:26  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '8901092b-4e3c-4560-9d28-48dc5c91cc33', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9a5c389d00>]}
2022-07-07 09:11:26.378365 (Thread-113): sending response (<Response 2408 bytes [200 OK]>) to 10.0.19.15
2022-07-07 09:11:27.669327 (Thread-114): handling status request
2022-07-07 09:11:27.669745 (Thread-114): 09:11:27  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '8901092b-4e3c-4560-9d28-48dc5c91cc33', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9a203fe820>]}
2022-07-07 09:11:27.670249 (Thread-114): sending response (<Response 2408 bytes [200 OK]>) to 10.0.19.15
2022-07-07 09:11:28.076421 (Thread-115): handling compile_sql request
2022-07-07 09:11:28.076848 (Thread-115): 09:11:28  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '8901092b-4e3c-4560-9d28-48dc5c91cc33', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9a2040ed60>]}
2022-07-07 09:11:30.501592 (Thread-115): sending response (<Response 139 bytes [200 OK]>) to 10.0.19.15
2022-07-07 09:11:30.528442 (MainThread): 09:11:30  Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '49fecf14-b67a-4ed6-b47c-73acc5068b19', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3fa53a1be0>]}
2022-07-07 09:11:30.529090 (MainThread): 09:11:30  Found 17 models, 0 tests, 0 snapshots, 0 analyses, 181 macros, 0 operations, 0 seed files, 15 sources, 0 exposures, 0 metrics
2022-07-07 09:11:30.529723 (Thread-1): 09:11:30  Acquiring new snowflake connection "rpc.ecommerce_data_model_dbt.request"
2022-07-07 09:11:30.529867 (Thread-1): 09:11:30  Began compiling node rpc.ecommerce_data_model_dbt.request
2022-07-07 09:11:30.529972 (Thread-1): 09:11:30  Compiling rpc.ecommerce_data_model_dbt.request
2022-07-07 09:11:30.532799 (Thread-1): 09:11:30  finished collecting timing info
2022-07-07 09:11:30.532992 (Thread-1): 09:11:30  Began executing node rpc.ecommerce_data_model_dbt.request
2022-07-07 09:11:30.533097 (Thread-1): 09:11:30  finished collecting timing info
2022-07-07 09:11:30.910406 (Thread-116): handling poll request
2022-07-07 09:11:30.910881 (Thread-116): 09:11:30  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '8901092b-4e3c-4560-9d28-48dc5c91cc33', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9a287e18e0>]}
2022-07-07 09:11:30.912092 (Thread-116): sending response (<Response 9035 bytes [200 OK]>) to 10.0.19.15
2022-07-07 09:11:55.237324 (Thread-117): 09:11:55  Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
2022-07-07 09:11:55.237981 (Thread-117): 09:11:55  Partial parsing: updated file: ecommerce_data_model_dbt://models/data_model/stg_traits/country_and_state_new.sql
2022-07-07 09:11:55.242494 (Thread-117): 09:11:55  1603: static parser failed on data_model/stg_traits/country_and_state_new.sql
2022-07-07 09:11:55.247703 (Thread-117): 09:11:55  1602: parser fallback to jinja rendering on data_model/stg_traits/country_and_state_new.sql
2022-07-07 09:11:55.282990 (Thread-117): 09:11:55  [WARNING]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.data-apps-ecommerce-template.data_model

2022-07-07 09:11:55.289035 (Thread-117): 09:11:55  Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '8901092b-4e3c-4560-9d28-48dc5c91cc33', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9a2015d670>]}
2022-07-07 09:11:56.052992 (Thread-118): handling status request
2022-07-07 09:11:56.053420 (Thread-118): 09:11:56  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '8901092b-4e3c-4560-9d28-48dc5c91cc33', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9a2035a520>]}
2022-07-07 09:11:56.053958 (Thread-118): sending response (<Response 2408 bytes [200 OK]>) to 10.0.19.15
2022-07-07 09:11:56.444341 (Thread-119): handling status request
2022-07-07 09:11:56.444759 (Thread-119): 09:11:56  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '8901092b-4e3c-4560-9d28-48dc5c91cc33', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9a2035a070>]}
2022-07-07 09:11:56.445300 (Thread-119): sending response (<Response 2408 bytes [200 OK]>) to 10.0.19.15
2022-07-07 09:11:57.529177 (Thread-120): 09:11:57  Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
2022-07-07 09:11:57.529414 (Thread-120): 09:11:57  Partial parsing enabled, no changes found, skipping parsing
2022-07-07 09:11:57.530096 (Thread-120): 09:11:57  [WARNING]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.data-apps-ecommerce-template.data_model

2022-07-07 09:11:57.535928 (Thread-120): 09:11:57  Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '8901092b-4e3c-4560-9d28-48dc5c91cc33', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9a200829a0>]}
2022-07-07 09:11:58.315167 (Thread-121): handling status request
2022-07-07 09:11:58.315587 (Thread-121): 09:11:58  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '8901092b-4e3c-4560-9d28-48dc5c91cc33', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9a20118250>]}
2022-07-07 09:11:58.316100 (Thread-121): sending response (<Response 1703 bytes [200 OK]>) to 10.0.19.15
2022-07-07 09:11:58.524180 (Thread-122): handling status request
2022-07-07 09:11:58.524596 (Thread-122): 09:11:58  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '8901092b-4e3c-4560-9d28-48dc5c91cc33', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9a201181f0>]}
2022-07-07 09:11:58.525125 (Thread-122): sending response (<Response 1703 bytes [200 OK]>) to 10.0.19.15
2022-07-07 09:12:04.780191 (Thread-123): handling status request
2022-07-07 09:12:04.780599 (Thread-123): 09:12:04  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '8901092b-4e3c-4560-9d28-48dc5c91cc33', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9a2007ed60>]}
2022-07-07 09:12:04.781125 (Thread-123): sending response (<Response 1703 bytes [200 OK]>) to 10.0.19.15
2022-07-07 09:12:05.185684 (Thread-124): handling run_sql request
2022-07-07 09:12:05.186109 (Thread-124): 09:12:05  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '8901092b-4e3c-4560-9d28-48dc5c91cc33', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9a2007eb50>]}
2022-07-07 09:12:07.634165 (Thread-124): sending response (<Response 139 bytes [200 OK]>) to 10.0.19.15
2022-07-07 09:12:07.661327 (MainThread): 09:12:07  Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'beac1e0d-5ab8-425d-967e-4c946b284647', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa8bb5dee50>]}
2022-07-07 09:12:07.661950 (MainThread): 09:12:07  Found 17 models, 0 tests, 0 snapshots, 0 analyses, 181 macros, 0 operations, 0 seed files, 15 sources, 0 exposures, 0 metrics
2022-07-07 09:12:07.662609 (Thread-1): 09:12:07  Acquiring new snowflake connection "rpc.ecommerce_data_model_dbt.request"
2022-07-07 09:12:07.662748 (Thread-1): 09:12:07  Began compiling node rpc.ecommerce_data_model_dbt.request
2022-07-07 09:12:07.662848 (Thread-1): 09:12:07  Compiling rpc.ecommerce_data_model_dbt.request
2022-07-07 09:12:07.665784 (Thread-1): 09:12:07  finished collecting timing info
2022-07-07 09:12:07.665927 (Thread-1): 09:12:07  Began executing node rpc.ecommerce_data_model_dbt.request
2022-07-07 09:12:07.667330 (Thread-1): 09:12:07  Using snowflake connection "rpc.ecommerce_data_model_dbt.request"
2022-07-07 09:12:07.667426 (Thread-1): 09:12:07  On rpc.ecommerce_data_model_dbt.request: with cte_id_stitched_identifies as 
(select distinct b.main_id as main_id, properties_country, properties_state, timestamp from analytics_db.data_apps_simulated.identifies a left join 
ANALYTICS_DB.DATA_APPS_SIMULATED.MATERIAL_DOMAIN_PROFILE__IDSTITCHER_DC3F9DA0_12 b 
on (a.user_id = b.other_id and b.other_id_type = 'user_id') or (a.properties_email = b.other_id and b.other_id_type = 'email'))
select distinct main_id, 
first_value(properties_country)
over(partition by main_id order by case when properties_country is not null and properties_country != '' then 2 else 1 end desc, timestamp desc) as country,
first_value(properties_state)
over(partition by main_id order by case when properties_state is not null and properties_state != '' then 2 else 1 end desc, timestamp desc) as state
from cte_id_stitched_identifies where timestamp >= '2021-05-01' and timestamp <= '2022-06-29' and main_id is not null
limit 500
/* limit added automatically by dbt cloud */
2022-07-07 09:12:07.667603 (Thread-1): 09:12:07  Opening a new connection, currently in state init
2022-07-07 09:12:08.050598 (Thread-125): handling poll request
2022-07-07 09:12:08.051113 (Thread-125): 09:12:08  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '8901092b-4e3c-4560-9d28-48dc5c91cc33', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9a20369970>]}
2022-07-07 09:12:08.052107 (Thread-125): sending response (<Response 4716 bytes [200 OK]>) to 10.0.19.15
2022-07-07 09:12:09.300846 (Thread-1): 09:12:09  SQL status: SUCCESS 4 in 1.63 seconds
2022-07-07 09:12:09.302310 (Thread-1): 09:12:09  finished collecting timing info
2022-07-07 09:12:09.302498 (Thread-1): 09:12:09  On rpc.ecommerce_data_model_dbt.request: Close
2022-07-07 09:12:09.478723 (Thread-126): handling poll request
2022-07-07 09:12:09.479138 (Thread-126): 09:12:09  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '8901092b-4e3c-4560-9d28-48dc5c91cc33', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9a20082d30>]}
2022-07-07 09:12:09.479687 (Thread-126): sending response (<Response 1401 bytes [200 OK]>) to 10.0.19.15
2022-07-07 09:12:10.889719 (Thread-127): handling poll request
2022-07-07 09:12:10.890142 (Thread-127): 09:12:10  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '8901092b-4e3c-4560-9d28-48dc5c91cc33', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9a20082670>]}
2022-07-07 09:12:10.891090 (Thread-127): sending response (<Response 6476 bytes [200 OK]>) to 10.0.19.15
2022-07-07 09:12:32.369552 (Thread-128): handling status request
2022-07-07 09:12:32.369970 (Thread-128): 09:12:32  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '8901092b-4e3c-4560-9d28-48dc5c91cc33', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9a20082a60>]}
2022-07-07 09:12:32.370490 (Thread-128): sending response (<Response 1680 bytes [200 OK]>) to 10.0.19.15
2022-07-07 09:12:32.379358 (Thread-129): handling status request
2022-07-07 09:12:32.379636 (Thread-129): 09:12:32  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '8901092b-4e3c-4560-9d28-48dc5c91cc33', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9a20085b80>]}
2022-07-07 09:12:32.380040 (Thread-129): sending response (<Response 1680 bytes [200 OK]>) to 10.0.19.15
2022-07-07 09:12:32.384468 (Thread-130): handling list request
2022-07-07 09:12:32.384735 (Thread-130): 09:12:32  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '8901092b-4e3c-4560-9d28-48dc5c91cc33', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9a20085280>]}
2022-07-07 09:12:32.397212 (Thread-131): handling list request
2022-07-07 09:12:32.423948 (Thread-130): 09:12:32  Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '8901092b-4e3c-4560-9d28-48dc5c91cc33', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9a2011c8b0>]}
2022-07-07 09:12:32.397658 (Thread-131): 09:12:32  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '8901092b-4e3c-4560-9d28-48dc5c91cc33', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9a20082610>]}
2022-07-07 09:12:32.424298 (Thread-130): 09:12:32  Found 17 models, 0 tests, 0 snapshots, 0 analyses, 181 macros, 0 operations, 0 seed files, 15 sources, 0 exposures, 0 metrics
2022-07-07 09:12:32.430316 (Thread-130): sending response (<Response 1982 bytes [200 OK]>) to 10.0.19.15
2022-07-07 09:12:32.425072 (Thread-131): 09:12:32  Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '8901092b-4e3c-4560-9d28-48dc5c91cc33', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9a2011ccd0>]}
2022-07-07 09:12:32.425354 (Thread-131): 09:12:32  Found 17 models, 0 tests, 0 snapshots, 0 analyses, 181 macros, 0 operations, 0 seed files, 15 sources, 0 exposures, 0 metrics
2022-07-07 09:12:32.431532 (Thread-131): sending response (<Response 2835 bytes [200 OK]>) to 10.0.19.15
2022-07-07 09:15:16.332754 (Thread-132): 09:15:16  Partial parsing enabled: 0 files deleted, 1 files added, 0 files changed.
2022-07-07 09:15:16.334584 (Thread-132): 09:15:16  Partial parsing: added file: ecommerce_data_model_dbt://models/data_model/stg_traits/age_and_gender.sql
2022-07-07 09:15:16.338725 (Thread-132): 09:15:16  1699: static parser successfully parsed data_model/stg_traits/age_and_gender.sql
2022-07-07 09:15:16.379237 (Thread-132): 09:15:16  [WARNING]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.data-apps-ecommerce-template.data_model

2022-07-07 09:15:16.385126 (Thread-132): 09:15:16  Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '8901092b-4e3c-4560-9d28-48dc5c91cc33', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f99d075dc40>]}
2022-07-07 09:15:17.161298 (Thread-133): handling status request
2022-07-07 09:15:17.161702 (Thread-133): 09:15:17  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '8901092b-4e3c-4560-9d28-48dc5c91cc33', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f99d07cd820>]}
2022-07-07 09:15:17.162194 (Thread-133): sending response (<Response 2069 bytes [200 OK]>) to 10.0.19.15
2022-07-07 09:15:17.223158 (Thread-134): handling status request
2022-07-07 09:15:17.223601 (Thread-134): 09:15:17  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '8901092b-4e3c-4560-9d28-48dc5c91cc33', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f99d07cd640>]}
2022-07-07 09:15:17.224113 (Thread-134): sending response (<Response 2069 bytes [200 OK]>) to 10.0.19.15
2022-07-07 09:18:02.124686 (Thread-135): 09:18:02  Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
2022-07-07 09:18:02.126844 (Thread-135): 09:18:02  Partial parsing: updated file: ecommerce_data_model_dbt://models/data_model/stg_traits/age_and_gender.sql
2022-07-07 09:18:02.131429 (Thread-135): 09:18:02  1603: static parser failed on data_model/stg_traits/age_and_gender.sql
2022-07-07 09:18:02.135549 (Thread-135): 09:18:02  1602: parser fallback to jinja rendering on data_model/stg_traits/age_and_gender.sql
2022-07-07 09:18:02.173385 (Thread-135): 09:18:02  [WARNING]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.data-apps-ecommerce-template.data_model

2022-07-07 09:18:02.178777 (Thread-135): 09:18:02  Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '8901092b-4e3c-4560-9d28-48dc5c91cc33', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f99d06b2fd0>]}
2022-07-07 09:18:02.971250 (Thread-136): handling status request
2022-07-07 09:18:02.971660 (Thread-136): 09:18:02  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '8901092b-4e3c-4560-9d28-48dc5c91cc33', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9a28040c70>]}
2022-07-07 09:18:02.972191 (Thread-136): sending response (<Response 2387 bytes [200 OK]>) to 10.0.19.15
2022-07-07 09:18:03.012239 (Thread-137): handling status request
2022-07-07 09:18:03.012646 (Thread-137): 09:18:03  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '8901092b-4e3c-4560-9d28-48dc5c91cc33', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f99d0796e80>]}
2022-07-07 09:18:03.013201 (Thread-137): sending response (<Response 2387 bytes [200 OK]>) to 10.0.19.15
2022-07-07 09:18:03.865774 (Thread-138): handling status request
2022-07-07 09:18:03.866246 (Thread-138): 09:18:03  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '8901092b-4e3c-4560-9d28-48dc5c91cc33', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f99d07a5580>]}
2022-07-07 09:18:03.866770 (Thread-138): sending response (<Response 2387 bytes [200 OK]>) to 10.0.19.15
2022-07-07 09:18:04.238825 (Thread-139): handling run_sql request
2022-07-07 09:18:04.239230 (Thread-139): 09:18:04  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '8901092b-4e3c-4560-9d28-48dc5c91cc33', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f99d0796c10>]}
2022-07-07 09:18:06.674851 (Thread-139): sending response (<Response 139 bytes [200 OK]>) to 10.0.19.15
2022-07-07 09:18:06.702175 (MainThread): 09:18:06  Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '8a017b5a-c11e-4836-8c04-1b82cdb774c7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb016a7ff10>]}
2022-07-07 09:18:06.702738 (MainThread): 09:18:06  Found 18 models, 0 tests, 0 snapshots, 0 analyses, 181 macros, 0 operations, 0 seed files, 15 sources, 0 exposures, 0 metrics
2022-07-07 09:18:06.703323 (Thread-1): 09:18:06  Acquiring new snowflake connection "rpc.ecommerce_data_model_dbt.request"
2022-07-07 09:18:06.703459 (Thread-1): 09:18:06  Began compiling node rpc.ecommerce_data_model_dbt.request
2022-07-07 09:18:06.703554 (Thread-1): 09:18:06  Compiling rpc.ecommerce_data_model_dbt.request
2022-07-07 09:18:06.706419 (Thread-1): 09:18:06  finished collecting timing info
2022-07-07 09:18:06.706551 (Thread-1): 09:18:06  Began executing node rpc.ecommerce_data_model_dbt.request
2022-07-07 09:18:06.707739 (Thread-1): 09:18:06  Using snowflake connection "rpc.ecommerce_data_model_dbt.request"
2022-07-07 09:18:06.707827 (Thread-1): 09:18:06  On rpc.ecommerce_data_model_dbt.request: select user_id, 
CASE WHEN getdate() < '2022-06-29'
THEN
(CASE WHEN dateadd(year, datediff (year, properties_birthday, getdate()), properties_birthday) > getdate()
      THEN datediff(year, properties_birthday, getdate()) - 1
      ELSE datediff(year, properties_birthday, getdate())
 END)
 ELSE
(CASE WHEN dateadd(year, datediff (year, properties_birthday, '2022-06-29'), properties_birthday) > '2022-06-29'
      THEN datediff(year, properties_birthday, '2022-06-29') - 1
      ELSE datediff(year, properties_birthday, '2022-06-29')
 END)
 END
  as age,
gender from analytics_db.data_apps_simulated.identifies where timestamp >= '2021-05-01' and timestamp <= '2022-06-29'
and properties_gender is not null and properties_gender != ''
and properties_birthday is not null and properties_birthday != ''
limit 500
/* limit added automatically by dbt cloud */
2022-07-07 09:18:06.707908 (Thread-1): 09:18:06  Opening a new connection, currently in state init
2022-07-07 09:18:07.073228 (Thread-140): handling poll request
2022-07-07 09:18:07.073742 (Thread-140): 09:18:07  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '8901092b-4e3c-4560-9d28-48dc5c91cc33', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9a20129490>]}
2022-07-07 09:18:07.074669 (Thread-140): sending response (<Response 4609 bytes [200 OK]>) to 10.0.19.15
2022-07-07 09:18:07.403754 (Thread-1): 09:18:07  Snowflake adapter: Snowflake query id: 01a571ae-0602-3441-0019-8203046b4f8a
2022-07-07 09:18:07.403946 (Thread-1): 09:18:07  Snowflake adapter: Snowflake error: 000904 (42000): SQL compilation error: error line 15 at position 0
invalid identifier 'GENDER'
2022-07-07 09:18:07.404102 (Thread-1): 09:18:07  finished collecting timing info
2022-07-07 09:18:07.404277 (Thread-1): 09:18:07  On rpc.ecommerce_data_model_dbt.request: Close
2022-07-07 09:18:07.498553 (Thread-1): Got an exception: Database Error
  000904 (42000): SQL compilation error: error line 15 at position 0
  invalid identifier 'GENDER'
Traceback (most recent call last):
  File "/usr/local/lib/python3.8/dist-packages/dbt/adapters/snowflake/connections.py", line 206, in exception_handler
    yield
  File "/usr/local/lib/python3.8/dist-packages/dbt/adapters/sql/connections.py", line 74, in add_query
    cursor.execute(sql, bindings)
  File "/usr/local/lib/python3.8/dist-packages/snowflake/connector/cursor.py", line 721, in execute
    Error.errorhandler_wrapper(
  File "/usr/local/lib/python3.8/dist-packages/snowflake/connector/errors.py", line 258, in errorhandler_wrapper
    cursor.errorhandler(connection, cursor, error_class, error_value)
  File "/usr/local/lib/python3.8/dist-packages/snowflake/connector/errors.py", line 188, in default_errorhandler
    raise error_class(
snowflake.connector.errors.ProgrammingError: 000904 (42000): SQL compilation error: error line 15 at position 0
invalid identifier 'GENDER'

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/usr/local/lib/python3.8/dist-packages/dbt/task/base.py", line 361, in safe_run
    result = self.compile_and_execute(manifest, ctx)
  File "/usr/local/lib/python3.8/dist-packages/dbt/task/base.py", line 314, in compile_and_execute
    result = self.run(ctx.node, manifest)
  File "/usr/local/lib/python3.8/dist-packages/dbt/task/base.py", line 403, in run
    return self.execute(compiled_node, manifest)
  File "/usr/local/lib/python3.8/dist-packages/dbt_rpc/rpc/node_runners.py", line 90, in execute
    _, execute_result = self.adapter.execute(
  File "/usr/local/lib/python3.8/dist-packages/dbt/adapters/base/impl.py", line 225, in execute
    return self.connections.execute(
  File "/usr/local/lib/python3.8/dist-packages/dbt/adapters/sql/connections.py", line 127, in execute
    _, cursor = self.add_query(sql, auto_begin)
  File "/usr/local/lib/python3.8/dist-packages/dbt/adapters/snowflake/connections.py", line 433, in add_query
    connection, cursor = super().add_query(
  File "/usr/local/lib/python3.8/dist-packages/dbt/adapters/sql/connections.py", line 83, in add_query
    return connection, cursor
  File "/usr/lib/python3.8/contextlib.py", line 131, in __exit__
    self.gen.throw(type, value, traceback)
  File "/usr/local/lib/python3.8/dist-packages/dbt/adapters/snowflake/connections.py", line 223, in exception_handler
    raise DatabaseException(msg)
dbt.exceptions.DatabaseException: Database Error
  000904 (42000): SQL compilation error: error line 15 at position 0
  invalid identifier 'GENDER'
2022-07-07 09:18:07.499517 (Thread-1): Got exception RPCException(10003, Database Error, {'type': 'DatabaseException', 'message': "Database Error in rpc request (from remote system)\n  000904 (42000): SQL compilation error: error line 15 at position 0\n  invalid identifier 'GENDER'", 'raw_sql': "select user_id, {{get_age_from_dob('properties_birthday')}} as age,\r\ngender from {{ source('ecommerce', 'identifies') }} where timestamp >= '{{ var('start_date') }}' and timestamp <= '{{ var('end_date') }}'\r\nand properties_gender is not null and properties_gender != ''\r\nand properties_birthday is not null and properties_birthday != ''\nlimit 500\n/* limit added automatically by dbt cloud */", 'compiled_sql': "select user_id, \nCASE WHEN getdate() < '2022-06-29'\nTHEN\n(CASE WHEN dateadd(year, datediff (year, properties_birthday, getdate()), properties_birthday) > getdate()\n      THEN datediff(year, properties_birthday, getdate()) - 1\n      ELSE datediff(year, properties_birthday, getdate())\n END)\n ELSE\n(CASE WHEN dateadd(year, datediff (year, properties_birthday, '2022-06-29'), properties_birthday) > '2022-06-29'\n      THEN datediff(year, properties_birthday, '2022-06-29') - 1\n      ELSE datediff(year, properties_birthday, '2022-06-29')\n END)\n END\n  as age,\ngender from analytics_db.data_apps_simulated.identifies where timestamp >= '2021-05-01' and timestamp <= '2022-06-29'\nand properties_gender is not null and properties_gender != ''\nand properties_birthday is not null and properties_birthday != ''\nlimit 500\n/* limit added automatically by dbt cloud */", 'tags': None}, None)
Traceback (most recent call last):
  File "/usr/local/lib/python3.8/dist-packages/dbt_rpc/task/sql_commands.py", line 147, in _in_thread
    self.node_results.append(runner.safe_run(self.manifest))
  File "/usr/local/lib/python3.8/dist-packages/dbt/task/base.py", line 377, in safe_run
    result = self.error_result(ctx.node, error, started, [])
  File "/usr/local/lib/python3.8/dist-packages/dbt_rpc/rpc/node_runners.py", line 56, in error_result
    raise error
dbt_rpc.rpc.error.RPCException: RPCException(10003, Database Error, {'type': 'DatabaseException', 'message': "Database Error in rpc request (from remote system)\n  000904 (42000): SQL compilation error: error line 15 at position 0\n  invalid identifier 'GENDER'", 'raw_sql': "select user_id, {{get_age_from_dob('properties_birthday')}} as age,\r\ngender from {{ source('ecommerce', 'identifies') }} where timestamp >= '{{ var('start_date') }}' and timestamp <= '{{ var('end_date') }}'\r\nand properties_gender is not null and properties_gender != ''\r\nand properties_birthday is not null and properties_birthday != ''\nlimit 500\n/* limit added automatically by dbt cloud */", 'compiled_sql': "select user_id, \nCASE WHEN getdate() < '2022-06-29'\nTHEN\n(CASE WHEN dateadd(year, datediff (year, properties_birthday, getdate()), properties_birthday) > getdate()\n      THEN datediff(year, properties_birthday, getdate()) - 1\n      ELSE datediff(year, properties_birthday, getdate())\n END)\n ELSE\n(CASE WHEN dateadd(year, datediff (year, properties_birthday, '2022-06-29'), properties_birthday) > '2022-06-29'\n      THEN datediff(year, properties_birthday, '2022-06-29') - 1\n      ELSE datediff(year, properties_birthday, '2022-06-29')\n END)\n END\n  as age,\ngender from analytics_db.data_apps_simulated.identifies where timestamp >= '2021-05-01' and timestamp <= '2022-06-29'\nand properties_gender is not null and properties_gender != ''\nand properties_birthday is not null and properties_birthday != ''\nlimit 500\n/* limit added automatically by dbt cloud */", 'tags': None}, None)
2022-07-07 09:18:08.468021 (Thread-141): handling poll request
2022-07-07 09:18:08.468469 (Thread-141): 09:18:08  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '8901092b-4e3c-4560-9d28-48dc5c91cc33', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9a287eb610>]}
2022-07-07 09:18:08.469208 (Thread-141): sending response (<Response 14120 bytes [200 OK]>) to 10.0.19.15
2022-07-07 09:18:36.442931 (Thread-142): 09:18:36  Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
2022-07-07 09:18:36.443463 (Thread-142): 09:18:36  Partial parsing: updated file: ecommerce_data_model_dbt://models/data_model/stg_traits/age_and_gender.sql
2022-07-07 09:18:36.447888 (Thread-142): 09:18:36  1603: static parser failed on data_model/stg_traits/age_and_gender.sql
2022-07-07 09:18:36.452345 (Thread-142): 09:18:36  1602: parser fallback to jinja rendering on data_model/stg_traits/age_and_gender.sql
2022-07-07 09:18:36.490253 (Thread-142): 09:18:36  [WARNING]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.data-apps-ecommerce-template.data_model

2022-07-07 09:18:36.496042 (Thread-142): 09:18:36  Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '8901092b-4e3c-4560-9d28-48dc5c91cc33', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f99d061beb0>]}
2022-07-07 09:18:37.194989 (Thread-143): handling status request
2022-07-07 09:18:37.195413 (Thread-143): 09:18:37  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '8901092b-4e3c-4560-9d28-48dc5c91cc33', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9a2009f850>]}
2022-07-07 09:18:37.195954 (Thread-143): sending response (<Response 2387 bytes [200 OK]>) to 10.0.19.15
2022-07-07 09:18:37.226696 (Thread-144): handling status request
2022-07-07 09:18:37.233792 (Thread-144): 09:18:37  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '8901092b-4e3c-4560-9d28-48dc5c91cc33', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9a2009f790>]}
2022-07-07 09:18:37.234316 (Thread-144): sending response (<Response 2387 bytes [200 OK]>) to 10.0.19.15
2022-07-07 09:18:40.017328 (Thread-145): handling status request
2022-07-07 09:18:40.017737 (Thread-145): 09:18:40  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '8901092b-4e3c-4560-9d28-48dc5c91cc33', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9a2009fbb0>]}
2022-07-07 09:18:40.018246 (Thread-145): sending response (<Response 2387 bytes [200 OK]>) to 10.0.19.15
2022-07-07 09:18:40.383743 (Thread-146): handling run_sql request
2022-07-07 09:18:40.384157 (Thread-146): 09:18:40  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '8901092b-4e3c-4560-9d28-48dc5c91cc33', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9a2009f730>]}
2022-07-07 09:18:42.785781 (Thread-146): sending response (<Response 139 bytes [200 OK]>) to 10.0.19.15
2022-07-07 09:18:42.813347 (MainThread): 09:18:42  Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '5531e9de-3541-41c4-a3a2-a1dd93ef106e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f75e2b633a0>]}
2022-07-07 09:18:42.813935 (MainThread): 09:18:42  Found 18 models, 0 tests, 0 snapshots, 0 analyses, 181 macros, 0 operations, 0 seed files, 15 sources, 0 exposures, 0 metrics
2022-07-07 09:18:42.814557 (Thread-1): 09:18:42  Acquiring new snowflake connection "rpc.ecommerce_data_model_dbt.request"
2022-07-07 09:18:42.814693 (Thread-1): 09:18:42  Began compiling node rpc.ecommerce_data_model_dbt.request
2022-07-07 09:18:42.814794 (Thread-1): 09:18:42  Compiling rpc.ecommerce_data_model_dbt.request
2022-07-07 09:18:42.817802 (Thread-1): 09:18:42  finished collecting timing info
2022-07-07 09:18:42.817941 (Thread-1): 09:18:42  Began executing node rpc.ecommerce_data_model_dbt.request
2022-07-07 09:18:42.819186 (Thread-1): 09:18:42  Using snowflake connection "rpc.ecommerce_data_model_dbt.request"
2022-07-07 09:18:42.819278 (Thread-1): 09:18:42  On rpc.ecommerce_data_model_dbt.request: select user_id, 
CASE WHEN getdate() < '2022-06-29'
THEN
(CASE WHEN dateadd(year, datediff (year, properties_birthday, getdate()), properties_birthday) > getdate()
      THEN datediff(year, properties_birthday, getdate()) - 1
      ELSE datediff(year, properties_birthday, getdate())
 END)
 ELSE
(CASE WHEN dateadd(year, datediff (year, properties_birthday, '2022-06-29'), properties_birthday) > '2022-06-29'
      THEN datediff(year, properties_birthday, '2022-06-29') - 1
      ELSE datediff(year, properties_birthday, '2022-06-29')
 END)
 END
  as age,
properties_gender as gender from analytics_db.data_apps_simulated.identifies where timestamp >= '2021-05-01' and timestamp <= '2022-06-29'
and properties_gender is not null and properties_gender != ''
and properties_birthday is not null and properties_birthday != ''
limit 500
/* limit added automatically by dbt cloud */
2022-07-07 09:18:42.819361 (Thread-1): 09:18:42  Opening a new connection, currently in state init
2022-07-07 09:18:43.151994 (Thread-147): handling poll request
2022-07-07 09:18:43.152484 (Thread-147): 09:18:43  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '8901092b-4e3c-4560-9d28-48dc5c91cc33', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f99d0603520>]}
2022-07-07 09:18:43.153431 (Thread-147): sending response (<Response 4630 bytes [200 OK]>) to 10.0.19.15
2022-07-07 09:18:44.132331 (Thread-1): 09:18:44  SQL status: SUCCESS 3 in 1.31 seconds
2022-07-07 09:18:44.133919 (Thread-1): 09:18:44  finished collecting timing info
2022-07-07 09:18:44.134116 (Thread-1): 09:18:44  On rpc.ecommerce_data_model_dbt.request: Close
2022-07-07 09:18:44.520098 (Thread-148): handling poll request
2022-07-07 09:18:44.520545 (Thread-148): 09:18:44  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '8901092b-4e3c-4560-9d28-48dc5c91cc33', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f99d06131c0>]}
2022-07-07 09:18:44.549386 (Thread-148): sending response (<Response 5974 bytes [200 OK]>) to 10.0.19.15
2022-07-07 09:19:00.792032 (Thread-149): 09:19:00  Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
2022-07-07 09:19:00.792600 (Thread-149): 09:19:00  Partial parsing: updated file: ecommerce_data_model_dbt://models/data_model/stg_traits/age_and_gender.sql
2022-07-07 09:19:00.797114 (Thread-149): 09:19:00  1603: static parser failed on data_model/stg_traits/age_and_gender.sql
2022-07-07 09:19:00.801247 (Thread-149): 09:19:00  1602: parser fallback to jinja rendering on data_model/stg_traits/age_and_gender.sql
2022-07-07 09:19:00.835994 (Thread-149): 09:19:00  [WARNING]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.data-apps-ecommerce-template.data_model

2022-07-07 09:19:00.841148 (Thread-149): 09:19:00  Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '8901092b-4e3c-4560-9d28-48dc5c91cc33', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f99d0574940>]}
2022-07-07 09:19:01.535241 (Thread-150): handling status request
2022-07-07 09:19:01.535663 (Thread-150): 09:19:01  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '8901092b-4e3c-4560-9d28-48dc5c91cc33', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f99d054dd30>]}
2022-07-07 09:19:01.536199 (Thread-150): sending response (<Response 2387 bytes [200 OK]>) to 10.0.19.15
2022-07-07 09:19:01.574656 (Thread-151): handling status request
2022-07-07 09:19:01.575008 (Thread-151): 09:19:01  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '8901092b-4e3c-4560-9d28-48dc5c91cc33', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f99d054d700>]}
2022-07-07 09:19:01.575479 (Thread-151): sending response (<Response 2387 bytes [200 OK]>) to 10.0.19.15
2022-07-07 09:19:02.124557 (Thread-152): handling status request
2022-07-07 09:19:02.124989 (Thread-152): 09:19:02  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '8901092b-4e3c-4560-9d28-48dc5c91cc33', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f99d054d6d0>]}
2022-07-07 09:19:02.125492 (Thread-152): sending response (<Response 2387 bytes [200 OK]>) to 10.0.19.15
2022-07-07 09:19:02.510616 (Thread-153): handling run_sql request
2022-07-07 09:19:02.511017 (Thread-153): 09:19:02  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '8901092b-4e3c-4560-9d28-48dc5c91cc33', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f99d07a5af0>]}
2022-07-07 09:19:04.908451 (Thread-153): sending response (<Response 139 bytes [200 OK]>) to 10.0.19.15
2022-07-07 09:19:04.936351 (MainThread): 09:19:04  Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '7c2b960a-ecb3-4de1-8f1c-a2b045d92393', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc2c1f3df40>]}
2022-07-07 09:19:04.936913 (MainThread): 09:19:04  Found 18 models, 0 tests, 0 snapshots, 0 analyses, 181 macros, 0 operations, 0 seed files, 15 sources, 0 exposures, 0 metrics
2022-07-07 09:19:04.937507 (Thread-1): 09:19:04  Acquiring new snowflake connection "rpc.ecommerce_data_model_dbt.request"
2022-07-07 09:19:04.937639 (Thread-1): 09:19:04  Began compiling node rpc.ecommerce_data_model_dbt.request
2022-07-07 09:19:04.937751 (Thread-1): 09:19:04  Compiling rpc.ecommerce_data_model_dbt.request
2022-07-07 09:19:04.940507 (Thread-1): 09:19:04  finished collecting timing info
2022-07-07 09:19:04.940640 (Thread-1): 09:19:04  Began executing node rpc.ecommerce_data_model_dbt.request
2022-07-07 09:19:04.941770 (Thread-1): 09:19:04  Using snowflake connection "rpc.ecommerce_data_model_dbt.request"
2022-07-07 09:19:04.941867 (Thread-1): 09:19:04  On rpc.ecommerce_data_model_dbt.request: select user_id, 
CASE WHEN getdate() < '2022-06-29'
THEN
(CASE WHEN dateadd(year, datediff (year, properties_birthday, getdate()), properties_birthday) > getdate()
      THEN datediff(year, properties_birthday, getdate()) - 1
      ELSE datediff(year, properties_birthday, getdate())
 END)
 ELSE
(CASE WHEN dateadd(year, datediff (year, properties_birthday, '2022-06-29'), properties_birthday) > '2022-06-29'
      THEN datediff(year, properties_birthday, '2022-06-29') - 1
      ELSE datediff(year, properties_birthday, '2022-06-29')
 END)
 END
  as age,
properties_gender as gender from analytics_db.data_apps_simulated.identifies where timestamp >= '2021-05-01' and timestamp <= '2022-06-29'
limit 500
/* limit added automatically by dbt cloud */
2022-07-07 09:19:04.941951 (Thread-1): 09:19:04  Opening a new connection, currently in state init
2022-07-07 09:19:05.275324 (Thread-154): handling poll request
2022-07-07 09:19:05.275806 (Thread-154): 09:19:05  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '8901092b-4e3c-4560-9d28-48dc5c91cc33', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f99d061ab80>]}
2022-07-07 09:19:05.276739 (Thread-154): sending response (<Response 4499 bytes [200 OK]>) to 10.0.19.15
2022-07-07 09:19:05.722159 (Thread-1): 09:19:05  SQL status: SUCCESS 8 in 0.78 seconds
2022-07-07 09:19:05.723673 (Thread-1): 09:19:05  finished collecting timing info
2022-07-07 09:19:05.723859 (Thread-1): 09:19:05  On rpc.ecommerce_data_model_dbt.request: Close
2022-07-07 09:19:06.642806 (Thread-155): handling poll request
2022-07-07 09:19:06.643254 (Thread-155): 09:19:06  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '8901092b-4e3c-4560-9d28-48dc5c91cc33', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f99d0613f70>]}
2022-07-07 09:19:06.644233 (Thread-155): sending response (<Response 5556 bytes [200 OK]>) to 10.0.19.15
2022-07-07 09:19:44.855839 (Thread-156): 09:19:44  Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
2022-07-07 09:19:44.856635 (Thread-156): 09:19:44  Partial parsing: updated file: ecommerce_data_model_dbt://models/data_model/stg_traits/age_and_gender.sql
2022-07-07 09:19:44.862874 (Thread-156): 09:19:44  1603: static parser failed on data_model/stg_traits/age_and_gender.sql
2022-07-07 09:19:44.868899 (Thread-156): 09:19:44  1602: parser fallback to jinja rendering on data_model/stg_traits/age_and_gender.sql
2022-07-07 09:19:44.909491 (Thread-156): 09:19:44  [WARNING]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.data-apps-ecommerce-template.data_model

2022-07-07 09:19:44.917670 (Thread-156): 09:19:44  Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '8901092b-4e3c-4560-9d28-48dc5c91cc33', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f99d04764f0>]}
2022-07-07 09:19:45.652495 (Thread-157): handling status request
2022-07-07 09:19:45.652927 (Thread-157): 09:19:45  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '8901092b-4e3c-4560-9d28-48dc5c91cc33', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f99d043ae80>]}
2022-07-07 09:19:45.653450 (Thread-157): sending response (<Response 2387 bytes [200 OK]>) to 10.0.19.15
2022-07-07 09:19:45.687530 (Thread-158): handling status request
2022-07-07 09:19:45.687902 (Thread-158): 09:19:45  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '8901092b-4e3c-4560-9d28-48dc5c91cc33', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f99d043ad60>]}
2022-07-07 09:19:45.688385 (Thread-158): sending response (<Response 2387 bytes [200 OK]>) to 10.0.19.15
2022-07-07 09:19:46.355873 (Thread-159): handling status request
2022-07-07 09:19:46.356329 (Thread-159): 09:19:46  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '8901092b-4e3c-4560-9d28-48dc5c91cc33', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9a2009faf0>]}
2022-07-07 09:19:46.356858 (Thread-159): sending response (<Response 2387 bytes [200 OK]>) to 10.0.19.15
2022-07-07 09:19:46.776692 (Thread-160): handling run_sql request
2022-07-07 09:19:46.777149 (Thread-160): 09:19:46  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '8901092b-4e3c-4560-9d28-48dc5c91cc33', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f99d043ab80>]}
2022-07-07 09:19:49.158361 (Thread-160): sending response (<Response 139 bytes [200 OK]>) to 10.0.19.15
2022-07-07 09:19:49.185867 (MainThread): 09:19:49  Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '476e5446-110e-43e6-84fb-1ce44f9ca80b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1de7c672b0>]}
2022-07-07 09:19:49.186396 (MainThread): 09:19:49  Found 18 models, 0 tests, 0 snapshots, 0 analyses, 181 macros, 0 operations, 0 seed files, 15 sources, 0 exposures, 0 metrics
2022-07-07 09:19:49.186993 (Thread-1): 09:19:49  Acquiring new snowflake connection "rpc.ecommerce_data_model_dbt.request"
2022-07-07 09:19:49.187128 (Thread-1): 09:19:49  Began compiling node rpc.ecommerce_data_model_dbt.request
2022-07-07 09:19:49.187229 (Thread-1): 09:19:49  Compiling rpc.ecommerce_data_model_dbt.request
2022-07-07 09:19:49.190061 (Thread-1): 09:19:49  finished collecting timing info
2022-07-07 09:19:49.190192 (Thread-1): 09:19:49  Began executing node rpc.ecommerce_data_model_dbt.request
2022-07-07 09:19:49.191302 (Thread-1): 09:19:49  Using snowflake connection "rpc.ecommerce_data_model_dbt.request"
2022-07-07 09:19:49.191394 (Thread-1): 09:19:49  On rpc.ecommerce_data_model_dbt.request: select distinct user_id, 
CASE WHEN getdate() < '2022-06-29'
THEN
(CASE WHEN dateadd(year, datediff (year, properties_birthday, getdate()), properties_birthday) > getdate()
      THEN datediff(year, properties_birthday, getdate()) - 1
      ELSE datediff(year, properties_birthday, getdate())
 END)
 ELSE
(CASE WHEN dateadd(year, datediff (year, properties_birthday, '2022-06-29'), properties_birthday) > '2022-06-29'
      THEN datediff(year, properties_birthday, '2022-06-29') - 1
      ELSE datediff(year, properties_birthday, '2022-06-29')
 END)
 END
  as age,
properties_gender as gender from analytics_db.data_apps_simulated.identifies where timestamp >= '2021-05-01' and timestamp <= '2022-06-29'
and user_id is not null
limit 500
/* limit added automatically by dbt cloud */
2022-07-07 09:19:49.191478 (Thread-1): 09:19:49  Opening a new connection, currently in state init
2022-07-07 09:19:49.536785 (Thread-161): handling poll request
2022-07-07 09:19:49.537323 (Thread-161): 09:19:49  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '8901092b-4e3c-4560-9d28-48dc5c91cc33', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f99d0573a90>]}
2022-07-07 09:19:49.538316 (Thread-161): sending response (<Response 4534 bytes [200 OK]>) to 10.0.19.15
2022-07-07 09:19:50.218299 (Thread-1): 09:19:50  SQL status: SUCCESS 7 in 1.03 seconds
2022-07-07 09:19:50.219813 (Thread-1): 09:19:50  finished collecting timing info
2022-07-07 09:19:50.220006 (Thread-1): 09:19:50  On rpc.ecommerce_data_model_dbt.request: Close
2022-07-07 09:19:50.901973 (Thread-162): handling poll request
2022-07-07 09:19:50.902373 (Thread-162): 09:19:50  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '8901092b-4e3c-4560-9d28-48dc5c91cc33', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f99d0574af0>]}
2022-07-07 09:19:50.903327 (Thread-162): sending response (<Response 5675 bytes [200 OK]>) to 10.0.19.15
2022-07-07 09:20:37.970146 (Thread-163): 09:20:37  Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
2022-07-07 09:20:37.970379 (Thread-163): 09:20:37  Partial parsing enabled, no changes found, skipping parsing
2022-07-07 09:20:37.971238 (Thread-163): 09:20:37  [WARNING]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.data-apps-ecommerce-template.data_model

2022-07-07 09:20:37.977026 (Thread-163): 09:20:37  Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '8901092b-4e3c-4560-9d28-48dc5c91cc33', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f99d0388c10>]}
2022-07-07 09:20:38.910166 (Thread-164): handling status request
2022-07-07 09:20:38.910587 (Thread-164): 09:20:38  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '8901092b-4e3c-4560-9d28-48dc5c91cc33', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f99d0437790>]}
2022-07-07 09:20:38.911111 (Thread-164): sending response (<Response 1703 bytes [200 OK]>) to 10.0.19.15
2022-07-07 09:20:38.943021 (Thread-165): handling status request
2022-07-07 09:20:38.943396 (Thread-165): 09:20:38  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '8901092b-4e3c-4560-9d28-48dc5c91cc33', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f99d0437580>]}
2022-07-07 09:20:38.943868 (Thread-165): sending response (<Response 1703 bytes [200 OK]>) to 10.0.19.15
2022-07-07 09:20:39.415614 (Thread-166): handling status request
2022-07-07 09:20:39.416021 (Thread-166): 09:20:39  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '8901092b-4e3c-4560-9d28-48dc5c91cc33', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f99d0437400>]}
2022-07-07 09:20:39.416513 (Thread-166): sending response (<Response 1703 bytes [200 OK]>) to 10.0.19.15
2022-07-07 09:20:39.799645 (Thread-167): handling run_sql request
2022-07-07 09:20:39.800038 (Thread-167): 09:20:39  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '8901092b-4e3c-4560-9d28-48dc5c91cc33', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f99d04371f0>]}
2022-07-07 09:20:42.134647 (Thread-167): sending response (<Response 139 bytes [200 OK]>) to 10.0.19.15
2022-07-07 09:20:42.161790 (MainThread): 09:20:42  Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '05f8064d-9afc-4c73-a436-2d8c4c714fa1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7efdec190550>]}
2022-07-07 09:20:42.162342 (MainThread): 09:20:42  Found 18 models, 0 tests, 0 snapshots, 0 analyses, 181 macros, 0 operations, 0 seed files, 15 sources, 0 exposures, 0 metrics
2022-07-07 09:20:42.162942 (Thread-1): 09:20:42  Acquiring new snowflake connection "rpc.ecommerce_data_model_dbt.request"
2022-07-07 09:20:42.163074 (Thread-1): 09:20:42  Began compiling node rpc.ecommerce_data_model_dbt.request
2022-07-07 09:20:42.163169 (Thread-1): 09:20:42  Compiling rpc.ecommerce_data_model_dbt.request
2022-07-07 09:20:42.166047 (Thread-1): 09:20:42  finished collecting timing info
2022-07-07 09:20:42.166176 (Thread-1): 09:20:42  Began executing node rpc.ecommerce_data_model_dbt.request
2022-07-07 09:20:42.167317 (Thread-1): 09:20:42  Using snowflake connection "rpc.ecommerce_data_model_dbt.request"
2022-07-07 09:20:42.167409 (Thread-1): 09:20:42  On rpc.ecommerce_data_model_dbt.request: select distinct user_id, 
CASE WHEN getdate() < '2022-06-29'
THEN
(CASE WHEN dateadd(year, datediff (year, properties_birthday, getdate()), properties_birthday) > getdate()
      THEN datediff(year, properties_birthday, getdate()) - 1
      ELSE datediff(year, properties_birthday, getdate())
 END)
 ELSE
(CASE WHEN dateadd(year, datediff (year, properties_birthday, '2022-06-29'), properties_birthday) > '2022-06-29'
      THEN datediff(year, properties_birthday, '2022-06-29') - 1
      ELSE datediff(year, properties_birthday, '2022-06-29')
 END)
 END
  as age,
properties_gender as gender from analytics_db.data_apps_simulated.identifies where timestamp >= '2021-05-01' and timestamp <= '2022-06-29'
and user_id is not null
limit 500
/* limit added automatically by dbt cloud */
2022-07-07 09:20:42.167489 (Thread-1): 09:20:42  Opening a new connection, currently in state init
2022-07-07 09:20:42.540744 (Thread-168): handling poll request
2022-07-07 09:20:42.541242 (Thread-168): 09:20:42  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '8901092b-4e3c-4560-9d28-48dc5c91cc33', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f99d04726d0>]}
2022-07-07 09:20:42.542147 (Thread-168): sending response (<Response 4532 bytes [200 OK]>) to 10.0.19.15
2022-07-07 09:20:43.257471 (Thread-1): 09:20:43  SQL status: SUCCESS 7 in 1.09 seconds
2022-07-07 09:20:43.258966 (Thread-1): 09:20:43  finished collecting timing info
2022-07-07 09:20:43.259150 (Thread-1): 09:20:43  On rpc.ecommerce_data_model_dbt.request: Close
2022-07-07 09:20:43.905819 (Thread-169): handling poll request
2022-07-07 09:20:43.906224 (Thread-169): 09:20:43  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '8901092b-4e3c-4560-9d28-48dc5c91cc33', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f99d03888e0>]}
2022-07-07 09:20:43.907193 (Thread-169): sending response (<Response 5676 bytes [200 OK]>) to 10.0.19.15
2022-07-07 09:23:01.844513 (Thread-170): 09:23:01  Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
2022-07-07 09:23:01.846500 (Thread-170): 09:23:01  Partial parsing: updated file: ecommerce_data_model_dbt://models/data_model/stg_traits/age_and_gender.sql
2022-07-07 09:23:01.851377 (Thread-170): 09:23:01  1603: static parser failed on data_model/stg_traits/age_and_gender.sql
2022-07-07 09:23:01.855435 (Thread-170): 09:23:01  1602: parser fallback to jinja rendering on data_model/stg_traits/age_and_gender.sql
2022-07-07 09:23:01.890520 (Thread-170): 09:23:01  [WARNING]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.data-apps-ecommerce-template.data_model

2022-07-07 09:23:01.895733 (Thread-170): 09:23:01  Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '8901092b-4e3c-4560-9d28-48dc5c91cc33', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f99d02f5ca0>]}
2022-07-07 09:23:02.590799 (Thread-171): handling status request
2022-07-07 09:23:02.591259 (Thread-171): 09:23:02  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '8901092b-4e3c-4560-9d28-48dc5c91cc33', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f99d0561430>]}
2022-07-07 09:23:02.591789 (Thread-171): sending response (<Response 2387 bytes [200 OK]>) to 10.0.19.15
2022-07-07 09:23:02.641271 (Thread-172): handling status request
2022-07-07 09:23:02.641658 (Thread-172): 09:23:02  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '8901092b-4e3c-4560-9d28-48dc5c91cc33', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f99d0377a30>]}
2022-07-07 09:23:02.642123 (Thread-172): sending response (<Response 2387 bytes [200 OK]>) to 10.0.19.15
2022-07-07 09:23:04.454441 (Thread-173): 09:23:04  Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
2022-07-07 09:23:04.454680 (Thread-173): 09:23:04  Partial parsing enabled, no changes found, skipping parsing
2022-07-07 09:23:04.455456 (Thread-173): 09:23:04  [WARNING]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.data-apps-ecommerce-template.data_model

2022-07-07 09:23:04.461100 (Thread-173): 09:23:04  Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '8901092b-4e3c-4560-9d28-48dc5c91cc33', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f99d0241430>]}
2022-07-07 09:23:05.178480 (Thread-174): handling status request
2022-07-07 09:23:05.178888 (Thread-174): 09:23:05  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '8901092b-4e3c-4560-9d28-48dc5c91cc33', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f99d02365b0>]}
2022-07-07 09:23:05.179382 (Thread-174): sending response (<Response 1703 bytes [200 OK]>) to 10.0.19.15
2022-07-07 09:23:05.290193 (Thread-175): handling status request
2022-07-07 09:23:05.290587 (Thread-175): 09:23:05  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '8901092b-4e3c-4560-9d28-48dc5c91cc33', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f99d02364f0>]}
2022-07-07 09:23:05.291060 (Thread-175): sending response (<Response 1703 bytes [200 OK]>) to 10.0.19.15
2022-07-07 09:23:06.464236 (Thread-176): handling status request
2022-07-07 09:23:06.464644 (Thread-176): 09:23:06  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '8901092b-4e3c-4560-9d28-48dc5c91cc33', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f99d0236dc0>]}
2022-07-07 09:23:06.465153 (Thread-176): sending response (<Response 1703 bytes [200 OK]>) to 10.0.19.15
2022-07-07 09:23:06.828083 (Thread-177): handling run_sql request
2022-07-07 09:23:06.828496 (Thread-177): 09:23:06  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '8901092b-4e3c-4560-9d28-48dc5c91cc33', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f99d0236460>]}
2022-07-07 09:23:09.176722 (Thread-177): sending response (<Response 139 bytes [200 OK]>) to 10.0.19.15
2022-07-07 09:23:09.201962 (MainThread): 09:23:09  Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'b5ab4a04-8daf-4434-a9ef-287eeec17469', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f45432b4160>]}
2022-07-07 09:23:09.202543 (MainThread): 09:23:09  Found 18 models, 0 tests, 0 snapshots, 0 analyses, 181 macros, 0 operations, 0 seed files, 15 sources, 0 exposures, 0 metrics
2022-07-07 09:23:09.203161 (Thread-1): 09:23:09  Acquiring new snowflake connection "rpc.ecommerce_data_model_dbt.request"
2022-07-07 09:23:09.203300 (Thread-1): 09:23:09  Began compiling node rpc.ecommerce_data_model_dbt.request
2022-07-07 09:23:09.203394 (Thread-1): 09:23:09  Compiling rpc.ecommerce_data_model_dbt.request
2022-07-07 09:23:09.206067 (Thread-1): 09:23:09  finished collecting timing info
2022-07-07 09:23:09.206197 (Thread-1): 09:23:09  Began executing node rpc.ecommerce_data_model_dbt.request
2022-07-07 09:23:09.207520 (Thread-1): 09:23:09  Using snowflake connection "rpc.ecommerce_data_model_dbt.request"
2022-07-07 09:23:09.207612 (Thread-1): 09:23:09  On rpc.ecommerce_data_model_dbt.request: with cte_id_stitched_identifies as 
(select distinct b.main_id as main_id, properties_gender, properties_age, timestamp from analytics_db.data_apps_simulated.identifies a left join 
ANALYTICS_DB.DATA_APPS_SIMULATED.MATERIAL_DOMAIN_PROFILE__IDSTITCHER_DC3F9DA0_12 b 
on (a.user_id = b.other_id and b.other_id_type = 'user_id') or (a.properties_email = b.other_id and b.other_id_type = 'email'))
select distinct main_id, 
first_value(properties_gender)
over(partition by main_id order by case when properties_gender is not null and properties_gender != '' then 2 else 1 end desc, timestamp desc) as gender,
first_value(properties_age)
over(partition by main_id order by case when properties_age is not null and properties_age != '' then 2 else 1 end desc, timestamp desc) as age
from cte_id_stitched_identifies where timestamp >= '2021-05-01' and timestamp <= '2022-06-29' and main_id is not null
limit 500
/* limit added automatically by dbt cloud */
2022-07-07 09:23:09.207695 (Thread-1): 09:23:09  Opening a new connection, currently in state init
2022-07-07 09:23:09.583872 (Thread-178): handling poll request
2022-07-07 09:23:09.584379 (Thread-178): 09:23:09  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '8901092b-4e3c-4560-9d28-48dc5c91cc33', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f99d02e3c70>]}
2022-07-07 09:23:09.606248 (Thread-178): sending response (<Response 4694 bytes [200 OK]>) to 10.0.19.15
2022-07-07 09:23:09.985571 (Thread-1): 09:23:09  Snowflake adapter: Snowflake query id: 01a571b3-0602-3441-0019-8203046b4fc2
2022-07-07 09:23:09.985774 (Thread-1): 09:23:09  Snowflake adapter: Snowflake error: 000904 (42000): SQL compilation error: error line 2 at position 58
invalid identifier 'PROPERTIES_AGE'
2022-07-07 09:23:09.985942 (Thread-1): 09:23:09  finished collecting timing info
2022-07-07 09:23:09.986109 (Thread-1): 09:23:09  On rpc.ecommerce_data_model_dbt.request: Close
2022-07-07 09:23:10.041020 (Thread-1): Got an exception: Database Error
  000904 (42000): SQL compilation error: error line 2 at position 58
  invalid identifier 'PROPERTIES_AGE'
Traceback (most recent call last):
  File "/usr/local/lib/python3.8/dist-packages/dbt/adapters/snowflake/connections.py", line 206, in exception_handler
    yield
  File "/usr/local/lib/python3.8/dist-packages/dbt/adapters/sql/connections.py", line 74, in add_query
    cursor.execute(sql, bindings)
  File "/usr/local/lib/python3.8/dist-packages/snowflake/connector/cursor.py", line 721, in execute
    Error.errorhandler_wrapper(
  File "/usr/local/lib/python3.8/dist-packages/snowflake/connector/errors.py", line 258, in errorhandler_wrapper
    cursor.errorhandler(connection, cursor, error_class, error_value)
  File "/usr/local/lib/python3.8/dist-packages/snowflake/connector/errors.py", line 188, in default_errorhandler
    raise error_class(
snowflake.connector.errors.ProgrammingError: 000904 (42000): SQL compilation error: error line 2 at position 58
invalid identifier 'PROPERTIES_AGE'

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/usr/local/lib/python3.8/dist-packages/dbt/task/base.py", line 361, in safe_run
    result = self.compile_and_execute(manifest, ctx)
  File "/usr/local/lib/python3.8/dist-packages/dbt/task/base.py", line 314, in compile_and_execute
    result = self.run(ctx.node, manifest)
  File "/usr/local/lib/python3.8/dist-packages/dbt/task/base.py", line 403, in run
    return self.execute(compiled_node, manifest)
  File "/usr/local/lib/python3.8/dist-packages/dbt_rpc/rpc/node_runners.py", line 90, in execute
    _, execute_result = self.adapter.execute(
  File "/usr/local/lib/python3.8/dist-packages/dbt/adapters/base/impl.py", line 225, in execute
    return self.connections.execute(
  File "/usr/local/lib/python3.8/dist-packages/dbt/adapters/sql/connections.py", line 127, in execute
    _, cursor = self.add_query(sql, auto_begin)
  File "/usr/local/lib/python3.8/dist-packages/dbt/adapters/snowflake/connections.py", line 433, in add_query
    connection, cursor = super().add_query(
  File "/usr/local/lib/python3.8/dist-packages/dbt/adapters/sql/connections.py", line 83, in add_query
    return connection, cursor
  File "/usr/lib/python3.8/contextlib.py", line 131, in __exit__
    self.gen.throw(type, value, traceback)
  File "/usr/local/lib/python3.8/dist-packages/dbt/adapters/snowflake/connections.py", line 223, in exception_handler
    raise DatabaseException(msg)
dbt.exceptions.DatabaseException: Database Error
  000904 (42000): SQL compilation error: error line 2 at position 58
  invalid identifier 'PROPERTIES_AGE'
2022-07-07 09:23:10.041953 (Thread-1): Got exception RPCException(10003, Database Error, {'type': 'DatabaseException', 'message': "Database Error in rpc request (from remote system)\n  000904 (42000): SQL compilation error: error line 2 at position 58\n  invalid identifier 'PROPERTIES_AGE'", 'raw_sql': "with cte_id_stitched_identifies as \r\n(select distinct b.main_id as main_id, properties_gender, properties_age, timestamp from {{ source('ecommerce', 'identifies') }} a left join \r\nANALYTICS_DB.DATA_APPS_SIMULATED.MATERIAL_DOMAIN_PROFILE__IDSTITCHER_DC3F9DA0_12 b \r\non (a.user_id = b.other_id and b.other_id_type = 'user_id') or (a.properties_email = b.other_id and b.other_id_type = 'email'))\r\nselect distinct main_id, \r\nfirst_value(properties_gender)\r\nover(partition by main_id order by case when properties_gender is not null and properties_gender != '' then 2 else 1 end desc, timestamp desc) as gender,\r\nfirst_value(properties_age)\r\nover(partition by main_id order by case when properties_age is not null and properties_age != '' then 2 else 1 end desc, timestamp desc) as age\r\nfrom cte_id_stitched_identifies where timestamp >= '{{ var('start_date') }}' and timestamp <= '{{ var('end_date') }}' and main_id is not null\nlimit 500\n/* limit added automatically by dbt cloud */", 'compiled_sql': "with cte_id_stitched_identifies as \n(select distinct b.main_id as main_id, properties_gender, properties_age, timestamp from analytics_db.data_apps_simulated.identifies a left join \nANALYTICS_DB.DATA_APPS_SIMULATED.MATERIAL_DOMAIN_PROFILE__IDSTITCHER_DC3F9DA0_12 b \non (a.user_id = b.other_id and b.other_id_type = 'user_id') or (a.properties_email = b.other_id and b.other_id_type = 'email'))\nselect distinct main_id, \nfirst_value(properties_gender)\nover(partition by main_id order by case when properties_gender is not null and properties_gender != '' then 2 else 1 end desc, timestamp desc) as gender,\nfirst_value(properties_age)\nover(partition by main_id order by case when properties_age is not null and properties_age != '' then 2 else 1 end desc, timestamp desc) as age\nfrom cte_id_stitched_identifies where timestamp >= '2021-05-01' and timestamp <= '2022-06-29' and main_id is not null\nlimit 500\n/* limit added automatically by dbt cloud */", 'tags': None}, None)
Traceback (most recent call last):
  File "/usr/local/lib/python3.8/dist-packages/dbt_rpc/task/sql_commands.py", line 147, in _in_thread
    self.node_results.append(runner.safe_run(self.manifest))
  File "/usr/local/lib/python3.8/dist-packages/dbt/task/base.py", line 377, in safe_run
    result = self.error_result(ctx.node, error, started, [])
  File "/usr/local/lib/python3.8/dist-packages/dbt_rpc/rpc/node_runners.py", line 56, in error_result
    raise error
dbt_rpc.rpc.error.RPCException: RPCException(10003, Database Error, {'type': 'DatabaseException', 'message': "Database Error in rpc request (from remote system)\n  000904 (42000): SQL compilation error: error line 2 at position 58\n  invalid identifier 'PROPERTIES_AGE'", 'raw_sql': "with cte_id_stitched_identifies as \r\n(select distinct b.main_id as main_id, properties_gender, properties_age, timestamp from {{ source('ecommerce', 'identifies') }} a left join \r\nANALYTICS_DB.DATA_APPS_SIMULATED.MATERIAL_DOMAIN_PROFILE__IDSTITCHER_DC3F9DA0_12 b \r\non (a.user_id = b.other_id and b.other_id_type = 'user_id') or (a.properties_email = b.other_id and b.other_id_type = 'email'))\r\nselect distinct main_id, \r\nfirst_value(properties_gender)\r\nover(partition by main_id order by case when properties_gender is not null and properties_gender != '' then 2 else 1 end desc, timestamp desc) as gender,\r\nfirst_value(properties_age)\r\nover(partition by main_id order by case when properties_age is not null and properties_age != '' then 2 else 1 end desc, timestamp desc) as age\r\nfrom cte_id_stitched_identifies where timestamp >= '{{ var('start_date') }}' and timestamp <= '{{ var('end_date') }}' and main_id is not null\nlimit 500\n/* limit added automatically by dbt cloud */", 'compiled_sql': "with cte_id_stitched_identifies as \n(select distinct b.main_id as main_id, properties_gender, properties_age, timestamp from analytics_db.data_apps_simulated.identifies a left join \nANALYTICS_DB.DATA_APPS_SIMULATED.MATERIAL_DOMAIN_PROFILE__IDSTITCHER_DC3F9DA0_12 b \non (a.user_id = b.other_id and b.other_id_type = 'user_id') or (a.properties_email = b.other_id and b.other_id_type = 'email'))\nselect distinct main_id, \nfirst_value(properties_gender)\nover(partition by main_id order by case when properties_gender is not null and properties_gender != '' then 2 else 1 end desc, timestamp desc) as gender,\nfirst_value(properties_age)\nover(partition by main_id order by case when properties_age is not null and properties_age != '' then 2 else 1 end desc, timestamp desc) as age\nfrom cte_id_stitched_identifies where timestamp >= '2021-05-01' and timestamp <= '2022-06-29' and main_id is not null\nlimit 500\n/* limit added automatically by dbt cloud */", 'tags': None}, None)
2022-07-07 09:23:10.966503 (Thread-179): handling poll request
2022-07-07 09:23:10.966944 (Thread-179): 09:23:10  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '8901092b-4e3c-4560-9d28-48dc5c91cc33', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f99d0395e20>]}
2022-07-07 09:23:10.967590 (Thread-179): sending response (<Response 16327 bytes [200 OK]>) to 10.0.19.15
2022-07-07 09:23:28.559804 (Thread-180): 09:23:28  Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
2022-07-07 09:23:28.560461 (Thread-180): 09:23:28  Partial parsing: updated file: ecommerce_data_model_dbt://models/data_model/stg_traits/age_and_gender.sql
2022-07-07 09:23:28.565057 (Thread-180): 09:23:28  1603: static parser failed on data_model/stg_traits/age_and_gender.sql
2022-07-07 09:23:28.569502 (Thread-180): 09:23:28  1602: parser fallback to jinja rendering on data_model/stg_traits/age_and_gender.sql
2022-07-07 09:23:28.606814 (Thread-180): 09:23:28  [WARNING]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.data-apps-ecommerce-template.data_model

2022-07-07 09:23:28.612582 (Thread-180): 09:23:28  Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '8901092b-4e3c-4560-9d28-48dc5c91cc33', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f99d01353a0>]}
2022-07-07 09:23:29.462522 (Thread-181): handling status request
2022-07-07 09:23:29.462925 (Thread-181): 09:23:29  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '8901092b-4e3c-4560-9d28-48dc5c91cc33', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f99d02abb80>]}
2022-07-07 09:23:29.463446 (Thread-181): sending response (<Response 2387 bytes [200 OK]>) to 10.0.19.15
2022-07-07 09:23:29.500342 (Thread-182): handling status request
2022-07-07 09:23:29.500723 (Thread-182): 09:23:29  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '8901092b-4e3c-4560-9d28-48dc5c91cc33', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f99d0178eb0>]}
2022-07-07 09:23:29.501266 (Thread-182): sending response (<Response 2387 bytes [200 OK]>) to 10.0.19.15
2022-07-07 09:23:29.701562 (Thread-183): handling status request
2022-07-07 09:23:29.702026 (Thread-183): 09:23:29  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '8901092b-4e3c-4560-9d28-48dc5c91cc33', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f99d0437ac0>]}
2022-07-07 09:23:29.702537 (Thread-183): sending response (<Response 2387 bytes [200 OK]>) to 10.0.19.15
2022-07-07 09:23:30.058438 (Thread-184): handling run_sql request
2022-07-07 09:23:30.058830 (Thread-184): 09:23:30  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '8901092b-4e3c-4560-9d28-48dc5c91cc33', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f99d0178df0>]}
2022-07-07 09:23:32.421745 (Thread-184): sending response (<Response 139 bytes [200 OK]>) to 10.0.19.15
2022-07-07 09:23:32.446978 (MainThread): 09:23:32  Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '0145b88f-2044-4e82-aa00-f9242ba49386', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0e2e5e32e0>]}
2022-07-07 09:23:32.447544 (MainThread): 09:23:32  Found 18 models, 0 tests, 0 snapshots, 0 analyses, 181 macros, 0 operations, 0 seed files, 15 sources, 0 exposures, 0 metrics
2022-07-07 09:23:32.448157 (Thread-1): 09:23:32  Acquiring new snowflake connection "rpc.ecommerce_data_model_dbt.request"
2022-07-07 09:23:32.448308 (Thread-1): 09:23:32  Began compiling node rpc.ecommerce_data_model_dbt.request
2022-07-07 09:23:32.448405 (Thread-1): 09:23:32  Compiling rpc.ecommerce_data_model_dbt.request
2022-07-07 09:23:32.451121 (Thread-1): 09:23:32  finished collecting timing info
2022-07-07 09:23:32.451250 (Thread-1): 09:23:32  Began executing node rpc.ecommerce_data_model_dbt.request
2022-07-07 09:23:32.452639 (Thread-1): 09:23:32  Using snowflake connection "rpc.ecommerce_data_model_dbt.request"
2022-07-07 09:23:32.452732 (Thread-1): 09:23:32  On rpc.ecommerce_data_model_dbt.request: with cte_id_stitched_identifies as 
(select distinct b.main_id as main_id, properties_gender, properties_birthday, timestamp from analytics_db.data_apps_simulated.identifies a left join 
ANALYTICS_DB.DATA_APPS_SIMULATED.MATERIAL_DOMAIN_PROFILE__IDSTITCHER_DC3F9DA0_12 b 
on (a.user_id = b.other_id and b.other_id_type = 'user_id') or (a.properties_email = b.other_id and b.other_id_type = 'email'))
select distinct main_id, 
first_value(properties_gender)
over(partition by main_id order by case when properties_gender is not null and properties_gender != '' then 2 else 1 end desc, timestamp desc) as gender,
first_value(properties_birthday)
over(partition by main_id order by case when properties_birthday is not null and properties_birthday != '' then 2 else 1 end desc, timestamp desc) as age
from cte_id_stitched_identifies where timestamp >= '2021-05-01' and timestamp <= '2022-06-29' and main_id is not null
limit 500
/* limit added automatically by dbt cloud */
2022-07-07 09:23:32.452833 (Thread-1): 09:23:32  Opening a new connection, currently in state init
2022-07-07 09:23:32.778207 (Thread-185): handling poll request
2022-07-07 09:23:32.778744 (Thread-185): 09:23:32  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '8901092b-4e3c-4560-9d28-48dc5c91cc33', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f99d0174760>]}
2022-07-07 09:23:32.779687 (Thread-185): sending response (<Response 4715 bytes [200 OK]>) to 10.0.19.15
2022-07-07 09:23:33.854387 (Thread-1): 09:23:33  SQL status: SUCCESS 4 in 1.4 seconds
2022-07-07 09:23:33.855828 (Thread-1): 09:23:33  finished collecting timing info
2022-07-07 09:23:33.856016 (Thread-1): 09:23:33  On rpc.ecommerce_data_model_dbt.request: Close
2022-07-07 09:23:34.142302 (Thread-186): handling poll request
2022-07-07 09:23:34.142721 (Thread-186): 09:23:34  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '8901092b-4e3c-4560-9d28-48dc5c91cc33', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f99d0236580>]}
2022-07-07 09:23:34.143720 (Thread-186): sending response (<Response 7460 bytes [200 OK]>) to 10.0.19.15
2022-07-07 09:24:51.746864 (Thread-187): 09:24:51  Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
2022-07-07 09:24:51.748688 (Thread-187): 09:24:51  Partial parsing: updated file: ecommerce_data_model_dbt://models/data_model/stg_traits/age_and_gender.sql
2022-07-07 09:24:51.753305 (Thread-187): 09:24:51  1603: static parser failed on data_model/stg_traits/age_and_gender.sql
2022-07-07 09:24:52.522615 (Thread-188): handling status request
2022-07-07 09:24:52.523042 (Thread-188): 09:24:52  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '8901092b-4e3c-4560-9d28-48dc5c91cc33', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f99d0053850>]}
2022-07-07 09:24:52.523541 (Thread-188): sending response (<Response 1466 bytes [200 OK]>) to 10.0.19.15
2022-07-07 09:24:52.565064 (Thread-189): handling status request
2022-07-07 09:24:52.565411 (Thread-189): 09:24:52  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '8901092b-4e3c-4560-9d28-48dc5c91cc33', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f99d00539d0>]}
2022-07-07 09:24:52.565845 (Thread-189): sending response (<Response 1466 bytes [200 OK]>) to 10.0.19.15
2022-07-07 09:24:53.199918 (Thread-190): handling status request
2022-07-07 09:24:53.200354 (Thread-190): 09:24:53  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '8901092b-4e3c-4560-9d28-48dc5c91cc33', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f99d0053250>]}
2022-07-07 09:24:53.200872 (Thread-190): sending response (<Response 1466 bytes [200 OK]>) to 10.0.19.15
2022-07-07 09:24:53.569086 (Thread-191): handling run_sql request
2022-07-07 09:24:53.569537 (Thread-191): 09:24:53  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '8901092b-4e3c-4560-9d28-48dc5c91cc33', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f99d00ff2b0>]}
2022-07-07 09:24:53.569975 (Thread-191): sending response (<Response 946 bytes [200 OK]>) to 10.0.19.15
2022-07-07 09:25:25.061232 (Thread-192): 09:25:25  Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
2022-07-07 09:25:25.062428 (Thread-192): 09:25:25  Partial parsing: updated file: ecommerce_data_model_dbt://models/data_model/stg_traits/age_and_gender.sql
2022-07-07 09:25:25.066188 (Thread-192): 09:25:25  1603: static parser failed on data_model/stg_traits/age_and_gender.sql
2022-07-07 09:25:25.856742 (Thread-193): handling status request
2022-07-07 09:25:25.857335 (Thread-193): 09:25:25  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '8901092b-4e3c-4560-9d28-48dc5c91cc33', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f99adf03dc0>]}
2022-07-07 09:25:25.857893 (Thread-193): sending response (<Response 1466 bytes [200 OK]>) to 10.0.19.15
2022-07-07 09:25:25.889365 (Thread-194): handling status request
2022-07-07 09:25:25.889767 (Thread-194): 09:25:25  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '8901092b-4e3c-4560-9d28-48dc5c91cc33', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f99adf03e50>]}
2022-07-07 09:25:25.890240 (Thread-194): sending response (<Response 1466 bytes [200 OK]>) to 10.0.19.15
2022-07-07 09:25:26.545443 (Thread-195): handling status request
2022-07-07 09:25:26.545885 (Thread-195): 09:25:26  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '8901092b-4e3c-4560-9d28-48dc5c91cc33', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f99adf03fd0>]}
2022-07-07 09:25:26.546364 (Thread-195): sending response (<Response 1466 bytes [200 OK]>) to 10.0.19.15
2022-07-07 09:25:26.914317 (Thread-196): handling run_sql request
2022-07-07 09:25:26.914743 (Thread-196): 09:25:26  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '8901092b-4e3c-4560-9d28-48dc5c91cc33', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f99adf0a190>]}
2022-07-07 09:25:26.915144 (Thread-196): sending response (<Response 946 bytes [200 OK]>) to 10.0.19.15
2022-07-07 09:25:41.590020 (Thread-197): 09:25:41  Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
2022-07-07 09:25:41.590325 (Thread-197): 09:25:41  Partial parsing enabled, no changes found, skipping parsing
2022-07-07 09:25:41.591056 (Thread-197): 09:25:41  [WARNING]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.data-apps-ecommerce-template.data_model

2022-07-07 09:25:41.596567 (Thread-197): 09:25:41  Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '8901092b-4e3c-4560-9d28-48dc5c91cc33', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f99d01b9340>]}
2022-07-07 09:25:42.211748 (Thread-198): handling status request
2022-07-07 09:25:42.212155 (Thread-198): 09:25:42  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '8901092b-4e3c-4560-9d28-48dc5c91cc33', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f99d0041a60>]}
2022-07-07 09:25:42.212671 (Thread-198): sending response (<Response 1703 bytes [200 OK]>) to 10.0.19.15
2022-07-07 09:25:42.266040 (Thread-199): handling status request
2022-07-07 09:25:42.266380 (Thread-199): 09:25:42  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '8901092b-4e3c-4560-9d28-48dc5c91cc33', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f99adf0aa90>]}
2022-07-07 09:25:42.266815 (Thread-199): sending response (<Response 1703 bytes [200 OK]>) to 10.0.19.15
2022-07-07 09:25:42.654435 (Thread-200): handling status request
2022-07-07 09:25:42.654843 (Thread-200): 09:25:42  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '8901092b-4e3c-4560-9d28-48dc5c91cc33', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f99d0042220>]}
2022-07-07 09:25:42.655324 (Thread-200): sending response (<Response 1703 bytes [200 OK]>) to 10.0.19.15
2022-07-07 09:25:43.019879 (Thread-201): handling run_sql request
2022-07-07 09:25:43.020313 (Thread-201): 09:25:43  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '8901092b-4e3c-4560-9d28-48dc5c91cc33', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f99d0042370>]}
2022-07-07 09:25:45.445907 (Thread-201): sending response (<Response 139 bytes [200 OK]>) to 10.0.19.15
2022-07-07 09:25:45.472275 (MainThread): 09:25:45  Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'df804562-0d46-4520-ba3c-e7325d2e5d81', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe98062d1f0>]}
2022-07-07 09:25:45.472919 (MainThread): 09:25:45  Found 18 models, 0 tests, 0 snapshots, 0 analyses, 181 macros, 0 operations, 0 seed files, 15 sources, 0 exposures, 0 metrics
2022-07-07 09:25:45.473578 (Thread-1): 09:25:45  Acquiring new snowflake connection "rpc.ecommerce_data_model_dbt.request"
2022-07-07 09:25:45.473717 (Thread-1): 09:25:45  Began compiling node rpc.ecommerce_data_model_dbt.request
2022-07-07 09:25:45.473812 (Thread-1): 09:25:45  Compiling rpc.ecommerce_data_model_dbt.request
2022-07-07 09:25:45.476645 (Thread-1): 09:25:45  finished collecting timing info
2022-07-07 09:25:45.476784 (Thread-1): 09:25:45  Began executing node rpc.ecommerce_data_model_dbt.request
2022-07-07 09:25:45.478214 (Thread-1): 09:25:45  Using snowflake connection "rpc.ecommerce_data_model_dbt.request"
2022-07-07 09:25:45.478313 (Thread-1): 09:25:45  On rpc.ecommerce_data_model_dbt.request: with cte_id_stitched_identifies as 
(select distinct b.main_id as main_id, properties_gender, properties_birthday, timestamp from analytics_db.data_apps_simulated.identifies a left join 
ANALYTICS_DB.DATA_APPS_SIMULATED.MATERIAL_DOMAIN_PROFILE__IDSTITCHER_DC3F9DA0_12 b 
on (a.user_id = b.other_id and b.other_id_type = 'user_id') or (a.properties_email = b.other_id and b.other_id_type = 'email'))
select distinct main_id, 
first_value(properties_gender)
over(partition by main_id order by case when properties_gender is not null and properties_gender != '' then 2 else 1 end desc, timestamp desc) as gender,
first_value(properties_birthday)
over(partition by main_id order by case when properties_birthday is not null and properties_birthday != '' then 2 else 1 end desc, timestamp desc) as age
from cte_id_stitched_identifies where timestamp >= '2021-05-01' and timestamp <= '2022-06-29' and main_id is not null
limit 500
/* limit added automatically by dbt cloud */
2022-07-07 09:25:45.478399 (Thread-1): 09:25:45  Opening a new connection, currently in state init
2022-07-07 09:25:45.841856 (Thread-202): handling poll request
2022-07-07 09:25:45.842344 (Thread-202): 09:25:45  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '8901092b-4e3c-4560-9d28-48dc5c91cc33', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f99d0047e50>]}
2022-07-07 09:25:45.843242 (Thread-202): sending response (<Response 4725 bytes [200 OK]>) to 10.0.19.15
2022-07-07 09:25:46.694296 (Thread-1): 09:25:46  SQL status: SUCCESS 4 in 1.22 seconds
2022-07-07 09:25:46.695722 (Thread-1): 09:25:46  finished collecting timing info
2022-07-07 09:25:46.695908 (Thread-1): 09:25:46  On rpc.ecommerce_data_model_dbt.request: Close
2022-07-07 09:25:47.215626 (Thread-203): handling poll request
2022-07-07 09:25:47.216060 (Thread-203): 09:25:47  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '8901092b-4e3c-4560-9d28-48dc5c91cc33', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f99d0047ac0>]}
2022-07-07 09:25:47.217077 (Thread-203): sending response (<Response 7464 bytes [200 OK]>) to 10.0.19.15
2022-07-07 09:25:57.022636 (Thread-204): 09:25:57  Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
2022-07-07 09:25:57.023272 (Thread-204): 09:25:57  Partial parsing: updated file: ecommerce_data_model_dbt://models/data_model/stg_traits/age_and_gender.sql
2022-07-07 09:25:57.027872 (Thread-204): 09:25:57  1603: static parser failed on data_model/stg_traits/age_and_gender.sql
2022-07-07 09:25:57.032237 (Thread-204): 09:25:57  1602: parser fallback to jinja rendering on data_model/stg_traits/age_and_gender.sql
2022-07-07 09:25:57.071310 (Thread-204): 09:25:57  [WARNING]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.data-apps-ecommerce-template.data_model

2022-07-07 09:25:57.077730 (Thread-204): 09:25:57  Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '8901092b-4e3c-4560-9d28-48dc5c91cc33', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9a28061b80>]}
2022-07-07 09:25:57.799926 (Thread-205): handling status request
2022-07-07 09:25:57.800377 (Thread-205): 09:25:57  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '8901092b-4e3c-4560-9d28-48dc5c91cc33', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f99d02f54f0>]}
2022-07-07 09:25:57.800964 (Thread-205): sending response (<Response 2387 bytes [200 OK]>) to 10.0.19.15
2022-07-07 09:25:57.814774 (Thread-206): handling status request
2022-07-07 09:25:57.815167 (Thread-206): 09:25:57  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '8901092b-4e3c-4560-9d28-48dc5c91cc33', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f99d02f5df0>]}
2022-07-07 09:25:57.815658 (Thread-206): sending response (<Response 2387 bytes [200 OK]>) to 10.0.19.15
2022-07-07 09:25:58.289271 (Thread-207): handling status request
2022-07-07 09:25:58.289691 (Thread-207): 09:25:58  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '8901092b-4e3c-4560-9d28-48dc5c91cc33', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f99d044df10>]}
2022-07-07 09:25:58.290183 (Thread-207): sending response (<Response 2387 bytes [200 OK]>) to 10.0.19.15
2022-07-07 09:25:58.674750 (Thread-208): handling run_sql request
2022-07-07 09:25:58.675144 (Thread-208): 09:25:58  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '8901092b-4e3c-4560-9d28-48dc5c91cc33', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f99d044daf0>]}
2022-07-07 09:26:01.062522 (Thread-208): sending response (<Response 139 bytes [200 OK]>) to 10.0.19.15
2022-07-07 09:26:01.087394 (MainThread): 09:26:01  Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '127caa52-6152-4638-82c3-ba658267a6e3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0f60563430>]}
2022-07-07 09:26:01.087946 (MainThread): 09:26:01  Found 18 models, 0 tests, 0 snapshots, 0 analyses, 181 macros, 0 operations, 0 seed files, 15 sources, 0 exposures, 0 metrics
2022-07-07 09:26:01.088545 (Thread-1): 09:26:01  Acquiring new snowflake connection "rpc.ecommerce_data_model_dbt.request"
2022-07-07 09:26:01.088682 (Thread-1): 09:26:01  Began compiling node rpc.ecommerce_data_model_dbt.request
2022-07-07 09:26:01.088779 (Thread-1): 09:26:01  Compiling rpc.ecommerce_data_model_dbt.request
2022-07-07 09:26:01.091367 (Thread-1): 09:26:01  finished collecting timing info
2022-07-07 09:26:01.091499 (Thread-1): 09:26:01  Began executing node rpc.ecommerce_data_model_dbt.request
2022-07-07 09:26:01.092868 (Thread-1): 09:26:01  Using snowflake connection "rpc.ecommerce_data_model_dbt.request"
2022-07-07 09:26:01.092968 (Thread-1): 09:26:01  On rpc.ecommerce_data_model_dbt.request: with cte_id_stitched_identifies as 
(select distinct b.main_id as main_id, properties_gender, properties_birthday, timestamp from analytics_db.data_apps_simulated.identifies a left join 
ANALYTICS_DB.DATA_APPS_SIMULATED.MATERIAL_DOMAIN_PROFILE__IDSTITCHER_DC3F9DA0_12 b 
on (a.user_id = b.other_id and b.other_id_type = 'user_id') or (a.properties_email = b.other_id and b.other_id_type = 'email'))
select distinct main_id, 
first_value(properties_gender)
over(partition by main_id order by case when properties_gender is not null and properties_gender != '' then 2 else 1 end desc, timestamp desc) as gender,
first_value(properties_birthday)
over(partition by main_id order by case when properties_birthday is not null and properties_birthday != '' then 2 else 1 end desc, timestamp desc) as dob
from cte_id_stitched_identifies where timestamp >= '2021-05-01' and timestamp <= '2022-06-29' and main_id is not null
limit 500
/* limit added automatically by dbt cloud */
2022-07-07 09:26:01.093050 (Thread-1): 09:26:01  Opening a new connection, currently in state init
2022-07-07 09:26:01.436257 (Thread-209): handling poll request
2022-07-07 09:26:01.436730 (Thread-209): 09:26:01  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '8901092b-4e3c-4560-9d28-48dc5c91cc33', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f99d0477b50>]}
2022-07-07 09:26:01.437680 (Thread-209): sending response (<Response 4725 bytes [200 OK]>) to 10.0.19.15
2022-07-07 09:26:02.407749 (Thread-1): 09:26:02  SQL status: SUCCESS 4 in 1.31 seconds
2022-07-07 09:26:02.409223 (Thread-1): 09:26:02  finished collecting timing info
2022-07-07 09:26:02.409418 (Thread-1): 09:26:02  On rpc.ecommerce_data_model_dbt.request: Close
2022-07-07 09:26:02.802171 (Thread-210): handling poll request
2022-07-07 09:26:02.802609 (Thread-210): 09:26:02  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '8901092b-4e3c-4560-9d28-48dc5c91cc33', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f99d04ef4f0>]}
2022-07-07 09:26:02.839774 (Thread-210): sending response (<Response 7464 bytes [200 OK]>) to 10.0.19.15
2022-07-07 09:27:19.617956 (Thread-211): 09:27:19  Partial parsing enabled: 1 files deleted, 1 files added, 0 files changed.
2022-07-07 09:27:19.619760 (Thread-211): 09:27:19  Partial parsing: added file: ecommerce_data_model_dbt://models/data_model/stg_traits/dob_and_gender.sql
2022-07-07 09:27:19.619939 (Thread-211): 09:27:19  Partial parsing: deleted file: ecommerce_data_model_dbt://models/data_model/stg_traits/age_and_gender.sql
2022-07-07 09:27:19.624321 (Thread-211): 09:27:19  1603: static parser failed on data_model/stg_traits/dob_and_gender.sql
2022-07-07 09:27:19.628464 (Thread-211): 09:27:19  1602: parser fallback to jinja rendering on data_model/stg_traits/dob_and_gender.sql
2022-07-07 09:27:19.667529 (Thread-211): 09:27:19  [WARNING]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.data-apps-ecommerce-template.data_model

2022-07-07 09:27:19.673196 (Thread-211): 09:27:19  Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '8901092b-4e3c-4560-9d28-48dc5c91cc33', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9a286c25e0>]}
2022-07-07 09:27:20.400540 (Thread-212): handling status request
2022-07-07 09:27:20.401034 (Thread-212): 09:27:20  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '8901092b-4e3c-4560-9d28-48dc5c91cc33', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9a2804a940>]}
2022-07-07 09:27:20.401575 (Thread-212): sending response (<Response 2732 bytes [200 OK]>) to 10.0.19.15
2022-07-07 09:27:20.519458 (Thread-213): handling status request
2022-07-07 09:27:20.519862 (Thread-213): 09:27:20  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '8901092b-4e3c-4560-9d28-48dc5c91cc33', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9a2158a130>]}
2022-07-07 09:27:20.520392 (Thread-213): sending response (<Response 2732 bytes [200 OK]>) to 10.0.19.15
2022-07-07 09:27:25.441443 (Thread-214): handling status request
2022-07-07 09:27:25.441844 (Thread-214): 09:27:25  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '8901092b-4e3c-4560-9d28-48dc5c91cc33', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9a2158aa60>]}
2022-07-07 09:27:25.442350 (Thread-214): sending response (<Response 2732 bytes [200 OK]>) to 10.0.19.15
2022-07-07 09:27:25.809312 (Thread-215): handling run_sql request
2022-07-07 09:27:25.809715 (Thread-215): 09:27:25  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '8901092b-4e3c-4560-9d28-48dc5c91cc33', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9a2158a250>]}
2022-07-07 09:27:28.172051 (Thread-215): sending response (<Response 139 bytes [200 OK]>) to 10.0.19.15
2022-07-07 09:27:28.196997 (MainThread): 09:27:28  Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '1a26ddd1-931b-42dc-b26a-9961a7609062', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f85fe075a60>]}
2022-07-07 09:27:28.197525 (MainThread): 09:27:28  Found 18 models, 0 tests, 0 snapshots, 0 analyses, 181 macros, 0 operations, 0 seed files, 15 sources, 0 exposures, 0 metrics
2022-07-07 09:27:28.198118 (Thread-1): 09:27:28  Acquiring new snowflake connection "rpc.ecommerce_data_model_dbt.request"
2022-07-07 09:27:28.198257 (Thread-1): 09:27:28  Began compiling node rpc.ecommerce_data_model_dbt.request
2022-07-07 09:27:28.198358 (Thread-1): 09:27:28  Compiling rpc.ecommerce_data_model_dbt.request
2022-07-07 09:27:28.200948 (Thread-1): 09:27:28  finished collecting timing info
2022-07-07 09:27:28.201078 (Thread-1): 09:27:28  Began executing node rpc.ecommerce_data_model_dbt.request
2022-07-07 09:27:28.202405 (Thread-1): 09:27:28  Using snowflake connection "rpc.ecommerce_data_model_dbt.request"
2022-07-07 09:27:28.202495 (Thread-1): 09:27:28  On rpc.ecommerce_data_model_dbt.request: with cte_id_stitched_identifies as 
(select distinct b.main_id as main_id, properties_gender, properties_birthday, timestamp from analytics_db.data_apps_simulated.identifies a left join 
ANALYTICS_DB.DATA_APPS_SIMULATED.MATERIAL_DOMAIN_PROFILE__IDSTITCHER_DC3F9DA0_12 b 
on (a.user_id = b.other_id and b.other_id_type = 'user_id') or (a.properties_email = b.other_id and b.other_id_type = 'email'))
select distinct main_id, 
first_value(properties_gender)
over(partition by main_id order by case when properties_gender is not null and properties_gender != '' then 2 else 1 end desc, timestamp desc) as gender,
first_value(properties_birthday)
over(partition by main_id order by case when properties_birthday is not null and properties_birthday != '' then 2 else 1 end desc, timestamp desc) as dob
from cte_id_stitched_identifies where timestamp >= '2021-05-01' and timestamp <= '2022-06-29' and main_id is not null
limit 500
/* limit added automatically by dbt cloud */
2022-07-07 09:27:28.202577 (Thread-1): 09:27:28  Opening a new connection, currently in state init
2022-07-07 09:27:28.528988 (Thread-216): handling poll request
2022-07-07 09:27:28.529506 (Thread-216): 09:27:28  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '8901092b-4e3c-4560-9d28-48dc5c91cc33', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9a2158a310>]}
2022-07-07 09:27:28.530416 (Thread-216): sending response (<Response 4725 bytes [200 OK]>) to 10.0.19.15
2022-07-07 09:27:29.382053 (Thread-1): 09:27:29  SQL status: SUCCESS 4 in 1.18 seconds
2022-07-07 09:27:29.383502 (Thread-1): 09:27:29  finished collecting timing info
2022-07-07 09:27:29.383685 (Thread-1): 09:27:29  On rpc.ecommerce_data_model_dbt.request: Close
2022-07-07 09:27:29.913442 (Thread-217): handling poll request
2022-07-07 09:27:29.913894 (Thread-217): 09:27:29  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '8901092b-4e3c-4560-9d28-48dc5c91cc33', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f99d01c47f0>]}
2022-07-07 09:27:29.914857 (Thread-217): sending response (<Response 7464 bytes [200 OK]>) to 10.0.19.15
2022-07-07 09:33:10.409500 (Thread-218): handling status request
2022-07-07 09:33:10.411357 (Thread-218): 09:33:10  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '8901092b-4e3c-4560-9d28-48dc5c91cc33', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f99d06b27c0>]}
2022-07-07 09:33:10.411990 (Thread-218): sending response (<Response 2732 bytes [200 OK]>) to 10.0.19.15
2022-07-07 09:33:10.744903 (Thread-219): handling compile_sql request
2022-07-07 09:33:10.745308 (Thread-219): 09:33:10  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '8901092b-4e3c-4560-9d28-48dc5c91cc33', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f99d06b28e0>]}
2022-07-07 09:33:13.140799 (Thread-219): sending response (<Response 139 bytes [200 OK]>) to 10.0.19.15
2022-07-07 09:33:13.169940 (MainThread): 09:33:13  Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'dde7451a-28d9-4756-ac31-412c3267e1a0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc229e82970>]}
2022-07-07 09:33:13.170548 (MainThread): 09:33:13  Found 18 models, 0 tests, 0 snapshots, 0 analyses, 181 macros, 0 operations, 0 seed files, 15 sources, 0 exposures, 0 metrics
2022-07-07 09:33:13.171190 (Thread-1): 09:33:13  Acquiring new snowflake connection "rpc.ecommerce_data_model_dbt.request"
2022-07-07 09:33:13.171324 (Thread-1): 09:33:13  Began compiling node rpc.ecommerce_data_model_dbt.request
2022-07-07 09:33:13.171424 (Thread-1): 09:33:13  Compiling rpc.ecommerce_data_model_dbt.request
2022-07-07 09:33:13.175338 (Thread-1): 09:33:13  finished collecting timing info
2022-07-07 09:33:13.175487 (Thread-1): 09:33:13  Began executing node rpc.ecommerce_data_model_dbt.request
2022-07-07 09:33:13.175592 (Thread-1): 09:33:13  finished collecting timing info
2022-07-07 09:33:13.483462 (Thread-220): handling poll request
2022-07-07 09:33:13.483936 (Thread-220): 09:33:13  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '8901092b-4e3c-4560-9d28-48dc5c91cc33', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9a2806b6a0>]}
2022-07-07 09:33:13.485181 (Thread-220): sending response (<Response 11649 bytes [200 OK]>) to 10.0.19.15
2022-07-07 09:33:14.417528 (Thread-221): handling status request
2022-07-07 09:33:14.417934 (Thread-221): 09:33:14  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '8901092b-4e3c-4560-9d28-48dc5c91cc33', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9a2806b4f0>]}
2022-07-07 09:33:14.418657 (Thread-221): sending response (<Response 2709 bytes [200 OK]>) to 10.0.19.15
2022-07-07 09:33:14.419290 (Thread-222): handling status request
2022-07-07 09:33:14.419996 (Thread-222): 09:33:14  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '8901092b-4e3c-4560-9d28-48dc5c91cc33', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9a2806b280>]}
2022-07-07 09:33:14.420521 (Thread-222): sending response (<Response 2709 bytes [200 OK]>) to 10.0.19.15
2022-07-07 09:33:14.430149 (Thread-223): handling list request
2022-07-07 09:33:14.430544 (Thread-223): 09:33:14  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '8901092b-4e3c-4560-9d28-48dc5c91cc33', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f99d00ff940>]}
2022-07-07 09:33:14.443298 (Thread-224): handling list request
2022-07-07 09:33:14.473499 (Thread-223): 09:33:14  Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '8901092b-4e3c-4560-9d28-48dc5c91cc33', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9a28766550>]}
2022-07-07 09:33:14.443783 (Thread-224): 09:33:14  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '8901092b-4e3c-4560-9d28-48dc5c91cc33', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9a2804a790>]}
2022-07-07 09:33:14.473921 (Thread-223): 09:33:14  Found 18 models, 0 tests, 0 snapshots, 0 analyses, 181 macros, 0 operations, 0 seed files, 15 sources, 0 exposures, 0 metrics
2022-07-07 09:33:14.482004 (Thread-223): sending response (<Response 6815 bytes [200 OK]>) to 10.0.19.15
2022-07-07 09:33:14.474730 (Thread-224): 09:33:14  Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '8901092b-4e3c-4560-9d28-48dc5c91cc33', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9a201ab700>]}
2022-07-07 09:33:14.475028 (Thread-224): 09:33:14  Found 18 models, 0 tests, 0 snapshots, 0 analyses, 181 macros, 0 operations, 0 seed files, 15 sources, 0 exposures, 0 metrics
2022-07-07 09:33:14.483336 (Thread-224): sending response (<Response 3132 bytes [200 OK]>) to 10.0.19.15
2022-07-07 09:34:03.411405 (Thread-225): handling status request
2022-07-07 09:34:03.411820 (Thread-225): 09:34:03  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '8901092b-4e3c-4560-9d28-48dc5c91cc33', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9a2806b4c0>]}
2022-07-07 09:34:03.412359 (Thread-225): sending response (<Response 2732 bytes [200 OK]>) to 10.0.19.15
2022-07-07 09:34:03.753753 (Thread-226): handling run_sql request
2022-07-07 09:34:03.754162 (Thread-226): 09:34:03  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '8901092b-4e3c-4560-9d28-48dc5c91cc33', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9a2806bac0>]}
2022-07-07 09:34:06.143657 (Thread-226): sending response (<Response 139 bytes [200 OK]>) to 10.0.19.15
2022-07-07 09:34:06.171264 (MainThread): 09:34:06  Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '2743453f-c2bf-40cc-a52a-2cbe398c67fc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f329e379a60>]}
2022-07-07 09:34:06.171806 (MainThread): 09:34:06  Found 18 models, 0 tests, 0 snapshots, 0 analyses, 181 macros, 0 operations, 0 seed files, 15 sources, 0 exposures, 0 metrics
2022-07-07 09:34:06.172406 (Thread-1): 09:34:06  Acquiring new snowflake connection "rpc.ecommerce_data_model_dbt.request"
2022-07-07 09:34:06.172543 (Thread-1): 09:34:06  Began compiling node rpc.ecommerce_data_model_dbt.request
2022-07-07 09:34:06.172640 (Thread-1): 09:34:06  Compiling rpc.ecommerce_data_model_dbt.request
2022-07-07 09:34:06.176267 (Thread-1): 09:34:06  finished collecting timing info
2022-07-07 09:34:06.176405 (Thread-1): 09:34:06  Began executing node rpc.ecommerce_data_model_dbt.request
2022-07-07 09:34:06.178587 (Thread-1): 09:34:06  Using snowflake connection "rpc.ecommerce_data_model_dbt.request"
2022-07-07 09:34:06.178688 (Thread-1): 09:34:06  On rpc.ecommerce_data_model_dbt.request: with cte_gender as ANALYTICS_DB.dbt_ecommerce_features.gender,

cte_age as ANALYTICS_DB.dbt_ecommerce_features.age,

cte_location as ANALYTICS_DB.dbt_ecommerce_features.country_and_state,

cte_email_domain as ANALYTICS_DB.dbt_ecommerce_features.email_domain,

cte_is_member as ANALYTICS_DB.dbt_ecommerce_features.is_member,

cte_has_mobile_app as ANALYTICS_DB.dbt_ecommerce_features.has_mobile_app,

cte_is_active_on_website as ANALYTICS_DB.dbt_ecommerce_features.is_active_on_website,

cte_device_type as ANALYTICS_DB.dbt_ecommerce_features.device_type

select coalesce(a.user_id, b.user_id, c.user_id, d.user_id, e.user_id, f.user_id, g.user_id, h.user_id) 
as user_id, gender, c.country as country, c.state as state, email_domain, is_member, has_mobile_app, is_active_on_website, device_type
from ((((((cte_gender a full outer join cte_age b on a.user_id = b.user_id) 
full outer join cte_location c on c.user_id = coalesce(a.user_id, b.user_id))
full outer join cte_email_domain d on d.user_id = coalesce(a.user_id, b.user_id, c.user_id))
full outer join cte_is_member e on e.user_id = coalesce(a.user_id, b.user_id, c.user_id,d.user_id))
full outer join cte_has_mobile_app f on f.user_id = coalesce(a.user_id, b.user_id, c.user_id,d.user_id, e.user_id))
full outer join cte_is_active_on_website as g on g.user_id = coalesce(a.user_id, b.user_id, c.user_id,d.user_id, e.user_id, f.user_id))
full outer join cte_device_type as h on h.user_id = coalesce(a.user_id, b.user_id, c.user_id,d.user_id, e.user_id, f.user_id, g.user_id)
limit 500
/* limit added automatically by dbt cloud */
2022-07-07 09:34:06.178771 (Thread-1): 09:34:06  Opening a new connection, currently in state init
2022-07-07 09:34:06.516614 (Thread-227): handling poll request
2022-07-07 09:34:06.517123 (Thread-227): 09:34:06  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '8901092b-4e3c-4560-9d28-48dc5c91cc33', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9a2872e8b0>]}
2022-07-07 09:34:06.518034 (Thread-227): sending response (<Response 5351 bytes [200 OK]>) to 10.0.19.15
2022-07-07 09:34:06.999789 (Thread-1): 09:34:06  Snowflake adapter: Snowflake query id: 01a571be-0602-33c1-0019-8203046b6cd2
2022-07-07 09:34:07.000013 (Thread-1): 09:34:06  Snowflake adapter: Snowflake error: 001003 (42000): SQL compilation error:
syntax error line 1 at position 19 unexpected 'ANALYTICS_DB'.
syntax error line 1 at position 61 unexpected ','.
syntax error line 3 at position 11 unexpected 'ANALYTICS_DB'.
syntax error line 3 at position 50 unexpected ','.
syntax error line 5 at position 16 unexpected 'ANALYTICS_DB'.
syntax error line 5 at position 69 unexpected ','.
syntax error line 7 at position 20 unexpected 'ANALYTICS_DB'.
syntax error line 7 at position 68 unexpected ','.
syntax error line 9 at position 17 unexpected 'ANALYTICS_DB'.
syntax error line 9 at position 62 unexpected ','.
syntax error line 11 at position 22 unexpected 'ANALYTICS_DB'.
syntax error line 11 at position 72 unexpected ','.
syntax error line 13 at position 28 unexpected 'ANALYTICS_DB'.
syntax error line 13 at position 84 unexpected ','.
syntax error line 15 at position 19 unexpected 'ANALYTICS_DB'.
syntax error line 17 at position 16 unexpected 'a'.
syntax error line 18 at position 0 unexpected 'as'.
2022-07-07 09:34:07.000193 (Thread-1): 09:34:07  finished collecting timing info
2022-07-07 09:34:07.000378 (Thread-1): 09:34:07  On rpc.ecommerce_data_model_dbt.request: Close
2022-07-07 09:34:07.062210 (Thread-1): Got an exception: Database Error
  001003 (42000): SQL compilation error:
  syntax error line 1 at position 19 unexpected 'ANALYTICS_DB'.
  syntax error line 1 at position 61 unexpected ','.
  syntax error line 3 at position 11 unexpected 'ANALYTICS_DB'.
  syntax error line 3 at position 50 unexpected ','.
  syntax error line 5 at position 16 unexpected 'ANALYTICS_DB'.
  syntax error line 5 at position 69 unexpected ','.
  syntax error line 7 at position 20 unexpected 'ANALYTICS_DB'.
  syntax error line 7 at position 68 unexpected ','.
  syntax error line 9 at position 17 unexpected 'ANALYTICS_DB'.
  syntax error line 9 at position 62 unexpected ','.
  syntax error line 11 at position 22 unexpected 'ANALYTICS_DB'.
  syntax error line 11 at position 72 unexpected ','.
  syntax error line 13 at position 28 unexpected 'ANALYTICS_DB'.
  syntax error line 13 at position 84 unexpected ','.
  syntax error line 15 at position 19 unexpected 'ANALYTICS_DB'.
  syntax error line 17 at position 16 unexpected 'a'.
  syntax error line 18 at position 0 unexpected 'as'.
Traceback (most recent call last):
  File "/usr/local/lib/python3.8/dist-packages/dbt/adapters/snowflake/connections.py", line 206, in exception_handler
    yield
  File "/usr/local/lib/python3.8/dist-packages/dbt/adapters/sql/connections.py", line 74, in add_query
    cursor.execute(sql, bindings)
  File "/usr/local/lib/python3.8/dist-packages/snowflake/connector/cursor.py", line 721, in execute
    Error.errorhandler_wrapper(
  File "/usr/local/lib/python3.8/dist-packages/snowflake/connector/errors.py", line 258, in errorhandler_wrapper
    cursor.errorhandler(connection, cursor, error_class, error_value)
  File "/usr/local/lib/python3.8/dist-packages/snowflake/connector/errors.py", line 188, in default_errorhandler
    raise error_class(
snowflake.connector.errors.ProgrammingError: 001003 (42000): SQL compilation error:
syntax error line 1 at position 19 unexpected 'ANALYTICS_DB'.
syntax error line 1 at position 61 unexpected ','.
syntax error line 3 at position 11 unexpected 'ANALYTICS_DB'.
syntax error line 3 at position 50 unexpected ','.
syntax error line 5 at position 16 unexpected 'ANALYTICS_DB'.
syntax error line 5 at position 69 unexpected ','.
syntax error line 7 at position 20 unexpected 'ANALYTICS_DB'.
syntax error line 7 at position 68 unexpected ','.
syntax error line 9 at position 17 unexpected 'ANALYTICS_DB'.
syntax error line 9 at position 62 unexpected ','.
syntax error line 11 at position 22 unexpected 'ANALYTICS_DB'.
syntax error line 11 at position 72 unexpected ','.
syntax error line 13 at position 28 unexpected 'ANALYTICS_DB'.
syntax error line 13 at position 84 unexpected ','.
syntax error line 15 at position 19 unexpected 'ANALYTICS_DB'.
syntax error line 17 at position 16 unexpected 'a'.
syntax error line 18 at position 0 unexpected 'as'.

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/usr/local/lib/python3.8/dist-packages/dbt/task/base.py", line 361, in safe_run
    result = self.compile_and_execute(manifest, ctx)
  File "/usr/local/lib/python3.8/dist-packages/dbt/task/base.py", line 314, in compile_and_execute
    result = self.run(ctx.node, manifest)
  File "/usr/local/lib/python3.8/dist-packages/dbt/task/base.py", line 403, in run
    return self.execute(compiled_node, manifest)
  File "/usr/local/lib/python3.8/dist-packages/dbt_rpc/rpc/node_runners.py", line 90, in execute
    _, execute_result = self.adapter.execute(
  File "/usr/local/lib/python3.8/dist-packages/dbt/adapters/base/impl.py", line 225, in execute
    return self.connections.execute(
  File "/usr/local/lib/python3.8/dist-packages/dbt/adapters/sql/connections.py", line 127, in execute
    _, cursor = self.add_query(sql, auto_begin)
  File "/usr/local/lib/python3.8/dist-packages/dbt/adapters/snowflake/connections.py", line 433, in add_query
    connection, cursor = super().add_query(
  File "/usr/local/lib/python3.8/dist-packages/dbt/adapters/sql/connections.py", line 83, in add_query
    return connection, cursor
  File "/usr/lib/python3.8/contextlib.py", line 131, in __exit__
    self.gen.throw(type, value, traceback)
  File "/usr/local/lib/python3.8/dist-packages/dbt/adapters/snowflake/connections.py", line 223, in exception_handler
    raise DatabaseException(msg)
dbt.exceptions.DatabaseException: Database Error
  001003 (42000): SQL compilation error:
  syntax error line 1 at position 19 unexpected 'ANALYTICS_DB'.
  syntax error line 1 at position 61 unexpected ','.
  syntax error line 3 at position 11 unexpected 'ANALYTICS_DB'.
  syntax error line 3 at position 50 unexpected ','.
  syntax error line 5 at position 16 unexpected 'ANALYTICS_DB'.
  syntax error line 5 at position 69 unexpected ','.
  syntax error line 7 at position 20 unexpected 'ANALYTICS_DB'.
  syntax error line 7 at position 68 unexpected ','.
  syntax error line 9 at position 17 unexpected 'ANALYTICS_DB'.
  syntax error line 9 at position 62 unexpected ','.
  syntax error line 11 at position 22 unexpected 'ANALYTICS_DB'.
  syntax error line 11 at position 72 unexpected ','.
  syntax error line 13 at position 28 unexpected 'ANALYTICS_DB'.
  syntax error line 13 at position 84 unexpected ','.
  syntax error line 15 at position 19 unexpected 'ANALYTICS_DB'.
  syntax error line 17 at position 16 unexpected 'a'.
  syntax error line 18 at position 0 unexpected 'as'.
2022-07-07 09:34:07.062896 (Thread-1): Got exception RPCException(10003, Database Error, {'type': 'DatabaseException', 'message': "Database Error in rpc request (from remote system)\n  001003 (42000): SQL compilation error:\n  syntax error line 1 at position 19 unexpected 'ANALYTICS_DB'.\n  syntax error line 1 at position 61 unexpected ','.\n  syntax error line 3 at position 11 unexpected 'ANALYTICS_DB'.\n  syntax error line 3 at position 50 unexpected ','.\n  syntax error line 5 at position 16 unexpected 'ANALYTICS_DB'.\n  syntax error line 5 at position 69 unexpected ','.\n  syntax error line 7 at position 20 unexpected 'ANALYTICS_DB'.\n  syntax error line 7 at position 68 unexpected ','.\n  syntax error line 9 at position 17 unexpected 'ANALYTICS_DB'.\n  syntax error line 9 at position 62 unexpected ','.\n  syntax error line 11 at position 22 unexpected 'ANALYTICS_DB'.\n  syntax error line 11 at position 72 unexpected ','.\n  syntax error line 13 at position 28 unexpected 'ANALYTICS_DB'.\n  syntax error line 13 at position 84 unexpected ','.\n  syntax error line 15 at position 19 unexpected 'ANALYTICS_DB'.\n  syntax error line 17 at position 16 unexpected 'a'.\n  syntax error line 18 at position 0 unexpected 'as'.", 'raw_sql': "with cte_gender as {{ ref('gender') }},\r\n\r\ncte_age as {{ ref('age') }},\r\n\r\ncte_location as {{ ref('country_and_state') }},\r\n\r\ncte_email_domain as {{ ref('email_domain') }},\r\n\r\ncte_is_member as {{ ref('is_member') }},\r\n\r\ncte_has_mobile_app as {{ ref('has_mobile_app') }},\r\n\r\ncte_is_active_on_website as {{ ref('is_active_on_website') }},\r\n\r\ncte_device_type as {{ ref('device_type') }}\r\n\r\nselect coalesce(a.user_id, b.user_id, c.user_id, d.user_id, e.user_id, f.user_id, g.user_id, h.user_id) \r\nas user_id, gender, c.country as country, c.state as state, email_domain, is_member, has_mobile_app, is_active_on_website, device_type\r\nfrom ((((((cte_gender a full outer join cte_age b on a.user_id = b.user_id) \r\nfull outer join cte_location c on c.user_id = coalesce(a.user_id, b.user_id))\r\nfull outer join cte_email_domain d on d.user_id = coalesce(a.user_id, b.user_id, c.user_id))\r\nfull outer join cte_is_member e on e.user_id = coalesce(a.user_id, b.user_id, c.user_id,d.user_id))\r\nfull outer join cte_has_mobile_app f on f.user_id = coalesce(a.user_id, b.user_id, c.user_id,d.user_id, e.user_id))\r\nfull outer join cte_is_active_on_website as g on g.user_id = coalesce(a.user_id, b.user_id, c.user_id,d.user_id, e.user_id, f.user_id))\r\nfull outer join cte_device_type as h on h.user_id = coalesce(a.user_id, b.user_id, c.user_id,d.user_id, e.user_id, f.user_id, g.user_id)\nlimit 500\n/* limit added automatically by dbt cloud */", 'compiled_sql': 'with cte_gender as ANALYTICS_DB.dbt_ecommerce_features.gender,\n\ncte_age as ANALYTICS_DB.dbt_ecommerce_features.age,\n\ncte_location as ANALYTICS_DB.dbt_ecommerce_features.country_and_state,\n\ncte_email_domain as ANALYTICS_DB.dbt_ecommerce_features.email_domain,\n\ncte_is_member as ANALYTICS_DB.dbt_ecommerce_features.is_member,\n\ncte_has_mobile_app as ANALYTICS_DB.dbt_ecommerce_features.has_mobile_app,\n\ncte_is_active_on_website as ANALYTICS_DB.dbt_ecommerce_features.is_active_on_website,\n\ncte_device_type as ANALYTICS_DB.dbt_ecommerce_features.device_type\n\nselect coalesce(a.user_id, b.user_id, c.user_id, d.user_id, e.user_id, f.user_id, g.user_id, h.user_id) \nas user_id, gender, c.country as country, c.state as state, email_domain, is_member, has_mobile_app, is_active_on_website, device_type\nfrom ((((((cte_gender a full outer join cte_age b on a.user_id = b.user_id) \nfull outer join cte_location c on c.user_id = coalesce(a.user_id, b.user_id))\nfull outer join cte_email_domain d on d.user_id = coalesce(a.user_id, b.user_id, c.user_id))\nfull outer join cte_is_member e on e.user_id = coalesce(a.user_id, b.user_id, c.user_id,d.user_id))\nfull outer join cte_has_mobile_app f on f.user_id = coalesce(a.user_id, b.user_id, c.user_id,d.user_id, e.user_id))\nfull outer join cte_is_active_on_website as g on g.user_id = coalesce(a.user_id, b.user_id, c.user_id,d.user_id, e.user_id, f.user_id))\nfull outer join cte_device_type as h on h.user_id = coalesce(a.user_id, b.user_id, c.user_id,d.user_id, e.user_id, f.user_id, g.user_id)\nlimit 500\n/* limit added automatically by dbt cloud */', 'tags': None}, None)
Traceback (most recent call last):
  File "/usr/local/lib/python3.8/dist-packages/dbt_rpc/task/sql_commands.py", line 147, in _in_thread
    self.node_results.append(runner.safe_run(self.manifest))
  File "/usr/local/lib/python3.8/dist-packages/dbt/task/base.py", line 377, in safe_run
    result = self.error_result(ctx.node, error, started, [])
  File "/usr/local/lib/python3.8/dist-packages/dbt_rpc/rpc/node_runners.py", line 56, in error_result
    raise error
dbt_rpc.rpc.error.RPCException: RPCException(10003, Database Error, {'type': 'DatabaseException', 'message': "Database Error in rpc request (from remote system)\n  001003 (42000): SQL compilation error:\n  syntax error line 1 at position 19 unexpected 'ANALYTICS_DB'.\n  syntax error line 1 at position 61 unexpected ','.\n  syntax error line 3 at position 11 unexpected 'ANALYTICS_DB'.\n  syntax error line 3 at position 50 unexpected ','.\n  syntax error line 5 at position 16 unexpected 'ANALYTICS_DB'.\n  syntax error line 5 at position 69 unexpected ','.\n  syntax error line 7 at position 20 unexpected 'ANALYTICS_DB'.\n  syntax error line 7 at position 68 unexpected ','.\n  syntax error line 9 at position 17 unexpected 'ANALYTICS_DB'.\n  syntax error line 9 at position 62 unexpected ','.\n  syntax error line 11 at position 22 unexpected 'ANALYTICS_DB'.\n  syntax error line 11 at position 72 unexpected ','.\n  syntax error line 13 at position 28 unexpected 'ANALYTICS_DB'.\n  syntax error line 13 at position 84 unexpected ','.\n  syntax error line 15 at position 19 unexpected 'ANALYTICS_DB'.\n  syntax error line 17 at position 16 unexpected 'a'.\n  syntax error line 18 at position 0 unexpected 'as'.", 'raw_sql': "with cte_gender as {{ ref('gender') }},\r\n\r\ncte_age as {{ ref('age') }},\r\n\r\ncte_location as {{ ref('country_and_state') }},\r\n\r\ncte_email_domain as {{ ref('email_domain') }},\r\n\r\ncte_is_member as {{ ref('is_member') }},\r\n\r\ncte_has_mobile_app as {{ ref('has_mobile_app') }},\r\n\r\ncte_is_active_on_website as {{ ref('is_active_on_website') }},\r\n\r\ncte_device_type as {{ ref('device_type') }}\r\n\r\nselect coalesce(a.user_id, b.user_id, c.user_id, d.user_id, e.user_id, f.user_id, g.user_id, h.user_id) \r\nas user_id, gender, c.country as country, c.state as state, email_domain, is_member, has_mobile_app, is_active_on_website, device_type\r\nfrom ((((((cte_gender a full outer join cte_age b on a.user_id = b.user_id) \r\nfull outer join cte_location c on c.user_id = coalesce(a.user_id, b.user_id))\r\nfull outer join cte_email_domain d on d.user_id = coalesce(a.user_id, b.user_id, c.user_id))\r\nfull outer join cte_is_member e on e.user_id = coalesce(a.user_id, b.user_id, c.user_id,d.user_id))\r\nfull outer join cte_has_mobile_app f on f.user_id = coalesce(a.user_id, b.user_id, c.user_id,d.user_id, e.user_id))\r\nfull outer join cte_is_active_on_website as g on g.user_id = coalesce(a.user_id, b.user_id, c.user_id,d.user_id, e.user_id, f.user_id))\r\nfull outer join cte_device_type as h on h.user_id = coalesce(a.user_id, b.user_id, c.user_id,d.user_id, e.user_id, f.user_id, g.user_id)\nlimit 500\n/* limit added automatically by dbt cloud */", 'compiled_sql': 'with cte_gender as ANALYTICS_DB.dbt_ecommerce_features.gender,\n\ncte_age as ANALYTICS_DB.dbt_ecommerce_features.age,\n\ncte_location as ANALYTICS_DB.dbt_ecommerce_features.country_and_state,\n\ncte_email_domain as ANALYTICS_DB.dbt_ecommerce_features.email_domain,\n\ncte_is_member as ANALYTICS_DB.dbt_ecommerce_features.is_member,\n\ncte_has_mobile_app as ANALYTICS_DB.dbt_ecommerce_features.has_mobile_app,\n\ncte_is_active_on_website as ANALYTICS_DB.dbt_ecommerce_features.is_active_on_website,\n\ncte_device_type as ANALYTICS_DB.dbt_ecommerce_features.device_type\n\nselect coalesce(a.user_id, b.user_id, c.user_id, d.user_id, e.user_id, f.user_id, g.user_id, h.user_id) \nas user_id, gender, c.country as country, c.state as state, email_domain, is_member, has_mobile_app, is_active_on_website, device_type\nfrom ((((((cte_gender a full outer join cte_age b on a.user_id = b.user_id) \nfull outer join cte_location c on c.user_id = coalesce(a.user_id, b.user_id))\nfull outer join cte_email_domain d on d.user_id = coalesce(a.user_id, b.user_id, c.user_id))\nfull outer join cte_is_member e on e.user_id = coalesce(a.user_id, b.user_id, c.user_id,d.user_id))\nfull outer join cte_has_mobile_app f on f.user_id = coalesce(a.user_id, b.user_id, c.user_id,d.user_id, e.user_id))\nfull outer join cte_is_active_on_website as g on g.user_id = coalesce(a.user_id, b.user_id, c.user_id,d.user_id, e.user_id, f.user_id))\nfull outer join cte_device_type as h on h.user_id = coalesce(a.user_id, b.user_id, c.user_id,d.user_id, e.user_id, f.user_id, g.user_id)\nlimit 500\n/* limit added automatically by dbt cloud */', 'tags': None}, None)
2022-07-07 09:34:07.943259 (Thread-228): handling poll request
2022-07-07 09:34:07.943715 (Thread-228): 09:34:07  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '8901092b-4e3c-4560-9d28-48dc5c91cc33', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f99d01b9040>]}
2022-07-07 09:34:07.944479 (Thread-228): sending response (<Response 27055 bytes [200 OK]>) to 10.0.19.15
2022-07-07 09:34:19.149864 (Thread-229): handling status request
2022-07-07 09:34:19.150283 (Thread-229): 09:34:19  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '8901092b-4e3c-4560-9d28-48dc5c91cc33', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9a2872e400>]}
2022-07-07 09:34:19.150867 (Thread-229): sending response (<Response 2732 bytes [200 OK]>) to 10.0.19.15
2022-07-07 09:34:19.493518 (Thread-230): handling compile_sql request
2022-07-07 09:34:19.493926 (Thread-230): 09:34:19  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '8901092b-4e3c-4560-9d28-48dc5c91cc33', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9a20233250>]}
2022-07-07 09:34:21.929344 (Thread-230): sending response (<Response 139 bytes [200 OK]>) to 10.0.19.15
2022-07-07 09:34:21.958821 (MainThread): 09:34:21  Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'f8dbd38d-1d5e-4c23-b6df-ed9b36dad3d4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f986d2baa60>]}
2022-07-07 09:34:21.959584 (MainThread): 09:34:21  Found 18 models, 0 tests, 0 snapshots, 0 analyses, 181 macros, 0 operations, 0 seed files, 15 sources, 0 exposures, 0 metrics
2022-07-07 09:34:21.960263 (Thread-1): 09:34:21  Acquiring new snowflake connection "rpc.ecommerce_data_model_dbt.request"
2022-07-07 09:34:21.960402 (Thread-1): 09:34:21  Began compiling node rpc.ecommerce_data_model_dbt.request
2022-07-07 09:34:21.960501 (Thread-1): 09:34:21  Compiling rpc.ecommerce_data_model_dbt.request
2022-07-07 09:34:21.964420 (Thread-1): 09:34:21  finished collecting timing info
2022-07-07 09:34:21.964564 (Thread-1): 09:34:21  Began executing node rpc.ecommerce_data_model_dbt.request
2022-07-07 09:34:21.964668 (Thread-1): 09:34:21  finished collecting timing info
2022-07-07 09:34:22.306524 (Thread-231): handling poll request
2022-07-07 09:34:22.307032 (Thread-231): 09:34:22  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '8901092b-4e3c-4560-9d28-48dc5c91cc33', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9a20238f40>]}
2022-07-07 09:34:22.308279 (Thread-231): sending response (<Response 11649 bytes [200 OK]>) to 10.0.19.15
2022-07-07 09:35:49.861901 (Thread-232): handling status request
2022-07-07 09:35:49.862320 (Thread-232): 09:35:49  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '8901092b-4e3c-4560-9d28-48dc5c91cc33', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9a20238730>]}
2022-07-07 09:35:49.862890 (Thread-232): sending response (<Response 2732 bytes [200 OK]>) to 10.0.19.15
2022-07-07 09:35:49.887886 (Thread-233): handling status request
2022-07-07 09:35:49.888296 (Thread-233): 09:35:49  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '8901092b-4e3c-4560-9d28-48dc5c91cc33', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9a202385e0>]}
2022-07-07 09:35:49.888834 (Thread-233): sending response (<Response 2732 bytes [200 OK]>) to 10.0.19.15
2022-07-07 09:35:49.952727 (Thread-234): handling status request
2022-07-07 09:35:49.953195 (Thread-234): 09:35:49  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '8901092b-4e3c-4560-9d28-48dc5c91cc33', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9a20238700>]}
2022-07-07 09:35:49.953702 (Thread-234): sending response (<Response 2732 bytes [200 OK]>) to 10.0.19.15
2022-07-07 09:35:50.021459 (Thread-235): handling ps request
2022-07-07 09:35:50.021868 (Thread-235): 09:35:50  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '8901092b-4e3c-4560-9d28-48dc5c91cc33', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9a20238d60>]}
2022-07-07 09:35:50.024357 (Thread-235): sending response (<Response 20776 bytes [200 OK]>) to 10.0.19.15
2022-07-07 09:35:51.290788 (Thread-236): handling status request
2022-07-07 09:35:51.291210 (Thread-236): 09:35:51  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '8901092b-4e3c-4560-9d28-48dc5c91cc33', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9a20238940>]}
2022-07-07 09:35:51.291728 (Thread-236): sending response (<Response 2732 bytes [200 OK]>) to 10.0.19.15
2022-07-07 09:35:57.257479 (Thread-237): handling status request
2022-07-07 09:35:57.257923 (Thread-237): 09:35:57  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '8901092b-4e3c-4560-9d28-48dc5c91cc33', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9a202384f0>]}
2022-07-07 09:35:57.258482 (Thread-237): sending response (<Response 2709 bytes [200 OK]>) to 10.0.19.15
2022-07-07 09:35:57.265195 (Thread-238): handling list request
2022-07-07 09:35:57.265564 (Thread-238): 09:35:57  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '8901092b-4e3c-4560-9d28-48dc5c91cc33', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9a20238df0>]}
2022-07-07 09:35:57.319244 (Thread-238): 09:35:57  Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '8901092b-4e3c-4560-9d28-48dc5c91cc33', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9a20238e80>]}
2022-07-07 09:35:57.319662 (Thread-238): 09:35:57  Found 18 models, 0 tests, 0 snapshots, 0 analyses, 181 macros, 0 operations, 0 seed files, 15 sources, 0 exposures, 0 metrics
2022-07-07 09:35:57.323645 (Thread-238): sending response (<Response 6933 bytes [200 OK]>) to 10.0.19.15
2022-07-07 09:35:59.357592 (Thread-239): handling status request
2022-07-07 09:35:59.358012 (Thread-239): 09:35:59  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '8901092b-4e3c-4560-9d28-48dc5c91cc33', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9a2023ae20>]}
2022-07-07 09:35:59.358538 (Thread-239): sending response (<Response 2732 bytes [200 OK]>) to 10.0.19.15
2022-07-07 09:35:59.730739 (Thread-240): handling run_sql request
2022-07-07 09:35:59.731151 (Thread-240): 09:35:59  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '8901092b-4e3c-4560-9d28-48dc5c91cc33', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9a2023afa0>]}
2022-07-07 09:36:02.148721 (Thread-240): sending response (<Response 139 bytes [200 OK]>) to 10.0.19.15
2022-07-07 09:36:02.176610 (MainThread): 09:36:02  Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'b1d7de73-5fe6-4c75-8189-c80d5a9f6187', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f109d68da90>]}
2022-07-07 09:36:02.177246 (MainThread): 09:36:02  Found 18 models, 0 tests, 0 snapshots, 0 analyses, 181 macros, 0 operations, 0 seed files, 15 sources, 0 exposures, 0 metrics
2022-07-07 09:36:02.177893 (Thread-1): 09:36:02  Acquiring new snowflake connection "rpc.ecommerce_data_model_dbt.request"
2022-07-07 09:36:02.178031 (Thread-1): 09:36:02  Began compiling node rpc.ecommerce_data_model_dbt.request
2022-07-07 09:36:02.178130 (Thread-1): 09:36:02  Compiling rpc.ecommerce_data_model_dbt.request
2022-07-07 09:36:02.182030 (Thread-1): 09:36:02  finished collecting timing info
2022-07-07 09:36:02.182180 (Thread-1): 09:36:02  Began executing node rpc.ecommerce_data_model_dbt.request
2022-07-07 09:36:02.184487 (Thread-1): 09:36:02  Using snowflake connection "rpc.ecommerce_data_model_dbt.request"
2022-07-07 09:36:02.184609 (Thread-1): 09:36:02  On rpc.ecommerce_data_model_dbt.request: with cte_gender as ANALYTICS_DB.dbt_ecommerce_features.gender,

cte_age as ANALYTICS_DB.dbt_ecommerce_features.age,

cte_location as ANALYTICS_DB.dbt_ecommerce_features.country_and_state,

cte_email_domain as ANALYTICS_DB.dbt_ecommerce_features.email_domain,

cte_is_member as ANALYTICS_DB.dbt_ecommerce_features.is_member,

cte_has_mobile_app as ANALYTICS_DB.dbt_ecommerce_features.has_mobile_app,

cte_is_active_on_website as ANALYTICS_DB.dbt_ecommerce_features.is_active_on_website,

cte_device_type as ANALYTICS_DB.dbt_ecommerce_features.device_type

select coalesce(a.user_id, b.user_id, c.user_id, d.user_id, e.user_id, f.user_id, g.user_id, h.user_id) 
as user_id, gender, c.country as country, c.state as state, email_domain, is_member, has_mobile_app, is_active_on_website, device_type
from ((((((cte_gender a full outer join cte_age b on a.user_id = b.user_id) 
full outer join cte_location c on c.user_id = coalesce(a.user_id, b.user_id))
full outer join cte_email_domain d on d.user_id = coalesce(a.user_id, b.user_id, c.user_id))
full outer join cte_is_member e on e.user_id = coalesce(a.user_id, b.user_id, c.user_id,d.user_id))
full outer join cte_has_mobile_app f on f.user_id = coalesce(a.user_id, b.user_id, c.user_id,d.user_id, e.user_id))
full outer join cte_is_active_on_website as g on g.user_id = coalesce(a.user_id, b.user_id, c.user_id,d.user_id, e.user_id, f.user_id))
full outer join cte_device_type as h on h.user_id = coalesce(a.user_id, b.user_id, c.user_id,d.user_id, e.user_id, f.user_id, g.user_id)
limit 500
/* limit added automatically by dbt cloud */
2022-07-07 09:36:02.184698 (Thread-1): 09:36:02  Opening a new connection, currently in state init
2022-07-07 09:36:02.492890 (Thread-241): handling poll request
2022-07-07 09:36:02.493357 (Thread-241): 09:36:02  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '8901092b-4e3c-4560-9d28-48dc5c91cc33', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9a202383a0>]}
2022-07-07 09:36:02.494219 (Thread-241): sending response (<Response 5351 bytes [200 OK]>) to 10.0.19.15
2022-07-07 09:36:02.960844 (Thread-1): 09:36:02  Snowflake adapter: Snowflake query id: 01a571c0-0602-3441-0019-8203046b808e
2022-07-07 09:36:02.961055 (Thread-1): 09:36:02  Snowflake adapter: Snowflake error: 001003 (42000): SQL compilation error:
syntax error line 1 at position 19 unexpected 'ANALYTICS_DB'.
syntax error line 1 at position 61 unexpected ','.
syntax error line 3 at position 11 unexpected 'ANALYTICS_DB'.
syntax error line 3 at position 50 unexpected ','.
syntax error line 5 at position 16 unexpected 'ANALYTICS_DB'.
syntax error line 5 at position 69 unexpected ','.
syntax error line 7 at position 20 unexpected 'ANALYTICS_DB'.
syntax error line 7 at position 68 unexpected ','.
syntax error line 9 at position 17 unexpected 'ANALYTICS_DB'.
syntax error line 9 at position 62 unexpected ','.
syntax error line 11 at position 22 unexpected 'ANALYTICS_DB'.
syntax error line 11 at position 72 unexpected ','.
syntax error line 13 at position 28 unexpected 'ANALYTICS_DB'.
syntax error line 13 at position 84 unexpected ','.
syntax error line 15 at position 19 unexpected 'ANALYTICS_DB'.
syntax error line 17 at position 16 unexpected 'a'.
syntax error line 18 at position 0 unexpected 'as'.
2022-07-07 09:36:02.961243 (Thread-1): 09:36:02  finished collecting timing info
2022-07-07 09:36:02.961415 (Thread-1): 09:36:02  On rpc.ecommerce_data_model_dbt.request: Close
2022-07-07 09:36:03.028481 (Thread-1): Got an exception: Database Error
  001003 (42000): SQL compilation error:
  syntax error line 1 at position 19 unexpected 'ANALYTICS_DB'.
  syntax error line 1 at position 61 unexpected ','.
  syntax error line 3 at position 11 unexpected 'ANALYTICS_DB'.
  syntax error line 3 at position 50 unexpected ','.
  syntax error line 5 at position 16 unexpected 'ANALYTICS_DB'.
  syntax error line 5 at position 69 unexpected ','.
  syntax error line 7 at position 20 unexpected 'ANALYTICS_DB'.
  syntax error line 7 at position 68 unexpected ','.
  syntax error line 9 at position 17 unexpected 'ANALYTICS_DB'.
  syntax error line 9 at position 62 unexpected ','.
  syntax error line 11 at position 22 unexpected 'ANALYTICS_DB'.
  syntax error line 11 at position 72 unexpected ','.
  syntax error line 13 at position 28 unexpected 'ANALYTICS_DB'.
  syntax error line 13 at position 84 unexpected ','.
  syntax error line 15 at position 19 unexpected 'ANALYTICS_DB'.
  syntax error line 17 at position 16 unexpected 'a'.
  syntax error line 18 at position 0 unexpected 'as'.
Traceback (most recent call last):
  File "/usr/local/lib/python3.8/dist-packages/dbt/adapters/snowflake/connections.py", line 206, in exception_handler
    yield
  File "/usr/local/lib/python3.8/dist-packages/dbt/adapters/sql/connections.py", line 74, in add_query
    cursor.execute(sql, bindings)
  File "/usr/local/lib/python3.8/dist-packages/snowflake/connector/cursor.py", line 721, in execute
    Error.errorhandler_wrapper(
  File "/usr/local/lib/python3.8/dist-packages/snowflake/connector/errors.py", line 258, in errorhandler_wrapper
    cursor.errorhandler(connection, cursor, error_class, error_value)
  File "/usr/local/lib/python3.8/dist-packages/snowflake/connector/errors.py", line 188, in default_errorhandler
    raise error_class(
snowflake.connector.errors.ProgrammingError: 001003 (42000): SQL compilation error:
syntax error line 1 at position 19 unexpected 'ANALYTICS_DB'.
syntax error line 1 at position 61 unexpected ','.
syntax error line 3 at position 11 unexpected 'ANALYTICS_DB'.
syntax error line 3 at position 50 unexpected ','.
syntax error line 5 at position 16 unexpected 'ANALYTICS_DB'.
syntax error line 5 at position 69 unexpected ','.
syntax error line 7 at position 20 unexpected 'ANALYTICS_DB'.
syntax error line 7 at position 68 unexpected ','.
syntax error line 9 at position 17 unexpected 'ANALYTICS_DB'.
syntax error line 9 at position 62 unexpected ','.
syntax error line 11 at position 22 unexpected 'ANALYTICS_DB'.
syntax error line 11 at position 72 unexpected ','.
syntax error line 13 at position 28 unexpected 'ANALYTICS_DB'.
syntax error line 13 at position 84 unexpected ','.
syntax error line 15 at position 19 unexpected 'ANALYTICS_DB'.
syntax error line 17 at position 16 unexpected 'a'.
syntax error line 18 at position 0 unexpected 'as'.

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/usr/local/lib/python3.8/dist-packages/dbt/task/base.py", line 361, in safe_run
    result = self.compile_and_execute(manifest, ctx)
  File "/usr/local/lib/python3.8/dist-packages/dbt/task/base.py", line 314, in compile_and_execute
    result = self.run(ctx.node, manifest)
  File "/usr/local/lib/python3.8/dist-packages/dbt/task/base.py", line 403, in run
    return self.execute(compiled_node, manifest)
  File "/usr/local/lib/python3.8/dist-packages/dbt_rpc/rpc/node_runners.py", line 90, in execute
    _, execute_result = self.adapter.execute(
  File "/usr/local/lib/python3.8/dist-packages/dbt/adapters/base/impl.py", line 225, in execute
    return self.connections.execute(
  File "/usr/local/lib/python3.8/dist-packages/dbt/adapters/sql/connections.py", line 127, in execute
    _, cursor = self.add_query(sql, auto_begin)
  File "/usr/local/lib/python3.8/dist-packages/dbt/adapters/snowflake/connections.py", line 433, in add_query
    connection, cursor = super().add_query(
  File "/usr/local/lib/python3.8/dist-packages/dbt/adapters/sql/connections.py", line 83, in add_query
    return connection, cursor
  File "/usr/lib/python3.8/contextlib.py", line 131, in __exit__
    self.gen.throw(type, value, traceback)
  File "/usr/local/lib/python3.8/dist-packages/dbt/adapters/snowflake/connections.py", line 223, in exception_handler
    raise DatabaseException(msg)
dbt.exceptions.DatabaseException: Database Error
  001003 (42000): SQL compilation error:
  syntax error line 1 at position 19 unexpected 'ANALYTICS_DB'.
  syntax error line 1 at position 61 unexpected ','.
  syntax error line 3 at position 11 unexpected 'ANALYTICS_DB'.
  syntax error line 3 at position 50 unexpected ','.
  syntax error line 5 at position 16 unexpected 'ANALYTICS_DB'.
  syntax error line 5 at position 69 unexpected ','.
  syntax error line 7 at position 20 unexpected 'ANALYTICS_DB'.
  syntax error line 7 at position 68 unexpected ','.
  syntax error line 9 at position 17 unexpected 'ANALYTICS_DB'.
  syntax error line 9 at position 62 unexpected ','.
  syntax error line 11 at position 22 unexpected 'ANALYTICS_DB'.
  syntax error line 11 at position 72 unexpected ','.
  syntax error line 13 at position 28 unexpected 'ANALYTICS_DB'.
  syntax error line 13 at position 84 unexpected ','.
  syntax error line 15 at position 19 unexpected 'ANALYTICS_DB'.
  syntax error line 17 at position 16 unexpected 'a'.
  syntax error line 18 at position 0 unexpected 'as'.
2022-07-07 09:36:03.029332 (Thread-1): Got exception RPCException(10003, Database Error, {'type': 'DatabaseException', 'message': "Database Error in rpc request (from remote system)\n  001003 (42000): SQL compilation error:\n  syntax error line 1 at position 19 unexpected 'ANALYTICS_DB'.\n  syntax error line 1 at position 61 unexpected ','.\n  syntax error line 3 at position 11 unexpected 'ANALYTICS_DB'.\n  syntax error line 3 at position 50 unexpected ','.\n  syntax error line 5 at position 16 unexpected 'ANALYTICS_DB'.\n  syntax error line 5 at position 69 unexpected ','.\n  syntax error line 7 at position 20 unexpected 'ANALYTICS_DB'.\n  syntax error line 7 at position 68 unexpected ','.\n  syntax error line 9 at position 17 unexpected 'ANALYTICS_DB'.\n  syntax error line 9 at position 62 unexpected ','.\n  syntax error line 11 at position 22 unexpected 'ANALYTICS_DB'.\n  syntax error line 11 at position 72 unexpected ','.\n  syntax error line 13 at position 28 unexpected 'ANALYTICS_DB'.\n  syntax error line 13 at position 84 unexpected ','.\n  syntax error line 15 at position 19 unexpected 'ANALYTICS_DB'.\n  syntax error line 17 at position 16 unexpected 'a'.\n  syntax error line 18 at position 0 unexpected 'as'.", 'raw_sql': "with cte_gender as {{ ref('gender') }},\r\n\r\ncte_age as {{ ref('age') }},\r\n\r\ncte_location as {{ ref('country_and_state') }},\r\n\r\ncte_email_domain as {{ ref('email_domain') }},\r\n\r\ncte_is_member as {{ ref('is_member') }},\r\n\r\ncte_has_mobile_app as {{ ref('has_mobile_app') }},\r\n\r\ncte_is_active_on_website as {{ ref('is_active_on_website') }},\r\n\r\ncte_device_type as {{ ref('device_type') }}\r\n\r\nselect coalesce(a.user_id, b.user_id, c.user_id, d.user_id, e.user_id, f.user_id, g.user_id, h.user_id) \r\nas user_id, gender, c.country as country, c.state as state, email_domain, is_member, has_mobile_app, is_active_on_website, device_type\r\nfrom ((((((cte_gender a full outer join cte_age b on a.user_id = b.user_id) \r\nfull outer join cte_location c on c.user_id = coalesce(a.user_id, b.user_id))\r\nfull outer join cte_email_domain d on d.user_id = coalesce(a.user_id, b.user_id, c.user_id))\r\nfull outer join cte_is_member e on e.user_id = coalesce(a.user_id, b.user_id, c.user_id,d.user_id))\r\nfull outer join cte_has_mobile_app f on f.user_id = coalesce(a.user_id, b.user_id, c.user_id,d.user_id, e.user_id))\r\nfull outer join cte_is_active_on_website as g on g.user_id = coalesce(a.user_id, b.user_id, c.user_id,d.user_id, e.user_id, f.user_id))\r\nfull outer join cte_device_type as h on h.user_id = coalesce(a.user_id, b.user_id, c.user_id,d.user_id, e.user_id, f.user_id, g.user_id)\nlimit 500\n/* limit added automatically by dbt cloud */", 'compiled_sql': 'with cte_gender as ANALYTICS_DB.dbt_ecommerce_features.gender,\n\ncte_age as ANALYTICS_DB.dbt_ecommerce_features.age,\n\ncte_location as ANALYTICS_DB.dbt_ecommerce_features.country_and_state,\n\ncte_email_domain as ANALYTICS_DB.dbt_ecommerce_features.email_domain,\n\ncte_is_member as ANALYTICS_DB.dbt_ecommerce_features.is_member,\n\ncte_has_mobile_app as ANALYTICS_DB.dbt_ecommerce_features.has_mobile_app,\n\ncte_is_active_on_website as ANALYTICS_DB.dbt_ecommerce_features.is_active_on_website,\n\ncte_device_type as ANALYTICS_DB.dbt_ecommerce_features.device_type\n\nselect coalesce(a.user_id, b.user_id, c.user_id, d.user_id, e.user_id, f.user_id, g.user_id, h.user_id) \nas user_id, gender, c.country as country, c.state as state, email_domain, is_member, has_mobile_app, is_active_on_website, device_type\nfrom ((((((cte_gender a full outer join cte_age b on a.user_id = b.user_id) \nfull outer join cte_location c on c.user_id = coalesce(a.user_id, b.user_id))\nfull outer join cte_email_domain d on d.user_id = coalesce(a.user_id, b.user_id, c.user_id))\nfull outer join cte_is_member e on e.user_id = coalesce(a.user_id, b.user_id, c.user_id,d.user_id))\nfull outer join cte_has_mobile_app f on f.user_id = coalesce(a.user_id, b.user_id, c.user_id,d.user_id, e.user_id))\nfull outer join cte_is_active_on_website as g on g.user_id = coalesce(a.user_id, b.user_id, c.user_id,d.user_id, e.user_id, f.user_id))\nfull outer join cte_device_type as h on h.user_id = coalesce(a.user_id, b.user_id, c.user_id,d.user_id, e.user_id, f.user_id, g.user_id)\nlimit 500\n/* limit added automatically by dbt cloud */', 'tags': None}, None)
Traceback (most recent call last):
  File "/usr/local/lib/python3.8/dist-packages/dbt_rpc/task/sql_commands.py", line 147, in _in_thread
    self.node_results.append(runner.safe_run(self.manifest))
  File "/usr/local/lib/python3.8/dist-packages/dbt/task/base.py", line 377, in safe_run
    result = self.error_result(ctx.node, error, started, [])
  File "/usr/local/lib/python3.8/dist-packages/dbt_rpc/rpc/node_runners.py", line 56, in error_result
    raise error
dbt_rpc.rpc.error.RPCException: RPCException(10003, Database Error, {'type': 'DatabaseException', 'message': "Database Error in rpc request (from remote system)\n  001003 (42000): SQL compilation error:\n  syntax error line 1 at position 19 unexpected 'ANALYTICS_DB'.\n  syntax error line 1 at position 61 unexpected ','.\n  syntax error line 3 at position 11 unexpected 'ANALYTICS_DB'.\n  syntax error line 3 at position 50 unexpected ','.\n  syntax error line 5 at position 16 unexpected 'ANALYTICS_DB'.\n  syntax error line 5 at position 69 unexpected ','.\n  syntax error line 7 at position 20 unexpected 'ANALYTICS_DB'.\n  syntax error line 7 at position 68 unexpected ','.\n  syntax error line 9 at position 17 unexpected 'ANALYTICS_DB'.\n  syntax error line 9 at position 62 unexpected ','.\n  syntax error line 11 at position 22 unexpected 'ANALYTICS_DB'.\n  syntax error line 11 at position 72 unexpected ','.\n  syntax error line 13 at position 28 unexpected 'ANALYTICS_DB'.\n  syntax error line 13 at position 84 unexpected ','.\n  syntax error line 15 at position 19 unexpected 'ANALYTICS_DB'.\n  syntax error line 17 at position 16 unexpected 'a'.\n  syntax error line 18 at position 0 unexpected 'as'.", 'raw_sql': "with cte_gender as {{ ref('gender') }},\r\n\r\ncte_age as {{ ref('age') }},\r\n\r\ncte_location as {{ ref('country_and_state') }},\r\n\r\ncte_email_domain as {{ ref('email_domain') }},\r\n\r\ncte_is_member as {{ ref('is_member') }},\r\n\r\ncte_has_mobile_app as {{ ref('has_mobile_app') }},\r\n\r\ncte_is_active_on_website as {{ ref('is_active_on_website') }},\r\n\r\ncte_device_type as {{ ref('device_type') }}\r\n\r\nselect coalesce(a.user_id, b.user_id, c.user_id, d.user_id, e.user_id, f.user_id, g.user_id, h.user_id) \r\nas user_id, gender, c.country as country, c.state as state, email_domain, is_member, has_mobile_app, is_active_on_website, device_type\r\nfrom ((((((cte_gender a full outer join cte_age b on a.user_id = b.user_id) \r\nfull outer join cte_location c on c.user_id = coalesce(a.user_id, b.user_id))\r\nfull outer join cte_email_domain d on d.user_id = coalesce(a.user_id, b.user_id, c.user_id))\r\nfull outer join cte_is_member e on e.user_id = coalesce(a.user_id, b.user_id, c.user_id,d.user_id))\r\nfull outer join cte_has_mobile_app f on f.user_id = coalesce(a.user_id, b.user_id, c.user_id,d.user_id, e.user_id))\r\nfull outer join cte_is_active_on_website as g on g.user_id = coalesce(a.user_id, b.user_id, c.user_id,d.user_id, e.user_id, f.user_id))\r\nfull outer join cte_device_type as h on h.user_id = coalesce(a.user_id, b.user_id, c.user_id,d.user_id, e.user_id, f.user_id, g.user_id)\nlimit 500\n/* limit added automatically by dbt cloud */", 'compiled_sql': 'with cte_gender as ANALYTICS_DB.dbt_ecommerce_features.gender,\n\ncte_age as ANALYTICS_DB.dbt_ecommerce_features.age,\n\ncte_location as ANALYTICS_DB.dbt_ecommerce_features.country_and_state,\n\ncte_email_domain as ANALYTICS_DB.dbt_ecommerce_features.email_domain,\n\ncte_is_member as ANALYTICS_DB.dbt_ecommerce_features.is_member,\n\ncte_has_mobile_app as ANALYTICS_DB.dbt_ecommerce_features.has_mobile_app,\n\ncte_is_active_on_website as ANALYTICS_DB.dbt_ecommerce_features.is_active_on_website,\n\ncte_device_type as ANALYTICS_DB.dbt_ecommerce_features.device_type\n\nselect coalesce(a.user_id, b.user_id, c.user_id, d.user_id, e.user_id, f.user_id, g.user_id, h.user_id) \nas user_id, gender, c.country as country, c.state as state, email_domain, is_member, has_mobile_app, is_active_on_website, device_type\nfrom ((((((cte_gender a full outer join cte_age b on a.user_id = b.user_id) \nfull outer join cte_location c on c.user_id = coalesce(a.user_id, b.user_id))\nfull outer join cte_email_domain d on d.user_id = coalesce(a.user_id, b.user_id, c.user_id))\nfull outer join cte_is_member e on e.user_id = coalesce(a.user_id, b.user_id, c.user_id,d.user_id))\nfull outer join cte_has_mobile_app f on f.user_id = coalesce(a.user_id, b.user_id, c.user_id,d.user_id, e.user_id))\nfull outer join cte_is_active_on_website as g on g.user_id = coalesce(a.user_id, b.user_id, c.user_id,d.user_id, e.user_id, f.user_id))\nfull outer join cte_device_type as h on h.user_id = coalesce(a.user_id, b.user_id, c.user_id,d.user_id, e.user_id, f.user_id, g.user_id)\nlimit 500\n/* limit added automatically by dbt cloud */', 'tags': None}, None)
2022-07-07 09:36:03.841142 (Thread-242): handling poll request
2022-07-07 09:36:03.841562 (Thread-242): 09:36:03  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '8901092b-4e3c-4560-9d28-48dc5c91cc33', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9a203bb9a0>]}
2022-07-07 09:36:03.842273 (Thread-242): sending response (<Response 27055 bytes [200 OK]>) to 10.0.19.15
2022-07-07 09:36:12.220033 (Thread-243): handling status request
2022-07-07 09:36:12.220460 (Thread-243): 09:36:12  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '8901092b-4e3c-4560-9d28-48dc5c91cc33', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9a28694fd0>]}
2022-07-07 09:36:12.221048 (Thread-243): sending response (<Response 2732 bytes [200 OK]>) to 10.0.19.15
2022-07-07 09:36:12.564208 (Thread-244): handling compile_sql request
2022-07-07 09:36:12.564633 (Thread-244): 09:36:12  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '8901092b-4e3c-4560-9d28-48dc5c91cc33', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9a28694730>]}
2022-07-07 09:36:14.972567 (Thread-244): sending response (<Response 139 bytes [200 OK]>) to 10.0.19.15
2022-07-07 09:36:14.999676 (MainThread): 09:36:14  Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '84ba1e80-41e8-4658-8d9c-d94666e7efa3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f40c4df2a60>]}
2022-07-07 09:36:15.000260 (MainThread): 09:36:15  Found 18 models, 0 tests, 0 snapshots, 0 analyses, 181 macros, 0 operations, 0 seed files, 15 sources, 0 exposures, 0 metrics
2022-07-07 09:36:15.000889 (Thread-1): 09:36:15  Acquiring new snowflake connection "rpc.ecommerce_data_model_dbt.request"
2022-07-07 09:36:15.001024 (Thread-1): 09:36:15  Began compiling node rpc.ecommerce_data_model_dbt.request
2022-07-07 09:36:15.001120 (Thread-1): 09:36:15  Compiling rpc.ecommerce_data_model_dbt.request
2022-07-07 09:36:15.004750 (Thread-1): 09:36:15  finished collecting timing info
2022-07-07 09:36:15.004918 (Thread-1): 09:36:15  Began executing node rpc.ecommerce_data_model_dbt.request
2022-07-07 09:36:15.005021 (Thread-1): 09:36:15  finished collecting timing info
2022-07-07 09:36:15.309821 (Thread-245): handling poll request
2022-07-07 09:36:15.310301 (Thread-245): 09:36:15  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '8901092b-4e3c-4560-9d28-48dc5c91cc33', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9a28682d00>]}
2022-07-07 09:36:15.311541 (Thread-245): sending response (<Response 11648 bytes [200 OK]>) to 10.0.19.15
2022-07-07 09:37:14.321925 (Thread-246): handling status request
2022-07-07 09:37:14.322356 (Thread-246): 09:37:14  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '8901092b-4e3c-4560-9d28-48dc5c91cc33', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9a286825b0>]}
2022-07-07 09:37:14.322935 (Thread-246): sending response (<Response 2732 bytes [200 OK]>) to 10.0.19.15
2022-07-07 09:37:14.668547 (Thread-247): handling run_sql request
2022-07-07 09:37:14.669019 (Thread-247): 09:37:14  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '8901092b-4e3c-4560-9d28-48dc5c91cc33', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9a202f4070>]}
2022-07-07 09:37:17.051654 (Thread-247): sending response (<Response 139 bytes [200 OK]>) to 10.0.19.15
2022-07-07 09:37:17.080102 (MainThread): 09:37:17  Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '11680f82-f163-4ffe-add5-74c0f011ca20', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9c70670310>]}
2022-07-07 09:37:17.080711 (MainThread): 09:37:17  Found 18 models, 0 tests, 0 snapshots, 0 analyses, 181 macros, 0 operations, 0 seed files, 15 sources, 0 exposures, 0 metrics
2022-07-07 09:37:17.081366 (Thread-1): 09:37:17  Acquiring new snowflake connection "rpc.ecommerce_data_model_dbt.request"
2022-07-07 09:37:17.081503 (Thread-1): 09:37:17  Began compiling node rpc.ecommerce_data_model_dbt.request
2022-07-07 09:37:17.081602 (Thread-1): 09:37:17  Compiling rpc.ecommerce_data_model_dbt.request
2022-07-07 09:37:17.085344 (Thread-1): 09:37:17  finished collecting timing info
2022-07-07 09:37:17.085481 (Thread-1): 09:37:17  Began executing node rpc.ecommerce_data_model_dbt.request
2022-07-07 09:37:17.087678 (Thread-1): 09:37:17  Using snowflake connection "rpc.ecommerce_data_model_dbt.request"
2022-07-07 09:37:17.087781 (Thread-1): 09:37:17  On rpc.ecommerce_data_model_dbt.request: with cte_gender as ANALYTICS_DB.dbt_ecommerce_features.gender,

cte_age as ANALYTICS_DB.dbt_ecommerce_features.age,

cte_location as ANALYTICS_DB.dbt_ecommerce_features.country_and_state,

cte_email_domain as ANALYTICS_DB.dbt_ecommerce_features.email_domain,

cte_is_member as ANALYTICS_DB.dbt_ecommerce_features.is_member,

cte_has_mobile_app as ANALYTICS_DB.dbt_ecommerce_features.has_mobile_app,

cte_is_active_on_website as ANALYTICS_DB.dbt_ecommerce_features.is_active_on_website,

cte_device_type as ANALYTICS_DB.dbt_ecommerce_features.device_type

select coalesce(a.user_id, b.user_id, c.user_id, d.user_id, e.user_id, f.user_id, g.user_id, h.user_id) 
as user_id, gender, c.country as country, c.state as state, email_domain, is_member, has_mobile_app, is_active_on_website, device_type
from ((((((cte_gender a full outer join cte_age b on a.user_id = b.user_id) 
full outer join cte_location c on c.user_id = coalesce(a.user_id, b.user_id))
full outer join cte_email_domain d on d.user_id = coalesce(a.user_id, b.user_id, c.user_id))
full outer join cte_is_member e on e.user_id = coalesce(a.user_id, b.user_id, c.user_id,d.user_id))
full outer join cte_has_mobile_app f on f.user_id = coalesce(a.user_id, b.user_id, c.user_id,d.user_id, e.user_id))
full outer join cte_is_active_on_website as g on g.user_id = coalesce(a.user_id, b.user_id, c.user_id,d.user_id, e.user_id, f.user_id))
full outer join cte_device_type as h on h.user_id = coalesce(a.user_id, b.user_id, c.user_id,d.user_id, e.user_id, f.user_id, g.user_id)
limit 500
/* limit added automatically by dbt cloud */
2022-07-07 09:37:17.087865 (Thread-1): 09:37:17  Opening a new connection, currently in state init
2022-07-07 09:37:17.434762 (Thread-248): handling poll request
2022-07-07 09:37:17.435245 (Thread-248): 09:37:17  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '8901092b-4e3c-4560-9d28-48dc5c91cc33', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9a215eadc0>]}
2022-07-07 09:37:17.436204 (Thread-248): sending response (<Response 5351 bytes [200 OK]>) to 10.0.19.15
2022-07-07 09:37:17.706647 (Thread-1): 09:37:17  Snowflake adapter: Snowflake query id: 01a571c1-0602-3374-0019-8203046b5c8a
2022-07-07 09:37:17.706856 (Thread-1): 09:37:17  Snowflake adapter: Snowflake error: 001003 (42000): SQL compilation error:
syntax error line 1 at position 19 unexpected 'ANALYTICS_DB'.
syntax error line 1 at position 61 unexpected ','.
syntax error line 3 at position 11 unexpected 'ANALYTICS_DB'.
syntax error line 3 at position 50 unexpected ','.
syntax error line 5 at position 16 unexpected 'ANALYTICS_DB'.
syntax error line 5 at position 69 unexpected ','.
syntax error line 7 at position 20 unexpected 'ANALYTICS_DB'.
syntax error line 7 at position 68 unexpected ','.
syntax error line 9 at position 17 unexpected 'ANALYTICS_DB'.
syntax error line 9 at position 62 unexpected ','.
syntax error line 11 at position 22 unexpected 'ANALYTICS_DB'.
syntax error line 11 at position 72 unexpected ','.
syntax error line 13 at position 28 unexpected 'ANALYTICS_DB'.
syntax error line 13 at position 84 unexpected ','.
syntax error line 15 at position 19 unexpected 'ANALYTICS_DB'.
syntax error line 17 at position 16 unexpected 'a'.
syntax error line 18 at position 0 unexpected 'as'.
2022-07-07 09:37:17.707026 (Thread-1): 09:37:17  finished collecting timing info
2022-07-07 09:37:17.707192 (Thread-1): 09:37:17  On rpc.ecommerce_data_model_dbt.request: Close
2022-07-07 09:37:17.786479 (Thread-1): Got an exception: Database Error
  001003 (42000): SQL compilation error:
  syntax error line 1 at position 19 unexpected 'ANALYTICS_DB'.
  syntax error line 1 at position 61 unexpected ','.
  syntax error line 3 at position 11 unexpected 'ANALYTICS_DB'.
  syntax error line 3 at position 50 unexpected ','.
  syntax error line 5 at position 16 unexpected 'ANALYTICS_DB'.
  syntax error line 5 at position 69 unexpected ','.
  syntax error line 7 at position 20 unexpected 'ANALYTICS_DB'.
  syntax error line 7 at position 68 unexpected ','.
  syntax error line 9 at position 17 unexpected 'ANALYTICS_DB'.
  syntax error line 9 at position 62 unexpected ','.
  syntax error line 11 at position 22 unexpected 'ANALYTICS_DB'.
  syntax error line 11 at position 72 unexpected ','.
  syntax error line 13 at position 28 unexpected 'ANALYTICS_DB'.
  syntax error line 13 at position 84 unexpected ','.
  syntax error line 15 at position 19 unexpected 'ANALYTICS_DB'.
  syntax error line 17 at position 16 unexpected 'a'.
  syntax error line 18 at position 0 unexpected 'as'.
Traceback (most recent call last):
  File "/usr/local/lib/python3.8/dist-packages/dbt/adapters/snowflake/connections.py", line 206, in exception_handler
    yield
  File "/usr/local/lib/python3.8/dist-packages/dbt/adapters/sql/connections.py", line 74, in add_query
    cursor.execute(sql, bindings)
  File "/usr/local/lib/python3.8/dist-packages/snowflake/connector/cursor.py", line 721, in execute
    Error.errorhandler_wrapper(
  File "/usr/local/lib/python3.8/dist-packages/snowflake/connector/errors.py", line 258, in errorhandler_wrapper
    cursor.errorhandler(connection, cursor, error_class, error_value)
  File "/usr/local/lib/python3.8/dist-packages/snowflake/connector/errors.py", line 188, in default_errorhandler
    raise error_class(
snowflake.connector.errors.ProgrammingError: 001003 (42000): SQL compilation error:
syntax error line 1 at position 19 unexpected 'ANALYTICS_DB'.
syntax error line 1 at position 61 unexpected ','.
syntax error line 3 at position 11 unexpected 'ANALYTICS_DB'.
syntax error line 3 at position 50 unexpected ','.
syntax error line 5 at position 16 unexpected 'ANALYTICS_DB'.
syntax error line 5 at position 69 unexpected ','.
syntax error line 7 at position 20 unexpected 'ANALYTICS_DB'.
syntax error line 7 at position 68 unexpected ','.
syntax error line 9 at position 17 unexpected 'ANALYTICS_DB'.
syntax error line 9 at position 62 unexpected ','.
syntax error line 11 at position 22 unexpected 'ANALYTICS_DB'.
syntax error line 11 at position 72 unexpected ','.
syntax error line 13 at position 28 unexpected 'ANALYTICS_DB'.
syntax error line 13 at position 84 unexpected ','.
syntax error line 15 at position 19 unexpected 'ANALYTICS_DB'.
syntax error line 17 at position 16 unexpected 'a'.
syntax error line 18 at position 0 unexpected 'as'.

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/usr/local/lib/python3.8/dist-packages/dbt/task/base.py", line 361, in safe_run
    result = self.compile_and_execute(manifest, ctx)
  File "/usr/local/lib/python3.8/dist-packages/dbt/task/base.py", line 314, in compile_and_execute
    result = self.run(ctx.node, manifest)
  File "/usr/local/lib/python3.8/dist-packages/dbt/task/base.py", line 403, in run
    return self.execute(compiled_node, manifest)
  File "/usr/local/lib/python3.8/dist-packages/dbt_rpc/rpc/node_runners.py", line 90, in execute
    _, execute_result = self.adapter.execute(
  File "/usr/local/lib/python3.8/dist-packages/dbt/adapters/base/impl.py", line 225, in execute
    return self.connections.execute(
  File "/usr/local/lib/python3.8/dist-packages/dbt/adapters/sql/connections.py", line 127, in execute
    _, cursor = self.add_query(sql, auto_begin)
  File "/usr/local/lib/python3.8/dist-packages/dbt/adapters/snowflake/connections.py", line 433, in add_query
    connection, cursor = super().add_query(
  File "/usr/local/lib/python3.8/dist-packages/dbt/adapters/sql/connections.py", line 83, in add_query
    return connection, cursor
  File "/usr/lib/python3.8/contextlib.py", line 131, in __exit__
    self.gen.throw(type, value, traceback)
  File "/usr/local/lib/python3.8/dist-packages/dbt/adapters/snowflake/connections.py", line 223, in exception_handler
    raise DatabaseException(msg)
dbt.exceptions.DatabaseException: Database Error
  001003 (42000): SQL compilation error:
  syntax error line 1 at position 19 unexpected 'ANALYTICS_DB'.
  syntax error line 1 at position 61 unexpected ','.
  syntax error line 3 at position 11 unexpected 'ANALYTICS_DB'.
  syntax error line 3 at position 50 unexpected ','.
  syntax error line 5 at position 16 unexpected 'ANALYTICS_DB'.
  syntax error line 5 at position 69 unexpected ','.
  syntax error line 7 at position 20 unexpected 'ANALYTICS_DB'.
  syntax error line 7 at position 68 unexpected ','.
  syntax error line 9 at position 17 unexpected 'ANALYTICS_DB'.
  syntax error line 9 at position 62 unexpected ','.
  syntax error line 11 at position 22 unexpected 'ANALYTICS_DB'.
  syntax error line 11 at position 72 unexpected ','.
  syntax error line 13 at position 28 unexpected 'ANALYTICS_DB'.
  syntax error line 13 at position 84 unexpected ','.
  syntax error line 15 at position 19 unexpected 'ANALYTICS_DB'.
  syntax error line 17 at position 16 unexpected 'a'.
  syntax error line 18 at position 0 unexpected 'as'.
2022-07-07 09:37:17.787275 (Thread-1): Got exception RPCException(10003, Database Error, {'type': 'DatabaseException', 'message': "Database Error in rpc request (from remote system)\n  001003 (42000): SQL compilation error:\n  syntax error line 1 at position 19 unexpected 'ANALYTICS_DB'.\n  syntax error line 1 at position 61 unexpected ','.\n  syntax error line 3 at position 11 unexpected 'ANALYTICS_DB'.\n  syntax error line 3 at position 50 unexpected ','.\n  syntax error line 5 at position 16 unexpected 'ANALYTICS_DB'.\n  syntax error line 5 at position 69 unexpected ','.\n  syntax error line 7 at position 20 unexpected 'ANALYTICS_DB'.\n  syntax error line 7 at position 68 unexpected ','.\n  syntax error line 9 at position 17 unexpected 'ANALYTICS_DB'.\n  syntax error line 9 at position 62 unexpected ','.\n  syntax error line 11 at position 22 unexpected 'ANALYTICS_DB'.\n  syntax error line 11 at position 72 unexpected ','.\n  syntax error line 13 at position 28 unexpected 'ANALYTICS_DB'.\n  syntax error line 13 at position 84 unexpected ','.\n  syntax error line 15 at position 19 unexpected 'ANALYTICS_DB'.\n  syntax error line 17 at position 16 unexpected 'a'.\n  syntax error line 18 at position 0 unexpected 'as'.", 'raw_sql': "with cte_gender as {{ ref('gender') }},\r\n\r\ncte_age as {{ ref('age') }},\r\n\r\ncte_location as {{ ref('country_and_state') }},\r\n\r\ncte_email_domain as {{ ref('email_domain') }},\r\n\r\ncte_is_member as {{ ref('is_member') }},\r\n\r\ncte_has_mobile_app as {{ ref('has_mobile_app') }},\r\n\r\ncte_is_active_on_website as {{ ref('is_active_on_website') }},\r\n\r\ncte_device_type as {{ ref('device_type') }}\r\n\r\nselect coalesce(a.user_id, b.user_id, c.user_id, d.user_id, e.user_id, f.user_id, g.user_id, h.user_id) \r\nas user_id, gender, c.country as country, c.state as state, email_domain, is_member, has_mobile_app, is_active_on_website, device_type\r\nfrom ((((((cte_gender a full outer join cte_age b on a.user_id = b.user_id) \r\nfull outer join cte_location c on c.user_id = coalesce(a.user_id, b.user_id))\r\nfull outer join cte_email_domain d on d.user_id = coalesce(a.user_id, b.user_id, c.user_id))\r\nfull outer join cte_is_member e on e.user_id = coalesce(a.user_id, b.user_id, c.user_id,d.user_id))\r\nfull outer join cte_has_mobile_app f on f.user_id = coalesce(a.user_id, b.user_id, c.user_id,d.user_id, e.user_id))\r\nfull outer join cte_is_active_on_website as g on g.user_id = coalesce(a.user_id, b.user_id, c.user_id,d.user_id, e.user_id, f.user_id))\r\nfull outer join cte_device_type as h on h.user_id = coalesce(a.user_id, b.user_id, c.user_id,d.user_id, e.user_id, f.user_id, g.user_id)\nlimit 500\n/* limit added automatically by dbt cloud */", 'compiled_sql': 'with cte_gender as ANALYTICS_DB.dbt_ecommerce_features.gender,\n\ncte_age as ANALYTICS_DB.dbt_ecommerce_features.age,\n\ncte_location as ANALYTICS_DB.dbt_ecommerce_features.country_and_state,\n\ncte_email_domain as ANALYTICS_DB.dbt_ecommerce_features.email_domain,\n\ncte_is_member as ANALYTICS_DB.dbt_ecommerce_features.is_member,\n\ncte_has_mobile_app as ANALYTICS_DB.dbt_ecommerce_features.has_mobile_app,\n\ncte_is_active_on_website as ANALYTICS_DB.dbt_ecommerce_features.is_active_on_website,\n\ncte_device_type as ANALYTICS_DB.dbt_ecommerce_features.device_type\n\nselect coalesce(a.user_id, b.user_id, c.user_id, d.user_id, e.user_id, f.user_id, g.user_id, h.user_id) \nas user_id, gender, c.country as country, c.state as state, email_domain, is_member, has_mobile_app, is_active_on_website, device_type\nfrom ((((((cte_gender a full outer join cte_age b on a.user_id = b.user_id) \nfull outer join cte_location c on c.user_id = coalesce(a.user_id, b.user_id))\nfull outer join cte_email_domain d on d.user_id = coalesce(a.user_id, b.user_id, c.user_id))\nfull outer join cte_is_member e on e.user_id = coalesce(a.user_id, b.user_id, c.user_id,d.user_id))\nfull outer join cte_has_mobile_app f on f.user_id = coalesce(a.user_id, b.user_id, c.user_id,d.user_id, e.user_id))\nfull outer join cte_is_active_on_website as g on g.user_id = coalesce(a.user_id, b.user_id, c.user_id,d.user_id, e.user_id, f.user_id))\nfull outer join cte_device_type as h on h.user_id = coalesce(a.user_id, b.user_id, c.user_id,d.user_id, e.user_id, f.user_id, g.user_id)\nlimit 500\n/* limit added automatically by dbt cloud */', 'tags': None}, None)
Traceback (most recent call last):
  File "/usr/local/lib/python3.8/dist-packages/dbt_rpc/task/sql_commands.py", line 147, in _in_thread
    self.node_results.append(runner.safe_run(self.manifest))
  File "/usr/local/lib/python3.8/dist-packages/dbt/task/base.py", line 377, in safe_run
    result = self.error_result(ctx.node, error, started, [])
  File "/usr/local/lib/python3.8/dist-packages/dbt_rpc/rpc/node_runners.py", line 56, in error_result
    raise error
dbt_rpc.rpc.error.RPCException: RPCException(10003, Database Error, {'type': 'DatabaseException', 'message': "Database Error in rpc request (from remote system)\n  001003 (42000): SQL compilation error:\n  syntax error line 1 at position 19 unexpected 'ANALYTICS_DB'.\n  syntax error line 1 at position 61 unexpected ','.\n  syntax error line 3 at position 11 unexpected 'ANALYTICS_DB'.\n  syntax error line 3 at position 50 unexpected ','.\n  syntax error line 5 at position 16 unexpected 'ANALYTICS_DB'.\n  syntax error line 5 at position 69 unexpected ','.\n  syntax error line 7 at position 20 unexpected 'ANALYTICS_DB'.\n  syntax error line 7 at position 68 unexpected ','.\n  syntax error line 9 at position 17 unexpected 'ANALYTICS_DB'.\n  syntax error line 9 at position 62 unexpected ','.\n  syntax error line 11 at position 22 unexpected 'ANALYTICS_DB'.\n  syntax error line 11 at position 72 unexpected ','.\n  syntax error line 13 at position 28 unexpected 'ANALYTICS_DB'.\n  syntax error line 13 at position 84 unexpected ','.\n  syntax error line 15 at position 19 unexpected 'ANALYTICS_DB'.\n  syntax error line 17 at position 16 unexpected 'a'.\n  syntax error line 18 at position 0 unexpected 'as'.", 'raw_sql': "with cte_gender as {{ ref('gender') }},\r\n\r\ncte_age as {{ ref('age') }},\r\n\r\ncte_location as {{ ref('country_and_state') }},\r\n\r\ncte_email_domain as {{ ref('email_domain') }},\r\n\r\ncte_is_member as {{ ref('is_member') }},\r\n\r\ncte_has_mobile_app as {{ ref('has_mobile_app') }},\r\n\r\ncte_is_active_on_website as {{ ref('is_active_on_website') }},\r\n\r\ncte_device_type as {{ ref('device_type') }}\r\n\r\nselect coalesce(a.user_id, b.user_id, c.user_id, d.user_id, e.user_id, f.user_id, g.user_id, h.user_id) \r\nas user_id, gender, c.country as country, c.state as state, email_domain, is_member, has_mobile_app, is_active_on_website, device_type\r\nfrom ((((((cte_gender a full outer join cte_age b on a.user_id = b.user_id) \r\nfull outer join cte_location c on c.user_id = coalesce(a.user_id, b.user_id))\r\nfull outer join cte_email_domain d on d.user_id = coalesce(a.user_id, b.user_id, c.user_id))\r\nfull outer join cte_is_member e on e.user_id = coalesce(a.user_id, b.user_id, c.user_id,d.user_id))\r\nfull outer join cte_has_mobile_app f on f.user_id = coalesce(a.user_id, b.user_id, c.user_id,d.user_id, e.user_id))\r\nfull outer join cte_is_active_on_website as g on g.user_id = coalesce(a.user_id, b.user_id, c.user_id,d.user_id, e.user_id, f.user_id))\r\nfull outer join cte_device_type as h on h.user_id = coalesce(a.user_id, b.user_id, c.user_id,d.user_id, e.user_id, f.user_id, g.user_id)\nlimit 500\n/* limit added automatically by dbt cloud */", 'compiled_sql': 'with cte_gender as ANALYTICS_DB.dbt_ecommerce_features.gender,\n\ncte_age as ANALYTICS_DB.dbt_ecommerce_features.age,\n\ncte_location as ANALYTICS_DB.dbt_ecommerce_features.country_and_state,\n\ncte_email_domain as ANALYTICS_DB.dbt_ecommerce_features.email_domain,\n\ncte_is_member as ANALYTICS_DB.dbt_ecommerce_features.is_member,\n\ncte_has_mobile_app as ANALYTICS_DB.dbt_ecommerce_features.has_mobile_app,\n\ncte_is_active_on_website as ANALYTICS_DB.dbt_ecommerce_features.is_active_on_website,\n\ncte_device_type as ANALYTICS_DB.dbt_ecommerce_features.device_type\n\nselect coalesce(a.user_id, b.user_id, c.user_id, d.user_id, e.user_id, f.user_id, g.user_id, h.user_id) \nas user_id, gender, c.country as country, c.state as state, email_domain, is_member, has_mobile_app, is_active_on_website, device_type\nfrom ((((((cte_gender a full outer join cte_age b on a.user_id = b.user_id) \nfull outer join cte_location c on c.user_id = coalesce(a.user_id, b.user_id))\nfull outer join cte_email_domain d on d.user_id = coalesce(a.user_id, b.user_id, c.user_id))\nfull outer join cte_is_member e on e.user_id = coalesce(a.user_id, b.user_id, c.user_id,d.user_id))\nfull outer join cte_has_mobile_app f on f.user_id = coalesce(a.user_id, b.user_id, c.user_id,d.user_id, e.user_id))\nfull outer join cte_is_active_on_website as g on g.user_id = coalesce(a.user_id, b.user_id, c.user_id,d.user_id, e.user_id, f.user_id))\nfull outer join cte_device_type as h on h.user_id = coalesce(a.user_id, b.user_id, c.user_id,d.user_id, e.user_id, f.user_id, g.user_id)\nlimit 500\n/* limit added automatically by dbt cloud */', 'tags': None}, None)
2022-07-07 09:37:18.778158 (Thread-249): handling poll request
2022-07-07 09:37:18.778571 (Thread-249): 09:37:18  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '8901092b-4e3c-4560-9d28-48dc5c91cc33', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9a28055f70>]}
2022-07-07 09:37:18.779264 (Thread-249): sending response (<Response 27055 bytes [200 OK]>) to 10.0.19.15
2022-07-07 09:37:37.047177 (Thread-250): handling status request
2022-07-07 09:37:37.048037 (Thread-250): 09:37:37  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '8901092b-4e3c-4560-9d28-48dc5c91cc33', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9a215ea9a0>]}
2022-07-07 09:37:37.048611 (Thread-250): sending response (<Response 2732 bytes [200 OK]>) to 10.0.19.15
2022-07-07 09:37:37.395877 (Thread-251): handling compile_sql request
2022-07-07 09:37:37.396303 (Thread-251): 09:37:37  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '8901092b-4e3c-4560-9d28-48dc5c91cc33', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9a20238e20>]}
2022-07-07 09:37:39.801475 (Thread-251): sending response (<Response 139 bytes [200 OK]>) to 10.0.19.15
2022-07-07 09:37:39.828612 (MainThread): 09:37:39  Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '93de40ff-0624-4104-b95e-1c02c7f461bb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f104f0b9a00>]}
2022-07-07 09:37:39.829202 (MainThread): 09:37:39  Found 18 models, 0 tests, 0 snapshots, 0 analyses, 181 macros, 0 operations, 0 seed files, 15 sources, 0 exposures, 0 metrics
2022-07-07 09:37:39.829827 (Thread-1): 09:37:39  Acquiring new snowflake connection "rpc.ecommerce_data_model_dbt.request"
2022-07-07 09:37:39.829962 (Thread-1): 09:37:39  Began compiling node rpc.ecommerce_data_model_dbt.request
2022-07-07 09:37:39.830063 (Thread-1): 09:37:39  Compiling rpc.ecommerce_data_model_dbt.request
2022-07-07 09:37:39.833773 (Thread-1): 09:37:39  finished collecting timing info
2022-07-07 09:37:39.833908 (Thread-1): 09:37:39  Began executing node rpc.ecommerce_data_model_dbt.request
2022-07-07 09:37:39.834008 (Thread-1): 09:37:39  finished collecting timing info
2022-07-07 09:37:40.132090 (Thread-252): handling poll request
2022-07-07 09:37:40.132582 (Thread-252): 09:37:40  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '8901092b-4e3c-4560-9d28-48dc5c91cc33', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9a20179f40>]}
2022-07-07 09:37:40.133825 (Thread-252): sending response (<Response 11649 bytes [200 OK]>) to 10.0.19.15
2022-07-07 09:41:15.423199 (Thread-253): handling status request
2022-07-07 09:41:15.425012 (Thread-253): 09:41:15  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '8901092b-4e3c-4560-9d28-48dc5c91cc33', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9a2157a3d0>]}
2022-07-07 09:41:15.425599 (Thread-253): sending response (<Response 2709 bytes [200 OK]>) to 10.0.19.15
2022-07-07 09:41:15.429831 (Thread-254): handling status request
2022-07-07 09:41:15.430153 (Thread-254): 09:41:15  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '8901092b-4e3c-4560-9d28-48dc5c91cc33', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9a2157a6d0>]}
2022-07-07 09:41:15.430625 (Thread-254): sending response (<Response 2709 bytes [200 OK]>) to 10.0.19.15
2022-07-07 09:41:15.434505 (Thread-255): handling list request
2022-07-07 09:41:15.434800 (Thread-255): 09:41:15  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '8901092b-4e3c-4560-9d28-48dc5c91cc33', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9a2157aca0>]}
2022-07-07 09:41:15.501117 (Thread-256): sending response (<Response 214 bytes [200 OK]>) to 10.0.19.15
2022-07-07 09:41:16.823534 (Thread-257): handling status request
2022-07-07 09:41:16.823938 (Thread-257): 09:41:16  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '8901092b-4e3c-4560-9d28-48dc5c91cc33', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9a286b3eb0>]}
2022-07-07 09:41:16.824446 (Thread-257): sending response (<Response 2709 bytes [200 OK]>) to 10.0.19.15
2022-07-07 09:41:16.833717 (Thread-258): handling list request
2022-07-07 09:41:16.834091 (Thread-258): 09:41:16  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '8901092b-4e3c-4560-9d28-48dc5c91cc33', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9a286b3790>]}
2022-07-07 09:41:16.866719 (Thread-258): 09:41:16  Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '8901092b-4e3c-4560-9d28-48dc5c91cc33', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9a2157aaf0>]}
2022-07-07 09:41:16.867120 (Thread-258): 09:41:16  Found 18 models, 0 tests, 0 snapshots, 0 analyses, 181 macros, 0 operations, 0 seed files, 15 sources, 0 exposures, 0 metrics
2022-07-07 09:41:16.870815 (Thread-258): sending response (<Response 6933 bytes [200 OK]>) to 10.0.19.15
2022-07-07 09:42:46.267760 (Thread-259): handling status request
2022-07-07 09:42:46.269658 (Thread-259): 09:42:46  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '8901092b-4e3c-4560-9d28-48dc5c91cc33', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9a287bf1f0>]}
2022-07-07 09:42:46.270166 (Thread-259): sending response (<Response 2732 bytes [200 OK]>) to 10.0.19.15
2022-07-07 09:42:46.605618 (Thread-260): handling run_sql request
2022-07-07 09:42:46.606018 (Thread-260): 09:42:46  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '8901092b-4e3c-4560-9d28-48dc5c91cc33', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9a287bfa60>]}
2022-07-07 09:42:48.985604 (Thread-260): sending response (<Response 139 bytes [200 OK]>) to 10.0.19.15
2022-07-07 09:42:49.010437 (MainThread): 09:42:49  Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '9d77172e-b6cf-4c5f-827d-88738cee6b36', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffa8e9389d0>]}
2022-07-07 09:42:49.010979 (MainThread): 09:42:49  Found 18 models, 0 tests, 0 snapshots, 0 analyses, 181 macros, 0 operations, 0 seed files, 15 sources, 0 exposures, 0 metrics
2022-07-07 09:42:49.011590 (Thread-1): 09:42:49  Acquiring new snowflake connection "rpc.ecommerce_data_model_dbt.request"
2022-07-07 09:42:49.011733 (Thread-1): 09:42:49  Began compiling node rpc.ecommerce_data_model_dbt.request
2022-07-07 09:42:49.011834 (Thread-1): 09:42:49  Compiling rpc.ecommerce_data_model_dbt.request
2022-07-07 09:42:49.014446 (Thread-1): 09:42:49  finished collecting timing info
2022-07-07 09:42:49.014577 (Thread-1): 09:42:49  Began executing node rpc.ecommerce_data_model_dbt.request
2022-07-07 09:42:49.015913 (Thread-1): 09:42:49  Using snowflake connection "rpc.ecommerce_data_model_dbt.request"
2022-07-07 09:42:49.016004 (Thread-1): 09:42:49  On rpc.ecommerce_data_model_dbt.request: with cte_id_stitched_identifies as 
(select distinct b.main_id as main_id, properties_gender, properties_birthday, timestamp from analytics_db.data_apps_simulated.identifies a left join 
ANALYTICS_DB.DATA_APPS_SIMULATED.MATERIAL_DOMAIN_PROFILE__IDSTITCHER_DC3F9DA0_12 b 
on (a.user_id = b.other_id and b.other_id_type = 'user_id') or (a.properties_email = b.other_id and b.other_id_type = 'email'))
select distinct main_id, 
first_value(properties_gender)
over(partition by main_id order by case when properties_gender is not null and properties_gender != '' then 2 else 1 end desc, timestamp desc) as gender,
first_value(properties_birthday)
over(partition by main_id order by case when properties_birthday is not null and properties_birthday != '' then 2 else 1 end desc, timestamp desc) as dob
from cte_id_stitched_identifies where timestamp >= '2021-05-01' and timestamp <= '2022-06-29' and main_id is not null
limit 500
/* limit added automatically by dbt cloud */
2022-07-07 09:42:49.016090 (Thread-1): 09:42:49  Opening a new connection, currently in state init
2022-07-07 09:42:49.346452 (Thread-261): handling poll request
2022-07-07 09:42:49.346926 (Thread-261): 09:42:49  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '8901092b-4e3c-4560-9d28-48dc5c91cc33', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9a286b39a0>]}
2022-07-07 09:42:49.347756 (Thread-261): sending response (<Response 4725 bytes [200 OK]>) to 10.0.19.15
2022-07-07 09:42:50.708015 (Thread-262): handling poll request
2022-07-07 09:42:50.708443 (Thread-262): 09:42:50  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '8901092b-4e3c-4560-9d28-48dc5c91cc33', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9a286b3790>]}
2022-07-07 09:42:50.708967 (Thread-262): sending response (<Response 409 bytes [200 OK]>) to 10.0.19.15
2022-07-07 09:42:50.760969 (Thread-1): 09:42:50  SQL status: SUCCESS 4 in 1.74 seconds
2022-07-07 09:42:50.762429 (Thread-1): 09:42:50  finished collecting timing info
2022-07-07 09:42:50.762688 (Thread-1): 09:42:50  On rpc.ecommerce_data_model_dbt.request: Close
2022-07-07 09:42:52.052170 (Thread-263): handling poll request
2022-07-07 09:42:52.052597 (Thread-263): 09:42:52  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '8901092b-4e3c-4560-9d28-48dc5c91cc33', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9a20130d60>]}
2022-07-07 09:42:52.053505 (Thread-263): sending response (<Response 7463 bytes [200 OK]>) to 10.0.19.15
2022-07-07 09:55:08.379855 (Thread-264): handling status request
2022-07-07 09:55:08.381692 (Thread-264): 09:55:08  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '8901092b-4e3c-4560-9d28-48dc5c91cc33', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9a201a63d0>]}
2022-07-07 09:55:08.383141 (Thread-265): handling status request
2022-07-07 09:55:08.384731 (Thread-265): 09:55:08  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '8901092b-4e3c-4560-9d28-48dc5c91cc33', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9a287e1bb0>]}
2022-07-07 09:55:08.402879 (Thread-264): sending response (<Response 2709 bytes [200 OK]>) to 10.0.19.15
2022-07-07 09:55:08.403325 (Thread-265): sending response (<Response 2709 bytes [200 OK]>) to 10.0.19.15
2022-07-07 09:55:08.410106 (Thread-266): handling list request
2022-07-07 09:55:08.410789 (Thread-267): handling list request
2022-07-07 09:55:08.411166 (Thread-266): 09:55:08  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '8901092b-4e3c-4560-9d28-48dc5c91cc33', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9a201a6160>]}
2022-07-07 09:55:08.411455 (Thread-267): 09:55:08  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '8901092b-4e3c-4560-9d28-48dc5c91cc33', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9a201a69a0>]}
2022-07-07 09:55:08.454152 (Thread-266): 09:55:08  Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '8901092b-4e3c-4560-9d28-48dc5c91cc33', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9a287e17f0>]}
2022-07-07 09:55:08.454541 (Thread-266): 09:55:08  Found 18 models, 0 tests, 0 snapshots, 0 analyses, 181 macros, 0 operations, 0 seed files, 15 sources, 0 exposures, 0 metrics
2022-07-07 09:55:08.455314 (Thread-267): 09:55:08  Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '8901092b-4e3c-4560-9d28-48dc5c91cc33', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9a28763460>]}
2022-07-07 09:55:08.465610 (Thread-266): sending response (<Response 1694 bytes [200 OK]>) to 10.0.19.15
2022-07-07 09:55:08.455594 (Thread-267): 09:55:08  Found 18 models, 0 tests, 0 snapshots, 0 analyses, 181 macros, 0 operations, 0 seed files, 15 sources, 0 exposures, 0 metrics
2022-07-07 09:55:08.466701 (Thread-267): sending response (<Response 2817 bytes [200 OK]>) to 10.0.19.15
2022-07-08 05:57:11.347946 (MainThread): Running with dbt=1.0.8
2022-07-08 05:57:11.625022 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt_rpc.task.server.RPCServerTask'>, debug=None, defer=None, exclude=None, fail_fast=None, host='0.0.0.0', log_cache_events=False, log_format=None, models=None, partial_parse=True, port=8580, printer_width=None, profile='user', profiles_dir='/usr/src/develop/.dbt', project_dir=None, record_timing_info=None, rpc_method=None, send_anonymous_usage_stats=None, single_threaded=False, state=None, static_parser=None, target=None, threads=None, use_colors=None, use_experimental_parser=None, vars='{}', version_check=None, warn_error=None, which='rpc', write_json=None)
2022-07-08 05:57:11.633766 (MainThread): Tracking: tracking
2022-07-08 05:57:11.634118 (MainThread): 05:57:11  Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4f68956160>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4f2fa41850>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4f2fa41d30>]}
2022-07-08 05:57:11.634518 (MainThread): Serving RPC server at 0.0.0.0:8580, pid=22
2022-07-08 05:57:11.635152 (MainThread): Supported methods: ['build', 'cli_args', 'compile', 'compile_sql', 'deps', 'docs.generate', 'gc', 'get-manifest', 'kill', 'list', 'poll', 'ps', 'run', 'run-operation', 'run_sql', 'seed', 'snapshot', 'snapshot-freshness', 'source-freshness', 'status', 'test']
2022-07-08 05:57:11.640135 (MainThread): Send requests to http://localhost:8580/jsonrpc
2022-07-08 05:57:11.792749 (Thread-12): 05:57:11  Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
2022-07-08 05:57:11.793000 (Thread-12): 05:57:11  Partial parsing enabled, no changes found, skipping parsing
2022-07-08 05:57:11.793863 (Thread-12): 05:57:11  [WARNING]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.data-apps-ecommerce-template.data_model

2022-07-08 05:57:11.801074 (Thread-12): 05:57:11  Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '78f3b6e0-4584-4822-b7bb-4d1427a5d8b5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4f2d8c0e50>]}
2022-07-08 05:57:14.593422 (Thread-13): handling status request
2022-07-08 05:57:14.593916 (Thread-13): 05:57:14  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '78f3b6e0-4584-4822-b7bb-4d1427a5d8b5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4f2d9ac070>]}
2022-07-08 05:57:14.594560 (Thread-13): sending response (<Response 1699 bytes [200 OK]>) to 10.0.5.222
2022-07-08 05:57:14.719189 (Thread-14): handling status request
2022-07-08 05:57:14.719618 (Thread-14): 05:57:14  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '78f3b6e0-4584-4822-b7bb-4d1427a5d8b5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4f2d928f10>]}
2022-07-08 05:57:14.720107 (Thread-14): sending response (<Response 1699 bytes [200 OK]>) to 10.0.5.222
2022-07-08 05:57:14.737675 (Thread-15): handling status request
2022-07-08 05:57:14.738071 (Thread-15): 05:57:14  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '78f3b6e0-4584-4822-b7bb-4d1427a5d8b5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4f2d928d60>]}
2022-07-08 05:57:14.738537 (Thread-15): sending response (<Response 1699 bytes [200 OK]>) to 10.0.5.222
2022-07-08 05:57:14.768871 (Thread-16): handling ps request
2022-07-08 05:57:14.769266 (Thread-16): 05:57:14  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '78f3b6e0-4584-4822-b7bb-4d1427a5d8b5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4f2d928ca0>]}
2022-07-08 05:57:14.769782 (Thread-16): sending response (<Response 106 bytes [200 OK]>) to 10.0.5.222
2022-07-08 05:57:16.790122 (Thread-17): handling status request
2022-07-08 05:57:16.790577 (Thread-17): 05:57:16  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '78f3b6e0-4584-4822-b7bb-4d1427a5d8b5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4f2fa30850>]}
2022-07-08 05:57:16.791090 (Thread-17): sending response (<Response 1676 bytes [200 OK]>) to 10.0.5.222
2022-07-08 05:57:16.810289 (Thread-18): handling list request
2022-07-08 05:57:16.810702 (Thread-18): 05:57:16  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '78f3b6e0-4584-4822-b7bb-4d1427a5d8b5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4f2fa30940>]}
2022-07-08 05:57:16.849875 (Thread-18): 05:57:16  Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '78f3b6e0-4584-4822-b7bb-4d1427a5d8b5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4f2d9ac400>]}
2022-07-08 05:57:16.850288 (Thread-18): 05:57:16  Found 18 models, 0 tests, 0 snapshots, 0 analyses, 181 macros, 0 operations, 0 seed files, 15 sources, 0 exposures, 0 metrics
2022-07-08 05:57:16.853695 (Thread-18): sending response (<Response 2712 bytes [200 OK]>) to 10.0.5.222
2022-07-08 05:57:16.963256 (Thread-19): handling status request
2022-07-08 05:57:16.963714 (Thread-19): 05:57:16  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '78f3b6e0-4584-4822-b7bb-4d1427a5d8b5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4f2d8c5be0>]}
2022-07-08 05:57:16.964229 (Thread-19): sending response (<Response 1699 bytes [200 OK]>) to 10.0.5.222
2022-07-08 05:57:29.984790 (Thread-20): handling status request
2022-07-08 05:57:29.986645 (Thread-20): 05:57:29  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '78f3b6e0-4584-4822-b7bb-4d1427a5d8b5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4f2d8c57f0>]}
2022-07-08 05:57:29.987129 (Thread-20): sending response (<Response 1676 bytes [200 OK]>) to 10.0.5.222
2022-07-08 05:57:29.994001 (Thread-21): handling list request
2022-07-08 05:57:29.994317 (Thread-21): 05:57:29  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '78f3b6e0-4584-4822-b7bb-4d1427a5d8b5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4f2d8c5bb0>]}
2022-07-08 05:57:30.028417 (Thread-21): 05:57:30  Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '78f3b6e0-4584-4822-b7bb-4d1427a5d8b5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4f2fa30850>]}
2022-07-08 05:57:30.028810 (Thread-21): 05:57:30  Found 18 models, 0 tests, 0 snapshots, 0 analyses, 181 macros, 0 operations, 0 seed files, 15 sources, 0 exposures, 0 metrics
2022-07-08 05:57:30.033265 (Thread-21): sending response (<Response 2098 bytes [200 OK]>) to 10.0.5.222
2022-07-08 05:57:30.287784 (Thread-22): handling status request
2022-07-08 05:57:30.288213 (Thread-22): 05:57:30  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '78f3b6e0-4584-4822-b7bb-4d1427a5d8b5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4f2e9c13a0>]}
2022-07-08 05:57:30.288703 (Thread-22): sending response (<Response 1676 bytes [200 OK]>) to 10.0.5.222
2022-07-08 05:57:30.295711 (Thread-23): handling list request
2022-07-08 05:57:30.296072 (Thread-23): 05:57:30  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '78f3b6e0-4584-4822-b7bb-4d1427a5d8b5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4f2d8c88e0>]}
2022-07-08 05:57:30.322549 (Thread-23): 05:57:30  Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '78f3b6e0-4584-4822-b7bb-4d1427a5d8b5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4f2d8c8f10>]}
2022-07-08 05:57:30.322952 (Thread-23): 05:57:30  Found 18 models, 0 tests, 0 snapshots, 0 analyses, 181 macros, 0 operations, 0 seed files, 15 sources, 0 exposures, 0 metrics
2022-07-08 05:57:30.327943 (Thread-23): sending response (<Response 2070 bytes [200 OK]>) to 10.0.5.222
2022-07-08 05:57:31.162065 (Thread-24): handling status request
2022-07-08 05:57:31.162467 (Thread-24): 05:57:31  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '78f3b6e0-4584-4822-b7bb-4d1427a5d8b5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4f2d8a29a0>]}
2022-07-08 05:57:31.162939 (Thread-24): sending response (<Response 1676 bytes [200 OK]>) to 10.0.5.222
2022-07-08 05:57:31.169528 (Thread-25): handling list request
2022-07-08 05:57:31.169908 (Thread-25): 05:57:31  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '78f3b6e0-4584-4822-b7bb-4d1427a5d8b5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4f2d8a2e50>]}
2022-07-08 05:57:31.200949 (Thread-25): 05:57:31  Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '78f3b6e0-4584-4822-b7bb-4d1427a5d8b5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4f2d8a2d30>]}
2022-07-08 05:57:31.201343 (Thread-25): 05:57:31  Found 18 models, 0 tests, 0 snapshots, 0 analyses, 181 macros, 0 operations, 0 seed files, 15 sources, 0 exposures, 0 metrics
2022-07-08 05:57:31.206762 (Thread-25): sending response (<Response 3035 bytes [200 OK]>) to 10.0.5.222
2022-07-08 05:57:31.924847 (Thread-26): handling status request
2022-07-08 05:57:31.925287 (Thread-26): 05:57:31  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '78f3b6e0-4584-4822-b7bb-4d1427a5d8b5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4f2d8a2f70>]}
2022-07-08 05:57:31.925853 (Thread-26): sending response (<Response 1676 bytes [200 OK]>) to 10.0.5.222
2022-07-08 05:57:31.972615 (Thread-27): handling list request
2022-07-08 05:57:31.973065 (Thread-27): 05:57:31  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '78f3b6e0-4584-4822-b7bb-4d1427a5d8b5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4f2d8b5bb0>]}
2022-07-08 05:57:32.008079 (Thread-27): 05:57:32  Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '78f3b6e0-4584-4822-b7bb-4d1427a5d8b5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4f2d8a23d0>]}
2022-07-08 05:57:32.008474 (Thread-27): 05:57:32  Found 18 models, 0 tests, 0 snapshots, 0 analyses, 181 macros, 0 operations, 0 seed files, 15 sources, 0 exposures, 0 metrics
2022-07-08 05:57:32.011527 (Thread-27): 05:57:32  The selection criterion '+models/data_model/stg_traits/device_type.sql+' does not match any nodes
2022-07-08 05:57:32.011735 (Thread-27): 05:57:32  No nodes selected!
2022-07-08 05:57:32.013360 (Thread-27): sending response (<Response 1955 bytes [200 OK]>) to 10.0.5.222
2022-07-08 05:57:35.263571 (Thread-28): handling status request
2022-07-08 05:57:35.263982 (Thread-28): 05:57:35  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '78f3b6e0-4584-4822-b7bb-4d1427a5d8b5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4f2c03ca90>]}
2022-07-08 05:57:35.264476 (Thread-28): sending response (<Response 1676 bytes [200 OK]>) to 10.0.5.222
2022-07-08 05:57:35.270958 (Thread-29): handling list request
2022-07-08 05:57:35.271246 (Thread-29): 05:57:35  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '78f3b6e0-4584-4822-b7bb-4d1427a5d8b5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4f2c04b0d0>]}
2022-07-08 05:57:35.305883 (Thread-29): 05:57:35  Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '78f3b6e0-4584-4822-b7bb-4d1427a5d8b5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4f2d8b5880>]}
2022-07-08 05:57:35.306280 (Thread-29): 05:57:35  Found 18 models, 0 tests, 0 snapshots, 0 analyses, 181 macros, 0 operations, 0 seed files, 15 sources, 0 exposures, 0 metrics
2022-07-08 05:57:35.312107 (Thread-29): sending response (<Response 6931 bytes [200 OK]>) to 10.0.5.222
2022-07-08 05:59:04.539150 (Thread-30): handling status request
2022-07-08 05:59:04.541173 (Thread-30): 05:59:04  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '78f3b6e0-4584-4822-b7bb-4d1427a5d8b5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4f2c04b5e0>]}
2022-07-08 05:59:04.541718 (Thread-30): sending response (<Response 1699 bytes [200 OK]>) to 10.0.5.222
2022-07-08 05:59:04.925067 (Thread-31): handling run_sql request
2022-07-08 05:59:04.925513 (Thread-31): 05:59:04  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '78f3b6e0-4584-4822-b7bb-4d1427a5d8b5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4f2c044100>]}
2022-07-08 05:59:07.314562 (Thread-31): sending response (<Response 139 bytes [200 OK]>) to 10.0.5.222
2022-07-08 05:59:07.343882 (MainThread): 05:59:07  Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '5a84a82b-a77f-4ed8-a0d0-c645eaedf935', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe919373d60>]}
2022-07-08 05:59:07.344496 (MainThread): 05:59:07  Found 18 models, 0 tests, 0 snapshots, 0 analyses, 181 macros, 0 operations, 0 seed files, 15 sources, 0 exposures, 0 metrics
2022-07-08 05:59:07.345144 (Thread-1): 05:59:07  Acquiring new snowflake connection "rpc.ecommerce_data_model_dbt.request"
2022-07-08 05:59:07.345288 (Thread-1): 05:59:07  Began compiling node rpc.ecommerce_data_model_dbt.request
2022-07-08 05:59:07.345412 (Thread-1): 05:59:07  Compiling rpc.ecommerce_data_model_dbt.request
2022-07-08 05:59:07.348545 (Thread-1): 05:59:07  finished collecting timing info
2022-07-08 05:59:07.348695 (Thread-1): 05:59:07  Began executing node rpc.ecommerce_data_model_dbt.request
2022-07-08 05:59:07.350313 (Thread-1): 05:59:07  Using snowflake connection "rpc.ecommerce_data_model_dbt.request"
2022-07-08 05:59:07.350423 (Thread-1): 05:59:07  On rpc.ecommerce_data_model_dbt.request: with cte_id_stitched_identifies as 
(select distinct b.main_id as main_id, properties_gender, properties_birthday, timestamp from analytics_db.data_apps_simulated.identifies a left join 
ANALYTICS_DB.DATA_APPS_SIMULATED.MATERIAL_DOMAIN_PROFILE__IDSTITCHER_DC3F9DA0_12 b 
on (a.user_id = b.other_id and b.other_id_type = 'user_id') or (a.properties_email = b.other_id and b.other_id_type = 'email'))
select distinct main_id, 
first_value(properties_gender)
over(partition by main_id order by case when properties_gender is not null and properties_gender != '' then 2 else 1 end desc, timestamp desc) as gender,
first_value(properties_birthday)
over(partition by main_id order by case when properties_birthday is not null and properties_birthday != '' then 2 else 1 end desc, timestamp desc) as dob
from cte_id_stitched_identifies where timestamp >= '2021-05-01' and timestamp <= '2022-06-29' and main_id is not null
limit 500
/* limit added automatically by dbt cloud */
2022-07-08 05:59:07.350510 (Thread-1): 05:59:07  Opening a new connection, currently in state init
2022-07-08 05:59:07.692498 (Thread-32): handling poll request
2022-07-08 05:59:07.692960 (Thread-32): 05:59:07  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '78f3b6e0-4584-4822-b7bb-4d1427a5d8b5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4f2c064430>]}
2022-07-08 05:59:07.693906 (Thread-32): sending response (<Response 4715 bytes [200 OK]>) to 10.0.5.222
2022-07-08 05:59:09.029764 (Thread-1): 05:59:09  SQL status: SUCCESS 4 in 1.68 seconds
2022-07-08 05:59:09.031793 (Thread-1): 05:59:09  finished collecting timing info
2022-07-08 05:59:09.032063 (Thread-1): 05:59:09  On rpc.ecommerce_data_model_dbt.request: Close
2022-07-08 05:59:09.046205 (Thread-33): handling poll request
2022-07-08 05:59:09.046571 (Thread-33): 05:59:09  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '78f3b6e0-4584-4822-b7bb-4d1427a5d8b5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4f2c0645b0>]}
2022-07-08 05:59:09.047103 (Thread-33): sending response (<Response 1393 bytes [200 OK]>) to 10.0.5.222
2022-07-08 05:59:10.409769 (Thread-34): handling poll request
2022-07-08 05:59:10.410194 (Thread-34): 05:59:10  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '78f3b6e0-4584-4822-b7bb-4d1427a5d8b5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4f2c064c10>]}
2022-07-08 05:59:10.438367 (Thread-34): sending response (<Response 6476 bytes [200 OK]>) to 10.0.5.222
2022-07-08 05:59:47.916262 (Thread-35): 05:59:47  Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
2022-07-08 05:59:47.918047 (Thread-35): 05:59:47  Partial parsing: updated file: ecommerce_data_model_dbt://models/data_model/stg_traits/dob_and_gender.sql
2022-07-08 05:59:47.929565 (Thread-35): 05:59:47  1603: static parser failed on data_model/stg_traits/dob_and_gender.sql
2022-07-08 05:59:47.943085 (Thread-35): 05:59:47  1602: parser fallback to jinja rendering on data_model/stg_traits/dob_and_gender.sql
2022-07-08 05:59:47.999861 (Thread-35): 05:59:47  [WARNING]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.data-apps-ecommerce-template.data_model

2022-07-08 05:59:48.005501 (Thread-35): 05:59:48  Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '78f3b6e0-4584-4822-b7bb-4d1427a5d8b5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4f140e0d00>]}
2022-07-08 05:59:48.617685 (Thread-36): handling status request
2022-07-08 05:59:48.618104 (Thread-36): 05:59:48  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '78f3b6e0-4584-4822-b7bb-4d1427a5d8b5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4f15f09e50>]}
2022-07-08 05:59:48.618638 (Thread-36): sending response (<Response 2381 bytes [200 OK]>) to 10.0.5.222
2022-07-08 05:59:48.688223 (Thread-37): handling status request
2022-07-08 05:59:48.688628 (Thread-37): 05:59:48  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '78f3b6e0-4584-4822-b7bb-4d1427a5d8b5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4f15f094c0>]}
2022-07-08 05:59:48.689141 (Thread-37): sending response (<Response 2381 bytes [200 OK]>) to 10.0.5.222
2022-07-08 05:59:54.737875 (Thread-38): handling status request
2022-07-08 05:59:54.738289 (Thread-38): 05:59:54  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '78f3b6e0-4584-4822-b7bb-4d1427a5d8b5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4f15f09a30>]}
2022-07-08 05:59:54.738789 (Thread-38): sending response (<Response 2381 bytes [200 OK]>) to 10.0.5.222
2022-07-08 05:59:55.120682 (Thread-39): handling run_sql request
2022-07-08 05:59:55.121117 (Thread-39): 05:59:55  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '78f3b6e0-4584-4822-b7bb-4d1427a5d8b5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4f15f099d0>]}
2022-07-08 05:59:57.585292 (Thread-39): sending response (<Response 139 bytes [200 OK]>) to 10.0.5.222
2022-07-08 05:59:57.613097 (MainThread): 05:59:57  Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '2b7bfd62-d28b-4e68-aaed-e91e1bea6410', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f81868bac70>]}
2022-07-08 05:59:57.613791 (MainThread): 05:59:57  Found 18 models, 0 tests, 0 snapshots, 0 analyses, 181 macros, 0 operations, 0 seed files, 15 sources, 0 exposures, 0 metrics
2022-07-08 05:59:57.614471 (Thread-1): 05:59:57  Acquiring new snowflake connection "rpc.ecommerce_data_model_dbt.request"
2022-07-08 05:59:57.614620 (Thread-1): 05:59:57  Began compiling node rpc.ecommerce_data_model_dbt.request
2022-07-08 05:59:57.614719 (Thread-1): 05:59:57  Compiling rpc.ecommerce_data_model_dbt.request
2022-07-08 05:59:57.618003 (Thread-1): 05:59:57  finished collecting timing info
2022-07-08 05:59:57.618178 (Thread-1): 05:59:57  Began executing node rpc.ecommerce_data_model_dbt.request
2022-07-08 05:59:57.619965 (Thread-1): 05:59:57  Using snowflake connection "rpc.ecommerce_data_model_dbt.request"
2022-07-08 05:59:57.620081 (Thread-1): 05:59:57  On rpc.ecommerce_data_model_dbt.request: with cte_id_stitched_identifies as 
(select distinct b.main_id as main_id, properties_gender, properties_birthday, timestamp from analytics_db.data_apps_simulated.identifies a left join 
ANALYTICS_DB.DATA_APPS_SIMULATED.MATERIAL_DOMAIN_PROFILE__IDSTITCHER_DC3F9DA0_12 b 
on (a.user_id = b.other_id and b.other_id_type = 'user_id') or (a.properties_email = b.other_id and b.other_id_type = 'email'))
select distinct main_id, 
first_value(properties_gender)
over(partition by main_id order by case when properties_gender is not null and properties_gender != '' then 2 else 1 end desc, timestamp desc) as gender,
first_value(get_age_from_dob(properties_birthday))
over(partition by main_id order by case when properties_birthday is not null and properties_birthday != '' then 2 else 1 end desc, timestamp desc) as age
from cte_id_stitched_identifies where timestamp >= '2021-05-01' and timestamp <= '2022-06-29' and main_id is not null
limit 500
/* limit added automatically by dbt cloud */
2022-07-08 05:59:57.620170 (Thread-1): 05:59:57  Opening a new connection, currently in state init
2022-07-08 05:59:57.966735 (Thread-40): handling poll request
2022-07-08 05:59:57.967216 (Thread-40): 05:59:57  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '78f3b6e0-4584-4822-b7bb-4d1427a5d8b5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4f2c06b700>]}
2022-07-08 05:59:57.968139 (Thread-40): sending response (<Response 4733 bytes [200 OK]>) to 10.0.5.222
2022-07-08 05:59:58.319116 (Thread-1): 05:59:58  Snowflake adapter: Snowflake query id: 01a57687-0602-3511-0019-8203046d5f26
2022-07-08 05:59:58.319322 (Thread-1): 05:59:58  Snowflake adapter: Snowflake error: 002140 (42601): SQL compilation error:
Unknown function GET_AGE_FROM_DOB
2022-07-08 05:59:58.319483 (Thread-1): 05:59:58  finished collecting timing info
2022-07-08 05:59:58.319650 (Thread-1): 05:59:58  On rpc.ecommerce_data_model_dbt.request: Close
2022-07-08 05:59:58.369962 (Thread-1): Got an exception: Database Error
  002140 (42601): SQL compilation error:
  Unknown function GET_AGE_FROM_DOB
Traceback (most recent call last):
  File "/usr/local/lib/python3.8/dist-packages/dbt/adapters/snowflake/connections.py", line 206, in exception_handler
    yield
  File "/usr/local/lib/python3.8/dist-packages/dbt/adapters/sql/connections.py", line 74, in add_query
    cursor.execute(sql, bindings)
  File "/usr/local/lib/python3.8/dist-packages/snowflake/connector/cursor.py", line 721, in execute
    Error.errorhandler_wrapper(
  File "/usr/local/lib/python3.8/dist-packages/snowflake/connector/errors.py", line 258, in errorhandler_wrapper
    cursor.errorhandler(connection, cursor, error_class, error_value)
  File "/usr/local/lib/python3.8/dist-packages/snowflake/connector/errors.py", line 188, in default_errorhandler
    raise error_class(
snowflake.connector.errors.ProgrammingError: 002140 (42601): SQL compilation error:
Unknown function GET_AGE_FROM_DOB

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/usr/local/lib/python3.8/dist-packages/dbt/task/base.py", line 361, in safe_run
    result = self.compile_and_execute(manifest, ctx)
  File "/usr/local/lib/python3.8/dist-packages/dbt/task/base.py", line 314, in compile_and_execute
    result = self.run(ctx.node, manifest)
  File "/usr/local/lib/python3.8/dist-packages/dbt/task/base.py", line 403, in run
    return self.execute(compiled_node, manifest)
  File "/usr/local/lib/python3.8/dist-packages/dbt_rpc/rpc/node_runners.py", line 90, in execute
    _, execute_result = self.adapter.execute(
  File "/usr/local/lib/python3.8/dist-packages/dbt/adapters/base/impl.py", line 225, in execute
    return self.connections.execute(
  File "/usr/local/lib/python3.8/dist-packages/dbt/adapters/sql/connections.py", line 127, in execute
    _, cursor = self.add_query(sql, auto_begin)
  File "/usr/local/lib/python3.8/dist-packages/dbt/adapters/snowflake/connections.py", line 433, in add_query
    connection, cursor = super().add_query(
  File "/usr/local/lib/python3.8/dist-packages/dbt/adapters/sql/connections.py", line 83, in add_query
    return connection, cursor
  File "/usr/lib/python3.8/contextlib.py", line 131, in __exit__
    self.gen.throw(type, value, traceback)
  File "/usr/local/lib/python3.8/dist-packages/dbt/adapters/snowflake/connections.py", line 223, in exception_handler
    raise DatabaseException(msg)
dbt.exceptions.DatabaseException: Database Error
  002140 (42601): SQL compilation error:
  Unknown function GET_AGE_FROM_DOB
2022-07-08 05:59:58.370944 (Thread-1): Got exception RPCException(10003, Database Error, {'type': 'DatabaseException', 'message': 'Database Error in rpc request (from remote system)\n  002140 (42601): SQL compilation error:\n  Unknown function GET_AGE_FROM_DOB', 'raw_sql': "with cte_id_stitched_identifies as \r\n(select distinct b.main_id as main_id, properties_gender, properties_birthday, timestamp from {{ source('ecommerce', 'identifies') }} a left join \r\nANALYTICS_DB.DATA_APPS_SIMULATED.MATERIAL_DOMAIN_PROFILE__IDSTITCHER_DC3F9DA0_12 b \r\non (a.user_id = b.other_id and b.other_id_type = 'user_id') or (a.properties_email = b.other_id and b.other_id_type = 'email'))\r\nselect distinct main_id, \r\nfirst_value(properties_gender)\r\nover(partition by main_id order by case when properties_gender is not null and properties_gender != '' then 2 else 1 end desc, timestamp desc) as gender,\r\nfirst_value(get_age_from_dob(properties_birthday))\r\nover(partition by main_id order by case when properties_birthday is not null and properties_birthday != '' then 2 else 1 end desc, timestamp desc) as age\r\nfrom cte_id_stitched_identifies where timestamp >= '{{ var('start_date') }}' and timestamp <= '{{ var('end_date') }}' and main_id is not null\nlimit 500\n/* limit added automatically by dbt cloud */", 'compiled_sql': "with cte_id_stitched_identifies as \n(select distinct b.main_id as main_id, properties_gender, properties_birthday, timestamp from analytics_db.data_apps_simulated.identifies a left join \nANALYTICS_DB.DATA_APPS_SIMULATED.MATERIAL_DOMAIN_PROFILE__IDSTITCHER_DC3F9DA0_12 b \non (a.user_id = b.other_id and b.other_id_type = 'user_id') or (a.properties_email = b.other_id and b.other_id_type = 'email'))\nselect distinct main_id, \nfirst_value(properties_gender)\nover(partition by main_id order by case when properties_gender is not null and properties_gender != '' then 2 else 1 end desc, timestamp desc) as gender,\nfirst_value(get_age_from_dob(properties_birthday))\nover(partition by main_id order by case when properties_birthday is not null and properties_birthday != '' then 2 else 1 end desc, timestamp desc) as age\nfrom cte_id_stitched_identifies where timestamp >= '2021-05-01' and timestamp <= '2022-06-29' and main_id is not null\nlimit 500\n/* limit added automatically by dbt cloud */", 'tags': None}, None)
Traceback (most recent call last):
  File "/usr/local/lib/python3.8/dist-packages/dbt_rpc/task/sql_commands.py", line 147, in _in_thread
    self.node_results.append(runner.safe_run(self.manifest))
  File "/usr/local/lib/python3.8/dist-packages/dbt/task/base.py", line 377, in safe_run
    result = self.error_result(ctx.node, error, started, [])
  File "/usr/local/lib/python3.8/dist-packages/dbt_rpc/rpc/node_runners.py", line 56, in error_result
    raise error
dbt_rpc.rpc.error.RPCException: RPCException(10003, Database Error, {'type': 'DatabaseException', 'message': 'Database Error in rpc request (from remote system)\n  002140 (42601): SQL compilation error:\n  Unknown function GET_AGE_FROM_DOB', 'raw_sql': "with cte_id_stitched_identifies as \r\n(select distinct b.main_id as main_id, properties_gender, properties_birthday, timestamp from {{ source('ecommerce', 'identifies') }} a left join \r\nANALYTICS_DB.DATA_APPS_SIMULATED.MATERIAL_DOMAIN_PROFILE__IDSTITCHER_DC3F9DA0_12 b \r\non (a.user_id = b.other_id and b.other_id_type = 'user_id') or (a.properties_email = b.other_id and b.other_id_type = 'email'))\r\nselect distinct main_id, \r\nfirst_value(properties_gender)\r\nover(partition by main_id order by case when properties_gender is not null and properties_gender != '' then 2 else 1 end desc, timestamp desc) as gender,\r\nfirst_value(get_age_from_dob(properties_birthday))\r\nover(partition by main_id order by case when properties_birthday is not null and properties_birthday != '' then 2 else 1 end desc, timestamp desc) as age\r\nfrom cte_id_stitched_identifies where timestamp >= '{{ var('start_date') }}' and timestamp <= '{{ var('end_date') }}' and main_id is not null\nlimit 500\n/* limit added automatically by dbt cloud */", 'compiled_sql': "with cte_id_stitched_identifies as \n(select distinct b.main_id as main_id, properties_gender, properties_birthday, timestamp from analytics_db.data_apps_simulated.identifies a left join \nANALYTICS_DB.DATA_APPS_SIMULATED.MATERIAL_DOMAIN_PROFILE__IDSTITCHER_DC3F9DA0_12 b \non (a.user_id = b.other_id and b.other_id_type = 'user_id') or (a.properties_email = b.other_id and b.other_id_type = 'email'))\nselect distinct main_id, \nfirst_value(properties_gender)\nover(partition by main_id order by case when properties_gender is not null and properties_gender != '' then 2 else 1 end desc, timestamp desc) as gender,\nfirst_value(get_age_from_dob(properties_birthday))\nover(partition by main_id order by case when properties_birthday is not null and properties_birthday != '' then 2 else 1 end desc, timestamp desc) as age\nfrom cte_id_stitched_identifies where timestamp >= '2021-05-01' and timestamp <= '2022-06-29' and main_id is not null\nlimit 500\n/* limit added automatically by dbt cloud */", 'tags': None}, None)
2022-07-08 05:59:59.325617 (Thread-41): handling poll request
2022-07-08 05:59:59.326056 (Thread-41): 05:59:59  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '78f3b6e0-4584-4822-b7bb-4d1427a5d8b5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4f2d9ac9a0>]}
2022-07-08 05:59:59.326769 (Thread-41): sending response (<Response 16379 bytes [200 OK]>) to 10.0.5.222
2022-07-08 06:00:15.975227 (Thread-42): 06:00:15  Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
2022-07-08 06:00:15.975848 (Thread-42): 06:00:15  Partial parsing: updated file: ecommerce_data_model_dbt://models/data_model/stg_traits/dob_and_gender.sql
2022-07-08 06:00:15.980340 (Thread-42): 06:00:15  1603: static parser failed on data_model/stg_traits/dob_and_gender.sql
2022-07-08 06:00:15.988163 (Thread-42): 06:00:15  1602: parser fallback to jinja rendering on data_model/stg_traits/dob_and_gender.sql
2022-07-08 06:00:16.030576 (Thread-42): 06:00:16  [WARNING]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.data-apps-ecommerce-template.data_model

2022-07-08 06:00:16.036232 (Thread-42): 06:00:16  Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '78f3b6e0-4584-4822-b7bb-4d1427a5d8b5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4ec37fc190>]}
2022-07-08 06:00:16.740467 (Thread-43): handling status request
2022-07-08 06:00:16.740900 (Thread-43): 06:00:16  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '78f3b6e0-4584-4822-b7bb-4d1427a5d8b5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4ec37d0f10>]}
2022-07-08 06:00:16.741499 (Thread-43): sending response (<Response 2381 bytes [200 OK]>) to 10.0.5.222
2022-07-08 06:00:16.799825 (Thread-44): handling status request
2022-07-08 06:00:16.800221 (Thread-44): 06:00:16  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '78f3b6e0-4584-4822-b7bb-4d1427a5d8b5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4ec37d0a30>]}
2022-07-08 06:00:16.800712 (Thread-44): sending response (<Response 2381 bytes [200 OK]>) to 10.0.5.222
2022-07-08 06:00:17.612550 (Thread-45): handling status request
2022-07-08 06:00:17.613020 (Thread-45): 06:00:17  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '78f3b6e0-4584-4822-b7bb-4d1427a5d8b5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4f2d92d0a0>]}
2022-07-08 06:00:17.613637 (Thread-45): sending response (<Response 2381 bytes [200 OK]>) to 10.0.5.222
2022-07-08 06:00:17.982656 (Thread-46): handling run_sql request
2022-07-08 06:00:17.983078 (Thread-46): 06:00:17  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '78f3b6e0-4584-4822-b7bb-4d1427a5d8b5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4ec37deb20>]}
2022-07-08 06:00:20.337133 (Thread-46): sending response (<Response 139 bytes [200 OK]>) to 10.0.5.222
2022-07-08 06:00:20.365298 (MainThread): 06:00:20  Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'f42b40f9-e679-476c-bc2c-5640204960c4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f655bee32e0>]}
2022-07-08 06:00:20.365938 (MainThread): 06:00:20  Found 18 models, 0 tests, 0 snapshots, 0 analyses, 181 macros, 0 operations, 0 seed files, 15 sources, 0 exposures, 0 metrics
2022-07-08 06:00:20.366570 (Thread-1): 06:00:20  Acquiring new snowflake connection "rpc.ecommerce_data_model_dbt.request"
2022-07-08 06:00:20.366705 (Thread-1): 06:00:20  Began compiling node rpc.ecommerce_data_model_dbt.request
2022-07-08 06:00:20.366798 (Thread-1): 06:00:20  Compiling rpc.ecommerce_data_model_dbt.request
2022-07-08 06:00:20.369916 (Thread-1): 06:00:20  finished collecting timing info
2022-07-08 06:00:20.370055 (Thread-1): 06:00:20  Began executing node rpc.ecommerce_data_model_dbt.request
2022-07-08 06:00:20.372030 (Thread-1): 06:00:20  Using snowflake connection "rpc.ecommerce_data_model_dbt.request"
2022-07-08 06:00:20.372132 (Thread-1): 06:00:20  On rpc.ecommerce_data_model_dbt.request: with cte_id_stitched_identifies as 
(select distinct b.main_id as main_id, properties_gender, properties_birthday, timestamp from analytics_db.data_apps_simulated.identifies a left join 
ANALYTICS_DB.DATA_APPS_SIMULATED.MATERIAL_DOMAIN_PROFILE__IDSTITCHER_DC3F9DA0_12 b 
on (a.user_id = b.other_id and b.other_id_type = 'user_id') or (a.properties_email = b.other_id and b.other_id_type = 'email'))
select distinct main_id, 
first_value(properties_gender)
over(partition by main_id order by case when properties_gender is not null and properties_gender != '' then 2 else 1 end desc, timestamp desc) as gender,
first_value(
CASE WHEN getdate() < '2022-06-29'
THEN
(CASE WHEN dateadd(year, datediff (year, properties_birthday, getdate()), properties_birthday) > getdate()
      THEN datediff(year, properties_birthday, getdate()) - 1
      ELSE datediff(year, properties_birthday, getdate())
 END)
 ELSE
(CASE WHEN dateadd(year, datediff (year, properties_birthday, '2022-06-29'), properties_birthday) > '2022-06-29'
      THEN datediff(year, properties_birthday, '2022-06-29') - 1
      ELSE datediff(year, properties_birthday, '2022-06-29')
 END)
 END
 )
over(partition by main_id order by case when properties_birthday is not null and properties_birthday != '' then 2 else 1 end desc, timestamp desc) as age
from cte_id_stitched_identifies where timestamp >= '2021-05-01' and timestamp <= '2022-06-29' and main_id is not null
limit 500
/* limit added automatically by dbt cloud */
2022-07-08 06:00:20.372217 (Thread-1): 06:00:20  Opening a new connection, currently in state init
2022-07-08 06:00:20.691549 (Thread-47): handling poll request
2022-07-08 06:00:20.692026 (Thread-47): 06:00:20  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '78f3b6e0-4584-4822-b7bb-4d1427a5d8b5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4ec37fc430>]}
2022-07-08 06:00:20.692921 (Thread-47): sending response (<Response 5240 bytes [200 OK]>) to 10.0.5.222
2022-07-08 06:00:22.051041 (Thread-48): handling poll request
2022-07-08 06:00:22.051449 (Thread-48): 06:00:22  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '78f3b6e0-4584-4822-b7bb-4d1427a5d8b5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4ec37fcb50>]}
2022-07-08 06:00:22.051938 (Thread-48): sending response (<Response 409 bytes [200 OK]>) to 10.0.5.222
2022-07-08 06:00:22.761806 (Thread-1): 06:00:22  SQL status: SUCCESS 4 in 2.39 seconds
2022-07-08 06:00:22.763307 (Thread-1): 06:00:22  finished collecting timing info
2022-07-08 06:00:22.763492 (Thread-1): 06:00:22  On rpc.ecommerce_data_model_dbt.request: Close
2022-07-08 06:00:23.407010 (Thread-49): handling poll request
2022-07-08 06:00:23.407449 (Thread-49): 06:00:23  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '78f3b6e0-4584-4822-b7bb-4d1427a5d8b5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4ec37f8160>]}
2022-07-08 06:00:23.408420 (Thread-49): sending response (<Response 8584 bytes [200 OK]>) to 10.0.5.222
2022-07-08 06:00:53.732718 (Thread-50): 06:00:53  Partial parsing enabled: 1 files deleted, 1 files added, 0 files changed.
2022-07-08 06:00:53.733278 (Thread-50): 06:00:53  Partial parsing: added file: ecommerce_data_model_dbt://models/data_model/stg_traits/age_and_gender.sql
2022-07-08 06:00:53.733499 (Thread-50): 06:00:53  Partial parsing: deleted file: ecommerce_data_model_dbt://models/data_model/stg_traits/dob_and_gender.sql
2022-07-08 06:00:53.737810 (Thread-50): 06:00:53  1603: static parser failed on data_model/stg_traits/age_and_gender.sql
2022-07-08 06:00:53.742306 (Thread-50): 06:00:53  1602: parser fallback to jinja rendering on data_model/stg_traits/age_and_gender.sql
2022-07-08 06:00:53.788560 (Thread-50): 06:00:53  [WARNING]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.data-apps-ecommerce-template.data_model

2022-07-08 06:00:53.794237 (Thread-50): 06:00:53  Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '78f3b6e0-4584-4822-b7bb-4d1427a5d8b5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4ec36fa9a0>]}
2022-07-08 06:00:54.463560 (Thread-51): handling status request
2022-07-08 06:00:54.463973 (Thread-51): 06:00:54  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '78f3b6e0-4584-4822-b7bb-4d1427a5d8b5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4ec37a6fd0>]}
2022-07-08 06:00:54.464514 (Thread-51): sending response (<Response 2725 bytes [200 OK]>) to 10.0.5.222
2022-07-08 06:00:54.563621 (Thread-52): handling status request
2022-07-08 06:00:54.564092 (Thread-52): 06:00:54  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '78f3b6e0-4584-4822-b7bb-4d1427a5d8b5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4ec37f8c40>]}
2022-07-08 06:00:54.564635 (Thread-52): sending response (<Response 2725 bytes [200 OK]>) to 10.0.5.222
2022-07-08 06:01:25.688597 (Thread-53): 06:01:25  Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
2022-07-08 06:01:25.688841 (Thread-53): 06:01:25  Partial parsing enabled, no changes found, skipping parsing
2022-07-08 06:01:25.689751 (Thread-53): 06:01:25  [WARNING]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.data-apps-ecommerce-template.data_model

2022-07-08 06:01:25.695593 (Thread-53): 06:01:25  Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '78f3b6e0-4584-4822-b7bb-4d1427a5d8b5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4ec360ebe0>]}
2022-07-08 06:01:26.492161 (Thread-54): handling status request
2022-07-08 06:01:26.492610 (Thread-54): 06:01:26  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '78f3b6e0-4584-4822-b7bb-4d1427a5d8b5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4ec37358b0>]}
2022-07-08 06:01:26.493145 (Thread-54): sending response (<Response 1699 bytes [200 OK]>) to 10.0.5.222
2022-07-08 06:01:26.536179 (Thread-55): handling status request
2022-07-08 06:01:26.536618 (Thread-55): 06:01:26  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '78f3b6e0-4584-4822-b7bb-4d1427a5d8b5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4ec37356d0>]}
2022-07-08 06:01:26.537137 (Thread-55): sending response (<Response 1699 bytes [200 OK]>) to 10.0.5.222
2022-07-08 06:01:30.777078 (Thread-56): 06:01:30  Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
2022-07-08 06:01:30.777337 (Thread-56): 06:01:30  Partial parsing enabled, no changes found, skipping parsing
2022-07-08 06:01:30.778071 (Thread-56): 06:01:30  [WARNING]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.data-apps-ecommerce-template.data_model

2022-07-08 06:01:30.783722 (Thread-56): 06:01:30  Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '78f3b6e0-4584-4822-b7bb-4d1427a5d8b5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4ec35eb820>]}
2022-07-08 06:01:31.582615 (Thread-57): handling status request
2022-07-08 06:01:31.583035 (Thread-57): 06:01:31  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '78f3b6e0-4584-4822-b7bb-4d1427a5d8b5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4ec36070d0>]}
2022-07-08 06:01:31.583551 (Thread-57): sending response (<Response 1699 bytes [200 OK]>) to 10.0.5.222
2022-07-08 06:01:31.611521 (Thread-58): handling status request
2022-07-08 06:01:31.611942 (Thread-58): 06:01:31  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '78f3b6e0-4584-4822-b7bb-4d1427a5d8b5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4ec36f73a0>]}
2022-07-08 06:01:31.612462 (Thread-58): sending response (<Response 1699 bytes [200 OK]>) to 10.0.5.222
2022-07-08 06:02:04.832118 (Thread-59): 06:02:04  Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
2022-07-08 06:02:04.832362 (Thread-59): 06:02:04  Partial parsing enabled, no changes found, skipping parsing
2022-07-08 06:02:04.833190 (Thread-59): 06:02:04  [WARNING]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.data-apps-ecommerce-template.data_model

2022-07-08 06:02:04.838826 (Thread-59): 06:02:04  Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '78f3b6e0-4584-4822-b7bb-4d1427a5d8b5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4ec37e6640>]}
2022-07-08 06:02:05.470520 (Thread-60): handling status request
2022-07-08 06:02:05.470935 (Thread-60): 06:02:05  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '78f3b6e0-4584-4822-b7bb-4d1427a5d8b5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4ec3610310>]}
2022-07-08 06:02:05.471451 (Thread-60): sending response (<Response 1699 bytes [200 OK]>) to 10.0.5.222
2022-07-08 06:02:05.501135 (Thread-61): handling status request
2022-07-08 06:02:05.501613 (Thread-61): 06:02:05  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '78f3b6e0-4584-4822-b7bb-4d1427a5d8b5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4ec36106d0>]}
2022-07-08 06:02:05.502105 (Thread-61): sending response (<Response 1699 bytes [200 OK]>) to 10.0.5.222
2022-07-08 06:02:15.527653 (Thread-62): handling status request
2022-07-08 06:02:15.528119 (Thread-62): 06:02:15  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '78f3b6e0-4584-4822-b7bb-4d1427a5d8b5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4ec360ef70>]}
2022-07-08 06:02:15.528648 (Thread-62): sending response (<Response 1699 bytes [200 OK]>) to 10.0.5.222
2022-07-08 06:02:15.902005 (Thread-63): handling run_sql request
2022-07-08 06:02:15.902414 (Thread-63): 06:02:15  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '78f3b6e0-4584-4822-b7bb-4d1427a5d8b5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4ec360ea30>]}
2022-07-08 06:02:18.288609 (Thread-63): sending response (<Response 139 bytes [200 OK]>) to 10.0.5.222
2022-07-08 06:02:18.316134 (MainThread): 06:02:18  Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '8bfef9b5-9923-4683-aa1d-586140f05101', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd10f9b7dc0>]}
2022-07-08 06:02:18.316741 (MainThread): 06:02:18  Found 18 models, 0 tests, 0 snapshots, 0 analyses, 181 macros, 0 operations, 0 seed files, 15 sources, 0 exposures, 0 metrics
2022-07-08 06:02:18.317410 (Thread-1): 06:02:18  Acquiring new snowflake connection "rpc.ecommerce_data_model_dbt.request"
2022-07-08 06:02:18.317558 (Thread-1): 06:02:18  Began compiling node rpc.ecommerce_data_model_dbt.request
2022-07-08 06:02:18.317657 (Thread-1): 06:02:18  Compiling rpc.ecommerce_data_model_dbt.request
2022-07-08 06:02:18.321274 (Thread-1): 06:02:18  finished collecting timing info
2022-07-08 06:02:18.321430 (Thread-1): 06:02:18  Began executing node rpc.ecommerce_data_model_dbt.request
2022-07-08 06:02:18.323618 (Thread-1): 06:02:18  Using snowflake connection "rpc.ecommerce_data_model_dbt.request"
2022-07-08 06:02:18.323717 (Thread-1): 06:02:18  On rpc.ecommerce_data_model_dbt.request: with cte_gender as ANALYTICS_DB.dbt_ecommerce_features.gender,

cte_age as ANALYTICS_DB.dbt_ecommerce_features.age,

cte_location as ANALYTICS_DB.dbt_ecommerce_features.country_and_state,

cte_email_domain as ANALYTICS_DB.dbt_ecommerce_features.email_domain,

cte_is_member as ANALYTICS_DB.dbt_ecommerce_features.is_member,

cte_has_mobile_app as ANALYTICS_DB.dbt_ecommerce_features.has_mobile_app,

cte_is_active_on_website as ANALYTICS_DB.dbt_ecommerce_features.is_active_on_website,

cte_device_type as ANALYTICS_DB.dbt_ecommerce_features.device_type

select coalesce(a.user_id, b.user_id, c.user_id, d.user_id, e.user_id, f.user_id, g.user_id, h.user_id) 
as user_id, gender, c.country as country, c.state as state, email_domain, is_member, has_mobile_app, is_active_on_website, device_type
from ((((((cte_gender a full outer join cte_age b on a.user_id = b.user_id) 
full outer join cte_location c on c.user_id = coalesce(a.user_id, b.user_id))
full outer join cte_email_domain d on d.user_id = coalesce(a.user_id, b.user_id, c.user_id))
full outer join cte_is_member e on e.user_id = coalesce(a.user_id, b.user_id, c.user_id,d.user_id))
full outer join cte_has_mobile_app f on f.user_id = coalesce(a.user_id, b.user_id, c.user_id,d.user_id, e.user_id))
full outer join cte_is_active_on_website as g on g.user_id = coalesce(a.user_id, b.user_id, c.user_id,d.user_id, e.user_id, f.user_id))
full outer join cte_device_type as h on h.user_id = coalesce(a.user_id, b.user_id, c.user_id,d.user_id, e.user_id, f.user_id, g.user_id)
limit 500
/* limit added automatically by dbt cloud */
2022-07-08 06:02:18.323799 (Thread-1): 06:02:18  Opening a new connection, currently in state init
2022-07-08 06:02:18.657697 (Thread-64): handling poll request
2022-07-08 06:02:18.658182 (Thread-64): 06:02:18  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '78f3b6e0-4584-4822-b7bb-4d1427a5d8b5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4ec37f92e0>]}
2022-07-08 06:02:18.686727 (Thread-64): sending response (<Response 5341 bytes [200 OK]>) to 10.0.5.222
2022-07-08 06:02:20.052790 (Thread-65): handling poll request
2022-07-08 06:02:20.053222 (Thread-65): 06:02:20  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '78f3b6e0-4584-4822-b7bb-4d1427a5d8b5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4f15fa05e0>]}
2022-07-08 06:02:20.053788 (Thread-65): sending response (<Response 401 bytes [200 OK]>) to 10.0.5.222
2022-07-08 06:02:20.124624 (Thread-1): 06:02:20  Snowflake adapter: Snowflake query id: 01a5768a-0602-3511-0019-8203046d80ba
2022-07-08 06:02:20.124832 (Thread-1): 06:02:20  Snowflake adapter: Snowflake error: 001003 (42000): SQL compilation error:
syntax error line 1 at position 19 unexpected 'ANALYTICS_DB'.
syntax error line 1 at position 61 unexpected ','.
syntax error line 3 at position 11 unexpected 'ANALYTICS_DB'.
syntax error line 3 at position 50 unexpected ','.
syntax error line 5 at position 16 unexpected 'ANALYTICS_DB'.
syntax error line 5 at position 69 unexpected ','.
syntax error line 7 at position 20 unexpected 'ANALYTICS_DB'.
syntax error line 7 at position 68 unexpected ','.
syntax error line 9 at position 17 unexpected 'ANALYTICS_DB'.
syntax error line 9 at position 62 unexpected ','.
syntax error line 11 at position 22 unexpected 'ANALYTICS_DB'.
syntax error line 11 at position 72 unexpected ','.
syntax error line 13 at position 28 unexpected 'ANALYTICS_DB'.
syntax error line 13 at position 84 unexpected ','.
syntax error line 15 at position 19 unexpected 'ANALYTICS_DB'.
syntax error line 17 at position 16 unexpected 'a'.
syntax error line 18 at position 0 unexpected 'as'.
2022-07-08 06:02:20.125001 (Thread-1): 06:02:20  finished collecting timing info
2022-07-08 06:02:20.125169 (Thread-1): 06:02:20  On rpc.ecommerce_data_model_dbt.request: Close
2022-07-08 06:02:20.488059 (Thread-1): Got an exception: Database Error
  001003 (42000): SQL compilation error:
  syntax error line 1 at position 19 unexpected 'ANALYTICS_DB'.
  syntax error line 1 at position 61 unexpected ','.
  syntax error line 3 at position 11 unexpected 'ANALYTICS_DB'.
  syntax error line 3 at position 50 unexpected ','.
  syntax error line 5 at position 16 unexpected 'ANALYTICS_DB'.
  syntax error line 5 at position 69 unexpected ','.
  syntax error line 7 at position 20 unexpected 'ANALYTICS_DB'.
  syntax error line 7 at position 68 unexpected ','.
  syntax error line 9 at position 17 unexpected 'ANALYTICS_DB'.
  syntax error line 9 at position 62 unexpected ','.
  syntax error line 11 at position 22 unexpected 'ANALYTICS_DB'.
  syntax error line 11 at position 72 unexpected ','.
  syntax error line 13 at position 28 unexpected 'ANALYTICS_DB'.
  syntax error line 13 at position 84 unexpected ','.
  syntax error line 15 at position 19 unexpected 'ANALYTICS_DB'.
  syntax error line 17 at position 16 unexpected 'a'.
  syntax error line 18 at position 0 unexpected 'as'.
Traceback (most recent call last):
  File "/usr/local/lib/python3.8/dist-packages/dbt/adapters/snowflake/connections.py", line 206, in exception_handler
    yield
  File "/usr/local/lib/python3.8/dist-packages/dbt/adapters/sql/connections.py", line 74, in add_query
    cursor.execute(sql, bindings)
  File "/usr/local/lib/python3.8/dist-packages/snowflake/connector/cursor.py", line 721, in execute
    Error.errorhandler_wrapper(
  File "/usr/local/lib/python3.8/dist-packages/snowflake/connector/errors.py", line 258, in errorhandler_wrapper
    cursor.errorhandler(connection, cursor, error_class, error_value)
  File "/usr/local/lib/python3.8/dist-packages/snowflake/connector/errors.py", line 188, in default_errorhandler
    raise error_class(
snowflake.connector.errors.ProgrammingError: 001003 (42000): SQL compilation error:
syntax error line 1 at position 19 unexpected 'ANALYTICS_DB'.
syntax error line 1 at position 61 unexpected ','.
syntax error line 3 at position 11 unexpected 'ANALYTICS_DB'.
syntax error line 3 at position 50 unexpected ','.
syntax error line 5 at position 16 unexpected 'ANALYTICS_DB'.
syntax error line 5 at position 69 unexpected ','.
syntax error line 7 at position 20 unexpected 'ANALYTICS_DB'.
syntax error line 7 at position 68 unexpected ','.
syntax error line 9 at position 17 unexpected 'ANALYTICS_DB'.
syntax error line 9 at position 62 unexpected ','.
syntax error line 11 at position 22 unexpected 'ANALYTICS_DB'.
syntax error line 11 at position 72 unexpected ','.
syntax error line 13 at position 28 unexpected 'ANALYTICS_DB'.
syntax error line 13 at position 84 unexpected ','.
syntax error line 15 at position 19 unexpected 'ANALYTICS_DB'.
syntax error line 17 at position 16 unexpected 'a'.
syntax error line 18 at position 0 unexpected 'as'.

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/usr/local/lib/python3.8/dist-packages/dbt/task/base.py", line 361, in safe_run
    result = self.compile_and_execute(manifest, ctx)
  File "/usr/local/lib/python3.8/dist-packages/dbt/task/base.py", line 314, in compile_and_execute
    result = self.run(ctx.node, manifest)
  File "/usr/local/lib/python3.8/dist-packages/dbt/task/base.py", line 403, in run
    return self.execute(compiled_node, manifest)
  File "/usr/local/lib/python3.8/dist-packages/dbt_rpc/rpc/node_runners.py", line 90, in execute
    _, execute_result = self.adapter.execute(
  File "/usr/local/lib/python3.8/dist-packages/dbt/adapters/base/impl.py", line 225, in execute
    return self.connections.execute(
  File "/usr/local/lib/python3.8/dist-packages/dbt/adapters/sql/connections.py", line 127, in execute
    _, cursor = self.add_query(sql, auto_begin)
  File "/usr/local/lib/python3.8/dist-packages/dbt/adapters/snowflake/connections.py", line 433, in add_query
    connection, cursor = super().add_query(
  File "/usr/local/lib/python3.8/dist-packages/dbt/adapters/sql/connections.py", line 83, in add_query
    return connection, cursor
  File "/usr/lib/python3.8/contextlib.py", line 131, in __exit__
    self.gen.throw(type, value, traceback)
  File "/usr/local/lib/python3.8/dist-packages/dbt/adapters/snowflake/connections.py", line 223, in exception_handler
    raise DatabaseException(msg)
dbt.exceptions.DatabaseException: Database Error
  001003 (42000): SQL compilation error:
  syntax error line 1 at position 19 unexpected 'ANALYTICS_DB'.
  syntax error line 1 at position 61 unexpected ','.
  syntax error line 3 at position 11 unexpected 'ANALYTICS_DB'.
  syntax error line 3 at position 50 unexpected ','.
  syntax error line 5 at position 16 unexpected 'ANALYTICS_DB'.
  syntax error line 5 at position 69 unexpected ','.
  syntax error line 7 at position 20 unexpected 'ANALYTICS_DB'.
  syntax error line 7 at position 68 unexpected ','.
  syntax error line 9 at position 17 unexpected 'ANALYTICS_DB'.
  syntax error line 9 at position 62 unexpected ','.
  syntax error line 11 at position 22 unexpected 'ANALYTICS_DB'.
  syntax error line 11 at position 72 unexpected ','.
  syntax error line 13 at position 28 unexpected 'ANALYTICS_DB'.
  syntax error line 13 at position 84 unexpected ','.
  syntax error line 15 at position 19 unexpected 'ANALYTICS_DB'.
  syntax error line 17 at position 16 unexpected 'a'.
  syntax error line 18 at position 0 unexpected 'as'.
2022-07-08 06:02:20.488880 (Thread-1): Got exception RPCException(10003, Database Error, {'type': 'DatabaseException', 'message': "Database Error in rpc request (from remote system)\n  001003 (42000): SQL compilation error:\n  syntax error line 1 at position 19 unexpected 'ANALYTICS_DB'.\n  syntax error line 1 at position 61 unexpected ','.\n  syntax error line 3 at position 11 unexpected 'ANALYTICS_DB'.\n  syntax error line 3 at position 50 unexpected ','.\n  syntax error line 5 at position 16 unexpected 'ANALYTICS_DB'.\n  syntax error line 5 at position 69 unexpected ','.\n  syntax error line 7 at position 20 unexpected 'ANALYTICS_DB'.\n  syntax error line 7 at position 68 unexpected ','.\n  syntax error line 9 at position 17 unexpected 'ANALYTICS_DB'.\n  syntax error line 9 at position 62 unexpected ','.\n  syntax error line 11 at position 22 unexpected 'ANALYTICS_DB'.\n  syntax error line 11 at position 72 unexpected ','.\n  syntax error line 13 at position 28 unexpected 'ANALYTICS_DB'.\n  syntax error line 13 at position 84 unexpected ','.\n  syntax error line 15 at position 19 unexpected 'ANALYTICS_DB'.\n  syntax error line 17 at position 16 unexpected 'a'.\n  syntax error line 18 at position 0 unexpected 'as'.", 'raw_sql': "with cte_gender as {{ ref('gender') }},\r\n\r\ncte_age as {{ ref('age') }},\r\n\r\ncte_location as {{ ref('country_and_state') }},\r\n\r\ncte_email_domain as {{ ref('email_domain') }},\r\n\r\ncte_is_member as {{ ref('is_member') }},\r\n\r\ncte_has_mobile_app as {{ ref('has_mobile_app') }},\r\n\r\ncte_is_active_on_website as {{ ref('is_active_on_website') }},\r\n\r\ncte_device_type as {{ ref('device_type') }}\r\n\r\nselect coalesce(a.user_id, b.user_id, c.user_id, d.user_id, e.user_id, f.user_id, g.user_id, h.user_id) \r\nas user_id, gender, c.country as country, c.state as state, email_domain, is_member, has_mobile_app, is_active_on_website, device_type\r\nfrom ((((((cte_gender a full outer join cte_age b on a.user_id = b.user_id) \r\nfull outer join cte_location c on c.user_id = coalesce(a.user_id, b.user_id))\r\nfull outer join cte_email_domain d on d.user_id = coalesce(a.user_id, b.user_id, c.user_id))\r\nfull outer join cte_is_member e on e.user_id = coalesce(a.user_id, b.user_id, c.user_id,d.user_id))\r\nfull outer join cte_has_mobile_app f on f.user_id = coalesce(a.user_id, b.user_id, c.user_id,d.user_id, e.user_id))\r\nfull outer join cte_is_active_on_website as g on g.user_id = coalesce(a.user_id, b.user_id, c.user_id,d.user_id, e.user_id, f.user_id))\r\nfull outer join cte_device_type as h on h.user_id = coalesce(a.user_id, b.user_id, c.user_id,d.user_id, e.user_id, f.user_id, g.user_id)\nlimit 500\n/* limit added automatically by dbt cloud */", 'compiled_sql': 'with cte_gender as ANALYTICS_DB.dbt_ecommerce_features.gender,\n\ncte_age as ANALYTICS_DB.dbt_ecommerce_features.age,\n\ncte_location as ANALYTICS_DB.dbt_ecommerce_features.country_and_state,\n\ncte_email_domain as ANALYTICS_DB.dbt_ecommerce_features.email_domain,\n\ncte_is_member as ANALYTICS_DB.dbt_ecommerce_features.is_member,\n\ncte_has_mobile_app as ANALYTICS_DB.dbt_ecommerce_features.has_mobile_app,\n\ncte_is_active_on_website as ANALYTICS_DB.dbt_ecommerce_features.is_active_on_website,\n\ncte_device_type as ANALYTICS_DB.dbt_ecommerce_features.device_type\n\nselect coalesce(a.user_id, b.user_id, c.user_id, d.user_id, e.user_id, f.user_id, g.user_id, h.user_id) \nas user_id, gender, c.country as country, c.state as state, email_domain, is_member, has_mobile_app, is_active_on_website, device_type\nfrom ((((((cte_gender a full outer join cte_age b on a.user_id = b.user_id) \nfull outer join cte_location c on c.user_id = coalesce(a.user_id, b.user_id))\nfull outer join cte_email_domain d on d.user_id = coalesce(a.user_id, b.user_id, c.user_id))\nfull outer join cte_is_member e on e.user_id = coalesce(a.user_id, b.user_id, c.user_id,d.user_id))\nfull outer join cte_has_mobile_app f on f.user_id = coalesce(a.user_id, b.user_id, c.user_id,d.user_id, e.user_id))\nfull outer join cte_is_active_on_website as g on g.user_id = coalesce(a.user_id, b.user_id, c.user_id,d.user_id, e.user_id, f.user_id))\nfull outer join cte_device_type as h on h.user_id = coalesce(a.user_id, b.user_id, c.user_id,d.user_id, e.user_id, f.user_id, g.user_id)\nlimit 500\n/* limit added automatically by dbt cloud */', 'tags': None}, None)
Traceback (most recent call last):
  File "/usr/local/lib/python3.8/dist-packages/dbt_rpc/task/sql_commands.py", line 147, in _in_thread
    self.node_results.append(runner.safe_run(self.manifest))
  File "/usr/local/lib/python3.8/dist-packages/dbt/task/base.py", line 377, in safe_run
    result = self.error_result(ctx.node, error, started, [])
  File "/usr/local/lib/python3.8/dist-packages/dbt_rpc/rpc/node_runners.py", line 56, in error_result
    raise error
dbt_rpc.rpc.error.RPCException: RPCException(10003, Database Error, {'type': 'DatabaseException', 'message': "Database Error in rpc request (from remote system)\n  001003 (42000): SQL compilation error:\n  syntax error line 1 at position 19 unexpected 'ANALYTICS_DB'.\n  syntax error line 1 at position 61 unexpected ','.\n  syntax error line 3 at position 11 unexpected 'ANALYTICS_DB'.\n  syntax error line 3 at position 50 unexpected ','.\n  syntax error line 5 at position 16 unexpected 'ANALYTICS_DB'.\n  syntax error line 5 at position 69 unexpected ','.\n  syntax error line 7 at position 20 unexpected 'ANALYTICS_DB'.\n  syntax error line 7 at position 68 unexpected ','.\n  syntax error line 9 at position 17 unexpected 'ANALYTICS_DB'.\n  syntax error line 9 at position 62 unexpected ','.\n  syntax error line 11 at position 22 unexpected 'ANALYTICS_DB'.\n  syntax error line 11 at position 72 unexpected ','.\n  syntax error line 13 at position 28 unexpected 'ANALYTICS_DB'.\n  syntax error line 13 at position 84 unexpected ','.\n  syntax error line 15 at position 19 unexpected 'ANALYTICS_DB'.\n  syntax error line 17 at position 16 unexpected 'a'.\n  syntax error line 18 at position 0 unexpected 'as'.", 'raw_sql': "with cte_gender as {{ ref('gender') }},\r\n\r\ncte_age as {{ ref('age') }},\r\n\r\ncte_location as {{ ref('country_and_state') }},\r\n\r\ncte_email_domain as {{ ref('email_domain') }},\r\n\r\ncte_is_member as {{ ref('is_member') }},\r\n\r\ncte_has_mobile_app as {{ ref('has_mobile_app') }},\r\n\r\ncte_is_active_on_website as {{ ref('is_active_on_website') }},\r\n\r\ncte_device_type as {{ ref('device_type') }}\r\n\r\nselect coalesce(a.user_id, b.user_id, c.user_id, d.user_id, e.user_id, f.user_id, g.user_id, h.user_id) \r\nas user_id, gender, c.country as country, c.state as state, email_domain, is_member, has_mobile_app, is_active_on_website, device_type\r\nfrom ((((((cte_gender a full outer join cte_age b on a.user_id = b.user_id) \r\nfull outer join cte_location c on c.user_id = coalesce(a.user_id, b.user_id))\r\nfull outer join cte_email_domain d on d.user_id = coalesce(a.user_id, b.user_id, c.user_id))\r\nfull outer join cte_is_member e on e.user_id = coalesce(a.user_id, b.user_id, c.user_id,d.user_id))\r\nfull outer join cte_has_mobile_app f on f.user_id = coalesce(a.user_id, b.user_id, c.user_id,d.user_id, e.user_id))\r\nfull outer join cte_is_active_on_website as g on g.user_id = coalesce(a.user_id, b.user_id, c.user_id,d.user_id, e.user_id, f.user_id))\r\nfull outer join cte_device_type as h on h.user_id = coalesce(a.user_id, b.user_id, c.user_id,d.user_id, e.user_id, f.user_id, g.user_id)\nlimit 500\n/* limit added automatically by dbt cloud */", 'compiled_sql': 'with cte_gender as ANALYTICS_DB.dbt_ecommerce_features.gender,\n\ncte_age as ANALYTICS_DB.dbt_ecommerce_features.age,\n\ncte_location as ANALYTICS_DB.dbt_ecommerce_features.country_and_state,\n\ncte_email_domain as ANALYTICS_DB.dbt_ecommerce_features.email_domain,\n\ncte_is_member as ANALYTICS_DB.dbt_ecommerce_features.is_member,\n\ncte_has_mobile_app as ANALYTICS_DB.dbt_ecommerce_features.has_mobile_app,\n\ncte_is_active_on_website as ANALYTICS_DB.dbt_ecommerce_features.is_active_on_website,\n\ncte_device_type as ANALYTICS_DB.dbt_ecommerce_features.device_type\n\nselect coalesce(a.user_id, b.user_id, c.user_id, d.user_id, e.user_id, f.user_id, g.user_id, h.user_id) \nas user_id, gender, c.country as country, c.state as state, email_domain, is_member, has_mobile_app, is_active_on_website, device_type\nfrom ((((((cte_gender a full outer join cte_age b on a.user_id = b.user_id) \nfull outer join cte_location c on c.user_id = coalesce(a.user_id, b.user_id))\nfull outer join cte_email_domain d on d.user_id = coalesce(a.user_id, b.user_id, c.user_id))\nfull outer join cte_is_member e on e.user_id = coalesce(a.user_id, b.user_id, c.user_id,d.user_id))\nfull outer join cte_has_mobile_app f on f.user_id = coalesce(a.user_id, b.user_id, c.user_id,d.user_id, e.user_id))\nfull outer join cte_is_active_on_website as g on g.user_id = coalesce(a.user_id, b.user_id, c.user_id,d.user_id, e.user_id, f.user_id))\nfull outer join cte_device_type as h on h.user_id = coalesce(a.user_id, b.user_id, c.user_id,d.user_id, e.user_id, f.user_id, g.user_id)\nlimit 500\n/* limit added automatically by dbt cloud */', 'tags': None}, None)
2022-07-08 06:02:21.414197 (Thread-66): handling poll request
2022-07-08 06:02:21.414594 (Thread-66): 06:02:21  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '78f3b6e0-4584-4822-b7bb-4d1427a5d8b5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4ec37f9eb0>]}
2022-07-08 06:02:21.415261 (Thread-66): sending response (<Response 27039 bytes [200 OK]>) to 10.0.5.222
2022-07-08 06:02:41.688881 (Thread-67): handling status request
2022-07-08 06:02:41.689333 (Thread-67): 06:02:41  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '78f3b6e0-4584-4822-b7bb-4d1427a5d8b5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4ec37f9c70>]}
2022-07-08 06:02:41.689886 (Thread-67): sending response (<Response 1676 bytes [200 OK]>) to 10.0.5.222
2022-07-08 06:02:41.691271 (Thread-68): handling status request
2022-07-08 06:02:41.691573 (Thread-68): 06:02:41  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '78f3b6e0-4584-4822-b7bb-4d1427a5d8b5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4ec37f9cd0>]}
2022-07-08 06:02:41.692014 (Thread-68): sending response (<Response 1676 bytes [200 OK]>) to 10.0.5.222
2022-07-08 06:02:41.702322 (Thread-69): handling list request
2022-07-08 06:02:41.702743 (Thread-69): 06:02:41  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '78f3b6e0-4584-4822-b7bb-4d1427a5d8b5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4ec37f94c0>]}
2022-07-08 06:02:41.765227 (Thread-70): sending response (<Response 214 bytes [200 OK]>) to 10.0.5.222
2022-07-08 06:02:43.091526 (Thread-71): handling status request
2022-07-08 06:02:43.091959 (Thread-71): 06:02:43  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '78f3b6e0-4584-4822-b7bb-4d1427a5d8b5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4ec37f89d0>]}
2022-07-08 06:02:43.092464 (Thread-71): sending response (<Response 1676 bytes [200 OK]>) to 10.0.5.222
2022-07-08 06:02:43.098571 (Thread-72): handling list request
2022-07-08 06:02:43.098971 (Thread-72): 06:02:43  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '78f3b6e0-4584-4822-b7bb-4d1427a5d8b5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4ec37fc2e0>]}
2022-07-08 06:02:43.127635 (Thread-72): 06:02:43  Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '78f3b6e0-4584-4822-b7bb-4d1427a5d8b5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4ec37f98e0>]}
2022-07-08 06:02:43.128040 (Thread-72): 06:02:43  Found 18 models, 0 tests, 0 snapshots, 0 analyses, 181 macros, 0 operations, 0 seed files, 15 sources, 0 exposures, 0 metrics
2022-07-08 06:02:43.131839 (Thread-72): sending response (<Response 6931 bytes [200 OK]>) to 10.0.5.222
2022-07-08 06:08:54.090825 (Thread-73): 06:08:54  Partial parsing enabled: 1 files deleted, 0 files added, 0 files changed.
2022-07-08 06:08:54.094432 (Thread-73): 06:08:54  Partial parsing: deleted file: ecommerce_data_model_dbt://models/data_model/stg_traits/age.sql
2022-07-08 06:08:54.099032 (Thread-73): 06:08:54  1699: static parser successfully parsed data_model/stg_user_traits_new.sql
2022-07-08 06:08:54.890530 (Thread-74): handling status request
2022-07-08 06:08:54.891216 (Thread-74): 06:08:54  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '78f3b6e0-4584-4822-b7bb-4d1427a5d8b5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4f2fa7d550>]}
2022-07-08 06:08:54.891874 (Thread-74): sending response (<Response 1401 bytes [200 OK]>) to 10.0.5.222
2022-07-08 06:08:54.954287 (Thread-75): handling status request
2022-07-08 06:08:54.954695 (Thread-75): 06:08:54  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '78f3b6e0-4584-4822-b7bb-4d1427a5d8b5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4f2fa7d400>]}
2022-07-08 06:08:54.955177 (Thread-75): sending response (<Response 1401 bytes [200 OK]>) to 10.0.5.222
2022-07-08 06:09:05.531744 (Thread-76): 06:09:05  Partial parsing enabled: 1 files deleted, 1 files added, 0 files changed.
2022-07-08 06:09:05.532265 (Thread-76): 06:09:05  Partial parsing: added file: ecommerce_data_model_dbt://models/data_model/stg_traits/temp/age.sql
2022-07-08 06:09:05.532493 (Thread-76): 06:09:05  Partial parsing: deleted file: ecommerce_data_model_dbt://models/data_model/stg_traits/age.sql
2022-07-08 06:09:05.536273 (Thread-76): 06:09:05  1699: static parser successfully parsed data_model/stg_traits/temp/age.sql
2022-07-08 06:09:05.539188 (Thread-76): 06:09:05  1699: static parser successfully parsed data_model/stg_user_traits_new.sql
2022-07-08 06:09:05.576796 (Thread-76): 06:09:05  [WARNING]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.data-apps-ecommerce-template.data_model

2022-07-08 06:09:05.584261 (Thread-76): 06:09:05  Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '78f3b6e0-4584-4822-b7bb-4d1427a5d8b5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4ec37156d0>]}
2022-07-08 06:09:06.350046 (Thread-77): handling status request
2022-07-08 06:09:06.350480 (Thread-77): 06:09:06  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '78f3b6e0-4584-4822-b7bb-4d1427a5d8b5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4ec37ef490>]}
2022-07-08 06:09:06.351015 (Thread-77): sending response (<Response 2702 bytes [200 OK]>) to 10.0.5.222
2022-07-08 06:09:06.400635 (Thread-78): handling status request
2022-07-08 06:09:06.401038 (Thread-78): 06:09:06  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '78f3b6e0-4584-4822-b7bb-4d1427a5d8b5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4ec37ef280>]}
2022-07-08 06:09:06.401601 (Thread-78): sending response (<Response 2702 bytes [200 OK]>) to 10.0.5.222
2022-07-08 06:09:10.939133 (Thread-79): 06:09:10  Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
2022-07-08 06:09:10.939745 (Thread-79): 06:09:10  Partial parsing: updated file: ecommerce_data_model_dbt://models/data_model/stg_traits/temp/age.sql
2022-07-08 06:09:10.943792 (Thread-79): 06:09:10  1603: static parser failed on data_model/stg_traits/temp/age.sql
2022-07-08 06:09:10.948023 (Thread-79): 06:09:10  1602: parser fallback to jinja rendering on data_model/stg_traits/temp/age.sql
2022-07-08 06:09:10.987010 (Thread-79): 06:09:10  [WARNING]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.data-apps-ecommerce-template.data_model

2022-07-08 06:09:10.993404 (Thread-79): 06:09:10  Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '78f3b6e0-4584-4822-b7bb-4d1427a5d8b5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4ec259e730>]}
2022-07-08 06:09:11.679458 (Thread-80): handling status request
2022-07-08 06:09:11.679885 (Thread-80): 06:09:11  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '78f3b6e0-4584-4822-b7bb-4d1427a5d8b5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4ec35fba30>]}
2022-07-08 06:09:11.680454 (Thread-80): sending response (<Response 2363 bytes [200 OK]>) to 10.0.5.222
2022-07-08 06:09:11.721347 (Thread-81): handling status request
2022-07-08 06:09:11.721818 (Thread-81): 06:09:11  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '78f3b6e0-4584-4822-b7bb-4d1427a5d8b5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4ec35fb850>]}
2022-07-08 06:09:11.722372 (Thread-81): sending response (<Response 2363 bytes [200 OK]>) to 10.0.5.222
2022-07-08 06:09:22.571550 (Thread-82): 06:09:22  Partial parsing enabled: 1 files deleted, 0 files added, 0 files changed.
2022-07-08 06:09:22.572133 (Thread-82): 06:09:22  Partial parsing: deleted file: ecommerce_data_model_dbt://models/data_model/stg_traits/country_and_state.sql
2022-07-08 06:09:22.577554 (Thread-82): 06:09:22  1699: static parser successfully parsed data_model/stg_user_traits_new.sql
2022-07-08 06:09:23.312557 (Thread-83): handling status request
2022-07-08 06:09:23.312991 (Thread-83): 06:09:23  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '78f3b6e0-4584-4822-b7bb-4d1427a5d8b5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4ec35fb670>]}
2022-07-08 06:09:23.313568 (Thread-83): sending response (<Response 1429 bytes [200 OK]>) to 10.0.5.222
2022-07-08 06:09:23.373213 (Thread-84): handling status request
2022-07-08 06:09:23.373667 (Thread-84): 06:09:23  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '78f3b6e0-4584-4822-b7bb-4d1427a5d8b5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4ec35fbeb0>]}
2022-07-08 06:09:23.374211 (Thread-84): sending response (<Response 1429 bytes [200 OK]>) to 10.0.5.222
2022-07-08 06:09:36.512460 (Thread-85): 06:09:36  Partial parsing enabled: 1 files deleted, 1 files added, 0 files changed.
2022-07-08 06:09:36.513636 (Thread-85): 06:09:36  Partial parsing: added file: ecommerce_data_model_dbt://models/data_model/stg_traits/temp/country_and_state_old.sql
2022-07-08 06:09:36.513884 (Thread-85): 06:09:36  Partial parsing: deleted file: ecommerce_data_model_dbt://models/data_model/stg_traits/country_and_state.sql
2022-07-08 06:09:36.517491 (Thread-85): 06:09:36  1699: static parser successfully parsed data_model/stg_traits/temp/country_and_state_old.sql
2022-07-08 06:09:36.521559 (Thread-85): 06:09:36  1699: static parser successfully parsed data_model/stg_user_traits_new.sql
2022-07-08 06:09:37.264487 (Thread-86): handling status request
2022-07-08 06:09:37.264912 (Thread-86): 06:09:37  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '78f3b6e0-4584-4822-b7bb-4d1427a5d8b5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4ec2575d60>]}
2022-07-08 06:09:37.265463 (Thread-86): sending response (<Response 2118 bytes [200 OK]>) to 10.0.5.222
2022-07-08 06:09:37.311364 (Thread-87): handling status request
2022-07-08 06:09:37.311786 (Thread-87): 06:09:37  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '78f3b6e0-4584-4822-b7bb-4d1427a5d8b5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4ec2575f40>]}
2022-07-08 06:09:37.312278 (Thread-87): sending response (<Response 2118 bytes [200 OK]>) to 10.0.5.222
2022-07-08 06:09:40.597385 (Thread-88): 06:09:40  Partial parsing enabled: 1 files deleted, 1 files added, 0 files changed.
2022-07-08 06:09:40.597918 (Thread-88): 06:09:40  Partial parsing: added file: ecommerce_data_model_dbt://models/data_model/stg_traits/temp/country_and_state_old.sql
2022-07-08 06:09:40.598147 (Thread-88): 06:09:40  Partial parsing: deleted file: ecommerce_data_model_dbt://models/data_model/stg_traits/country_and_state.sql
2022-07-08 06:09:40.602158 (Thread-88): 06:09:40  1603: static parser failed on data_model/stg_traits/temp/country_and_state_old.sql
2022-07-08 06:09:40.606044 (Thread-88): 06:09:40  1602: parser fallback to jinja rendering on data_model/stg_traits/temp/country_and_state_old.sql
2022-07-08 06:09:40.607756 (Thread-88): 06:09:40  1699: static parser successfully parsed data_model/stg_user_traits_new.sql
2022-07-08 06:09:41.386603 (Thread-89): handling status request
2022-07-08 06:09:41.387045 (Thread-89): 06:09:41  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '78f3b6e0-4584-4822-b7bb-4d1427a5d8b5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4ec24a39d0>]}
2022-07-08 06:09:41.387598 (Thread-89): sending response (<Response 2445 bytes [200 OK]>) to 10.0.5.222
2022-07-08 06:09:41.438159 (Thread-90): handling status request
2022-07-08 06:09:41.438548 (Thread-90): 06:09:41  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '78f3b6e0-4584-4822-b7bb-4d1427a5d8b5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4ec24a3af0>]}
2022-07-08 06:09:41.439031 (Thread-90): sending response (<Response 2445 bytes [200 OK]>) to 10.0.5.222
2022-07-08 06:10:03.107898 (Thread-91): 06:10:03  Partial parsing enabled: 1 files deleted, 1 files added, 1 files changed.
2022-07-08 06:10:03.108464 (Thread-91): 06:10:03  Partial parsing: added file: ecommerce_data_model_dbt://models/data_model/stg_traits/temp/country_and_state_old.sql
2022-07-08 06:10:03.108616 (Thread-91): 06:10:03  Partial parsing: deleted file: ecommerce_data_model_dbt://models/data_model/stg_traits/country_and_state_new.sql
2022-07-08 06:10:03.108848 (Thread-91): 06:10:03  Partial parsing: updated file: ecommerce_data_model_dbt://models/data_model/stg_traits/country_and_state.sql
2022-07-08 06:10:03.112977 (Thread-91): 06:10:03  1603: static parser failed on data_model/stg_traits/temp/country_and_state_old.sql
2022-07-08 06:10:03.117015 (Thread-91): 06:10:03  1602: parser fallback to jinja rendering on data_model/stg_traits/temp/country_and_state_old.sql
2022-07-08 06:10:03.118304 (Thread-91): 06:10:03  1603: static parser failed on data_model/stg_traits/country_and_state.sql
2022-07-08 06:10:03.122181 (Thread-91): 06:10:03  1602: parser fallback to jinja rendering on data_model/stg_traits/country_and_state.sql
2022-07-08 06:10:03.160934 (Thread-91): 06:10:03  [WARNING]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.data-apps-ecommerce-template.data_model

2022-07-08 06:10:03.168286 (Thread-91): 06:10:03  Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '78f3b6e0-4584-4822-b7bb-4d1427a5d8b5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4ec242af40>]}
2022-07-08 06:10:03.854563 (Thread-92): handling status request
2022-07-08 06:10:03.855002 (Thread-92): 06:10:03  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '78f3b6e0-4584-4822-b7bb-4d1427a5d8b5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4ec3727dc0>]}
2022-07-08 06:10:03.855650 (Thread-92): sending response (<Response 3759 bytes [200 OK]>) to 10.0.5.222
2022-07-08 06:10:03.922576 (Thread-93): handling status request
2022-07-08 06:10:03.922974 (Thread-93): 06:10:03  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '78f3b6e0-4584-4822-b7bb-4d1427a5d8b5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4ec37279d0>]}
2022-07-08 06:10:03.923496 (Thread-93): sending response (<Response 3759 bytes [200 OK]>) to 10.0.5.222
2022-07-08 06:10:18.391538 (Thread-94): 06:10:18  Partial parsing enabled: 1 files deleted, 0 files added, 0 files changed.
2022-07-08 06:10:18.392075 (Thread-94): 06:10:18  Partial parsing: deleted file: ecommerce_data_model_dbt://models/data_model/stg_traits/gender.sql
2022-07-08 06:10:18.396537 (Thread-94): 06:10:18  1699: static parser successfully parsed data_model/stg_user_traits_new.sql
2022-07-08 06:10:19.221756 (Thread-95): handling status request
2022-07-08 06:10:19.222201 (Thread-95): 06:10:19  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '78f3b6e0-4584-4822-b7bb-4d1427a5d8b5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4ec2432340>]}
2022-07-08 06:10:19.222825 (Thread-95): sending response (<Response 1407 bytes [200 OK]>) to 10.0.5.222
2022-07-08 06:10:19.290954 (Thread-96): handling status request
2022-07-08 06:10:19.291393 (Thread-96): 06:10:19  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '78f3b6e0-4584-4822-b7bb-4d1427a5d8b5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4ec2432280>]}
2022-07-08 06:10:19.322381 (Thread-96): sending response (<Response 1407 bytes [200 OK]>) to 10.0.5.222
2022-07-08 06:10:26.575820 (Thread-97): 06:10:26  Partial parsing enabled: 1 files deleted, 1 files added, 0 files changed.
2022-07-08 06:10:26.576353 (Thread-97): 06:10:26  Partial parsing: added file: ecommerce_data_model_dbt://models/data_model/stg_traits/temp/gender.sql
2022-07-08 06:10:26.576592 (Thread-97): 06:10:26  Partial parsing: deleted file: ecommerce_data_model_dbt://models/data_model/stg_traits/gender.sql
2022-07-08 06:10:26.581070 (Thread-97): 06:10:26  1699: static parser successfully parsed data_model/stg_traits/temp/gender.sql
2022-07-08 06:10:26.583758 (Thread-97): 06:10:26  1699: static parser successfully parsed data_model/stg_user_traits_new.sql
2022-07-08 06:10:26.621170 (Thread-97): 06:10:26  [WARNING]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.data-apps-ecommerce-template.data_model

2022-07-08 06:10:26.626935 (Thread-97): 06:10:26  Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '78f3b6e0-4584-4822-b7bb-4d1427a5d8b5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4ec23c87f0>]}
2022-07-08 06:10:27.378718 (Thread-98): handling status request
2022-07-08 06:10:27.379133 (Thread-98): 06:10:27  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '78f3b6e0-4584-4822-b7bb-4d1427a5d8b5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4ec23e0940>]}
2022-07-08 06:10:27.379679 (Thread-98): sending response (<Response 2711 bytes [200 OK]>) to 10.0.5.222
2022-07-08 06:10:27.422120 (Thread-99): handling status request
2022-07-08 06:10:27.422540 (Thread-99): 06:10:27  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '78f3b6e0-4584-4822-b7bb-4d1427a5d8b5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4ec23e0c10>]}
2022-07-08 06:10:27.423059 (Thread-99): sending response (<Response 2711 bytes [200 OK]>) to 10.0.5.222
2022-07-08 06:10:30.451355 (Thread-100): 06:10:30  Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
2022-07-08 06:10:30.451916 (Thread-100): 06:10:30  Partial parsing: updated file: ecommerce_data_model_dbt://models/data_model/stg_traits/temp/gender.sql
2022-07-08 06:10:30.456029 (Thread-100): 06:10:30  1603: static parser failed on data_model/stg_traits/temp/gender.sql
2022-07-08 06:10:30.459942 (Thread-100): 06:10:30  1602: parser fallback to jinja rendering on data_model/stg_traits/temp/gender.sql
2022-07-08 06:10:30.494917 (Thread-100): 06:10:30  [WARNING]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.data-apps-ecommerce-template.data_model

2022-07-08 06:10:30.500660 (Thread-100): 06:10:30  Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '78f3b6e0-4584-4822-b7bb-4d1427a5d8b5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4ec23752b0>]}
2022-07-08 06:10:31.178782 (Thread-101): handling status request
2022-07-08 06:10:31.179191 (Thread-101): 06:10:31  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '78f3b6e0-4584-4822-b7bb-4d1427a5d8b5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4ec23b6e50>]}
2022-07-08 06:10:31.179703 (Thread-101): sending response (<Response 2378 bytes [200 OK]>) to 10.0.5.222
2022-07-08 06:10:31.365210 (Thread-102): handling status request
2022-07-08 06:10:31.365668 (Thread-102): 06:10:31  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '78f3b6e0-4584-4822-b7bb-4d1427a5d8b5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4ec23b6d30>]}
2022-07-08 06:10:31.366179 (Thread-102): sending response (<Response 2378 bytes [200 OK]>) to 10.0.5.222
2022-07-08 06:17:16.969102 (Thread-103): handling status request
2022-07-08 06:17:16.971079 (Thread-103): 06:17:16  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '78f3b6e0-4584-4822-b7bb-4d1427a5d8b5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4ec23b6a90>]}
2022-07-08 06:17:16.971624 (Thread-103): sending response (<Response 2378 bytes [200 OK]>) to 10.0.5.222
2022-07-08 06:17:17.331716 (Thread-104): handling run_sql request
2022-07-08 06:17:17.332129 (Thread-104): 06:17:17  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '78f3b6e0-4584-4822-b7bb-4d1427a5d8b5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4ec23b6a60>]}
2022-07-08 06:17:19.742062 (Thread-104): sending response (<Response 139 bytes [200 OK]>) to 10.0.5.222
2022-07-08 06:17:19.773335 (MainThread): 06:17:19  Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'a4d63d9f-92d7-4624-858e-ccf4af9a9d09', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f56b45a3340>]}
2022-07-08 06:17:19.773997 (MainThread): 06:17:19  Found 18 models, 0 tests, 0 snapshots, 0 analyses, 181 macros, 0 operations, 0 seed files, 15 sources, 0 exposures, 0 metrics
2022-07-08 06:17:19.774729 (Thread-1): 06:17:19  Acquiring new snowflake connection "rpc.ecommerce_data_model_dbt.request"
2022-07-08 06:17:19.774858 (Thread-1): 06:17:19  Began compiling node rpc.ecommerce_data_model_dbt.request
2022-07-08 06:17:19.774954 (Thread-1): 06:17:19  Compiling rpc.ecommerce_data_model_dbt.request
2022-07-08 06:17:19.778363 (Thread-1): 06:17:19  finished collecting timing info
2022-07-08 06:17:19.778519 (Thread-1): 06:17:19  Began executing node rpc.ecommerce_data_model_dbt.request
2022-07-08 06:17:19.780432 (Thread-1): 06:17:19  Using snowflake connection "rpc.ecommerce_data_model_dbt.request"
2022-07-08 06:17:19.780537 (Thread-1): 06:17:19  On rpc.ecommerce_data_model_dbt.request: with cte_id_stitched_identifies as 
(select distinct b.main_id as main_id, properties_gender, properties_birthday, timestamp from analytics_db.data_apps_simulated.identifies a left join 
ANALYTICS_DB.DATA_APPS_SIMULATED.MATERIAL_DOMAIN_PROFILE__IDSTITCHER_DC3F9DA0_12 b 
on (a.user_id = b.other_id and b.other_id_type = 'user_id') or (a.properties_email = b.other_id and b.other_id_type = 'email'))
select distinct main_id, 
first_value(properties_gender)
over(partition by main_id order by case when properties_gender is not null and properties_gender != '' then 2 else 1 end desc, timestamp desc) as gender,
first_value(
CASE WHEN getdate() < '2022-06-29'
THEN
(CASE WHEN dateadd(year, datediff (year, properties_birthday, getdate()), properties_birthday) > getdate()
      THEN datediff(year, properties_birthday, getdate()) - 1
      ELSE datediff(year, properties_birthday, getdate())
 END)
 ELSE
(CASE WHEN dateadd(year, datediff (year, properties_birthday, '2022-06-29'), properties_birthday) > '2022-06-29'
      THEN datediff(year, properties_birthday, '2022-06-29') - 1
      ELSE datediff(year, properties_birthday, '2022-06-29')
 END)
 END
 )
over(partition by main_id order by case when properties_birthday is not null and properties_birthday != '' then 2 else 1 end desc, timestamp desc) as age
from cte_id_stitched_identifies where timestamp >= '2021-05-01' and timestamp <= '2022-06-29' and main_id is not null
limit 500
/* limit added automatically by dbt cloud */
2022-07-08 06:17:19.780622 (Thread-1): 06:17:19  Opening a new connection, currently in state init
2022-07-08 06:17:20.101858 (Thread-105): handling poll request
2022-07-08 06:17:20.102416 (Thread-105): 06:17:20  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '78f3b6e0-4584-4822-b7bb-4d1427a5d8b5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4ec373f640>]}
2022-07-08 06:17:20.103365 (Thread-105): sending response (<Response 5240 bytes [200 OK]>) to 10.0.5.222
2022-07-08 06:17:21.024387 (Thread-1): 06:17:21  SQL status: SUCCESS 4 in 1.24 seconds
2022-07-08 06:17:21.026034 (Thread-1): 06:17:21  finished collecting timing info
2022-07-08 06:17:21.026248 (Thread-1): 06:17:21  On rpc.ecommerce_data_model_dbt.request: Close
2022-07-08 06:17:21.468970 (Thread-106): handling poll request
2022-07-08 06:17:21.469442 (Thread-106): 06:17:21  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '78f3b6e0-4584-4822-b7bb-4d1427a5d8b5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4ec23757f0>]}
2022-07-08 06:17:21.470437 (Thread-106): sending response (<Response 8583 bytes [200 OK]>) to 10.0.5.222
2022-07-08 06:18:16.965775 (Thread-107): handling status request
2022-07-08 06:18:16.966194 (Thread-107): 06:18:16  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '78f3b6e0-4584-4822-b7bb-4d1427a5d8b5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4ec2375970>]}
2022-07-08 06:18:16.966737 (Thread-107): sending response (<Response 2378 bytes [200 OK]>) to 10.0.5.222
2022-07-08 06:18:17.325057 (Thread-108): handling run_sql request
2022-07-08 06:18:17.325535 (Thread-108): 06:18:17  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '78f3b6e0-4584-4822-b7bb-4d1427a5d8b5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4ec2375520>]}
2022-07-08 06:18:19.729537 (Thread-108): sending response (<Response 139 bytes [200 OK]>) to 10.0.5.222
2022-07-08 06:18:19.756168 (MainThread): 06:18:19  Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '6a31dab4-d54d-47e5-91e2-ef009e33402a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa7d6e2b430>]}
2022-07-08 06:18:19.756783 (MainThread): 06:18:19  Found 18 models, 0 tests, 0 snapshots, 0 analyses, 181 macros, 0 operations, 0 seed files, 15 sources, 0 exposures, 0 metrics
2022-07-08 06:18:19.757446 (Thread-1): 06:18:19  Acquiring new snowflake connection "rpc.ecommerce_data_model_dbt.request"
2022-07-08 06:18:19.757584 (Thread-1): 06:18:19  Began compiling node rpc.ecommerce_data_model_dbt.request
2022-07-08 06:18:19.757681 (Thread-1): 06:18:19  Compiling rpc.ecommerce_data_model_dbt.request
2022-07-08 06:18:19.760435 (Thread-1): 06:18:19  finished collecting timing info
2022-07-08 06:18:19.760570 (Thread-1): 06:18:19  Began executing node rpc.ecommerce_data_model_dbt.request
2022-07-08 06:18:19.761992 (Thread-1): 06:18:19  Using snowflake connection "rpc.ecommerce_data_model_dbt.request"
2022-07-08 06:18:19.762089 (Thread-1): 06:18:19  On rpc.ecommerce_data_model_dbt.request: with cte_id_stitched_identifies as 
(select distinct b.main_id as main_id, properties_country, properties_state, timestamp from analytics_db.data_apps_simulated.identifies a left join 
ANALYTICS_DB.DATA_APPS_SIMULATED.MATERIAL_DOMAIN_PROFILE__IDSTITCHER_DC3F9DA0_12 b 
on (a.user_id = b.other_id and b.other_id_type = 'user_id') or (a.properties_email = b.other_id and b.other_id_type = 'email'))
select distinct main_id, 
first_value(properties_country)
over(partition by main_id order by case when properties_country is not null and properties_country != '' then 2 else 1 end desc, timestamp desc) as country,
first_value(properties_state)
over(partition by main_id order by case when properties_state is not null and properties_state != '' then 2 else 1 end desc, timestamp desc) as state
from cte_id_stitched_identifies where timestamp >= '2021-05-01' and timestamp <= '2022-06-29' and main_id is not null
limit 500
/* limit added automatically by dbt cloud */
2022-07-08 06:18:19.762174 (Thread-1): 06:18:19  Opening a new connection, currently in state init
2022-07-08 06:18:20.091026 (Thread-109): handling poll request
2022-07-08 06:18:20.091528 (Thread-109): 06:18:20  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '78f3b6e0-4584-4822-b7bb-4d1427a5d8b5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4ec235e790>]}
2022-07-08 06:18:20.092408 (Thread-109): sending response (<Response 4713 bytes [200 OK]>) to 10.0.5.222
2022-07-08 06:18:20.762433 (Thread-1): 06:18:20  SQL status: SUCCESS 4 in 1.0 seconds
2022-07-08 06:18:20.763844 (Thread-1): 06:18:20  finished collecting timing info
2022-07-08 06:18:20.764026 (Thread-1): 06:18:20  On rpc.ecommerce_data_model_dbt.request: Close
2022-07-08 06:18:21.453243 (Thread-110): handling poll request
2022-07-08 06:18:21.453699 (Thread-110): 06:18:21  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '78f3b6e0-4584-4822-b7bb-4d1427a5d8b5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4ec235edf0>]}
2022-07-08 06:18:21.454604 (Thread-110): sending response (<Response 7456 bytes [200 OK]>) to 10.0.5.222
2022-07-08 06:20:57.079535 (Thread-111): handling status request
2022-07-08 06:20:57.081278 (Thread-111): 06:20:57  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '78f3b6e0-4584-4822-b7bb-4d1427a5d8b5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4ec235ef70>]}
2022-07-08 06:20:57.081857 (Thread-111): sending response (<Response 2378 bytes [200 OK]>) to 10.0.5.222
2022-07-08 06:20:57.462208 (Thread-112): handling run_sql request
2022-07-08 06:20:57.462617 (Thread-112): 06:20:57  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '78f3b6e0-4584-4822-b7bb-4d1427a5d8b5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4ec23b8160>]}
2022-07-08 06:20:59.882962 (Thread-112): sending response (<Response 139 bytes [200 OK]>) to 10.0.5.222
2022-07-08 06:20:59.922049 (MainThread): 06:20:59  Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'b531a532-df11-48d5-bcb2-a3675b982aaa', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd36581fd90>]}
2022-07-08 06:20:59.922665 (MainThread): 06:20:59  Found 18 models, 0 tests, 0 snapshots, 0 analyses, 181 macros, 0 operations, 0 seed files, 15 sources, 0 exposures, 0 metrics
2022-07-08 06:20:59.923309 (Thread-1): 06:20:59  Acquiring new snowflake connection "rpc.ecommerce_data_model_dbt.request"
2022-07-08 06:20:59.923449 (Thread-1): 06:20:59  Began compiling node rpc.ecommerce_data_model_dbt.request
2022-07-08 06:20:59.923543 (Thread-1): 06:20:59  Compiling rpc.ecommerce_data_model_dbt.request
2022-07-08 06:20:59.932773 (Thread-1): 06:20:59  finished collecting timing info
2022-07-08 06:20:59.932948 (Thread-1): 06:20:59  Began executing node rpc.ecommerce_data_model_dbt.request
2022-07-08 06:20:59.938363 (Thread-1): 06:20:59  Using snowflake connection "rpc.ecommerce_data_model_dbt.request"
2022-07-08 06:20:59.938628 (Thread-1): 06:20:59  On rpc.ecommerce_data_model_dbt.request: with cte_gender as 
(select user_id, gender from 
(select user_id, properties_gender as gender, row_number() over(partition by user_id order by timestamp desc) as rn from 
analytics_db.data_apps_simulated.identifies where timestamp >= '2021-05-01' and timestamp <= '2022-06-29'
and properties_gender is not null and properties_gender != '') where rn = 1),

cte_age as 
(select user_id, age from
(select user_id, 
(CASE WHEN dateadd(year, datediff (year, properties_birthday, getdate()), properties_birthday) > getdate()
      THEN datediff(year, properties_birthday, getdate()) - 1
      ELSE datediff(year, properties_birthday, getdate())
 END) as age, row_number() over(partition by user_id order by timestamp desc) as rn 
from analytics_db.data_apps_simulated.identifies where timestamp >= '2021-05-01' and timestamp <= '2022-06-29'
and properties_birthday is not null and properties_birthday!='') where rn = 1),

cte_country as 
(select user_id, country from 
(select user_id, properties_country as country, row_number() over(partition by user_id order by timestamp desc) as rn from 
analytics_db.data_apps_simulated.identifies where timestamp >= '2021-05-01' and timestamp <= '2022-06-29'
and properties_country is not null and properties_country != '') where rn = 1),

cte_state as 
(select user_id, state from 
(select user_id, properties_state as state, row_number() over(partition by user_id order by timestamp desc) as rn from 
analytics_db.data_apps_simulated.identifies where timestamp >= '2021-05-01' and timestamp <= '2022-06-29'
and properties_state is not null and properties_state != '') where rn = 1),

cte_email_domain as 
(select user_id, email_domain from 
(select user_id, substring(properties_email, charindex( '@', properties_email) + 1, len(properties_email)) as email_domain, row_number() over(partition by user_id order by timestamp desc) as rn from 
analytics_db.data_apps_simulated.identifies where timestamp >= '2021-05-01' and timestamp <= '2022-06-29'
and properties_email is not null and properties_email != '') where rn = 1),

cte_is_member as 
(select user_id, is_member from
(select user_id, 
(CASE WHEN properties_is_member = TRUE
      THEN TRUE
      ELSE FALSE
END) as is_member, row_number() over(partition by user_id order by timestamp desc) as rn from 
analytics_db.data_apps_simulated.identifies where timestamp >= '2021-05-01' and timestamp <= '2022-06-29'
and user_id is not null) where rn = 1),

cte_has_mobile_app as 
(select user_id, has_mobile_app from 
(select user_id, 
(CASE WHEN user_id IN(select user_id from analytics_db.data_apps_simulated.identifies where context_device_type  = 'android' or context_device_type = 'iOS')
      THEN TRUE
      ELSE FALSE
      END) as has_mobile_app, row_number() over(partition by user_id order by timestamp desc) as rn from 
analytics_db.data_apps_simulated.identifies where timestamp >= '2021-05-01' and timestamp <= '2022-06-29'
and context_device_type is not null and context_device_type != '' and user_id is not null) where rn = 1),

cte_is_active_on_website as 
(select user_id, is_active_on_website from 
(select user_id, 
(CASE WHEN user_id IN(select user_id from analytics_db.data_apps_simulated.identifies where context_device_type like '%PC')
      THEN TRUE
      ELSE FALSE
      END)
as is_active_on_website, row_number() over(partition by user_id order by timestamp desc) as rn from 
analytics_db.data_apps_simulated.identifies where timestamp >= '2021-05-01' and timestamp <= '2022-06-29'
and context_device_type is not null and context_device_type != '' and user_id is not null) where rn = 1),

cte_device_type as 
(select user_id, device_type from 
(select user_id, context_device_type as device_type, row_number() over(partition by user_id order by timestamp desc) as rn from 
analytics_db.data_apps_simulated.identifies where timestamp >= '2021-05-01' and timestamp <= '2022-06-29'
and device_type is not null and device_type != '') where rn = 1)

select coalesce(a.user_id, b.user_id, c.user_id, d.user_id, e.user_id, f.user_id, g.user_id, h.user_id, i.user_id) 
as user_id, gender, age, country, state, email_domain, is_member, has_mobile_app, is_active_on_website, device_type
from (((((((cte_gender a full outer join cte_age b on a.user_id = b.user_id) 
full outer join cte_country c on c.user_id = coalesce(a.user_id, b.user_id))
full outer join cte_state d on d.user_id = coalesce(a.user_id, b.user_id, c.user_id))
full outer join cte_email_domain e on e.user_id = coalesce(a.user_id, b.user_id, c.user_id,d.user_id))
full outer join cte_is_member f on f.user_id = coalesce(a.user_id, b.user_id, c.user_id,d.user_id, e.user_id))
full outer join cte_has_mobile_app g on g.user_id = coalesce(a.user_id, b.user_id, c.user_id,d.user_id, e.user_id, f.user_id))
full outer join cte_is_active_on_website as h on h.user_id = coalesce(a.user_id, b.user_id, c.user_id,d.user_id, e.user_id, f.user_id, g.user_id))
full outer join cte_device_type as i on i.user_id = coalesce(a.user_id, b.user_id, c.user_id,d.user_id, e.user_id, f.user_id, g.user_id, h.user_id)
limit 500
/* limit added automatically by dbt cloud */
2022-07-08 06:20:59.938721 (Thread-1): 06:20:59  Opening a new connection, currently in state init
2022-07-08 06:21:00.293666 (Thread-113): handling poll request
2022-07-08 06:21:00.294164 (Thread-113): 06:21:00  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '78f3b6e0-4584-4822-b7bb-4d1427a5d8b5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4ec2378f70>]}
2022-07-08 06:21:00.295108 (Thread-113): sending response (<Response 8930 bytes [200 OK]>) to 10.0.5.222
2022-07-08 06:21:01.607473 (Thread-1): 06:21:01  SQL status: SUCCESS 6 in 1.67 seconds
2022-07-08 06:21:01.609205 (Thread-1): 06:21:01  finished collecting timing info
2022-07-08 06:21:01.609472 (Thread-1): 06:21:01  On rpc.ecommerce_data_model_dbt.request: Close
2022-07-08 06:21:01.688921 (Thread-114): handling poll request
2022-07-08 06:21:01.689426 (Thread-114): 06:21:01  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '78f3b6e0-4584-4822-b7bb-4d1427a5d8b5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4ec23b8280>]}
2022-07-08 06:21:01.689990 (Thread-114): sending response (<Response 1384 bytes [200 OK]>) to 10.0.5.222
2022-07-08 06:21:03.059334 (Thread-115): handling poll request
2022-07-08 06:21:03.059745 (Thread-115): 06:21:03  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '78f3b6e0-4584-4822-b7bb-4d1427a5d8b5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4ec23b8c70>]}
2022-07-08 06:21:03.060727 (Thread-115): sending response (<Response 24861 bytes [200 OK]>) to 10.0.5.222
2022-07-08 06:21:57.021349 (Thread-116): 06:21:57  Partial parsing enabled: 1 files deleted, 0 files added, 0 files changed.
2022-07-08 06:21:57.021943 (Thread-116): 06:21:57  Partial parsing: deleted file: ecommerce_data_model_dbt://models/data_model/stg_traits/device_type.sql
2022-07-08 06:21:57.027267 (Thread-116): 06:21:57  1699: static parser successfully parsed data_model/stg_user_traits_new.sql
2022-07-08 06:21:57.761900 (Thread-117): handling status request
2022-07-08 06:21:57.762369 (Thread-117): 06:21:57  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '78f3b6e0-4584-4822-b7bb-4d1427a5d8b5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4ec2353a60>]}
2022-07-08 06:21:57.762912 (Thread-117): sending response (<Response 1420 bytes [200 OK]>) to 10.0.5.222
2022-07-08 06:21:57.793804 (Thread-118): handling status request
2022-07-08 06:21:57.794219 (Thread-118): 06:21:57  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '78f3b6e0-4584-4822-b7bb-4d1427a5d8b5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4ec1a97c70>]}
2022-07-08 06:21:57.794712 (Thread-118): sending response (<Response 1420 bytes [200 OK]>) to 10.0.5.222
2022-07-08 06:22:14.369604 (Thread-119): 06:22:14  Partial parsing enabled: 1 files deleted, 1 files added, 0 files changed.
2022-07-08 06:22:14.370336 (Thread-119): 06:22:14  Partial parsing: added file: ecommerce_data_model_dbt://models/data_model/stg_traits/temp/device_type.sql
2022-07-08 06:22:14.370714 (Thread-119): 06:22:14  Partial parsing: deleted file: ecommerce_data_model_dbt://models/data_model/stg_traits/device_type.sql
2022-07-08 06:22:14.376485 (Thread-119): 06:22:14  1699: static parser successfully parsed data_model/stg_traits/temp/device_type.sql
2022-07-08 06:22:14.379765 (Thread-119): 06:22:14  1699: static parser successfully parsed data_model/stg_user_traits_new.sql
2022-07-08 06:22:14.423444 (Thread-119): 06:22:14  [WARNING]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.data-apps-ecommerce-template.data_model

2022-07-08 06:22:14.431439 (Thread-119): 06:22:14  Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '78f3b6e0-4584-4822-b7bb-4d1427a5d8b5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4ec19f9fd0>]}
2022-07-08 06:22:15.177676 (Thread-120): handling status request
2022-07-08 06:22:15.178074 (Thread-120): 06:22:15  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '78f3b6e0-4584-4822-b7bb-4d1427a5d8b5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4ec19e0730>]}
2022-07-08 06:22:15.178577 (Thread-120): sending response (<Response 2733 bytes [200 OK]>) to 10.0.5.222
2022-07-08 06:22:15.230487 (Thread-121): handling status request
2022-07-08 06:22:15.230889 (Thread-121): 06:22:15  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '78f3b6e0-4584-4822-b7bb-4d1427a5d8b5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4ec19e0e80>]}
2022-07-08 06:22:15.231390 (Thread-121): sending response (<Response 2733 bytes [200 OK]>) to 10.0.5.222
2022-07-08 06:22:19.055681 (Thread-122): 06:22:19  Partial parsing enabled: 1 files deleted, 0 files added, 0 files changed.
2022-07-08 06:22:19.056223 (Thread-122): 06:22:19  Partial parsing: deleted file: ecommerce_data_model_dbt://models/data_model/stg_traits/temp/device_type.sql
2022-07-08 06:22:19.060716 (Thread-122): 06:22:19  1699: static parser successfully parsed data_model/stg_user_traits_new.sql
2022-07-08 06:22:19.893564 (Thread-123): handling status request
2022-07-08 06:22:19.893996 (Thread-123): 06:22:19  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '78f3b6e0-4584-4822-b7bb-4d1427a5d8b5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4ec1935eb0>]}
2022-07-08 06:22:19.909241 (Thread-123): sending response (<Response 1425 bytes [200 OK]>) to 10.0.5.222
2022-07-08 06:22:20.002856 (Thread-124): handling status request
2022-07-08 06:22:20.003263 (Thread-124): 06:22:20  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '78f3b6e0-4584-4822-b7bb-4d1427a5d8b5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4ec1935d90>]}
2022-07-08 06:22:20.003752 (Thread-124): sending response (<Response 1425 bytes [200 OK]>) to 10.0.5.222
2022-07-08 06:22:34.183611 (Thread-125): 06:22:34  Partial parsing enabled: 1 files deleted, 1 files added, 0 files changed.
2022-07-08 06:22:34.184154 (Thread-125): 06:22:34  Partial parsing: added file: ecommerce_data_model_dbt://models/data_model/stg_traits/device_type.sql
2022-07-08 06:22:34.184375 (Thread-125): 06:22:34  Partial parsing: deleted file: ecommerce_data_model_dbt://models/data_model/stg_traits/temp/device_type.sql
2022-07-08 06:22:34.188085 (Thread-125): 06:22:34  1699: static parser successfully parsed data_model/stg_traits/device_type.sql
2022-07-08 06:22:34.190720 (Thread-125): 06:22:34  1699: static parser successfully parsed data_model/stg_user_traits_new.sql
2022-07-08 06:22:34.226950 (Thread-125): 06:22:34  [WARNING]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.data-apps-ecommerce-template.data_model

2022-07-08 06:22:34.232412 (Thread-125): 06:22:34  Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '78f3b6e0-4584-4822-b7bb-4d1427a5d8b5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4ec198e040>]}
2022-07-08 06:22:35.001756 (Thread-126): handling status request
2022-07-08 06:22:35.002170 (Thread-126): 06:22:35  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '78f3b6e0-4584-4822-b7bb-4d1427a5d8b5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4ec19ea190>]}
2022-07-08 06:22:35.002698 (Thread-126): sending response (<Response 2728 bytes [200 OK]>) to 10.0.5.222
2022-07-08 06:22:35.079126 (Thread-127): handling status request
2022-07-08 06:22:35.079559 (Thread-127): 06:22:35  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '78f3b6e0-4584-4822-b7bb-4d1427a5d8b5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4ec19eaf10>]}
2022-07-08 06:22:35.080081 (Thread-127): sending response (<Response 2728 bytes [200 OK]>) to 10.0.5.222
2022-07-08 06:22:50.671485 (Thread-128): 06:22:50  Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
2022-07-08 06:22:50.672354 (Thread-128): 06:22:50  Partial parsing: updated file: ecommerce_data_model_dbt://models/data_model/stg_traits/device_type.sql
2022-07-08 06:22:50.676416 (Thread-128): 06:22:50  1603: static parser failed on data_model/stg_traits/device_type.sql
2022-07-08 06:22:50.680449 (Thread-128): 06:22:50  1602: parser fallback to jinja rendering on data_model/stg_traits/device_type.sql
2022-07-08 06:22:50.878085 (Thread-128): 06:22:50  [WARNING]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.data-apps-ecommerce-template.data_model

2022-07-08 06:22:50.886010 (Thread-128): 06:22:50  Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '78f3b6e0-4584-4822-b7bb-4d1427a5d8b5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4ec19f82e0>]}
2022-07-08 06:22:51.415807 (Thread-129): handling status request
2022-07-08 06:22:51.416212 (Thread-129): 06:22:51  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '78f3b6e0-4584-4822-b7bb-4d1427a5d8b5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4ec19277c0>]}
2022-07-08 06:22:51.416713 (Thread-129): sending response (<Response 2378 bytes [200 OK]>) to 10.0.5.222
2022-07-08 06:22:51.470514 (Thread-130): handling status request
2022-07-08 06:22:51.470907 (Thread-130): 06:22:51  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '78f3b6e0-4584-4822-b7bb-4d1427a5d8b5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4ec19279a0>]}
2022-07-08 06:22:51.471399 (Thread-130): sending response (<Response 2378 bytes [200 OK]>) to 10.0.5.222
2022-07-08 06:30:51.071077 (Thread-131): 06:30:51  Partial parsing enabled: 1 files deleted, 1 files added, 0 files changed.
2022-07-08 06:30:51.072956 (Thread-131): 06:30:51  Partial parsing: added file: ecommerce_data_model_dbt://models/data_model/stg_traits/campaign_source.sql
2022-07-08 06:30:51.073118 (Thread-131): 06:30:51  Partial parsing: deleted file: ecommerce_data_model_dbt://models/data_model/stg_traits/utm_url_sequence.sql
2022-07-08 06:30:51.076822 (Thread-131): 06:30:51  1699: static parser successfully parsed data_model/stg_traits/campaign_source.sql
2022-07-08 06:30:51.122020 (Thread-131): 06:30:51  [WARNING]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.data-apps-ecommerce-template.data_model

2022-07-08 06:30:51.127783 (Thread-131): 06:30:51  Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '78f3b6e0-4584-4822-b7bb-4d1427a5d8b5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4ec23c82e0>]}
2022-07-08 06:30:51.833944 (Thread-132): handling status request
2022-07-08 06:30:51.834431 (Thread-132): 06:30:51  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '78f3b6e0-4584-4822-b7bb-4d1427a5d8b5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4ec1927d30>]}
2022-07-08 06:30:51.834997 (Thread-132): sending response (<Response 2420 bytes [200 OK]>) to 10.0.5.222
2022-07-08 06:30:51.863094 (Thread-133): handling status request
2022-07-08 06:30:51.863506 (Thread-133): 06:30:51  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '78f3b6e0-4584-4822-b7bb-4d1427a5d8b5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4ec18000d0>]}
2022-07-08 06:30:51.864005 (Thread-133): sending response (<Response 2420 bytes [200 OK]>) to 10.0.5.222
2022-07-08 06:33:29.881208 (Thread-134): 06:33:29  Partial parsing enabled: 1 files deleted, 1 files added, 0 files changed.
2022-07-08 06:33:29.883223 (Thread-134): 06:33:29  Partial parsing: added file: ecommerce_data_model_dbt://models/data_model/stg_traits/campaign.sql
2022-07-08 06:33:29.883391 (Thread-134): 06:33:29  Partial parsing: deleted file: ecommerce_data_model_dbt://models/data_model/stg_traits/campaign_source.sql
2022-07-08 06:33:29.887275 (Thread-134): 06:33:29  1699: static parser successfully parsed data_model/stg_traits/campaign.sql
2022-07-08 06:33:29.928855 (Thread-134): 06:33:29  [WARNING]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.data-apps-ecommerce-template.data_model

2022-07-08 06:33:29.934603 (Thread-134): 06:33:29  Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '78f3b6e0-4584-4822-b7bb-4d1427a5d8b5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4ec249df70>]}
2022-07-08 06:33:30.548773 (Thread-135): handling status request
2022-07-08 06:33:30.549217 (Thread-135): 06:33:30  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '78f3b6e0-4584-4822-b7bb-4d1427a5d8b5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4ec18c16a0>]}
2022-07-08 06:33:30.549778 (Thread-135): sending response (<Response 2405 bytes [200 OK]>) to 10.0.5.222
2022-07-08 06:33:30.608874 (Thread-136): handling status request
2022-07-08 06:33:30.609341 (Thread-136): 06:33:30  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '78f3b6e0-4584-4822-b7bb-4d1427a5d8b5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4ec18c1a30>]}
2022-07-08 06:33:30.609868 (Thread-136): sending response (<Response 2405 bytes [200 OK]>) to 10.0.5.222
2022-07-08 06:35:07.194554 (Thread-137): 06:35:07  Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
2022-07-08 06:35:07.197124 (Thread-137): 06:35:07  Partial parsing: updated file: ecommerce_data_model_dbt://models/data_model/stg_traits/campaign.sql
2022-07-08 06:35:07.201039 (Thread-137): 06:35:07  1603: static parser failed on data_model/stg_traits/campaign.sql
2022-07-08 06:35:07.204968 (Thread-137): 06:35:07  1602: parser fallback to jinja rendering on data_model/stg_traits/campaign.sql
2022-07-08 06:35:07.240097 (Thread-137): 06:35:07  [WARNING]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.data-apps-ecommerce-template.data_model

2022-07-08 06:35:07.246116 (Thread-137): 06:35:07  Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '78f3b6e0-4584-4822-b7bb-4d1427a5d8b5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4ec36f7370>]}
2022-07-08 06:35:07.892925 (Thread-138): handling status request
2022-07-08 06:35:07.893364 (Thread-138): 06:35:07  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '78f3b6e0-4584-4822-b7bb-4d1427a5d8b5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4ec2346d60>]}
2022-07-08 06:35:07.893884 (Thread-138): sending response (<Response 2369 bytes [200 OK]>) to 10.0.5.222
2022-07-08 06:35:07.955165 (Thread-139): handling status request
2022-07-08 06:35:07.955588 (Thread-139): 06:35:07  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '78f3b6e0-4584-4822-b7bb-4d1427a5d8b5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4ec2346a00>]}
2022-07-08 06:35:07.956090 (Thread-139): sending response (<Response 2369 bytes [200 OK]>) to 10.0.5.222
2022-07-08 06:35:09.090664 (Thread-140): handling status request
2022-07-08 06:35:09.091076 (Thread-140): 06:35:09  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '78f3b6e0-4584-4822-b7bb-4d1427a5d8b5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4ec23463a0>]}
2022-07-08 06:35:09.091576 (Thread-140): sending response (<Response 2369 bytes [200 OK]>) to 10.0.5.222
2022-07-08 06:35:09.444374 (Thread-141): handling run_sql request
2022-07-08 06:35:09.444818 (Thread-141): 06:35:09  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '78f3b6e0-4584-4822-b7bb-4d1427a5d8b5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4ec23461f0>]}
2022-07-08 06:35:11.834995 (Thread-141): sending response (<Response 139 bytes [200 OK]>) to 10.0.5.222
2022-07-08 06:35:11.861887 (MainThread): 06:35:11  Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '04071be0-2a18-4823-bf79-e0d2ec5915fc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff67230e610>]}
2022-07-08 06:35:11.862513 (MainThread): 06:35:11  Found 18 models, 0 tests, 0 snapshots, 0 analyses, 181 macros, 0 operations, 0 seed files, 15 sources, 0 exposures, 0 metrics
2022-07-08 06:35:11.863166 (Thread-1): 06:35:11  Acquiring new snowflake connection "rpc.ecommerce_data_model_dbt.request"
2022-07-08 06:35:11.863307 (Thread-1): 06:35:11  Began compiling node rpc.ecommerce_data_model_dbt.request
2022-07-08 06:35:11.863500 (Thread-1): 06:35:11  Compiling rpc.ecommerce_data_model_dbt.request
2022-07-08 06:35:11.866575 (Thread-1): 06:35:11  finished collecting timing info
2022-07-08 06:35:11.866730 (Thread-1): 06:35:11  Began executing node rpc.ecommerce_data_model_dbt.request
2022-07-08 06:35:11.868329 (Thread-1): 06:35:11  Using snowflake connection "rpc.ecommerce_data_model_dbt.request"
2022-07-08 06:35:11.868437 (Thread-1): 06:35:11  On rpc.ecommerce_data_model_dbt.request: with cte_id_stitched_identifies as 
(select distinct b.main_id as main_id, context_campaign_source, context_campaign_name, timestamp from analytics_db.data_apps_simulated.identifies a left join 
ANALYTICS_DB.DATA_APPS_SIMULATED.MATERIAL_DOMAIN_PROFILE__IDSTITCHER_DC3F9DA0_12 b 
on (a.user_id = b.other_id and b.other_id_type = 'user_id') or (a.properties_email = b.other_id and b.other_id_type = 'email'))
select distinct main_id, 
first_value(context_campaign_source)
over(partition by main_id order by case when context_campaign_source is not null and context_campaign_source != '' then 2 else 1 end desc, timestamp desc) as campaign_source,
first_value(context_campaign_name)
over(partition by main_id order by case when context_campaign_name is not null and context_campaign_name != '' then 2 else 1 end desc, timestamp desc) as campaign_name
from cte_id_stitched_identifies where timestamp >= '2021-05-01' and timestamp <= '2022-06-29' and main_id is not null
limit 500
/* limit added automatically by dbt cloud */
2022-07-08 06:35:11.868525 (Thread-1): 06:35:11  Opening a new connection, currently in state init
2022-07-08 06:35:12.213214 (Thread-142): handling poll request
2022-07-08 06:35:12.213786 (Thread-142): 06:35:12  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '78f3b6e0-4584-4822-b7bb-4d1427a5d8b5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4ec1aac340>]}
2022-07-08 06:35:12.214719 (Thread-142): sending response (<Response 4760 bytes [200 OK]>) to 10.0.5.222
2022-07-08 06:35:13.478283 (Thread-1): 06:35:13  SQL status: SUCCESS 4 in 1.61 seconds
2022-07-08 06:35:13.480343 (Thread-1): 06:35:13  finished collecting timing info
2022-07-08 06:35:13.480631 (Thread-1): 06:35:13  On rpc.ecommerce_data_model_dbt.request: Close
2022-07-08 06:35:13.596805 (Thread-143): handling poll request
2022-07-08 06:35:13.597225 (Thread-143): 06:35:13  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '78f3b6e0-4584-4822-b7bb-4d1427a5d8b5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4ec18bee20>]}
2022-07-08 06:35:13.597847 (Thread-143): sending response (<Response 1388 bytes [200 OK]>) to 10.0.5.222
2022-07-08 06:35:14.971376 (Thread-144): handling poll request
2022-07-08 06:35:14.971793 (Thread-144): 06:35:14  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '78f3b6e0-4584-4822-b7bb-4d1427a5d8b5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4ec18be550>]}
2022-07-08 06:35:14.972691 (Thread-144): sending response (<Response 6734 bytes [200 OK]>) to 10.0.5.222
2022-07-11 04:15:07.362610 (MainThread): Running with dbt=1.0.8
2022-07-11 04:15:07.626769 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt_rpc.task.server.RPCServerTask'>, debug=None, defer=None, exclude=None, fail_fast=None, host='0.0.0.0', log_cache_events=False, log_format=None, models=None, partial_parse=True, port=8580, printer_width=None, profile='user', profiles_dir='/usr/src/develop/.dbt', project_dir=None, record_timing_info=None, rpc_method=None, send_anonymous_usage_stats=None, single_threaded=False, state=None, static_parser=None, target=None, threads=None, use_colors=None, use_experimental_parser=None, vars='{}', version_check=None, warn_error=None, which='rpc', write_json=None)
2022-07-11 04:15:07.634613 (MainThread): Tracking: tracking
2022-07-11 04:15:07.634930 (MainThread): 04:15:07  Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5fa5a5e5b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5f686ec790>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5f686fefd0>]}
2022-07-11 04:15:07.635626 (MainThread): Serving RPC server at 0.0.0.0:8580, pid=22
2022-07-11 04:15:07.640515 (MainThread): Supported methods: ['build', 'cli_args', 'compile', 'compile_sql', 'deps', 'docs.generate', 'gc', 'get-manifest', 'kill', 'list', 'poll', 'ps', 'run', 'run-operation', 'run_sql', 'seed', 'snapshot', 'snapshot-freshness', 'source-freshness', 'status', 'test']
2022-07-11 04:15:07.640778 (MainThread): Send requests to http://localhost:8580/jsonrpc
2022-07-11 04:15:07.790494 (Thread-12): 04:15:07  Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
2022-07-11 04:15:07.790732 (Thread-12): 04:15:07  Partial parsing enabled, no changes found, skipping parsing
2022-07-11 04:15:07.791538 (Thread-12): 04:15:07  [WARNING]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.data-apps-ecommerce-template.data_model

2022-07-11 04:15:07.798141 (Thread-12): 04:15:07  Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'abb747fb-8e32-40e8-a54b-14dec56d6a10', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5f68182d90>]}
2022-07-11 04:15:08.602585 (Thread-13): handling ps request
2022-07-11 04:15:08.602999 (Thread-13): 04:15:08  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'abb747fb-8e32-40e8-a54b-14dec56d6a10', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5f6867b430>]}
2022-07-11 04:15:08.603592 (Thread-13): sending response (<Response 106 bytes [200 OK]>) to 10.0.45.34
2022-07-11 04:15:08.637604 (Thread-14): handling status request
2022-07-11 04:15:08.637962 (Thread-14): 04:15:08  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'abb747fb-8e32-40e8-a54b-14dec56d6a10', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5f6867b2e0>]}
2022-07-11 04:15:08.638426 (Thread-14): sending response (<Response 1699 bytes [200 OK]>) to 10.0.45.34
2022-07-11 04:15:08.784291 (Thread-15): handling status request
2022-07-11 04:15:08.784697 (Thread-15): 04:15:08  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'abb747fb-8e32-40e8-a54b-14dec56d6a10', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5f6867b610>]}
2022-07-11 04:15:08.785187 (Thread-15): sending response (<Response 1699 bytes [200 OK]>) to 10.0.45.34
2022-07-11 04:15:08.827452 (Thread-16): handling status request
2022-07-11 04:15:08.827789 (Thread-16): 04:15:08  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'abb747fb-8e32-40e8-a54b-14dec56d6a10', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5f6867b1c0>]}
2022-07-11 04:15:08.828257 (Thread-16): sending response (<Response 1699 bytes [200 OK]>) to 10.0.45.34
2022-07-11 04:15:11.102921 (Thread-17): handling status request
2022-07-11 04:15:11.103320 (Thread-17): 04:15:11  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'abb747fb-8e32-40e8-a54b-14dec56d6a10', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5f681eaeb0>]}
2022-07-11 04:15:11.103807 (Thread-17): sending response (<Response 1676 bytes [200 OK]>) to 10.0.45.34
2022-07-11 04:15:11.139075 (Thread-18): handling list request
2022-07-11 04:15:11.139354 (Thread-18): 04:15:11  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'abb747fb-8e32-40e8-a54b-14dec56d6a10', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5f681ead30>]}
2022-07-11 04:15:11.181860 (Thread-18): 04:15:11  Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'abb747fb-8e32-40e8-a54b-14dec56d6a10', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5f686ecdf0>]}
2022-07-11 04:15:11.182171 (Thread-18): 04:15:11  Found 18 models, 0 tests, 0 snapshots, 0 analyses, 181 macros, 0 operations, 0 seed files, 15 sources, 0 exposures, 0 metrics
2022-07-11 04:15:11.185107 (Thread-18): sending response (<Response 2046 bytes [200 OK]>) to 10.0.45.34
2022-07-11 04:15:11.326008 (Thread-19): handling status request
2022-07-11 04:15:11.326325 (Thread-19): 04:15:11  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'abb747fb-8e32-40e8-a54b-14dec56d6a10', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5f6867b0a0>]}
2022-07-11 04:15:11.326742 (Thread-19): sending response (<Response 1699 bytes [200 OK]>) to 10.0.45.34
2022-07-12 04:01:50.246044 (MainThread): Running with dbt=1.0.8
2022-07-12 04:01:50.511418 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt_rpc.task.server.RPCServerTask'>, debug=None, defer=None, exclude=None, fail_fast=None, host='0.0.0.0', log_cache_events=False, log_format=None, models=None, partial_parse=True, port=8580, printer_width=None, profile='user', profiles_dir='/usr/src/develop/.dbt', project_dir=None, record_timing_info=None, rpc_method=None, send_anonymous_usage_stats=None, single_threaded=False, state=None, static_parser=None, target=None, threads=None, use_colors=None, use_experimental_parser=None, vars='{}', version_check=None, warn_error=None, which='rpc', write_json=None)
2022-07-12 04:01:50.519820 (MainThread): Tracking: tracking
2022-07-12 04:01:50.520140 (MainThread): 04:01:50  Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f57e24e7550>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f57a85f6400>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f57a85f6e50>]}
2022-07-12 04:01:50.520720 (MainThread): Serving RPC server at 0.0.0.0:8580, pid=22
2022-07-12 04:01:50.525559 (MainThread): Supported methods: ['build', 'cli_args', 'compile', 'compile_sql', 'deps', 'docs.generate', 'gc', 'get-manifest', 'kill', 'list', 'poll', 'ps', 'run', 'run-operation', 'run_sql', 'seed', 'snapshot', 'snapshot-freshness', 'source-freshness', 'status', 'test']
2022-07-12 04:01:50.525807 (MainThread): Send requests to http://localhost:8580/jsonrpc
2022-07-12 04:01:50.661942 (Thread-12): 04:01:50  Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
2022-07-12 04:01:50.662187 (Thread-12): 04:01:50  Partial parsing enabled, no changes found, skipping parsing
2022-07-12 04:01:50.662955 (Thread-12): 04:01:50  [WARNING]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.data-apps-ecommerce-template.data_model

2022-07-12 04:01:50.669517 (Thread-12): 04:01:50  Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'e9ee85b0-5af3-42b4-9ed9-b00233565715', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f57a848b880>]}
2022-07-12 04:01:52.387758 (Thread-13): handling status request
2022-07-12 04:01:52.388189 (Thread-13): 04:01:52  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'e9ee85b0-5af3-42b4-9ed9-b00233565715', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f57a84f99a0>]}
2022-07-12 04:01:52.388847 (Thread-13): sending response (<Response 1699 bytes [200 OK]>) to 10.0.12.141
2022-07-12 04:01:52.522595 (Thread-14): handling ps request
2022-07-12 04:01:52.522996 (Thread-14): 04:01:52  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'e9ee85b0-5af3-42b4-9ed9-b00233565715', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f57a84f9910>]}
2022-07-12 04:01:52.523451 (Thread-14): sending response (<Response 106 bytes [200 OK]>) to 10.0.12.141
2022-07-12 04:01:52.563614 (Thread-15): handling status request
2022-07-12 04:01:52.564033 (Thread-15): 04:01:52  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'e9ee85b0-5af3-42b4-9ed9-b00233565715', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f57a84f9f10>]}
2022-07-12 04:01:52.564492 (Thread-15): sending response (<Response 1699 bytes [200 OK]>) to 10.0.12.141
2022-07-12 04:01:52.699104 (Thread-16): handling status request
2022-07-12 04:01:52.699506 (Thread-16): 04:01:52  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'e9ee85b0-5af3-42b4-9ed9-b00233565715', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f57a84f9610>]}
2022-07-12 04:01:52.699979 (Thread-16): sending response (<Response 1699 bytes [200 OK]>) to 10.0.12.141
2022-07-12 04:01:53.895931 (Thread-17): handling status request
2022-07-12 04:01:53.896391 (Thread-17): 04:01:53  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'e9ee85b0-5af3-42b4-9ed9-b00233565715', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f57eaaa5490>]}
2022-07-12 04:01:53.896889 (Thread-17): sending response (<Response 1699 bytes [200 OK]>) to 10.0.12.141
2022-07-12 04:02:04.257191 (Thread-18): handling status request
2022-07-12 04:02:04.257607 (Thread-18): 04:02:04  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'e9ee85b0-5af3-42b4-9ed9-b00233565715', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f57a84f90d0>]}
2022-07-12 04:02:04.258150 (Thread-18): sending response (<Response 1699 bytes [200 OK]>) to 10.0.12.141
2022-07-12 04:02:04.299471 (Thread-19): handling status request
2022-07-12 04:02:04.299870 (Thread-19): 04:02:04  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'e9ee85b0-5af3-42b4-9ed9-b00233565715', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f57a85fdd30>]}
2022-07-12 04:02:04.300351 (Thread-19): sending response (<Response 1699 bytes [200 OK]>) to 10.0.12.141
2022-07-12 04:02:04.329350 (Thread-20): handling status request
2022-07-12 04:02:04.329752 (Thread-20): 04:02:04  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'e9ee85b0-5af3-42b4-9ed9-b00233565715', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f57a85fde80>]}
2022-07-12 04:02:04.330260 (Thread-20): sending response (<Response 1699 bytes [200 OK]>) to 10.0.12.141
2022-07-12 04:02:04.418265 (Thread-21): handling ps request
2022-07-12 04:02:04.418681 (Thread-21): 04:02:04  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'e9ee85b0-5af3-42b4-9ed9-b00233565715', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f57a8552b80>]}
2022-07-12 04:02:04.419117 (Thread-21): sending response (<Response 106 bytes [200 OK]>) to 10.0.12.141
2022-07-12 04:02:06.310713 (Thread-22): handling status request
2022-07-12 04:02:06.311167 (Thread-22): 04:02:06  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'e9ee85b0-5af3-42b4-9ed9-b00233565715', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f57a85527c0>]}
2022-07-12 04:02:06.311686 (Thread-22): sending response (<Response 1676 bytes [200 OK]>) to 10.0.12.141
2022-07-12 04:02:06.321443 (Thread-23): handling list request
2022-07-12 04:02:06.321740 (Thread-23): 04:02:06  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'e9ee85b0-5af3-42b4-9ed9-b00233565715', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f57a8552ee0>]}
2022-07-12 04:02:06.363970 (Thread-23): 04:02:06  Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'e9ee85b0-5af3-42b4-9ed9-b00233565715', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f57a84f9bb0>]}
2022-07-12 04:02:06.364368 (Thread-23): 04:02:06  Found 18 models, 0 tests, 0 snapshots, 0 analyses, 181 macros, 0 operations, 0 seed files, 15 sources, 0 exposures, 0 metrics
2022-07-12 04:02:06.367600 (Thread-23): sending response (<Response 2048 bytes [200 OK]>) to 10.0.12.141
2022-07-12 04:02:06.594736 (Thread-24): handling status request
2022-07-12 04:02:06.595140 (Thread-24): 04:02:06  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'e9ee85b0-5af3-42b4-9ed9-b00233565715', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f57a84976d0>]}
2022-07-12 04:02:06.595613 (Thread-24): sending response (<Response 1699 bytes [200 OK]>) to 10.0.12.141
2022-07-12 04:02:20.200431 (Thread-25): 04:02:20  Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
2022-07-12 04:02:20.203415 (Thread-25): 04:02:20  Partial parsing: updated file: ecommerce_data_model_dbt://models/data_model/stg_traits/campaign.sql
2022-07-12 04:02:20.215143 (Thread-25): 04:02:20  1603: static parser failed on data_model/stg_traits/campaign.sql
2022-07-12 04:02:20.231534 (Thread-25): 04:02:20  1602: parser fallback to jinja rendering on data_model/stg_traits/campaign.sql
2022-07-12 04:02:20.287708 (Thread-25): 04:02:20  [WARNING]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.data-apps-ecommerce-template.data_model

2022-07-12 04:02:20.293359 (Thread-25): 04:02:20  Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'e9ee85b0-5af3-42b4-9ed9-b00233565715', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f57a836fd30>]}
2022-07-12 04:02:20.716524 (Thread-26): handling status request
2022-07-12 04:02:20.716972 (Thread-26): 04:02:20  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'e9ee85b0-5af3-42b4-9ed9-b00233565715', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f57a83a3850>]}
2022-07-12 04:02:20.717474 (Thread-26): sending response (<Response 2340 bytes [200 OK]>) to 10.0.12.141
2022-07-12 04:02:20.764658 (Thread-27): handling list request
2022-07-12 04:02:20.765060 (Thread-27): 04:02:20  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'e9ee85b0-5af3-42b4-9ed9-b00233565715', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f57a83a3760>]}
2022-07-12 04:02:20.794095 (Thread-27): 04:02:20  Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'e9ee85b0-5af3-42b4-9ed9-b00233565715', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f57a83a3580>]}
2022-07-12 04:02:20.794441 (Thread-27): 04:02:20  Found 18 models, 0 tests, 0 snapshots, 0 analyses, 181 macros, 0 operations, 0 seed files, 15 sources, 0 exposures, 0 metrics
2022-07-12 04:02:20.797298 (Thread-27): sending response (<Response 2097 bytes [200 OK]>) to 10.0.12.141
2022-07-12 04:02:20.872078 (Thread-28): handling status request
2022-07-12 04:02:20.872496 (Thread-28): 04:02:20  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'e9ee85b0-5af3-42b4-9ed9-b00233565715', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f57a8420460>]}
2022-07-12 04:02:20.872999 (Thread-28): sending response (<Response 2363 bytes [200 OK]>) to 10.0.12.141
2022-07-12 04:02:20.930675 (Thread-29): handling status request
2022-07-12 04:02:20.931056 (Thread-29): 04:02:20  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'e9ee85b0-5af3-42b4-9ed9-b00233565715', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f57a84485e0>]}
2022-07-12 04:02:20.931523 (Thread-29): sending response (<Response 2363 bytes [200 OK]>) to 10.0.12.141
2022-07-12 04:02:26.822470 (Thread-30): 04:02:26  Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
2022-07-12 04:02:26.823033 (Thread-30): 04:02:26  Partial parsing: updated file: ecommerce_data_model_dbt://models/data_model/stg_traits/campaign.sql
2022-07-12 04:02:26.826699 (Thread-30): 04:02:26  1699: static parser successfully parsed data_model/stg_traits/campaign.sql
2022-07-12 04:02:26.864152 (Thread-30): 04:02:26  [WARNING]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.data-apps-ecommerce-template.data_model

2022-07-12 04:02:26.869981 (Thread-30): 04:02:26  Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'e9ee85b0-5af3-42b4-9ed9-b00233565715', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f57a80bce80>]}
2022-07-12 04:02:27.383547 (Thread-31): handling status request
2022-07-12 04:02:27.383963 (Thread-31): 04:02:27  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'e9ee85b0-5af3-42b4-9ed9-b00233565715', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f57a80a6c10>]}
2022-07-12 04:02:27.384478 (Thread-31): sending response (<Response 2031 bytes [200 OK]>) to 10.0.12.141
2022-07-12 04:02:27.414151 (Thread-32): handling list request
2022-07-12 04:02:27.414562 (Thread-32): 04:02:27  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'e9ee85b0-5af3-42b4-9ed9-b00233565715', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f57a80a6af0>]}
2022-07-12 04:02:27.447999 (Thread-32): 04:02:27  Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'e9ee85b0-5af3-42b4-9ed9-b00233565715', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f57a80a6400>]}
2022-07-12 04:02:27.448398 (Thread-32): 04:02:27  Found 18 models, 0 tests, 0 snapshots, 0 analyses, 181 macros, 0 operations, 0 seed files, 15 sources, 0 exposures, 0 metrics
2022-07-12 04:02:27.450033 (Thread-32): 04:02:27  The selection criterion '+models/data_model/stg_traits/campaign.sql+' does not match any nodes
2022-07-12 04:02:27.450308 (Thread-32): 04:02:27  No nodes selected!
2022-07-12 04:02:27.451904 (Thread-32): sending response (<Response 1956 bytes [200 OK]>) to 10.0.12.141
2022-07-12 04:02:27.532333 (Thread-33): handling status request
2022-07-12 04:02:27.532772 (Thread-33): 04:02:27  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'e9ee85b0-5af3-42b4-9ed9-b00233565715', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f57a836fd90>]}
2022-07-12 04:02:27.533275 (Thread-33): sending response (<Response 2054 bytes [200 OK]>) to 10.0.12.141
2022-07-12 04:02:27.944242 (Thread-34): handling status request
2022-07-12 04:02:27.944685 (Thread-34): 04:02:27  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'e9ee85b0-5af3-42b4-9ed9-b00233565715', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f57a8448310>]}
2022-07-12 04:02:27.945160 (Thread-34): sending response (<Response 2054 bytes [200 OK]>) to 10.0.12.141
2022-07-12 04:02:48.270727 (Thread-35): handling status request
2022-07-12 04:02:48.272147 (Thread-35): 04:02:48  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'e9ee85b0-5af3-42b4-9ed9-b00233565715', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f57a80a6d30>]}
2022-07-12 04:02:48.272651 (Thread-35): sending response (<Response 2054 bytes [200 OK]>) to 10.0.12.141
